++ id -u
+ myuid=0
++ id -g
+ mygid=0
+ set +e
++ getent passwd 0
+ uidentry=root:x:0:0:root:/root:/bin/ash
+ set -e
+ '[' -z root:x:0:0:root:/root:/bin/ash ']'
+ SPARK_K8S_CMD=driver
+ case "$SPARK_K8S_CMD" in
+ shift 1
+ SPARK_CLASSPATH=':/opt/spark/jars/*'
+ env
+ grep SPARK_JAVA_OPT_
+ sort -t_ -k4 -n
+ sed 's/[^=]*=\(.*\)/\1/g'
+ readarray -t SPARK_EXECUTOR_JAVA_OPTS
+ '[' -n '' ']'
+ '[' -n '' ']'
+ PYSPARK_ARGS=
+ '[' -n '' ']'
+ R_ARGS=
+ '[' -n '' ']'
+ '[' '' == 2 ']'
+ '[' '' == 3 ']'
+ case "$SPARK_K8S_CMD" in
+ CMD=("$SPARK_HOME/bin/spark-submit" --conf "spark.driver.bindAddress=$SPARK_DRIVER_BIND_ADDRESS" --deploy-mode client "$@")
+ exec /sbin/tini -s -- /opt/spark/bin/spark-submit --conf spark.driver.bindAddress=192.168.61.42 --deploy-mode client --properties-file /opt/spark/conf/spark.properties --class com.amazonaws.eks.tpcds.BenchmarkSparkSQL spark-internal s3a://spark-k8s-data/TPCDS-TEST-100G s3a://spark-k8s-data/TPCDS-TEST-100G-RESULT /opt/tpcds-kit/tools 100 1 false '' true
19/09/08 18:11:58 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
DATA DIR is s3a://spark-k8s-data/TPCDS-TEST-100G
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
19/09/08 18:11:59 INFO SparkContext: Running Spark version 2.4.5-SNAPSHOT
19/09/08 18:11:59 INFO SparkContext: Submitted application: TPCDS SQL Benchmark 100 GB
19/09/08 18:11:59 INFO SecurityManager: Changing view acls to: root
19/09/08 18:11:59 INFO SecurityManager: Changing modify acls to: root
19/09/08 18:11:59 INFO SecurityManager: Changing view acls groups to: 
19/09/08 18:11:59 INFO SecurityManager: Changing modify acls groups to: 
19/09/08 18:11:59 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(root); groups with view permissions: Set(); users  with modify permissions: Set(root); groups with modify permissions: Set()
19/09/08 18:11:59 INFO Utils: Successfully started service 'sparkDriver' on port 7078.
19/09/08 18:11:59 INFO SparkEnv: Registering MapOutputTracker
19/09/08 18:11:59 INFO SparkEnv: Registering BlockManagerMaster
19/09/08 18:11:59 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
19/09/08 18:11:59 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
19/09/08 18:11:59 INFO DiskBlockManager: Created local directory at /var/data/spark-7d3925f2-1cde-4f99-9e61-9f4462af32b4/blockmgr-5f381160-7f48-4930-8d39-7da0d78d35de
19/09/08 18:11:59 INFO MemoryStore: MemoryStore started with capacity 4.0 GB
19/09/08 18:11:59 INFO SparkEnv: Registering OutputCommitCoordinator
19/09/08 18:12:00 INFO Utils: Successfully started service 'SparkUI' on port 4040.
19/09/08 18:12:00 INFO SparkUI: Bound SparkUI to 0.0.0.0, and started at http://tpcds-benchmark-100g-1567966314619-driver-svc.default.svc:4040
19/09/08 18:12:00 INFO SparkContext: Added JAR file:///opt/spark/examples/jars/eks-spark-examples-assembly-1.0.jar at spark://tpcds-benchmark-100g-1567966314619-driver-svc.default.svc:7078/jars/eks-spark-examples-assembly-1.0.jar with timestamp 1567966320248
19/09/08 18:12:01 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:12:01 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 7079.
19/09/08 18:12:01 INFO NettyBlockTransferService: Server created on tpcds-benchmark-100g-1567966314619-driver-svc.default.svc:7079
19/09/08 18:12:01 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
19/09/08 18:12:01 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, tpcds-benchmark-100g-1567966314619-driver-svc.default.svc, 7079, None)
19/09/08 18:12:01 INFO BlockManagerMasterEndpoint: Registering block manager tpcds-benchmark-100g-1567966314619-driver-svc.default.svc:7079 with 4.0 GB RAM, BlockManagerId(driver, tpcds-benchmark-100g-1567966314619-driver-svc.default.svc, 7079, None)
19/09/08 18:12:01 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, tpcds-benchmark-100g-1567966314619-driver-svc.default.svc, 7079, None)
19/09/08 18:12:01 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, tpcds-benchmark-100g-1567966314619-driver-svc.default.svc, 7079, None)
19/09/08 18:12:04 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:12:04 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.60.168:49902) with ID 1
19/09/08 18:12:04 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.59.59:35574) with ID 3
19/09/08 18:12:04 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.14.171:45360) with ID 4
19/09/08 18:12:04 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.21.197:34672) with ID 2
19/09/08 18:12:04 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.60.168:46183 with 4.3 GB RAM, BlockManagerId(1, 192.168.60.168, 46183, None)
19/09/08 18:12:04 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.21.201:36980) with ID 5
19/09/08 18:12:04 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.14.171:44047 with 4.3 GB RAM, BlockManagerId(4, 192.168.14.171, 44047, None)
19/09/08 18:12:04 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.59.59:43065 with 4.3 GB RAM, BlockManagerId(3, 192.168.59.59, 43065, None)
19/09/08 18:12:05 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.21.197:43649 with 4.3 GB RAM, BlockManagerId(2, 192.168.21.197, 43649, None)
19/09/08 18:12:05 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.21.201:43643 with 4.3 GB RAM, BlockManagerId(5, 192.168.21.201, 43643, None)
19/09/08 18:12:06 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:12:07 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.10.9:49100) with ID 6
19/09/08 18:12:07 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.27.133:35638) with ID 9
19/09/08 18:12:08 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.8.107:46488) with ID 8
19/09/08 18:12:08 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.51.66:54944) with ID 7
19/09/08 18:12:08 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.10.9:45165 with 4.3 GB RAM, BlockManagerId(6, 192.168.10.9, 45165, None)
19/09/08 18:12:08 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.27.133:36379 with 4.3 GB RAM, BlockManagerId(9, 192.168.27.133, 36379, None)
19/09/08 18:12:08 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.55.222:59818) with ID 10
19/09/08 18:12:08 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.8.107:33309 with 4.3 GB RAM, BlockManagerId(8, 192.168.8.107, 33309, None)
19/09/08 18:12:08 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.51.66:43411 with 4.3 GB RAM, BlockManagerId(7, 192.168.51.66, 43411, None)
19/09/08 18:12:08 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.55.222:40799 with 4.3 GB RAM, BlockManagerId(10, 192.168.55.222, 40799, None)
19/09/08 18:12:09 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:12:10 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.48.158:43114) with ID 12
19/09/08 18:12:10 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.10.107:37568) with ID 11
19/09/08 18:12:10 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.23.67:49688) with ID 13
19/09/08 18:12:10 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.40.194:39000) with ID 14
19/09/08 18:12:10 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.48.158:45699 with 4.3 GB RAM, BlockManagerId(12, 192.168.48.158, 45699, None)
19/09/08 18:12:10 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.10.107:42037 with 4.3 GB RAM, BlockManagerId(11, 192.168.10.107, 42037, None)
19/09/08 18:12:10 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.23.67:36759 with 4.3 GB RAM, BlockManagerId(13, 192.168.23.67, 36759, None)
19/09/08 18:12:10 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.40.194:45881 with 4.3 GB RAM, BlockManagerId(14, 192.168.40.194, 45881, None)
19/09/08 18:12:10 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.17.74:45182) with ID 15
19/09/08 18:12:10 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.17.74:43349 with 4.3 GB RAM, BlockManagerId(15, 192.168.17.74, 43349, None)
19/09/08 18:12:11 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:12:12 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.54.132:34614) with ID 16
19/09/08 18:12:12 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.27.141:56882) with ID 18
19/09/08 18:12:12 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.23.206:56774) with ID 20
19/09/08 18:12:12 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.44.190:41744) with ID 19
19/09/08 18:12:12 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.54.132:42365 with 4.3 GB RAM, BlockManagerId(16, 192.168.54.132, 42365, None)
19/09/08 18:12:12 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.27.141:46393 with 4.3 GB RAM, BlockManagerId(18, 192.168.27.141, 46393, None)
19/09/08 18:12:12 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.23.206:46741 with 4.3 GB RAM, BlockManagerId(20, 192.168.23.206, 46741, None)
19/09/08 18:12:12 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.39.152:57830) with ID 17
19/09/08 18:12:12 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.44.190:35651 with 4.3 GB RAM, BlockManagerId(19, 192.168.44.190, 35651, None)
19/09/08 18:12:12 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.39.152:45653 with 4.3 GB RAM, BlockManagerId(17, 192.168.39.152, 45653, None)
19/09/08 18:12:13 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:12:14 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.45.183:51642) with ID 22
19/09/08 18:12:14 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.6.66:60720) with ID 21
19/09/08 18:12:14 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.2.135:36474) with ID 25
19/09/08 18:12:14 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.37.187:44124) with ID 23
19/09/08 18:12:14 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.45.183:33059 with 4.3 GB RAM, BlockManagerId(22, 192.168.45.183, 33059, None)
19/09/08 18:12:14 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.6.66:44269 with 4.3 GB RAM, BlockManagerId(21, 192.168.6.66, 44269, None)
19/09/08 18:12:14 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.4.97:50896) with ID 24
19/09/08 18:12:14 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.2.135:44569 with 4.3 GB RAM, BlockManagerId(25, 192.168.2.135, 44569, None)
19/09/08 18:12:14 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.37.187:35225 with 4.3 GB RAM, BlockManagerId(23, 192.168.37.187, 35225, None)
19/09/08 18:12:14 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.4.97:40947 with 4.3 GB RAM, BlockManagerId(24, 192.168.4.97, 40947, None)
19/09/08 18:12:16 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:12:16 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.37.69:42468) with ID 29
19/09/08 18:12:16 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.3.117:35018) with ID 28
19/09/08 18:12:16 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.51.198:40380) with ID 27
19/09/08 18:12:16 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.52.147:35832) with ID 26
19/09/08 18:12:16 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.3.154:35808) with ID 30
19/09/08 18:12:16 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.37.69:38583 with 4.3 GB RAM, BlockManagerId(29, 192.168.37.69, 38583, None)
19/09/08 18:12:16 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.3.117:43109 with 4.3 GB RAM, BlockManagerId(28, 192.168.3.117, 43109, None)
19/09/08 18:12:16 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.51.198:44265 with 4.3 GB RAM, BlockManagerId(27, 192.168.51.198, 44265, None)
19/09/08 18:12:16 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.52.147:44083 with 4.3 GB RAM, BlockManagerId(26, 192.168.52.147, 44083, None)
19/09/08 18:12:16 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.3.154:43843 with 4.3 GB RAM, BlockManagerId(30, 192.168.3.154, 43843, None)
19/09/08 18:12:19 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:12:19 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.61.22:39714) with ID 33
19/09/08 18:12:19 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.27.158:48620) with ID 32
19/09/08 18:12:19 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.29.3:35342) with ID 31
19/09/08 18:12:19 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.48.239:56000) with ID 35
19/09/08 18:12:20 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.61.22:35201 with 4.3 GB RAM, BlockManagerId(33, 192.168.61.22, 35201, None)
19/09/08 18:12:20 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.27.158:45565 with 4.3 GB RAM, BlockManagerId(32, 192.168.27.158, 45565, None)
19/09/08 18:12:20 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.36.103:38228) with ID 34
19/09/08 18:12:20 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.29.3:37893 with 4.3 GB RAM, BlockManagerId(31, 192.168.29.3, 37893, None)
19/09/08 18:12:20 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.48.239:36899 with 4.3 GB RAM, BlockManagerId(35, 192.168.48.239, 36899, None)
19/09/08 18:12:20 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.36.103:36417 with 4.3 GB RAM, BlockManagerId(34, 192.168.36.103, 36417, None)
19/09/08 18:12:22 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:12:23 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.62.132:52378) with ID 36
19/09/08 18:12:23 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.27.207:54568) with ID 37
19/09/08 18:12:23 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.8.187:38196) with ID 38
19/09/08 18:12:23 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.22.77:38982) with ID 40
19/09/08 18:12:23 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.62.132:41079 with 4.3 GB RAM, BlockManagerId(36, 192.168.62.132, 41079, None)
19/09/08 18:12:23 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.27.207:46025 with 4.3 GB RAM, BlockManagerId(37, 192.168.27.207, 46025, None)
19/09/08 18:12:23 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.8.187:38363 with 4.3 GB RAM, BlockManagerId(38, 192.168.8.187, 38363, None)
19/09/08 18:12:23 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.22.77:40755 with 4.3 GB RAM, BlockManagerId(40, 192.168.22.77, 40755, None)
19/09/08 18:12:23 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.56.202:44080) with ID 39
19/09/08 18:12:23 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.56.202:36145 with 4.3 GB RAM, BlockManagerId(39, 192.168.56.202, 36145, None)
19/09/08 18:12:25 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:12:26 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.43.191:53610) with ID 41
19/09/08 18:12:26 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.22.218:36006) with ID 42
19/09/08 18:12:26 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.5.29:44298) with ID 45
19/09/08 18:12:26 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.11.61:48266) with ID 43
19/09/08 18:12:26 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.12.106:41248) with ID 44
19/09/08 18:12:26 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.43.191:38373 with 4.3 GB RAM, BlockManagerId(41, 192.168.43.191, 38373, None)
19/09/08 18:12:26 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.22.218:44813 with 4.3 GB RAM, BlockManagerId(42, 192.168.22.218, 44813, None)
19/09/08 18:12:26 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.5.29:44733 with 4.3 GB RAM, BlockManagerId(45, 192.168.5.29, 44733, None)
19/09/08 18:12:26 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.12.106:35263 with 4.3 GB RAM, BlockManagerId(44, 192.168.12.106, 35263, None)
19/09/08 18:12:26 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.11.61:38805 with 4.3 GB RAM, BlockManagerId(43, 192.168.11.61, 38805, None)
19/09/08 18:12:27 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:12:28 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.5.161:45298) with ID 50
19/09/08 18:12:28 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.9.199:35748) with ID 46
19/09/08 18:12:28 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.2.166:55564) with ID 47
19/09/08 18:12:28 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.45.144:46216) with ID 49
19/09/08 18:12:28 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.5.161:39545 with 4.3 GB RAM, BlockManagerId(50, 192.168.5.161, 39545, None)
19/09/08 18:12:28 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.9.199:37329 with 4.3 GB RAM, BlockManagerId(46, 192.168.9.199, 37329, None)
19/09/08 18:12:28 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.2.166:42401 with 4.3 GB RAM, BlockManagerId(47, 192.168.2.166, 42401, None)
19/09/08 18:12:28 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.45.144:43623 with 4.3 GB RAM, BlockManagerId(49, 192.168.45.144, 43623, None)
19/09/08 18:12:28 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.58.52:43454) with ID 48
19/09/08 18:12:28 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.58.52:38349 with 4.3 GB RAM, BlockManagerId(48, 192.168.58.52, 38349, None)
19/09/08 18:12:30 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:12:30 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.59.7:44716) with ID 52
19/09/08 18:12:30 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.20.209:32818) with ID 53
19/09/08 18:12:30 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.42.107:60438) with ID 55
19/09/08 18:12:30 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.59.7:38605 with 4.3 GB RAM, BlockManagerId(52, 192.168.59.7, 38605, None)
19/09/08 18:12:30 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.17.121:36402) with ID 54
19/09/08 18:12:30 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.20.209:34549 with 4.3 GB RAM, BlockManagerId(53, 192.168.20.209, 34549, None)
19/09/08 18:12:30 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.42.107:44035 with 4.3 GB RAM, BlockManagerId(55, 192.168.42.107, 44035, None)
19/09/08 18:12:30 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.17.121:37759 with 4.3 GB RAM, BlockManagerId(54, 192.168.17.121, 37759, None)
19/09/08 18:12:30 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.50.8:46186) with ID 51
19/09/08 18:12:30 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.50.8:39135 with 4.3 GB RAM, BlockManagerId(51, 192.168.50.8, 39135, None)
19/09/08 18:12:31 INFO KubernetesClusterSchedulerBackend: SchedulerBackend is ready for scheduling beginning after waiting maxRegisteredResourcesWaitingTime: 30000(ms)
Only WARN
Creating temporary table catalog_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/catalog_sales.
19/09/08 18:12:31 INFO TPCDSTables: Creating temporary table catalog_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/catalog_sales.
19/09/08 18:12:32 WARN MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-s3a-file-system.properties,hadoop-metrics2.properties
19/09/08 18:12:39 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
Creating temporary table catalog_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/catalog_returns.
19/09/08 18:12:39 INFO TPCDSTables: Creating temporary table catalog_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/catalog_returns.
Creating temporary table inventory using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/inventory.
19/09/08 18:12:42 INFO TPCDSTables: Creating temporary table inventory using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/inventory.
Creating temporary table store_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/store_sales.
19/09/08 18:12:45 INFO TPCDSTables: Creating temporary table store_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/store_sales.
Creating temporary table store_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/store_returns.
19/09/08 18:12:46 INFO TPCDSTables: Creating temporary table store_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/store_returns.
Creating temporary table web_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/web_sales.
19/09/08 18:12:49 INFO TPCDSTables: Creating temporary table web_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/web_sales.
Creating temporary table web_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/web_returns.
19/09/08 18:12:52 INFO TPCDSTables: Creating temporary table web_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/web_returns.
Creating temporary table call_center using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/call_center.
19/09/08 18:12:55 INFO TPCDSTables: Creating temporary table call_center using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/call_center.
Creating temporary table catalog_page using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/catalog_page.
19/09/08 18:12:58 INFO TPCDSTables: Creating temporary table catalog_page using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/catalog_page.
Creating temporary table customer using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/customer.
19/09/08 18:13:01 INFO TPCDSTables: Creating temporary table customer using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/customer.
Creating temporary table customer_address using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/customer_address.
19/09/08 18:13:04 INFO TPCDSTables: Creating temporary table customer_address using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/customer_address.
Creating temporary table customer_demographics using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/customer_demographics.
19/09/08 18:13:08 INFO TPCDSTables: Creating temporary table customer_demographics using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/customer_demographics.
Creating temporary table date_dim using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/date_dim.
19/09/08 18:13:11 INFO TPCDSTables: Creating temporary table date_dim using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/date_dim.
Creating temporary table household_demographics using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/household_demographics.
19/09/08 18:13:14 INFO TPCDSTables: Creating temporary table household_demographics using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/household_demographics.
Creating temporary table income_band using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/income_band.
19/09/08 18:13:17 INFO TPCDSTables: Creating temporary table income_band using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/income_band.
Creating temporary table item using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/item.
19/09/08 18:13:19 INFO TPCDSTables: Creating temporary table item using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/item.
Creating temporary table promotion using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/promotion.
19/09/08 18:13:23 INFO TPCDSTables: Creating temporary table promotion using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/promotion.
Creating temporary table reason using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/reason.
19/09/08 18:13:26 INFO TPCDSTables: Creating temporary table reason using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/reason.
Creating temporary table ship_mode using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/ship_mode.
19/09/08 18:13:28 INFO TPCDSTables: Creating temporary table ship_mode using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/ship_mode.
Creating temporary table store using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/store.
19/09/08 18:13:31 INFO TPCDSTables: Creating temporary table store using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/store.
Creating temporary table time_dim using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/time_dim.
19/09/08 18:13:34 INFO TPCDSTables: Creating temporary table time_dim using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/time_dim.
Creating temporary table warehouse using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/warehouse.
19/09/08 18:13:35 INFO TPCDSTables: Creating temporary table warehouse using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/warehouse.
Creating temporary table web_page using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/web_page.
19/09/08 18:13:35 INFO TPCDSTables: Creating temporary table web_page using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/web_page.
Creating temporary table web_site using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/web_site.
19/09/08 18:13:38 INFO TPCDSTables: Creating temporary table web_site using data stored in s3a://spark-k8s-data/TPCDS-TEST-100G/web_site.
Couldn't read table customer_total_return and its not defined as a Benchmark.Table.
Table store exists.
Table customer exists.
Couldn't read table wswscs and its not defined as a Benchmark.Table.
Table date_dim exists.
Table store_sales exists.
Table item exists.
Couldn't read table year_total and its not defined as a Benchmark.Table.
Couldn't read table ssr and its not defined as a Benchmark.Table.
Couldn't read table csr and its not defined as a Benchmark.Table.
Couldn't read table wsr and its not defined as a Benchmark.Table.
Table customer_address exists.
Table customer_demographics exists.
Table promotion exists.
Table reason exists.
Table web_sales exists.
Table household_demographics exists.
Table catalog_sales exists.
Table call_center exists.
Table store_returns exists.
Table inventory exists.
Table warehouse exists.
Couldn't read table ssales and its not defined as a Benchmark.Table.
Couldn't read table ss and its not defined as a Benchmark.Table.
Couldn't read table ws and its not defined as a Benchmark.Table.
Couldn't read table cs and its not defined as a Benchmark.Table.
Couldn't read table inv and its not defined as a Benchmark.Table.
Table catalog_returns exists.
Couldn't read table v2 and its not defined as a Benchmark.Table.
Table web_returns exists.
Couldn't read table web_v1 and its not defined as a Benchmark.Table.
Couldn't read table store_v1 and its not defined as a Benchmark.Table.
Couldn't read table segments and its not defined as a Benchmark.Table.
Couldn't read table ss_items and its not defined as a Benchmark.Table.
Couldn't read table cs_items and its not defined as a Benchmark.Table.
Couldn't read table ws_items and its not defined as a Benchmark.Table.
Couldn't read table wss and its not defined as a Benchmark.Table.
Table ship_mode exists.
Table web_site exists.
Couldn't read table cross_sales and its not defined as a Benchmark.Table.
Table time_dim exists.
Couldn't read table all_sales and its not defined as a Benchmark.Table.
Couldn't read table sr and its not defined as a Benchmark.Table.
Couldn't read table cr and its not defined as a Benchmark.Table.
Couldn't read table wr and its not defined as a Benchmark.Table.
Couldn't read table sr_items and its not defined as a Benchmark.Table.
Couldn't read table cr_items and its not defined as a Benchmark.Table.
Couldn't read table wr_items and its not defined as a Benchmark.Table.
Table income_band exists.
Table web_page exists.
Couldn't read table ssci and its not defined as a Benchmark.Table.
Couldn't read table csci and its not defined as a Benchmark.Table.
Running execution q1-v2.4 iteration: 1, StandardRun=true
19/09/08 18:13:51 INFO Query: 
== Query: q1-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_customer_id#413 ASC NULLS FIRST], true
      +- Project [c_customer_id#413]
         +- Filter (((cast(ctr_total_return#8593 as decimal(24,7)) > cast(scalar-subquery#8590 [ctr_store_sk#8592] as decimal(24,7))) && (s_store_sk#664 = ctr_store_sk#8592)) && ((s_state#688 = TN) && (ctr_customer_sk#8591 = c_customer_sk#412)))
            :  +- Aggregate [CheckOverflow((promote_precision(cast(avg(ctr_total_return#8593) as decimal(21,6))) * promote_precision(cast(1.2 as decimal(21,6)))), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#8596]
            :     +- Filter (outer(ctr_store_sk#8592) = ctr_store_sk#8592)
            :        +- SubqueryAlias `ctr2`
            :           +- SubqueryAlias `customer_total_return`
            :              +- Aggregate [sr_customer_sk#179, sr_store_sk#183], [sr_customer_sk#179 AS ctr_customer_sk#8591, sr_store_sk#183 AS ctr_store_sk#8592, sum(sr_return_amt#187) AS ctr_total_return#8593]
            :                 +- Filter ((sr_returned_date_sk#176 = d_date_sk#492) && (d_year#498 = 2000))
            :                    +- Join Inner
            :                       :- SubqueryAlias `store_returns`
            :                       :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
            :                       +- SubqueryAlias `date_dim`
            :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ctr1`
               :  :  +- SubqueryAlias `customer_total_return`
               :  :     +- Aggregate [sr_customer_sk#179, sr_store_sk#183], [sr_customer_sk#179 AS ctr_customer_sk#8591, sr_store_sk#183 AS ctr_store_sk#8592, sum(sr_return_amt#187) AS ctr_total_return#8593]
               :  :        +- Filter ((sr_returned_date_sk#176 = d_date_sk#492) && (d_year#498 = 2000))
               :  :           +- Join Inner
               :  :              :- SubqueryAlias `store_returns`
               :  :              :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :  :              +- SubqueryAlias `date_dim`
               :  :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store`
               :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               +- SubqueryAlias `customer`
                  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/09/08 18:13:51 INFO Query: 
== Query: q1-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_customer_id#413 ASC NULLS FIRST], true
      +- Project [c_customer_id#413]
         +- Filter (((cast(ctr_total_return#8601 as decimal(24,7)) > cast(scalar-subquery#8598 [ctr_store_sk#8600] as decimal(24,7))) && (s_store_sk#664 = ctr_store_sk#8600)) && ((s_state#688 = TN) && (ctr_customer_sk#8599 = c_customer_sk#412)))
            :  +- Aggregate [CheckOverflow((promote_precision(cast(avg(ctr_total_return#8601) as decimal(21,6))) * promote_precision(cast(1.2 as decimal(21,6)))), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#8604]
            :     +- Filter (outer(ctr_store_sk#8600) = ctr_store_sk#8600)
            :        +- SubqueryAlias `ctr2`
            :           +- SubqueryAlias `customer_total_return`
            :              +- Aggregate [sr_customer_sk#179, sr_store_sk#183], [sr_customer_sk#179 AS ctr_customer_sk#8599, sr_store_sk#183 AS ctr_store_sk#8600, sum(sr_return_amt#187) AS ctr_total_return#8601]
            :                 +- Filter ((sr_returned_date_sk#176 = d_date_sk#492) && (d_year#498 = 2000))
            :                    +- Join Inner
            :                       :- SubqueryAlias `store_returns`
            :                       :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
            :                       +- SubqueryAlias `date_dim`
            :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ctr1`
               :  :  +- SubqueryAlias `customer_total_return`
               :  :     +- Aggregate [sr_customer_sk#179, sr_store_sk#183], [sr_customer_sk#179 AS ctr_customer_sk#8599, sr_store_sk#183 AS ctr_store_sk#8600, sum(sr_return_amt#187) AS ctr_total_return#8601]
               :  :        +- Filter ((sr_returned_date_sk#176 = d_date_sk#492) && (d_year#498 = 2000))
               :  :           +- Join Inner
               :  :              :- SubqueryAlias `store_returns`
               :  :              :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :  :              +- SubqueryAlias `date_dim`
               :  :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store`
               :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               +- SubqueryAlias `customer`
                  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 23.286073167999998s
Running execution q2-v2.4 iteration: 1, StandardRun=true
19/09/08 18:14:16 INFO Query: 
== Query: q2-v2.4 ==
Sort [d_week_seq1#8781 ASC NULLS FIRST], true
+- Project [d_week_seq1#8781, round(CheckOverflow((promote_precision(cast(sun_sales1#8782 as decimal(17,2))) / promote_precision(cast(sun_sales2#8790 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((sun_sales1 / sun_sales2), 2)#8871, round(CheckOverflow((promote_precision(cast(mon_sales1#8783 as decimal(17,2))) / promote_precision(cast(mon_sales2#8791 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((mon_sales1 / mon_sales2), 2)#8872, round(CheckOverflow((promote_precision(cast(tue_sales1#8784 as decimal(17,2))) / promote_precision(cast(tue_sales2#8792 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((tue_sales1 / tue_sales2), 2)#8873, round(CheckOverflow((promote_precision(cast(wed_sales1#8785 as decimal(17,2))) / promote_precision(cast(wed_sales2#8793 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((wed_sales1 / wed_sales2), 2)#8874, round(CheckOverflow((promote_precision(cast(thu_sales1#8786 as decimal(17,2))) / promote_precision(cast(thu_sales2#8794 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((thu_sales1 / thu_sales2), 2)#8875, round(CheckOverflow((promote_precision(cast(fri_sales1#8787 as decimal(17,2))) / promote_precision(cast(fri_sales2#8795 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((fri_sales1 / fri_sales2), 2)#8876, round(CheckOverflow((promote_precision(cast(sat_sales1#8788 as decimal(17,2))) / promote_precision(cast(sat_sales2#8796 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((sat_sales1 / sat_sales2), 2)#8877]
   +- Filter (d_week_seq1#8781 = (d_week_seq2#8789 - 53))
      +- Join Inner
         :- SubqueryAlias `y`
         :  +- Project [d_week_seq#496 AS d_week_seq1#8781, sun_sales#8801 AS sun_sales1#8782, mon_sales#8802 AS mon_sales1#8783, tue_sales#8803 AS tue_sales1#8784, wed_sales#8804 AS wed_sales1#8785, thu_sales#8805 AS thu_sales1#8786, fri_sales#8806 AS fri_sales1#8787, sat_sales#8807 AS sat_sales1#8788]
         :     +- Filter ((d_week_seq#8819 = d_week_seq#496) && (d_year#8821 = 2001))
         :        +- Join Inner
         :           :- SubqueryAlias `wswscs`
         :           :  +- Aggregate [d_week_seq#496], [d_week_seq#496, sum(CASE WHEN (d_day_name#506 = Sunday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS sun_sales#8801, sum(CASE WHEN (d_day_name#506 = Monday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS mon_sales#8802, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS tue_sales#8803, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS wed_sales#8804, sum(CASE WHEN (d_day_name#506 = Thursday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS thu_sales#8805, sum(CASE WHEN (d_day_name#506 = Friday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS fri_sales#8806, sum(CASE WHEN (d_day_name#506 = Saturday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS sat_sales#8807]
         :           :     +- Filter (d_date_sk#492 = sold_date_sk#8797)
         :           :        +- Join Inner
         :           :           :- SubqueryAlias `wscs`
         :           :           :  +- Project [sold_date_sk#8797, sales_price#8798]
         :           :           :     +- SubqueryAlias `x`
         :           :           :        +- Union
         :           :           :           :- Project [ws_sold_date_sk#216 AS sold_date_sk#8797, ws_ext_sales_price#239 AS sales_price#8798]
         :           :           :           :  +- SubqueryAlias `web_sales`
         :           :           :           :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
         :           :           :           +- Project [cs_sold_date_sk#0 AS sold_date_sk#8799, cs_ext_sales_price#23 AS sales_price#8800]
         :           :           :              +- SubqueryAlias `catalog_sales`
         :           :           :                 +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :           :           +- SubqueryAlias `date_dim`
         :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :           +- SubqueryAlias `date_dim`
         :              +- Relation[d_date_sk#8815,d_date_id#8816,d_date#8817,d_month_seq#8818,d_week_seq#8819,d_quarter_seq#8820,d_year#8821,d_dow#8822,d_moy#8823,d_dom#8824,d_qoy#8825,d_fy_year#8826,d_fy_quarter_seq#8827,d_fy_week_seq#8828,d_day_name#8829,d_quarter_name#8830,d_holiday#8831,d_weekend#8832,d_following_holiday#8833,d_first_dom#8834,d_last_dom#8835,d_same_day_ly#8836,d_same_day_lq#8837,d_current_day#8838,... 4 more fields] parquet
         +- SubqueryAlias `z`
            +- Project [d_week_seq#496 AS d_week_seq2#8789, sun_sales#8801 AS sun_sales2#8790, mon_sales#8802 AS mon_sales2#8791, tue_sales#8803 AS tue_sales2#8792, wed_sales#8804 AS wed_sales2#8793, thu_sales#8805 AS thu_sales2#8794, fri_sales#8806 AS fri_sales2#8795, sat_sales#8807 AS sat_sales2#8796]
               +- Filter ((d_week_seq#8847 = d_week_seq#496) && (d_year#8849 = (2001 + 1)))
                  +- Join Inner
                     :- SubqueryAlias `wswscs`
                     :  +- Aggregate [d_week_seq#496], [d_week_seq#496, sum(CASE WHEN (d_day_name#506 = Sunday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS sun_sales#8801, sum(CASE WHEN (d_day_name#506 = Monday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS mon_sales#8802, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS tue_sales#8803, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS wed_sales#8804, sum(CASE WHEN (d_day_name#506 = Thursday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS thu_sales#8805, sum(CASE WHEN (d_day_name#506 = Friday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS fri_sales#8806, sum(CASE WHEN (d_day_name#506 = Saturday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS sat_sales#8807]
                     :     +- Filter (d_date_sk#492 = sold_date_sk#8797)
                     :        +- Join Inner
                     :           :- SubqueryAlias `wscs`
                     :           :  +- Project [sold_date_sk#8797, sales_price#8798]
                     :           :     +- SubqueryAlias `x`
                     :           :        +- Union
                     :           :           :- Project [ws_sold_date_sk#216 AS sold_date_sk#8797, ws_ext_sales_price#239 AS sales_price#8798]
                     :           :           :  +- SubqueryAlias `web_sales`
                     :           :           :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :           :           +- Project [cs_sold_date_sk#0 AS sold_date_sk#8799, cs_ext_sales_price#23 AS sales_price#8800]
                     :           :              +- SubqueryAlias `catalog_sales`
                     :           :                 +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :           +- SubqueryAlias `date_dim`
                     :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#8843,d_date_id#8844,d_date#8845,d_month_seq#8846,d_week_seq#8847,d_quarter_seq#8848,d_year#8849,d_dow#8850,d_moy#8851,d_dom#8852,d_qoy#8853,d_fy_year#8854,d_fy_quarter_seq#8855,d_fy_week_seq#8856,d_day_name#8857,d_quarter_name#8858,d_holiday#8859,d_weekend#8860,d_following_holiday#8861,d_first_dom#8862,d_last_dom#8863,d_same_day_ly#8864,d_same_day_lq#8865,d_current_day#8866,... 4 more fields] parquet

     : benchmark
19/09/08 18:14:16 INFO Query: 
== Query: q2-v2.4 ==
Sort [d_week_seq1#8886 ASC NULLS FIRST], true
+- Project [d_week_seq1#8886, round(CheckOverflow((promote_precision(cast(sun_sales1#8887 as decimal(17,2))) / promote_precision(cast(sun_sales2#8895 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((sun_sales1 / sun_sales2), 2)#8976, round(CheckOverflow((promote_precision(cast(mon_sales1#8888 as decimal(17,2))) / promote_precision(cast(mon_sales2#8896 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((mon_sales1 / mon_sales2), 2)#8977, round(CheckOverflow((promote_precision(cast(tue_sales1#8889 as decimal(17,2))) / promote_precision(cast(tue_sales2#8897 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((tue_sales1 / tue_sales2), 2)#8978, round(CheckOverflow((promote_precision(cast(wed_sales1#8890 as decimal(17,2))) / promote_precision(cast(wed_sales2#8898 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((wed_sales1 / wed_sales2), 2)#8979, round(CheckOverflow((promote_precision(cast(thu_sales1#8891 as decimal(17,2))) / promote_precision(cast(thu_sales2#8899 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((thu_sales1 / thu_sales2), 2)#8980, round(CheckOverflow((promote_precision(cast(fri_sales1#8892 as decimal(17,2))) / promote_precision(cast(fri_sales2#8900 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((fri_sales1 / fri_sales2), 2)#8981, round(CheckOverflow((promote_precision(cast(sat_sales1#8893 as decimal(17,2))) / promote_precision(cast(sat_sales2#8901 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((sat_sales1 / sat_sales2), 2)#8982]
   +- Filter (d_week_seq1#8886 = (d_week_seq2#8894 - 53))
      +- Join Inner
         :- SubqueryAlias `y`
         :  +- Project [d_week_seq#496 AS d_week_seq1#8886, sun_sales#8906 AS sun_sales1#8887, mon_sales#8907 AS mon_sales1#8888, tue_sales#8908 AS tue_sales1#8889, wed_sales#8909 AS wed_sales1#8890, thu_sales#8910 AS thu_sales1#8891, fri_sales#8911 AS fri_sales1#8892, sat_sales#8912 AS sat_sales1#8893]
         :     +- Filter ((d_week_seq#8924 = d_week_seq#496) && (d_year#8926 = 2001))
         :        +- Join Inner
         :           :- SubqueryAlias `wswscs`
         :           :  +- Aggregate [d_week_seq#496], [d_week_seq#496, sum(CASE WHEN (d_day_name#506 = Sunday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS sun_sales#8906, sum(CASE WHEN (d_day_name#506 = Monday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS mon_sales#8907, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS tue_sales#8908, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS wed_sales#8909, sum(CASE WHEN (d_day_name#506 = Thursday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS thu_sales#8910, sum(CASE WHEN (d_day_name#506 = Friday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS fri_sales#8911, sum(CASE WHEN (d_day_name#506 = Saturday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS sat_sales#8912]
         :           :     +- Filter (d_date_sk#492 = sold_date_sk#8902)
         :           :        +- Join Inner
         :           :           :- SubqueryAlias `wscs`
         :           :           :  +- Project [sold_date_sk#8902, sales_price#8903]
         :           :           :     +- SubqueryAlias `x`
         :           :           :        +- Union
         :           :           :           :- Project [ws_sold_date_sk#216 AS sold_date_sk#8902, ws_ext_sales_price#239 AS sales_price#8903]
         :           :           :           :  +- SubqueryAlias `web_sales`
         :           :           :           :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
         :           :           :           +- Project [cs_sold_date_sk#0 AS sold_date_sk#8904, cs_ext_sales_price#23 AS sales_price#8905]
         :           :           :              +- SubqueryAlias `catalog_sales`
         :           :           :                 +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :           :           +- SubqueryAlias `date_dim`
         :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :           +- SubqueryAlias `date_dim`
         :              +- Relation[d_date_sk#8920,d_date_id#8921,d_date#8922,d_month_seq#8923,d_week_seq#8924,d_quarter_seq#8925,d_year#8926,d_dow#8927,d_moy#8928,d_dom#8929,d_qoy#8930,d_fy_year#8931,d_fy_quarter_seq#8932,d_fy_week_seq#8933,d_day_name#8934,d_quarter_name#8935,d_holiday#8936,d_weekend#8937,d_following_holiday#8938,d_first_dom#8939,d_last_dom#8940,d_same_day_ly#8941,d_same_day_lq#8942,d_current_day#8943,... 4 more fields] parquet
         +- SubqueryAlias `z`
            +- Project [d_week_seq#496 AS d_week_seq2#8894, sun_sales#8906 AS sun_sales2#8895, mon_sales#8907 AS mon_sales2#8896, tue_sales#8908 AS tue_sales2#8897, wed_sales#8909 AS wed_sales2#8898, thu_sales#8910 AS thu_sales2#8899, fri_sales#8911 AS fri_sales2#8900, sat_sales#8912 AS sat_sales2#8901]
               +- Filter ((d_week_seq#8952 = d_week_seq#496) && (d_year#8954 = (2001 + 1)))
                  +- Join Inner
                     :- SubqueryAlias `wswscs`
                     :  +- Aggregate [d_week_seq#496], [d_week_seq#496, sum(CASE WHEN (d_day_name#506 = Sunday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS sun_sales#8906, sum(CASE WHEN (d_day_name#506 = Monday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS mon_sales#8907, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS tue_sales#8908, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS wed_sales#8909, sum(CASE WHEN (d_day_name#506 = Thursday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS thu_sales#8910, sum(CASE WHEN (d_day_name#506 = Friday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS fri_sales#8911, sum(CASE WHEN (d_day_name#506 = Saturday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS sat_sales#8912]
                     :     +- Filter (d_date_sk#492 = sold_date_sk#8902)
                     :        +- Join Inner
                     :           :- SubqueryAlias `wscs`
                     :           :  +- Project [sold_date_sk#8902, sales_price#8903]
                     :           :     +- SubqueryAlias `x`
                     :           :        +- Union
                     :           :           :- Project [ws_sold_date_sk#216 AS sold_date_sk#8902, ws_ext_sales_price#239 AS sales_price#8903]
                     :           :           :  +- SubqueryAlias `web_sales`
                     :           :           :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :           :           +- Project [cs_sold_date_sk#0 AS sold_date_sk#8904, cs_ext_sales_price#23 AS sales_price#8905]
                     :           :              +- SubqueryAlias `catalog_sales`
                     :           :                 +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :           +- SubqueryAlias `date_dim`
                     :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#8948,d_date_id#8949,d_date#8950,d_month_seq#8951,d_week_seq#8952,d_quarter_seq#8953,d_year#8954,d_dow#8955,d_moy#8956,d_dom#8957,d_qoy#8958,d_fy_year#8959,d_fy_quarter_seq#8960,d_fy_week_seq#8961,d_day_name#8962,d_quarter_name#8963,d_holiday#8964,d_weekend#8965,d_following_holiday#8966,d_first_dom#8967,d_last_dom#8968,d_same_day_ly#8969,d_same_day_lq#8970,d_current_day#8971,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 7.677093639s
Running execution q3-v2.4 iteration: 1, StandardRun=true
19/09/08 18:14:25 INFO Query: 
== Query: q3-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [d_year#498 ASC NULLS FIRST, sum_agg#9259 DESC NULLS LAST, brand_id#9257 ASC NULLS FIRST], true
      +- Aggregate [d_year#498, i_brand#572, i_brand_id#571], [d_year#498, i_brand_id#571 AS brand_id#9257, i_brand#572 AS brand#9258, sum(ss_ext_sales_price#145) AS sum_agg#9259]
         +- Filter (((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && ((i_manufact_id#577 = 128) && (d_moy#500 = 11)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dt`
               :  :  +- SubqueryAlias `date_dim`
               :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:14:25 INFO Query: 
== Query: q3-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [d_year#498 ASC NULLS FIRST, sum_agg#9270 DESC NULLS LAST, brand_id#9268 ASC NULLS FIRST], true
      +- Aggregate [d_year#498, i_brand#572, i_brand_id#571], [d_year#498, i_brand_id#571 AS brand_id#9268, i_brand#572 AS brand#9269, sum(ss_ext_sales_price#145) AS sum_agg#9270]
         +- Filter (((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && ((i_manufact_id#577 = 128) && (d_moy#500 = 11)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dt`
               :  :  +- SubqueryAlias `date_dim`
               :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 3.731308309s
Running execution q4-v2.4 iteration: 1, StandardRun=true
19/09/08 18:14:32 INFO Query: 
== Query: q4-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#9447 ASC NULLS FIRST, customer_first_name#9448 ASC NULLS FIRST, customer_last_name#9449 ASC NULLS FIRST, customer_preferred_cust_flag#9450 ASC NULLS FIRST], true
      +- Project [customer_id#9447, customer_first_name#9448, customer_last_name#9449, customer_preferred_cust_flag#9450]
         +- Filter ((((((customer_id#9447 = customer_id#9414) && (customer_id#9414 = customer_id#9467)) && (customer_id#9414 = customer_id#9457)) && (((customer_id#9414 = customer_id#9477) && (customer_id#9414 = customer_id#9487)) && (sale_type#9423 = s))) && ((((sale_type#9466 = c) && (sale_type#9486 = w)) && (sale_type#9456 = s)) && ((sale_type#9476 = c) && (sale_type#9496 = w)))) && (((((dyear#9421 = 2001) && (dyear#9454 = (2001 + 1))) && (dyear#9464 = 2001)) && (((dyear#9474 = (2001 + 1)) && (dyear#9484 = 2001)) && (dyear#9494 = (2001 + 1)))) && ((((cast(year_total#9422 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) && (cast(year_total#9465 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6)))) && (cast(year_total#9485 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6)))) && ((CASE WHEN (cast(year_total#9465 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9475 as decimal(24,6))) / promote_precision(cast(year_total#9465 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END > CASE WHEN (cast(year_total#9422 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9455 as decimal(24,6))) / promote_precision(cast(year_total#9422 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END) && (CASE WHEN (cast(year_total#9465 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9475 as decimal(24,6))) / promote_precision(cast(year_total#9465 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END > CASE WHEN (cast(year_total#9485 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9495 as decimal(24,6))) / promote_precision(cast(year_total#9485 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END)))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- Join Inner
               :  :  :  :- Join Inner
               :  :  :  :  :- SubqueryAlias `t_s_firstyear`
               :  :  :  :  :  +- SubqueryAlias `year_total`
               :  :  :  :  :     +- Union
               :  :  :  :  :        :- Union
               :  :  :  :  :        :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9414, c_first_name#420 AS customer_first_name#9415, c_last_name#421 AS customer_last_name#9416, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9417, c_birth_country#426 AS customer_birth_country#9418, c_login#427 AS customer_login#9419, c_email_address#428 AS customer_email_address#9420, d_year#498 AS dyear#9421, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9422, s AS sale_type#9423]
               :  :  :  :  :        :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :  :  :        :  :     +- Join Inner
               :  :  :  :  :        :  :        :- Join Inner
               :  :  :  :  :        :  :        :  :- SubqueryAlias `customer`
               :  :  :  :  :        :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :  :        :  :        :  +- SubqueryAlias `store_sales`
               :  :  :  :  :        :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  :  :        :  :        +- SubqueryAlias `date_dim`
               :  :  :  :  :        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  :        :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9424, c_first_name#420 AS customer_first_name#9425, c_last_name#421 AS customer_last_name#9426, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9427, c_birth_country#426 AS customer_birth_country#9428, c_login#427 AS customer_login#9429, c_email_address#428 AS customer_email_address#9430, d_year#498 AS dyear#9431, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9432, c AS sale_type#9433]
               :  :  :  :  :        :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :  :  :  :        :        +- Join Inner
               :  :  :  :  :        :           :- Join Inner
               :  :  :  :  :        :           :  :- SubqueryAlias `customer`
               :  :  :  :  :        :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :  :        :           :  +- SubqueryAlias `catalog_sales`
               :  :  :  :  :        :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :  :        :           +- SubqueryAlias `date_dim`
               :  :  :  :  :        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  :        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9434, c_first_name#420 AS customer_first_name#9435, c_last_name#421 AS customer_last_name#9436, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9437, c_birth_country#426 AS customer_birth_country#9438, c_login#427 AS customer_login#9439, c_email_address#428 AS customer_email_address#9440, d_year#498 AS dyear#9441, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9442, w AS sale_type#9443]
               :  :  :  :  :           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :  :  :              +- Join Inner
               :  :  :  :  :                 :- Join Inner
               :  :  :  :  :                 :  :- SubqueryAlias `customer`
               :  :  :  :  :                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :  :                 :  +- SubqueryAlias `web_sales`
               :  :  :  :  :                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :  :  :                 +- SubqueryAlias `date_dim`
               :  :  :  :  :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  +- SubqueryAlias `t_s_secyear`
               :  :  :  :     +- SubqueryAlias `year_total`
               :  :  :  :        +- Union
               :  :  :  :           :- Union
               :  :  :  :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9447, c_first_name#420 AS customer_first_name#9448, c_last_name#421 AS customer_last_name#9449, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9450, c_birth_country#426 AS customer_birth_country#9451, c_login#427 AS customer_login#9452, c_email_address#428 AS customer_email_address#9453, d_year#498 AS dyear#9454, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9455, s AS sale_type#9456]
               :  :  :  :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :  :           :  :     +- Join Inner
               :  :  :  :           :  :        :- Join Inner
               :  :  :  :           :  :        :  :- SubqueryAlias `customer`
               :  :  :  :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :           :  :        :  +- SubqueryAlias `store_sales`
               :  :  :  :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  :           :  :        +- SubqueryAlias `date_dim`
               :  :  :  :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9424, c_first_name#420 AS customer_first_name#9425, c_last_name#421 AS customer_last_name#9426, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9427, c_birth_country#426 AS customer_birth_country#9428, c_login#427 AS customer_login#9429, c_email_address#428 AS customer_email_address#9430, d_year#498 AS dyear#9431, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9432, c AS sale_type#9433]
               :  :  :  :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :  :  :           :        +- Join Inner
               :  :  :  :           :           :- Join Inner
               :  :  :  :           :           :  :- SubqueryAlias `customer`
               :  :  :  :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :           :           :  +- SubqueryAlias `catalog_sales`
               :  :  :  :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :           :           +- SubqueryAlias `date_dim`
               :  :  :  :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9434, c_first_name#420 AS customer_first_name#9435, c_last_name#421 AS customer_last_name#9436, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9437, c_birth_country#426 AS customer_birth_country#9438, c_login#427 AS customer_login#9439, c_email_address#428 AS customer_email_address#9440, d_year#498 AS dyear#9441, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9442, w AS sale_type#9443]
               :  :  :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :  :                 +- Join Inner
               :  :  :  :                    :- Join Inner
               :  :  :  :                    :  :- SubqueryAlias `customer`
               :  :  :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :                    :  +- SubqueryAlias `web_sales`
               :  :  :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :  :                    +- SubqueryAlias `date_dim`
               :  :  :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  +- SubqueryAlias `t_c_firstyear`
               :  :  :     +- SubqueryAlias `year_total`
               :  :  :        +- Union
               :  :  :           :- Union
               :  :  :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9457, c_first_name#420 AS customer_first_name#9458, c_last_name#421 AS customer_last_name#9459, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9460, c_birth_country#426 AS customer_birth_country#9461, c_login#427 AS customer_login#9462, c_email_address#428 AS customer_email_address#9463, d_year#498 AS dyear#9464, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9465, s AS sale_type#9466]
               :  :  :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :           :  :     +- Join Inner
               :  :  :           :  :        :- Join Inner
               :  :  :           :  :        :  :- SubqueryAlias `customer`
               :  :  :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :           :  :        :  +- SubqueryAlias `store_sales`
               :  :  :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :           :  :        +- SubqueryAlias `date_dim`
               :  :  :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9424, c_first_name#420 AS customer_first_name#9425, c_last_name#421 AS customer_last_name#9426, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9427, c_birth_country#426 AS customer_birth_country#9428, c_login#427 AS customer_login#9429, c_email_address#428 AS customer_email_address#9430, d_year#498 AS dyear#9431, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9432, c AS sale_type#9433]
               :  :  :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :  :           :        +- Join Inner
               :  :  :           :           :- Join Inner
               :  :  :           :           :  :- SubqueryAlias `customer`
               :  :  :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :           :           :  +- SubqueryAlias `catalog_sales`
               :  :  :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :           :           +- SubqueryAlias `date_dim`
               :  :  :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9434, c_first_name#420 AS customer_first_name#9435, c_last_name#421 AS customer_last_name#9436, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9437, c_birth_country#426 AS customer_birth_country#9438, c_login#427 AS customer_login#9439, c_email_address#428 AS customer_email_address#9440, d_year#498 AS dyear#9441, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9442, w AS sale_type#9443]
               :  :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :                 +- Join Inner
               :  :  :                    :- Join Inner
               :  :  :                    :  :- SubqueryAlias `customer`
               :  :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :                    :  +- SubqueryAlias `web_sales`
               :  :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :                    +- SubqueryAlias `date_dim`
               :  :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  +- SubqueryAlias `t_c_secyear`
               :  :     +- SubqueryAlias `year_total`
               :  :        +- Union
               :  :           :- Union
               :  :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9467, c_first_name#420 AS customer_first_name#9468, c_last_name#421 AS customer_last_name#9469, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9470, c_birth_country#426 AS customer_birth_country#9471, c_login#427 AS customer_login#9472, c_email_address#428 AS customer_email_address#9473, d_year#498 AS dyear#9474, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9475, s AS sale_type#9476]
               :  :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :           :  :     +- Join Inner
               :  :           :  :        :- Join Inner
               :  :           :  :        :  :- SubqueryAlias `customer`
               :  :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :  :        :  +- SubqueryAlias `store_sales`
               :  :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  :        +- SubqueryAlias `date_dim`
               :  :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9424, c_first_name#420 AS customer_first_name#9425, c_last_name#421 AS customer_last_name#9426, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9427, c_birth_country#426 AS customer_birth_country#9428, c_login#427 AS customer_login#9429, c_email_address#428 AS customer_email_address#9430, d_year#498 AS dyear#9431, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9432, c AS sale_type#9433]
               :  :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :           :        +- Join Inner
               :  :           :           :- Join Inner
               :  :           :           :  :- SubqueryAlias `customer`
               :  :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :           :  +- SubqueryAlias `catalog_sales`
               :  :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :           :           +- SubqueryAlias `date_dim`
               :  :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9434, c_first_name#420 AS customer_first_name#9435, c_last_name#421 AS customer_last_name#9436, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9437, c_birth_country#426 AS customer_birth_country#9438, c_login#427 AS customer_login#9439, c_email_address#428 AS customer_email_address#9440, d_year#498 AS dyear#9441, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9442, w AS sale_type#9443]
               :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :                 +- Join Inner
               :  :                    :- Join Inner
               :  :                    :  :- SubqueryAlias `customer`
               :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :                    :  +- SubqueryAlias `web_sales`
               :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :                    +- SubqueryAlias `date_dim`
               :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `t_w_firstyear`
               :     +- SubqueryAlias `year_total`
               :        +- Union
               :           :- Union
               :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9477, c_first_name#420 AS customer_first_name#9478, c_last_name#421 AS customer_last_name#9479, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9480, c_birth_country#426 AS customer_birth_country#9481, c_login#427 AS customer_login#9482, c_email_address#428 AS customer_email_address#9483, d_year#498 AS dyear#9484, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9485, s AS sale_type#9486]
               :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :           :  :     +- Join Inner
               :           :  :        :- Join Inner
               :           :  :        :  :- SubqueryAlias `customer`
               :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :  :        :  +- SubqueryAlias `store_sales`
               :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :  :        +- SubqueryAlias `date_dim`
               :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9424, c_first_name#420 AS customer_first_name#9425, c_last_name#421 AS customer_last_name#9426, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9427, c_birth_country#426 AS customer_birth_country#9428, c_login#427 AS customer_login#9429, c_email_address#428 AS customer_email_address#9430, d_year#498 AS dyear#9431, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9432, c AS sale_type#9433]
               :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :           :        +- Join Inner
               :           :           :- Join Inner
               :           :           :  :- SubqueryAlias `customer`
               :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :           :  +- SubqueryAlias `catalog_sales`
               :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :           :           +- SubqueryAlias `date_dim`
               :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9434, c_first_name#420 AS customer_first_name#9435, c_last_name#421 AS customer_last_name#9436, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9437, c_birth_country#426 AS customer_birth_country#9438, c_login#427 AS customer_login#9439, c_email_address#428 AS customer_email_address#9440, d_year#498 AS dyear#9441, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9442, w AS sale_type#9443]
               :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :                 +- Join Inner
               :                    :- Join Inner
               :                    :  :- SubqueryAlias `customer`
               :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :                    :  +- SubqueryAlias `web_sales`
               :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `t_w_secyear`
                  +- SubqueryAlias `year_total`
                     +- Union
                        :- Union
                        :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9487, c_first_name#420 AS customer_first_name#9488, c_last_name#421 AS customer_last_name#9489, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9490, c_birth_country#426 AS customer_birth_country#9491, c_login#427 AS customer_login#9492, c_email_address#428 AS customer_email_address#9493, d_year#498 AS dyear#9494, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9495, s AS sale_type#9496]
                        :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
                        :  :     +- Join Inner
                        :  :        :- Join Inner
                        :  :        :  :- SubqueryAlias `customer`
                        :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :        :  +- SubqueryAlias `store_sales`
                        :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :        +- SubqueryAlias `date_dim`
                        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9424, c_first_name#420 AS customer_first_name#9425, c_last_name#421 AS customer_last_name#9426, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9427, c_birth_country#426 AS customer_birth_country#9428, c_login#427 AS customer_login#9429, c_email_address#428 AS customer_email_address#9430, d_year#498 AS dyear#9431, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9432, c AS sale_type#9433]
                        :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
                        :        +- Join Inner
                        :           :- Join Inner
                        :           :  :- SubqueryAlias `customer`
                        :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :           :  +- SubqueryAlias `catalog_sales`
                        :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :           +- SubqueryAlias `date_dim`
                        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9434, c_first_name#420 AS customer_first_name#9435, c_last_name#421 AS customer_last_name#9436, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9437, c_birth_country#426 AS customer_birth_country#9438, c_login#427 AS customer_login#9439, c_email_address#428 AS customer_email_address#9440, d_year#498 AS dyear#9441, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9442, w AS sale_type#9443]
                           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `customer`
                                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                                 :  +- SubqueryAlias `web_sales`
                                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:14:32 INFO Query: 
== Query: q4-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#9534 ASC NULLS FIRST, customer_first_name#9535 ASC NULLS FIRST, customer_last_name#9536 ASC NULLS FIRST, customer_preferred_cust_flag#9537 ASC NULLS FIRST], true
      +- Project [customer_id#9534, customer_first_name#9535, customer_last_name#9536, customer_preferred_cust_flag#9537]
         +- Filter ((((((customer_id#9534 = customer_id#9501) && (customer_id#9501 = customer_id#9554)) && (customer_id#9501 = customer_id#9544)) && (((customer_id#9501 = customer_id#9564) && (customer_id#9501 = customer_id#9574)) && (sale_type#9510 = s))) && ((((sale_type#9553 = c) && (sale_type#9573 = w)) && (sale_type#9543 = s)) && ((sale_type#9563 = c) && (sale_type#9583 = w)))) && (((((dyear#9508 = 2001) && (dyear#9541 = (2001 + 1))) && (dyear#9551 = 2001)) && (((dyear#9561 = (2001 + 1)) && (dyear#9571 = 2001)) && (dyear#9581 = (2001 + 1)))) && ((((cast(year_total#9509 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) && (cast(year_total#9552 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6)))) && (cast(year_total#9572 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6)))) && ((CASE WHEN (cast(year_total#9552 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9562 as decimal(24,6))) / promote_precision(cast(year_total#9552 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END > CASE WHEN (cast(year_total#9509 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9542 as decimal(24,6))) / promote_precision(cast(year_total#9509 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END) && (CASE WHEN (cast(year_total#9552 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9562 as decimal(24,6))) / promote_precision(cast(year_total#9552 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END > CASE WHEN (cast(year_total#9572 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9582 as decimal(24,6))) / promote_precision(cast(year_total#9572 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END)))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- Join Inner
               :  :  :  :- Join Inner
               :  :  :  :  :- SubqueryAlias `t_s_firstyear`
               :  :  :  :  :  +- SubqueryAlias `year_total`
               :  :  :  :  :     +- Union
               :  :  :  :  :        :- Union
               :  :  :  :  :        :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9501, c_first_name#420 AS customer_first_name#9502, c_last_name#421 AS customer_last_name#9503, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9504, c_birth_country#426 AS customer_birth_country#9505, c_login#427 AS customer_login#9506, c_email_address#428 AS customer_email_address#9507, d_year#498 AS dyear#9508, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9509, s AS sale_type#9510]
               :  :  :  :  :        :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :  :  :        :  :     +- Join Inner
               :  :  :  :  :        :  :        :- Join Inner
               :  :  :  :  :        :  :        :  :- SubqueryAlias `customer`
               :  :  :  :  :        :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :  :        :  :        :  +- SubqueryAlias `store_sales`
               :  :  :  :  :        :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  :  :        :  :        +- SubqueryAlias `date_dim`
               :  :  :  :  :        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  :        :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9511, c_first_name#420 AS customer_first_name#9512, c_last_name#421 AS customer_last_name#9513, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9514, c_birth_country#426 AS customer_birth_country#9515, c_login#427 AS customer_login#9516, c_email_address#428 AS customer_email_address#9517, d_year#498 AS dyear#9518, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9519, c AS sale_type#9520]
               :  :  :  :  :        :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :  :  :  :        :        +- Join Inner
               :  :  :  :  :        :           :- Join Inner
               :  :  :  :  :        :           :  :- SubqueryAlias `customer`
               :  :  :  :  :        :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :  :        :           :  +- SubqueryAlias `catalog_sales`
               :  :  :  :  :        :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :  :        :           +- SubqueryAlias `date_dim`
               :  :  :  :  :        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  :        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9521, c_first_name#420 AS customer_first_name#9522, c_last_name#421 AS customer_last_name#9523, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9524, c_birth_country#426 AS customer_birth_country#9525, c_login#427 AS customer_login#9526, c_email_address#428 AS customer_email_address#9527, d_year#498 AS dyear#9528, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9529, w AS sale_type#9530]
               :  :  :  :  :           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :  :  :              +- Join Inner
               :  :  :  :  :                 :- Join Inner
               :  :  :  :  :                 :  :- SubqueryAlias `customer`
               :  :  :  :  :                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :  :                 :  +- SubqueryAlias `web_sales`
               :  :  :  :  :                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :  :  :                 +- SubqueryAlias `date_dim`
               :  :  :  :  :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  +- SubqueryAlias `t_s_secyear`
               :  :  :  :     +- SubqueryAlias `year_total`
               :  :  :  :        +- Union
               :  :  :  :           :- Union
               :  :  :  :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9534, c_first_name#420 AS customer_first_name#9535, c_last_name#421 AS customer_last_name#9536, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9537, c_birth_country#426 AS customer_birth_country#9538, c_login#427 AS customer_login#9539, c_email_address#428 AS customer_email_address#9540, d_year#498 AS dyear#9541, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9542, s AS sale_type#9543]
               :  :  :  :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :  :           :  :     +- Join Inner
               :  :  :  :           :  :        :- Join Inner
               :  :  :  :           :  :        :  :- SubqueryAlias `customer`
               :  :  :  :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :           :  :        :  +- SubqueryAlias `store_sales`
               :  :  :  :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  :           :  :        +- SubqueryAlias `date_dim`
               :  :  :  :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9511, c_first_name#420 AS customer_first_name#9512, c_last_name#421 AS customer_last_name#9513, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9514, c_birth_country#426 AS customer_birth_country#9515, c_login#427 AS customer_login#9516, c_email_address#428 AS customer_email_address#9517, d_year#498 AS dyear#9518, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9519, c AS sale_type#9520]
               :  :  :  :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :  :  :           :        +- Join Inner
               :  :  :  :           :           :- Join Inner
               :  :  :  :           :           :  :- SubqueryAlias `customer`
               :  :  :  :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :           :           :  +- SubqueryAlias `catalog_sales`
               :  :  :  :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :           :           +- SubqueryAlias `date_dim`
               :  :  :  :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9521, c_first_name#420 AS customer_first_name#9522, c_last_name#421 AS customer_last_name#9523, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9524, c_birth_country#426 AS customer_birth_country#9525, c_login#427 AS customer_login#9526, c_email_address#428 AS customer_email_address#9527, d_year#498 AS dyear#9528, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9529, w AS sale_type#9530]
               :  :  :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :  :                 +- Join Inner
               :  :  :  :                    :- Join Inner
               :  :  :  :                    :  :- SubqueryAlias `customer`
               :  :  :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :                    :  +- SubqueryAlias `web_sales`
               :  :  :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :  :                    +- SubqueryAlias `date_dim`
               :  :  :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  +- SubqueryAlias `t_c_firstyear`
               :  :  :     +- SubqueryAlias `year_total`
               :  :  :        +- Union
               :  :  :           :- Union
               :  :  :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9544, c_first_name#420 AS customer_first_name#9545, c_last_name#421 AS customer_last_name#9546, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9547, c_birth_country#426 AS customer_birth_country#9548, c_login#427 AS customer_login#9549, c_email_address#428 AS customer_email_address#9550, d_year#498 AS dyear#9551, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9552, s AS sale_type#9553]
               :  :  :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :           :  :     +- Join Inner
               :  :  :           :  :        :- Join Inner
               :  :  :           :  :        :  :- SubqueryAlias `customer`
               :  :  :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :           :  :        :  +- SubqueryAlias `store_sales`
               :  :  :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :           :  :        +- SubqueryAlias `date_dim`
               :  :  :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9511, c_first_name#420 AS customer_first_name#9512, c_last_name#421 AS customer_last_name#9513, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9514, c_birth_country#426 AS customer_birth_country#9515, c_login#427 AS customer_login#9516, c_email_address#428 AS customer_email_address#9517, d_year#498 AS dyear#9518, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9519, c AS sale_type#9520]
               :  :  :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :  :           :        +- Join Inner
               :  :  :           :           :- Join Inner
               :  :  :           :           :  :- SubqueryAlias `customer`
               :  :  :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :           :           :  +- SubqueryAlias `catalog_sales`
               :  :  :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :           :           +- SubqueryAlias `date_dim`
               :  :  :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9521, c_first_name#420 AS customer_first_name#9522, c_last_name#421 AS customer_last_name#9523, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9524, c_birth_country#426 AS customer_birth_country#9525, c_login#427 AS customer_login#9526, c_email_address#428 AS customer_email_address#9527, d_year#498 AS dyear#9528, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9529, w AS sale_type#9530]
               :  :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :                 +- Join Inner
               :  :  :                    :- Join Inner
               :  :  :                    :  :- SubqueryAlias `customer`
               :  :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :                    :  +- SubqueryAlias `web_sales`
               :  :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :                    +- SubqueryAlias `date_dim`
               :  :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  +- SubqueryAlias `t_c_secyear`
               :  :     +- SubqueryAlias `year_total`
               :  :        +- Union
               :  :           :- Union
               :  :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9554, c_first_name#420 AS customer_first_name#9555, c_last_name#421 AS customer_last_name#9556, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9557, c_birth_country#426 AS customer_birth_country#9558, c_login#427 AS customer_login#9559, c_email_address#428 AS customer_email_address#9560, d_year#498 AS dyear#9561, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9562, s AS sale_type#9563]
               :  :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :           :  :     +- Join Inner
               :  :           :  :        :- Join Inner
               :  :           :  :        :  :- SubqueryAlias `customer`
               :  :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :  :        :  +- SubqueryAlias `store_sales`
               :  :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  :        +- SubqueryAlias `date_dim`
               :  :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9511, c_first_name#420 AS customer_first_name#9512, c_last_name#421 AS customer_last_name#9513, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9514, c_birth_country#426 AS customer_birth_country#9515, c_login#427 AS customer_login#9516, c_email_address#428 AS customer_email_address#9517, d_year#498 AS dyear#9518, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9519, c AS sale_type#9520]
               :  :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :           :        +- Join Inner
               :  :           :           :- Join Inner
               :  :           :           :  :- SubqueryAlias `customer`
               :  :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :           :  +- SubqueryAlias `catalog_sales`
               :  :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :           :           +- SubqueryAlias `date_dim`
               :  :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9521, c_first_name#420 AS customer_first_name#9522, c_last_name#421 AS customer_last_name#9523, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9524, c_birth_country#426 AS customer_birth_country#9525, c_login#427 AS customer_login#9526, c_email_address#428 AS customer_email_address#9527, d_year#498 AS dyear#9528, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9529, w AS sale_type#9530]
               :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :                 +- Join Inner
               :  :                    :- Join Inner
               :  :                    :  :- SubqueryAlias `customer`
               :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :                    :  +- SubqueryAlias `web_sales`
               :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :                    +- SubqueryAlias `date_dim`
               :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `t_w_firstyear`
               :     +- SubqueryAlias `year_total`
               :        +- Union
               :           :- Union
               :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9564, c_first_name#420 AS customer_first_name#9565, c_last_name#421 AS customer_last_name#9566, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9567, c_birth_country#426 AS customer_birth_country#9568, c_login#427 AS customer_login#9569, c_email_address#428 AS customer_email_address#9570, d_year#498 AS dyear#9571, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9572, s AS sale_type#9573]
               :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :           :  :     +- Join Inner
               :           :  :        :- Join Inner
               :           :  :        :  :- SubqueryAlias `customer`
               :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :  :        :  +- SubqueryAlias `store_sales`
               :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :  :        +- SubqueryAlias `date_dim`
               :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9511, c_first_name#420 AS customer_first_name#9512, c_last_name#421 AS customer_last_name#9513, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9514, c_birth_country#426 AS customer_birth_country#9515, c_login#427 AS customer_login#9516, c_email_address#428 AS customer_email_address#9517, d_year#498 AS dyear#9518, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9519, c AS sale_type#9520]
               :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :           :        +- Join Inner
               :           :           :- Join Inner
               :           :           :  :- SubqueryAlias `customer`
               :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :           :  +- SubqueryAlias `catalog_sales`
               :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :           :           +- SubqueryAlias `date_dim`
               :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9521, c_first_name#420 AS customer_first_name#9522, c_last_name#421 AS customer_last_name#9523, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9524, c_birth_country#426 AS customer_birth_country#9525, c_login#427 AS customer_login#9526, c_email_address#428 AS customer_email_address#9527, d_year#498 AS dyear#9528, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9529, w AS sale_type#9530]
               :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :                 +- Join Inner
               :                    :- Join Inner
               :                    :  :- SubqueryAlias `customer`
               :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :                    :  +- SubqueryAlias `web_sales`
               :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `t_w_secyear`
                  +- SubqueryAlias `year_total`
                     +- Union
                        :- Union
                        :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9574, c_first_name#420 AS customer_first_name#9575, c_last_name#421 AS customer_last_name#9576, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9577, c_birth_country#426 AS customer_birth_country#9578, c_login#427 AS customer_login#9579, c_email_address#428 AS customer_email_address#9580, d_year#498 AS dyear#9581, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9582, s AS sale_type#9583]
                        :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
                        :  :     +- Join Inner
                        :  :        :- Join Inner
                        :  :        :  :- SubqueryAlias `customer`
                        :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :        :  +- SubqueryAlias `store_sales`
                        :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :        +- SubqueryAlias `date_dim`
                        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9511, c_first_name#420 AS customer_first_name#9512, c_last_name#421 AS customer_last_name#9513, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9514, c_birth_country#426 AS customer_birth_country#9515, c_login#427 AS customer_login#9516, c_email_address#428 AS customer_email_address#9517, d_year#498 AS dyear#9518, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9519, c AS sale_type#9520]
                        :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
                        :        +- Join Inner
                        :           :- Join Inner
                        :           :  :- SubqueryAlias `customer`
                        :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :           :  +- SubqueryAlias `catalog_sales`
                        :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :           +- SubqueryAlias `date_dim`
                        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9521, c_first_name#420 AS customer_first_name#9522, c_last_name#421 AS customer_last_name#9523, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9524, c_birth_country#426 AS customer_birth_country#9525, c_login#427 AS customer_login#9526, c_email_address#428 AS customer_email_address#9527, d_year#498 AS dyear#9528, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9529, w AS sale_type#9530]
                           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `customer`
                                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                                 :  +- SubqueryAlias `web_sales`
                                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 50.148098798999996s
Running execution q5-v2.4 iteration: 1, StandardRun=true
19/09/08 18:15:26 INFO Query: 
== Query: q5-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#9985 ASC NULLS FIRST, id#9986 ASC NULLS FIRST], true
      +- Aggregate [channel#9985, id#9986, spark_grouping_id#9982], [channel#9985, id#9986, sum(sales#9931) AS sales#9916, sum(returns#9933) AS returns#9917, sum(profit#9909) AS profit#9918]
         +- Expand [List(channel#9907, id#9908, sales#9931, returns#9933, profit#9909, channel#9983, id#9984, 0), List(channel#9907, id#9908, sales#9931, returns#9933, profit#9909, channel#9983, null, 1), List(channel#9907, id#9908, sales#9931, returns#9933, profit#9909, null, null, 3)], [channel#9907, id#9908, sales#9931, returns#9933, profit#9909, channel#9985, id#9986, spark_grouping_id#9982]
            +- Project [channel#9907, id#9908, sales#9931, returns#9933, profit#9909, channel#9907 AS channel#9983, id#9908 AS id#9984]
               +- SubqueryAlias `x`
                  +- Union
                     :- Union
                     :  :- Project [store channel AS channel#9907, concat(store, s_store_id#665) AS id#9908, sales#9931, returns#9933, CheckOverflow((promote_precision(cast(profit#9932 as decimal(18,2))) - promote_precision(cast(profit_loss#9934 as decimal(18,2)))), DecimalType(18,2)) AS profit#9909]
                     :  :  +- SubqueryAlias `ssr`
                     :  :     +- Aggregate [s_store_id#665], [s_store_id#665, sum(sales_price#9921) AS sales#9931, sum(profit#9922) AS profit#9932, sum(return_amt#9923) AS returns#9933, sum(net_loss#9924) AS profit_loss#9934]
                     :  :        +- Filter (((date_sk#9920 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 2 weeks as date)))) && (store_sk#9919 = s_store_sk#664))
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- SubqueryAlias `salesreturns`
                     :  :              :  :  +- Union
                     :  :              :  :     :- Project [ss_store_sk#137 AS store_sk#9919, ss_sold_date_sk#130 AS date_sk#9920, ss_ext_sales_price#145 AS sales_price#9921, ss_net_profit#152 AS profit#9922, cast(0 as decimal(7,2)) AS return_amt#9923, cast(0 as decimal(7,2)) AS net_loss#9924]
                     :  :              :  :     :  +- SubqueryAlias `store_sales`
                     :  :              :  :     :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :              :  :     +- Project [sr_store_sk#183 AS store_sk#9925, sr_returned_date_sk#176 AS date_sk#9926, cast(0 as decimal(7,2)) AS sales_price#9927, cast(0 as decimal(7,2)) AS profit#9928, sr_return_amt#187 AS return_amt#9929, sr_net_loss#195 AS net_loss#9930]
                     :  :              :  :        +- SubqueryAlias `store_returns`
                     :  :              :  :           +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :              :  +- SubqueryAlias `date_dim`
                     :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :              +- SubqueryAlias `store`
                     :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  +- Project [catalog channel AS channel#9910, concat(catalog_page, cp_catalog_page_id#395) AS id#9911, sales#9947, returns#9949, CheckOverflow((promote_precision(cast(profit#9948 as decimal(18,2))) - promote_precision(cast(profit_loss#9950 as decimal(18,2)))), DecimalType(18,2)) AS profit#9912]
                     :     +- SubqueryAlias `csr`
                     :        +- Aggregate [cp_catalog_page_id#395], [cp_catalog_page_id#395, sum(sales_price#9937) AS sales#9947, sum(profit#9938) AS profit#9948, sum(return_amt#9939) AS returns#9949, sum(net_loss#9940) AS profit_loss#9950]
                     :           +- Filter (((date_sk#9936 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 2 weeks as date)))) && (page_sk#9935 = cp_catalog_page_sk#394))
                     :              +- Join Inner
                     :                 :- Join Inner
                     :                 :  :- SubqueryAlias `salesreturns`
                     :                 :  :  +- Union
                     :                 :  :     :- Project [cs_catalog_page_sk#12 AS page_sk#9935, cs_sold_date_sk#0 AS date_sk#9936, cs_ext_sales_price#23 AS sales_price#9937, cs_net_profit#33 AS profit#9938, cast(0 as decimal(7,2)) AS return_amt#9939, cast(0 as decimal(7,2)) AS net_loss#9940]
                     :                 :  :     :  +- SubqueryAlias `catalog_sales`
                     :                 :  :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :                 :  :     +- Project [cr_catalog_page_sk#80 AS page_sk#9941, cr_returned_date_sk#68 AS date_sk#9942, cast(0 as decimal(7,2)) AS sales_price#9943, cast(0 as decimal(7,2)) AS profit#9944, cr_return_amount#86 AS return_amt#9945, cr_net_loss#94 AS net_loss#9946]
                     :                 :  :        +- SubqueryAlias `catalog_returns`
                     :                 :  :           +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                     :                 :  +- SubqueryAlias `date_dim`
                     :                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :                 +- SubqueryAlias `catalog_page`
                     :                    +- Relation[cp_catalog_page_sk#394,cp_catalog_page_id#395,cp_start_date_sk#396,cp_end_date_sk#397,cp_department#398,cp_catalog_number#399,cp_catalog_page_number#400,cp_description#401,cp_type#402] parquet
                     +- Project [web channel AS channel#9913, concat(web_site, web_site_id#799) AS id#9914, sales#9963, returns#9965, CheckOverflow((promote_precision(cast(profit#9964 as decimal(18,2))) - promote_precision(cast(profit_loss#9966 as decimal(18,2)))), DecimalType(18,2)) AS profit#9915]
                        +- SubqueryAlias `wsr`
                           +- Aggregate [web_site_id#799], [web_site_id#799, sum(sales_price#9953) AS sales#9963, sum(profit#9954) AS profit#9964, sum(return_amt#9955) AS returns#9965, sum(net_loss#9956) AS profit_loss#9966]
                              +- Filter (((date_sk#9952 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 2 weeks as date)))) && (wsr_web_site_sk#9951 = web_site_sk#798))
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- SubqueryAlias `salesreturns`
                                    :  :  +- Union
                                    :  :     :- Project [ws_web_site_sk#229 AS wsr_web_site_sk#9951, ws_sold_date_sk#216 AS date_sk#9952, ws_ext_sales_price#239 AS sales_price#9953, ws_net_profit#249 AS profit#9954, cast(0 as decimal(7,2)) AS return_amt#9955, cast(0 as decimal(7,2)) AS net_loss#9956]
                                    :  :     :  +- SubqueryAlias `web_sales`
                                    :  :     :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  :     +- Project [ws_web_site_sk#229 AS wsr_web_site_sk#9957, wr_returned_date_sk#284 AS date_sk#9958, cast(0 as decimal(7,2)) AS sales_price#9959, cast(0 as decimal(7,2)) AS profit#9960, wr_return_amt#299 AS return_amt#9961, wr_net_loss#307 AS net_loss#9962]
                                    :  :        +- Join LeftOuter, ((wr_item_sk#286 = ws_item_sk#219) && (wr_order_number#297L = ws_order_number#233L))
                                    :  :           :- SubqueryAlias `web_returns`
                                    :  :           :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                                    :  :           +- SubqueryAlias `web_sales`
                                    :  :              +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  +- SubqueryAlias `date_dim`
                                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                    +- SubqueryAlias `web_site`
                                       +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet

     : benchmark
19/09/08 18:15:26 INFO Query: 
== Query: q5-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#10072 ASC NULLS FIRST, id#10073 ASC NULLS FIRST], true
      +- Aggregate [channel#10072, id#10073, spark_grouping_id#10069], [channel#10072, id#10073, sum(sales#10018) AS sales#10003, sum(returns#10020) AS returns#10004, sum(profit#9996) AS profit#10005]
         +- Expand [List(channel#9994, id#9995, sales#10018, returns#10020, profit#9996, channel#10070, id#10071, 0), List(channel#9994, id#9995, sales#10018, returns#10020, profit#9996, channel#10070, null, 1), List(channel#9994, id#9995, sales#10018, returns#10020, profit#9996, null, null, 3)], [channel#9994, id#9995, sales#10018, returns#10020, profit#9996, channel#10072, id#10073, spark_grouping_id#10069]
            +- Project [channel#9994, id#9995, sales#10018, returns#10020, profit#9996, channel#9994 AS channel#10070, id#9995 AS id#10071]
               +- SubqueryAlias `x`
                  +- Union
                     :- Union
                     :  :- Project [store channel AS channel#9994, concat(store, s_store_id#665) AS id#9995, sales#10018, returns#10020, CheckOverflow((promote_precision(cast(profit#10019 as decimal(18,2))) - promote_precision(cast(profit_loss#10021 as decimal(18,2)))), DecimalType(18,2)) AS profit#9996]
                     :  :  +- SubqueryAlias `ssr`
                     :  :     +- Aggregate [s_store_id#665], [s_store_id#665, sum(sales_price#10008) AS sales#10018, sum(profit#10009) AS profit#10019, sum(return_amt#10010) AS returns#10020, sum(net_loss#10011) AS profit_loss#10021]
                     :  :        +- Filter (((date_sk#10007 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 2 weeks as date)))) && (store_sk#10006 = s_store_sk#664))
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- SubqueryAlias `salesreturns`
                     :  :              :  :  +- Union
                     :  :              :  :     :- Project [ss_store_sk#137 AS store_sk#10006, ss_sold_date_sk#130 AS date_sk#10007, ss_ext_sales_price#145 AS sales_price#10008, ss_net_profit#152 AS profit#10009, cast(0 as decimal(7,2)) AS return_amt#10010, cast(0 as decimal(7,2)) AS net_loss#10011]
                     :  :              :  :     :  +- SubqueryAlias `store_sales`
                     :  :              :  :     :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :              :  :     +- Project [sr_store_sk#183 AS store_sk#10012, sr_returned_date_sk#176 AS date_sk#10013, cast(0 as decimal(7,2)) AS sales_price#10014, cast(0 as decimal(7,2)) AS profit#10015, sr_return_amt#187 AS return_amt#10016, sr_net_loss#195 AS net_loss#10017]
                     :  :              :  :        +- SubqueryAlias `store_returns`
                     :  :              :  :           +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :              :  +- SubqueryAlias `date_dim`
                     :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :              +- SubqueryAlias `store`
                     :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  +- Project [catalog channel AS channel#9997, concat(catalog_page, cp_catalog_page_id#395) AS id#9998, sales#10034, returns#10036, CheckOverflow((promote_precision(cast(profit#10035 as decimal(18,2))) - promote_precision(cast(profit_loss#10037 as decimal(18,2)))), DecimalType(18,2)) AS profit#9999]
                     :     +- SubqueryAlias `csr`
                     :        +- Aggregate [cp_catalog_page_id#395], [cp_catalog_page_id#395, sum(sales_price#10024) AS sales#10034, sum(profit#10025) AS profit#10035, sum(return_amt#10026) AS returns#10036, sum(net_loss#10027) AS profit_loss#10037]
                     :           +- Filter (((date_sk#10023 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 2 weeks as date)))) && (page_sk#10022 = cp_catalog_page_sk#394))
                     :              +- Join Inner
                     :                 :- Join Inner
                     :                 :  :- SubqueryAlias `salesreturns`
                     :                 :  :  +- Union
                     :                 :  :     :- Project [cs_catalog_page_sk#12 AS page_sk#10022, cs_sold_date_sk#0 AS date_sk#10023, cs_ext_sales_price#23 AS sales_price#10024, cs_net_profit#33 AS profit#10025, cast(0 as decimal(7,2)) AS return_amt#10026, cast(0 as decimal(7,2)) AS net_loss#10027]
                     :                 :  :     :  +- SubqueryAlias `catalog_sales`
                     :                 :  :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :                 :  :     +- Project [cr_catalog_page_sk#80 AS page_sk#10028, cr_returned_date_sk#68 AS date_sk#10029, cast(0 as decimal(7,2)) AS sales_price#10030, cast(0 as decimal(7,2)) AS profit#10031, cr_return_amount#86 AS return_amt#10032, cr_net_loss#94 AS net_loss#10033]
                     :                 :  :        +- SubqueryAlias `catalog_returns`
                     :                 :  :           +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                     :                 :  +- SubqueryAlias `date_dim`
                     :                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :                 +- SubqueryAlias `catalog_page`
                     :                    +- Relation[cp_catalog_page_sk#394,cp_catalog_page_id#395,cp_start_date_sk#396,cp_end_date_sk#397,cp_department#398,cp_catalog_number#399,cp_catalog_page_number#400,cp_description#401,cp_type#402] parquet
                     +- Project [web channel AS channel#10000, concat(web_site, web_site_id#799) AS id#10001, sales#10050, returns#10052, CheckOverflow((promote_precision(cast(profit#10051 as decimal(18,2))) - promote_precision(cast(profit_loss#10053 as decimal(18,2)))), DecimalType(18,2)) AS profit#10002]
                        +- SubqueryAlias `wsr`
                           +- Aggregate [web_site_id#799], [web_site_id#799, sum(sales_price#10040) AS sales#10050, sum(profit#10041) AS profit#10051, sum(return_amt#10042) AS returns#10052, sum(net_loss#10043) AS profit_loss#10053]
                              +- Filter (((date_sk#10039 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 2 weeks as date)))) && (wsr_web_site_sk#10038 = web_site_sk#798))
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- SubqueryAlias `salesreturns`
                                    :  :  +- Union
                                    :  :     :- Project [ws_web_site_sk#229 AS wsr_web_site_sk#10038, ws_sold_date_sk#216 AS date_sk#10039, ws_ext_sales_price#239 AS sales_price#10040, ws_net_profit#249 AS profit#10041, cast(0 as decimal(7,2)) AS return_amt#10042, cast(0 as decimal(7,2)) AS net_loss#10043]
                                    :  :     :  +- SubqueryAlias `web_sales`
                                    :  :     :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  :     +- Project [ws_web_site_sk#229 AS wsr_web_site_sk#10044, wr_returned_date_sk#284 AS date_sk#10045, cast(0 as decimal(7,2)) AS sales_price#10046, cast(0 as decimal(7,2)) AS profit#10047, wr_return_amt#299 AS return_amt#10048, wr_net_loss#307 AS net_loss#10049]
                                    :  :        +- Join LeftOuter, ((wr_item_sk#286 = ws_item_sk#219) && (wr_order_number#297L = ws_order_number#233L))
                                    :  :           :- SubqueryAlias `web_returns`
                                    :  :           :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                                    :  :           +- SubqueryAlias `web_sales`
                                    :  :              +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  +- SubqueryAlias `date_dim`
                                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                    +- SubqueryAlias `web_site`
                                       +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 11.724827730000001s
Running execution q6-v2.4 iteration: 1, StandardRun=true
19/09/08 18:15:39 INFO Query: 
== Query: q6-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cnt#10307L ASC NULLS FIRST], true
      +- Project [state#10306, cnt#10307L]
         +- Filter (cnt#10307L >= cast(10 as bigint))
            +- SubqueryAlias `x`
               +- Aggregate [ca_state#456], [ca_state#456 AS state#10306, count(1) AS cnt#10307L]
                  +- Filter ((((ca_address_sk#448 = c_current_addr_sk#416) && (c_customer_sk#412 = ss_customer_sk#133)) && (ss_sold_date_sk#130 = d_date_sk#492)) && (((ss_item_sk#132 = i_item_sk#564) && (d_month_seq#495 = scalar-subquery#10308 [])) && (cast(i_current_price#569 as decimal(14,7)) > cast(CheckOverflow((promote_precision(cast(1.2 as decimal(11,6))) * promote_precision(cast(scalar-subquery#10309 [i_category#576] as decimal(11,6)))), DecimalType(14,7)) as decimal(14,7)))))
                     :  :- Distinct
                     :  :  +- Project [d_month_seq#495]
                     :  :     +- Filter ((d_year#498 = 2001) && (d_moy#500 = 1))
                     :  :        +- SubqueryAlias `date_dim`
                     :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- Aggregate [avg(i_current_price#569) AS avg(i_current_price)#10312]
                     :     +- Filter (i_category#576 = outer(i_category#576))
                     :        +- SubqueryAlias `j`
                     :           +- SubqueryAlias `item`
                     :              +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- SubqueryAlias `a`
                        :  :  :  :  +- SubqueryAlias `customer_address`
                        :  :  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `c`
                        :  :  :     +- SubqueryAlias `customer`
                        :  :  :        +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  +- SubqueryAlias `s`
                        :  :     +- SubqueryAlias `store_sales`
                        :  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  +- SubqueryAlias `d`
                        :     +- SubqueryAlias `date_dim`
                        :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- SubqueryAlias `i`
                           +- SubqueryAlias `item`
                              +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:15:40 INFO Query: 
== Query: q6-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cnt#10316L ASC NULLS FIRST], true
      +- Project [state#10315, cnt#10316L]
         +- Filter (cnt#10316L >= cast(10 as bigint))
            +- SubqueryAlias `x`
               +- Aggregate [ca_state#456], [ca_state#456 AS state#10315, count(1) AS cnt#10316L]
                  +- Filter ((((ca_address_sk#448 = c_current_addr_sk#416) && (c_customer_sk#412 = ss_customer_sk#133)) && (ss_sold_date_sk#130 = d_date_sk#492)) && (((ss_item_sk#132 = i_item_sk#564) && (d_month_seq#495 = scalar-subquery#10317 [])) && (cast(i_current_price#569 as decimal(14,7)) > cast(CheckOverflow((promote_precision(cast(1.2 as decimal(11,6))) * promote_precision(cast(scalar-subquery#10318 [i_category#576] as decimal(11,6)))), DecimalType(14,7)) as decimal(14,7)))))
                     :  :- Distinct
                     :  :  +- Project [d_month_seq#495]
                     :  :     +- Filter ((d_year#498 = 2001) && (d_moy#500 = 1))
                     :  :        +- SubqueryAlias `date_dim`
                     :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- Aggregate [avg(i_current_price#569) AS avg(i_current_price)#10321]
                     :     +- Filter (i_category#576 = outer(i_category#576))
                     :        +- SubqueryAlias `j`
                     :           +- SubqueryAlias `item`
                     :              +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- SubqueryAlias `a`
                        :  :  :  :  +- SubqueryAlias `customer_address`
                        :  :  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `c`
                        :  :  :     +- SubqueryAlias `customer`
                        :  :  :        +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  +- SubqueryAlias `s`
                        :  :     +- SubqueryAlias `store_sales`
                        :  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  +- SubqueryAlias `d`
                        :     +- SubqueryAlias `date_dim`
                        :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- SubqueryAlias `i`
                           +- SubqueryAlias `item`
                              +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 15.019081014s
Running execution q7-v2.4 iteration: 1, StandardRun=true
19/09/08 18:15:56 INFO Query: 
== Query: q7-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, agg1#10380, agg2#10381, agg3#10382, agg4#10383]
      +- Sort [i_item_id#565 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565], [i_item_id#565, avg(cast(ss_quantity#140 as bigint)) AS agg1#10380, avg(ss_list_price#142) AS agg2#10381, avg(ss_coupon_amt#149) AS agg3#10382, avg(ss_sales_price#143) AS agg4#10383]
            +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && (ss_cdemo_sk#134 = cd_demo_sk#474)) && ((ss_promo_sk#138 = p_promo_sk#608) && (cd_gender#475 = M))) && (((cd_marital_status#476 = S) && (cd_education_status#477 = College)) && (((p_channel_email#617 = N) || (p_channel_event#622 = N)) && (d_year#498 = 2000))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  +- SubqueryAlias `customer_demographics`
                  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `promotion`
                     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet

     : benchmark
19/09/08 18:15:56 INFO Query: 
== Query: q7-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, agg1#10394, agg2#10395, agg3#10396, agg4#10397]
      +- Sort [i_item_id#565 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565], [i_item_id#565, avg(cast(ss_quantity#140 as bigint)) AS agg1#10394, avg(ss_list_price#142) AS agg2#10395, avg(ss_coupon_amt#149) AS agg3#10396, avg(ss_sales_price#143) AS agg4#10397]
            +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && (ss_cdemo_sk#134 = cd_demo_sk#474)) && ((ss_promo_sk#138 = p_promo_sk#608) && (cd_gender#475 = M))) && (((cd_marital_status#476 = S) && (cd_education_status#477 = College)) && (((p_channel_email#617 = N) || (p_channel_event#622 = N)) && (d_year#498 = 2000))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  +- SubqueryAlias `customer_demographics`
                  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `promotion`
                     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet

      running Thread[benchmark runner,5,main]
Execution time: 4.964337759s
Running execution q8-v2.4 iteration: 1, StandardRun=true
19/09/08 18:16:02 INFO Query: 
== Query: q8-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [s_store_name#669, sum(ss_net_profit)#10486]
      +- Sort [s_store_name#669 ASC NULLS FIRST], true
         +- Aggregate [s_store_name#669], [s_store_name#669, sum(ss_net_profit#152) AS sum(ss_net_profit)#10486]
            +- Filter ((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (d_qoy#502 = 2)) && ((d_year#498 = 1998) && (substring(s_zip#689, 1, 2) = substring(ca_zip#10476, 1, 2))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `store`
                  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  +- SubqueryAlias `V1`
                     +- Project [ca_zip#10476]
                        +- SubqueryAlias `A2`
                           +- Intersect false
                              :- Project [substring(ca_zip#457, 1, 5) AS ca_zip#10476]
                              :  +- Filter substring(ca_zip#457, 1, 5) IN (24128,76232,65084,87816,83926,77556,20548,26231,43848,15126,91137,61265,98294,25782,17920,18426,98235,40081,84093,28577,55565,17183,54601,67897,22752,86284,18376,38607,45200,21756,29741,96765,23932,89360,29839,25989,28898,91068,72550,10390,18845,47770,82636,41367,76638,86198,81312,37126,39192,88424,72175,81426,53672,10445,42666,66864,66708,41248,48583,82276,18842,78890,49448,14089,38122,34425,79077,19849,43285,39861,66162,77610,13695,99543,83444,83041,12305,57665,68341,25003,57834,62878,49130,81096,18840,27700,23470,50412,21195,16021,76107,71954,68309,18119,98359,64544,10336,86379,27068,39736,98569,28915,24206,56529,57647,54917,42961,91110,63981,14922,36420,23006,67467,32754,30903,20260,31671,51798,72325,85816,68621,13955,36446,41766,68806,16725,15146,22744,35850,88086,51649,18270,52867,39972,96976,63792,11376,94898,13595,10516,90225,58943,39371,94945,28587,96576,57855,28488,26105,83933,25858,34322,44438,73171,30122,34102,22685,71256,78451,54364,13354,45375,40558,56458,28286,45266,47305,69399,83921,26233,11101,15371,69913,35942,15882,25631,24610,44165,99076,33786,70738,26653,14328,72305,62496,22152,10144,64147,48425,14663,21076,18799,30450,63089,81019,68893,24996,51200,51211,45692,92712,70466,79994,22437,25280,38935,71791,73134,56571,14060,19505,72425,56575,74351,68786,51650,20004,18383,76614,11634,18906,15765,41368,73241,76698,78567,97189,28545,76231,75691,22246,51061,90578,56691,68014,51103,94167,57047,14867,73520,15734,63435,25733,35474,24676,94627,53535,17879,15559,53268,59166,11928,59402,33282,45721,43933,68101,33515,36634,71286,19736,58058,55253,67473,41918,19515,36495,19430,22351,77191,91393,49156,50298,87501,18652,53179,18767,63193,23968,65164,68880,21286,72823,58470,67301,13394,31016,70372,67030,40604,24317,45748,39127,26065,77721,31029,31880,60576,24671,45549,13376,50016,33123,19769,22927,97789,46081,72151,15723,46136,51949,68100,96888,64528,14171,79777,28709,11489,25103,32213,78668,22245,15798,27156,37930,62971,21337,51622,67853,10567,38415,15455,58263,42029,60279,37125,56240,88190,50308,26859,64457,89091,82136,62377,36233,63837,58078,17043,30010,60099,28810,98025,29178,87343,73273,30469,64034,39516,86057,21309,90257,67875,40162,11356,73650,61810,72013,30431,22461,19512,13375,55307,30625,83849,68908,26689,96451,38193,46820,88885,84935,69035,83144,47537,56616,94983,48033,69952,25486,61547,27385,61860,58048,56910,16807,17871,35258,31387,35458,35576)
                              :     +- SubqueryAlias `customer_address`
                              :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- Project [ca_zip#10477]
                                 +- SubqueryAlias `A1`
                                    +- Project [ca_zip#10477, cnt#10478L]
                                       +- Filter (count(1)#10482L > cast(10 as bigint))
                                          +- Aggregate [ca_zip#457], [substring(ca_zip#457, 1, 5) AS ca_zip#10477, count(1) AS cnt#10478L, count(1) AS count(1)#10482L]
                                             +- Filter ((ca_address_sk#448 = c_current_addr_sk#416) && (c_preferred_cust_flag#422 = Y))
                                                +- Join Inner
                                                   :- SubqueryAlias `customer_address`
                                                   :  +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                                                   +- SubqueryAlias `customer`
                                                      +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/09/08 18:16:02 INFO Query: 
== Query: q8-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [s_store_name#669, sum(ss_net_profit)#10505]
      +- Sort [s_store_name#669 ASC NULLS FIRST], true
         +- Aggregate [s_store_name#669], [s_store_name#669, sum(ss_net_profit#152) AS sum(ss_net_profit)#10505]
            +- Filter ((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (d_qoy#502 = 2)) && ((d_year#498 = 1998) && (substring(s_zip#689, 1, 2) = substring(ca_zip#10495, 1, 2))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `store`
                  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  +- SubqueryAlias `V1`
                     +- Project [ca_zip#10495]
                        +- SubqueryAlias `A2`
                           +- Intersect false
                              :- Project [substring(ca_zip#457, 1, 5) AS ca_zip#10495]
                              :  +- Filter substring(ca_zip#457, 1, 5) IN (24128,76232,65084,87816,83926,77556,20548,26231,43848,15126,91137,61265,98294,25782,17920,18426,98235,40081,84093,28577,55565,17183,54601,67897,22752,86284,18376,38607,45200,21756,29741,96765,23932,89360,29839,25989,28898,91068,72550,10390,18845,47770,82636,41367,76638,86198,81312,37126,39192,88424,72175,81426,53672,10445,42666,66864,66708,41248,48583,82276,18842,78890,49448,14089,38122,34425,79077,19849,43285,39861,66162,77610,13695,99543,83444,83041,12305,57665,68341,25003,57834,62878,49130,81096,18840,27700,23470,50412,21195,16021,76107,71954,68309,18119,98359,64544,10336,86379,27068,39736,98569,28915,24206,56529,57647,54917,42961,91110,63981,14922,36420,23006,67467,32754,30903,20260,31671,51798,72325,85816,68621,13955,36446,41766,68806,16725,15146,22744,35850,88086,51649,18270,52867,39972,96976,63792,11376,94898,13595,10516,90225,58943,39371,94945,28587,96576,57855,28488,26105,83933,25858,34322,44438,73171,30122,34102,22685,71256,78451,54364,13354,45375,40558,56458,28286,45266,47305,69399,83921,26233,11101,15371,69913,35942,15882,25631,24610,44165,99076,33786,70738,26653,14328,72305,62496,22152,10144,64147,48425,14663,21076,18799,30450,63089,81019,68893,24996,51200,51211,45692,92712,70466,79994,22437,25280,38935,71791,73134,56571,14060,19505,72425,56575,74351,68786,51650,20004,18383,76614,11634,18906,15765,41368,73241,76698,78567,97189,28545,76231,75691,22246,51061,90578,56691,68014,51103,94167,57047,14867,73520,15734,63435,25733,35474,24676,94627,53535,17879,15559,53268,59166,11928,59402,33282,45721,43933,68101,33515,36634,71286,19736,58058,55253,67473,41918,19515,36495,19430,22351,77191,91393,49156,50298,87501,18652,53179,18767,63193,23968,65164,68880,21286,72823,58470,67301,13394,31016,70372,67030,40604,24317,45748,39127,26065,77721,31029,31880,60576,24671,45549,13376,50016,33123,19769,22927,97789,46081,72151,15723,46136,51949,68100,96888,64528,14171,79777,28709,11489,25103,32213,78668,22245,15798,27156,37930,62971,21337,51622,67853,10567,38415,15455,58263,42029,60279,37125,56240,88190,50308,26859,64457,89091,82136,62377,36233,63837,58078,17043,30010,60099,28810,98025,29178,87343,73273,30469,64034,39516,86057,21309,90257,67875,40162,11356,73650,61810,72013,30431,22461,19512,13375,55307,30625,83849,68908,26689,96451,38193,46820,88885,84935,69035,83144,47537,56616,94983,48033,69952,25486,61547,27385,61860,58048,56910,16807,17871,35258,31387,35458,35576)
                              :     +- SubqueryAlias `customer_address`
                              :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- Project [ca_zip#10496]
                                 +- SubqueryAlias `A1`
                                    +- Project [ca_zip#10496, cnt#10497L]
                                       +- Filter (count(1)#10501L > cast(10 as bigint))
                                          +- Aggregate [ca_zip#457], [substring(ca_zip#457, 1, 5) AS ca_zip#10496, count(1) AS cnt#10497L, count(1) AS count(1)#10501L]
                                             +- Filter ((ca_address_sk#448 = c_current_addr_sk#416) && (c_preferred_cust_flag#422 = Y))
                                                +- Join Inner
                                                   :- SubqueryAlias `customer_address`
                                                   :  +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                                                   +- SubqueryAlias `customer`
                                                      +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 6.643368553s
Running execution q9-v2.4 iteration: 1, StandardRun=true
19/09/08 18:16:11 INFO Query: 
== Query: q9-v2.4 ==
Project [CASE WHEN (scalar-subquery#10702 [] > cast(74129 as bigint)) THEN scalar-subquery#10703 [] ELSE scalar-subquery#10704 [] END AS bucket1#10705, CASE WHEN (scalar-subquery#10706 [] > cast(122840 as bigint)) THEN scalar-subquery#10707 [] ELSE scalar-subquery#10708 [] END AS bucket2#10709, CASE WHEN (scalar-subquery#10710 [] > cast(56580 as bigint)) THEN scalar-subquery#10711 [] ELSE scalar-subquery#10712 [] END AS bucket3#10713, CASE WHEN (scalar-subquery#10714 [] > cast(10097 as bigint)) THEN scalar-subquery#10715 [] ELSE scalar-subquery#10716 [] END AS bucket4#10717, CASE WHEN (scalar-subquery#10718 [] > cast(165306 as bigint)) THEN scalar-subquery#10719 [] ELSE scalar-subquery#10720 [] END AS bucket5#10721]
:  :- Aggregate [count(1) AS count(1)#10723L]
:  :  +- Filter ((ss_quantity#140 >= 1) && (ss_quantity#140 <= 20))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10725]
:  :  +- Filter ((ss_quantity#140 >= 1) && (ss_quantity#140 <= 20))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10727]
:  :  +- Filter ((ss_quantity#140 >= 1) && (ss_quantity#140 <= 20))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10729L]
:  :  +- Filter ((ss_quantity#140 >= 21) && (ss_quantity#140 <= 40))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10731]
:  :  +- Filter ((ss_quantity#140 >= 21) && (ss_quantity#140 <= 40))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10733]
:  :  +- Filter ((ss_quantity#140 >= 21) && (ss_quantity#140 <= 40))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10735L]
:  :  +- Filter ((ss_quantity#140 >= 41) && (ss_quantity#140 <= 60))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10737]
:  :  +- Filter ((ss_quantity#140 >= 41) && (ss_quantity#140 <= 60))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10739]
:  :  +- Filter ((ss_quantity#140 >= 41) && (ss_quantity#140 <= 60))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10741L]
:  :  +- Filter ((ss_quantity#140 >= 61) && (ss_quantity#140 <= 80))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10743]
:  :  +- Filter ((ss_quantity#140 >= 61) && (ss_quantity#140 <= 80))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10745]
:  :  +- Filter ((ss_quantity#140 >= 61) && (ss_quantity#140 <= 80))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10747L]
:  :  +- Filter ((ss_quantity#140 >= 81) && (ss_quantity#140 <= 100))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10749]
:  :  +- Filter ((ss_quantity#140 >= 81) && (ss_quantity#140 <= 100))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  +- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10751]
:     +- Filter ((ss_quantity#140 >= 81) && (ss_quantity#140 <= 100))
:        +- SubqueryAlias `store_sales`
:           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
+- Filter (r_reason_sk#646 = 1)
   +- SubqueryAlias `reason`
      +- Relation[r_reason_sk#646,r_reason_id#647,r_reason_desc#648] parquet

     : benchmark
19/09/08 18:16:11 INFO Query: 
== Query: q9-v2.4 ==
Project [CASE WHEN (scalar-subquery#10757 [] > cast(74129 as bigint)) THEN scalar-subquery#10758 [] ELSE scalar-subquery#10759 [] END AS bucket1#10760, CASE WHEN (scalar-subquery#10761 [] > cast(122840 as bigint)) THEN scalar-subquery#10762 [] ELSE scalar-subquery#10763 [] END AS bucket2#10764, CASE WHEN (scalar-subquery#10765 [] > cast(56580 as bigint)) THEN scalar-subquery#10766 [] ELSE scalar-subquery#10767 [] END AS bucket3#10768, CASE WHEN (scalar-subquery#10769 [] > cast(10097 as bigint)) THEN scalar-subquery#10770 [] ELSE scalar-subquery#10771 [] END AS bucket4#10772, CASE WHEN (scalar-subquery#10773 [] > cast(165306 as bigint)) THEN scalar-subquery#10774 [] ELSE scalar-subquery#10775 [] END AS bucket5#10776]
:  :- Aggregate [count(1) AS count(1)#10778L]
:  :  +- Filter ((ss_quantity#140 >= 1) && (ss_quantity#140 <= 20))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10780]
:  :  +- Filter ((ss_quantity#140 >= 1) && (ss_quantity#140 <= 20))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10782]
:  :  +- Filter ((ss_quantity#140 >= 1) && (ss_quantity#140 <= 20))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10784L]
:  :  +- Filter ((ss_quantity#140 >= 21) && (ss_quantity#140 <= 40))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10786]
:  :  +- Filter ((ss_quantity#140 >= 21) && (ss_quantity#140 <= 40))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10788]
:  :  +- Filter ((ss_quantity#140 >= 21) && (ss_quantity#140 <= 40))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10790L]
:  :  +- Filter ((ss_quantity#140 >= 41) && (ss_quantity#140 <= 60))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10792]
:  :  +- Filter ((ss_quantity#140 >= 41) && (ss_quantity#140 <= 60))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10794]
:  :  +- Filter ((ss_quantity#140 >= 41) && (ss_quantity#140 <= 60))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10796L]
:  :  +- Filter ((ss_quantity#140 >= 61) && (ss_quantity#140 <= 80))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10798]
:  :  +- Filter ((ss_quantity#140 >= 61) && (ss_quantity#140 <= 80))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10800]
:  :  +- Filter ((ss_quantity#140 >= 61) && (ss_quantity#140 <= 80))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10802L]
:  :  +- Filter ((ss_quantity#140 >= 81) && (ss_quantity#140 <= 100))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10804]
:  :  +- Filter ((ss_quantity#140 >= 81) && (ss_quantity#140 <= 100))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  +- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10806]
:     +- Filter ((ss_quantity#140 >= 81) && (ss_quantity#140 <= 100))
:        +- SubqueryAlias `store_sales`
:           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
+- Filter (r_reason_sk#646 = 1)
   +- SubqueryAlias `reason`
      +- Relation[r_reason_sk#646,r_reason_id#647,r_reason_desc#648] parquet

      running Thread[benchmark runner,5,main]
Execution time: 8.766031709s
Running execution q10-v2.4 iteration: 1, StandardRun=true
19/09/08 18:16:21 INFO Query: 
== Query: q10-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cd_gender#475 ASC NULLS FIRST, cd_marital_status#476 ASC NULLS FIRST, cd_education_status#477 ASC NULLS FIRST, cd_purchase_estimate#478 ASC NULLS FIRST, cd_credit_rating#479 ASC NULLS FIRST, cd_dep_count#480 ASC NULLS FIRST, cd_dep_employed_count#481 ASC NULLS FIRST, cd_dep_college_count#482 ASC NULLS FIRST], true
      +- Aggregate [cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482], [cd_gender#475, cd_marital_status#476, cd_education_status#477, count(1) AS cnt1#11046L, cd_purchase_estimate#478, count(1) AS cnt2#11047L, cd_credit_rating#479, count(1) AS cnt3#11048L, cd_dep_count#480, count(1) AS cnt4#11049L, cd_dep_employed_count#481, count(1) AS cnt5#11050L, cd_dep_college_count#482, count(1) AS cnt6#11051L]
         +- Filter ((((c_current_addr_sk#416 = ca_address_sk#448) && ca_county#455 IN (Rush County,Toole County,Jefferson County,Dona Ana County,La Porte County)) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && (exists#11052 [c_customer_sk#412] && (exists#11053 [c_customer_sk#412] || exists#11054 [c_customer_sk#412])))
            :  :- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 27 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = 2002) && ((d_moy#500 >= 1) && (d_moy#500 <= (1 + 3)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `store_sales`
            :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 38 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = 2002) && ((d_moy#500 >= 1) && (d_moy#500 <= (1 + 3)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `web_sales`
            :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 38 more fields]
            :     +- Filter (((outer(c_customer_sk#412) = cs_ship_customer_sk#7) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = 2002) && ((d_moy#500 >= 1) && (d_moy#500 <= (1 + 3)))))
            :        +- Join Inner
            :           :- SubqueryAlias `catalog_sales`
            :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :           +- SubqueryAlias `date_dim`
            :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `c`
               :  :  +- SubqueryAlias `customer`
               :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  +- SubqueryAlias `ca`
               :     +- SubqueryAlias `customer_address`
               :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer_demographics`
                  +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet

     : benchmark
19/09/08 18:16:21 INFO Query: 
== Query: q10-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cd_gender#475 ASC NULLS FIRST, cd_marital_status#476 ASC NULLS FIRST, cd_education_status#477 ASC NULLS FIRST, cd_purchase_estimate#478 ASC NULLS FIRST, cd_credit_rating#479 ASC NULLS FIRST, cd_dep_count#480 ASC NULLS FIRST, cd_dep_employed_count#481 ASC NULLS FIRST, cd_dep_college_count#482 ASC NULLS FIRST], true
      +- Aggregate [cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482], [cd_gender#475, cd_marital_status#476, cd_education_status#477, count(1) AS cnt1#11075L, cd_purchase_estimate#478, count(1) AS cnt2#11076L, cd_credit_rating#479, count(1) AS cnt3#11077L, cd_dep_count#480, count(1) AS cnt4#11078L, cd_dep_employed_count#481, count(1) AS cnt5#11079L, cd_dep_college_count#482, count(1) AS cnt6#11080L]
         +- Filter ((((c_current_addr_sk#416 = ca_address_sk#448) && ca_county#455 IN (Rush County,Toole County,Jefferson County,Dona Ana County,La Porte County)) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && (exists#11081 [c_customer_sk#412] && (exists#11082 [c_customer_sk#412] || exists#11083 [c_customer_sk#412])))
            :  :- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 27 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = 2002) && ((d_moy#500 >= 1) && (d_moy#500 <= (1 + 3)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `store_sales`
            :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 38 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = 2002) && ((d_moy#500 >= 1) && (d_moy#500 <= (1 + 3)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `web_sales`
            :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 38 more fields]
            :     +- Filter (((outer(c_customer_sk#412) = cs_ship_customer_sk#7) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = 2002) && ((d_moy#500 >= 1) && (d_moy#500 <= (1 + 3)))))
            :        +- Join Inner
            :           :- SubqueryAlias `catalog_sales`
            :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :           +- SubqueryAlias `date_dim`
            :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `c`
               :  :  +- SubqueryAlias `customer`
               :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  +- SubqueryAlias `ca`
               :     +- SubqueryAlias `customer_address`
               :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer_demographics`
                  +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet

      running Thread[benchmark runner,5,main]
Execution time: 11.52746475s
Running execution q11-v2.4 iteration: 1, StandardRun=true
19/09/08 18:16:35 INFO Query: 
== Query: q11-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#11260 ASC NULLS FIRST, customer_first_name#11261 ASC NULLS FIRST, customer_last_name#11262 ASC NULLS FIRST, customer_preferred_cust_flag#11263 ASC NULLS FIRST], true
      +- Project [customer_id#11260, customer_first_name#11261, customer_last_name#11262, customer_preferred_cust_flag#11263]
         +- Filter (((((customer_id#11260 = customer_id#11238) && (customer_id#11238 = customer_id#11280)) && ((customer_id#11238 = customer_id#11270) && (sale_type#11247 = s))) && (((sale_type#11279 = w) && (sale_type#11269 = s)) && (sale_type#11289 = w))) && ((((dyear#11245 = 2001) && (dyear#11267 = (2001 + 1))) && ((dyear#11277 = 2001) && (dyear#11287 = (2001 + 1)))) && (((cast(year_total#11246 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2))) && (cast(year_total#11278 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2)))) && (CASE WHEN (cast(year_total#11278 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2))) THEN CheckOverflow((promote_precision(cast(year_total#11288 as decimal(18,2))) / promote_precision(cast(year_total#11278 as decimal(18,2)))), DecimalType(38,20)) ELSE cast(0.0 as decimal(38,20)) END > CASE WHEN (cast(year_total#11246 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2))) THEN CheckOverflow((promote_precision(cast(year_total#11268 as decimal(18,2))) / promote_precision(cast(year_total#11246 as decimal(18,2)))), DecimalType(38,20)) ELSE cast(0.0 as decimal(38,20)) END))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `t_s_firstyear`
               :  :  :  +- SubqueryAlias `year_total`
               :  :  :     +- Union
               :  :  :        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11238, c_first_name#420 AS customer_first_name#11239, c_last_name#421 AS customer_last_name#11240, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11241, c_birth_country#426 AS customer_birth_country#11242, c_login#427 AS customer_login#11243, c_email_address#428 AS customer_email_address#11244, d_year#498 AS dyear#11245, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11246, s AS sale_type#11247]
               :  :  :        :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :        :     +- Join Inner
               :  :  :        :        :- Join Inner
               :  :  :        :        :  :- SubqueryAlias `customer`
               :  :  :        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :        :        :  +- SubqueryAlias `store_sales`
               :  :  :        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :        :        +- SubqueryAlias `date_dim`
               :  :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11248, c_first_name#420 AS customer_first_name#11249, c_last_name#421 AS customer_last_name#11250, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11251, c_birth_country#426 AS customer_birth_country#11252, c_login#427 AS customer_login#11253, c_email_address#428 AS customer_email_address#11254, d_year#498 AS dyear#11255, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11256, w AS sale_type#11257]
               :  :  :           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :              +- Join Inner
               :  :  :                 :- Join Inner
               :  :  :                 :  :- SubqueryAlias `customer`
               :  :  :                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :                 :  +- SubqueryAlias `web_sales`
               :  :  :                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :                 +- SubqueryAlias `date_dim`
               :  :  :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  +- SubqueryAlias `t_s_secyear`
               :  :     +- SubqueryAlias `year_total`
               :  :        +- Union
               :  :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11260, c_first_name#420 AS customer_first_name#11261, c_last_name#421 AS customer_last_name#11262, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11263, c_birth_country#426 AS customer_birth_country#11264, c_login#427 AS customer_login#11265, c_email_address#428 AS customer_email_address#11266, d_year#498 AS dyear#11267, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11268, s AS sale_type#11269]
               :  :           :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :           :     +- Join Inner
               :  :           :        :- Join Inner
               :  :           :        :  :- SubqueryAlias `customer`
               :  :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :        :  +- SubqueryAlias `store_sales`
               :  :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :        +- SubqueryAlias `date_dim`
               :  :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11248, c_first_name#420 AS customer_first_name#11249, c_last_name#421 AS customer_last_name#11250, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11251, c_birth_country#426 AS customer_birth_country#11252, c_login#427 AS customer_login#11253, c_email_address#428 AS customer_email_address#11254, d_year#498 AS dyear#11255, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11256, w AS sale_type#11257]
               :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :                 +- Join Inner
               :  :                    :- Join Inner
               :  :                    :  :- SubqueryAlias `customer`
               :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :                    :  +- SubqueryAlias `web_sales`
               :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :                    +- SubqueryAlias `date_dim`
               :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `t_w_firstyear`
               :     +- SubqueryAlias `year_total`
               :        +- Union
               :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11270, c_first_name#420 AS customer_first_name#11271, c_last_name#421 AS customer_last_name#11272, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11273, c_birth_country#426 AS customer_birth_country#11274, c_login#427 AS customer_login#11275, c_email_address#428 AS customer_email_address#11276, d_year#498 AS dyear#11277, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11278, s AS sale_type#11279]
               :           :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :           :     +- Join Inner
               :           :        :- Join Inner
               :           :        :  :- SubqueryAlias `customer`
               :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :        :  +- SubqueryAlias `store_sales`
               :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11248, c_first_name#420 AS customer_first_name#11249, c_last_name#421 AS customer_last_name#11250, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11251, c_birth_country#426 AS customer_birth_country#11252, c_login#427 AS customer_login#11253, c_email_address#428 AS customer_email_address#11254, d_year#498 AS dyear#11255, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11256, w AS sale_type#11257]
               :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :                 +- Join Inner
               :                    :- Join Inner
               :                    :  :- SubqueryAlias `customer`
               :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :                    :  +- SubqueryAlias `web_sales`
               :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `t_w_secyear`
                  +- SubqueryAlias `year_total`
                     +- Union
                        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11280, c_first_name#420 AS customer_first_name#11281, c_last_name#421 AS customer_last_name#11282, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11283, c_birth_country#426 AS customer_birth_country#11284, c_login#427 AS customer_login#11285, c_email_address#428 AS customer_email_address#11286, d_year#498 AS dyear#11287, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11288, s AS sale_type#11289]
                        :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
                        :     +- Join Inner
                        :        :- Join Inner
                        :        :  :- SubqueryAlias `customer`
                        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :        :  +- SubqueryAlias `store_sales`
                        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11248, c_first_name#420 AS customer_first_name#11249, c_last_name#421 AS customer_last_name#11250, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11251, c_birth_country#426 AS customer_birth_country#11252, c_login#427 AS customer_login#11253, c_email_address#428 AS customer_email_address#11254, d_year#498 AS dyear#11255, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11256, w AS sale_type#11257]
                           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `customer`
                                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                                 :  +- SubqueryAlias `web_sales`
                                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:16:35 INFO Query: 
== Query: q11-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#11316 ASC NULLS FIRST, customer_first_name#11317 ASC NULLS FIRST, customer_last_name#11318 ASC NULLS FIRST, customer_preferred_cust_flag#11319 ASC NULLS FIRST], true
      +- Project [customer_id#11316, customer_first_name#11317, customer_last_name#11318, customer_preferred_cust_flag#11319]
         +- Filter (((((customer_id#11316 = customer_id#11294) && (customer_id#11294 = customer_id#11336)) && ((customer_id#11294 = customer_id#11326) && (sale_type#11303 = s))) && (((sale_type#11335 = w) && (sale_type#11325 = s)) && (sale_type#11345 = w))) && ((((dyear#11301 = 2001) && (dyear#11323 = (2001 + 1))) && ((dyear#11333 = 2001) && (dyear#11343 = (2001 + 1)))) && (((cast(year_total#11302 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2))) && (cast(year_total#11334 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2)))) && (CASE WHEN (cast(year_total#11334 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2))) THEN CheckOverflow((promote_precision(cast(year_total#11344 as decimal(18,2))) / promote_precision(cast(year_total#11334 as decimal(18,2)))), DecimalType(38,20)) ELSE cast(0.0 as decimal(38,20)) END > CASE WHEN (cast(year_total#11302 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2))) THEN CheckOverflow((promote_precision(cast(year_total#11324 as decimal(18,2))) / promote_precision(cast(year_total#11302 as decimal(18,2)))), DecimalType(38,20)) ELSE cast(0.0 as decimal(38,20)) END))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `t_s_firstyear`
               :  :  :  +- SubqueryAlias `year_total`
               :  :  :     +- Union
               :  :  :        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11294, c_first_name#420 AS customer_first_name#11295, c_last_name#421 AS customer_last_name#11296, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11297, c_birth_country#426 AS customer_birth_country#11298, c_login#427 AS customer_login#11299, c_email_address#428 AS customer_email_address#11300, d_year#498 AS dyear#11301, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11302, s AS sale_type#11303]
               :  :  :        :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :        :     +- Join Inner
               :  :  :        :        :- Join Inner
               :  :  :        :        :  :- SubqueryAlias `customer`
               :  :  :        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :        :        :  +- SubqueryAlias `store_sales`
               :  :  :        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :        :        +- SubqueryAlias `date_dim`
               :  :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11304, c_first_name#420 AS customer_first_name#11305, c_last_name#421 AS customer_last_name#11306, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11307, c_birth_country#426 AS customer_birth_country#11308, c_login#427 AS customer_login#11309, c_email_address#428 AS customer_email_address#11310, d_year#498 AS dyear#11311, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11312, w AS sale_type#11313]
               :  :  :           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :              +- Join Inner
               :  :  :                 :- Join Inner
               :  :  :                 :  :- SubqueryAlias `customer`
               :  :  :                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :                 :  +- SubqueryAlias `web_sales`
               :  :  :                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :                 +- SubqueryAlias `date_dim`
               :  :  :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  +- SubqueryAlias `t_s_secyear`
               :  :     +- SubqueryAlias `year_total`
               :  :        +- Union
               :  :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11316, c_first_name#420 AS customer_first_name#11317, c_last_name#421 AS customer_last_name#11318, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11319, c_birth_country#426 AS customer_birth_country#11320, c_login#427 AS customer_login#11321, c_email_address#428 AS customer_email_address#11322, d_year#498 AS dyear#11323, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11324, s AS sale_type#11325]
               :  :           :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :           :     +- Join Inner
               :  :           :        :- Join Inner
               :  :           :        :  :- SubqueryAlias `customer`
               :  :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :        :  +- SubqueryAlias `store_sales`
               :  :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :        +- SubqueryAlias `date_dim`
               :  :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11304, c_first_name#420 AS customer_first_name#11305, c_last_name#421 AS customer_last_name#11306, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11307, c_birth_country#426 AS customer_birth_country#11308, c_login#427 AS customer_login#11309, c_email_address#428 AS customer_email_address#11310, d_year#498 AS dyear#11311, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11312, w AS sale_type#11313]
               :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :                 +- Join Inner
               :  :                    :- Join Inner
               :  :                    :  :- SubqueryAlias `customer`
               :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :                    :  +- SubqueryAlias `web_sales`
               :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :                    +- SubqueryAlias `date_dim`
               :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `t_w_firstyear`
               :     +- SubqueryAlias `year_total`
               :        +- Union
               :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11326, c_first_name#420 AS customer_first_name#11327, c_last_name#421 AS customer_last_name#11328, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11329, c_birth_country#426 AS customer_birth_country#11330, c_login#427 AS customer_login#11331, c_email_address#428 AS customer_email_address#11332, d_year#498 AS dyear#11333, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11334, s AS sale_type#11335]
               :           :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :           :     +- Join Inner
               :           :        :- Join Inner
               :           :        :  :- SubqueryAlias `customer`
               :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :        :  +- SubqueryAlias `store_sales`
               :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11304, c_first_name#420 AS customer_first_name#11305, c_last_name#421 AS customer_last_name#11306, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11307, c_birth_country#426 AS customer_birth_country#11308, c_login#427 AS customer_login#11309, c_email_address#428 AS customer_email_address#11310, d_year#498 AS dyear#11311, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11312, w AS sale_type#11313]
               :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :                 +- Join Inner
               :                    :- Join Inner
               :                    :  :- SubqueryAlias `customer`
               :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :                    :  +- SubqueryAlias `web_sales`
               :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `t_w_secyear`
                  +- SubqueryAlias `year_total`
                     +- Union
                        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11336, c_first_name#420 AS customer_first_name#11337, c_last_name#421 AS customer_last_name#11338, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11339, c_birth_country#426 AS customer_birth_country#11340, c_login#427 AS customer_login#11341, c_email_address#428 AS customer_email_address#11342, d_year#498 AS dyear#11343, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11344, s AS sale_type#11345]
                        :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
                        :     +- Join Inner
                        :        :- Join Inner
                        :        :  :- SubqueryAlias `customer`
                        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :        :  +- SubqueryAlias `store_sales`
                        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11304, c_first_name#420 AS customer_first_name#11305, c_last_name#421 AS customer_last_name#11306, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11307, c_birth_country#426 AS customer_birth_country#11308, c_login#427 AS customer_login#11309, c_email_address#428 AS customer_email_address#11310, d_year#498 AS dyear#11311, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11312, w AS sale_type#11313]
                           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `customer`
                                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                                 :  +- SubqueryAlias `web_sales`
                                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 18.138428886s
Running execution q12-v2.4 iteration: 1, StandardRun=true
19/09/08 18:16:55 INFO Query: 
== Query: q12-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#576 ASC NULLS FIRST, i_class#574 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, revenueratio#11497 ASC NULLS FIRST], true
      +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#11496, revenueratio#11497]
         +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#11496, _w0#11502, _w1#11503, _we0#11504, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(_w0#11502 as decimal(17,2))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(17,2)))), DecimalType(21,2)) as decimal(27,2))) / promote_precision(cast(_we0#11504 as decimal(27,2)))), DecimalType(38,17)) AS revenueratio#11497]
            +- Window [sum(_w1#11503) windowspecdefinition(i_class#574, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#11504], [i_class#574]
               +- Aggregate [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569], [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, sum(ws_ext_sales_price#239) AS itemrevenue#11496, sum(ws_ext_sales_price#239) AS _w0#11502, sum(ws_ext_sales_price#239) AS _w1#11503]
                  +- Filter (((ws_item_sk#219 = i_item_sk#564) && i_category#576 IN (Sports,Books,Home)) && ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_date#494 >= cast(1999-02-22 as date)) && (d_date#494 <= cast(cast(cast(1999-02-22 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `web_sales`
                        :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  +- SubqueryAlias `item`
                        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:16:55 INFO Query: 
== Query: q12-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#576 ASC NULLS FIRST, i_class#574 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, revenueratio#11513 ASC NULLS FIRST], true
      +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#11512, revenueratio#11513]
         +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#11512, _w0#11518, _w1#11519, _we0#11520, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(_w0#11518 as decimal(17,2))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(17,2)))), DecimalType(21,2)) as decimal(27,2))) / promote_precision(cast(_we0#11520 as decimal(27,2)))), DecimalType(38,17)) AS revenueratio#11513]
            +- Window [sum(_w1#11519) windowspecdefinition(i_class#574, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#11520], [i_class#574]
               +- Aggregate [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569], [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, sum(ws_ext_sales_price#239) AS itemrevenue#11512, sum(ws_ext_sales_price#239) AS _w0#11518, sum(ws_ext_sales_price#239) AS _w1#11519]
                  +- Filter (((ws_item_sk#219 = i_item_sk#564) && i_category#576 IN (Sports,Books,Home)) && ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_date#494 >= cast(1999-02-22 as date)) && (d_date#494 <= cast(cast(cast(1999-02-22 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `web_sales`
                        :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  +- SubqueryAlias `item`
                        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 3.145186824s
Running execution q13-v2.4 iteration: 1, StandardRun=true
19/09/08 18:16:59 INFO Query: 
== Query: q13-v2.4 ==
Aggregate [avg(cast(ss_quantity#140 as bigint)) AS avg(ss_quantity)#11593, avg(ss_ext_sales_price#145) AS avg(ss_ext_sales_price)#11594, avg(ss_ext_wholesale_cost#146) AS avg(ss_ext_wholesale_cost)#11595, sum(ss_ext_wholesale_cost#146) AS sum(ss_ext_wholesale_cost)#11596]
+- Filter ((((s_store_sk#664 = ss_store_sk#137) && (ss_sold_date_sk#130 = d_date_sk#492)) && (d_year#498 = 2001)) && (((((((ss_hdemo_sk#135 = hd_demo_sk#548) && (cd_demo_sk#474 = ss_cdemo_sk#134)) && (cd_marital_status#476 = M)) && (((cd_education_status#477 = Advanced Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(100.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(150.00 as decimal(7,2))))) && (hd_dep_count#551 = 3))) || ((((ss_hdemo_sk#135 = hd_demo_sk#548) && (cd_demo_sk#474 = ss_cdemo_sk#134)) && (cd_marital_status#476 = S)) && (((cd_education_status#477 = College) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(50.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(100.00 as decimal(7,2))))) && (hd_dep_count#551 = 1)))) || ((((ss_hdemo_sk#135 = hd_demo_sk#548) && (cd_demo_sk#474 = ss_cdemo_sk#134)) && (cd_marital_status#476 = W)) && (((cd_education_status#477 = 2 yr Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(150.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(200.00 as decimal(7,2))))) && (hd_dep_count#551 = 1)))) && (((((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (TX,OH,TX) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(100 as decimal(3,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(200 as decimal(3,0)) as decimal(7,2)))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (OR,NM,KY) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(150 as decimal(3,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(300 as decimal(3,0)) as decimal(7,2))))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (VA,TX,MS) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(250 as decimal(3,0)) as decimal(7,2)))))))))
   +- Join Inner
      :- Join Inner
      :  :- Join Inner
      :  :  :- Join Inner
      :  :  :  :- Join Inner
      :  :  :  :  :- SubqueryAlias `store_sales`
      :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
      :  :  :  :  +- SubqueryAlias `store`
      :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
      :  :  :  +- SubqueryAlias `customer_demographics`
      :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
      :  :  +- SubqueryAlias `household_demographics`
      :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
      :  +- SubqueryAlias `customer_address`
      :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
      +- SubqueryAlias `date_dim`
         +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:16:59 INFO Query: 
== Query: q13-v2.4 ==
Aggregate [avg(cast(ss_quantity#140 as bigint)) AS avg(ss_quantity)#11605, avg(ss_ext_sales_price#145) AS avg(ss_ext_sales_price)#11606, avg(ss_ext_wholesale_cost#146) AS avg(ss_ext_wholesale_cost)#11607, sum(ss_ext_wholesale_cost#146) AS sum(ss_ext_wholesale_cost)#11608]
+- Filter ((((s_store_sk#664 = ss_store_sk#137) && (ss_sold_date_sk#130 = d_date_sk#492)) && (d_year#498 = 2001)) && (((((((ss_hdemo_sk#135 = hd_demo_sk#548) && (cd_demo_sk#474 = ss_cdemo_sk#134)) && (cd_marital_status#476 = M)) && (((cd_education_status#477 = Advanced Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(100.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(150.00 as decimal(7,2))))) && (hd_dep_count#551 = 3))) || ((((ss_hdemo_sk#135 = hd_demo_sk#548) && (cd_demo_sk#474 = ss_cdemo_sk#134)) && (cd_marital_status#476 = S)) && (((cd_education_status#477 = College) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(50.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(100.00 as decimal(7,2))))) && (hd_dep_count#551 = 1)))) || ((((ss_hdemo_sk#135 = hd_demo_sk#548) && (cd_demo_sk#474 = ss_cdemo_sk#134)) && (cd_marital_status#476 = W)) && (((cd_education_status#477 = 2 yr Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(150.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(200.00 as decimal(7,2))))) && (hd_dep_count#551 = 1)))) && (((((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (TX,OH,TX) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(100 as decimal(3,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(200 as decimal(3,0)) as decimal(7,2)))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (OR,NM,KY) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(150 as decimal(3,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(300 as decimal(3,0)) as decimal(7,2))))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (VA,TX,MS) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(250 as decimal(3,0)) as decimal(7,2)))))))))
   +- Join Inner
      :- Join Inner
      :  :- Join Inner
      :  :  :- Join Inner
      :  :  :  :- Join Inner
      :  :  :  :  :- SubqueryAlias `store_sales`
      :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
      :  :  :  :  +- SubqueryAlias `store`
      :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
      :  :  :  +- SubqueryAlias `customer_demographics`
      :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
      :  :  +- SubqueryAlias `household_demographics`
      :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
      :  +- SubqueryAlias `customer_address`
      :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
      +- SubqueryAlias `date_dim`
         +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 7.456327457s
Running execution q14a-v2.4 iteration: 1, StandardRun=true
19/09/08 18:17:10 INFO Query: 
== Query: q14a-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#11832 ASC NULLS FIRST, i_brand_id#11833 ASC NULLS FIRST, i_class_id#11834 ASC NULLS FIRST, i_category_id#11835 ASC NULLS FIRST], true
      +- Aggregate [channel#11832, i_brand_id#11833, i_class_id#11834, i_category_id#11835, spark_grouping_id#11827], [channel#11832, i_brand_id#11833, i_class_id#11834, i_category_id#11835, sum(sales#11779) AS sum(sales)#11822, sum(number_sales#11780L) AS sum(number_sales)#11823L]
         +- Expand [List(channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, channel#11828, i_brand_id#11829, i_class_id#11830, i_category_id#11831, 0), List(channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, channel#11828, i_brand_id#11829, i_class_id#11830, null, 1), List(channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, channel#11828, i_brand_id#11829, null, null, 3), List(channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, channel#11828, null, null, null, 7), List(channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, null, null, null, null, 15)], [channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, channel#11832, i_brand_id#11833, i_class_id#11834, i_category_id#11835, spark_grouping_id#11827]
            +- Project [channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, channel#11778 AS channel#11828, i_brand_id#571 AS i_brand_id#11829, i_class_id#573 AS i_class_id#11830, i_category_id#575 AS i_category_id#11831]
               +- SubqueryAlias `y`
                  +- Union
                     :- Union
                     :  :- Project [channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L]
                     :  :  +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#11813 as decimal(32,6)) > cast(scalar-subquery#11782 [] as decimal(32,6)))
                     :  :     :  +- Project [average_sales#11803]
                     :  :     :     +- SubqueryAlias `avg_sales`
                     :  :     :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#11797 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#11798 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#11803]
                     :  :     :           +- SubqueryAlias `x`
                     :  :     :              +- Union
                     :  :     :                 :- Union
                     :  :     :                 :  :- Project [ss_quantity#140 AS quantity#11797, ss_list_price#142 AS list_price#11798]
                     :  :     :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= 2001)))
                     :  :     :                 :  :     +- Join Inner
                     :  :     :                 :  :        :- SubqueryAlias `store_sales`
                     :  :     :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :     :                 :  :        +- SubqueryAlias `date_dim`
                     :  :     :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :     :                 :  +- Project [cs_quantity#18 AS quantity#11799, cs_list_price#20 AS list_price#11800]
                     :  :     :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :     :                 :        +- Join Inner
                     :  :     :                 :           :- SubqueryAlias `catalog_sales`
                     :  :     :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :  :     :                 :           +- SubqueryAlias `date_dim`
                     :  :     :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :     :                 +- Project [ws_quantity#234 AS quantity#11801, ws_list_price#236 AS list_price#11802]
                     :  :     :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :     :                       +- Join Inner
                     :  :     :                          :- SubqueryAlias `web_sales`
                     :  :     :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :  :     :                          +- SubqueryAlias `date_dim`
                     :  :     :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :     +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [store AS channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sales#11779, count(1) AS number_sales#11780L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#11813]
                     :  :        +- Filter (((ss_item_sk#132 IN (list#11781 []) && (ss_item_sk#132 = i_item_sk#564)) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = (1999 + 2)) && (d_moy#500 = 11)))
                     :  :           :  +- Project [ss_item_sk#11796]
                     :  :           :     +- SubqueryAlias `cross_items`
                     :  :           :        +- Project [i_item_sk#564 AS ss_item_sk#11796]
                     :  :           :           +- Filter (((i_brand_id#571 = brand_id#11793) && (i_class_id#573 = class_id#11794)) && (i_category_id#575 = category_id#11795))
                     :  :           :              +- Join Inner
                     :  :           :                 :- SubqueryAlias `item`
                     :  :           :                 :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                 +- SubqueryAlias `x`
                     :  :           :                    +- Intersect false
                     :  :           :                       :- Intersect false
                     :  :           :                       :  :- Project [i_brand_id#571 AS brand_id#11793, i_class_id#573 AS class_id#11794, i_category_id#575 AS category_id#11795]
                     :  :           :                       :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :           :                       :  :     +- Join Inner
                     :  :           :                       :  :        :- Join Inner
                     :  :           :                       :  :        :  :- SubqueryAlias `store_sales`
                     :  :           :                       :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :           :                       :  :        :  +- SubqueryAlias `iss`
                     :  :           :                       :  :        :     +- SubqueryAlias `item`
                     :  :           :                       :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                       :  :        +- SubqueryAlias `d1`
                     :  :           :                       :  :           +- SubqueryAlias `date_dim`
                     :  :           :                       :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :           :                       :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :  :           :                       :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :           :                       :        +- Join Inner
                     :  :           :                       :           :- Join Inner
                     :  :           :                       :           :  :- SubqueryAlias `catalog_sales`
                     :  :           :                       :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :  :           :                       :           :  +- SubqueryAlias `ics`
                     :  :           :                       :           :     +- SubqueryAlias `item`
                     :  :           :                       :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                       :           +- SubqueryAlias `d2`
                     :  :           :                       :              +- SubqueryAlias `date_dim`
                     :  :           :                       :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :           :                       +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :  :           :                          +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :           :                             +- Join Inner
                     :  :           :                                :- Join Inner
                     :  :           :                                :  :- SubqueryAlias `web_sales`
                     :  :           :                                :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :  :           :                                :  +- SubqueryAlias `iws`
                     :  :           :                                :     +- SubqueryAlias `item`
                     :  :           :                                :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                                +- SubqueryAlias `d3`
                     :  :           :                                   +- SubqueryAlias `date_dim`
                     :  :           :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- SubqueryAlias `store_sales`
                     :  :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :              :  +- SubqueryAlias `item`
                     :  :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :              +- SubqueryAlias `date_dim`
                     :  :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- Project [channel#11783, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11784, number_sales#11785L]
                     :     +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2)))#11816 as decimal(32,6)) > cast(scalar-subquery#11787 [] as decimal(32,6)))
                     :        :  +- Project [average_sales#11803]
                     :        :     +- SubqueryAlias `avg_sales`
                     :        :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#11797 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#11798 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#11803]
                     :        :           +- SubqueryAlias `x`
                     :        :              +- Union
                     :        :                 :- Union
                     :        :                 :  :- Project [ss_quantity#140 AS quantity#11797, ss_list_price#142 AS list_price#11798]
                     :        :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= 2001)))
                     :        :                 :  :     +- Join Inner
                     :        :                 :  :        :- SubqueryAlias `store_sales`
                     :        :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :        :                 :  :        +- SubqueryAlias `date_dim`
                     :        :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :        :                 :  +- Project [cs_quantity#18 AS quantity#11799, cs_list_price#20 AS list_price#11800]
                     :        :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :        :                 :        +- Join Inner
                     :        :                 :           :- SubqueryAlias `catalog_sales`
                     :        :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :        :                 :           +- SubqueryAlias `date_dim`
                     :        :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :        :                 +- Project [ws_quantity#234 AS quantity#11801, ws_list_price#236 AS list_price#11802]
                     :        :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :        :                       +- Join Inner
                     :        :                          :- SubqueryAlias `web_sales`
                     :        :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :        :                          +- SubqueryAlias `date_dim`
                     :        :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :        +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [catalog AS channel#11783, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2))) AS sales#11784, count(1) AS number_sales#11785L, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2)))#11816]
                     :           +- Filter (((cs_item_sk#15 IN (list#11786 []) && (cs_item_sk#15 = i_item_sk#564)) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = (1999 + 2)) && (d_moy#500 = 11)))
                     :              :  +- Project [ss_item_sk#11796]
                     :              :     +- SubqueryAlias `cross_items`
                     :              :        +- Project [i_item_sk#564 AS ss_item_sk#11796]
                     :              :           +- Filter (((i_brand_id#571 = brand_id#11793) && (i_class_id#573 = class_id#11794)) && (i_category_id#575 = category_id#11795))
                     :              :              +- Join Inner
                     :              :                 :- SubqueryAlias `item`
                     :              :                 :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                 +- SubqueryAlias `x`
                     :              :                    +- Intersect false
                     :              :                       :- Intersect false
                     :              :                       :  :- Project [i_brand_id#571 AS brand_id#11793, i_class_id#573 AS class_id#11794, i_category_id#575 AS category_id#11795]
                     :              :                       :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :              :                       :  :     +- Join Inner
                     :              :                       :  :        :- Join Inner
                     :              :                       :  :        :  :- SubqueryAlias `store_sales`
                     :              :                       :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :              :                       :  :        :  +- SubqueryAlias `iss`
                     :              :                       :  :        :     +- SubqueryAlias `item`
                     :              :                       :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                       :  :        +- SubqueryAlias `d1`
                     :              :                       :  :           +- SubqueryAlias `date_dim`
                     :              :                       :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              :                       :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :              :                       :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :              :                       :        +- Join Inner
                     :              :                       :           :- Join Inner
                     :              :                       :           :  :- SubqueryAlias `catalog_sales`
                     :              :                       :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :              :                       :           :  +- SubqueryAlias `ics`
                     :              :                       :           :     +- SubqueryAlias `item`
                     :              :                       :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                       :           +- SubqueryAlias `d2`
                     :              :                       :              +- SubqueryAlias `date_dim`
                     :              :                       :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              :                       +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :              :                          +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :              :                             +- Join Inner
                     :              :                                :- Join Inner
                     :              :                                :  :- SubqueryAlias `web_sales`
                     :              :                                :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :              :                                :  +- SubqueryAlias `iws`
                     :              :                                :     +- SubqueryAlias `item`
                     :              :                                :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                                +- SubqueryAlias `d3`
                     :              :                                   +- SubqueryAlias `date_dim`
                     :              :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              +- Join Inner
                     :                 :- Join Inner
                     :                 :  :- SubqueryAlias `catalog_sales`
                     :                 :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :                 :  +- SubqueryAlias `item`
                     :                 :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :                 +- SubqueryAlias `date_dim`
                     :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- Project [channel#11788, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11789, number_sales#11790L]
                        +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2)))#11819 as decimal(32,6)) > cast(scalar-subquery#11792 [] as decimal(32,6)))
                           :  +- Project [average_sales#11803]
                           :     +- SubqueryAlias `avg_sales`
                           :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#11797 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#11798 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#11803]
                           :           +- SubqueryAlias `x`
                           :              +- Union
                           :                 :- Union
                           :                 :  :- Project [ss_quantity#140 AS quantity#11797, ss_list_price#142 AS list_price#11798]
                           :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= 2001)))
                           :                 :  :     +- Join Inner
                           :                 :  :        :- SubqueryAlias `store_sales`
                           :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                 :  :        +- SubqueryAlias `date_dim`
                           :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :                 :  +- Project [cs_quantity#18 AS quantity#11799, cs_list_price#20 AS list_price#11800]
                           :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                           :                 :        +- Join Inner
                           :                 :           :- SubqueryAlias `catalog_sales`
                           :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :                 :           +- SubqueryAlias `date_dim`
                           :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :                 +- Project [ws_quantity#234 AS quantity#11801, ws_list_price#236 AS list_price#11802]
                           :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                           :                       +- Join Inner
                           :                          :- SubqueryAlias `web_sales`
                           :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :                          +- SubqueryAlias `date_dim`
                           :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [web AS channel#11788, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2))) AS sales#11789, count(1) AS number_sales#11790L, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2)))#11819]
                              +- Filter (((ws_item_sk#219 IN (list#11791 []) && (ws_item_sk#219 = i_item_sk#564)) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = (1999 + 2)) && (d_moy#500 = 11)))
                                 :  +- Project [ss_item_sk#11796]
                                 :     +- SubqueryAlias `cross_items`
                                 :        +- Project [i_item_sk#564 AS ss_item_sk#11796]
                                 :           +- Filter (((i_brand_id#571 = brand_id#11793) && (i_class_id#573 = class_id#11794)) && (i_category_id#575 = category_id#11795))
                                 :              +- Join Inner
                                 :                 :- SubqueryAlias `item`
                                 :                 :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                 +- SubqueryAlias `x`
                                 :                    +- Intersect false
                                 :                       :- Intersect false
                                 :                       :  :- Project [i_brand_id#571 AS brand_id#11793, i_class_id#573 AS class_id#11794, i_category_id#575 AS category_id#11795]
                                 :                       :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                                 :                       :  :     +- Join Inner
                                 :                       :  :        :- Join Inner
                                 :                       :  :        :  :- SubqueryAlias `store_sales`
                                 :                       :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :                       :  :        :  +- SubqueryAlias `iss`
                                 :                       :  :        :     +- SubqueryAlias `item`
                                 :                       :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                       :  :        +- SubqueryAlias `d1`
                                 :                       :  :           +- SubqueryAlias `date_dim`
                                 :                       :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 :                       :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                                 :                       :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                                 :                       :        +- Join Inner
                                 :                       :           :- Join Inner
                                 :                       :           :  :- SubqueryAlias `catalog_sales`
                                 :                       :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                                 :                       :           :  +- SubqueryAlias `ics`
                                 :                       :           :     +- SubqueryAlias `item`
                                 :                       :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                       :           +- SubqueryAlias `d2`
                                 :                       :              +- SubqueryAlias `date_dim`
                                 :                       :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 :                       +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                                 :                          +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                                 :                             +- Join Inner
                                 :                                :- Join Inner
                                 :                                :  :- SubqueryAlias `web_sales`
                                 :                                :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 :                                :  +- SubqueryAlias `iws`
                                 :                                :     +- SubqueryAlias `item`
                                 :                                :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                                +- SubqueryAlias `d3`
                                 :                                   +- SubqueryAlias `date_dim`
                                 :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- SubqueryAlias `web_sales`
                                    :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  +- SubqueryAlias `item`
                                    :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                    +- SubqueryAlias `date_dim`
                                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:17:11 INFO Query: 
== Query: q14a-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#11915 ASC NULLS FIRST, i_brand_id#11916 ASC NULLS FIRST, i_class_id#11917 ASC NULLS FIRST, i_category_id#11918 ASC NULLS FIRST], true
      +- Aggregate [channel#11915, i_brand_id#11916, i_class_id#11917, i_category_id#11918, spark_grouping_id#11910], [channel#11915, i_brand_id#11916, i_class_id#11917, i_category_id#11918, sum(sales#11862) AS sum(sales)#11905, sum(number_sales#11863L) AS sum(number_sales)#11906L]
         +- Expand [List(channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, channel#11911, i_brand_id#11912, i_class_id#11913, i_category_id#11914, 0), List(channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, channel#11911, i_brand_id#11912, i_class_id#11913, null, 1), List(channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, channel#11911, i_brand_id#11912, null, null, 3), List(channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, channel#11911, null, null, null, 7), List(channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, null, null, null, null, 15)], [channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, channel#11915, i_brand_id#11916, i_class_id#11917, i_category_id#11918, spark_grouping_id#11910]
            +- Project [channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, channel#11861 AS channel#11911, i_brand_id#571 AS i_brand_id#11912, i_class_id#573 AS i_class_id#11913, i_category_id#575 AS i_category_id#11914]
               +- SubqueryAlias `y`
                  +- Union
                     :- Union
                     :  :- Project [channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L]
                     :  :  +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#11896 as decimal(32,6)) > cast(scalar-subquery#11865 [] as decimal(32,6)))
                     :  :     :  +- Project [average_sales#11886]
                     :  :     :     +- SubqueryAlias `avg_sales`
                     :  :     :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#11880 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#11881 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#11886]
                     :  :     :           +- SubqueryAlias `x`
                     :  :     :              +- Union
                     :  :     :                 :- Union
                     :  :     :                 :  :- Project [ss_quantity#140 AS quantity#11880, ss_list_price#142 AS list_price#11881]
                     :  :     :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= 2001)))
                     :  :     :                 :  :     +- Join Inner
                     :  :     :                 :  :        :- SubqueryAlias `store_sales`
                     :  :     :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :     :                 :  :        +- SubqueryAlias `date_dim`
                     :  :     :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :     :                 :  +- Project [cs_quantity#18 AS quantity#11882, cs_list_price#20 AS list_price#11883]
                     :  :     :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :     :                 :        +- Join Inner
                     :  :     :                 :           :- SubqueryAlias `catalog_sales`
                     :  :     :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :  :     :                 :           +- SubqueryAlias `date_dim`
                     :  :     :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :     :                 +- Project [ws_quantity#234 AS quantity#11884, ws_list_price#236 AS list_price#11885]
                     :  :     :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :     :                       +- Join Inner
                     :  :     :                          :- SubqueryAlias `web_sales`
                     :  :     :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :  :     :                          +- SubqueryAlias `date_dim`
                     :  :     :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :     +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [store AS channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sales#11862, count(1) AS number_sales#11863L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#11896]
                     :  :        +- Filter (((ss_item_sk#132 IN (list#11864 []) && (ss_item_sk#132 = i_item_sk#564)) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = (1999 + 2)) && (d_moy#500 = 11)))
                     :  :           :  +- Project [ss_item_sk#11879]
                     :  :           :     +- SubqueryAlias `cross_items`
                     :  :           :        +- Project [i_item_sk#564 AS ss_item_sk#11879]
                     :  :           :           +- Filter (((i_brand_id#571 = brand_id#11876) && (i_class_id#573 = class_id#11877)) && (i_category_id#575 = category_id#11878))
                     :  :           :              +- Join Inner
                     :  :           :                 :- SubqueryAlias `item`
                     :  :           :                 :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                 +- SubqueryAlias `x`
                     :  :           :                    +- Intersect false
                     :  :           :                       :- Intersect false
                     :  :           :                       :  :- Project [i_brand_id#571 AS brand_id#11876, i_class_id#573 AS class_id#11877, i_category_id#575 AS category_id#11878]
                     :  :           :                       :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :           :                       :  :     +- Join Inner
                     :  :           :                       :  :        :- Join Inner
                     :  :           :                       :  :        :  :- SubqueryAlias `store_sales`
                     :  :           :                       :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :           :                       :  :        :  +- SubqueryAlias `iss`
                     :  :           :                       :  :        :     +- SubqueryAlias `item`
                     :  :           :                       :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                       :  :        +- SubqueryAlias `d1`
                     :  :           :                       :  :           +- SubqueryAlias `date_dim`
                     :  :           :                       :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :           :                       :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :  :           :                       :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :           :                       :        +- Join Inner
                     :  :           :                       :           :- Join Inner
                     :  :           :                       :           :  :- SubqueryAlias `catalog_sales`
                     :  :           :                       :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :  :           :                       :           :  +- SubqueryAlias `ics`
                     :  :           :                       :           :     +- SubqueryAlias `item`
                     :  :           :                       :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                       :           +- SubqueryAlias `d2`
                     :  :           :                       :              +- SubqueryAlias `date_dim`
                     :  :           :                       :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :           :                       +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :  :           :                          +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :           :                             +- Join Inner
                     :  :           :                                :- Join Inner
                     :  :           :                                :  :- SubqueryAlias `web_sales`
                     :  :           :                                :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :  :           :                                :  +- SubqueryAlias `iws`
                     :  :           :                                :     +- SubqueryAlias `item`
                     :  :           :                                :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                                +- SubqueryAlias `d3`
                     :  :           :                                   +- SubqueryAlias `date_dim`
                     :  :           :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- SubqueryAlias `store_sales`
                     :  :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :              :  +- SubqueryAlias `item`
                     :  :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :              +- SubqueryAlias `date_dim`
                     :  :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- Project [channel#11866, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11867, number_sales#11868L]
                     :     +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2)))#11899 as decimal(32,6)) > cast(scalar-subquery#11870 [] as decimal(32,6)))
                     :        :  +- Project [average_sales#11886]
                     :        :     +- SubqueryAlias `avg_sales`
                     :        :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#11880 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#11881 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#11886]
                     :        :           +- SubqueryAlias `x`
                     :        :              +- Union
                     :        :                 :- Union
                     :        :                 :  :- Project [ss_quantity#140 AS quantity#11880, ss_list_price#142 AS list_price#11881]
                     :        :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= 2001)))
                     :        :                 :  :     +- Join Inner
                     :        :                 :  :        :- SubqueryAlias `store_sales`
                     :        :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :        :                 :  :        +- SubqueryAlias `date_dim`
                     :        :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :        :                 :  +- Project [cs_quantity#18 AS quantity#11882, cs_list_price#20 AS list_price#11883]
                     :        :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :        :                 :        +- Join Inner
                     :        :                 :           :- SubqueryAlias `catalog_sales`
                     :        :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :        :                 :           +- SubqueryAlias `date_dim`
                     :        :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :        :                 +- Project [ws_quantity#234 AS quantity#11884, ws_list_price#236 AS list_price#11885]
                     :        :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :        :                       +- Join Inner
                     :        :                          :- SubqueryAlias `web_sales`
                     :        :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :        :                          +- SubqueryAlias `date_dim`
                     :        :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :        +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [catalog AS channel#11866, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2))) AS sales#11867, count(1) AS number_sales#11868L, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2)))#11899]
                     :           +- Filter (((cs_item_sk#15 IN (list#11869 []) && (cs_item_sk#15 = i_item_sk#564)) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = (1999 + 2)) && (d_moy#500 = 11)))
                     :              :  +- Project [ss_item_sk#11879]
                     :              :     +- SubqueryAlias `cross_items`
                     :              :        +- Project [i_item_sk#564 AS ss_item_sk#11879]
                     :              :           +- Filter (((i_brand_id#571 = brand_id#11876) && (i_class_id#573 = class_id#11877)) && (i_category_id#575 = category_id#11878))
                     :              :              +- Join Inner
                     :              :                 :- SubqueryAlias `item`
                     :              :                 :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                 +- SubqueryAlias `x`
                     :              :                    +- Intersect false
                     :              :                       :- Intersect false
                     :              :                       :  :- Project [i_brand_id#571 AS brand_id#11876, i_class_id#573 AS class_id#11877, i_category_id#575 AS category_id#11878]
                     :              :                       :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :              :                       :  :     +- Join Inner
                     :              :                       :  :        :- Join Inner
                     :              :                       :  :        :  :- SubqueryAlias `store_sales`
                     :              :                       :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :              :                       :  :        :  +- SubqueryAlias `iss`
                     :              :                       :  :        :     +- SubqueryAlias `item`
                     :              :                       :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                       :  :        +- SubqueryAlias `d1`
                     :              :                       :  :           +- SubqueryAlias `date_dim`
                     :              :                       :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              :                       :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :              :                       :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :              :                       :        +- Join Inner
                     :              :                       :           :- Join Inner
                     :              :                       :           :  :- SubqueryAlias `catalog_sales`
                     :              :                       :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :              :                       :           :  +- SubqueryAlias `ics`
                     :              :                       :           :     +- SubqueryAlias `item`
                     :              :                       :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                       :           +- SubqueryAlias `d2`
                     :              :                       :              +- SubqueryAlias `date_dim`
                     :              :                       :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              :                       +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :              :                          +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :              :                             +- Join Inner
                     :              :                                :- Join Inner
                     :              :                                :  :- SubqueryAlias `web_sales`
                     :              :                                :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :              :                                :  +- SubqueryAlias `iws`
                     :              :                                :     +- SubqueryAlias `item`
                     :              :                                :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                                +- SubqueryAlias `d3`
                     :              :                                   +- SubqueryAlias `date_dim`
                     :              :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              +- Join Inner
                     :                 :- Join Inner
                     :                 :  :- SubqueryAlias `catalog_sales`
                     :                 :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :                 :  +- SubqueryAlias `item`
                     :                 :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :                 +- SubqueryAlias `date_dim`
                     :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- Project [channel#11871, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11872, number_sales#11873L]
                        +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2)))#11902 as decimal(32,6)) > cast(scalar-subquery#11875 [] as decimal(32,6)))
                           :  +- Project [average_sales#11886]
                           :     +- SubqueryAlias `avg_sales`
                           :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#11880 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#11881 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#11886]
                           :           +- SubqueryAlias `x`
                           :              +- Union
                           :                 :- Union
                           :                 :  :- Project [ss_quantity#140 AS quantity#11880, ss_list_price#142 AS list_price#11881]
                           :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= 2001)))
                           :                 :  :     +- Join Inner
                           :                 :  :        :- SubqueryAlias `store_sales`
                           :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                 :  :        +- SubqueryAlias `date_dim`
                           :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :                 :  +- Project [cs_quantity#18 AS quantity#11882, cs_list_price#20 AS list_price#11883]
                           :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                           :                 :        +- Join Inner
                           :                 :           :- SubqueryAlias `catalog_sales`
                           :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :                 :           +- SubqueryAlias `date_dim`
                           :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :                 +- Project [ws_quantity#234 AS quantity#11884, ws_list_price#236 AS list_price#11885]
                           :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                           :                       +- Join Inner
                           :                          :- SubqueryAlias `web_sales`
                           :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :                          +- SubqueryAlias `date_dim`
                           :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [web AS channel#11871, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2))) AS sales#11872, count(1) AS number_sales#11873L, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2)))#11902]
                              +- Filter (((ws_item_sk#219 IN (list#11874 []) && (ws_item_sk#219 = i_item_sk#564)) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = (1999 + 2)) && (d_moy#500 = 11)))
                                 :  +- Project [ss_item_sk#11879]
                                 :     +- SubqueryAlias `cross_items`
                                 :        +- Project [i_item_sk#564 AS ss_item_sk#11879]
                                 :           +- Filter (((i_brand_id#571 = brand_id#11876) && (i_class_id#573 = class_id#11877)) && (i_category_id#575 = category_id#11878))
                                 :              +- Join Inner
                                 :                 :- SubqueryAlias `item`
                                 :                 :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                 +- SubqueryAlias `x`
                                 :                    +- Intersect false
                                 :                       :- Intersect false
                                 :                       :  :- Project [i_brand_id#571 AS brand_id#11876, i_class_id#573 AS class_id#11877, i_category_id#575 AS category_id#11878]
                                 :                       :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                                 :                       :  :     +- Join Inner
                                 :                       :  :        :- Join Inner
                                 :                       :  :        :  :- SubqueryAlias `store_sales`
                                 :                       :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :                       :  :        :  +- SubqueryAlias `iss`
                                 :                       :  :        :     +- SubqueryAlias `item`
                                 :                       :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                       :  :        +- SubqueryAlias `d1`
                                 :                       :  :           +- SubqueryAlias `date_dim`
                                 :                       :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 :                       :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                                 :                       :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                                 :                       :        +- Join Inner
                                 :                       :           :- Join Inner
                                 :                       :           :  :- SubqueryAlias `catalog_sales`
                                 :                       :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                                 :                       :           :  +- SubqueryAlias `ics`
                                 :                       :           :     +- SubqueryAlias `item`
                                 :                       :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                       :           +- SubqueryAlias `d2`
                                 :                       :              +- SubqueryAlias `date_dim`
                                 :                       :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 :                       +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                                 :                          +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                                 :                             +- Join Inner
                                 :                                :- Join Inner
                                 :                                :  :- SubqueryAlias `web_sales`
                                 :                                :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 :                                :  +- SubqueryAlias `iws`
                                 :                                :     +- SubqueryAlias `item`
                                 :                                :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                                +- SubqueryAlias `d3`
                                 :                                   +- SubqueryAlias `date_dim`
                                 :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- SubqueryAlias `web_sales`
                                    :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  +- SubqueryAlias `item`
                                    :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                    +- SubqueryAlias `date_dim`
                                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 39.169428831s
Running execution q14b-v2.4 iteration: 1, StandardRun=true
19/09/08 18:17:56 INFO Query: 
== Query: q14b-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#12248 ASC NULLS FIRST, i_brand_id#571 ASC NULLS FIRST, i_class_id#573 ASC NULLS FIRST, i_category_id#575 ASC NULLS FIRST], true
      +- Project [channel#12248, i_brand_id#571, i_class_id#573, i_category_id#575, sales#12249, number_sales#12250L, channel#12254, i_brand_id#12289, i_class_id#12291, i_category_id#12293, sales#12255, number_sales#12256L]
         +- Filter (((i_brand_id#571 = i_brand_id#12289) && (i_class_id#573 = i_class_id#12291)) && (i_category_id#575 = i_category_id#12293))
            +- Join Inner
               :- SubqueryAlias `this_year`
               :  +- Project [channel#12248, i_brand_id#571, i_class_id#573, i_category_id#575, sales#12249, number_sales#12250L]
               :     +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12278 as decimal(32,6)) > cast(scalar-subquery#12253 [] as decimal(32,6)))
               :        :  +- Project [average_sales#12270]
               :        :     +- SubqueryAlias `avg_sales`
               :        :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#12264 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#12265 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#12270]
               :        :           +- SubqueryAlias `x`
               :        :              +- Union
               :        :                 :- Union
               :        :                 :  :- Project [ss_quantity#140 AS quantity#12264, ss_list_price#142 AS list_price#12265]
               :        :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :        :                 :  :     +- Join Inner
               :        :                 :  :        :- SubqueryAlias `store_sales`
               :        :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :        :                 :  :        +- SubqueryAlias `date_dim`
               :        :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :        :                 :  +- Project [cs_quantity#18 AS quantity#12266, cs_list_price#20 AS list_price#12267]
               :        :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :        :                 :        +- Join Inner
               :        :                 :           :- SubqueryAlias `catalog_sales`
               :        :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :        :                 :           +- SubqueryAlias `date_dim`
               :        :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :        :                 +- Project [ws_quantity#234 AS quantity#12268, ws_list_price#236 AS list_price#12269]
               :        :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :        :                       +- Join Inner
               :        :                          :- SubqueryAlias `web_sales`
               :        :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :        :                          +- SubqueryAlias `date_dim`
               :        :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :        +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [store AS channel#12248, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sales#12249, count(1) AS number_sales#12250L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12278]
               :           +- Filter ((ss_item_sk#132 IN (list#12251 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_week_seq#496 = scalar-subquery#12252 [])))
               :              :  :- Project [ss_item_sk#12263]
               :              :  :  +- SubqueryAlias `cross_items`
               :              :  :     +- Project [i_item_sk#564 AS ss_item_sk#12263]
               :              :  :        +- Filter (((i_brand_id#571 = brand_id#12260) && (i_class_id#573 = class_id#12261)) && (i_category_id#575 = category_id#12262))
               :              :  :           +- Join Inner
               :              :  :              :- SubqueryAlias `item`
               :              :  :              :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :              +- SubqueryAlias `x`
               :              :  :                 +- Intersect false
               :              :  :                    :- Intersect false
               :              :  :                    :  :- Project [i_brand_id#571 AS brand_id#12260, i_class_id#573 AS class_id#12261, i_category_id#575 AS category_id#12262]
               :              :  :                    :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :              :  :                    :  :     +- Join Inner
               :              :  :                    :  :        :- Join Inner
               :              :  :                    :  :        :  :- SubqueryAlias `store_sales`
               :              :  :                    :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :              :  :                    :  :        :  +- SubqueryAlias `iss`
               :              :  :                    :  :        :     +- SubqueryAlias `item`
               :              :  :                    :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :                    :  :        +- SubqueryAlias `d1`
               :              :  :                    :  :           +- SubqueryAlias `date_dim`
               :              :  :                    :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              :  :                    :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
               :              :  :                    :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :              :  :                    :        +- Join Inner
               :              :  :                    :           :- Join Inner
               :              :  :                    :           :  :- SubqueryAlias `catalog_sales`
               :              :  :                    :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :              :  :                    :           :  +- SubqueryAlias `ics`
               :              :  :                    :           :     +- SubqueryAlias `item`
               :              :  :                    :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :                    :           +- SubqueryAlias `d2`
               :              :  :                    :              +- SubqueryAlias `date_dim`
               :              :  :                    :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              :  :                    +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
               :              :  :                       +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :              :  :                          +- Join Inner
               :              :  :                             :- Join Inner
               :              :  :                             :  :- SubqueryAlias `web_sales`
               :              :  :                             :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :              :  :                             :  +- SubqueryAlias `iws`
               :              :  :                             :     +- SubqueryAlias `item`
               :              :  :                             :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :                             +- SubqueryAlias `d3`
               :              :  :                                +- SubqueryAlias `date_dim`
               :              :  :                                   +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              :  +- Project [d_week_seq#496]
               :              :     +- Filter (((d_year#498 = (1999 + 1)) && (d_moy#500 = 12)) && (d_dom#501 = 11))
               :              :        +- SubqueryAlias `date_dim`
               :              :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- SubqueryAlias `store_sales`
               :                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :                 :  +- SubqueryAlias `item`
               :                 :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                 +- SubqueryAlias `date_dim`
               :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `last_year`
                  +- Project [channel#12254, i_brand_id#12289, i_class_id#12291, i_category_id#12293, sales#12255, number_sales#12256L]
                     +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12281 as decimal(32,6)) > cast(scalar-subquery#12259 [] as decimal(32,6)))
                        :  +- Project [average_sales#12270]
                        :     +- SubqueryAlias `avg_sales`
                        :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#12264 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#12265 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#12270]
                        :           +- SubqueryAlias `x`
                        :              +- Union
                        :                 :- Union
                        :                 :  :- Project [ss_quantity#140 AS quantity#12264, ss_list_price#142 AS list_price#12265]
                        :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                        :                 :  :     +- Join Inner
                        :                 :  :        :- SubqueryAlias `store_sales`
                        :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :                 :  :        +- SubqueryAlias `date_dim`
                        :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :                 :  +- Project [cs_quantity#18 AS quantity#12266, cs_list_price#20 AS list_price#12267]
                        :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                        :                 :        +- Join Inner
                        :                 :           :- SubqueryAlias `catalog_sales`
                        :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :                 :           +- SubqueryAlias `date_dim`
                        :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :                 +- Project [ws_quantity#234 AS quantity#12268, ws_list_price#236 AS list_price#12269]
                        :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                        :                       +- Join Inner
                        :                          :- SubqueryAlias `web_sales`
                        :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :                          +- SubqueryAlias `date_dim`
                        :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [i_brand_id#12289, i_class_id#12291, i_category_id#12293], [store AS channel#12254, i_brand_id#12289, i_class_id#12291, i_category_id#12293, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sales#12255, count(1) AS number_sales#12256L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12281]
                           +- Filter ((ss_item_sk#132 IN (list#12257 []) && (ss_item_sk#132 = i_item_sk#12282)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_week_seq#496 = scalar-subquery#12258 [])))
                              :  :- Project [ss_item_sk#12263]
                              :  :  +- SubqueryAlias `cross_items`
                              :  :     +- Project [i_item_sk#564 AS ss_item_sk#12263]
                              :  :        +- Filter (((i_brand_id#571 = brand_id#12260) && (i_class_id#573 = class_id#12261)) && (i_category_id#575 = category_id#12262))
                              :  :           +- Join Inner
                              :  :              :- SubqueryAlias `item`
                              :  :              :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :              +- SubqueryAlias `x`
                              :  :                 +- Intersect false
                              :  :                    :- Intersect false
                              :  :                    :  :- Project [i_brand_id#571 AS brand_id#12260, i_class_id#573 AS class_id#12261, i_category_id#575 AS category_id#12262]
                              :  :                    :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                              :  :                    :  :     +- Join Inner
                              :  :                    :  :        :- Join Inner
                              :  :                    :  :        :  :- SubqueryAlias `store_sales`
                              :  :                    :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  :                    :  :        :  +- SubqueryAlias `iss`
                              :  :                    :  :        :     +- SubqueryAlias `item`
                              :  :                    :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :                    :  :        +- SubqueryAlias `d1`
                              :  :                    :  :           +- SubqueryAlias `date_dim`
                              :  :                    :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  :                    :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                              :  :                    :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                              :  :                    :        +- Join Inner
                              :  :                    :           :- Join Inner
                              :  :                    :           :  :- SubqueryAlias `catalog_sales`
                              :  :                    :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                              :  :                    :           :  +- SubqueryAlias `ics`
                              :  :                    :           :     +- SubqueryAlias `item`
                              :  :                    :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :                    :           +- SubqueryAlias `d2`
                              :  :                    :              +- SubqueryAlias `date_dim`
                              :  :                    :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  :                    +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                              :  :                       +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                              :  :                          +- Join Inner
                              :  :                             :- Join Inner
                              :  :                             :  :- SubqueryAlias `web_sales`
                              :  :                             :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :                             :  +- SubqueryAlias `iws`
                              :  :                             :     +- SubqueryAlias `item`
                              :  :                             :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :                             +- SubqueryAlias `d3`
                              :  :                                +- SubqueryAlias `date_dim`
                              :  :                                   +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- Project [d_week_seq#496]
                              :     +- Filter (((d_year#498 = 1999) && (d_moy#500 = 12)) && (d_dom#501 = 11))
                              :        +- SubqueryAlias `date_dim`
                              :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `store_sales`
                                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `item`
                                 :     +- Relation[i_item_sk#12282,i_item_id#12283,i_rec_start_date#12284,i_rec_end_date#12285,i_item_desc#12286,i_current_price#12287,i_wholesale_cost#12288,i_brand_id#12289,i_brand#12290,i_class_id#12291,i_class#12292,i_category_id#12293,i_category#12294,i_manufact_id#12295,i_manufact#12296,i_size#12297,i_formulation#12298,i_color#12299,i_units#12300,i_container#12301,i_manager_id#12302,i_product_name#12303] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:17:57 INFO Query: 
== Query: q14b-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#12320 ASC NULLS FIRST, i_brand_id#571 ASC NULLS FIRST, i_class_id#573 ASC NULLS FIRST, i_category_id#575 ASC NULLS FIRST], true
      +- Project [channel#12320, i_brand_id#571, i_class_id#573, i_category_id#575, sales#12321, number_sales#12322L, channel#12326, i_brand_id#12361, i_class_id#12363, i_category_id#12365, sales#12327, number_sales#12328L]
         +- Filter (((i_brand_id#571 = i_brand_id#12361) && (i_class_id#573 = i_class_id#12363)) && (i_category_id#575 = i_category_id#12365))
            +- Join Inner
               :- SubqueryAlias `this_year`
               :  +- Project [channel#12320, i_brand_id#571, i_class_id#573, i_category_id#575, sales#12321, number_sales#12322L]
               :     +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12350 as decimal(32,6)) > cast(scalar-subquery#12325 [] as decimal(32,6)))
               :        :  +- Project [average_sales#12342]
               :        :     +- SubqueryAlias `avg_sales`
               :        :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#12336 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#12337 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#12342]
               :        :           +- SubqueryAlias `x`
               :        :              +- Union
               :        :                 :- Union
               :        :                 :  :- Project [ss_quantity#140 AS quantity#12336, ss_list_price#142 AS list_price#12337]
               :        :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :        :                 :  :     +- Join Inner
               :        :                 :  :        :- SubqueryAlias `store_sales`
               :        :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :        :                 :  :        +- SubqueryAlias `date_dim`
               :        :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :        :                 :  +- Project [cs_quantity#18 AS quantity#12338, cs_list_price#20 AS list_price#12339]
               :        :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :        :                 :        +- Join Inner
               :        :                 :           :- SubqueryAlias `catalog_sales`
               :        :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :        :                 :           +- SubqueryAlias `date_dim`
               :        :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :        :                 +- Project [ws_quantity#234 AS quantity#12340, ws_list_price#236 AS list_price#12341]
               :        :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :        :                       +- Join Inner
               :        :                          :- SubqueryAlias `web_sales`
               :        :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :        :                          +- SubqueryAlias `date_dim`
               :        :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :        +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [store AS channel#12320, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sales#12321, count(1) AS number_sales#12322L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12350]
               :           +- Filter ((ss_item_sk#132 IN (list#12323 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_week_seq#496 = scalar-subquery#12324 [])))
               :              :  :- Project [ss_item_sk#12335]
               :              :  :  +- SubqueryAlias `cross_items`
               :              :  :     +- Project [i_item_sk#564 AS ss_item_sk#12335]
               :              :  :        +- Filter (((i_brand_id#571 = brand_id#12332) && (i_class_id#573 = class_id#12333)) && (i_category_id#575 = category_id#12334))
               :              :  :           +- Join Inner
               :              :  :              :- SubqueryAlias `item`
               :              :  :              :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :              +- SubqueryAlias `x`
               :              :  :                 +- Intersect false
               :              :  :                    :- Intersect false
               :              :  :                    :  :- Project [i_brand_id#571 AS brand_id#12332, i_class_id#573 AS class_id#12333, i_category_id#575 AS category_id#12334]
               :              :  :                    :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :              :  :                    :  :     +- Join Inner
               :              :  :                    :  :        :- Join Inner
               :              :  :                    :  :        :  :- SubqueryAlias `store_sales`
               :              :  :                    :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :              :  :                    :  :        :  +- SubqueryAlias `iss`
               :              :  :                    :  :        :     +- SubqueryAlias `item`
               :              :  :                    :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :                    :  :        +- SubqueryAlias `d1`
               :              :  :                    :  :           +- SubqueryAlias `date_dim`
               :              :  :                    :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              :  :                    :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
               :              :  :                    :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :              :  :                    :        +- Join Inner
               :              :  :                    :           :- Join Inner
               :              :  :                    :           :  :- SubqueryAlias `catalog_sales`
               :              :  :                    :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :              :  :                    :           :  +- SubqueryAlias `ics`
               :              :  :                    :           :     +- SubqueryAlias `item`
               :              :  :                    :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :                    :           +- SubqueryAlias `d2`
               :              :  :                    :              +- SubqueryAlias `date_dim`
               :              :  :                    :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              :  :                    +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
               :              :  :                       +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :              :  :                          +- Join Inner
               :              :  :                             :- Join Inner
               :              :  :                             :  :- SubqueryAlias `web_sales`
               :              :  :                             :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :              :  :                             :  +- SubqueryAlias `iws`
               :              :  :                             :     +- SubqueryAlias `item`
               :              :  :                             :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :                             +- SubqueryAlias `d3`
               :              :  :                                +- SubqueryAlias `date_dim`
               :              :  :                                   +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              :  +- Project [d_week_seq#496]
               :              :     +- Filter (((d_year#498 = (1999 + 1)) && (d_moy#500 = 12)) && (d_dom#501 = 11))
               :              :        +- SubqueryAlias `date_dim`
               :              :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- SubqueryAlias `store_sales`
               :                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :                 :  +- SubqueryAlias `item`
               :                 :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                 +- SubqueryAlias `date_dim`
               :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `last_year`
                  +- Project [channel#12326, i_brand_id#12361, i_class_id#12363, i_category_id#12365, sales#12327, number_sales#12328L]
                     +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12353 as decimal(32,6)) > cast(scalar-subquery#12331 [] as decimal(32,6)))
                        :  +- Project [average_sales#12342]
                        :     +- SubqueryAlias `avg_sales`
                        :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#12336 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#12337 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#12342]
                        :           +- SubqueryAlias `x`
                        :              +- Union
                        :                 :- Union
                        :                 :  :- Project [ss_quantity#140 AS quantity#12336, ss_list_price#142 AS list_price#12337]
                        :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                        :                 :  :     +- Join Inner
                        :                 :  :        :- SubqueryAlias `store_sales`
                        :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :                 :  :        +- SubqueryAlias `date_dim`
                        :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :                 :  +- Project [cs_quantity#18 AS quantity#12338, cs_list_price#20 AS list_price#12339]
                        :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                        :                 :        +- Join Inner
                        :                 :           :- SubqueryAlias `catalog_sales`
                        :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :                 :           +- SubqueryAlias `date_dim`
                        :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :                 +- Project [ws_quantity#234 AS quantity#12340, ws_list_price#236 AS list_price#12341]
                        :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                        :                       +- Join Inner
                        :                          :- SubqueryAlias `web_sales`
                        :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :                          +- SubqueryAlias `date_dim`
                        :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [i_brand_id#12361, i_class_id#12363, i_category_id#12365], [store AS channel#12326, i_brand_id#12361, i_class_id#12363, i_category_id#12365, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sales#12327, count(1) AS number_sales#12328L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12353]
                           +- Filter ((ss_item_sk#132 IN (list#12329 []) && (ss_item_sk#132 = i_item_sk#12354)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_week_seq#496 = scalar-subquery#12330 [])))
                              :  :- Project [ss_item_sk#12335]
                              :  :  +- SubqueryAlias `cross_items`
                              :  :     +- Project [i_item_sk#564 AS ss_item_sk#12335]
                              :  :        +- Filter (((i_brand_id#571 = brand_id#12332) && (i_class_id#573 = class_id#12333)) && (i_category_id#575 = category_id#12334))
                              :  :           +- Join Inner
                              :  :              :- SubqueryAlias `item`
                              :  :              :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :              +- SubqueryAlias `x`
                              :  :                 +- Intersect false
                              :  :                    :- Intersect false
                              :  :                    :  :- Project [i_brand_id#571 AS brand_id#12332, i_class_id#573 AS class_id#12333, i_category_id#575 AS category_id#12334]
                              :  :                    :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                              :  :                    :  :     +- Join Inner
                              :  :                    :  :        :- Join Inner
                              :  :                    :  :        :  :- SubqueryAlias `store_sales`
                              :  :                    :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  :                    :  :        :  +- SubqueryAlias `iss`
                              :  :                    :  :        :     +- SubqueryAlias `item`
                              :  :                    :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :                    :  :        +- SubqueryAlias `d1`
                              :  :                    :  :           +- SubqueryAlias `date_dim`
                              :  :                    :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  :                    :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                              :  :                    :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                              :  :                    :        +- Join Inner
                              :  :                    :           :- Join Inner
                              :  :                    :           :  :- SubqueryAlias `catalog_sales`
                              :  :                    :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                              :  :                    :           :  +- SubqueryAlias `ics`
                              :  :                    :           :     +- SubqueryAlias `item`
                              :  :                    :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :                    :           +- SubqueryAlias `d2`
                              :  :                    :              +- SubqueryAlias `date_dim`
                              :  :                    :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  :                    +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                              :  :                       +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                              :  :                          +- Join Inner
                              :  :                             :- Join Inner
                              :  :                             :  :- SubqueryAlias `web_sales`
                              :  :                             :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :                             :  +- SubqueryAlias `iws`
                              :  :                             :     +- SubqueryAlias `item`
                              :  :                             :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :                             +- SubqueryAlias `d3`
                              :  :                                +- SubqueryAlias `date_dim`
                              :  :                                   +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- Project [d_week_seq#496]
                              :     +- Filter (((d_year#498 = 1999) && (d_moy#500 = 12)) && (d_dom#501 = 11))
                              :        +- SubqueryAlias `date_dim`
                              :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `store_sales`
                                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `item`
                                 :     +- Relation[i_item_sk#12354,i_item_id#12355,i_rec_start_date#12356,i_rec_end_date#12357,i_item_desc#12358,i_current_price#12359,i_wholesale_cost#12360,i_brand_id#12361,i_brand#12362,i_class_id#12363,i_class#12364,i_category_id#12365,i_category#12366,i_manufact_id#12367,i_manufact#12368,i_size#12369,i_formulation#12370,i_color#12371,i_units#12372,i_container#12373,i_manager_id#12374,i_product_name#12375] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 31.38250116s
Running execution q15-v2.4 iteration: 1, StandardRun=true
19/09/08 18:18:31 INFO Query: 
== Query: q15-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ca_zip#457, sum(cs_sales_price)#12567]
      +- Sort [ca_zip#457 ASC NULLS FIRST], true
         +- Aggregate [ca_zip#457], [ca_zip#457, sum(cs_sales_price#21) AS sum(cs_sales_price)#12567]
            +- Filter ((((cs_bill_customer_sk#3 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && ((substring(ca_zip#457, 1, 5) IN (85669,86197,88274,83405,86475,85392,85460,80348,81792) || ca_state#456 IN (CA,WA,GA)) || (cast(cs_sales_price#21 as decimal(7,2)) > cast(cast(500 as decimal(3,0)) as decimal(7,2))))) && (((cs_sold_date_sk#0 = d_date_sk#492) && (d_qoy#502 = 2)) && (d_year#498 = 2001)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `customer`
                  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:18:31 INFO Query: 
== Query: q15-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ca_zip#457, sum(cs_sales_price)#12572]
      +- Sort [ca_zip#457 ASC NULLS FIRST], true
         +- Aggregate [ca_zip#457], [ca_zip#457, sum(cs_sales_price#21) AS sum(cs_sales_price)#12572]
            +- Filter ((((cs_bill_customer_sk#3 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && ((substring(ca_zip#457, 1, 5) IN (85669,86197,88274,83405,86475,85392,85460,80348,81792) || ca_state#456 IN (CA,WA,GA)) || (cast(cs_sales_price#21 as decimal(7,2)) > cast(cast(500 as decimal(3,0)) as decimal(7,2))))) && (((cs_sold_date_sk#0 = d_date_sk#492) && (d_qoy#502 = 2)) && (d_year#498 = 2001)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `customer`
                  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 5.874261235s
Running execution q16-v2.4 iteration: 1, StandardRun=true
19/09/08 18:18:38 INFO Query: 
== Query: q16-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [order count#12644L, total shipping cost#12645, total net profit#12646]
      +- Sort [order count#12644L ASC NULLS FIRST], true
         +- Aggregate [count(distinct cs_order_number#17L) AS order count#12644L, sum(cs_ext_ship_cost#28) AS total shipping cost#12645, sum(cs_net_profit#33) AS total net profit#12646]
            +- Filter (((((d_date#494 >= cast(2002-02-01 as date)) && (d_date#494 <= cast(cast(cast(2002-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))) && (cs_ship_date_sk#2 = d_date_sk#492)) && ((cs_ship_addr_sk#10 = ca_address_sk#448) && (ca_state#456 = GA))) && (((cs_call_center_sk#11 = cc_call_center_sk#332) && cc_county#357 IN (Williamson County,Williamson County,Williamson County,Williamson County,Williamson County)) && (exists#12647 [cs_order_number#17L && cs_warehouse_sk#14] && NOT exists#12648 [cs_order_number#17L])))
               :  :- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 10 more fields]
               :  :  +- Filter ((outer(cs_order_number#17L) = cs_order_number#17L) && NOT (outer(cs_warehouse_sk#14) = cs_warehouse_sk#14))
               :  :     +- SubqueryAlias `cs2`
               :  :        +- SubqueryAlias `catalog_sales`
               :  :           +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  +- Project [cr_returned_date_sk#68, cr_returned_time_sk#69, cr_item_sk#70, cr_refunded_customer_sk#71, cr_refunded_cdemo_sk#72, cr_refunded_hdemo_sk#73, cr_refunded_addr_sk#74, cr_returning_customer_sk#75, cr_returning_cdemo_sk#76, cr_returning_hdemo_sk#77, cr_returning_addr_sk#78, cr_call_center_sk#79, cr_catalog_page_sk#80, cr_ship_mode_sk#81, cr_warehouse_sk#82, cr_reason_sk#83, cr_order_number#84L, cr_return_quantity#85, cr_return_amount#86, cr_return_tax#87, cr_return_amt_inc_tax#88, cr_fee#89, cr_return_ship_cost#90, cr_refunded_cash#91, ... 3 more fields]
               :     +- Filter (outer(cs_order_number#17L) = cr_order_number#84L)
               :        +- SubqueryAlias `cr1`
               :           +- SubqueryAlias `catalog_returns`
               :              +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `cs1`
                  :  :  :  +- SubqueryAlias `catalog_sales`
                  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `call_center`
                     +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet

     : benchmark
19/09/08 18:18:38 INFO Query: 
== Query: q16-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [order count#12657L, total shipping cost#12658, total net profit#12659]
      +- Sort [order count#12657L ASC NULLS FIRST], true
         +- Aggregate [count(distinct cs_order_number#17L) AS order count#12657L, sum(cs_ext_ship_cost#28) AS total shipping cost#12658, sum(cs_net_profit#33) AS total net profit#12659]
            +- Filter (((((d_date#494 >= cast(2002-02-01 as date)) && (d_date#494 <= cast(cast(cast(2002-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))) && (cs_ship_date_sk#2 = d_date_sk#492)) && ((cs_ship_addr_sk#10 = ca_address_sk#448) && (ca_state#456 = GA))) && (((cs_call_center_sk#11 = cc_call_center_sk#332) && cc_county#357 IN (Williamson County,Williamson County,Williamson County,Williamson County,Williamson County)) && (exists#12660 [cs_order_number#17L && cs_warehouse_sk#14] && NOT exists#12661 [cs_order_number#17L])))
               :  :- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 10 more fields]
               :  :  +- Filter ((outer(cs_order_number#17L) = cs_order_number#17L) && NOT (outer(cs_warehouse_sk#14) = cs_warehouse_sk#14))
               :  :     +- SubqueryAlias `cs2`
               :  :        +- SubqueryAlias `catalog_sales`
               :  :           +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  +- Project [cr_returned_date_sk#68, cr_returned_time_sk#69, cr_item_sk#70, cr_refunded_customer_sk#71, cr_refunded_cdemo_sk#72, cr_refunded_hdemo_sk#73, cr_refunded_addr_sk#74, cr_returning_customer_sk#75, cr_returning_cdemo_sk#76, cr_returning_hdemo_sk#77, cr_returning_addr_sk#78, cr_call_center_sk#79, cr_catalog_page_sk#80, cr_ship_mode_sk#81, cr_warehouse_sk#82, cr_reason_sk#83, cr_order_number#84L, cr_return_quantity#85, cr_return_amount#86, cr_return_tax#87, cr_return_amt_inc_tax#88, cr_fee#89, cr_return_ship_cost#90, cr_refunded_cash#91, ... 3 more fields]
               :     +- Filter (outer(cs_order_number#17L) = cr_order_number#84L)
               :        +- SubqueryAlias `cr1`
               :           +- SubqueryAlias `catalog_returns`
               :              +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `cs1`
                  :  :  :  +- SubqueryAlias `catalog_sales`
                  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `call_center`
                     +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 8.838998014000001s
Running execution q17-v2.4 iteration: 1, StandardRun=true
19/09/08 18:18:49 INFO Query: 
== Query: q17-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, s_state#688 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, s_state#688], [i_item_id#565, i_item_desc#568, s_state#688, count(ss_quantity#140) AS store_sales_quantitycount#13048L, avg(cast(ss_quantity#140 as bigint)) AS store_sales_quantityave#13049, stddev_samp(cast(ss_quantity#140 as double)) AS store_sales_quantitystdev#13050, (stddev_samp(cast(ss_quantity#140 as double)) / avg(cast(ss_quantity#140 as bigint))) AS store_sales_quantitycov#13051, count(sr_return_quantity#186) AS as_store_returns_quantitycount#13052L, avg(cast(sr_return_quantity#186 as bigint)) AS as_store_returns_quantityave#13053, stddev_samp(cast(sr_return_quantity#186 as double)) AS as_store_returns_quantitystdev#13054, (stddev_samp(cast(sr_return_quantity#186 as double)) / avg(cast(sr_return_quantity#186 as bigint))) AS store_returns_quantitycov#13055, count(cs_quantity#18) AS catalog_sales_quantitycount#13056L, avg(cast(cs_quantity#18 as bigint)) AS catalog_sales_quantityave#13057, (stddev_samp(cast(cs_quantity#18 as double)) / avg(cast(cs_quantity#18 as bigint))) AS catalog_sales_quantitystdev#13058, (stddev_samp(cast(cs_quantity#18 as double)) / avg(cast(cs_quantity#18 as bigint))) AS catalog_sales_quantitycov#13059]
         +- Filter (((((d_quarter_name#507 = 2001Q1) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((i_item_sk#564 = ss_item_sk#132) && (s_store_sk#664 = ss_store_sk#137))) && (((ss_customer_sk#133 = sr_customer_sk#179) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L))) && ((((sr_returned_date_sk#176 = d_date_sk#13060) && d_quarter_name#13075 IN (2001Q1,2001Q2,2001Q3)) && (sr_customer_sk#179 = cs_bill_customer_sk#3)) && (((sr_item_sk#178 = cs_item_sk#15) && (cs_sold_date_sk#0 = d_date_sk#13088)) && d_quarter_name#13103 IN (2001Q1,2001Q2,2001Q3))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- Join Inner
               :  :  :  :- Join Inner
               :  :  :  :  :- Join Inner
               :  :  :  :  :  :- Join Inner
               :  :  :  :  :  :  :- SubqueryAlias `store_sales`
               :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  :  :  :  +- SubqueryAlias `store_returns`
               :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :  :  :  :  :  +- SubqueryAlias `catalog_sales`
               :  :  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :  +- SubqueryAlias `d1`
               :  :  :  :     +- SubqueryAlias `date_dim`
               :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  +- SubqueryAlias `d2`
               :  :  :     +- SubqueryAlias `date_dim`
               :  :  :        +- Relation[d_date_sk#13060,d_date_id#13061,d_date#13062,d_month_seq#13063,d_week_seq#13064,d_quarter_seq#13065,d_year#13066,d_dow#13067,d_moy#13068,d_dom#13069,d_qoy#13070,d_fy_year#13071,d_fy_quarter_seq#13072,d_fy_week_seq#13073,d_day_name#13074,d_quarter_name#13075,d_holiday#13076,d_weekend#13077,d_following_holiday#13078,d_first_dom#13079,d_last_dom#13080,d_same_day_ly#13081,d_same_day_lq#13082,d_current_day#13083,... 4 more fields] parquet
               :  :  +- SubqueryAlias `d3`
               :  :     +- SubqueryAlias `date_dim`
               :  :        +- Relation[d_date_sk#13088,d_date_id#13089,d_date#13090,d_month_seq#13091,d_week_seq#13092,d_quarter_seq#13093,d_year#13094,d_dow#13095,d_moy#13096,d_dom#13097,d_qoy#13098,d_fy_year#13099,d_fy_quarter_seq#13100,d_fy_week_seq#13101,d_day_name#13102,d_quarter_name#13103,d_holiday#13104,d_weekend#13105,d_following_holiday#13106,d_first_dom#13107,d_last_dom#13108,d_same_day_ly#13109,d_same_day_lq#13110,d_current_day#13111,... 4 more fields] parquet
               :  +- SubqueryAlias `store`
               :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:18:49 INFO Query: 
== Query: q17-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, s_state#688 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, s_state#688], [i_item_id#565, i_item_desc#568, s_state#688, count(ss_quantity#140) AS store_sales_quantitycount#13291L, avg(cast(ss_quantity#140 as bigint)) AS store_sales_quantityave#13292, stddev_samp(cast(ss_quantity#140 as double)) AS store_sales_quantitystdev#13293, (stddev_samp(cast(ss_quantity#140 as double)) / avg(cast(ss_quantity#140 as bigint))) AS store_sales_quantitycov#13294, count(sr_return_quantity#186) AS as_store_returns_quantitycount#13295L, avg(cast(sr_return_quantity#186 as bigint)) AS as_store_returns_quantityave#13296, stddev_samp(cast(sr_return_quantity#186 as double)) AS as_store_returns_quantitystdev#13297, (stddev_samp(cast(sr_return_quantity#186 as double)) / avg(cast(sr_return_quantity#186 as bigint))) AS store_returns_quantitycov#13298, count(cs_quantity#18) AS catalog_sales_quantitycount#13299L, avg(cast(cs_quantity#18 as bigint)) AS catalog_sales_quantityave#13300, (stddev_samp(cast(cs_quantity#18 as double)) / avg(cast(cs_quantity#18 as bigint))) AS catalog_sales_quantitystdev#13301, (stddev_samp(cast(cs_quantity#18 as double)) / avg(cast(cs_quantity#18 as bigint))) AS catalog_sales_quantitycov#13302]
         +- Filter (((((d_quarter_name#507 = 2001Q1) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((i_item_sk#564 = ss_item_sk#132) && (s_store_sk#664 = ss_store_sk#137))) && (((ss_customer_sk#133 = sr_customer_sk#179) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L))) && ((((sr_returned_date_sk#176 = d_date_sk#13303) && d_quarter_name#13318 IN (2001Q1,2001Q2,2001Q3)) && (sr_customer_sk#179 = cs_bill_customer_sk#3)) && (((sr_item_sk#178 = cs_item_sk#15) && (cs_sold_date_sk#0 = d_date_sk#13331)) && d_quarter_name#13346 IN (2001Q1,2001Q2,2001Q3))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- Join Inner
               :  :  :  :- Join Inner
               :  :  :  :  :- Join Inner
               :  :  :  :  :  :- Join Inner
               :  :  :  :  :  :  :- SubqueryAlias `store_sales`
               :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  :  :  :  +- SubqueryAlias `store_returns`
               :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :  :  :  :  :  +- SubqueryAlias `catalog_sales`
               :  :  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :  +- SubqueryAlias `d1`
               :  :  :  :     +- SubqueryAlias `date_dim`
               :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  +- SubqueryAlias `d2`
               :  :  :     +- SubqueryAlias `date_dim`
               :  :  :        +- Relation[d_date_sk#13303,d_date_id#13304,d_date#13305,d_month_seq#13306,d_week_seq#13307,d_quarter_seq#13308,d_year#13309,d_dow#13310,d_moy#13311,d_dom#13312,d_qoy#13313,d_fy_year#13314,d_fy_quarter_seq#13315,d_fy_week_seq#13316,d_day_name#13317,d_quarter_name#13318,d_holiday#13319,d_weekend#13320,d_following_holiday#13321,d_first_dom#13322,d_last_dom#13323,d_same_day_ly#13324,d_same_day_lq#13325,d_current_day#13326,... 4 more fields] parquet
               :  :  +- SubqueryAlias `d3`
               :  :     +- SubqueryAlias `date_dim`
               :  :        +- Relation[d_date_sk#13331,d_date_id#13332,d_date#13333,d_month_seq#13334,d_week_seq#13335,d_quarter_seq#13336,d_year#13337,d_dow#13338,d_moy#13339,d_dom#13340,d_qoy#13341,d_fy_year#13342,d_fy_quarter_seq#13343,d_fy_week_seq#13344,d_day_name#13345,d_quarter_name#13346,d_holiday#13347,d_weekend#13348,d_following_holiday#13349,d_first_dom#13350,d_last_dom#13351,d_same_day_ly#13352,d_same_day_lq#13353,d_current_day#13354,... 4 more fields] parquet
               :  +- SubqueryAlias `store`
               :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 14.536631893s
Running execution q18-v2.4 iteration: 1, StandardRun=true
19/09/08 18:19:05 INFO Query: 
== Query: q18-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ca_country#14191 ASC NULLS FIRST, ca_state#14192 ASC NULLS FIRST, ca_county#14193 ASC NULLS FIRST, i_item_id#14190 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#14190, ca_country#14191, ca_state#14192, ca_county#14193, spark_grouping_id#14185], [i_item_id#14190, ca_country#14191, ca_state#14192, ca_county#14193, avg(cast(cs_quantity#18 as decimal(12,2))) AS agg1#14162, avg(cast(cs_list_price#20 as decimal(12,2))) AS agg2#14163, avg(cast(cs_coupon_amt#27 as decimal(12,2))) AS agg3#14164, avg(cast(cs_sales_price#21 as decimal(12,2))) AS agg4#14165, avg(cast(cs_net_profit#33 as decimal(12,2))) AS agg5#14166, avg(cast(c_birth_year#425 as decimal(12,2))) AS agg6#14167, avg(cast(cd_dep_count#480 as decimal(12,2))) AS agg7#14168]
         +- Expand [List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14169, cd_gender#14170, cd_marital_status#14171, cd_education_status#14172, cd_purchase_estimate#14173, cd_credit_rating#14174, cd_dep_count#14175, cd_dep_employed_count#14176, cd_dep_college_count#14177, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14186, ca_country#14187, ca_state#14188, ca_county#14189, 0), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14169, cd_gender#14170, cd_marital_status#14171, cd_education_status#14172, cd_purchase_estimate#14173, cd_credit_rating#14174, cd_dep_count#14175, cd_dep_employed_count#14176, cd_dep_college_count#14177, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14186, ca_country#14187, ca_state#14188, null, 1), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14169, cd_gender#14170, cd_marital_status#14171, cd_education_status#14172, cd_purchase_estimate#14173, cd_credit_rating#14174, cd_dep_count#14175, cd_dep_employed_count#14176, cd_dep_college_count#14177, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14186, ca_country#14187, null, null, 3), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14169, cd_gender#14170, cd_marital_status#14171, cd_education_status#14172, cd_purchase_estimate#14173, cd_credit_rating#14174, cd_dep_count#14175, cd_dep_employed_count#14176, cd_dep_college_count#14177, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14186, null, null, null, 7), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14169, cd_gender#14170, cd_marital_status#14171, cd_education_status#14172, cd_purchase_estimate#14173, cd_credit_rating#14174, cd_dep_count#14175, cd_dep_employed_count#14176, cd_dep_college_count#14177, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, null, null, 15)], [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 114 more fields]
            +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 113 more fields]
               +- Filter (((((cs_sold_date_sk#0 = d_date_sk#492) && (cs_item_sk#15 = i_item_sk#564)) && (cs_bill_cdemo_sk#4 = cd_demo_sk#474)) && (((cs_bill_customer_sk#3 = c_customer_sk#412) && (cd_gender#475 = F)) && (cd_education_status#477 = Unknown))) && ((((c_current_cdemo_sk#414 = cd_demo_sk#14169) && (c_current_addr_sk#416 = ca_address_sk#448)) && c_birth_month#424 IN (1,6,8,9,12,2)) && ((d_year#498 = 1998) && ca_state#456 IN (MS,IN,ND,OK,NM,VA,MS))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- Join Inner
                     :  :  :  :  :  :- SubqueryAlias `catalog_sales`
                     :  :  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :  :  :  :  :  +- SubqueryAlias `cd1`
                     :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                     :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                     :  :  :  :  +- SubqueryAlias `cd2`
                     :  :  :  :     +- SubqueryAlias `customer_demographics`
                     :  :  :  :        +- Relation[cd_demo_sk#14169,cd_gender#14170,cd_marital_status#14171,cd_education_status#14172,cd_purchase_estimate#14173,cd_credit_rating#14174,cd_dep_count#14175,cd_dep_employed_count#14176,cd_dep_college_count#14177] parquet
                     :  :  :  +- SubqueryAlias `customer`
                     :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     :  :  +- SubqueryAlias `customer_address`
                     :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                     :  +- SubqueryAlias `date_dim`
                     :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- SubqueryAlias `item`
                        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:19:05 INFO Query: 
== Query: q18-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ca_country#14238 ASC NULLS FIRST, ca_state#14239 ASC NULLS FIRST, ca_county#14240 ASC NULLS FIRST, i_item_id#14237 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#14237, ca_country#14238, ca_state#14239, ca_county#14240, spark_grouping_id#14232], [i_item_id#14237, ca_country#14238, ca_state#14239, ca_county#14240, avg(cast(cs_quantity#18 as decimal(12,2))) AS agg1#14209, avg(cast(cs_list_price#20 as decimal(12,2))) AS agg2#14210, avg(cast(cs_coupon_amt#27 as decimal(12,2))) AS agg3#14211, avg(cast(cs_sales_price#21 as decimal(12,2))) AS agg4#14212, avg(cast(cs_net_profit#33 as decimal(12,2))) AS agg5#14213, avg(cast(c_birth_year#425 as decimal(12,2))) AS agg6#14214, avg(cast(cd_dep_count#480 as decimal(12,2))) AS agg7#14215]
         +- Expand [List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14216, cd_gender#14217, cd_marital_status#14218, cd_education_status#14219, cd_purchase_estimate#14220, cd_credit_rating#14221, cd_dep_count#14222, cd_dep_employed_count#14223, cd_dep_college_count#14224, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14233, ca_country#14234, ca_state#14235, ca_county#14236, 0), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14216, cd_gender#14217, cd_marital_status#14218, cd_education_status#14219, cd_purchase_estimate#14220, cd_credit_rating#14221, cd_dep_count#14222, cd_dep_employed_count#14223, cd_dep_college_count#14224, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14233, ca_country#14234, ca_state#14235, null, 1), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14216, cd_gender#14217, cd_marital_status#14218, cd_education_status#14219, cd_purchase_estimate#14220, cd_credit_rating#14221, cd_dep_count#14222, cd_dep_employed_count#14223, cd_dep_college_count#14224, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14233, ca_country#14234, null, null, 3), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14216, cd_gender#14217, cd_marital_status#14218, cd_education_status#14219, cd_purchase_estimate#14220, cd_credit_rating#14221, cd_dep_count#14222, cd_dep_employed_count#14223, cd_dep_college_count#14224, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14233, null, null, null, 7), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14216, cd_gender#14217, cd_marital_status#14218, cd_education_status#14219, cd_purchase_estimate#14220, cd_credit_rating#14221, cd_dep_count#14222, cd_dep_employed_count#14223, cd_dep_college_count#14224, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, null, null, 15)], [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 114 more fields]
            +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 113 more fields]
               +- Filter (((((cs_sold_date_sk#0 = d_date_sk#492) && (cs_item_sk#15 = i_item_sk#564)) && (cs_bill_cdemo_sk#4 = cd_demo_sk#474)) && (((cs_bill_customer_sk#3 = c_customer_sk#412) && (cd_gender#475 = F)) && (cd_education_status#477 = Unknown))) && ((((c_current_cdemo_sk#414 = cd_demo_sk#14216) && (c_current_addr_sk#416 = ca_address_sk#448)) && c_birth_month#424 IN (1,6,8,9,12,2)) && ((d_year#498 = 1998) && ca_state#456 IN (MS,IN,ND,OK,NM,VA,MS))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- Join Inner
                     :  :  :  :  :  :- SubqueryAlias `catalog_sales`
                     :  :  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :  :  :  :  :  +- SubqueryAlias `cd1`
                     :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                     :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                     :  :  :  :  +- SubqueryAlias `cd2`
                     :  :  :  :     +- SubqueryAlias `customer_demographics`
                     :  :  :  :        +- Relation[cd_demo_sk#14216,cd_gender#14217,cd_marital_status#14218,cd_education_status#14219,cd_purchase_estimate#14220,cd_credit_rating#14221,cd_dep_count#14222,cd_dep_employed_count#14223,cd_dep_college_count#14224] parquet
                     :  :  :  +- SubqueryAlias `customer`
                     :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     :  :  +- SubqueryAlias `customer_address`
                     :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                     :  +- SubqueryAlias `date_dim`
                     :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- SubqueryAlias `item`
                        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 7.77794147s
Running execution q19-v2.4 iteration: 1, StandardRun=true
19/09/08 18:19:14 INFO Query: 
== Query: q19-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ext_price#14397 DESC NULLS LAST, brand#14396 ASC NULLS FIRST, brand_id#14395 ASC NULLS FIRST, i_manufact_id#577 ASC NULLS FIRST, i_manufact#578 ASC NULLS FIRST], true
      +- Aggregate [i_brand#572, i_brand_id#571, i_manufact_id#577, i_manufact#578], [i_brand_id#571 AS brand_id#14395, i_brand#572 AS brand#14396, i_manufact_id#577, i_manufact#578, sum(ss_ext_sales_price#145) AS ext_price#14397]
         +- Filter (((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 8)) && ((d_moy#500 = 11) && (d_year#498 = 1998))) && (((ss_customer_sk#133 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && (NOT (substring(ca_zip#457, 1, 5) = substring(s_zip#689, 1, 5)) && (ss_store_sk#137 = s_store_sk#664))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- Join Inner
               :  :  :  :- Join Inner
               :  :  :  :  :- SubqueryAlias `date_dim`
               :  :  :  :  :  +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  +- SubqueryAlias `store_sales`
               :  :  :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  +- SubqueryAlias `item`
               :  :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `customer`
               :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  +- SubqueryAlias `customer_address`
               :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `store`
                  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/09/08 18:19:14 INFO Query: 
== Query: q19-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ext_price#14411 DESC NULLS LAST, brand#14410 ASC NULLS FIRST, brand_id#14409 ASC NULLS FIRST, i_manufact_id#577 ASC NULLS FIRST, i_manufact#578 ASC NULLS FIRST], true
      +- Aggregate [i_brand#572, i_brand_id#571, i_manufact_id#577, i_manufact#578], [i_brand_id#571 AS brand_id#14409, i_brand#572 AS brand#14410, i_manufact_id#577, i_manufact#578, sum(ss_ext_sales_price#145) AS ext_price#14411]
         +- Filter (((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 8)) && ((d_moy#500 = 11) && (d_year#498 = 1998))) && (((ss_customer_sk#133 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && (NOT (substring(ca_zip#457, 1, 5) = substring(s_zip#689, 1, 5)) && (ss_store_sk#137 = s_store_sk#664))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- Join Inner
               :  :  :  :- Join Inner
               :  :  :  :  :- SubqueryAlias `date_dim`
               :  :  :  :  :  +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  +- SubqueryAlias `store_sales`
               :  :  :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  +- SubqueryAlias `item`
               :  :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `customer`
               :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  +- SubqueryAlias `customer_address`
               :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `store`
                  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 4.452127045s
Running execution q20-v2.4 iteration: 1, StandardRun=true
19/09/08 18:19:20 INFO Query: 
== Query: q20-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#576 ASC NULLS FIRST, i_class#574 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, revenueratio#14473 ASC NULLS FIRST], true
      +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#14472, revenueratio#14473]
         +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#14472, _w0#14478, _w1#14479, _we0#14480, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(_w0#14478 as decimal(17,2))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(17,2)))), DecimalType(21,2)) as decimal(27,2))) / promote_precision(cast(_we0#14480 as decimal(27,2)))), DecimalType(38,17)) AS revenueratio#14473]
            +- Window [sum(_w1#14479) windowspecdefinition(i_class#574, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#14480], [i_class#574]
               +- Aggregate [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569], [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, sum(cs_ext_sales_price#23) AS itemrevenue#14472, sum(cs_ext_sales_price#23) AS _w0#14478, sum(cs_ext_sales_price#23) AS _w1#14479]
                  +- Filter (((cs_item_sk#15 = i_item_sk#564) && i_category#576 IN (Sports,Books,Home)) && ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(1999-02-22 as date)) && (d_date#494 <= cast(cast(cast(1999-02-22 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `catalog_sales`
                        :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  +- SubqueryAlias `item`
                        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:19:20 INFO Query: 
== Query: q20-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#576 ASC NULLS FIRST, i_class#574 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, revenueratio#14489 ASC NULLS FIRST], true
      +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#14488, revenueratio#14489]
         +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#14488, _w0#14494, _w1#14495, _we0#14496, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(_w0#14494 as decimal(17,2))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(17,2)))), DecimalType(21,2)) as decimal(27,2))) / promote_precision(cast(_we0#14496 as decimal(27,2)))), DecimalType(38,17)) AS revenueratio#14489]
            +- Window [sum(_w1#14495) windowspecdefinition(i_class#574, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#14496], [i_class#574]
               +- Aggregate [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569], [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, sum(cs_ext_sales_price#23) AS itemrevenue#14488, sum(cs_ext_sales_price#23) AS _w0#14494, sum(cs_ext_sales_price#23) AS _w1#14495]
                  +- Filter (((cs_item_sk#15 = i_item_sk#564) && i_category#576 IN (Sports,Books,Home)) && ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(1999-02-22 as date)) && (d_date#494 <= cast(cast(cast(1999-02-22 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `catalog_sales`
                        :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  +- SubqueryAlias `item`
                        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 4.857368983000001s
Running execution q21-v2.4 iteration: 1, StandardRun=true
19/09/08 18:19:26 INFO Query: 
== Query: q21-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [w_warehouse_name#744 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST], true
      +- Project [w_warehouse_name#744, i_item_id#565, inv_before#14551L, inv_after#14552L]
         +- Filter ((CASE WHEN (inv_before#14551L > cast(0 as bigint)) THEN (cast(inv_after#14552L as double) / cast(inv_before#14551L as double)) ELSE cast(null as double) END >= cast(CheckOverflow((promote_precision(cast(2.0 as decimal(2,1))) / promote_precision(cast(3.0 as decimal(2,1)))), DecimalType(8,6)) as double)) && (CASE WHEN (inv_before#14551L > cast(0 as bigint)) THEN (cast(inv_after#14552L as double) / cast(inv_before#14551L as double)) ELSE cast(null as double) END <= cast(CheckOverflow((promote_precision(cast(3.0 as decimal(2,1))) / promote_precision(cast(2.0 as decimal(2,1)))), DecimalType(8,6)) as double)))
            +- SubqueryAlias `x`
               +- Aggregate [w_warehouse_name#744, i_item_id#565], [w_warehouse_name#744, i_item_id#565, sum(cast(CASE WHEN (cast(d_date#494 as date) < cast(2000-03-11 as date)) THEN inv_quantity_on_hand#125 ELSE 0 END as bigint)) AS inv_before#14551L, sum(cast(CASE WHEN (cast(d_date#494 as date) >= cast(2000-03-11 as date)) THEN inv_quantity_on_hand#125 ELSE 0 END as bigint)) AS inv_after#14552L]
                  +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(0.99 as decimal(7,2))) && (cast(i_current_price#569 as decimal(7,2)) <= cast(1.49 as decimal(7,2)))) && (i_item_sk#564 = inv_item_sk#123)) && (inv_warehouse_sk#124 = w_warehouse_sk#742)) && ((inv_date_sk#122 = d_date_sk#492) && ((d_date#494 >= cast(cast(cast(2000-03-11 as date) as timestamp) - interval 4 weeks 2 days as date)) && (d_date#494 <= cast(cast(cast(2000-03-11 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- SubqueryAlias `inventory`
                        :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                        :  :  +- SubqueryAlias `warehouse`
                        :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                        :  +- SubqueryAlias `item`
                        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:19:26 INFO Query: 
== Query: q21-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [w_warehouse_name#744 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST], true
      +- Project [w_warehouse_name#744, i_item_id#565, inv_before#14559L, inv_after#14560L]
         +- Filter ((CASE WHEN (inv_before#14559L > cast(0 as bigint)) THEN (cast(inv_after#14560L as double) / cast(inv_before#14559L as double)) ELSE cast(null as double) END >= cast(CheckOverflow((promote_precision(cast(2.0 as decimal(2,1))) / promote_precision(cast(3.0 as decimal(2,1)))), DecimalType(8,6)) as double)) && (CASE WHEN (inv_before#14559L > cast(0 as bigint)) THEN (cast(inv_after#14560L as double) / cast(inv_before#14559L as double)) ELSE cast(null as double) END <= cast(CheckOverflow((promote_precision(cast(3.0 as decimal(2,1))) / promote_precision(cast(2.0 as decimal(2,1)))), DecimalType(8,6)) as double)))
            +- SubqueryAlias `x`
               +- Aggregate [w_warehouse_name#744, i_item_id#565], [w_warehouse_name#744, i_item_id#565, sum(cast(CASE WHEN (cast(d_date#494 as date) < cast(2000-03-11 as date)) THEN inv_quantity_on_hand#125 ELSE 0 END as bigint)) AS inv_before#14559L, sum(cast(CASE WHEN (cast(d_date#494 as date) >= cast(2000-03-11 as date)) THEN inv_quantity_on_hand#125 ELSE 0 END as bigint)) AS inv_after#14560L]
                  +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(0.99 as decimal(7,2))) && (cast(i_current_price#569 as decimal(7,2)) <= cast(1.49 as decimal(7,2)))) && (i_item_sk#564 = inv_item_sk#123)) && (inv_warehouse_sk#124 = w_warehouse_sk#742)) && ((inv_date_sk#122 = d_date_sk#492) && ((d_date#494 >= cast(cast(cast(2000-03-11 as date) as timestamp) - interval 4 weeks 2 days as date)) && (d_date#494 <= cast(cast(cast(2000-03-11 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- SubqueryAlias `inventory`
                        :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                        :  :  +- SubqueryAlias `warehouse`
                        :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                        :  +- SubqueryAlias `item`
                        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 2.942890824s
Running execution q22-v2.4 iteration: 1, StandardRun=true
19/09/08 18:19:30 INFO Query: 
== Query: q22-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [qoh#14613 ASC NULLS FIRST, i_product_name#14620 ASC NULLS FIRST, i_brand#14621 ASC NULLS FIRST, i_class#14622 ASC NULLS FIRST, i_category#14623 ASC NULLS FIRST], true
      +- Aggregate [i_product_name#14620, i_brand#14621, i_class#14622, i_category#14623, spark_grouping_id#14615], [i_product_name#14620, i_brand#14621, i_class#14622, i_category#14623, avg(cast(inv_quantity_on_hand#125 as bigint)) AS qoh#14613]
         +- Expand [List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14616, i_brand#14617, i_class#14618, i_category#14619, 0), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14616, i_brand#14617, i_class#14618, null, 1), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14616, i_brand#14617, null, null, 3), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14616, null, null, null, 7), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, null, null, null, null, 15)], [inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, ... 49 more fields]
            +- Project [inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, ... 48 more fields]
               +- Filter (((inv_date_sk#122 = d_date_sk#492) && (inv_item_sk#123 = i_item_sk#564)) && ((inv_warehouse_sk#124 = w_warehouse_sk#742) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11)))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- SubqueryAlias `inventory`
                     :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                     :  :  +- SubqueryAlias `date_dim`
                     :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- SubqueryAlias `item`
                     :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     +- SubqueryAlias `warehouse`
                        +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet

     : benchmark
19/09/08 18:19:30 INFO Query: 
== Query: q22-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [qoh#14634 ASC NULLS FIRST, i_product_name#14641 ASC NULLS FIRST, i_brand#14642 ASC NULLS FIRST, i_class#14643 ASC NULLS FIRST, i_category#14644 ASC NULLS FIRST], true
      +- Aggregate [i_product_name#14641, i_brand#14642, i_class#14643, i_category#14644, spark_grouping_id#14636], [i_product_name#14641, i_brand#14642, i_class#14643, i_category#14644, avg(cast(inv_quantity_on_hand#125 as bigint)) AS qoh#14634]
         +- Expand [List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14637, i_brand#14638, i_class#14639, i_category#14640, 0), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14637, i_brand#14638, i_class#14639, null, 1), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14637, i_brand#14638, null, null, 3), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14637, null, null, null, 7), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, null, null, null, null, 15)], [inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, ... 49 more fields]
            +- Project [inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, ... 48 more fields]
               +- Filter (((inv_date_sk#122 = d_date_sk#492) && (inv_item_sk#123 = i_item_sk#564)) && ((inv_warehouse_sk#124 = w_warehouse_sk#742) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11)))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- SubqueryAlias `inventory`
                     :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                     :  :  +- SubqueryAlias `date_dim`
                     :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- SubqueryAlias `item`
                     :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     +- SubqueryAlias `warehouse`
                        +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet

      running Thread[benchmark runner,5,main]
Execution time: 11.783228526999999s
Running execution q23a-v2.4 iteration: 1, StandardRun=true
19/09/08 18:19:43 INFO Query: 
== Query: q23a-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [sum(sales#14761) AS sum(sales)#14796]
      +- SubqueryAlias `x`
         +- Union
            :- Project [CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2)) AS sales#14761]
            :  +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (cs_sold_date_sk#0 = d_date_sk#492)) && (cs_item_sk#15 IN (list#14762 []) && cs_bill_customer_sk#3 IN (list#14763 [])))
            :     :  :- Project [item_sk#14768]
            :     :  :  +- SubqueryAlias `frequent_ss_items`
            :     :  :     +- Project [itemdesc#14767, item_sk#14768, solddate#14769, cnt#14770L]
            :     :  :        +- Filter (count(1)#14778L > cast(4 as bigint))
            :     :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#14767, i_item_sk#564 AS item_sk#14768, d_date#494 AS solddate#14769, count(1) AS cnt#14770L, count(1) AS count(1)#14778L]
            :     :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
            :     :  :                 +- Join Inner
            :     :  :                    :- Join Inner
            :     :  :                    :  :- SubqueryAlias `store_sales`
            :     :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :  :                    :  +- SubqueryAlias `date_dim`
            :     :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     :  :                    +- SubqueryAlias `item`
            :     :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            :     :  +- Project [c_customer_sk#412]
            :     :     +- SubqueryAlias `best_ss_customer`
            :     :        +- Project [c_customer_sk#412, ssales#14773]
            :     :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14785 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#14774 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
            :     :              :  +- Project [tpcds_cmax#14772]
            :     :              :     +- SubqueryAlias `max_store_sales`
            :     :              :        +- Aggregate [max(csales#14771) AS tpcds_cmax#14772]
            :     :              :           +- SubqueryAlias `x`
            :     :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#14771]
            :     :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
            :     :              :                    +- Join Inner
            :     :              :                       :- Join Inner
            :     :              :                       :  :- SubqueryAlias `store_sales`
            :     :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :              :                       :  +- SubqueryAlias `customer`
            :     :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :     :              :                       +- SubqueryAlias `date_dim`
            :     :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#14773, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14785]
            :     :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
            :     :                    +- Join Inner
            :     :                       :- SubqueryAlias `store_sales`
            :     :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :                       +- SubqueryAlias `customer`
            :     :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :     +- Join Inner
            :        :- SubqueryAlias `catalog_sales`
            :        :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :        +- SubqueryAlias `date_dim`
            :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Project [CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2)) AS sales#14764]
               +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (ws_sold_date_sk#216 = d_date_sk#492)) && (ws_item_sk#219 IN (list#14765 []) && ws_bill_customer_sk#220 IN (list#14766 [])))
                  :  :- Project [item_sk#14768]
                  :  :  +- SubqueryAlias `frequent_ss_items`
                  :  :     +- Project [itemdesc#14767, item_sk#14768, solddate#14769, cnt#14770L]
                  :  :        +- Filter (count(1)#14778L > cast(4 as bigint))
                  :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#14767, i_item_sk#564 AS item_sk#14768, d_date#494 AS solddate#14769, count(1) AS cnt#14770L, count(1) AS count(1)#14778L]
                  :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                  :  :                 +- Join Inner
                  :  :                    :- Join Inner
                  :  :                    :  :- SubqueryAlias `store_sales`
                  :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :                    :  +- SubqueryAlias `date_dim`
                  :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  :                    +- SubqueryAlias `item`
                  :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  :  +- Project [c_customer_sk#412]
                  :     +- SubqueryAlias `best_ss_customer`
                  :        +- Project [c_customer_sk#412, ssales#14773]
                  :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14785 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#14774 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
                  :              :  +- Project [tpcds_cmax#14772]
                  :              :     +- SubqueryAlias `max_store_sales`
                  :              :        +- Aggregate [max(csales#14771) AS tpcds_cmax#14772]
                  :              :           +- SubqueryAlias `x`
                  :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#14771]
                  :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                  :              :                    +- Join Inner
                  :              :                       :- Join Inner
                  :              :                       :  :- SubqueryAlias `store_sales`
                  :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :              :                       :  +- SubqueryAlias `customer`
                  :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :              :                       +- SubqueryAlias `date_dim`
                  :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#14773, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14785]
                  :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
                  :                    +- Join Inner
                  :                       :- SubqueryAlias `store_sales`
                  :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :                       +- SubqueryAlias `customer`
                  :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  +- Join Inner
                     :- SubqueryAlias `web_sales`
                     :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:19:43 INFO Query: 
== Query: q23a-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [sum(sales#14798) AS sum(sales)#14833]
      +- SubqueryAlias `x`
         +- Union
            :- Project [CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2)) AS sales#14798]
            :  +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (cs_sold_date_sk#0 = d_date_sk#492)) && (cs_item_sk#15 IN (list#14799 []) && cs_bill_customer_sk#3 IN (list#14800 [])))
            :     :  :- Project [item_sk#14805]
            :     :  :  +- SubqueryAlias `frequent_ss_items`
            :     :  :     +- Project [itemdesc#14804, item_sk#14805, solddate#14806, cnt#14807L]
            :     :  :        +- Filter (count(1)#14815L > cast(4 as bigint))
            :     :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#14804, i_item_sk#564 AS item_sk#14805, d_date#494 AS solddate#14806, count(1) AS cnt#14807L, count(1) AS count(1)#14815L]
            :     :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
            :     :  :                 +- Join Inner
            :     :  :                    :- Join Inner
            :     :  :                    :  :- SubqueryAlias `store_sales`
            :     :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :  :                    :  +- SubqueryAlias `date_dim`
            :     :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     :  :                    +- SubqueryAlias `item`
            :     :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            :     :  +- Project [c_customer_sk#412]
            :     :     +- SubqueryAlias `best_ss_customer`
            :     :        +- Project [c_customer_sk#412, ssales#14810]
            :     :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14822 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#14811 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
            :     :              :  +- Project [tpcds_cmax#14809]
            :     :              :     +- SubqueryAlias `max_store_sales`
            :     :              :        +- Aggregate [max(csales#14808) AS tpcds_cmax#14809]
            :     :              :           +- SubqueryAlias `x`
            :     :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#14808]
            :     :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
            :     :              :                    +- Join Inner
            :     :              :                       :- Join Inner
            :     :              :                       :  :- SubqueryAlias `store_sales`
            :     :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :              :                       :  +- SubqueryAlias `customer`
            :     :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :     :              :                       +- SubqueryAlias `date_dim`
            :     :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#14810, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14822]
            :     :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
            :     :                    +- Join Inner
            :     :                       :- SubqueryAlias `store_sales`
            :     :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :                       +- SubqueryAlias `customer`
            :     :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :     +- Join Inner
            :        :- SubqueryAlias `catalog_sales`
            :        :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :        +- SubqueryAlias `date_dim`
            :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Project [CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2)) AS sales#14801]
               +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (ws_sold_date_sk#216 = d_date_sk#492)) && (ws_item_sk#219 IN (list#14802 []) && ws_bill_customer_sk#220 IN (list#14803 [])))
                  :  :- Project [item_sk#14805]
                  :  :  +- SubqueryAlias `frequent_ss_items`
                  :  :     +- Project [itemdesc#14804, item_sk#14805, solddate#14806, cnt#14807L]
                  :  :        +- Filter (count(1)#14815L > cast(4 as bigint))
                  :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#14804, i_item_sk#564 AS item_sk#14805, d_date#494 AS solddate#14806, count(1) AS cnt#14807L, count(1) AS count(1)#14815L]
                  :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                  :  :                 +- Join Inner
                  :  :                    :- Join Inner
                  :  :                    :  :- SubqueryAlias `store_sales`
                  :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :                    :  +- SubqueryAlias `date_dim`
                  :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  :                    +- SubqueryAlias `item`
                  :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  :  +- Project [c_customer_sk#412]
                  :     +- SubqueryAlias `best_ss_customer`
                  :        +- Project [c_customer_sk#412, ssales#14810]
                  :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14822 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#14811 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
                  :              :  +- Project [tpcds_cmax#14809]
                  :              :     +- SubqueryAlias `max_store_sales`
                  :              :        +- Aggregate [max(csales#14808) AS tpcds_cmax#14809]
                  :              :           +- SubqueryAlias `x`
                  :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#14808]
                  :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                  :              :                    +- Join Inner
                  :              :                       :- Join Inner
                  :              :                       :  :- SubqueryAlias `store_sales`
                  :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :              :                       :  +- SubqueryAlias `customer`
                  :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :              :                       +- SubqueryAlias `date_dim`
                  :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#14810, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14822]
                  :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
                  :                    +- Join Inner
                  :                       :- SubqueryAlias `store_sales`
                  :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :                       +- SubqueryAlias `customer`
                  :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  +- Join Inner
                     :- SubqueryAlias `web_sales`
                     :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 32.896090627999996s
Running execution q23b-v2.4 iteration: 1, StandardRun=true
19/09/08 18:20:19 INFO Query: 
== Query: q23b-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, sales#14997 ASC NULLS FIRST], true
      +- Project [c_last_name#421, c_first_name#420, sales#14997]
         +- SubqueryAlias `y`
            +- Union
               :- Aggregate [c_last_name#421, c_first_name#420], [c_last_name#421, c_first_name#420, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2))) AS sales#14997]
               :  +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((cs_item_sk#15 IN (list#14998 []) && cs_bill_customer_sk#3 IN (list#14999 [])) && (cs_bill_customer_sk#3 = c_customer_sk#412)))
               :     :  :- Project [item_sk#15004]
               :     :  :  +- SubqueryAlias `frequent_ss_items`
               :     :  :     +- Project [itemdesc#15003, item_sk#15004, solddate#15005, cnt#15006L]
               :     :  :        +- Filter (count(1)#15014L > cast(4 as bigint))
               :     :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#15003, i_item_sk#564 AS item_sk#15004, d_date#494 AS solddate#15005, count(1) AS cnt#15006L, count(1) AS count(1)#15014L]
               :     :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
               :     :  :                 +- Join Inner
               :     :  :                    :- Join Inner
               :     :  :                    :  :- SubqueryAlias `store_sales`
               :     :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :     :  :                    :  +- SubqueryAlias `date_dim`
               :     :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :     :  :                    +- SubqueryAlias `item`
               :     :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :     :  +- Project [c_customer_sk#412]
               :     :     +- SubqueryAlias `best_ss_customer`
               :     :        +- Project [c_customer_sk#412, ssales#15009]
               :     :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#15021 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#15010 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
               :     :              :  +- Project [tpcds_cmax#15008]
               :     :              :     +- SubqueryAlias `max_store_sales`
               :     :              :        +- Aggregate [max(csales#15007) AS tpcds_cmax#15008]
               :     :              :           +- SubqueryAlias `x`
               :     :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#15007]
               :     :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
               :     :              :                    +- Join Inner
               :     :              :                       :- Join Inner
               :     :              :                       :  :- SubqueryAlias `store_sales`
               :     :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :     :              :                       :  +- SubqueryAlias `customer`
               :     :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :     :              :                       +- SubqueryAlias `date_dim`
               :     :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :     :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#15009, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#15021]
               :     :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
               :     :                    +- Join Inner
               :     :                       :- SubqueryAlias `store_sales`
               :     :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :     :                       +- SubqueryAlias `customer`
               :     :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :     +- Join Inner
               :        :- Join Inner
               :        :  :- SubqueryAlias `catalog_sales`
               :        :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :        :  +- SubqueryAlias `customer`
               :        :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :        +- SubqueryAlias `date_dim`
               :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- Aggregate [c_last_name#421, c_first_name#420], [c_last_name#421, c_first_name#420, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2))) AS sales#15000]
                  +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((ws_item_sk#219 IN (list#15001 []) && ws_bill_customer_sk#220 IN (list#15002 [])) && (ws_bill_customer_sk#220 = c_customer_sk#412)))
                     :  :- Project [item_sk#15004]
                     :  :  +- SubqueryAlias `frequent_ss_items`
                     :  :     +- Project [itemdesc#15003, item_sk#15004, solddate#15005, cnt#15006L]
                     :  :        +- Filter (count(1)#15014L > cast(4 as bigint))
                     :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#15003, i_item_sk#564 AS item_sk#15004, d_date#494 AS solddate#15005, count(1) AS cnt#15006L, count(1) AS count(1)#15014L]
                     :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                     :  :                 +- Join Inner
                     :  :                    :- Join Inner
                     :  :                    :  :- SubqueryAlias `store_sales`
                     :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :                    :  +- SubqueryAlias `date_dim`
                     :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :                    +- SubqueryAlias `item`
                     :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  +- Project [c_customer_sk#412]
                     :     +- SubqueryAlias `best_ss_customer`
                     :        +- Project [c_customer_sk#412, ssales#15009]
                     :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#15021 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#15010 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
                     :              :  +- Project [tpcds_cmax#15008]
                     :              :     +- SubqueryAlias `max_store_sales`
                     :              :        +- Aggregate [max(csales#15007) AS tpcds_cmax#15008]
                     :              :           +- SubqueryAlias `x`
                     :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#15007]
                     :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                     :              :                    +- Join Inner
                     :              :                       :- Join Inner
                     :              :                       :  :- SubqueryAlias `store_sales`
                     :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :              :                       :  +- SubqueryAlias `customer`
                     :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     :              :                       +- SubqueryAlias `date_dim`
                     :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#15009, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#15021]
                     :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
                     :                    +- Join Inner
                     :                       :- SubqueryAlias `store_sales`
                     :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :                       +- SubqueryAlias `customer`
                     :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `web_sales`
                        :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  +- SubqueryAlias `customer`
                        :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:20:20 INFO Query: 
== Query: q23b-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, sales#15036 ASC NULLS FIRST], true
      +- Project [c_last_name#421, c_first_name#420, sales#15036]
         +- SubqueryAlias `y`
            +- Union
               :- Aggregate [c_last_name#421, c_first_name#420], [c_last_name#421, c_first_name#420, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2))) AS sales#15036]
               :  +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((cs_item_sk#15 IN (list#15037 []) && cs_bill_customer_sk#3 IN (list#15038 [])) && (cs_bill_customer_sk#3 = c_customer_sk#412)))
               :     :  :- Project [item_sk#15043]
               :     :  :  +- SubqueryAlias `frequent_ss_items`
               :     :  :     +- Project [itemdesc#15042, item_sk#15043, solddate#15044, cnt#15045L]
               :     :  :        +- Filter (count(1)#15053L > cast(4 as bigint))
               :     :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#15042, i_item_sk#564 AS item_sk#15043, d_date#494 AS solddate#15044, count(1) AS cnt#15045L, count(1) AS count(1)#15053L]
               :     :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
               :     :  :                 +- Join Inner
               :     :  :                    :- Join Inner
               :     :  :                    :  :- SubqueryAlias `store_sales`
               :     :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :     :  :                    :  +- SubqueryAlias `date_dim`
               :     :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :     :  :                    +- SubqueryAlias `item`
               :     :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :     :  +- Project [c_customer_sk#412]
               :     :     +- SubqueryAlias `best_ss_customer`
               :     :        +- Project [c_customer_sk#412, ssales#15048]
               :     :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#15060 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#15049 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
               :     :              :  +- Project [tpcds_cmax#15047]
               :     :              :     +- SubqueryAlias `max_store_sales`
               :     :              :        +- Aggregate [max(csales#15046) AS tpcds_cmax#15047]
               :     :              :           +- SubqueryAlias `x`
               :     :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#15046]
               :     :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
               :     :              :                    +- Join Inner
               :     :              :                       :- Join Inner
               :     :              :                       :  :- SubqueryAlias `store_sales`
               :     :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :     :              :                       :  +- SubqueryAlias `customer`
               :     :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :     :              :                       +- SubqueryAlias `date_dim`
               :     :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :     :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#15048, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#15060]
               :     :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
               :     :                    +- Join Inner
               :     :                       :- SubqueryAlias `store_sales`
               :     :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :     :                       +- SubqueryAlias `customer`
               :     :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :     +- Join Inner
               :        :- Join Inner
               :        :  :- SubqueryAlias `catalog_sales`
               :        :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :        :  +- SubqueryAlias `customer`
               :        :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :        +- SubqueryAlias `date_dim`
               :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- Aggregate [c_last_name#421, c_first_name#420], [c_last_name#421, c_first_name#420, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2))) AS sales#15039]
                  +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((ws_item_sk#219 IN (list#15040 []) && ws_bill_customer_sk#220 IN (list#15041 [])) && (ws_bill_customer_sk#220 = c_customer_sk#412)))
                     :  :- Project [item_sk#15043]
                     :  :  +- SubqueryAlias `frequent_ss_items`
                     :  :     +- Project [itemdesc#15042, item_sk#15043, solddate#15044, cnt#15045L]
                     :  :        +- Filter (count(1)#15053L > cast(4 as bigint))
                     :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#15042, i_item_sk#564 AS item_sk#15043, d_date#494 AS solddate#15044, count(1) AS cnt#15045L, count(1) AS count(1)#15053L]
                     :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                     :  :                 +- Join Inner
                     :  :                    :- Join Inner
                     :  :                    :  :- SubqueryAlias `store_sales`
                     :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :                    :  +- SubqueryAlias `date_dim`
                     :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :                    +- SubqueryAlias `item`
                     :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  +- Project [c_customer_sk#412]
                     :     +- SubqueryAlias `best_ss_customer`
                     :        +- Project [c_customer_sk#412, ssales#15048]
                     :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#15060 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#15049 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
                     :              :  +- Project [tpcds_cmax#15047]
                     :              :     +- SubqueryAlias `max_store_sales`
                     :              :        +- Aggregate [max(csales#15046) AS tpcds_cmax#15047]
                     :              :           +- SubqueryAlias `x`
                     :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#15046]
                     :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                     :              :                    +- Join Inner
                     :              :                       :- Join Inner
                     :              :                       :  :- SubqueryAlias `store_sales`
                     :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :              :                       :  +- SubqueryAlias `customer`
                     :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     :              :                       +- SubqueryAlias `date_dim`
                     :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#15048, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#15060]
                     :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
                     :                    +- Join Inner
                     :                       :- SubqueryAlias `store_sales`
                     :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :                       +- SubqueryAlias `customer`
                     :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `web_sales`
                        :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  +- SubqueryAlias `customer`
                        :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 29.640964369000002s
Running execution q24a-v2.4 iteration: 1, StandardRun=true
19/09/08 18:20:52 INFO Query: 
== Query: q24a-v2.4 ==
Project [c_last_name#421, c_first_name#420, s_store_name#669, paid#15205]
+- Filter (cast(sum(netpaid#15207)#15214 as decimal(33,8)) > cast(scalar-subquery#15206 [] as decimal(33,8)))
   :  +- Aggregate [CheckOverflow((promote_precision(cast(0.05 as decimal(21,6))) * promote_precision(cast(avg(netpaid#15207) as decimal(21,6)))), DecimalType(24,8)) AS (CAST(0.05 AS DECIMAL(21,6)) * CAST(avg(netpaid) AS DECIMAL(21,6)))#15211]
   :     +- SubqueryAlias `ssales`
   :        +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15207]
   :           +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
   :              +- Join Inner
   :                 :- Join Inner
   :                 :  :- Join Inner
   :                 :  :  :- Join Inner
   :                 :  :  :  :- Join Inner
   :                 :  :  :  :  :- SubqueryAlias `store_sales`
   :                 :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :                 :  :  :  :  +- SubqueryAlias `store_returns`
   :                 :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
   :                 :  :  :  +- SubqueryAlias `store`
   :                 :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :                 :  :  +- SubqueryAlias `item`
   :                 :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
   :                 :  +- SubqueryAlias `customer`
   :                 :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
   :                 +- SubqueryAlias `customer_address`
   :                    +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
   +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669], [c_last_name#421, c_first_name#420, s_store_name#669, sum(netpaid#15207) AS paid#15205, sum(netpaid#15207) AS sum(netpaid#15207)#15214]
      +- Filter (i_color#581 = pale)
         +- SubqueryAlias `ssales`
            +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15207]
               +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- SubqueryAlias `store_sales`
                     :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :  :  :  +- SubqueryAlias `store_returns`
                     :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :  :  +- SubqueryAlias `store`
                     :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  :  +- SubqueryAlias `item`
                     :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  +- SubqueryAlias `customer`
                     :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     +- SubqueryAlias `customer_address`
                        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

     : benchmark
19/09/08 18:20:52 INFO Query: 
== Query: q24a-v2.4 ==
Project [c_last_name#421, c_first_name#420, s_store_name#669, paid#15220]
+- Filter (cast(sum(netpaid#15222)#15229 as decimal(33,8)) > cast(scalar-subquery#15221 [] as decimal(33,8)))
   :  +- Aggregate [CheckOverflow((promote_precision(cast(0.05 as decimal(21,6))) * promote_precision(cast(avg(netpaid#15222) as decimal(21,6)))), DecimalType(24,8)) AS (CAST(0.05 AS DECIMAL(21,6)) * CAST(avg(netpaid) AS DECIMAL(21,6)))#15226]
   :     +- SubqueryAlias `ssales`
   :        +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15222]
   :           +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
   :              +- Join Inner
   :                 :- Join Inner
   :                 :  :- Join Inner
   :                 :  :  :- Join Inner
   :                 :  :  :  :- Join Inner
   :                 :  :  :  :  :- SubqueryAlias `store_sales`
   :                 :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :                 :  :  :  :  +- SubqueryAlias `store_returns`
   :                 :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
   :                 :  :  :  +- SubqueryAlias `store`
   :                 :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :                 :  :  +- SubqueryAlias `item`
   :                 :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
   :                 :  +- SubqueryAlias `customer`
   :                 :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
   :                 +- SubqueryAlias `customer_address`
   :                    +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
   +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669], [c_last_name#421, c_first_name#420, s_store_name#669, sum(netpaid#15222) AS paid#15220, sum(netpaid#15222) AS sum(netpaid#15222)#15229]
      +- Filter (i_color#581 = pale)
         +- SubqueryAlias `ssales`
            +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15222]
               +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- SubqueryAlias `store_sales`
                     :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :  :  :  +- SubqueryAlias `store_returns`
                     :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :  :  +- SubqueryAlias `store`
                     :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  :  +- SubqueryAlias `item`
                     :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  +- SubqueryAlias `customer`
                     :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     +- SubqueryAlias `customer_address`
                        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

      running Thread[benchmark runner,5,main]
Execution time: 20.268969405s
Running execution q24b-v2.4 iteration: 1, StandardRun=true
19/09/08 18:21:15 INFO Query: 
== Query: q24b-v2.4 ==
Project [c_last_name#421, c_first_name#420, s_store_name#669, paid#15301]
+- Filter (cast(sum(netpaid#15303)#15310 as decimal(33,8)) > cast(scalar-subquery#15302 [] as decimal(33,8)))
   :  +- Aggregate [CheckOverflow((promote_precision(cast(0.05 as decimal(21,6))) * promote_precision(cast(avg(netpaid#15303) as decimal(21,6)))), DecimalType(24,8)) AS (CAST(0.05 AS DECIMAL(21,6)) * CAST(avg(netpaid) AS DECIMAL(21,6)))#15307]
   :     +- SubqueryAlias `ssales`
   :        +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15303]
   :           +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
   :              +- Join Inner
   :                 :- Join Inner
   :                 :  :- Join Inner
   :                 :  :  :- Join Inner
   :                 :  :  :  :- Join Inner
   :                 :  :  :  :  :- SubqueryAlias `store_sales`
   :                 :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :                 :  :  :  :  +- SubqueryAlias `store_returns`
   :                 :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
   :                 :  :  :  +- SubqueryAlias `store`
   :                 :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :                 :  :  +- SubqueryAlias `item`
   :                 :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
   :                 :  +- SubqueryAlias `customer`
   :                 :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
   :                 +- SubqueryAlias `customer_address`
   :                    +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
   +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669], [c_last_name#421, c_first_name#420, s_store_name#669, sum(netpaid#15303) AS paid#15301, sum(netpaid#15303) AS sum(netpaid#15303)#15310]
      +- Filter (i_color#581 = chiffon)
         +- SubqueryAlias `ssales`
            +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15303]
               +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- SubqueryAlias `store_sales`
                     :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :  :  :  +- SubqueryAlias `store_returns`
                     :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :  :  +- SubqueryAlias `store`
                     :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  :  +- SubqueryAlias `item`
                     :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  +- SubqueryAlias `customer`
                     :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     +- SubqueryAlias `customer_address`
                        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

     : benchmark
19/09/08 18:21:15 INFO Query: 
== Query: q24b-v2.4 ==
Project [c_last_name#421, c_first_name#420, s_store_name#669, paid#15316]
+- Filter (cast(sum(netpaid#15318)#15325 as decimal(33,8)) > cast(scalar-subquery#15317 [] as decimal(33,8)))
   :  +- Aggregate [CheckOverflow((promote_precision(cast(0.05 as decimal(21,6))) * promote_precision(cast(avg(netpaid#15318) as decimal(21,6)))), DecimalType(24,8)) AS (CAST(0.05 AS DECIMAL(21,6)) * CAST(avg(netpaid) AS DECIMAL(21,6)))#15322]
   :     +- SubqueryAlias `ssales`
   :        +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15318]
   :           +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
   :              +- Join Inner
   :                 :- Join Inner
   :                 :  :- Join Inner
   :                 :  :  :- Join Inner
   :                 :  :  :  :- Join Inner
   :                 :  :  :  :  :- SubqueryAlias `store_sales`
   :                 :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :                 :  :  :  :  +- SubqueryAlias `store_returns`
   :                 :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
   :                 :  :  :  +- SubqueryAlias `store`
   :                 :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :                 :  :  +- SubqueryAlias `item`
   :                 :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
   :                 :  +- SubqueryAlias `customer`
   :                 :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
   :                 +- SubqueryAlias `customer_address`
   :                    +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
   +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669], [c_last_name#421, c_first_name#420, s_store_name#669, sum(netpaid#15318) AS paid#15316, sum(netpaid#15318) AS sum(netpaid#15318)#15325]
      +- Filter (i_color#581 = chiffon)
         +- SubqueryAlias `ssales`
            +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15318]
               +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- SubqueryAlias `store_sales`
                     :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :  :  :  +- SubqueryAlias `store_returns`
                     :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :  :  +- SubqueryAlias `store`
                     :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  :  +- SubqueryAlias `item`
                     :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  +- SubqueryAlias `customer`
                     :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     +- SubqueryAlias `customer_address`
                        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

      running Thread[benchmark runner,5,main]
Execution time: 18.838072978s
Running execution q25-v2.4 iteration: 1, StandardRun=true
19/09/08 18:21:36 INFO Query: 
== Query: q25-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, store_sales_profit#15451, store_returns_loss#15452, catalog_sales_profit#15453]
      +- Sort [i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, s_store_id#665 ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669], [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, sum(ss_net_profit#152) AS store_sales_profit#15451, sum(sr_net_loss#195) AS store_returns_loss#15452, sum(cs_net_profit#33) AS catalog_sales_profit#15453]
            +- Filter (((((d_moy#500 = 4) && (d_year#498 = 2001)) && ((d_date_sk#492 = ss_sold_date_sk#130) && (i_item_sk#564 = ss_item_sk#132))) && (((s_store_sk#664 = ss_store_sk#137) && (ss_customer_sk#133 = sr_customer_sk#179)) && ((ss_item_sk#132 = sr_item_sk#178) && (ss_ticket_number#139L = sr_ticket_number#185L)))) && ((((sr_returned_date_sk#176 = d_date_sk#15454) && ((d_moy#15462 >= 4) && (d_moy#15462 <= 10))) && ((d_year#15460 = 2001) && (sr_customer_sk#179 = cs_bill_customer_sk#3))) && (((sr_item_sk#178 = cs_item_sk#15) && (cs_sold_date_sk#0 = d_date_sk#15482)) && (((d_moy#15490 >= 4) && (d_moy#15490 <= 10)) && (d_year#15488 = 2001)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :  :  :  :  +- SubqueryAlias `catalog_sales`
                  :  :  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  :  +- SubqueryAlias `d1`
                  :  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  :  :  +- SubqueryAlias `d2`
                  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :        +- Relation[d_date_sk#15454,d_date_id#15455,d_date#15456,d_month_seq#15457,d_week_seq#15458,d_quarter_seq#15459,d_year#15460,d_dow#15461,d_moy#15462,d_dom#15463,d_qoy#15464,d_fy_year#15465,d_fy_quarter_seq#15466,d_fy_week_seq#15467,d_day_name#15468,d_quarter_name#15469,d_holiday#15470,d_weekend#15471,d_following_holiday#15472,d_first_dom#15473,d_last_dom#15474,d_same_day_ly#15475,d_same_day_lq#15476,d_current_day#15477,... 4 more fields] parquet
                  :  :  +- SubqueryAlias `d3`
                  :  :     +- SubqueryAlias `date_dim`
                  :  :        +- Relation[d_date_sk#15482,d_date_id#15483,d_date#15484,d_month_seq#15485,d_week_seq#15486,d_quarter_seq#15487,d_year#15488,d_dow#15489,d_moy#15490,d_dom#15491,d_qoy#15492,d_fy_year#15493,d_fy_quarter_seq#15494,d_fy_week_seq#15495,d_day_name#15496,d_quarter_name#15497,d_holiday#15498,d_weekend#15499,d_following_holiday#15500,d_first_dom#15501,d_last_dom#15502,d_same_day_ly#15503,d_same_day_lq#15504,d_current_day#15505,... 4 more fields] parquet
                  :  +- SubqueryAlias `store`
                  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:21:36 INFO Query: 
== Query: q25-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, store_sales_profit#15524, store_returns_loss#15525, catalog_sales_profit#15526]
      +- Sort [i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, s_store_id#665 ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669], [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, sum(ss_net_profit#152) AS store_sales_profit#15524, sum(sr_net_loss#195) AS store_returns_loss#15525, sum(cs_net_profit#33) AS catalog_sales_profit#15526]
            +- Filter (((((d_moy#500 = 4) && (d_year#498 = 2001)) && ((d_date_sk#492 = ss_sold_date_sk#130) && (i_item_sk#564 = ss_item_sk#132))) && (((s_store_sk#664 = ss_store_sk#137) && (ss_customer_sk#133 = sr_customer_sk#179)) && ((ss_item_sk#132 = sr_item_sk#178) && (ss_ticket_number#139L = sr_ticket_number#185L)))) && ((((sr_returned_date_sk#176 = d_date_sk#15527) && ((d_moy#15535 >= 4) && (d_moy#15535 <= 10))) && ((d_year#15533 = 2001) && (sr_customer_sk#179 = cs_bill_customer_sk#3))) && (((sr_item_sk#178 = cs_item_sk#15) && (cs_sold_date_sk#0 = d_date_sk#15555)) && (((d_moy#15563 >= 4) && (d_moy#15563 <= 10)) && (d_year#15561 = 2001)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :  :  :  :  +- SubqueryAlias `catalog_sales`
                  :  :  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  :  +- SubqueryAlias `d1`
                  :  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  :  :  +- SubqueryAlias `d2`
                  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :        +- Relation[d_date_sk#15527,d_date_id#15528,d_date#15529,d_month_seq#15530,d_week_seq#15531,d_quarter_seq#15532,d_year#15533,d_dow#15534,d_moy#15535,d_dom#15536,d_qoy#15537,d_fy_year#15538,d_fy_quarter_seq#15539,d_fy_week_seq#15540,d_day_name#15541,d_quarter_name#15542,d_holiday#15543,d_weekend#15544,d_following_holiday#15545,d_first_dom#15546,d_last_dom#15547,d_same_day_ly#15548,d_same_day_lq#15549,d_current_day#15550,... 4 more fields] parquet
                  :  :  +- SubqueryAlias `d3`
                  :  :     +- SubqueryAlias `date_dim`
                  :  :        +- Relation[d_date_sk#15555,d_date_id#15556,d_date#15557,d_month_seq#15558,d_week_seq#15559,d_quarter_seq#15560,d_year#15561,d_dow#15562,d_moy#15563,d_dom#15564,d_qoy#15565,d_fy_year#15566,d_fy_quarter_seq#15567,d_fy_week_seq#15568,d_day_name#15569,d_quarter_name#15570,d_holiday#15571,d_weekend#15572,d_following_holiday#15573,d_first_dom#15574,d_last_dom#15575,d_same_day_ly#15576,d_same_day_lq#15577,d_current_day#15578,... 4 more fields] parquet
                  :  +- SubqueryAlias `store`
                  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 14.783679379999999s
Running execution q26-v2.4 iteration: 1, StandardRun=true
19/09/08 18:21:52 INFO Query: 
== Query: q26-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, agg1#15780, agg2#15781, agg3#15782, agg4#15783]
      +- Sort [i_item_id#565 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565], [i_item_id#565, avg(cast(cs_quantity#18 as bigint)) AS agg1#15780, avg(cs_list_price#20) AS agg2#15781, avg(cs_coupon_amt#27) AS agg3#15782, avg(cs_sales_price#21) AS agg4#15783]
            +- Filter (((((cs_sold_date_sk#0 = d_date_sk#492) && (cs_item_sk#15 = i_item_sk#564)) && (cs_bill_cdemo_sk#4 = cd_demo_sk#474)) && ((cs_promo_sk#16 = p_promo_sk#608) && (cd_gender#475 = M))) && (((cd_marital_status#476 = S) && (cd_education_status#477 = College)) && (((p_channel_email#617 = N) || (p_channel_event#622 = N)) && (d_year#498 = 2000))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `customer_demographics`
                  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `promotion`
                     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet

     : benchmark
19/09/08 18:21:52 INFO Query: 
== Query: q26-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, agg1#15794, agg2#15795, agg3#15796, agg4#15797]
      +- Sort [i_item_id#565 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565], [i_item_id#565, avg(cast(cs_quantity#18 as bigint)) AS agg1#15794, avg(cs_list_price#20) AS agg2#15795, avg(cs_coupon_amt#27) AS agg3#15796, avg(cs_sales_price#21) AS agg4#15797]
            +- Filter (((((cs_sold_date_sk#0 = d_date_sk#492) && (cs_item_sk#15 = i_item_sk#564)) && (cs_bill_cdemo_sk#4 = cd_demo_sk#474)) && ((cs_promo_sk#16 = p_promo_sk#608) && (cd_gender#475 = M))) && (((cd_marital_status#476 = S) && (cd_education_status#477 = College)) && (((p_channel_email#617 = N) || (p_channel_event#622 = N)) && (d_year#498 = 2000))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `customer_demographics`
                  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `promotion`
                     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet

      running Thread[benchmark runner,5,main]
Execution time: 2.708699726s
Running execution q27-v2.4 iteration: 1, StandardRun=true
19/09/08 18:21:56 INFO Query: 
== Query: q27-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#15905 ASC NULLS FIRST, s_state#15906 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#15905, s_state#15906, spark_grouping_id#15902], [i_item_id#15905, s_state#15906, cast((shiftright(spark_grouping_id#15902, 0) & 1) as tinyint) AS g_state#15893, avg(cast(ss_quantity#140 as bigint)) AS agg1#15894, avg(ss_list_price#142) AS agg2#15895, avg(ss_coupon_amt#149) AS agg3#15896, avg(ss_sales_price#143) AS agg4#15897]
         +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#15903, s_state#15904, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#15903, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, ... 90 more fields]
            +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, ... 89 more fields]
               +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_cdemo_sk#134 = cd_demo_sk#474) && (cd_gender#475 = M))) && (((cd_marital_status#476 = S) && (cd_education_status#477 = College)) && ((d_year#498 = 2002) && s_state#688 IN (TN,TN,TN,TN,TN,TN))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- SubqueryAlias `store_sales`
                     :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :  :  +- SubqueryAlias `customer_demographics`
                     :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                     :  :  +- SubqueryAlias `date_dim`
                     :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- SubqueryAlias `store`
                     :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     +- SubqueryAlias `item`
                        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:21:56 INFO Query: 
== Query: q27-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#15929 ASC NULLS FIRST, s_state#15930 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#15929, s_state#15930, spark_grouping_id#15926], [i_item_id#15929, s_state#15930, cast((shiftright(spark_grouping_id#15926, 0) & 1) as tinyint) AS g_state#15917, avg(cast(ss_quantity#140 as bigint)) AS agg1#15918, avg(ss_list_price#142) AS agg2#15919, avg(ss_coupon_amt#149) AS agg3#15920, avg(ss_sales_price#143) AS agg4#15921]
         +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#15927, s_state#15928, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#15927, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, ... 90 more fields]
            +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, ... 89 more fields]
               +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_cdemo_sk#134 = cd_demo_sk#474) && (cd_gender#475 = M))) && (((cd_marital_status#476 = S) && (cd_education_status#477 = College)) && ((d_year#498 = 2002) && s_state#688 IN (TN,TN,TN,TN,TN,TN))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- SubqueryAlias `store_sales`
                     :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :  :  +- SubqueryAlias `customer_demographics`
                     :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                     :  :  +- SubqueryAlias `date_dim`
                     :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- SubqueryAlias `store`
                     :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     +- SubqueryAlias `item`
                        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 3.668174861s
Running execution q28-v2.4 iteration: 1, StandardRun=true
19/09/08 18:22:00 INFO Query: 
== Query: q28-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [B1_LP#16180, B1_CNT#16181L, B1_CNTD#16182L, B2_LP#16183, B2_CNT#16184L, B2_CNTD#16185L, B3_LP#16186, B3_CNT#16187L, B3_CNTD#16188L, B4_LP#16189, B4_CNT#16190L, B4_CNTD#16191L, B5_LP#16192, B5_CNT#16193L, B5_CNTD#16194L, B6_LP#16195, B6_CNT#16196L, B6_CNTD#16197L]
      +- Join Cross
         :- Join Cross
         :  :- Join Cross
         :  :  :- Join Cross
         :  :  :  :- Join Cross
         :  :  :  :  :- SubqueryAlias `B1`
         :  :  :  :  :  +- Aggregate [avg(ss_list_price#142) AS B1_LP#16180, count(ss_list_price#142) AS B1_CNT#16181L, count(distinct ss_list_price#142) AS B1_CNTD#16182L]
         :  :  :  :  :     +- Filter (((ss_quantity#140 >= 0) && (ss_quantity#140 <= 5)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(8 as decimal(1,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((8 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(459 as decimal(3,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((459 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(57 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((57 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :  :  :  :        +- SubqueryAlias `store_sales`
         :  :  :  :  :           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  :  +- SubqueryAlias `B2`
         :  :  :  :     +- Aggregate [avg(ss_list_price#142) AS B2_LP#16183, count(ss_list_price#142) AS B2_CNT#16184L, count(distinct ss_list_price#142) AS B2_CNTD#16185L]
         :  :  :  :        +- Filter (((ss_quantity#140 >= 6) && (ss_quantity#140 <= 10)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(90 as decimal(2,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((90 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(2323 as decimal(4,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((2323 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(31 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((31 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :  :  :           +- SubqueryAlias `store_sales`
         :  :  :  :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  +- SubqueryAlias `B3`
         :  :  :     +- Aggregate [avg(ss_list_price#142) AS B3_LP#16186, count(ss_list_price#142) AS B3_CNT#16187L, count(distinct ss_list_price#142) AS B3_CNTD#16188L]
         :  :  :        +- Filter (((ss_quantity#140 >= 11) && (ss_quantity#140 <= 15)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(142 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((142 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(12214 as decimal(5,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((12214 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(79 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((79 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :  :           +- SubqueryAlias `store_sales`
         :  :  :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  +- SubqueryAlias `B4`
         :  :     +- Aggregate [avg(ss_list_price#142) AS B4_LP#16189, count(ss_list_price#142) AS B4_CNT#16190L, count(distinct ss_list_price#142) AS B4_CNTD#16191L]
         :  :        +- Filter (((ss_quantity#140 >= 16) && (ss_quantity#140 <= 20)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(135 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((135 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(6071 as decimal(4,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((6071 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(38 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((38 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :           +- SubqueryAlias `store_sales`
         :  :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  +- SubqueryAlias `B5`
         :     +- Aggregate [avg(ss_list_price#142) AS B5_LP#16192, count(ss_list_price#142) AS B5_CNT#16193L, count(distinct ss_list_price#142) AS B5_CNTD#16194L]
         :        +- Filter (((ss_quantity#140 >= 21) && (ss_quantity#140 <= 25)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(122 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((122 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(836 as decimal(3,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((836 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(17 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((17 + 20) as decimal(10,0)) as decimal(12,2))))))
         :           +- SubqueryAlias `store_sales`
         :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         +- SubqueryAlias `B6`
            +- Aggregate [avg(ss_list_price#142) AS B6_LP#16195, count(ss_list_price#142) AS B6_CNT#16196L, count(distinct ss_list_price#142) AS B6_CNTD#16197L]
               +- Filter (((ss_quantity#140 >= 26) && (ss_quantity#140 <= 30)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(154 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((154 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(7326 as decimal(4,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((7326 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(7 as decimal(1,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((7 + 20) as decimal(10,0)) as decimal(12,2))))))
                  +- SubqueryAlias `store_sales`
                     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
19/09/08 18:22:01 INFO Query: 
== Query: q28-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [B1_LP#16234, B1_CNT#16235L, B1_CNTD#16236L, B2_LP#16237, B2_CNT#16238L, B2_CNTD#16239L, B3_LP#16240, B3_CNT#16241L, B3_CNTD#16242L, B4_LP#16243, B4_CNT#16244L, B4_CNTD#16245L, B5_LP#16246, B5_CNT#16247L, B5_CNTD#16248L, B6_LP#16249, B6_CNT#16250L, B6_CNTD#16251L]
      +- Join Cross
         :- Join Cross
         :  :- Join Cross
         :  :  :- Join Cross
         :  :  :  :- Join Cross
         :  :  :  :  :- SubqueryAlias `B1`
         :  :  :  :  :  +- Aggregate [avg(ss_list_price#142) AS B1_LP#16234, count(ss_list_price#142) AS B1_CNT#16235L, count(distinct ss_list_price#142) AS B1_CNTD#16236L]
         :  :  :  :  :     +- Filter (((ss_quantity#140 >= 0) && (ss_quantity#140 <= 5)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(8 as decimal(1,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((8 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(459 as decimal(3,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((459 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(57 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((57 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :  :  :  :        +- SubqueryAlias `store_sales`
         :  :  :  :  :           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  :  +- SubqueryAlias `B2`
         :  :  :  :     +- Aggregate [avg(ss_list_price#142) AS B2_LP#16237, count(ss_list_price#142) AS B2_CNT#16238L, count(distinct ss_list_price#142) AS B2_CNTD#16239L]
         :  :  :  :        +- Filter (((ss_quantity#140 >= 6) && (ss_quantity#140 <= 10)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(90 as decimal(2,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((90 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(2323 as decimal(4,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((2323 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(31 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((31 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :  :  :           +- SubqueryAlias `store_sales`
         :  :  :  :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  +- SubqueryAlias `B3`
         :  :  :     +- Aggregate [avg(ss_list_price#142) AS B3_LP#16240, count(ss_list_price#142) AS B3_CNT#16241L, count(distinct ss_list_price#142) AS B3_CNTD#16242L]
         :  :  :        +- Filter (((ss_quantity#140 >= 11) && (ss_quantity#140 <= 15)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(142 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((142 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(12214 as decimal(5,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((12214 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(79 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((79 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :  :           +- SubqueryAlias `store_sales`
         :  :  :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  +- SubqueryAlias `B4`
         :  :     +- Aggregate [avg(ss_list_price#142) AS B4_LP#16243, count(ss_list_price#142) AS B4_CNT#16244L, count(distinct ss_list_price#142) AS B4_CNTD#16245L]
         :  :        +- Filter (((ss_quantity#140 >= 16) && (ss_quantity#140 <= 20)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(135 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((135 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(6071 as decimal(4,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((6071 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(38 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((38 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :           +- SubqueryAlias `store_sales`
         :  :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  +- SubqueryAlias `B5`
         :     +- Aggregate [avg(ss_list_price#142) AS B5_LP#16246, count(ss_list_price#142) AS B5_CNT#16247L, count(distinct ss_list_price#142) AS B5_CNTD#16248L]
         :        +- Filter (((ss_quantity#140 >= 21) && (ss_quantity#140 <= 25)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(122 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((122 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(836 as decimal(3,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((836 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(17 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((17 + 20) as decimal(10,0)) as decimal(12,2))))))
         :           +- SubqueryAlias `store_sales`
         :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         +- SubqueryAlias `B6`
            +- Aggregate [avg(ss_list_price#142) AS B6_LP#16249, count(ss_list_price#142) AS B6_CNT#16250L, count(distinct ss_list_price#142) AS B6_CNTD#16251L]
               +- Filter (((ss_quantity#140 >= 26) && (ss_quantity#140 <= 30)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(154 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((154 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(7326 as decimal(4,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((7326 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(7 as decimal(1,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((7 + 20) as decimal(10,0)) as decimal(12,2))))))
                  +- SubqueryAlias `store_sales`
                     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 9.311445539000001s
Running execution q29-v2.4 iteration: 1, StandardRun=true
19/09/08 18:22:11 INFO Query: 
== Query: q29-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, store_sales_quantity#16596L, store_returns_quantity#16597L, catalog_sales_quantity#16598L]
      +- Sort [i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, s_store_id#665 ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669], [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, sum(cast(ss_quantity#140 as bigint)) AS store_sales_quantity#16596L, sum(cast(sr_return_quantity#186 as bigint)) AS store_returns_quantity#16597L, sum(cast(cs_quantity#18 as bigint)) AS catalog_sales_quantity#16598L]
            +- Filter (((((d_moy#500 = 9) && (d_year#498 = 1999)) && ((d_date_sk#492 = ss_sold_date_sk#130) && (i_item_sk#564 = ss_item_sk#132))) && (((s_store_sk#664 = ss_store_sk#137) && (ss_customer_sk#133 = sr_customer_sk#179)) && ((ss_item_sk#132 = sr_item_sk#178) && (ss_ticket_number#139L = sr_ticket_number#185L)))) && ((((sr_returned_date_sk#176 = d_date_sk#16599) && ((d_moy#16607 >= 9) && (d_moy#16607 <= (9 + 3)))) && ((d_year#16605 = 1999) && (sr_customer_sk#179 = cs_bill_customer_sk#3))) && (((sr_item_sk#178 = cs_item_sk#15) && (cs_sold_date_sk#0 = d_date_sk#16627)) && d_year#16633 IN (1999,(1999 + 1),(1999 + 2)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :  :  :  :  +- SubqueryAlias `catalog_sales`
                  :  :  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  :  +- SubqueryAlias `d1`
                  :  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  :  :  +- SubqueryAlias `d2`
                  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :        +- Relation[d_date_sk#16599,d_date_id#16600,d_date#16601,d_month_seq#16602,d_week_seq#16603,d_quarter_seq#16604,d_year#16605,d_dow#16606,d_moy#16607,d_dom#16608,d_qoy#16609,d_fy_year#16610,d_fy_quarter_seq#16611,d_fy_week_seq#16612,d_day_name#16613,d_quarter_name#16614,d_holiday#16615,d_weekend#16616,d_following_holiday#16617,d_first_dom#16618,d_last_dom#16619,d_same_day_ly#16620,d_same_day_lq#16621,d_current_day#16622,... 4 more fields] parquet
                  :  :  +- SubqueryAlias `d3`
                  :  :     +- SubqueryAlias `date_dim`
                  :  :        +- Relation[d_date_sk#16627,d_date_id#16628,d_date#16629,d_month_seq#16630,d_week_seq#16631,d_quarter_seq#16632,d_year#16633,d_dow#16634,d_moy#16635,d_dom#16636,d_qoy#16637,d_fy_year#16638,d_fy_quarter_seq#16639,d_fy_week_seq#16640,d_day_name#16641,d_quarter_name#16642,d_holiday#16643,d_weekend#16644,d_following_holiday#16645,d_first_dom#16646,d_last_dom#16647,d_same_day_ly#16648,d_same_day_lq#16649,d_current_day#16650,... 4 more fields] parquet
                  :  +- SubqueryAlias `store`
                  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:22:11 INFO Query: 
== Query: q29-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, store_sales_quantity#16669L, store_returns_quantity#16670L, catalog_sales_quantity#16671L]
      +- Sort [i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, s_store_id#665 ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669], [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, sum(cast(ss_quantity#140 as bigint)) AS store_sales_quantity#16669L, sum(cast(sr_return_quantity#186 as bigint)) AS store_returns_quantity#16670L, sum(cast(cs_quantity#18 as bigint)) AS catalog_sales_quantity#16671L]
            +- Filter (((((d_moy#500 = 9) && (d_year#498 = 1999)) && ((d_date_sk#492 = ss_sold_date_sk#130) && (i_item_sk#564 = ss_item_sk#132))) && (((s_store_sk#664 = ss_store_sk#137) && (ss_customer_sk#133 = sr_customer_sk#179)) && ((ss_item_sk#132 = sr_item_sk#178) && (ss_ticket_number#139L = sr_ticket_number#185L)))) && ((((sr_returned_date_sk#176 = d_date_sk#16672) && ((d_moy#16680 >= 9) && (d_moy#16680 <= (9 + 3)))) && ((d_year#16678 = 1999) && (sr_customer_sk#179 = cs_bill_customer_sk#3))) && (((sr_item_sk#178 = cs_item_sk#15) && (cs_sold_date_sk#0 = d_date_sk#16700)) && d_year#16706 IN (1999,(1999 + 1),(1999 + 2)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :  :  :  :  +- SubqueryAlias `catalog_sales`
                  :  :  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  :  +- SubqueryAlias `d1`
                  :  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  :  :  +- SubqueryAlias `d2`
                  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :        +- Relation[d_date_sk#16672,d_date_id#16673,d_date#16674,d_month_seq#16675,d_week_seq#16676,d_quarter_seq#16677,d_year#16678,d_dow#16679,d_moy#16680,d_dom#16681,d_qoy#16682,d_fy_year#16683,d_fy_quarter_seq#16684,d_fy_week_seq#16685,d_day_name#16686,d_quarter_name#16687,d_holiday#16688,d_weekend#16689,d_following_holiday#16690,d_first_dom#16691,d_last_dom#16692,d_same_day_ly#16693,d_same_day_lq#16694,d_current_day#16695,... 4 more fields] parquet
                  :  :  +- SubqueryAlias `d3`
                  :  :     +- SubqueryAlias `date_dim`
                  :  :        +- Relation[d_date_sk#16700,d_date_id#16701,d_date#16702,d_month_seq#16703,d_week_seq#16704,d_quarter_seq#16705,d_year#16706,d_dow#16707,d_moy#16708,d_dom#16709,d_qoy#16710,d_fy_year#16711,d_fy_quarter_seq#16712,d_fy_week_seq#16713,d_day_name#16714,d_quarter_name#16715,d_holiday#16716,d_weekend#16717,d_following_holiday#16718,d_first_dom#16719,d_last_dom#16720,d_same_day_ly#16721,d_same_day_lq#16722,d_current_day#16723,... 4 more fields] parquet
                  :  +- SubqueryAlias `store`
                  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 14.056459867s
Running execution q30-v2.4 iteration: 1, StandardRun=true
19/09/08 18:22:27 INFO Query: 
== Query: q30-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_customer_id#413 ASC NULLS FIRST, c_salutation#419 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, c_last_name#421 ASC NULLS FIRST, c_preferred_cust_flag#422 ASC NULLS FIRST, c_birth_day#423 ASC NULLS FIRST, c_birth_month#424 ASC NULLS FIRST, c_birth_year#425 ASC NULLS FIRST, c_birth_country#426 ASC NULLS FIRST, c_login#427 ASC NULLS FIRST, c_email_address#428 ASC NULLS FIRST, c_last_review_date#429 ASC NULLS FIRST, ctr_total_return#16929 ASC NULLS FIRST], true
      +- Project [c_customer_id#413, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ctr_total_return#16929]
         +- Filter (((cast(ctr_total_return#16929 as decimal(24,7)) > cast(scalar-subquery#16926 [ctr_state#16928] as decimal(24,7))) && (ca_address_sk#448 = c_current_addr_sk#416)) && ((ca_state#456 = GA) && (ctr_customer_sk#16927 = c_customer_sk#412)))
            :  +- Aggregate [CheckOverflow((promote_precision(cast(avg(ctr_total_return#16929) as decimal(21,6))) * promote_precision(cast(1.2 as decimal(21,6)))), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#16932]
            :     +- Filter (outer(ctr_state#16928) = ctr_state#16928)
            :        +- SubqueryAlias `ctr2`
            :           +- SubqueryAlias `customer_total_return`
            :              +- Aggregate [wr_returning_customer_sk#291, ca_state#456], [wr_returning_customer_sk#291 AS ctr_customer_sk#16927, ca_state#456 AS ctr_state#16928, sum(wr_return_amt#299) AS ctr_total_return#16929]
            :                 +- Filter (((wr_returned_date_sk#284 = d_date_sk#492) && (d_year#498 = 2002)) && (wr_returning_addr_sk#294 = ca_address_sk#448))
            :                    +- Join Inner
            :                       :- Join Inner
            :                       :  :- SubqueryAlias `web_returns`
            :                       :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
            :                       :  +- SubqueryAlias `date_dim`
            :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :                       +- SubqueryAlias `customer_address`
            :                          +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ctr1`
               :  :  +- SubqueryAlias `customer_total_return`
               :  :     +- Aggregate [wr_returning_customer_sk#291, ca_state#456], [wr_returning_customer_sk#291 AS ctr_customer_sk#16927, ca_state#456 AS ctr_state#16928, sum(wr_return_amt#299) AS ctr_total_return#16929]
               :  :        +- Filter (((wr_returned_date_sk#284 = d_date_sk#492) && (d_year#498 = 2002)) && (wr_returning_addr_sk#294 = ca_address_sk#448))
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- SubqueryAlias `web_returns`
               :  :              :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               :  :              :  +- SubqueryAlias `date_dim`
               :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              +- SubqueryAlias `customer_address`
               :  :                 +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer_address`
               :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer`
                  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/09/08 18:22:27 INFO Query: 
== Query: q30-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_customer_id#413 ASC NULLS FIRST, c_salutation#419 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, c_last_name#421 ASC NULLS FIRST, c_preferred_cust_flag#422 ASC NULLS FIRST, c_birth_day#423 ASC NULLS FIRST, c_birth_month#424 ASC NULLS FIRST, c_birth_year#425 ASC NULLS FIRST, c_birth_country#426 ASC NULLS FIRST, c_login#427 ASC NULLS FIRST, c_email_address#428 ASC NULLS FIRST, c_last_review_date#429 ASC NULLS FIRST, ctr_total_return#16949 ASC NULLS FIRST], true
      +- Project [c_customer_id#413, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ctr_total_return#16949]
         +- Filter (((cast(ctr_total_return#16949 as decimal(24,7)) > cast(scalar-subquery#16946 [ctr_state#16948] as decimal(24,7))) && (ca_address_sk#448 = c_current_addr_sk#416)) && ((ca_state#456 = GA) && (ctr_customer_sk#16947 = c_customer_sk#412)))
            :  +- Aggregate [CheckOverflow((promote_precision(cast(avg(ctr_total_return#16949) as decimal(21,6))) * promote_precision(cast(1.2 as decimal(21,6)))), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#16952]
            :     +- Filter (outer(ctr_state#16948) = ctr_state#16948)
            :        +- SubqueryAlias `ctr2`
            :           +- SubqueryAlias `customer_total_return`
            :              +- Aggregate [wr_returning_customer_sk#291, ca_state#456], [wr_returning_customer_sk#291 AS ctr_customer_sk#16947, ca_state#456 AS ctr_state#16948, sum(wr_return_amt#299) AS ctr_total_return#16949]
            :                 +- Filter (((wr_returned_date_sk#284 = d_date_sk#492) && (d_year#498 = 2002)) && (wr_returning_addr_sk#294 = ca_address_sk#448))
            :                    +- Join Inner
            :                       :- Join Inner
            :                       :  :- SubqueryAlias `web_returns`
            :                       :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
            :                       :  +- SubqueryAlias `date_dim`
            :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :                       +- SubqueryAlias `customer_address`
            :                          +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ctr1`
               :  :  +- SubqueryAlias `customer_total_return`
               :  :     +- Aggregate [wr_returning_customer_sk#291, ca_state#456], [wr_returning_customer_sk#291 AS ctr_customer_sk#16947, ca_state#456 AS ctr_state#16948, sum(wr_return_amt#299) AS ctr_total_return#16949]
               :  :        +- Filter (((wr_returned_date_sk#284 = d_date_sk#492) && (d_year#498 = 2002)) && (wr_returning_addr_sk#294 = ca_address_sk#448))
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- SubqueryAlias `web_returns`
               :  :              :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               :  :              :  +- SubqueryAlias `date_dim`
               :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              +- SubqueryAlias `customer_address`
               :  :                 +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer_address`
               :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer`
                  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 5.085402472s
Running execution q31-v2.4 iteration: 1, StandardRun=true
19/09/08 18:22:34 INFO Query: 
== Query: q31-v2.4 ==
Sort [ca_county#455 ASC NULLS FIRST], true
+- Project [ca_county#455, d_year#498, CheckOverflow((promote_precision(cast(web_sales#17747 as decimal(17,2))) / promote_precision(cast(web_sales#17498 as decimal(17,2)))), DecimalType(37,20)) AS web_q1_q2_increase#17493, CheckOverflow((promote_precision(cast(store_sales#17501 as decimal(17,2))) / promote_precision(cast(store_sales#17497 as decimal(17,2)))), DecimalType(37,20)) AS store_q1_q2_increase#17494, CheckOverflow((promote_precision(cast(web_sales#17843 as decimal(17,2))) / promote_precision(cast(web_sales#17747 as decimal(17,2)))), DecimalType(37,20)) AS web_q2_q3_increase#17495, CheckOverflow((promote_precision(cast(store_sales#17597 as decimal(17,2))) / promote_precision(cast(store_sales#17501 as decimal(17,2)))), DecimalType(37,20)) AS store_q2_q3_increase#17496]
   +- Filter ((((((d_qoy#502 = 1) && (d_year#498 = 2000)) && (ca_county#455 = ca_county#17591)) && ((d_qoy#17553 = 2) && (d_year#17549 = 2000))) && ((((ca_county#17591 = ca_county#17687) && (d_qoy#17649 = 3)) && (d_year#17645 = 2000)) && ((ca_county#455 = ca_county#17741) && (d_qoy#17703 = 1)))) && (((((d_year#17699 = 2000) && (ca_county#17741 = ca_county#17837)) && (d_qoy#17799 = 2)) && ((d_year#17795 = 2000) && (ca_county#17741 = ca_county#17933))) && (((d_qoy#17895 = 3) && (d_year#17891 = 2000)) && ((CASE WHEN (cast(web_sales#17498 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(web_sales#17747 as decimal(17,2))) / promote_precision(cast(web_sales#17498 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END > CASE WHEN (cast(store_sales#17497 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(store_sales#17501 as decimal(17,2))) / promote_precision(cast(store_sales#17497 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END) && (CASE WHEN (cast(web_sales#17747 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(web_sales#17843 as decimal(17,2))) / promote_precision(cast(web_sales#17747 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END > CASE WHEN (cast(store_sales#17501 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(store_sales#17597 as decimal(17,2))) / promote_precision(cast(store_sales#17501 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END)))))
      +- Join Inner
         :- Join Inner
         :  :- Join Inner
         :  :  :- Join Inner
         :  :  :  :- Join Inner
         :  :  :  :  :- SubqueryAlias `ss1`
         :  :  :  :  :  +- SubqueryAlias `ss`
         :  :  :  :  :     +- Aggregate [ca_county#455, d_qoy#502, d_year#498], [ca_county#455, d_qoy#502, d_year#498, sum(ss_ext_sales_price#145) AS store_sales#17497]
         :  :  :  :  :        +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && (ss_addr_sk#136 = ca_address_sk#448))
         :  :  :  :  :           +- Join Inner
         :  :  :  :  :              :- Join Inner
         :  :  :  :  :              :  :- SubqueryAlias `store_sales`
         :  :  :  :  :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  :  :              :  +- SubqueryAlias `date_dim`
         :  :  :  :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :  :  :  :  :              +- SubqueryAlias `customer_address`
         :  :  :  :  :                 +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :  :  :  :  +- SubqueryAlias `ss2`
         :  :  :  :     +- SubqueryAlias `ss`
         :  :  :  :        +- Aggregate [ca_county#17591, d_qoy#17553, d_year#17549], [ca_county#17591, d_qoy#17553, d_year#17549, sum(ss_ext_sales_price#145) AS store_sales#17501]
         :  :  :  :           +- Filter ((ss_sold_date_sk#130 = d_date_sk#17543) && (ss_addr_sk#136 = ca_address_sk#17584))
         :  :  :  :              +- Join Inner
         :  :  :  :                 :- Join Inner
         :  :  :  :                 :  :- SubqueryAlias `store_sales`
         :  :  :  :                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  :                 :  +- SubqueryAlias `date_dim`
         :  :  :  :                 :     +- Relation[d_date_sk#17543,d_date_id#17544,d_date#17545,d_month_seq#17546,d_week_seq#17547,d_quarter_seq#17548,d_year#17549,d_dow#17550,d_moy#17551,d_dom#17552,d_qoy#17553,d_fy_year#17554,d_fy_quarter_seq#17555,d_fy_week_seq#17556,d_day_name#17557,d_quarter_name#17558,d_holiday#17559,d_weekend#17560,d_following_holiday#17561,d_first_dom#17562,d_last_dom#17563,d_same_day_ly#17564,d_same_day_lq#17565,d_current_day#17566,... 4 more fields] parquet
         :  :  :  :                 +- SubqueryAlias `customer_address`
         :  :  :  :                    +- Relation[ca_address_sk#17584,ca_address_id#17585,ca_street_number#17586,ca_street_name#17587,ca_street_type#17588,ca_suite_number#17589,ca_city#17590,ca_county#17591,ca_state#17592,ca_zip#17593,ca_country#17594,ca_gmt_offset#17595,ca_location_type#17596] parquet
         :  :  :  +- SubqueryAlias `ss3`
         :  :  :     +- SubqueryAlias `ss`
         :  :  :        +- Aggregate [ca_county#17687, d_qoy#17649, d_year#17645], [ca_county#17687, d_qoy#17649, d_year#17645, sum(ss_ext_sales_price#145) AS store_sales#17597]
         :  :  :           +- Filter ((ss_sold_date_sk#130 = d_date_sk#17639) && (ss_addr_sk#136 = ca_address_sk#17680))
         :  :  :              +- Join Inner
         :  :  :                 :- Join Inner
         :  :  :                 :  :- SubqueryAlias `store_sales`
         :  :  :                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :                 :  +- SubqueryAlias `date_dim`
         :  :  :                 :     +- Relation[d_date_sk#17639,d_date_id#17640,d_date#17641,d_month_seq#17642,d_week_seq#17643,d_quarter_seq#17644,d_year#17645,d_dow#17646,d_moy#17647,d_dom#17648,d_qoy#17649,d_fy_year#17650,d_fy_quarter_seq#17651,d_fy_week_seq#17652,d_day_name#17653,d_quarter_name#17654,d_holiday#17655,d_weekend#17656,d_following_holiday#17657,d_first_dom#17658,d_last_dom#17659,d_same_day_ly#17660,d_same_day_lq#17661,d_current_day#17662,... 4 more fields] parquet
         :  :  :                 +- SubqueryAlias `customer_address`
         :  :  :                    +- Relation[ca_address_sk#17680,ca_address_id#17681,ca_street_number#17682,ca_street_name#17683,ca_street_type#17684,ca_suite_number#17685,ca_city#17686,ca_county#17687,ca_state#17688,ca_zip#17689,ca_country#17690,ca_gmt_offset#17691,ca_location_type#17692] parquet
         :  :  +- SubqueryAlias `ws1`
         :  :     +- SubqueryAlias `ws`
         :  :        +- Aggregate [ca_county#17741, d_qoy#17703, d_year#17699], [ca_county#17741, d_qoy#17703, d_year#17699, sum(ws_ext_sales_price#239) AS web_sales#17498]
         :  :           +- Filter ((ws_sold_date_sk#216 = d_date_sk#17693) && (ws_bill_addr_sk#223 = ca_address_sk#17734))
         :  :              +- Join Inner
         :  :                 :- Join Inner
         :  :                 :  :- SubqueryAlias `web_sales`
         :  :                 :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
         :  :                 :  +- SubqueryAlias `date_dim`
         :  :                 :     +- Relation[d_date_sk#17693,d_date_id#17694,d_date#17695,d_month_seq#17696,d_week_seq#17697,d_quarter_seq#17698,d_year#17699,d_dow#17700,d_moy#17701,d_dom#17702,d_qoy#17703,d_fy_year#17704,d_fy_quarter_seq#17705,d_fy_week_seq#17706,d_day_name#17707,d_quarter_name#17708,d_holiday#17709,d_weekend#17710,d_following_holiday#17711,d_first_dom#17712,d_last_dom#17713,d_same_day_ly#17714,d_same_day_lq#17715,d_current_day#17716,... 4 more fields] parquet
         :  :                 +- SubqueryAlias `customer_address`
         :  :                    +- Relation[ca_address_sk#17734,ca_address_id#17735,ca_street_number#17736,ca_street_name#17737,ca_street_type#17738,ca_suite_number#17739,ca_city#17740,ca_county#17741,ca_state#17742,ca_zip#17743,ca_country#17744,ca_gmt_offset#17745,ca_location_type#17746] parquet
         :  +- SubqueryAlias `ws2`
         :     +- SubqueryAlias `ws`
         :        +- Aggregate [ca_county#17837, d_qoy#17799, d_year#17795], [ca_county#17837, d_qoy#17799, d_year#17795, sum(ws_ext_sales_price#239) AS web_sales#17747]
         :           +- Filter ((ws_sold_date_sk#216 = d_date_sk#17789) && (ws_bill_addr_sk#223 = ca_address_sk#17830))
         :              +- Join Inner
         :                 :- Join Inner
         :                 :  :- SubqueryAlias `web_sales`
         :                 :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
         :                 :  +- SubqueryAlias `date_dim`
         :                 :     +- Relation[d_date_sk#17789,d_date_id#17790,d_date#17791,d_month_seq#17792,d_week_seq#17793,d_quarter_seq#17794,d_year#17795,d_dow#17796,d_moy#17797,d_dom#17798,d_qoy#17799,d_fy_year#17800,d_fy_quarter_seq#17801,d_fy_week_seq#17802,d_day_name#17803,d_quarter_name#17804,d_holiday#17805,d_weekend#17806,d_following_holiday#17807,d_first_dom#17808,d_last_dom#17809,d_same_day_ly#17810,d_same_day_lq#17811,d_current_day#17812,... 4 more fields] parquet
         :                 +- SubqueryAlias `customer_address`
         :                    +- Relation[ca_address_sk#17830,ca_address_id#17831,ca_street_number#17832,ca_street_name#17833,ca_street_type#17834,ca_suite_number#17835,ca_city#17836,ca_county#17837,ca_state#17838,ca_zip#17839,ca_country#17840,ca_gmt_offset#17841,ca_location_type#17842] parquet
         +- SubqueryAlias `ws3`
            +- SubqueryAlias `ws`
               +- Aggregate [ca_county#17933, d_qoy#17895, d_year#17891], [ca_county#17933, d_qoy#17895, d_year#17891, sum(ws_ext_sales_price#239) AS web_sales#17843]
                  +- Filter ((ws_sold_date_sk#216 = d_date_sk#17885) && (ws_bill_addr_sk#223 = ca_address_sk#17926))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `web_sales`
                        :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  +- SubqueryAlias `date_dim`
                        :     +- Relation[d_date_sk#17885,d_date_id#17886,d_date#17887,d_month_seq#17888,d_week_seq#17889,d_quarter_seq#17890,d_year#17891,d_dow#17892,d_moy#17893,d_dom#17894,d_qoy#17895,d_fy_year#17896,d_fy_quarter_seq#17897,d_fy_week_seq#17898,d_day_name#17899,d_quarter_name#17900,d_holiday#17901,d_weekend#17902,d_following_holiday#17903,d_first_dom#17904,d_last_dom#17905,d_same_day_ly#17906,d_same_day_lq#17907,d_current_day#17908,... 4 more fields] parquet
                        +- SubqueryAlias `customer_address`
                           +- Relation[ca_address_sk#17926,ca_address_id#17927,ca_street_number#17928,ca_street_name#17929,ca_street_type#17930,ca_suite_number#17931,ca_city#17932,ca_county#17933,ca_state#17934,ca_zip#17935,ca_country#17936,ca_gmt_offset#17937,ca_location_type#17938] parquet

     : benchmark
19/09/08 18:22:34 INFO Query: 
== Query: q31-v2.4 ==
Sort [ca_county#455 ASC NULLS FIRST], true
+- Project [ca_county#455, d_year#498, CheckOverflow((promote_precision(cast(web_sales#18199 as decimal(17,2))) / promote_precision(cast(web_sales#17950 as decimal(17,2)))), DecimalType(37,20)) AS web_q1_q2_increase#17945, CheckOverflow((promote_precision(cast(store_sales#17953 as decimal(17,2))) / promote_precision(cast(store_sales#17949 as decimal(17,2)))), DecimalType(37,20)) AS store_q1_q2_increase#17946, CheckOverflow((promote_precision(cast(web_sales#18295 as decimal(17,2))) / promote_precision(cast(web_sales#18199 as decimal(17,2)))), DecimalType(37,20)) AS web_q2_q3_increase#17947, CheckOverflow((promote_precision(cast(store_sales#18049 as decimal(17,2))) / promote_precision(cast(store_sales#17953 as decimal(17,2)))), DecimalType(37,20)) AS store_q2_q3_increase#17948]
   +- Filter ((((((d_qoy#502 = 1) && (d_year#498 = 2000)) && (ca_county#455 = ca_county#18043)) && ((d_qoy#18005 = 2) && (d_year#18001 = 2000))) && ((((ca_county#18043 = ca_county#18139) && (d_qoy#18101 = 3)) && (d_year#18097 = 2000)) && ((ca_county#455 = ca_county#18193) && (d_qoy#18155 = 1)))) && (((((d_year#18151 = 2000) && (ca_county#18193 = ca_county#18289)) && (d_qoy#18251 = 2)) && ((d_year#18247 = 2000) && (ca_county#18193 = ca_county#18385))) && (((d_qoy#18347 = 3) && (d_year#18343 = 2000)) && ((CASE WHEN (cast(web_sales#17950 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(web_sales#18199 as decimal(17,2))) / promote_precision(cast(web_sales#17950 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END > CASE WHEN (cast(store_sales#17949 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(store_sales#17953 as decimal(17,2))) / promote_precision(cast(store_sales#17949 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END) && (CASE WHEN (cast(web_sales#18199 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(web_sales#18295 as decimal(17,2))) / promote_precision(cast(web_sales#18199 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END > CASE WHEN (cast(store_sales#17953 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(store_sales#18049 as decimal(17,2))) / promote_precision(cast(store_sales#17953 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END)))))
      +- Join Inner
         :- Join Inner
         :  :- Join Inner
         :  :  :- Join Inner
         :  :  :  :- Join Inner
         :  :  :  :  :- SubqueryAlias `ss1`
         :  :  :  :  :  +- SubqueryAlias `ss`
         :  :  :  :  :     +- Aggregate [ca_county#455, d_qoy#502, d_year#498], [ca_county#455, d_qoy#502, d_year#498, sum(ss_ext_sales_price#145) AS store_sales#17949]
         :  :  :  :  :        +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && (ss_addr_sk#136 = ca_address_sk#448))
         :  :  :  :  :           +- Join Inner
         :  :  :  :  :              :- Join Inner
         :  :  :  :  :              :  :- SubqueryAlias `store_sales`
         :  :  :  :  :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  :  :              :  +- SubqueryAlias `date_dim`
         :  :  :  :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :  :  :  :  :              +- SubqueryAlias `customer_address`
         :  :  :  :  :                 +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :  :  :  :  +- SubqueryAlias `ss2`
         :  :  :  :     +- SubqueryAlias `ss`
         :  :  :  :        +- Aggregate [ca_county#18043, d_qoy#18005, d_year#18001], [ca_county#18043, d_qoy#18005, d_year#18001, sum(ss_ext_sales_price#145) AS store_sales#17953]
         :  :  :  :           +- Filter ((ss_sold_date_sk#130 = d_date_sk#17995) && (ss_addr_sk#136 = ca_address_sk#18036))
         :  :  :  :              +- Join Inner
         :  :  :  :                 :- Join Inner
         :  :  :  :                 :  :- SubqueryAlias `store_sales`
         :  :  :  :                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  :                 :  +- SubqueryAlias `date_dim`
         :  :  :  :                 :     +- Relation[d_date_sk#17995,d_date_id#17996,d_date#17997,d_month_seq#17998,d_week_seq#17999,d_quarter_seq#18000,d_year#18001,d_dow#18002,d_moy#18003,d_dom#18004,d_qoy#18005,d_fy_year#18006,d_fy_quarter_seq#18007,d_fy_week_seq#18008,d_day_name#18009,d_quarter_name#18010,d_holiday#18011,d_weekend#18012,d_following_holiday#18013,d_first_dom#18014,d_last_dom#18015,d_same_day_ly#18016,d_same_day_lq#18017,d_current_day#18018,... 4 more fields] parquet
         :  :  :  :                 +- SubqueryAlias `customer_address`
         :  :  :  :                    +- Relation[ca_address_sk#18036,ca_address_id#18037,ca_street_number#18038,ca_street_name#18039,ca_street_type#18040,ca_suite_number#18041,ca_city#18042,ca_county#18043,ca_state#18044,ca_zip#18045,ca_country#18046,ca_gmt_offset#18047,ca_location_type#18048] parquet
         :  :  :  +- SubqueryAlias `ss3`
         :  :  :     +- SubqueryAlias `ss`
         :  :  :        +- Aggregate [ca_county#18139, d_qoy#18101, d_year#18097], [ca_county#18139, d_qoy#18101, d_year#18097, sum(ss_ext_sales_price#145) AS store_sales#18049]
         :  :  :           +- Filter ((ss_sold_date_sk#130 = d_date_sk#18091) && (ss_addr_sk#136 = ca_address_sk#18132))
         :  :  :              +- Join Inner
         :  :  :                 :- Join Inner
         :  :  :                 :  :- SubqueryAlias `store_sales`
         :  :  :                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :                 :  +- SubqueryAlias `date_dim`
         :  :  :                 :     +- Relation[d_date_sk#18091,d_date_id#18092,d_date#18093,d_month_seq#18094,d_week_seq#18095,d_quarter_seq#18096,d_year#18097,d_dow#18098,d_moy#18099,d_dom#18100,d_qoy#18101,d_fy_year#18102,d_fy_quarter_seq#18103,d_fy_week_seq#18104,d_day_name#18105,d_quarter_name#18106,d_holiday#18107,d_weekend#18108,d_following_holiday#18109,d_first_dom#18110,d_last_dom#18111,d_same_day_ly#18112,d_same_day_lq#18113,d_current_day#18114,... 4 more fields] parquet
         :  :  :                 +- SubqueryAlias `customer_address`
         :  :  :                    +- Relation[ca_address_sk#18132,ca_address_id#18133,ca_street_number#18134,ca_street_name#18135,ca_street_type#18136,ca_suite_number#18137,ca_city#18138,ca_county#18139,ca_state#18140,ca_zip#18141,ca_country#18142,ca_gmt_offset#18143,ca_location_type#18144] parquet
         :  :  +- SubqueryAlias `ws1`
         :  :     +- SubqueryAlias `ws`
         :  :        +- Aggregate [ca_county#18193, d_qoy#18155, d_year#18151], [ca_county#18193, d_qoy#18155, d_year#18151, sum(ws_ext_sales_price#239) AS web_sales#17950]
         :  :           +- Filter ((ws_sold_date_sk#216 = d_date_sk#18145) && (ws_bill_addr_sk#223 = ca_address_sk#18186))
         :  :              +- Join Inner
         :  :                 :- Join Inner
         :  :                 :  :- SubqueryAlias `web_sales`
         :  :                 :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
         :  :                 :  +- SubqueryAlias `date_dim`
         :  :                 :     +- Relation[d_date_sk#18145,d_date_id#18146,d_date#18147,d_month_seq#18148,d_week_seq#18149,d_quarter_seq#18150,d_year#18151,d_dow#18152,d_moy#18153,d_dom#18154,d_qoy#18155,d_fy_year#18156,d_fy_quarter_seq#18157,d_fy_week_seq#18158,d_day_name#18159,d_quarter_name#18160,d_holiday#18161,d_weekend#18162,d_following_holiday#18163,d_first_dom#18164,d_last_dom#18165,d_same_day_ly#18166,d_same_day_lq#18167,d_current_day#18168,... 4 more fields] parquet
         :  :                 +- SubqueryAlias `customer_address`
         :  :                    +- Relation[ca_address_sk#18186,ca_address_id#18187,ca_street_number#18188,ca_street_name#18189,ca_street_type#18190,ca_suite_number#18191,ca_city#18192,ca_county#18193,ca_state#18194,ca_zip#18195,ca_country#18196,ca_gmt_offset#18197,ca_location_type#18198] parquet
         :  +- SubqueryAlias `ws2`
         :     +- SubqueryAlias `ws`
         :        +- Aggregate [ca_county#18289, d_qoy#18251, d_year#18247], [ca_county#18289, d_qoy#18251, d_year#18247, sum(ws_ext_sales_price#239) AS web_sales#18199]
         :           +- Filter ((ws_sold_date_sk#216 = d_date_sk#18241) && (ws_bill_addr_sk#223 = ca_address_sk#18282))
         :              +- Join Inner
         :                 :- Join Inner
         :                 :  :- SubqueryAlias `web_sales`
         :                 :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
         :                 :  +- SubqueryAlias `date_dim`
         :                 :     +- Relation[d_date_sk#18241,d_date_id#18242,d_date#18243,d_month_seq#18244,d_week_seq#18245,d_quarter_seq#18246,d_year#18247,d_dow#18248,d_moy#18249,d_dom#18250,d_qoy#18251,d_fy_year#18252,d_fy_quarter_seq#18253,d_fy_week_seq#18254,d_day_name#18255,d_quarter_name#18256,d_holiday#18257,d_weekend#18258,d_following_holiday#18259,d_first_dom#18260,d_last_dom#18261,d_same_day_ly#18262,d_same_day_lq#18263,d_current_day#18264,... 4 more fields] parquet
         :                 +- SubqueryAlias `customer_address`
         :                    +- Relation[ca_address_sk#18282,ca_address_id#18283,ca_street_number#18284,ca_street_name#18285,ca_street_type#18286,ca_suite_number#18287,ca_city#18288,ca_county#18289,ca_state#18290,ca_zip#18291,ca_country#18292,ca_gmt_offset#18293,ca_location_type#18294] parquet
         +- SubqueryAlias `ws3`
            +- SubqueryAlias `ws`
               +- Aggregate [ca_county#18385, d_qoy#18347, d_year#18343], [ca_county#18385, d_qoy#18347, d_year#18343, sum(ws_ext_sales_price#239) AS web_sales#18295]
                  +- Filter ((ws_sold_date_sk#216 = d_date_sk#18337) && (ws_bill_addr_sk#223 = ca_address_sk#18378))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `web_sales`
                        :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  +- SubqueryAlias `date_dim`
                        :     +- Relation[d_date_sk#18337,d_date_id#18338,d_date#18339,d_month_seq#18340,d_week_seq#18341,d_quarter_seq#18342,d_year#18343,d_dow#18344,d_moy#18345,d_dom#18346,d_qoy#18347,d_fy_year#18348,d_fy_quarter_seq#18349,d_fy_week_seq#18350,d_day_name#18351,d_quarter_name#18352,d_holiday#18353,d_weekend#18354,d_following_holiday#18355,d_first_dom#18356,d_last_dom#18357,d_same_day_ly#18358,d_same_day_lq#18359,d_current_day#18360,... 4 more fields] parquet
                        +- SubqueryAlias `customer_address`
                           +- Relation[ca_address_sk#18378,ca_address_id#18379,ca_street_number#18380,ca_street_name#18381,ca_street_type#18382,ca_suite_number#18383,ca_city#18384,ca_county#18385,ca_state#18386,ca_zip#18387,ca_country#18388,ca_gmt_offset#18389,ca_location_type#18390] parquet

      running Thread[benchmark runner,5,main]
Execution time: 10.588824345999999s
Running execution q32-v2.4 iteration: 1, StandardRun=true
19/09/08 18:22:47 INFO Query: 
== Query: q32-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [sum(cs_ext_discount_amt#22) AS excess discount amount#19338]
      +- Filter ((((i_manufact_id#577 = 977) && (i_item_sk#564 = cs_item_sk#15)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && ((d_date_sk#492 = cs_sold_date_sk#0) && (cast(cs_ext_discount_amt#22 as decimal(14,7)) > cast(scalar-subquery#19339 [i_item_sk#564] as decimal(14,7)))))
         :  +- Aggregate [CheckOverflow((promote_precision(cast(1.3 as decimal(11,6))) * promote_precision(cast(avg(cs_ext_discount_amt#22) as decimal(11,6)))), DecimalType(14,7)) AS (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(cs_ext_discount_amt) AS DECIMAL(11,6)))#19341]
         :     +- Filter (((cs_item_sk#15 = outer(i_item_sk#564)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && (d_date_sk#492 = cs_sold_date_sk#0))
         :        +- Join Inner
         :           :- SubqueryAlias `catalog_sales`
         :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :           +- SubqueryAlias `date_dim`
         :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- Join Inner
            :- Join Inner
            :  :- SubqueryAlias `catalog_sales`
            :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :  +- SubqueryAlias `item`
            :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            +- SubqueryAlias `date_dim`
               +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:22:47 INFO Query: 
== Query: q32-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [sum(cs_ext_discount_amt#22) AS excess discount amount#19344]
      +- Filter ((((i_manufact_id#577 = 977) && (i_item_sk#564 = cs_item_sk#15)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && ((d_date_sk#492 = cs_sold_date_sk#0) && (cast(cs_ext_discount_amt#22 as decimal(14,7)) > cast(scalar-subquery#19345 [i_item_sk#564] as decimal(14,7)))))
         :  +- Aggregate [CheckOverflow((promote_precision(cast(1.3 as decimal(11,6))) * promote_precision(cast(avg(cs_ext_discount_amt#22) as decimal(11,6)))), DecimalType(14,7)) AS (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(cs_ext_discount_amt) AS DECIMAL(11,6)))#19347]
         :     +- Filter (((cs_item_sk#15 = outer(i_item_sk#564)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && (d_date_sk#492 = cs_sold_date_sk#0))
         :        +- Join Inner
         :           :- SubqueryAlias `catalog_sales`
         :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :           +- SubqueryAlias `date_dim`
         :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- Join Inner
            :- Join Inner
            :  :- SubqueryAlias `catalog_sales`
            :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :  +- SubqueryAlias `item`
            :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            +- SubqueryAlias `date_dim`
               +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 3.300057555s
Running execution q33-v2.4 iteration: 1, StandardRun=true
19/09/08 18:22:52 INFO Query: 
== Query: q33-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [total_sales#19398 ASC NULLS FIRST], true
      +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(total_sales#19399) AS total_sales#19398]
         +- SubqueryAlias `tmp1`
            +- Union
               :- Union
               :  :- Project [i_manufact_id#577, total_sales#19399]
               :  :  +- SubqueryAlias `ss`
               :  :     +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(ss_ext_sales_price#145) AS total_sales#19399]
               :  :        +- Filter (((i_manufact_id#577 IN (list#19400 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 5) && (ss_addr_sk#136 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :  :           :  +- Project [i_manufact_id#577]
               :  :           :     +- Filter i_category#576 IN (Electronics)
               :  :           :        +- SubqueryAlias `item`
               :  :           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- Join Inner
               :  :              :  :  :- SubqueryAlias `store_sales`
               :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :              :  :  +- SubqueryAlias `date_dim`
               :  :              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              :  +- SubqueryAlias `customer_address`
               :  :              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  :              +- SubqueryAlias `item`
               :  :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- Project [i_manufact_id#577, total_sales#19401]
               :     +- SubqueryAlias `cs`
               :        +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(cs_ext_sales_price#23) AS total_sales#19401]
               :           +- Filter (((i_manufact_id#577 IN (list#19402 []) && (cs_item_sk#15 = i_item_sk#564)) && ((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 5) && (cs_bill_addr_sk#6 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :              :  +- Project [i_manufact_id#577]
               :              :     +- Filter i_category#576 IN (Electronics)
               :              :        +- SubqueryAlias `item`
               :              :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- Join Inner
               :                 :  :  :- SubqueryAlias `catalog_sales`
               :                 :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :  :  +- SubqueryAlias `date_dim`
               :                 :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :  +- SubqueryAlias `customer_address`
               :                 :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :                 +- SubqueryAlias `item`
               :                    +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Project [i_manufact_id#577, total_sales#19403]
                  +- SubqueryAlias `ws`
                     +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(ws_ext_sales_price#239) AS total_sales#19403]
                        +- Filter (((i_manufact_id#577 IN (list#19404 []) && (ws_item_sk#219 = i_item_sk#564)) && ((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 5) && (ws_bill_addr_sk#223 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
                           :  +- Project [i_manufact_id#577]
                           :     +- Filter i_category#576 IN (Electronics)
                           :        +- SubqueryAlias `item`
                           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `web_sales`
                              :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :  +- SubqueryAlias `date_dim`
                              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `customer_address`
                              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:22:52 INFO Query: 
== Query: q33-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [total_sales#19412 ASC NULLS FIRST], true
      +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(total_sales#19413) AS total_sales#19412]
         +- SubqueryAlias `tmp1`
            +- Union
               :- Union
               :  :- Project [i_manufact_id#577, total_sales#19413]
               :  :  +- SubqueryAlias `ss`
               :  :     +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(ss_ext_sales_price#145) AS total_sales#19413]
               :  :        +- Filter (((i_manufact_id#577 IN (list#19414 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 5) && (ss_addr_sk#136 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :  :           :  +- Project [i_manufact_id#577]
               :  :           :     +- Filter i_category#576 IN (Electronics)
               :  :           :        +- SubqueryAlias `item`
               :  :           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- Join Inner
               :  :              :  :  :- SubqueryAlias `store_sales`
               :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :              :  :  +- SubqueryAlias `date_dim`
               :  :              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              :  +- SubqueryAlias `customer_address`
               :  :              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  :              +- SubqueryAlias `item`
               :  :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- Project [i_manufact_id#577, total_sales#19415]
               :     +- SubqueryAlias `cs`
               :        +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(cs_ext_sales_price#23) AS total_sales#19415]
               :           +- Filter (((i_manufact_id#577 IN (list#19416 []) && (cs_item_sk#15 = i_item_sk#564)) && ((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 5) && (cs_bill_addr_sk#6 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :              :  +- Project [i_manufact_id#577]
               :              :     +- Filter i_category#576 IN (Electronics)
               :              :        +- SubqueryAlias `item`
               :              :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- Join Inner
               :                 :  :  :- SubqueryAlias `catalog_sales`
               :                 :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :  :  +- SubqueryAlias `date_dim`
               :                 :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :  +- SubqueryAlias `customer_address`
               :                 :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :                 +- SubqueryAlias `item`
               :                    +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Project [i_manufact_id#577, total_sales#19417]
                  +- SubqueryAlias `ws`
                     +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(ws_ext_sales_price#239) AS total_sales#19417]
                        +- Filter (((i_manufact_id#577 IN (list#19418 []) && (ws_item_sk#219 = i_item_sk#564)) && ((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 5) && (ws_bill_addr_sk#223 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
                           :  +- Project [i_manufact_id#577]
                           :     +- Filter i_category#576 IN (Electronics)
                           :        +- SubqueryAlias `item`
                           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `web_sales`
                              :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :  +- SubqueryAlias `date_dim`
                              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `customer_address`
                              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 5.84359302s
Running execution q34-v2.4 iteration: 1, StandardRun=true
19/09/08 18:23:00 INFO Query: 
== Query: q34-v2.4 ==
Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, c_salutation#419 ASC NULLS FIRST, c_preferred_cust_flag#422 DESC NULLS LAST, ss_ticket_number#139L ASC NULLS FIRST], true
+- Project [c_last_name#421, c_first_name#420, c_salutation#419, c_preferred_cust_flag#422, ss_ticket_number#139L, cnt#19479L]
   +- Filter ((ss_customer_sk#133 = c_customer_sk#412) && ((cnt#19479L >= cast(15 as bigint)) && (cnt#19479L <= cast(20 as bigint))))
      +- Join Inner
         :- SubqueryAlias `dn`
         :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133], [ss_ticket_number#139L, ss_customer_sk#133, count(1) AS cnt#19479L]
         :     +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((((d_dom#501 >= 1) && (d_dom#501 <= 3)) || ((d_dom#501 >= 25) && (d_dom#501 <= 28))) && ((hd_buy_potential#550 = >10000) || (hd_buy_potential#550 = unknown)))) && (((hd_vehicle_count#552 > 0) && (CASE WHEN (hd_vehicle_count#552 > 0) THEN (cast(hd_dep_count#551 as double) / cast(hd_vehicle_count#552 as double)) ELSE cast(null as double) END > cast(1.2 as double))) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_county#687 IN (Williamson County,Williamson County,Williamson County,Williamson County,Williamson County,Williamson County,Williamson County,Williamson County))))
         :        +- Join Inner
         :           :- Join Inner
         :           :  :- Join Inner
         :           :  :  :- SubqueryAlias `store_sales`
         :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :           :  :  +- SubqueryAlias `date_dim`
         :           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :           :  +- SubqueryAlias `store`
         :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :           +- SubqueryAlias `household_demographics`
         :              +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         +- SubqueryAlias `customer`
            +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/09/08 18:23:00 INFO Query: 
== Query: q34-v2.4 ==
Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, c_salutation#419 ASC NULLS FIRST, c_preferred_cust_flag#422 DESC NULLS LAST, ss_ticket_number#139L ASC NULLS FIRST], true
+- Project [c_last_name#421, c_first_name#420, c_salutation#419, c_preferred_cust_flag#422, ss_ticket_number#139L, cnt#19487L]
   +- Filter ((ss_customer_sk#133 = c_customer_sk#412) && ((cnt#19487L >= cast(15 as bigint)) && (cnt#19487L <= cast(20 as bigint))))
      +- Join Inner
         :- SubqueryAlias `dn`
         :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133], [ss_ticket_number#139L, ss_customer_sk#133, count(1) AS cnt#19487L]
         :     +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((((d_dom#501 >= 1) && (d_dom#501 <= 3)) || ((d_dom#501 >= 25) && (d_dom#501 <= 28))) && ((hd_buy_potential#550 = >10000) || (hd_buy_potential#550 = unknown)))) && (((hd_vehicle_count#552 > 0) && (CASE WHEN (hd_vehicle_count#552 > 0) THEN (cast(hd_dep_count#551 as double) / cast(hd_vehicle_count#552 as double)) ELSE cast(null as double) END > cast(1.2 as double))) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_county#687 IN (Williamson County,Williamson County,Williamson County,Williamson County,Williamson County,Williamson County,Williamson County,Williamson County))))
         :        +- Join Inner
         :           :- Join Inner
         :           :  :- Join Inner
         :           :  :  :- SubqueryAlias `store_sales`
         :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :           :  :  +- SubqueryAlias `date_dim`
         :           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :           :  +- SubqueryAlias `store`
         :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :           +- SubqueryAlias `household_demographics`
         :              +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         +- SubqueryAlias `customer`
            +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 3.332361288s
Running execution q35-v2.4 iteration: 1, StandardRun=true
19/09/08 18:23:04 INFO Query: 
== Query: q35-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ca_state#456, cd_gender#475, cd_marital_status#476, cd_dep_count#480, cnt1#19593L, min(cd_dep_count)#19611, max(cd_dep_count)#19612, avg(cd_dep_count)#19613, cd_dep_employed_count#481, cnt2#19594L, min(cd_dep_employed_count)#19614, max(cd_dep_employed_count)#19615, avg(cd_dep_employed_count)#19616, cd_dep_college_count#482, cnt3#19595L, min(cd_dep_college_count)#19617, max(cd_dep_college_count)#19618, avg(cd_dep_college_count)#19619]
      +- Sort [ca_state#456 ASC NULLS FIRST, cd_gender#475 ASC NULLS FIRST, cd_marital_status#476 ASC NULLS FIRST, cd_dep_count#480 ASC NULLS FIRST, cd_dep_employed_count#481 ASC NULLS FIRST, cd_dep_college_count#482 ASC NULLS FIRST], true
         +- Aggregate [ca_state#456, cd_gender#475, cd_marital_status#476, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482], [ca_state#456, cd_gender#475, cd_marital_status#476, cd_dep_count#480, count(1) AS cnt1#19593L, min(cd_dep_count#480) AS min(cd_dep_count)#19611, max(cd_dep_count#480) AS max(cd_dep_count)#19612, avg(cast(cd_dep_count#480 as bigint)) AS avg(cd_dep_count)#19613, cd_dep_employed_count#481, count(1) AS cnt2#19594L, min(cd_dep_employed_count#481) AS min(cd_dep_employed_count)#19614, max(cd_dep_employed_count#481) AS max(cd_dep_employed_count)#19615, avg(cast(cd_dep_employed_count#481 as bigint)) AS avg(cd_dep_employed_count)#19616, cd_dep_college_count#482, count(1) AS cnt3#19595L, min(cd_dep_college_count#482) AS min(cd_dep_college_count)#19617, max(cd_dep_college_count#482) AS max(cd_dep_college_count)#19618, avg(cast(cd_dep_college_count#482 as bigint)) AS avg(cd_dep_college_count)#19619]
            +- Filter (((c_current_addr_sk#416 = ca_address_sk#448) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && (exists#19596 [c_customer_sk#412] && (exists#19597 [c_customer_sk#412] || exists#19598 [c_customer_sk#412])))
               :  :- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 27 more fields]
               :  :  +- Filter (((outer(c_customer_sk#412) = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = 2002) && (d_qoy#502 < 4)))
               :  :     +- Join Inner
               :  :        :- SubqueryAlias `store_sales`
               :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :        +- SubqueryAlias `date_dim`
               :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 38 more fields]
               :  :  +- Filter (((outer(c_customer_sk#412) = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = 2002) && (d_qoy#502 < 4)))
               :  :     +- Join Inner
               :  :        :- SubqueryAlias `web_sales`
               :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :        +- SubqueryAlias `date_dim`
               :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 38 more fields]
               :     +- Filter (((outer(c_customer_sk#412) = cs_ship_customer_sk#7) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = 2002) && (d_qoy#502 < 4)))
               :        +- Join Inner
               :           :- SubqueryAlias `catalog_sales`
               :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :           +- SubqueryAlias `date_dim`
               :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- SubqueryAlias `c`
                  :  :  +- SubqueryAlias `customer`
                  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  +- SubqueryAlias `ca`
                  :     +- SubqueryAlias `customer_address`
                  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `customer_demographics`
                     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet

     : benchmark
19/09/08 18:23:04 INFO Query: 
== Query: q35-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ca_state#456, cd_gender#475, cd_marital_status#476, cd_dep_count#480, cnt1#19644L, min(cd_dep_count)#19662, max(cd_dep_count)#19663, avg(cd_dep_count)#19664, cd_dep_employed_count#481, cnt2#19645L, min(cd_dep_employed_count)#19665, max(cd_dep_employed_count)#19666, avg(cd_dep_employed_count)#19667, cd_dep_college_count#482, cnt3#19646L, min(cd_dep_college_count)#19668, max(cd_dep_college_count)#19669, avg(cd_dep_college_count)#19670]
      +- Sort [ca_state#456 ASC NULLS FIRST, cd_gender#475 ASC NULLS FIRST, cd_marital_status#476 ASC NULLS FIRST, cd_dep_count#480 ASC NULLS FIRST, cd_dep_employed_count#481 ASC NULLS FIRST, cd_dep_college_count#482 ASC NULLS FIRST], true
         +- Aggregate [ca_state#456, cd_gender#475, cd_marital_status#476, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482], [ca_state#456, cd_gender#475, cd_marital_status#476, cd_dep_count#480, count(1) AS cnt1#19644L, min(cd_dep_count#480) AS min(cd_dep_count)#19662, max(cd_dep_count#480) AS max(cd_dep_count)#19663, avg(cast(cd_dep_count#480 as bigint)) AS avg(cd_dep_count)#19664, cd_dep_employed_count#481, count(1) AS cnt2#19645L, min(cd_dep_employed_count#481) AS min(cd_dep_employed_count)#19665, max(cd_dep_employed_count#481) AS max(cd_dep_employed_count)#19666, avg(cast(cd_dep_employed_count#481 as bigint)) AS avg(cd_dep_employed_count)#19667, cd_dep_college_count#482, count(1) AS cnt3#19646L, min(cd_dep_college_count#482) AS min(cd_dep_college_count)#19668, max(cd_dep_college_count#482) AS max(cd_dep_college_count)#19669, avg(cast(cd_dep_college_count#482 as bigint)) AS avg(cd_dep_college_count)#19670]
            +- Filter (((c_current_addr_sk#416 = ca_address_sk#448) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && (exists#19647 [c_customer_sk#412] && (exists#19648 [c_customer_sk#412] || exists#19649 [c_customer_sk#412])))
               :  :- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 27 more fields]
               :  :  +- Filter (((outer(c_customer_sk#412) = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = 2002) && (d_qoy#502 < 4)))
               :  :     +- Join Inner
               :  :        :- SubqueryAlias `store_sales`
               :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :        +- SubqueryAlias `date_dim`
               :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 38 more fields]
               :  :  +- Filter (((outer(c_customer_sk#412) = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = 2002) && (d_qoy#502 < 4)))
               :  :     +- Join Inner
               :  :        :- SubqueryAlias `web_sales`
               :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :        +- SubqueryAlias `date_dim`
               :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 38 more fields]
               :     +- Filter (((outer(c_customer_sk#412) = cs_ship_customer_sk#7) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = 2002) && (d_qoy#502 < 4)))
               :        +- Join Inner
               :           :- SubqueryAlias `catalog_sales`
               :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :           +- SubqueryAlias `date_dim`
               :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- SubqueryAlias `c`
                  :  :  +- SubqueryAlias `customer`
                  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  +- SubqueryAlias `ca`
                  :     +- SubqueryAlias `customer_address`
                  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `customer_demographics`
                     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet

      running Thread[benchmark runner,5,main]
Execution time: 7.484134726000001s
Running execution q36-v2.4 iteration: 1, StandardRun=true
19/09/08 18:23:13 INFO Query: 
== Query: q36-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#19874 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#19874 as int) = 0) THEN i_category#19885 END ASC NULLS FIRST, rank_within_parent#19875 ASC NULLS FIRST], true
      +- Project [gross_margin#19873, i_category#19885, i_class#19886, lochierarchy#19874, rank_within_parent#19875]
         +- Project [gross_margin#19873, i_category#19885, i_class#19886, lochierarchy#19874, _w0#19895, _w1#19899, _w2#19900, _w3#19901, rank_within_parent#19875, rank_within_parent#19875]
            +- Window [rank(_w3#19901) windowspecdefinition(_w1#19899, _w2#19900, _w3#19901 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#19875], [_w1#19899, _w2#19900], [_w3#19901 ASC NULLS FIRST]
               +- Aggregate [i_category#19885, i_class#19886, spark_grouping_id#19882], [CheckOverflow((promote_precision(cast(sum(ss_net_profit#152) as decimal(17,2))) / promote_precision(cast(sum(ss_ext_sales_price#145) as decimal(17,2)))), DecimalType(37,20)) AS gross_margin#19873, i_category#19885, i_class#19886, (cast((shiftright(spark_grouping_id#19882, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#19882, 0) & 1) as tinyint)) AS lochierarchy#19874, CheckOverflow((promote_precision(cast(sum(ss_net_profit#152) as decimal(17,2))) / promote_precision(cast(sum(ss_ext_sales_price#145) as decimal(17,2)))), DecimalType(37,20)) AS _w0#19895, (cast((shiftright(spark_grouping_id#19882, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#19882, 0) & 1) as tinyint)) AS _w1#19899, CASE WHEN (cast(cast((shiftright(spark_grouping_id#19882, 0) & 1) as tinyint) as int) = 0) THEN i_category#19885 END AS _w2#19900, CheckOverflow((promote_precision(cast(sum(ss_net_profit#152) as decimal(17,2))) / promote_precision(cast(sum(ss_ext_sales_price#145) as decimal(17,2)))), DecimalType(37,20)) AS _w3#19901]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_category#19883, i_class#19884, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_category#19883, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 81 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 80 more fields]
                        +- Filter ((((d_year#498 = 2001) && (d_date_sk#492 = ss_sold_date_sk#130)) && (i_item_sk#564 = ss_item_sk#132)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (TN,TN,TN,TN,TN,TN,TN,TN)))
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `store_sales`
                              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  :  +- SubqueryAlias `d1`
                              :  :     +- SubqueryAlias `date_dim`
                              :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `item`
                              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/09/08 18:23:13 INFO Query: 
== Query: q36-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#19917 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#19917 as int) = 0) THEN i_category#19928 END ASC NULLS FIRST, rank_within_parent#19918 ASC NULLS FIRST], true
      +- Project [gross_margin#19916, i_category#19928, i_class#19929, lochierarchy#19917, rank_within_parent#19918]
         +- Project [gross_margin#19916, i_category#19928, i_class#19929, lochierarchy#19917, _w0#19938, _w1#19942, _w2#19943, _w3#19944, rank_within_parent#19918, rank_within_parent#19918]
            +- Window [rank(_w3#19944) windowspecdefinition(_w1#19942, _w2#19943, _w3#19944 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#19918], [_w1#19942, _w2#19943], [_w3#19944 ASC NULLS FIRST]
               +- Aggregate [i_category#19928, i_class#19929, spark_grouping_id#19925], [CheckOverflow((promote_precision(cast(sum(ss_net_profit#152) as decimal(17,2))) / promote_precision(cast(sum(ss_ext_sales_price#145) as decimal(17,2)))), DecimalType(37,20)) AS gross_margin#19916, i_category#19928, i_class#19929, (cast((shiftright(spark_grouping_id#19925, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#19925, 0) & 1) as tinyint)) AS lochierarchy#19917, CheckOverflow((promote_precision(cast(sum(ss_net_profit#152) as decimal(17,2))) / promote_precision(cast(sum(ss_ext_sales_price#145) as decimal(17,2)))), DecimalType(37,20)) AS _w0#19938, (cast((shiftright(spark_grouping_id#19925, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#19925, 0) & 1) as tinyint)) AS _w1#19942, CASE WHEN (cast(cast((shiftright(spark_grouping_id#19925, 0) & 1) as tinyint) as int) = 0) THEN i_category#19928 END AS _w2#19943, CheckOverflow((promote_precision(cast(sum(ss_net_profit#152) as decimal(17,2))) / promote_precision(cast(sum(ss_ext_sales_price#145) as decimal(17,2)))), DecimalType(37,20)) AS _w3#19944]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_category#19926, i_class#19927, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_category#19926, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 81 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 80 more fields]
                        +- Filter ((((d_year#498 = 2001) && (d_date_sk#492 = ss_sold_date_sk#130)) && (i_item_sk#564 = ss_item_sk#132)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (TN,TN,TN,TN,TN,TN,TN,TN)))
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `store_sales`
                              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  :  +- SubqueryAlias `d1`
                              :  :     +- SubqueryAlias `date_dim`
                              :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `item`
                              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 4.686186203999999s
Running execution q37-v2.4 iteration: 1, StandardRun=true
19/09/08 18:23:19 INFO Query: 
== Query: q37-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(68 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((68 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-02-01 as date)) && (d_date#494 <= cast(cast(cast(2000-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (677,940,694,808) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (cs_item_sk#15 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `catalog_sales`
                  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet

     : benchmark
19/09/08 18:23:19 INFO Query: 
== Query: q37-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(68 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((68 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-02-01 as date)) && (d_date#494 <= cast(cast(cast(2000-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (677,940,694,808) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (cs_item_sk#15 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `catalog_sales`
                  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 3.289432465s
Running execution q38-v2.4 iteration: 1, StandardRun=true
19/09/08 18:23:23 INFO Query: 
== Query: q38-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [count(1) AS count(1)#20328L]
      +- SubqueryAlias `hot_cust`
         +- Intersect false
            :- Project [c_last_name#421, c_first_name#420, d_date#494]
            :  +- Intersect false
            :     :- Project [c_last_name#421, c_first_name#420, d_date#494]
            :     :  +- Distinct
            :     :     +- Project [c_last_name#421, c_first_name#420, d_date#494]
            :     :        +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_customer_sk#133 = c_customer_sk#412)) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
            :     :           +- Join Inner
            :     :              :- Join Inner
            :     :              :  :- SubqueryAlias `store_sales`
            :     :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :              :  +- SubqueryAlias `date_dim`
            :     :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     :              +- SubqueryAlias `customer`
            :     :                 +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :     +- Project [c_last_name#20255, c_first_name#20254, d_date#20201]
            :        +- Distinct
            :           +- Project [c_last_name#20255, c_first_name#20254, d_date#20201]
            :              +- Filter (((cs_sold_date_sk#0 = d_date_sk#20199) && (cs_bill_customer_sk#3 = c_customer_sk#20246)) && ((d_month_seq#20202 >= 1200) && (d_month_seq#20202 <= (1200 + 11))))
            :                 +- Join Inner
            :                    :- Join Inner
            :                    :  :- SubqueryAlias `catalog_sales`
            :                    :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :                    :  +- SubqueryAlias `date_dim`
            :                    :     +- Relation[d_date_sk#20199,d_date_id#20200,d_date#20201,d_month_seq#20202,d_week_seq#20203,d_quarter_seq#20204,d_year#20205,d_dow#20206,d_moy#20207,d_dom#20208,d_qoy#20209,d_fy_year#20210,d_fy_quarter_seq#20211,d_fy_week_seq#20212,d_day_name#20213,d_quarter_name#20214,d_holiday#20215,d_weekend#20216,d_following_holiday#20217,d_first_dom#20218,d_last_dom#20219,d_same_day_ly#20220,d_same_day_lq#20221,d_current_day#20222,... 4 more fields] parquet
            :                    +- SubqueryAlias `customer`
            :                       +- Relation[c_customer_sk#20246,c_customer_id#20247,c_current_cdemo_sk#20248,c_current_hdemo_sk#20249,c_current_addr_sk#20250,c_first_shipto_date_sk#20251,c_first_sales_date_sk#20252,c_salutation#20253,c_first_name#20254,c_last_name#20255,c_preferred_cust_flag#20256,c_birth_day#20257,c_birth_month#20258,c_birth_year#20259,c_birth_country#20260,c_login#20261,c_email_address#20262,c_last_review_date#20263] parquet
            +- Project [c_last_name#20319, c_first_name#20318, d_date#20266]
               +- Distinct
                  +- Project [c_last_name#20319, c_first_name#20318, d_date#20266]
                     +- Filter (((ws_sold_date_sk#216 = d_date_sk#20264) && (ws_bill_customer_sk#220 = c_customer_sk#20310)) && ((d_month_seq#20267 >= 1200) && (d_month_seq#20267 <= (1200 + 11))))
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `web_sales`
                           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :  +- SubqueryAlias `date_dim`
                           :     +- Relation[d_date_sk#20264,d_date_id#20265,d_date#20266,d_month_seq#20267,d_week_seq#20268,d_quarter_seq#20269,d_year#20270,d_dow#20271,d_moy#20272,d_dom#20273,d_qoy#20274,d_fy_year#20275,d_fy_quarter_seq#20276,d_fy_week_seq#20277,d_day_name#20278,d_quarter_name#20279,d_holiday#20280,d_weekend#20281,d_following_holiday#20282,d_first_dom#20283,d_last_dom#20284,d_same_day_ly#20285,d_same_day_lq#20286,d_current_day#20287,... 4 more fields] parquet
                           +- SubqueryAlias `customer`
                              +- Relation[c_customer_sk#20310,c_customer_id#20311,c_current_cdemo_sk#20312,c_current_hdemo_sk#20313,c_current_addr_sk#20314,c_first_shipto_date_sk#20315,c_first_sales_date_sk#20316,c_salutation#20317,c_first_name#20318,c_last_name#20319,c_preferred_cust_flag#20320,c_birth_day#20321,c_birth_month#20322,c_birth_year#20323,c_birth_country#20324,c_login#20325,c_email_address#20326,c_last_review_date#20327] parquet

     : benchmark
19/09/08 18:23:23 INFO Query: 
== Query: q38-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [count(1) AS count(1)#20459L]
      +- SubqueryAlias `hot_cust`
         +- Intersect false
            :- Project [c_last_name#421, c_first_name#420, d_date#494]
            :  +- Intersect false
            :     :- Project [c_last_name#421, c_first_name#420, d_date#494]
            :     :  +- Distinct
            :     :     +- Project [c_last_name#421, c_first_name#420, d_date#494]
            :     :        +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_customer_sk#133 = c_customer_sk#412)) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
            :     :           +- Join Inner
            :     :              :- Join Inner
            :     :              :  :- SubqueryAlias `store_sales`
            :     :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :              :  +- SubqueryAlias `date_dim`
            :     :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     :              +- SubqueryAlias `customer`
            :     :                 +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :     +- Project [c_last_name#20386, c_first_name#20385, d_date#20332]
            :        +- Distinct
            :           +- Project [c_last_name#20386, c_first_name#20385, d_date#20332]
            :              +- Filter (((cs_sold_date_sk#0 = d_date_sk#20330) && (cs_bill_customer_sk#3 = c_customer_sk#20377)) && ((d_month_seq#20333 >= 1200) && (d_month_seq#20333 <= (1200 + 11))))
            :                 +- Join Inner
            :                    :- Join Inner
            :                    :  :- SubqueryAlias `catalog_sales`
            :                    :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :                    :  +- SubqueryAlias `date_dim`
            :                    :     +- Relation[d_date_sk#20330,d_date_id#20331,d_date#20332,d_month_seq#20333,d_week_seq#20334,d_quarter_seq#20335,d_year#20336,d_dow#20337,d_moy#20338,d_dom#20339,d_qoy#20340,d_fy_year#20341,d_fy_quarter_seq#20342,d_fy_week_seq#20343,d_day_name#20344,d_quarter_name#20345,d_holiday#20346,d_weekend#20347,d_following_holiday#20348,d_first_dom#20349,d_last_dom#20350,d_same_day_ly#20351,d_same_day_lq#20352,d_current_day#20353,... 4 more fields] parquet
            :                    +- SubqueryAlias `customer`
            :                       +- Relation[c_customer_sk#20377,c_customer_id#20378,c_current_cdemo_sk#20379,c_current_hdemo_sk#20380,c_current_addr_sk#20381,c_first_shipto_date_sk#20382,c_first_sales_date_sk#20383,c_salutation#20384,c_first_name#20385,c_last_name#20386,c_preferred_cust_flag#20387,c_birth_day#20388,c_birth_month#20389,c_birth_year#20390,c_birth_country#20391,c_login#20392,c_email_address#20393,c_last_review_date#20394] parquet
            +- Project [c_last_name#20450, c_first_name#20449, d_date#20397]
               +- Distinct
                  +- Project [c_last_name#20450, c_first_name#20449, d_date#20397]
                     +- Filter (((ws_sold_date_sk#216 = d_date_sk#20395) && (ws_bill_customer_sk#220 = c_customer_sk#20441)) && ((d_month_seq#20398 >= 1200) && (d_month_seq#20398 <= (1200 + 11))))
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `web_sales`
                           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :  +- SubqueryAlias `date_dim`
                           :     +- Relation[d_date_sk#20395,d_date_id#20396,d_date#20397,d_month_seq#20398,d_week_seq#20399,d_quarter_seq#20400,d_year#20401,d_dow#20402,d_moy#20403,d_dom#20404,d_qoy#20405,d_fy_year#20406,d_fy_quarter_seq#20407,d_fy_week_seq#20408,d_day_name#20409,d_quarter_name#20410,d_holiday#20411,d_weekend#20412,d_following_holiday#20413,d_first_dom#20414,d_last_dom#20415,d_same_day_ly#20416,d_same_day_lq#20417,d_current_day#20418,... 4 more fields] parquet
                           +- SubqueryAlias `customer`
                              +- Relation[c_customer_sk#20441,c_customer_id#20442,c_current_cdemo_sk#20443,c_current_hdemo_sk#20444,c_current_addr_sk#20445,c_first_shipto_date_sk#20446,c_first_sales_date_sk#20447,c_salutation#20448,c_first_name#20449,c_last_name#20450,c_preferred_cust_flag#20451,c_birth_day#20452,c_birth_month#20453,c_birth_year#20454,c_birth_country#20455,c_login#20456,c_email_address#20457,c_last_review_date#20458] parquet

      running Thread[benchmark runner,5,main]
Execution time: 9.166271272s
Running execution q39a-v2.4 iteration: 1, StandardRun=true
19/09/08 18:23:34 INFO Query: 
== Query: q39a-v2.4 ==
Sort [w_warehouse_sk#742 ASC NULLS FIRST, i_item_sk#564 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, mean#21101 ASC NULLS FIRST, cov#21102 ASC NULLS FIRST, d_moy#21376 ASC NULLS FIRST, mean#21197 ASC NULLS FIRST, cov#21129 ASC NULLS FIRST], true
+- Project [w_warehouse_sk#742, i_item_sk#564, d_moy#500, mean#21101, cov#21102, w_warehouse_sk#21326, i_item_sk#21262, d_moy#21376, mean#21197, cov#21129]
   +- Filter (((i_item_sk#564 = i_item_sk#21262) && (w_warehouse_sk#742 = w_warehouse_sk#21326)) && ((d_moy#500 = 1) && (d_moy#21376 = (1 + 1))))
      +- Join Inner
         :- SubqueryAlias `inv1`
         :  +- SubqueryAlias `inv`
         :     +- Project [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stdev#21100, mean#21101, CASE WHEN (mean#21101 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#21100 / mean#21101) END AS cov#21102]
         :        +- Filter (CASE WHEN (mean#21101 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#21100 / mean#21101) END > cast(1 as double))
         :           +- SubqueryAlias `foo`
         :              +- Aggregate [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500], [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#21100, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#21101]
         :                 +- Filter (((inv_item_sk#123 = i_item_sk#564) && (inv_warehouse_sk#124 = w_warehouse_sk#742)) && ((inv_date_sk#122 = d_date_sk#492) && (d_year#498 = 2001)))
         :                    +- Join Inner
         :                       :- Join Inner
         :                       :  :- Join Inner
         :                       :  :  :- SubqueryAlias `inventory`
         :                       :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
         :                       :  :  +- SubqueryAlias `item`
         :                       :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         :                       :  +- SubqueryAlias `warehouse`
         :                       :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
         :                       +- SubqueryAlias `date_dim`
         :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- SubqueryAlias `inv2`
            +- SubqueryAlias `inv`
               +- Project [w_warehouse_name#21328, w_warehouse_sk#21326, i_item_sk#21262, d_moy#21376, stdev#21196, mean#21197, CASE WHEN (mean#21197 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#21196 / mean#21197) END AS cov#21129]
                  +- Filter (CASE WHEN (mean#21197 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#21196 / mean#21197) END > cast(1 as double))
                     +- SubqueryAlias `foo`
                        +- Aggregate [w_warehouse_name#21328, w_warehouse_sk#21326, i_item_sk#21262, d_moy#21376], [w_warehouse_name#21328, w_warehouse_sk#21326, i_item_sk#21262, d_moy#21376, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#21196, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#21197]
                           +- Filter (((inv_item_sk#123 = i_item_sk#21262) && (inv_warehouse_sk#124 = w_warehouse_sk#21326)) && ((inv_date_sk#122 = d_date_sk#21368) && (d_year#21374 = 2001)))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `inventory`
                                 :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                                 :  :  +- SubqueryAlias `item`
                                 :  :     +- Relation[i_item_sk#21262,i_item_id#21263,i_rec_start_date#21264,i_rec_end_date#21265,i_item_desc#21266,i_current_price#21267,i_wholesale_cost#21268,i_brand_id#21269,i_brand#21270,i_class_id#21271,i_class#21272,i_category_id#21273,i_category#21274,i_manufact_id#21275,i_manufact#21276,i_size#21277,i_formulation#21278,i_color#21279,i_units#21280,i_container#21281,i_manager_id#21282,i_product_name#21283] parquet
                                 :  +- SubqueryAlias `warehouse`
                                 :     +- Relation[w_warehouse_sk#21326,w_warehouse_id#21327,w_warehouse_name#21328,w_warehouse_sq_ft#21329,w_street_number#21330,w_street_name#21331,w_street_type#21332,w_suite_number#21333,w_city#21334,w_county#21335,w_state#21336,w_zip#21337,w_country#21338,w_gmt_offset#21339] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#21368,d_date_id#21369,d_date#21370,d_month_seq#21371,d_week_seq#21372,d_quarter_seq#21373,d_year#21374,d_dow#21375,d_moy#21376,d_dom#21377,d_qoy#21378,d_fy_year#21379,d_fy_quarter_seq#21380,d_fy_week_seq#21381,d_day_name#21382,d_quarter_name#21383,d_holiday#21384,d_weekend#21385,d_following_holiday#21386,d_first_dom#21387,d_last_dom#21388,d_same_day_ly#21389,d_same_day_lq#21390,d_current_day#21391,... 4 more fields] parquet

     : benchmark
19/09/08 18:23:34 INFO Query: 
== Query: q39a-v2.4 ==
Sort [w_warehouse_sk#742 ASC NULLS FIRST, i_item_sk#564 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, mean#21407 ASC NULLS FIRST, cov#21408 ASC NULLS FIRST, d_moy#21682 ASC NULLS FIRST, mean#21503 ASC NULLS FIRST, cov#21435 ASC NULLS FIRST], true
+- Project [w_warehouse_sk#742, i_item_sk#564, d_moy#500, mean#21407, cov#21408, w_warehouse_sk#21632, i_item_sk#21568, d_moy#21682, mean#21503, cov#21435]
   +- Filter (((i_item_sk#564 = i_item_sk#21568) && (w_warehouse_sk#742 = w_warehouse_sk#21632)) && ((d_moy#500 = 1) && (d_moy#21682 = (1 + 1))))
      +- Join Inner
         :- SubqueryAlias `inv1`
         :  +- SubqueryAlias `inv`
         :     +- Project [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stdev#21406, mean#21407, CASE WHEN (mean#21407 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#21406 / mean#21407) END AS cov#21408]
         :        +- Filter (CASE WHEN (mean#21407 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#21406 / mean#21407) END > cast(1 as double))
         :           +- SubqueryAlias `foo`
         :              +- Aggregate [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500], [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#21406, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#21407]
         :                 +- Filter (((inv_item_sk#123 = i_item_sk#564) && (inv_warehouse_sk#124 = w_warehouse_sk#742)) && ((inv_date_sk#122 = d_date_sk#492) && (d_year#498 = 2001)))
         :                    +- Join Inner
         :                       :- Join Inner
         :                       :  :- Join Inner
         :                       :  :  :- SubqueryAlias `inventory`
         :                       :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
         :                       :  :  +- SubqueryAlias `item`
         :                       :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         :                       :  +- SubqueryAlias `warehouse`
         :                       :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
         :                       +- SubqueryAlias `date_dim`
         :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- SubqueryAlias `inv2`
            +- SubqueryAlias `inv`
               +- Project [w_warehouse_name#21634, w_warehouse_sk#21632, i_item_sk#21568, d_moy#21682, stdev#21502, mean#21503, CASE WHEN (mean#21503 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#21502 / mean#21503) END AS cov#21435]
                  +- Filter (CASE WHEN (mean#21503 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#21502 / mean#21503) END > cast(1 as double))
                     +- SubqueryAlias `foo`
                        +- Aggregate [w_warehouse_name#21634, w_warehouse_sk#21632, i_item_sk#21568, d_moy#21682], [w_warehouse_name#21634, w_warehouse_sk#21632, i_item_sk#21568, d_moy#21682, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#21502, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#21503]
                           +- Filter (((inv_item_sk#123 = i_item_sk#21568) && (inv_warehouse_sk#124 = w_warehouse_sk#21632)) && ((inv_date_sk#122 = d_date_sk#21674) && (d_year#21680 = 2001)))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `inventory`
                                 :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                                 :  :  +- SubqueryAlias `item`
                                 :  :     +- Relation[i_item_sk#21568,i_item_id#21569,i_rec_start_date#21570,i_rec_end_date#21571,i_item_desc#21572,i_current_price#21573,i_wholesale_cost#21574,i_brand_id#21575,i_brand#21576,i_class_id#21577,i_class#21578,i_category_id#21579,i_category#21580,i_manufact_id#21581,i_manufact#21582,i_size#21583,i_formulation#21584,i_color#21585,i_units#21586,i_container#21587,i_manager_id#21588,i_product_name#21589] parquet
                                 :  +- SubqueryAlias `warehouse`
                                 :     +- Relation[w_warehouse_sk#21632,w_warehouse_id#21633,w_warehouse_name#21634,w_warehouse_sq_ft#21635,w_street_number#21636,w_street_name#21637,w_street_type#21638,w_suite_number#21639,w_city#21640,w_county#21641,w_state#21642,w_zip#21643,w_country#21644,w_gmt_offset#21645] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#21674,d_date_id#21675,d_date#21676,d_month_seq#21677,d_week_seq#21678,d_quarter_seq#21679,d_year#21680,d_dow#21681,d_moy#21682,d_dom#21683,d_qoy#21684,d_fy_year#21685,d_fy_quarter_seq#21686,d_fy_week_seq#21687,d_day_name#21688,d_quarter_name#21689,d_holiday#21690,d_weekend#21691,d_following_holiday#21692,d_first_dom#21693,d_last_dom#21694,d_same_day_ly#21695,d_same_day_lq#21696,d_current_day#21697,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 16.758508294s
Running execution q39b-v2.4 iteration: 1, StandardRun=true
19/09/08 18:23:52 INFO Query: 
== Query: q39b-v2.4 ==
Sort [w_warehouse_sk#742 ASC NULLS FIRST, i_item_sk#564 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, mean#22768 ASC NULLS FIRST, cov#22769 ASC NULLS FIRST, d_moy#23043 ASC NULLS FIRST, mean#22864 ASC NULLS FIRST, cov#22796 ASC NULLS FIRST], true
+- Project [w_warehouse_sk#742, i_item_sk#564, d_moy#500, mean#22768, cov#22769, w_warehouse_sk#22993, i_item_sk#22929, d_moy#23043, mean#22864, cov#22796]
   +- Filter ((((i_item_sk#564 = i_item_sk#22929) && (w_warehouse_sk#742 = w_warehouse_sk#22993)) && (d_moy#500 = 1)) && ((d_moy#23043 = (1 + 1)) && (cov#22769 > cast(1.5 as double))))
      +- Join Inner
         :- SubqueryAlias `inv1`
         :  +- SubqueryAlias `inv`
         :     +- Project [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stdev#22767, mean#22768, CASE WHEN (mean#22768 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#22767 / mean#22768) END AS cov#22769]
         :        +- Filter (CASE WHEN (mean#22768 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#22767 / mean#22768) END > cast(1 as double))
         :           +- SubqueryAlias `foo`
         :              +- Aggregate [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500], [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#22767, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#22768]
         :                 +- Filter (((inv_item_sk#123 = i_item_sk#564) && (inv_warehouse_sk#124 = w_warehouse_sk#742)) && ((inv_date_sk#122 = d_date_sk#492) && (d_year#498 = 2001)))
         :                    +- Join Inner
         :                       :- Join Inner
         :                       :  :- Join Inner
         :                       :  :  :- SubqueryAlias `inventory`
         :                       :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
         :                       :  :  +- SubqueryAlias `item`
         :                       :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         :                       :  +- SubqueryAlias `warehouse`
         :                       :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
         :                       +- SubqueryAlias `date_dim`
         :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- SubqueryAlias `inv2`
            +- SubqueryAlias `inv`
               +- Project [w_warehouse_name#22995, w_warehouse_sk#22993, i_item_sk#22929, d_moy#23043, stdev#22863, mean#22864, CASE WHEN (mean#22864 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#22863 / mean#22864) END AS cov#22796]
                  +- Filter (CASE WHEN (mean#22864 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#22863 / mean#22864) END > cast(1 as double))
                     +- SubqueryAlias `foo`
                        +- Aggregate [w_warehouse_name#22995, w_warehouse_sk#22993, i_item_sk#22929, d_moy#23043], [w_warehouse_name#22995, w_warehouse_sk#22993, i_item_sk#22929, d_moy#23043, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#22863, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#22864]
                           +- Filter (((inv_item_sk#123 = i_item_sk#22929) && (inv_warehouse_sk#124 = w_warehouse_sk#22993)) && ((inv_date_sk#122 = d_date_sk#23035) && (d_year#23041 = 2001)))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `inventory`
                                 :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                                 :  :  +- SubqueryAlias `item`
                                 :  :     +- Relation[i_item_sk#22929,i_item_id#22930,i_rec_start_date#22931,i_rec_end_date#22932,i_item_desc#22933,i_current_price#22934,i_wholesale_cost#22935,i_brand_id#22936,i_brand#22937,i_class_id#22938,i_class#22939,i_category_id#22940,i_category#22941,i_manufact_id#22942,i_manufact#22943,i_size#22944,i_formulation#22945,i_color#22946,i_units#22947,i_container#22948,i_manager_id#22949,i_product_name#22950] parquet
                                 :  +- SubqueryAlias `warehouse`
                                 :     +- Relation[w_warehouse_sk#22993,w_warehouse_id#22994,w_warehouse_name#22995,w_warehouse_sq_ft#22996,w_street_number#22997,w_street_name#22998,w_street_type#22999,w_suite_number#23000,w_city#23001,w_county#23002,w_state#23003,w_zip#23004,w_country#23005,w_gmt_offset#23006] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#23035,d_date_id#23036,d_date#23037,d_month_seq#23038,d_week_seq#23039,d_quarter_seq#23040,d_year#23041,d_dow#23042,d_moy#23043,d_dom#23044,d_qoy#23045,d_fy_year#23046,d_fy_quarter_seq#23047,d_fy_week_seq#23048,d_day_name#23049,d_quarter_name#23050,d_holiday#23051,d_weekend#23052,d_following_holiday#23053,d_first_dom#23054,d_last_dom#23055,d_same_day_ly#23056,d_same_day_lq#23057,d_current_day#23058,... 4 more fields] parquet

     : benchmark
19/09/08 18:23:52 INFO Query: 
== Query: q39b-v2.4 ==
Sort [w_warehouse_sk#742 ASC NULLS FIRST, i_item_sk#564 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, mean#23074 ASC NULLS FIRST, cov#23075 ASC NULLS FIRST, d_moy#23349 ASC NULLS FIRST, mean#23170 ASC NULLS FIRST, cov#23102 ASC NULLS FIRST], true
+- Project [w_warehouse_sk#742, i_item_sk#564, d_moy#500, mean#23074, cov#23075, w_warehouse_sk#23299, i_item_sk#23235, d_moy#23349, mean#23170, cov#23102]
   +- Filter ((((i_item_sk#564 = i_item_sk#23235) && (w_warehouse_sk#742 = w_warehouse_sk#23299)) && (d_moy#500 = 1)) && ((d_moy#23349 = (1 + 1)) && (cov#23075 > cast(1.5 as double))))
      +- Join Inner
         :- SubqueryAlias `inv1`
         :  +- SubqueryAlias `inv`
         :     +- Project [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stdev#23073, mean#23074, CASE WHEN (mean#23074 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#23073 / mean#23074) END AS cov#23075]
         :        +- Filter (CASE WHEN (mean#23074 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#23073 / mean#23074) END > cast(1 as double))
         :           +- SubqueryAlias `foo`
         :              +- Aggregate [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500], [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#23073, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#23074]
         :                 +- Filter (((inv_item_sk#123 = i_item_sk#564) && (inv_warehouse_sk#124 = w_warehouse_sk#742)) && ((inv_date_sk#122 = d_date_sk#492) && (d_year#498 = 2001)))
         :                    +- Join Inner
         :                       :- Join Inner
         :                       :  :- Join Inner
         :                       :  :  :- SubqueryAlias `inventory`
         :                       :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
         :                       :  :  +- SubqueryAlias `item`
         :                       :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         :                       :  +- SubqueryAlias `warehouse`
         :                       :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
         :                       +- SubqueryAlias `date_dim`
         :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- SubqueryAlias `inv2`
            +- SubqueryAlias `inv`
               +- Project [w_warehouse_name#23301, w_warehouse_sk#23299, i_item_sk#23235, d_moy#23349, stdev#23169, mean#23170, CASE WHEN (mean#23170 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#23169 / mean#23170) END AS cov#23102]
                  +- Filter (CASE WHEN (mean#23170 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#23169 / mean#23170) END > cast(1 as double))
                     +- SubqueryAlias `foo`
                        +- Aggregate [w_warehouse_name#23301, w_warehouse_sk#23299, i_item_sk#23235, d_moy#23349], [w_warehouse_name#23301, w_warehouse_sk#23299, i_item_sk#23235, d_moy#23349, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#23169, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#23170]
                           +- Filter (((inv_item_sk#123 = i_item_sk#23235) && (inv_warehouse_sk#124 = w_warehouse_sk#23299)) && ((inv_date_sk#122 = d_date_sk#23341) && (d_year#23347 = 2001)))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `inventory`
                                 :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                                 :  :  +- SubqueryAlias `item`
                                 :  :     +- Relation[i_item_sk#23235,i_item_id#23236,i_rec_start_date#23237,i_rec_end_date#23238,i_item_desc#23239,i_current_price#23240,i_wholesale_cost#23241,i_brand_id#23242,i_brand#23243,i_class_id#23244,i_class#23245,i_category_id#23246,i_category#23247,i_manufact_id#23248,i_manufact#23249,i_size#23250,i_formulation#23251,i_color#23252,i_units#23253,i_container#23254,i_manager_id#23255,i_product_name#23256] parquet
                                 :  +- SubqueryAlias `warehouse`
                                 :     +- Relation[w_warehouse_sk#23299,w_warehouse_id#23300,w_warehouse_name#23301,w_warehouse_sq_ft#23302,w_street_number#23303,w_street_name#23304,w_street_type#23305,w_suite_number#23306,w_city#23307,w_county#23308,w_state#23309,w_zip#23310,w_country#23311,w_gmt_offset#23312] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#23341,d_date_id#23342,d_date#23343,d_month_seq#23344,d_week_seq#23345,d_quarter_seq#23346,d_year#23347,d_dow#23348,d_moy#23349,d_dom#23350,d_qoy#23351,d_fy_year#23352,d_fy_quarter_seq#23353,d_fy_week_seq#23354,d_day_name#23355,d_quarter_name#23356,d_holiday#23357,d_weekend#23358,d_following_holiday#23359,d_first_dom#23360,d_last_dom#23361,d_same_day_ly#23362,d_same_day_lq#23363,d_current_day#23364,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 14.346495302s
Running execution q40-v2.4 iteration: 1, StandardRun=true
19/09/08 18:24:08 INFO Query: 
== Query: q40-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [w_state#752, i_item_id#565, sales_before#24074, sales_after#24075]
      +- Sort [w_state#752 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST], true
         +- Aggregate [w_state#752, i_item_id#565], [w_state#752, i_item_id#565, sum(CASE WHEN (cast(d_date#494 as date) < cast(2000-03-11 as date)) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_refunded_cash#91 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2)) ELSE cast(0 as decimal(13,2)) END) AS sales_before#24074, sum(CASE WHEN (cast(d_date#494 as date) >= cast(2000-03-11 as date)) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_refunded_cash#91 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2)) ELSE cast(0 as decimal(13,2)) END) AS sales_after#24075]
            +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(0.99 as decimal(7,2))) && (cast(i_current_price#569 as decimal(7,2)) <= cast(1.49 as decimal(7,2)))) && (i_item_sk#564 = cs_item_sk#15)) && (cs_warehouse_sk#14 = w_warehouse_sk#742)) && ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(cast(cast(2000-03-11 as date) as timestamp) - interval 4 weeks 2 days as date)) && (d_date#494 <= cast(cast(cast(2000-03-11 as date) as timestamp) + interval 4 weeks 2 days as date)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
                  :  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `catalog_returns`
                  :  :  :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                  :  :  +- SubqueryAlias `warehouse`
                  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:24:08 INFO Query: 
== Query: q40-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [w_state#752, i_item_id#565, sales_before#24084, sales_after#24085]
      +- Sort [w_state#752 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST], true
         +- Aggregate [w_state#752, i_item_id#565], [w_state#752, i_item_id#565, sum(CASE WHEN (cast(d_date#494 as date) < cast(2000-03-11 as date)) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_refunded_cash#91 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2)) ELSE cast(0 as decimal(13,2)) END) AS sales_before#24084, sum(CASE WHEN (cast(d_date#494 as date) >= cast(2000-03-11 as date)) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_refunded_cash#91 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2)) ELSE cast(0 as decimal(13,2)) END) AS sales_after#24085]
            +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(0.99 as decimal(7,2))) && (cast(i_current_price#569 as decimal(7,2)) <= cast(1.49 as decimal(7,2)))) && (i_item_sk#564 = cs_item_sk#15)) && (cs_warehouse_sk#14 = w_warehouse_sk#742)) && ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(cast(cast(2000-03-11 as date) as timestamp) - interval 4 weeks 2 days as date)) && (d_date#494 <= cast(cast(cast(2000-03-11 as date) as timestamp) + interval 4 weeks 2 days as date)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
                  :  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `catalog_returns`
                  :  :  :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                  :  :  +- SubqueryAlias `warehouse`
                  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 5.764034402999999s
Running execution q41-v2.4 iteration: 1, StandardRun=true
19/09/08 18:24:15 INFO Query: 
== Query: q41-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_product_name#585 ASC NULLS FIRST], true
      +- Distinct
         +- Project [i_product_name#585]
            +- Filter (((i_manufact_id#577 >= 738) && (i_manufact_id#577 <= (738 + 40))) && (scalar-subquery#24128 [i_manufact#578 && i_manufact#578] > cast(0 as bigint)))
               :  +- Aggregate [count(1) AS item_cnt#24127L]
               :     +- Filter (((i_manufact#578 = outer(i_manufact#578)) && (((((i_category#576 = Women) && ((i_color#581 = powder) || (i_color#581 = khaki))) && (((i_units#582 = Ounce) || (i_units#582 = Oz)) && ((i_size#579 = medium) || (i_size#579 = extra large)))) || (((i_category#576 = Women) && ((i_color#581 = brown) || (i_color#581 = honeydew))) && (((i_units#582 = Bunch) || (i_units#582 = Ton)) && ((i_size#579 = N/A) || (i_size#579 = small))))) || ((((i_category#576 = Men) && ((i_color#581 = floral) || (i_color#581 = deep))) && (((i_units#582 = N/A) || (i_units#582 = Dozen)) && ((i_size#579 = petite) || (i_size#579 = large)))) || (((i_category#576 = Men) && ((i_color#581 = light) || (i_color#581 = cornflower))) && (((i_units#582 = Box) || (i_units#582 = Pound)) && ((i_size#579 = medium) || (i_size#579 = extra large))))))) || ((i_manufact#578 = outer(i_manufact#578)) && (((((i_category#576 = Women) && ((i_color#581 = midnight) || (i_color#581 = snow))) && (((i_units#582 = Pallet) || (i_units#582 = Gross)) && ((i_size#579 = medium) || (i_size#579 = extra large)))) || (((i_category#576 = Women) && ((i_color#581 = cyan) || (i_color#581 = papaya))) && (((i_units#582 = Cup) || (i_units#582 = Dram)) && ((i_size#579 = N/A) || (i_size#579 = small))))) || ((((i_category#576 = Men) && ((i_color#581 = orange) || (i_color#581 = frosted))) && (((i_units#582 = Each) || (i_units#582 = Tbl)) && ((i_size#579 = petite) || (i_size#579 = large)))) || (((i_category#576 = Men) && ((i_color#581 = forest) || (i_color#581 = ghost))) && (((i_units#582 = Lb) || (i_units#582 = Bundle)) && ((i_size#579 = medium) || (i_size#579 = extra large))))))))
               :        +- SubqueryAlias `item`
               :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- SubqueryAlias `i1`
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:24:15 INFO Query: 
== Query: q41-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_product_name#585 ASC NULLS FIRST], true
      +- Distinct
         +- Project [i_product_name#585]
            +- Filter (((i_manufact_id#577 >= 738) && (i_manufact_id#577 <= (738 + 40))) && (scalar-subquery#24132 [i_manufact#578 && i_manufact#578] > cast(0 as bigint)))
               :  +- Aggregate [count(1) AS item_cnt#24131L]
               :     +- Filter (((i_manufact#578 = outer(i_manufact#578)) && (((((i_category#576 = Women) && ((i_color#581 = powder) || (i_color#581 = khaki))) && (((i_units#582 = Ounce) || (i_units#582 = Oz)) && ((i_size#579 = medium) || (i_size#579 = extra large)))) || (((i_category#576 = Women) && ((i_color#581 = brown) || (i_color#581 = honeydew))) && (((i_units#582 = Bunch) || (i_units#582 = Ton)) && ((i_size#579 = N/A) || (i_size#579 = small))))) || ((((i_category#576 = Men) && ((i_color#581 = floral) || (i_color#581 = deep))) && (((i_units#582 = N/A) || (i_units#582 = Dozen)) && ((i_size#579 = petite) || (i_size#579 = large)))) || (((i_category#576 = Men) && ((i_color#581 = light) || (i_color#581 = cornflower))) && (((i_units#582 = Box) || (i_units#582 = Pound)) && ((i_size#579 = medium) || (i_size#579 = extra large))))))) || ((i_manufact#578 = outer(i_manufact#578)) && (((((i_category#576 = Women) && ((i_color#581 = midnight) || (i_color#581 = snow))) && (((i_units#582 = Pallet) || (i_units#582 = Gross)) && ((i_size#579 = medium) || (i_size#579 = extra large)))) || (((i_category#576 = Women) && ((i_color#581 = cyan) || (i_color#581 = papaya))) && (((i_units#582 = Cup) || (i_units#582 = Dram)) && ((i_size#579 = N/A) || (i_size#579 = small))))) || ((((i_category#576 = Men) && ((i_color#581 = orange) || (i_color#581 = frosted))) && (((i_units#582 = Each) || (i_units#582 = Tbl)) && ((i_size#579 = petite) || (i_size#579 = large)))) || (((i_category#576 = Men) && ((i_color#581 = forest) || (i_color#581 = ghost))) && (((i_units#582 = Lb) || (i_units#582 = Bundle)) && ((i_size#579 = medium) || (i_size#579 = extra large))))))))
               :        +- SubqueryAlias `item`
               :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- SubqueryAlias `i1`
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 1.937929772s
Running execution q42-v2.4 iteration: 1, StandardRun=true
19/09/08 18:24:18 INFO Query: 
== Query: q42-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [d_year#498, i_category_id#575, i_category#576, sum(ss_ext_sales_price)#24162]
      +- Sort [sum(ss_ext_sales_price)#24162 DESC NULLS LAST, d_year#498 ASC NULLS FIRST, i_category_id#575 ASC NULLS FIRST, i_category#576 ASC NULLS FIRST], true
         +- Aggregate [d_year#498, i_category_id#575, i_category#576], [d_year#498, i_category_id#575, i_category#576, sum(ss_ext_sales_price#145) AS sum(ss_ext_sales_price)#24162]
            +- Filter ((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 1)) && ((d_moy#500 = 11) && (d_year#498 = 2000)))
               +- Join Inner
                  :- Join Inner
                  :  :- SubqueryAlias `dt`
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `store_sales`
                  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:24:18 INFO Query: 
== Query: q42-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [d_year#498, i_category_id#575, i_category#576, sum(ss_ext_sales_price)#24173]
      +- Sort [sum(ss_ext_sales_price)#24173 DESC NULLS LAST, d_year#498 ASC NULLS FIRST, i_category_id#575 ASC NULLS FIRST, i_category#576 ASC NULLS FIRST], true
         +- Aggregate [d_year#498, i_category_id#575, i_category#576], [d_year#498, i_category_id#575, i_category#576, sum(ss_ext_sales_price#145) AS sum(ss_ext_sales_price)#24173]
            +- Filter ((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 1)) && ((d_moy#500 = 11) && (d_year#498 = 2000)))
               +- Join Inner
                  :- Join Inner
                  :  :- SubqueryAlias `dt`
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `store_sales`
                  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 1.8471924309999999s
Running execution q43-v2.4 iteration: 1, StandardRun=true
19/09/08 18:24:21 INFO Query: 
== Query: q43-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name#669 ASC NULLS FIRST, s_store_id#665 ASC NULLS FIRST, sun_sales#24254 ASC NULLS FIRST, mon_sales#24255 ASC NULLS FIRST, tue_sales#24256 ASC NULLS FIRST, wed_sales#24257 ASC NULLS FIRST, thu_sales#24258 ASC NULLS FIRST, fri_sales#24259 ASC NULLS FIRST, sat_sales#24260 ASC NULLS FIRST], true
      +- Aggregate [s_store_name#669, s_store_id#665], [s_store_name#669, s_store_id#665, sum(CASE WHEN (d_day_name#506 = Sunday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sun_sales#24254, sum(CASE WHEN (d_day_name#506 = Monday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS mon_sales#24255, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS tue_sales#24256, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS wed_sales#24257, sum(CASE WHEN (d_day_name#506 = Thursday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS thu_sales#24258, sum(CASE WHEN (d_day_name#506 = Friday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS fri_sales#24259, sum(CASE WHEN (d_day_name#506 = Saturday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sat_sales#24260]
         +- Filter (((d_date_sk#492 = ss_sold_date_sk#130) && (s_store_sk#664 = ss_store_sk#137)) && ((cast(s_gmt_offset#691 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (d_year#498 = 2000)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `date_dim`
               :  :  +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `store`
                  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/09/08 18:24:21 INFO Query: 
== Query: q43-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name#669 ASC NULLS FIRST, s_store_id#665 ASC NULLS FIRST, sun_sales#24286 ASC NULLS FIRST, mon_sales#24287 ASC NULLS FIRST, tue_sales#24288 ASC NULLS FIRST, wed_sales#24289 ASC NULLS FIRST, thu_sales#24290 ASC NULLS FIRST, fri_sales#24291 ASC NULLS FIRST, sat_sales#24292 ASC NULLS FIRST], true
      +- Aggregate [s_store_name#669, s_store_id#665], [s_store_name#669, s_store_id#665, sum(CASE WHEN (d_day_name#506 = Sunday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sun_sales#24286, sum(CASE WHEN (d_day_name#506 = Monday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS mon_sales#24287, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS tue_sales#24288, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS wed_sales#24289, sum(CASE WHEN (d_day_name#506 = Thursday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS thu_sales#24290, sum(CASE WHEN (d_day_name#506 = Friday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS fri_sales#24291, sum(CASE WHEN (d_day_name#506 = Saturday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sat_sales#24292]
         +- Filter (((d_date_sk#492 = ss_sold_date_sk#130) && (s_store_sk#664 = ss_store_sk#137)) && ((cast(s_gmt_offset#691 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (d_year#498 = 2000)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `date_dim`
               :  :  +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `store`
                  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 2.255848649s
Running execution q44-v2.4 iteration: 1, StandardRun=true
19/09/08 18:24:24 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 18:24:24 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 18:24:24 INFO Query: 
== Query: q44-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [rnk#24508 ASC NULLS FIRST], true
      +- Project [rnk#24508, i_product_name#585 AS best_performing#24514, i_product_name#24559 AS worst_performing#24515]
         +- Filter (((rnk#24508 = rnk#24513) && (i_item_sk#564 = item_sk#24504)) && (i_item_sk#24538 = item_sk#24509))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `asceding`
               :  :  :  +- Project [item_sk#24504, rnk#24508]
               :  :  :     +- Filter (rnk#24508 < 11)
               :  :  :        +- SubqueryAlias `V11`
               :  :  :           +- Project [item_sk#24504, rnk#24508]
               :  :  :              +- Project [item_sk#24504, rank_col#24505, rnk#24508, rnk#24508]
               :  :  :                 +- Window [rank(rank_col#24505) windowspecdefinition(rank_col#24505 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rnk#24508], [rank_col#24505 ASC NULLS FIRST]
               :  :  :                    +- Project [item_sk#24504, rank_col#24505]
               :  :  :                       +- SubqueryAlias `V1`
               :  :  :                          +- Project [item_sk#24504, rank_col#24505]
               :  :  :                             +- Filter (cast(avg(ss_net_profit#152)#24526 as decimal(13,7)) > cast(CheckOverflow((promote_precision(cast(0.9 as decimal(11,6))) * promote_precision(cast(scalar-subquery#24507 [] as decimal(11,6)))), DecimalType(13,7)) as decimal(13,7)))
               :  :  :                                :  +- Aggregate [ss_store_sk#137], [avg(ss_net_profit#152) AS rank_col#24506]
               :  :  :                                :     +- Filter ((ss_store_sk#137 = 4) && isnull(ss_addr_sk#136))
               :  :  :                                :        +- SubqueryAlias `store_sales`
               :  :  :                                :           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :                                +- Aggregate [ss_item_sk#132], [ss_item_sk#132 AS item_sk#24504, avg(ss_net_profit#152) AS rank_col#24505, avg(ss_net_profit#152) AS avg(ss_net_profit#152)#24526]
               :  :  :                                   +- Filter (ss_store_sk#137 = 4)
               :  :  :                                      +- SubqueryAlias `ss1`
               :  :  :                                         +- SubqueryAlias `store_sales`
               :  :  :                                            +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  +- SubqueryAlias `descending`
               :  :     +- Project [item_sk#24509, rnk#24513]
               :  :        +- Filter (rnk#24513 < 11)
               :  :           +- SubqueryAlias `V21`
               :  :              +- Project [item_sk#24509, rnk#24513]
               :  :                 +- Project [item_sk#24509, rank_col#24510, rnk#24513, rnk#24513]
               :  :                    +- Window [rank(rank_col#24510) windowspecdefinition(rank_col#24510 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rnk#24513], [rank_col#24510 DESC NULLS LAST]
               :  :                       +- Project [item_sk#24509, rank_col#24510]
               :  :                          +- SubqueryAlias `V2`
               :  :                             +- Project [item_sk#24509, rank_col#24510]
               :  :                                +- Filter (cast(avg(ss_net_profit#152)#24529 as decimal(13,7)) > cast(CheckOverflow((promote_precision(cast(0.9 as decimal(11,6))) * promote_precision(cast(scalar-subquery#24512 [] as decimal(11,6)))), DecimalType(13,7)) as decimal(13,7)))
               :  :                                   :  +- Aggregate [ss_store_sk#137], [avg(ss_net_profit#152) AS rank_col#24511]
               :  :                                   :     +- Filter ((ss_store_sk#137 = 4) && isnull(ss_addr_sk#136))
               :  :                                   :        +- SubqueryAlias `store_sales`
               :  :                                   :           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :                                   +- Aggregate [ss_item_sk#132], [ss_item_sk#132 AS item_sk#24509, avg(ss_net_profit#152) AS rank_col#24510, avg(ss_net_profit#152) AS avg(ss_net_profit#152)#24529]
               :  :                                      +- Filter (ss_store_sk#137 = 4)
               :  :                                         +- SubqueryAlias `ss1`
               :  :                                            +- SubqueryAlias `store_sales`
               :  :                                               +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  +- SubqueryAlias `i1`
               :     +- SubqueryAlias `item`
               :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- SubqueryAlias `i2`
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#24538,i_item_id#24539,i_rec_start_date#24540,i_rec_end_date#24541,i_item_desc#24542,i_current_price#24543,i_wholesale_cost#24544,i_brand_id#24545,i_brand#24546,i_class_id#24547,i_class#24548,i_category_id#24549,i_category#24550,i_manufact_id#24551,i_manufact#24552,i_size#24553,i_formulation#24554,i_color#24555,i_units#24556,i_container#24557,i_manager_id#24558,i_product_name#24559] parquet

     : benchmark
19/09/08 18:24:24 INFO Query: 
== Query: q44-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [rnk#24583 ASC NULLS FIRST], true
      +- Project [rnk#24583, i_product_name#585 AS best_performing#24589, i_product_name#24634 AS worst_performing#24590]
         +- Filter (((rnk#24583 = rnk#24588) && (i_item_sk#564 = item_sk#24579)) && (i_item_sk#24613 = item_sk#24584))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `asceding`
               :  :  :  +- Project [item_sk#24579, rnk#24583]
               :  :  :     +- Filter (rnk#24583 < 11)
               :  :  :        +- SubqueryAlias `V11`
               :  :  :           +- Project [item_sk#24579, rnk#24583]
               :  :  :              +- Project [item_sk#24579, rank_col#24580, rnk#24583, rnk#24583]
               :  :  :                 +- Window [rank(rank_col#24580) windowspecdefinition(rank_col#24580 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rnk#24583], [rank_col#24580 ASC NULLS FIRST]
               :  :  :                    +- Project [item_sk#24579, rank_col#24580]
               :  :  :                       +- SubqueryAlias `V1`
               :  :  :                          +- Project [item_sk#24579, rank_col#24580]
               :  :  :                             +- Filter (cast(avg(ss_net_profit#152)#24601 as decimal(13,7)) > cast(CheckOverflow((promote_precision(cast(0.9 as decimal(11,6))) * promote_precision(cast(scalar-subquery#24582 [] as decimal(11,6)))), DecimalType(13,7)) as decimal(13,7)))
               :  :  :                                :  +- Aggregate [ss_store_sk#137], [avg(ss_net_profit#152) AS rank_col#24581]
               :  :  :                                :     +- Filter ((ss_store_sk#137 = 4) && isnull(ss_addr_sk#136))
               :  :  :                                :        +- SubqueryAlias `store_sales`
               :  :  :                                :           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :                                +- Aggregate [ss_item_sk#132], [ss_item_sk#132 AS item_sk#24579, avg(ss_net_profit#152) AS rank_col#24580, avg(ss_net_profit#152) AS avg(ss_net_profit#152)#24601]
               :  :  :                                   +- Filter (ss_store_sk#137 = 4)
               :  :  :                                      +- SubqueryAlias `ss1`
               :  :  :                                         +- SubqueryAlias `store_sales`
               :  :  :                                            +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  +- SubqueryAlias `descending`
               :  :     +- Project [item_sk#24584, rnk#24588]
               :  :        +- Filter (rnk#24588 < 11)
               :  :           +- SubqueryAlias `V21`
               :  :              +- Project [item_sk#24584, rnk#24588]
               :  :                 +- Project [item_sk#24584, rank_col#24585, rnk#24588, rnk#24588]
               :  :                    +- Window [rank(rank_col#24585) windowspecdefinition(rank_col#24585 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rnk#24588], [rank_col#24585 DESC NULLS LAST]
               :  :                       +- Project [item_sk#24584, rank_col#24585]
               :  :                          +- SubqueryAlias `V2`
               :  :                             +- Project [item_sk#24584, rank_col#24585]
               :  :                                +- Filter (cast(avg(ss_net_profit#152)#24604 as decimal(13,7)) > cast(CheckOverflow((promote_precision(cast(0.9 as decimal(11,6))) * promote_precision(cast(scalar-subquery#24587 [] as decimal(11,6)))), DecimalType(13,7)) as decimal(13,7)))
               :  :                                   :  +- Aggregate [ss_store_sk#137], [avg(ss_net_profit#152) AS rank_col#24586]
               :  :                                   :     +- Filter ((ss_store_sk#137 = 4) && isnull(ss_addr_sk#136))
               :  :                                   :        +- SubqueryAlias `store_sales`
               :  :                                   :           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :                                   +- Aggregate [ss_item_sk#132], [ss_item_sk#132 AS item_sk#24584, avg(ss_net_profit#152) AS rank_col#24585, avg(ss_net_profit#152) AS avg(ss_net_profit#152)#24604]
               :  :                                      +- Filter (ss_store_sk#137 = 4)
               :  :                                         +- SubqueryAlias `ss1`
               :  :                                            +- SubqueryAlias `store_sales`
               :  :                                               +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  +- SubqueryAlias `i1`
               :     +- SubqueryAlias `item`
               :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- SubqueryAlias `i2`
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#24613,i_item_id#24614,i_rec_start_date#24615,i_rec_end_date#24616,i_item_desc#24617,i_current_price#24618,i_wholesale_cost#24619,i_brand_id#24620,i_brand#24621,i_class_id#24622,i_class#24623,i_category_id#24624,i_category#24625,i_manufact_id#24626,i_manufact#24627,i_size#24628,i_formulation#24629,i_color#24630,i_units#24631,i_container#24632,i_manager_id#24633,i_product_name#24634] parquet

      running Thread[benchmark runner,5,main]
19/09/08 18:24:24 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 18:24:24 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
Execution time: 4.410559685s
Running execution q45-v2.4 iteration: 1, StandardRun=true
19/09/08 18:24:30 INFO Query: 
== Query: q45-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ca_zip#457, ca_city#454, sum(ws_sales_price)#24851]
      +- Sort [ca_zip#457 ASC NULLS FIRST, ca_city#454 ASC NULLS FIRST], true
         +- Aggregate [ca_zip#457, ca_city#454], [ca_zip#457, ca_city#454, sum(ws_sales_price#237) AS sum(ws_sales_price)#24851]
            +- Filter ((((ws_bill_customer_sk#220 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && ((ws_item_sk#219 = i_item_sk#564) && (substring(ca_zip#457, 1, 5) IN (85669,86197,88274,83405,86475,85392,85460,80348,81792) || i_item_id#565 IN (list#24849 [])))) && (((ws_sold_date_sk#216 = d_date_sk#492) && (d_qoy#502 = 2)) && (d_year#498 = 2001)))
               :  +- Project [i_item_id#565]
               :     +- Filter i_item_sk#564 IN (2,3,5,7,11,13,17,19,23,29)
               :        +- SubqueryAlias `item`
               :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `web_sales`
                  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `customer`
                  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  :  +- SubqueryAlias `customer_address`
                  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  :  +- SubqueryAlias `date_dim`
                  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:24:30 INFO Query: 
== Query: q45-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ca_zip#457, ca_city#454, sum(ws_sales_price)#24859]
      +- Sort [ca_zip#457 ASC NULLS FIRST, ca_city#454 ASC NULLS FIRST], true
         +- Aggregate [ca_zip#457, ca_city#454], [ca_zip#457, ca_city#454, sum(ws_sales_price#237) AS sum(ws_sales_price)#24859]
            +- Filter ((((ws_bill_customer_sk#220 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && ((ws_item_sk#219 = i_item_sk#564) && (substring(ca_zip#457, 1, 5) IN (85669,86197,88274,83405,86475,85392,85460,80348,81792) || i_item_id#565 IN (list#24857 [])))) && (((ws_sold_date_sk#216 = d_date_sk#492) && (d_qoy#502 = 2)) && (d_year#498 = 2001)))
               :  +- Project [i_item_id#565]
               :     +- Filter i_item_sk#564 IN (2,3,5,7,11,13,17,19,23,29)
               :        +- SubqueryAlias `item`
               :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `web_sales`
                  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `customer`
                  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  :  +- SubqueryAlias `customer_address`
                  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  :  +- SubqueryAlias `date_dim`
                  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 4.46917632s
Running execution q46-v2.4 iteration: 1, StandardRun=true
19/09/08 18:24:35 INFO Query: 
== Query: q46-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, ca_city#454 ASC NULLS FIRST, bought_city#24902 ASC NULLS FIRST, ss_ticket_number#139L ASC NULLS FIRST], true
      +- Project [c_last_name#421, c_first_name#420, ca_city#454, bought_city#24902, ss_ticket_number#139L, amt#24903, profit#24904]
         +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && NOT (ca_city#454 = bought_city#24902))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dn`
               :  :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133, ss_addr_sk#136, ca_city#454], [ss_ticket_number#139L, ss_customer_sk#133, ca_city#454 AS bought_city#24902, sum(ss_coupon_amt#149) AS amt#24903, sum(ss_net_profit#152) AS profit#24904]
               :  :     +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_hdemo_sk#135 = hd_demo_sk#548) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((hd_dep_count#551 = 4) || (hd_vehicle_count#552 = 3)) && d_dow#499 IN (6,0)) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_city#686 IN (Fairview,Midway,Fairview,Fairview,Fairview))))
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- Join Inner
               :  :           :  :  :- Join Inner
               :  :           :  :  :  :- SubqueryAlias `store_sales`
               :  :           :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  :  :  +- SubqueryAlias `date_dim`
               :  :           :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           :  :  +- SubqueryAlias `store`
               :  :           :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :  :           :  +- SubqueryAlias `household_demographics`
               :  :           :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  :           +- SubqueryAlias `customer_address`
               :  :              +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer`
               :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               +- SubqueryAlias `current_addr`
                  +- SubqueryAlias `customer_address`
                     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

     : benchmark
19/09/08 18:24:35 INFO Query: 
== Query: q46-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, ca_city#454 ASC NULLS FIRST, bought_city#24914 ASC NULLS FIRST, ss_ticket_number#139L ASC NULLS FIRST], true
      +- Project [c_last_name#421, c_first_name#420, ca_city#454, bought_city#24914, ss_ticket_number#139L, amt#24915, profit#24916]
         +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && NOT (ca_city#454 = bought_city#24914))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dn`
               :  :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133, ss_addr_sk#136, ca_city#454], [ss_ticket_number#139L, ss_customer_sk#133, ca_city#454 AS bought_city#24914, sum(ss_coupon_amt#149) AS amt#24915, sum(ss_net_profit#152) AS profit#24916]
               :  :     +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_hdemo_sk#135 = hd_demo_sk#548) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((hd_dep_count#551 = 4) || (hd_vehicle_count#552 = 3)) && d_dow#499 IN (6,0)) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_city#686 IN (Fairview,Midway,Fairview,Fairview,Fairview))))
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- Join Inner
               :  :           :  :  :- Join Inner
               :  :           :  :  :  :- SubqueryAlias `store_sales`
               :  :           :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  :  :  +- SubqueryAlias `date_dim`
               :  :           :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           :  :  +- SubqueryAlias `store`
               :  :           :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :  :           :  +- SubqueryAlias `household_demographics`
               :  :           :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  :           +- SubqueryAlias `customer_address`
               :  :              +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer`
               :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               +- SubqueryAlias `current_addr`
                  +- SubqueryAlias `customer_address`
                     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

      running Thread[benchmark runner,5,main]
Execution time: 5.806156739s
Running execution q47-v2.4 iteration: 1, StandardRun=true
19/09/08 18:24:44 INFO Query: 
== Query: q47-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#26049 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#26050 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
      +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, avg_monthly_sales#26050, sum_sales#26049, psum#26052, nsum#26053]
         +- Filter (((d_year#498 = 1999) && (cast(avg_monthly_sales#26050 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6)))) && (cast(CASE WHEN (cast(avg_monthly_sales#26050 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#26049 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#26050 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#26050 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16))))
            +- SubqueryAlias `v2`
               +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, avg_monthly_sales#26050, sum_sales#26049, sum_sales#26257 AS psum#26052, sum_sales#26732 AS nsum#26053]
                  +- Filter (((((i_category#576 = i_category#26362) && (i_category#576 = i_category#26837)) && (i_brand#572 = i_brand#26358)) && ((i_brand#572 = i_brand#26833) && (s_store_name#669 = s_store_name#26519))) && ((((s_store_name#669 = s_store_name#26994) && (s_company_name#681 = s_company_name#26531)) && (s_company_name#681 = s_company_name#27006)) && ((rn#26051 = (rn#26163 + 1)) && (rn#26051 = (rn#26638 - 1)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `v1`
                        :  :  +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, sum_sales#26049, avg_monthly_sales#26050, rn#26051]
                        :  :     +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, sum_sales#26049, _w0#26063, rn#26051, avg_monthly_sales#26050, avg_monthly_sales#26050, rn#26051]
                        :  :        +- Window [avg(_w0#26063) windowspecdefinition(i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#26050], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498]
                        :  :           +- Window [rank(d_year#498, d_moy#500) windowspecdefinition(i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#26051], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681], [d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST]
                        :  :              +- Aggregate [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, sum(ss_sales_price#143) AS sum_sales#26049, sum(ss_sales_price#143) AS _w0#26063]
                        :  :                 +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((ss_store_sk#137 = s_store_sk#664) && (((d_year#498 = 1999) || ((d_year#498 = (1999 - 1)) && (d_moy#500 = 12))) || ((d_year#498 = (1999 + 1)) && (d_moy#500 = 1)))))
                        :  :                    +- Join Inner
                        :  :                       :- Join Inner
                        :  :                       :  :- Join Inner
                        :  :                       :  :  :- SubqueryAlias `item`
                        :  :                       :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        :  :                       :  :  +- SubqueryAlias `store_sales`
                        :  :                       :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :                       :  +- SubqueryAlias `date_dim`
                        :  :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :                       +- SubqueryAlias `store`
                        :  :                          +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  +- SubqueryAlias `v1_lag`
                        :     +- SubqueryAlias `v1`
                        :        +- Project [i_category#26362, i_brand#26358, s_store_name#26519, s_company_name#26531, d_year#26447, d_moy#26449, sum_sales#26257, avg_monthly_sales#26068, rn#26163]
                        :           +- Project [i_category#26362, i_brand#26358, s_store_name#26519, s_company_name#26531, d_year#26447, d_moy#26449, sum_sales#26257, _w0#26258, rn#26163, avg_monthly_sales#26068, avg_monthly_sales#26068, rn#26163]
                        :              +- Window [avg(_w0#26258) windowspecdefinition(i_category#26362, i_brand#26358, s_store_name#26519, s_company_name#26531, d_year#26447, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#26068], [i_category#26362, i_brand#26358, s_store_name#26519, s_company_name#26531, d_year#26447]
                        :                 +- Window [rank(d_year#26447, d_moy#26449) windowspecdefinition(i_category#26362, i_brand#26358, s_store_name#26519, s_company_name#26531, d_year#26447 ASC NULLS FIRST, d_moy#26449 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#26163], [i_category#26362, i_brand#26358, s_store_name#26519, s_company_name#26531], [d_year#26447 ASC NULLS FIRST, d_moy#26449 ASC NULLS FIRST]
                        :                    +- Aggregate [i_category#26362, i_brand#26358, s_store_name#26519, s_company_name#26531, d_year#26447, d_moy#26449], [i_category#26362, i_brand#26358, s_store_name#26519, s_company_name#26531, d_year#26447, d_moy#26449, sum(ss_sales_price#143) AS sum_sales#26257, sum(ss_sales_price#143) AS _w0#26258]
                        :                       +- Filter (((ss_item_sk#132 = i_item_sk#26350) && (ss_sold_date_sk#130 = d_date_sk#26441)) && ((ss_store_sk#137 = s_store_sk#26514) && (((d_year#26447 = 1999) || ((d_year#26447 = (1999 - 1)) && (d_moy#26449 = 12))) || ((d_year#26447 = (1999 + 1)) && (d_moy#26449 = 1)))))
                        :                          +- Join Inner
                        :                             :- Join Inner
                        :                             :  :- Join Inner
                        :                             :  :  :- SubqueryAlias `item`
                        :                             :  :  :  +- Relation[i_item_sk#26350,i_item_id#26351,i_rec_start_date#26352,i_rec_end_date#26353,i_item_desc#26354,i_current_price#26355,i_wholesale_cost#26356,i_brand_id#26357,i_brand#26358,i_class_id#26359,i_class#26360,i_category_id#26361,i_category#26362,i_manufact_id#26363,i_manufact#26364,i_size#26365,i_formulation#26366,i_color#26367,i_units#26368,i_container#26369,i_manager_id#26370,i_product_name#26371] parquet
                        :                             :  :  +- SubqueryAlias `store_sales`
                        :                             :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :                             :  +- SubqueryAlias `date_dim`
                        :                             :     +- Relation[d_date_sk#26441,d_date_id#26442,d_date#26443,d_month_seq#26444,d_week_seq#26445,d_quarter_seq#26446,d_year#26447,d_dow#26448,d_moy#26449,d_dom#26450,d_qoy#26451,d_fy_year#26452,d_fy_quarter_seq#26453,d_fy_week_seq#26454,d_day_name#26455,d_quarter_name#26456,d_holiday#26457,d_weekend#26458,d_following_holiday#26459,d_first_dom#26460,d_last_dom#26461,d_same_day_ly#26462,d_same_day_lq#26463,d_current_day#26464,... 4 more fields] parquet
                        :                             +- SubqueryAlias `store`
                        :                                +- Relation[s_store_sk#26514,s_store_id#26515,s_rec_start_date#26516,s_rec_end_date#26517,s_closed_date_sk#26518,s_store_name#26519,s_number_employees#26520,s_floor_space#26521,s_hours#26522,s_manager#26523,s_market_id#26524,s_geography_class#26525,s_market_desc#26526,s_market_manager#26527,s_division_id#26528,s_division_name#26529,s_company_id#26530,s_company_name#26531,s_street_number#26532,s_street_name#26533,s_street_type#26534,s_suite_number#26535,s_city#26536,s_county#26537,... 5 more fields] parquet
                        +- SubqueryAlias `v1_lead`
                           +- SubqueryAlias `v1`
                              +- Project [i_category#26837, i_brand#26833, s_store_name#26994, s_company_name#27006, d_year#26922, d_moy#26924, sum_sales#26732, avg_monthly_sales#26543, rn#26638]
                                 +- Project [i_category#26837, i_brand#26833, s_store_name#26994, s_company_name#27006, d_year#26922, d_moy#26924, sum_sales#26732, _w0#26733, rn#26638, avg_monthly_sales#26543, avg_monthly_sales#26543, rn#26638]
                                    +- Window [avg(_w0#26733) windowspecdefinition(i_category#26837, i_brand#26833, s_store_name#26994, s_company_name#27006, d_year#26922, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#26543], [i_category#26837, i_brand#26833, s_store_name#26994, s_company_name#27006, d_year#26922]
                                       +- Window [rank(d_year#26922, d_moy#26924) windowspecdefinition(i_category#26837, i_brand#26833, s_store_name#26994, s_company_name#27006, d_year#26922 ASC NULLS FIRST, d_moy#26924 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#26638], [i_category#26837, i_brand#26833, s_store_name#26994, s_company_name#27006], [d_year#26922 ASC NULLS FIRST, d_moy#26924 ASC NULLS FIRST]
                                          +- Aggregate [i_category#26837, i_brand#26833, s_store_name#26994, s_company_name#27006, d_year#26922, d_moy#26924], [i_category#26837, i_brand#26833, s_store_name#26994, s_company_name#27006, d_year#26922, d_moy#26924, sum(ss_sales_price#143) AS sum_sales#26732, sum(ss_sales_price#143) AS _w0#26733]
                                             +- Filter (((ss_item_sk#132 = i_item_sk#26825) && (ss_sold_date_sk#130 = d_date_sk#26916)) && ((ss_store_sk#137 = s_store_sk#26989) && (((d_year#26922 = 1999) || ((d_year#26922 = (1999 - 1)) && (d_moy#26924 = 12))) || ((d_year#26922 = (1999 + 1)) && (d_moy#26924 = 1)))))
                                                +- Join Inner
                                                   :- Join Inner
                                                   :  :- Join Inner
                                                   :  :  :- SubqueryAlias `item`
                                                   :  :  :  +- Relation[i_item_sk#26825,i_item_id#26826,i_rec_start_date#26827,i_rec_end_date#26828,i_item_desc#26829,i_current_price#26830,i_wholesale_cost#26831,i_brand_id#26832,i_brand#26833,i_class_id#26834,i_class#26835,i_category_id#26836,i_category#26837,i_manufact_id#26838,i_manufact#26839,i_size#26840,i_formulation#26841,i_color#26842,i_units#26843,i_container#26844,i_manager_id#26845,i_product_name#26846] parquet
                                                   :  :  +- SubqueryAlias `store_sales`
                                                   :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                                   :  +- SubqueryAlias `date_dim`
                                                   :     +- Relation[d_date_sk#26916,d_date_id#26917,d_date#26918,d_month_seq#26919,d_week_seq#26920,d_quarter_seq#26921,d_year#26922,d_dow#26923,d_moy#26924,d_dom#26925,d_qoy#26926,d_fy_year#26927,d_fy_quarter_seq#26928,d_fy_week_seq#26929,d_day_name#26930,d_quarter_name#26931,d_holiday#26932,d_weekend#26933,d_following_holiday#26934,d_first_dom#26935,d_last_dom#26936,d_same_day_ly#26937,d_same_day_lq#26938,d_current_day#26939,... 4 more fields] parquet
                                                   +- SubqueryAlias `store`
                                                      +- Relation[s_store_sk#26989,s_store_id#26990,s_rec_start_date#26991,s_rec_end_date#26992,s_closed_date_sk#26993,s_store_name#26994,s_number_employees#26995,s_floor_space#26996,s_hours#26997,s_manager#26998,s_market_id#26999,s_geography_class#27000,s_market_desc#27001,s_market_manager#27002,s_division_id#27003,s_division_name#27004,s_company_id#27005,s_company_name#27006,s_street_number#27007,s_street_name#27008,s_street_type#27009,s_suite_number#27010,s_city#27011,s_county#27012,... 5 more fields] parquet

     : benchmark
19/09/08 18:24:44 INFO Query: 
== Query: q47-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#27124 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#27125 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
      +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, avg_monthly_sales#27125, sum_sales#27124, psum#27127, nsum#27128]
         +- Filter (((d_year#498 = 1999) && (cast(avg_monthly_sales#27125 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6)))) && (cast(CASE WHEN (cast(avg_monthly_sales#27125 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#27124 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#27125 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#27125 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16))))
            +- SubqueryAlias `v2`
               +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, avg_monthly_sales#27125, sum_sales#27124, sum_sales#27332 AS psum#27127, sum_sales#27807 AS nsum#27128]
                  +- Filter (((((i_category#576 = i_category#27437) && (i_category#576 = i_category#27912)) && (i_brand#572 = i_brand#27433)) && ((i_brand#572 = i_brand#27908) && (s_store_name#669 = s_store_name#27594))) && ((((s_store_name#669 = s_store_name#28069) && (s_company_name#681 = s_company_name#27606)) && (s_company_name#681 = s_company_name#28081)) && ((rn#27126 = (rn#27238 + 1)) && (rn#27126 = (rn#27713 - 1)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `v1`
                        :  :  +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, sum_sales#27124, avg_monthly_sales#27125, rn#27126]
                        :  :     +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, sum_sales#27124, _w0#27138, rn#27126, avg_monthly_sales#27125, avg_monthly_sales#27125, rn#27126]
                        :  :        +- Window [avg(_w0#27138) windowspecdefinition(i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#27125], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498]
                        :  :           +- Window [rank(d_year#498, d_moy#500) windowspecdefinition(i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#27126], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681], [d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST]
                        :  :              +- Aggregate [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, sum(ss_sales_price#143) AS sum_sales#27124, sum(ss_sales_price#143) AS _w0#27138]
                        :  :                 +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((ss_store_sk#137 = s_store_sk#664) && (((d_year#498 = 1999) || ((d_year#498 = (1999 - 1)) && (d_moy#500 = 12))) || ((d_year#498 = (1999 + 1)) && (d_moy#500 = 1)))))
                        :  :                    +- Join Inner
                        :  :                       :- Join Inner
                        :  :                       :  :- Join Inner
                        :  :                       :  :  :- SubqueryAlias `item`
                        :  :                       :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        :  :                       :  :  +- SubqueryAlias `store_sales`
                        :  :                       :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :                       :  +- SubqueryAlias `date_dim`
                        :  :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :                       +- SubqueryAlias `store`
                        :  :                          +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  +- SubqueryAlias `v1_lag`
                        :     +- SubqueryAlias `v1`
                        :        +- Project [i_category#27437, i_brand#27433, s_store_name#27594, s_company_name#27606, d_year#27522, d_moy#27524, sum_sales#27332, avg_monthly_sales#27143, rn#27238]
                        :           +- Project [i_category#27437, i_brand#27433, s_store_name#27594, s_company_name#27606, d_year#27522, d_moy#27524, sum_sales#27332, _w0#27333, rn#27238, avg_monthly_sales#27143, avg_monthly_sales#27143, rn#27238]
                        :              +- Window [avg(_w0#27333) windowspecdefinition(i_category#27437, i_brand#27433, s_store_name#27594, s_company_name#27606, d_year#27522, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#27143], [i_category#27437, i_brand#27433, s_store_name#27594, s_company_name#27606, d_year#27522]
                        :                 +- Window [rank(d_year#27522, d_moy#27524) windowspecdefinition(i_category#27437, i_brand#27433, s_store_name#27594, s_company_name#27606, d_year#27522 ASC NULLS FIRST, d_moy#27524 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#27238], [i_category#27437, i_brand#27433, s_store_name#27594, s_company_name#27606], [d_year#27522 ASC NULLS FIRST, d_moy#27524 ASC NULLS FIRST]
                        :                    +- Aggregate [i_category#27437, i_brand#27433, s_store_name#27594, s_company_name#27606, d_year#27522, d_moy#27524], [i_category#27437, i_brand#27433, s_store_name#27594, s_company_name#27606, d_year#27522, d_moy#27524, sum(ss_sales_price#143) AS sum_sales#27332, sum(ss_sales_price#143) AS _w0#27333]
                        :                       +- Filter (((ss_item_sk#132 = i_item_sk#27425) && (ss_sold_date_sk#130 = d_date_sk#27516)) && ((ss_store_sk#137 = s_store_sk#27589) && (((d_year#27522 = 1999) || ((d_year#27522 = (1999 - 1)) && (d_moy#27524 = 12))) || ((d_year#27522 = (1999 + 1)) && (d_moy#27524 = 1)))))
                        :                          +- Join Inner
                        :                             :- Join Inner
                        :                             :  :- Join Inner
                        :                             :  :  :- SubqueryAlias `item`
                        :                             :  :  :  +- Relation[i_item_sk#27425,i_item_id#27426,i_rec_start_date#27427,i_rec_end_date#27428,i_item_desc#27429,i_current_price#27430,i_wholesale_cost#27431,i_brand_id#27432,i_brand#27433,i_class_id#27434,i_class#27435,i_category_id#27436,i_category#27437,i_manufact_id#27438,i_manufact#27439,i_size#27440,i_formulation#27441,i_color#27442,i_units#27443,i_container#27444,i_manager_id#27445,i_product_name#27446] parquet
                        :                             :  :  +- SubqueryAlias `store_sales`
                        :                             :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :                             :  +- SubqueryAlias `date_dim`
                        :                             :     +- Relation[d_date_sk#27516,d_date_id#27517,d_date#27518,d_month_seq#27519,d_week_seq#27520,d_quarter_seq#27521,d_year#27522,d_dow#27523,d_moy#27524,d_dom#27525,d_qoy#27526,d_fy_year#27527,d_fy_quarter_seq#27528,d_fy_week_seq#27529,d_day_name#27530,d_quarter_name#27531,d_holiday#27532,d_weekend#27533,d_following_holiday#27534,d_first_dom#27535,d_last_dom#27536,d_same_day_ly#27537,d_same_day_lq#27538,d_current_day#27539,... 4 more fields] parquet
                        :                             +- SubqueryAlias `store`
                        :                                +- Relation[s_store_sk#27589,s_store_id#27590,s_rec_start_date#27591,s_rec_end_date#27592,s_closed_date_sk#27593,s_store_name#27594,s_number_employees#27595,s_floor_space#27596,s_hours#27597,s_manager#27598,s_market_id#27599,s_geography_class#27600,s_market_desc#27601,s_market_manager#27602,s_division_id#27603,s_division_name#27604,s_company_id#27605,s_company_name#27606,s_street_number#27607,s_street_name#27608,s_street_type#27609,s_suite_number#27610,s_city#27611,s_county#27612,... 5 more fields] parquet
                        +- SubqueryAlias `v1_lead`
                           +- SubqueryAlias `v1`
                              +- Project [i_category#27912, i_brand#27908, s_store_name#28069, s_company_name#28081, d_year#27997, d_moy#27999, sum_sales#27807, avg_monthly_sales#27618, rn#27713]
                                 +- Project [i_category#27912, i_brand#27908, s_store_name#28069, s_company_name#28081, d_year#27997, d_moy#27999, sum_sales#27807, _w0#27808, rn#27713, avg_monthly_sales#27618, avg_monthly_sales#27618, rn#27713]
                                    +- Window [avg(_w0#27808) windowspecdefinition(i_category#27912, i_brand#27908, s_store_name#28069, s_company_name#28081, d_year#27997, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#27618], [i_category#27912, i_brand#27908, s_store_name#28069, s_company_name#28081, d_year#27997]
                                       +- Window [rank(d_year#27997, d_moy#27999) windowspecdefinition(i_category#27912, i_brand#27908, s_store_name#28069, s_company_name#28081, d_year#27997 ASC NULLS FIRST, d_moy#27999 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#27713], [i_category#27912, i_brand#27908, s_store_name#28069, s_company_name#28081], [d_year#27997 ASC NULLS FIRST, d_moy#27999 ASC NULLS FIRST]
                                          +- Aggregate [i_category#27912, i_brand#27908, s_store_name#28069, s_company_name#28081, d_year#27997, d_moy#27999], [i_category#27912, i_brand#27908, s_store_name#28069, s_company_name#28081, d_year#27997, d_moy#27999, sum(ss_sales_price#143) AS sum_sales#27807, sum(ss_sales_price#143) AS _w0#27808]
                                             +- Filter (((ss_item_sk#132 = i_item_sk#27900) && (ss_sold_date_sk#130 = d_date_sk#27991)) && ((ss_store_sk#137 = s_store_sk#28064) && (((d_year#27997 = 1999) || ((d_year#27997 = (1999 - 1)) && (d_moy#27999 = 12))) || ((d_year#27997 = (1999 + 1)) && (d_moy#27999 = 1)))))
                                                +- Join Inner
                                                   :- Join Inner
                                                   :  :- Join Inner
                                                   :  :  :- SubqueryAlias `item`
                                                   :  :  :  +- Relation[i_item_sk#27900,i_item_id#27901,i_rec_start_date#27902,i_rec_end_date#27903,i_item_desc#27904,i_current_price#27905,i_wholesale_cost#27906,i_brand_id#27907,i_brand#27908,i_class_id#27909,i_class#27910,i_category_id#27911,i_category#27912,i_manufact_id#27913,i_manufact#27914,i_size#27915,i_formulation#27916,i_color#27917,i_units#27918,i_container#27919,i_manager_id#27920,i_product_name#27921] parquet
                                                   :  :  +- SubqueryAlias `store_sales`
                                                   :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                                   :  +- SubqueryAlias `date_dim`
                                                   :     +- Relation[d_date_sk#27991,d_date_id#27992,d_date#27993,d_month_seq#27994,d_week_seq#27995,d_quarter_seq#27996,d_year#27997,d_dow#27998,d_moy#27999,d_dom#28000,d_qoy#28001,d_fy_year#28002,d_fy_quarter_seq#28003,d_fy_week_seq#28004,d_day_name#28005,d_quarter_name#28006,d_holiday#28007,d_weekend#28008,d_following_holiday#28009,d_first_dom#28010,d_last_dom#28011,d_same_day_ly#28012,d_same_day_lq#28013,d_current_day#28014,... 4 more fields] parquet
                                                   +- SubqueryAlias `store`
                                                      +- Relation[s_store_sk#28064,s_store_id#28065,s_rec_start_date#28066,s_rec_end_date#28067,s_closed_date_sk#28068,s_store_name#28069,s_number_employees#28070,s_floor_space#28071,s_hours#28072,s_manager#28073,s_market_id#28074,s_geography_class#28075,s_market_desc#28076,s_market_manager#28077,s_division_id#28078,s_division_name#28079,s_company_id#28080,s_company_name#28081,s_street_number#28082,s_street_name#28083,s_street_type#28084,s_suite_number#28085,s_city#28086,s_county#28087,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 8.332887496s
Running execution q48-v2.4 iteration: 1, StandardRun=true
19/09/08 18:24:55 INFO Query: 
== Query: q48-v2.4 ==
Aggregate [sum(cast(ss_quantity#140 as bigint)) AS sum(ss_quantity)#30375L]
+- Filter ((((s_store_sk#664 = ss_store_sk#137) && (ss_sold_date_sk#130 = d_date_sk#492)) && (d_year#498 = 2000)) && ((((((cd_demo_sk#474 = ss_cdemo_sk#134) && (cd_marital_status#476 = M)) && ((cd_education_status#477 = 4 yr Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(100.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(150.00 as decimal(7,2)))))) || (((cd_demo_sk#474 = ss_cdemo_sk#134) && (cd_marital_status#476 = D)) && ((cd_education_status#477 = 2 yr Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(50.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(100.00 as decimal(7,2))))))) || (((cd_demo_sk#474 = ss_cdemo_sk#134) && (cd_marital_status#476 = S)) && ((cd_education_status#477 = College) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(150.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(200.00 as decimal(7,2))))))) && (((((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (CO,OH,TX) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(2000 as decimal(4,0)) as decimal(7,2)))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (OR,MN,KY) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(150 as decimal(3,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(3000 as decimal(4,0)) as decimal(7,2))))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (VA,CA,MS) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(25000 as decimal(5,0)) as decimal(7,2)))))))))
   +- Join Inner
      :- Join Inner
      :  :- Join Inner
      :  :  :- Join Inner
      :  :  :  :- SubqueryAlias `store_sales`
      :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
      :  :  :  +- SubqueryAlias `store`
      :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
      :  :  +- SubqueryAlias `customer_demographics`
      :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
      :  +- SubqueryAlias `customer_address`
      :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
      +- SubqueryAlias `date_dim`
         +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:24:55 INFO Query: 
== Query: q48-v2.4 ==
Aggregate [sum(cast(ss_quantity#140 as bigint)) AS sum(ss_quantity)#30378L]
+- Filter ((((s_store_sk#664 = ss_store_sk#137) && (ss_sold_date_sk#130 = d_date_sk#492)) && (d_year#498 = 2000)) && ((((((cd_demo_sk#474 = ss_cdemo_sk#134) && (cd_marital_status#476 = M)) && ((cd_education_status#477 = 4 yr Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(100.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(150.00 as decimal(7,2)))))) || (((cd_demo_sk#474 = ss_cdemo_sk#134) && (cd_marital_status#476 = D)) && ((cd_education_status#477 = 2 yr Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(50.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(100.00 as decimal(7,2))))))) || (((cd_demo_sk#474 = ss_cdemo_sk#134) && (cd_marital_status#476 = S)) && ((cd_education_status#477 = College) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(150.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(200.00 as decimal(7,2))))))) && (((((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (CO,OH,TX) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(2000 as decimal(4,0)) as decimal(7,2)))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (OR,MN,KY) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(150 as decimal(3,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(3000 as decimal(4,0)) as decimal(7,2))))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (VA,CA,MS) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(25000 as decimal(5,0)) as decimal(7,2)))))))))
   +- Join Inner
      :- Join Inner
      :  :- Join Inner
      :  :  :- Join Inner
      :  :  :  :- SubqueryAlias `store_sales`
      :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
      :  :  :  +- SubqueryAlias `store`
      :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
      :  :  +- SubqueryAlias `customer_demographics`
      :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
      :  +- SubqueryAlias `customer_address`
      :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
      +- SubqueryAlias `date_dim`
         +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 6.907831491s
Running execution q49-v2.4 iteration: 1, StandardRun=true
19/09/08 18:25:03 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 18:25:03 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 18:25:03 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 18:25:03 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 18:25:03 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 18:25:03 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 18:25:03 INFO Query: 
== Query: q49-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#30543 ASC NULLS FIRST, return_rank#30541 ASC NULLS FIRST, currency_rank#30542 ASC NULLS FIRST], true
      +- Distinct
         +- Union
            :- Distinct
            :  +- Union
            :     :- Project [web AS channel#30543, item#30538, return_ratio#30539, return_rank#30541, currency_rank#30542]
            :     :  +- Filter ((return_rank#30541 <= 10) || (currency_rank#30542 <= 10))
            :     :     +- SubqueryAlias `web`
            :     :        +- Project [item#30538, return_ratio#30539, currency_ratio#30540, return_rank#30541, currency_rank#30542]
            :     :           +- Project [item#30538, return_ratio#30539, currency_ratio#30540, currency_rank#30542, return_rank#30541, return_rank#30541, currency_rank#30542]
            :     :              +- Window [rank(return_ratio#30539) windowspecdefinition(return_ratio#30539 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#30541], [return_ratio#30539 ASC NULLS FIRST]
            :     :                 +- Window [rank(currency_ratio#30540) windowspecdefinition(currency_ratio#30540 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#30542], [currency_ratio#30540 ASC NULLS FIRST]
            :     :                    +- Project [item#30538, return_ratio#30539, currency_ratio#30540]
            :     :                       +- SubqueryAlias `in_web`
            :     :                          +- Aggregate [ws_item_sk#219], [ws_item_sk#219 AS item#30538, CheckOverflow((promote_precision(cast(cast(sum(cast(coalesce(wr_return_quantity#298, 0) as bigint)) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(cast(coalesce(ws_quantity#234, 0) as bigint)) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#30539, CheckOverflow((promote_precision(cast(cast(sum(coalesce(cast(wr_return_amt#299 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(coalesce(cast(ws_net_paid#245 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#30540]
            :     :                             +- Filter ((((cast(wr_return_amt#299 as decimal(7,2)) > cast(cast(10000 as decimal(5,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) > cast(cast(1 as decimal(1,0)) as decimal(7,2)))) && ((cast(ws_net_paid#245 as decimal(7,2)) > cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (ws_quantity#234 > 0))) && (((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 2001)) && (d_moy#500 = 12)))
            :     :                                +- Join Inner
            :     :                                   :- Join LeftOuter, ((ws_order_number#233L = wr_order_number#297L) && (ws_item_sk#219 = wr_item_sk#286))
            :     :                                   :  :- SubqueryAlias `ws`
            :     :                                   :  :  +- SubqueryAlias `web_sales`
            :     :                                   :  :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :     :                                   :  +- SubqueryAlias `wr`
            :     :                                   :     +- SubqueryAlias `web_returns`
            :     :                                   :        +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
            :     :                                   +- SubqueryAlias `date_dim`
            :     :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     +- Project [catalog AS channel#30549, item#30544, return_ratio#30545, return_rank#30547, currency_rank#30548]
            :        +- Filter ((return_rank#30547 <= 10) || (currency_rank#30548 <= 10))
            :           +- SubqueryAlias `catalog`
            :              +- Project [item#30544, return_ratio#30545, currency_ratio#30546, return_rank#30547, currency_rank#30548]
            :                 +- Project [item#30544, return_ratio#30545, currency_ratio#30546, currency_rank#30548, return_rank#30547, return_rank#30547, currency_rank#30548]
            :                    +- Window [rank(return_ratio#30545) windowspecdefinition(return_ratio#30545 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#30547], [return_ratio#30545 ASC NULLS FIRST]
            :                       +- Window [rank(currency_ratio#30546) windowspecdefinition(currency_ratio#30546 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#30548], [currency_ratio#30546 ASC NULLS FIRST]
            :                          +- Project [item#30544, return_ratio#30545, currency_ratio#30546]
            :                             +- SubqueryAlias `in_cat`
            :                                +- Aggregate [cs_item_sk#15], [cs_item_sk#15 AS item#30544, CheckOverflow((promote_precision(cast(cast(sum(cast(coalesce(cr_return_quantity#85, 0) as bigint)) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(cast(coalesce(cs_quantity#18, 0) as bigint)) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#30545, CheckOverflow((promote_precision(cast(cast(sum(coalesce(cast(cr_return_amount#86 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(coalesce(cast(cs_net_paid#29 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#30546]
            :                                   +- Filter ((((cast(cr_return_amount#86 as decimal(7,2)) > cast(cast(10000 as decimal(5,0)) as decimal(7,2))) && (cast(cs_net_profit#33 as decimal(7,2)) > cast(cast(1 as decimal(1,0)) as decimal(7,2)))) && ((cast(cs_net_paid#29 as decimal(7,2)) > cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (cs_quantity#18 > 0))) && (((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 2001)) && (d_moy#500 = 12)))
            :                                      +- Join Inner
            :                                         :- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
            :                                         :  :- SubqueryAlias `cs`
            :                                         :  :  +- SubqueryAlias `catalog_sales`
            :                                         :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :                                         :  +- SubqueryAlias `cr`
            :                                         :     +- SubqueryAlias `catalog_returns`
            :                                         :        +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
            :                                         +- SubqueryAlias `date_dim`
            :                                            +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Project [store AS channel#30555, item#30550, return_ratio#30551, return_rank#30553, currency_rank#30554]
               +- Filter ((return_rank#30553 <= 10) || (currency_rank#30554 <= 10))
                  +- SubqueryAlias `store`
                     +- Project [item#30550, return_ratio#30551, currency_ratio#30552, return_rank#30553, currency_rank#30554]
                        +- Project [item#30550, return_ratio#30551, currency_ratio#30552, return_rank#30553, currency_rank#30554, return_rank#30553, currency_rank#30554]
                           +- Window [rank(currency_ratio#30552) windowspecdefinition(currency_ratio#30552 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#30554], [currency_ratio#30552 ASC NULLS FIRST]
                              +- Window [rank(return_ratio#30551) windowspecdefinition(return_ratio#30551 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#30553], [return_ratio#30551 ASC NULLS FIRST]
                                 +- Project [item#30550, return_ratio#30551, currency_ratio#30552]
                                    +- SubqueryAlias `in_store`
                                       +- Aggregate [ss_item_sk#132], [ss_item_sk#132 AS item#30550, CheckOverflow((promote_precision(cast(cast(sum(cast(coalesce(sr_return_quantity#186, 0) as bigint)) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(cast(coalesce(ss_quantity#140, 0) as bigint)) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#30551, CheckOverflow((promote_precision(cast(cast(sum(coalesce(cast(sr_return_amt#187 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(coalesce(cast(ss_net_paid#150 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#30552]
                                          +- Filter ((((cast(sr_return_amt#187 as decimal(7,2)) > cast(cast(10000 as decimal(5,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) > cast(cast(1 as decimal(1,0)) as decimal(7,2)))) && ((cast(ss_net_paid#150 as decimal(7,2)) > cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (ss_quantity#140 > 0))) && (((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 2001)) && (d_moy#500 = 12)))
                                             +- Join Inner
                                                :- Join LeftOuter, ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))
                                                :  :- SubqueryAlias `sts`
                                                :  :  +- SubqueryAlias `store_sales`
                                                :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                                :  +- SubqueryAlias `sr`
                                                :     +- SubqueryAlias `store_returns`
                                                :        +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                                                +- SubqueryAlias `date_dim`
                                                   +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:25:03 INFO Query: 
== Query: q49-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#30644 ASC NULLS FIRST, return_rank#30642 ASC NULLS FIRST, currency_rank#30643 ASC NULLS FIRST], true
      +- Distinct
         +- Union
            :- Distinct
            :  +- Union
            :     :- Project [web AS channel#30644, item#30639, return_ratio#30640, return_rank#30642, currency_rank#30643]
            :     :  +- Filter ((return_rank#30642 <= 10) || (currency_rank#30643 <= 10))
            :     :     +- SubqueryAlias `web`
            :     :        +- Project [item#30639, return_ratio#30640, currency_ratio#30641, return_rank#30642, currency_rank#30643]
            :     :           +- Project [item#30639, return_ratio#30640, currency_ratio#30641, return_rank#30642, currency_rank#30643, return_rank#30642, currency_rank#30643]
            :     :              +- Window [rank(currency_ratio#30641) windowspecdefinition(currency_ratio#30641 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#30643], [currency_ratio#30641 ASC NULLS FIRST]
            :     :                 +- Window [rank(return_ratio#30640) windowspecdefinition(return_ratio#30640 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#30642], [return_ratio#30640 ASC NULLS FIRST]
            :     :                    +- Project [item#30639, return_ratio#30640, currency_ratio#30641]
            :     :                       +- SubqueryAlias `in_web`
            :     :                          +- Aggregate [ws_item_sk#219], [ws_item_sk#219 AS item#30639, CheckOverflow((promote_precision(cast(cast(sum(cast(coalesce(wr_return_quantity#298, 0) as bigint)) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(cast(coalesce(ws_quantity#234, 0) as bigint)) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#30640, CheckOverflow((promote_precision(cast(cast(sum(coalesce(cast(wr_return_amt#299 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(coalesce(cast(ws_net_paid#245 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#30641]
            :     :                             +- Filter ((((cast(wr_return_amt#299 as decimal(7,2)) > cast(cast(10000 as decimal(5,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) > cast(cast(1 as decimal(1,0)) as decimal(7,2)))) && ((cast(ws_net_paid#245 as decimal(7,2)) > cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (ws_quantity#234 > 0))) && (((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 2001)) && (d_moy#500 = 12)))
            :     :                                +- Join Inner
            :     :                                   :- Join LeftOuter, ((ws_order_number#233L = wr_order_number#297L) && (ws_item_sk#219 = wr_item_sk#286))
            :     :                                   :  :- SubqueryAlias `ws`
            :     :                                   :  :  +- SubqueryAlias `web_sales`
            :     :                                   :  :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :     :                                   :  +- SubqueryAlias `wr`
            :     :                                   :     +- SubqueryAlias `web_returns`
            :     :                                   :        +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
            :     :                                   +- SubqueryAlias `date_dim`
            :     :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     +- Project [catalog AS channel#30650, item#30645, return_ratio#30646, return_rank#30648, currency_rank#30649]
            :        +- Filter ((return_rank#30648 <= 10) || (currency_rank#30649 <= 10))
            :           +- SubqueryAlias `catalog`
            :              +- Project [item#30645, return_ratio#30646, currency_ratio#30647, return_rank#30648, currency_rank#30649]
            :                 +- Project [item#30645, return_ratio#30646, currency_ratio#30647, return_rank#30648, currency_rank#30649, return_rank#30648, currency_rank#30649]
            :                    +- Window [rank(currency_ratio#30647) windowspecdefinition(currency_ratio#30647 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#30649], [currency_ratio#30647 ASC NULLS FIRST]
            :                       +- Window [rank(return_ratio#30646) windowspecdefinition(return_ratio#30646 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#30648], [return_ratio#30646 ASC NULLS FIRST]
            :                          +- Project [item#30645, return_ratio#30646, currency_ratio#30647]
            :                             +- SubqueryAlias `in_cat`
            :                                +- Aggregate [cs_item_sk#15], [cs_item_sk#15 AS item#30645, CheckOverflow((promote_precision(cast(cast(sum(cast(coalesce(cr_return_quantity#85, 0) as bigint)) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(cast(coalesce(cs_quantity#18, 0) as bigint)) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#30646, CheckOverflow((promote_precision(cast(cast(sum(coalesce(cast(cr_return_amount#86 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(coalesce(cast(cs_net_paid#29 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#30647]
            :                                   +- Filter ((((cast(cr_return_amount#86 as decimal(7,2)) > cast(cast(10000 as decimal(5,0)) as decimal(7,2))) && (cast(cs_net_profit#33 as decimal(7,2)) > cast(cast(1 as decimal(1,0)) as decimal(7,2)))) && ((cast(cs_net_paid#29 as decimal(7,2)) > cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (cs_quantity#18 > 0))) && (((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 2001)) && (d_moy#500 = 12)))
            :                                      +- Join Inner
            :                                         :- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
            :                                         :  :- SubqueryAlias `cs`
            :                                         :  :  +- SubqueryAlias `catalog_sales`
            :                                         :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :                                         :  +- SubqueryAlias `cr`
            :                                         :     +- SubqueryAlias `catalog_returns`
            :                                         :        +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
            :                                         +- SubqueryAlias `date_dim`
            :                                            +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Project [store AS channel#30656, item#30651, return_ratio#30652, return_rank#30654, currency_rank#30655]
               +- Filter ((return_rank#30654 <= 10) || (currency_rank#30655 <= 10))
                  +- SubqueryAlias `store`
                     +- Project [item#30651, return_ratio#30652, currency_ratio#30653, return_rank#30654, currency_rank#30655]
                        +- Project [item#30651, return_ratio#30652, currency_ratio#30653, return_rank#30654, currency_rank#30655, return_rank#30654, currency_rank#30655]
                           +- Window [rank(currency_ratio#30653) windowspecdefinition(currency_ratio#30653 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#30655], [currency_ratio#30653 ASC NULLS FIRST]
                              +- Window [rank(return_ratio#30652) windowspecdefinition(return_ratio#30652 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#30654], [return_ratio#30652 ASC NULLS FIRST]
                                 +- Project [item#30651, return_ratio#30652, currency_ratio#30653]
                                    +- SubqueryAlias `in_store`
                                       +- Aggregate [ss_item_sk#132], [ss_item_sk#132 AS item#30651, CheckOverflow((promote_precision(cast(cast(sum(cast(coalesce(sr_return_quantity#186, 0) as bigint)) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(cast(coalesce(ss_quantity#140, 0) as bigint)) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#30652, CheckOverflow((promote_precision(cast(cast(sum(coalesce(cast(sr_return_amt#187 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(coalesce(cast(ss_net_paid#150 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#30653]
                                          +- Filter ((((cast(sr_return_amt#187 as decimal(7,2)) > cast(cast(10000 as decimal(5,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) > cast(cast(1 as decimal(1,0)) as decimal(7,2)))) && ((cast(ss_net_paid#150 as decimal(7,2)) > cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (ss_quantity#140 > 0))) && (((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 2001)) && (d_moy#500 = 12)))
                                             +- Join Inner
                                                :- Join LeftOuter, ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))
                                                :  :- SubqueryAlias `sts`
                                                :  :  +- SubqueryAlias `store_sales`
                                                :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                                :  +- SubqueryAlias `sr`
                                                :     +- SubqueryAlias `store_returns`
                                                :        +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                                                +- SubqueryAlias `date_dim`
                                                   +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
19/09/08 18:25:04 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 18:25:04 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 18:25:04 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 18:25:04 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 18:25:04 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 18:25:04 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
Execution time: 9.68022328s
Running execution q50-v2.4 iteration: 1, StandardRun=true
19/09/08 18:25:15 INFO Query: 
== Query: q50-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [s_store_name#669, s_company_id#680, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, 30 days#31064L, 31-60 days#31065L, 61-90 days#31066L, 91-120 days#31067L, >120 days#31068L]
      +- Sort [s_store_name#669 ASC NULLS FIRST, s_company_id#680 ASC NULLS FIRST, s_street_number#682 ASC NULLS FIRST, s_street_name#683 ASC NULLS FIRST, s_street_type#684 ASC NULLS FIRST, s_suite_number#685 ASC NULLS FIRST, s_city#686 ASC NULLS FIRST, s_county#687 ASC NULLS FIRST, s_state#688 ASC NULLS FIRST, s_zip#689 ASC NULLS FIRST], true
         +- Aggregate [s_store_name#669, s_company_id#680, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689], [s_store_name#669, s_company_id#680, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, sum(cast(CASE WHEN ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days#31064L, sum(cast(CASE WHEN (((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 30) && ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31-60 days#31065L, sum(cast(CASE WHEN (((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 60) && ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61-90 days#31066L, sum(cast(CASE WHEN (((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 90) && ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91-120 days#31067L, sum(cast(CASE WHEN ((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days#31068L]
            +- Filter ((((d_year#31075 = 2001) && (d_moy#31077 = 8)) && ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))) && (((ss_sold_date_sk#130 = d_date_sk#492) && (sr_returned_date_sk#176 = d_date_sk#31069)) && ((ss_customer_sk#133 = sr_customer_sk#179) && (ss_store_sk#137 = s_store_sk#664))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  +- SubqueryAlias `store_returns`
                  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :  +- SubqueryAlias `store`
                  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  :  +- SubqueryAlias `d1`
                  :     +- SubqueryAlias `date_dim`
                  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `d2`
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#31069,d_date_id#31070,d_date#31071,d_month_seq#31072,d_week_seq#31073,d_quarter_seq#31074,d_year#31075,d_dow#31076,d_moy#31077,d_dom#31078,d_qoy#31079,d_fy_year#31080,d_fy_quarter_seq#31081,d_fy_week_seq#31082,d_day_name#31083,d_quarter_name#31084,d_holiday#31085,d_weekend#31086,d_following_holiday#31087,d_first_dom#31088,d_last_dom#31089,d_same_day_ly#31090,d_same_day_lq#31091,d_current_day#31092,... 4 more fields] parquet

     : benchmark
19/09/08 18:25:15 INFO Query: 
== Query: q50-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [s_store_name#669, s_company_id#680, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, 30 days#31127L, 31-60 days#31128L, 61-90 days#31129L, 91-120 days#31130L, >120 days#31131L]
      +- Sort [s_store_name#669 ASC NULLS FIRST, s_company_id#680 ASC NULLS FIRST, s_street_number#682 ASC NULLS FIRST, s_street_name#683 ASC NULLS FIRST, s_street_type#684 ASC NULLS FIRST, s_suite_number#685 ASC NULLS FIRST, s_city#686 ASC NULLS FIRST, s_county#687 ASC NULLS FIRST, s_state#688 ASC NULLS FIRST, s_zip#689 ASC NULLS FIRST], true
         +- Aggregate [s_store_name#669, s_company_id#680, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689], [s_store_name#669, s_company_id#680, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, sum(cast(CASE WHEN ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days#31127L, sum(cast(CASE WHEN (((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 30) && ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31-60 days#31128L, sum(cast(CASE WHEN (((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 60) && ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61-90 days#31129L, sum(cast(CASE WHEN (((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 90) && ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91-120 days#31130L, sum(cast(CASE WHEN ((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days#31131L]
            +- Filter ((((d_year#31138 = 2001) && (d_moy#31140 = 8)) && ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))) && (((ss_sold_date_sk#130 = d_date_sk#492) && (sr_returned_date_sk#176 = d_date_sk#31132)) && ((ss_customer_sk#133 = sr_customer_sk#179) && (ss_store_sk#137 = s_store_sk#664))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  +- SubqueryAlias `store_returns`
                  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :  +- SubqueryAlias `store`
                  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  :  +- SubqueryAlias `d1`
                  :     +- SubqueryAlias `date_dim`
                  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `d2`
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#31132,d_date_id#31133,d_date#31134,d_month_seq#31135,d_week_seq#31136,d_quarter_seq#31137,d_year#31138,d_dow#31139,d_moy#31140,d_dom#31141,d_qoy#31142,d_fy_year#31143,d_fy_quarter_seq#31144,d_fy_week_seq#31145,d_day_name#31146,d_quarter_name#31147,d_holiday#31148,d_weekend#31149,d_following_holiday#31150,d_first_dom#31151,d_last_dom#31152,d_same_day_ly#31153,d_same_day_lq#31154,d_current_day#31155,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 7.225799367s
Running execution q51-v2.4 iteration: 1, StandardRun=true
19/09/08 18:25:23 INFO Query: 
== Query: q51-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_sk#31387 ASC NULLS FIRST, d_date#31388 ASC NULLS FIRST], true
      +- Project [item_sk#31387, d_date#31388, web_sales#31389, store_sales#31390, web_cumulative#31391, store_cumulative#31392]
         +- Filter (web_cumulative#31391 > store_cumulative#31392)
            +- SubqueryAlias `y`
               +- Project [item_sk#31387, d_date#31388, web_sales#31389, store_sales#31390, web_cumulative#31391, store_cumulative#31392]
                  +- Project [item_sk#31387, d_date#31388, web_sales#31389, store_sales#31390, web_cumulative#31391, store_cumulative#31392, web_cumulative#31391, store_cumulative#31392]
                     +- Window [max(web_sales#31389) windowspecdefinition(item_sk#31387, d_date#31388 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS web_cumulative#31391, max(store_sales#31390) windowspecdefinition(item_sk#31387, d_date#31388 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS store_cumulative#31392], [item_sk#31387], [d_date#31388 ASC NULLS FIRST]
                        +- Project [item_sk#31387, d_date#31388, web_sales#31389, store_sales#31390]
                           +- SubqueryAlias `x`
                              +- Project [CASE WHEN isnotnull(item_sk#31393) THEN item_sk#31393 ELSE item_sk#31395 END AS item_sk#31387, CASE WHEN isnotnull(d_date#494) THEN d_date#494 ELSE d_date#31405 END AS d_date#31388, cume_sales#31394 AS web_sales#31389, cume_sales#31396 AS store_sales#31390]
                                 +- Join FullOuter, ((item_sk#31393 = item_sk#31395) && (d_date#494 = d_date#31405))
                                    :- SubqueryAlias `web`
                                    :  +- SubqueryAlias `web_v1`
                                    :     +- Project [item_sk#31393, d_date#494, cume_sales#31394]
                                    :        +- Project [item_sk#31393, d_date#494, _w0#31399, ws_item_sk#219, cume_sales#31394, cume_sales#31394]
                                    :           +- Window [sum(_w0#31399) windowspecdefinition(ws_item_sk#219, d_date#494 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#31394], [ws_item_sk#219], [d_date#494 ASC NULLS FIRST]
                                    :              +- Aggregate [ws_item_sk#219, d_date#494], [ws_item_sk#219 AS item_sk#31393, d_date#494, sum(ws_sales_price#237) AS _w0#31399, ws_item_sk#219]
                                    :                 +- Filter (((ws_sold_date_sk#216 = d_date_sk#492) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11)))) && isnotnull(ws_item_sk#219))
                                    :                    +- Join Inner
                                    :                       :- SubqueryAlias `web_sales`
                                    :                       :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :                       +- SubqueryAlias `date_dim`
                                    :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                    +- SubqueryAlias `store`
                                       +- SubqueryAlias `store_v1`
                                          +- Project [item_sk#31395, d_date#31405, cume_sales#31396]
                                             +- Project [item_sk#31395, d_date#31405, _w0#31402, ss_item_sk#132, cume_sales#31396, cume_sales#31396]
                                                +- Window [sum(_w0#31402) windowspecdefinition(ss_item_sk#132, d_date#31405 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#31396], [ss_item_sk#132], [d_date#31405 ASC NULLS FIRST]
                                                   +- Aggregate [ss_item_sk#132, d_date#31405], [ss_item_sk#132 AS item_sk#31395, d_date#31405, sum(ss_sales_price#143) AS _w0#31402, ss_item_sk#132]
                                                      +- Filter (((ss_sold_date_sk#130 = d_date_sk#31403) && ((d_month_seq#31406 >= 1200) && (d_month_seq#31406 <= (1200 + 11)))) && isnotnull(ss_item_sk#132))
                                                         +- Join Inner
                                                            :- SubqueryAlias `store_sales`
                                                            :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                                            +- SubqueryAlias `date_dim`
                                                               +- Relation[d_date_sk#31403,d_date_id#31404,d_date#31405,d_month_seq#31406,d_week_seq#31407,d_quarter_seq#31408,d_year#31409,d_dow#31410,d_moy#31411,d_dom#31412,d_qoy#31413,d_fy_year#31414,d_fy_quarter_seq#31415,d_fy_week_seq#31416,d_day_name#31417,d_quarter_name#31418,d_holiday#31419,d_weekend#31420,d_following_holiday#31421,d_first_dom#31422,d_last_dom#31423,d_same_day_ly#31424,d_same_day_lq#31425,d_current_day#31426,... 4 more fields] parquet

     : benchmark
19/09/08 18:25:23 INFO Query: 
== Query: q51-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_sk#31439 ASC NULLS FIRST, d_date#31440 ASC NULLS FIRST], true
      +- Project [item_sk#31439, d_date#31440, web_sales#31441, store_sales#31442, web_cumulative#31443, store_cumulative#31444]
         +- Filter (web_cumulative#31443 > store_cumulative#31444)
            +- SubqueryAlias `y`
               +- Project [item_sk#31439, d_date#31440, web_sales#31441, store_sales#31442, web_cumulative#31443, store_cumulative#31444]
                  +- Project [item_sk#31439, d_date#31440, web_sales#31441, store_sales#31442, web_cumulative#31443, store_cumulative#31444, web_cumulative#31443, store_cumulative#31444]
                     +- Window [max(web_sales#31441) windowspecdefinition(item_sk#31439, d_date#31440 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS web_cumulative#31443, max(store_sales#31442) windowspecdefinition(item_sk#31439, d_date#31440 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS store_cumulative#31444], [item_sk#31439], [d_date#31440 ASC NULLS FIRST]
                        +- Project [item_sk#31439, d_date#31440, web_sales#31441, store_sales#31442]
                           +- SubqueryAlias `x`
                              +- Project [CASE WHEN isnotnull(item_sk#31445) THEN item_sk#31445 ELSE item_sk#31447 END AS item_sk#31439, CASE WHEN isnotnull(d_date#494) THEN d_date#494 ELSE d_date#31457 END AS d_date#31440, cume_sales#31446 AS web_sales#31441, cume_sales#31448 AS store_sales#31442]
                                 +- Join FullOuter, ((item_sk#31445 = item_sk#31447) && (d_date#494 = d_date#31457))
                                    :- SubqueryAlias `web`
                                    :  +- SubqueryAlias `web_v1`
                                    :     +- Project [item_sk#31445, d_date#494, cume_sales#31446]
                                    :        +- Project [item_sk#31445, d_date#494, _w0#31451, ws_item_sk#219, cume_sales#31446, cume_sales#31446]
                                    :           +- Window [sum(_w0#31451) windowspecdefinition(ws_item_sk#219, d_date#494 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#31446], [ws_item_sk#219], [d_date#494 ASC NULLS FIRST]
                                    :              +- Aggregate [ws_item_sk#219, d_date#494], [ws_item_sk#219 AS item_sk#31445, d_date#494, sum(ws_sales_price#237) AS _w0#31451, ws_item_sk#219]
                                    :                 +- Filter (((ws_sold_date_sk#216 = d_date_sk#492) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11)))) && isnotnull(ws_item_sk#219))
                                    :                    +- Join Inner
                                    :                       :- SubqueryAlias `web_sales`
                                    :                       :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :                       +- SubqueryAlias `date_dim`
                                    :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                    +- SubqueryAlias `store`
                                       +- SubqueryAlias `store_v1`
                                          +- Project [item_sk#31447, d_date#31457, cume_sales#31448]
                                             +- Project [item_sk#31447, d_date#31457, _w0#31454, ss_item_sk#132, cume_sales#31448, cume_sales#31448]
                                                +- Window [sum(_w0#31454) windowspecdefinition(ss_item_sk#132, d_date#31457 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#31448], [ss_item_sk#132], [d_date#31457 ASC NULLS FIRST]
                                                   +- Aggregate [ss_item_sk#132, d_date#31457], [ss_item_sk#132 AS item_sk#31447, d_date#31457, sum(ss_sales_price#143) AS _w0#31454, ss_item_sk#132]
                                                      +- Filter (((ss_sold_date_sk#130 = d_date_sk#31455) && ((d_month_seq#31458 >= 1200) && (d_month_seq#31458 <= (1200 + 11)))) && isnotnull(ss_item_sk#132))
                                                         +- Join Inner
                                                            :- SubqueryAlias `store_sales`
                                                            :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                                            +- SubqueryAlias `date_dim`
                                                               +- Relation[d_date_sk#31455,d_date_id#31456,d_date#31457,d_month_seq#31458,d_week_seq#31459,d_quarter_seq#31460,d_year#31461,d_dow#31462,d_moy#31463,d_dom#31464,d_qoy#31465,d_fy_year#31466,d_fy_quarter_seq#31467,d_fy_week_seq#31468,d_day_name#31469,d_quarter_name#31470,d_holiday#31471,d_weekend#31472,d_following_holiday#31473,d_first_dom#31474,d_last_dom#31475,d_same_day_ly#31476,d_same_day_lq#31477,d_current_day#31478,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 11.192502804s
Running execution q52-v2.4 iteration: 1, StandardRun=true
19/09/08 18:25:35 INFO Query: 
== Query: q52-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [d_year#498 ASC NULLS FIRST, ext_price#31619 DESC NULLS LAST, brand_id#31617 ASC NULLS FIRST], true
      +- Aggregate [d_year#498, i_brand#572, i_brand_id#571], [d_year#498, i_brand_id#571 AS brand_id#31617, i_brand#572 AS brand#31618, sum(ss_ext_sales_price#145) AS ext_price#31619]
         +- Filter ((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 1)) && ((d_moy#500 = 11) && (d_year#498 = 2000)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dt`
               :  :  +- SubqueryAlias `date_dim`
               :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:25:35 INFO Query: 
== Query: q52-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [d_year#498 ASC NULLS FIRST, ext_price#31630 DESC NULLS LAST, brand_id#31628 ASC NULLS FIRST], true
      +- Aggregate [d_year#498, i_brand#572, i_brand_id#571], [d_year#498, i_brand_id#571 AS brand_id#31628, i_brand#572 AS brand#31629, sum(ss_ext_sales_price#145) AS ext_price#31630]
         +- Filter ((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 1)) && ((d_moy#500 = 11) && (d_year#498 = 2000)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dt`
               :  :  +- SubqueryAlias `date_dim`
               :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 2.013670603s
Running execution q53-v2.4 iteration: 1, StandardRun=true
19/09/08 18:25:38 INFO Query: 
== Query: q53-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [avg_quarterly_sales#31676 ASC NULLS FIRST, sum_sales#31675 ASC NULLS FIRST, i_manufact_id#577 ASC NULLS FIRST], true
      +- Project [i_manufact_id#577, sum_sales#31675, avg_quarterly_sales#31676]
         +- Filter (cast(CASE WHEN (cast(avg_quarterly_sales#31676 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#31675 as decimal(22,6))) - promote_precision(cast(avg_quarterly_sales#31676 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_quarterly_sales#31676 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16)))
            +- SubqueryAlias `tmp1`
               +- Project [i_manufact_id#577, sum_sales#31675, avg_quarterly_sales#31676]
                  +- Project [i_manufact_id#577, sum_sales#31675, _w0#31680, avg_quarterly_sales#31676, avg_quarterly_sales#31676]
                     +- Window [avg(_w0#31680) windowspecdefinition(i_manufact_id#577, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_quarterly_sales#31676], [i_manufact_id#577]
                        +- Aggregate [i_manufact_id#577, d_qoy#502], [i_manufact_id#577, sum(ss_sales_price#143) AS sum_sales#31675, sum(ss_sales_price#143) AS _w0#31680]
                           +- Filter ((((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_store_sk#137 = s_store_sk#664)) && (d_month_seq#495 IN (1200,(1200 + 1),(1200 + 2),(1200 + 3),(1200 + 4),(1200 + 5),(1200 + 6),(1200 + 7),(1200 + 8),(1200 + 9),(1200 + 10),(1200 + 11)) && (((i_category#576 IN (Books,Children,Electronics) && i_class#574 IN (personal,portable,reference,self-help)) && i_brand#572 IN (scholaramalgamalg #14,scholaramalgamalg #7,exportiunivamalg #9,scholaramalgamalg #9)) || ((i_category#576 IN (Women,Music,Men) && i_class#574 IN (accessories,classical,fragrances,pants)) && i_brand#572 IN (amalgimporto #1,edu packscholar #1,exportiimporto #1,importoamalg #1)))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `item`
                                 :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :  :  +- SubqueryAlias `store_sales`
                                 :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `date_dim`
                                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- SubqueryAlias `store`
                                    +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/09/08 18:25:38 INFO Query: 
== Query: q53-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [avg_quarterly_sales#31685 ASC NULLS FIRST, sum_sales#31684 ASC NULLS FIRST, i_manufact_id#577 ASC NULLS FIRST], true
      +- Project [i_manufact_id#577, sum_sales#31684, avg_quarterly_sales#31685]
         +- Filter (cast(CASE WHEN (cast(avg_quarterly_sales#31685 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#31684 as decimal(22,6))) - promote_precision(cast(avg_quarterly_sales#31685 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_quarterly_sales#31685 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16)))
            +- SubqueryAlias `tmp1`
               +- Project [i_manufact_id#577, sum_sales#31684, avg_quarterly_sales#31685]
                  +- Project [i_manufact_id#577, sum_sales#31684, _w0#31689, avg_quarterly_sales#31685, avg_quarterly_sales#31685]
                     +- Window [avg(_w0#31689) windowspecdefinition(i_manufact_id#577, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_quarterly_sales#31685], [i_manufact_id#577]
                        +- Aggregate [i_manufact_id#577, d_qoy#502], [i_manufact_id#577, sum(ss_sales_price#143) AS sum_sales#31684, sum(ss_sales_price#143) AS _w0#31689]
                           +- Filter ((((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_store_sk#137 = s_store_sk#664)) && (d_month_seq#495 IN (1200,(1200 + 1),(1200 + 2),(1200 + 3),(1200 + 4),(1200 + 5),(1200 + 6),(1200 + 7),(1200 + 8),(1200 + 9),(1200 + 10),(1200 + 11)) && (((i_category#576 IN (Books,Children,Electronics) && i_class#574 IN (personal,portable,reference,self-help)) && i_brand#572 IN (scholaramalgamalg #14,scholaramalgamalg #7,exportiunivamalg #9,scholaramalgamalg #9)) || ((i_category#576 IN (Women,Music,Men) && i_class#574 IN (accessories,classical,fragrances,pants)) && i_brand#572 IN (amalgimporto #1,edu packscholar #1,exportiimporto #1,importoamalg #1)))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `item`
                                 :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :  :  +- SubqueryAlias `store_sales`
                                 :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `date_dim`
                                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- SubqueryAlias `store`
                                    +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 2.698091456s
Running execution q54-v2.4 iteration: 1, StandardRun=true
19/09/08 18:25:42 INFO Query: 
== Query: q54-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [segment#31750 ASC NULLS FIRST, num_customers#31739L ASC NULLS FIRST], true
      +- Aggregate [segment#31750], [segment#31750, count(1) AS num_customers#31739L, (segment#31750 * 50) AS segment_base#31740]
         +- SubqueryAlias `segments`
            +- Project [cast(CheckOverflow((promote_precision(cast(revenue#31747 as decimal(17,2))) / promote_precision(cast(cast(50 as decimal(2,0)) as decimal(17,2)))), DecimalType(21,6)) as int) AS segment#31750]
               +- SubqueryAlias `my_revenue`
                  +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(ss_ext_sales_price#145) AS revenue#31747]
                     +- Filter ((((c_current_addr_sk#416 = ca_address_sk#448) && (ca_county#455 = s_county#687)) && (ca_state#456 = s_state#688)) && (((ss_sold_date_sk#130 = d_date_sk#492) && (c_customer_sk#412 = ss_customer_sk#133)) && ((d_month_seq#495 >= scalar-subquery#31748 []) && (d_month_seq#495 <= scalar-subquery#31749 []))))
                        :  :- Distinct
                        :  :  +- Project [(d_month_seq#495 + 1) AS (d_month_seq + 1)#31751]
                        :  :     +- Filter ((d_year#498 = 1998) && (d_moy#500 = 12))
                        :  :        +- SubqueryAlias `date_dim`
                        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  +- Distinct
                        :     +- Project [(d_month_seq#495 + 3) AS (d_month_seq + 3)#31752]
                        :        +- Filter ((d_year#498 = 1998) && (d_moy#500 = 12))
                        :           +- SubqueryAlias `date_dim`
                        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Join Inner
                           :- Join Inner
                           :  :- Join Inner
                           :  :  :- Join Inner
                           :  :  :  :- SubqueryAlias `my_customers`
                           :  :  :  :  +- Distinct
                           :  :  :  :     +- Project [c_customer_sk#412, c_current_addr_sk#416]
                           :  :  :  :        +- Filter ((((sold_date_sk#31741 = d_date_sk#492) && (item_sk#31743 = i_item_sk#564)) && ((i_category#576 = Women) && (i_class#574 = maternity))) && (((c_customer_sk#412 = customer_sk#31742) && (d_moy#500 = 12)) && (d_year#498 = 1998)))
                           :  :  :  :           +- Join Inner
                           :  :  :  :              :- Join Inner
                           :  :  :  :              :  :- Join Inner
                           :  :  :  :              :  :  :- SubqueryAlias `cs_or_ws_sales`
                           :  :  :  :              :  :  :  +- Union
                           :  :  :  :              :  :  :     :- Project [cs_sold_date_sk#0 AS sold_date_sk#31741, cs_bill_customer_sk#3 AS customer_sk#31742, cs_item_sk#15 AS item_sk#31743]
                           :  :  :  :              :  :  :     :  +- SubqueryAlias `catalog_sales`
                           :  :  :  :              :  :  :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :  :  :  :              :  :  :     +- Project [ws_sold_date_sk#216 AS sold_date_sk#31744, ws_bill_customer_sk#220 AS customer_sk#31745, ws_item_sk#219 AS item_sk#31746]
                           :  :  :  :              :  :  :        +- SubqueryAlias `web_sales`
                           :  :  :  :              :  :  :           +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :  :  :  :              :  :  +- SubqueryAlias `item`
                           :  :  :  :              :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           :  :  :  :              :  +- SubqueryAlias `date_dim`
                           :  :  :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :  :  :  :              +- SubqueryAlias `customer`
                           :  :  :  :                 +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                           :  :  :  +- SubqueryAlias `store_sales`
                           :  :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :  :  +- SubqueryAlias `customer_address`
                           :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                           :  +- SubqueryAlias `store`
                           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:25:42 INFO Query: 
== Query: q54-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [segment#31771 ASC NULLS FIRST, num_customers#31760L ASC NULLS FIRST], true
      +- Aggregate [segment#31771], [segment#31771, count(1) AS num_customers#31760L, (segment#31771 * 50) AS segment_base#31761]
         +- SubqueryAlias `segments`
            +- Project [cast(CheckOverflow((promote_precision(cast(revenue#31768 as decimal(17,2))) / promote_precision(cast(cast(50 as decimal(2,0)) as decimal(17,2)))), DecimalType(21,6)) as int) AS segment#31771]
               +- SubqueryAlias `my_revenue`
                  +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(ss_ext_sales_price#145) AS revenue#31768]
                     +- Filter ((((c_current_addr_sk#416 = ca_address_sk#448) && (ca_county#455 = s_county#687)) && (ca_state#456 = s_state#688)) && (((ss_sold_date_sk#130 = d_date_sk#492) && (c_customer_sk#412 = ss_customer_sk#133)) && ((d_month_seq#495 >= scalar-subquery#31769 []) && (d_month_seq#495 <= scalar-subquery#31770 []))))
                        :  :- Distinct
                        :  :  +- Project [(d_month_seq#495 + 1) AS (d_month_seq + 1)#31772]
                        :  :     +- Filter ((d_year#498 = 1998) && (d_moy#500 = 12))
                        :  :        +- SubqueryAlias `date_dim`
                        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  +- Distinct
                        :     +- Project [(d_month_seq#495 + 3) AS (d_month_seq + 3)#31773]
                        :        +- Filter ((d_year#498 = 1998) && (d_moy#500 = 12))
                        :           +- SubqueryAlias `date_dim`
                        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Join Inner
                           :- Join Inner
                           :  :- Join Inner
                           :  :  :- Join Inner
                           :  :  :  :- SubqueryAlias `my_customers`
                           :  :  :  :  +- Distinct
                           :  :  :  :     +- Project [c_customer_sk#412, c_current_addr_sk#416]
                           :  :  :  :        +- Filter ((((sold_date_sk#31762 = d_date_sk#492) && (item_sk#31764 = i_item_sk#564)) && ((i_category#576 = Women) && (i_class#574 = maternity))) && (((c_customer_sk#412 = customer_sk#31763) && (d_moy#500 = 12)) && (d_year#498 = 1998)))
                           :  :  :  :           +- Join Inner
                           :  :  :  :              :- Join Inner
                           :  :  :  :              :  :- Join Inner
                           :  :  :  :              :  :  :- SubqueryAlias `cs_or_ws_sales`
                           :  :  :  :              :  :  :  +- Union
                           :  :  :  :              :  :  :     :- Project [cs_sold_date_sk#0 AS sold_date_sk#31762, cs_bill_customer_sk#3 AS customer_sk#31763, cs_item_sk#15 AS item_sk#31764]
                           :  :  :  :              :  :  :     :  +- SubqueryAlias `catalog_sales`
                           :  :  :  :              :  :  :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :  :  :  :              :  :  :     +- Project [ws_sold_date_sk#216 AS sold_date_sk#31765, ws_bill_customer_sk#220 AS customer_sk#31766, ws_item_sk#219 AS item_sk#31767]
                           :  :  :  :              :  :  :        +- SubqueryAlias `web_sales`
                           :  :  :  :              :  :  :           +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :  :  :  :              :  :  +- SubqueryAlias `item`
                           :  :  :  :              :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           :  :  :  :              :  +- SubqueryAlias `date_dim`
                           :  :  :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :  :  :  :              +- SubqueryAlias `customer`
                           :  :  :  :                 +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                           :  :  :  +- SubqueryAlias `store_sales`
                           :  :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :  :  +- SubqueryAlias `customer_address`
                           :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                           :  +- SubqueryAlias `store`
                           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 9.281361785s
Running execution q55-v2.4 iteration: 1, StandardRun=true
19/09/08 18:25:53 INFO Query: 
== Query: q55-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ext_price#31841 DESC NULLS LAST, brand_id#31839 ASC NULLS FIRST], true
      +- Aggregate [i_brand#572, i_brand_id#571], [i_brand_id#571 AS brand_id#31839, i_brand#572 AS brand#31840, sum(ss_ext_sales_price#145) AS ext_price#31841]
         +- Filter ((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 28)) && ((d_moy#500 = 11) && (d_year#498 = 1999)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `date_dim`
               :  :  +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:25:53 INFO Query: 
== Query: q55-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ext_price#31850 DESC NULLS LAST, brand_id#31848 ASC NULLS FIRST], true
      +- Aggregate [i_brand#572, i_brand_id#571], [i_brand_id#571 AS brand_id#31848, i_brand#572 AS brand#31849, sum(ss_ext_sales_price#145) AS ext_price#31850]
         +- Filter ((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 28)) && ((d_moy#500 = 11) && (d_year#498 = 1999)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `date_dim`
               :  :  +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 1.961933599s
Running execution q56-v2.4 iteration: 1, StandardRun=true
19/09/08 18:25:56 INFO Query: 
== Query: q56-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [total_sales#31906 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565], [i_item_id#565, sum(total_sales#31907) AS total_sales#31906]
         +- SubqueryAlias `tmp1`
            +- Union
               :- Union
               :  :- Project [i_item_id#565, total_sales#31907]
               :  :  +- SubqueryAlias `ss`
               :  :     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ss_ext_sales_price#145) AS total_sales#31907]
               :  :        +- Filter (((i_item_id#565 IN (list#31908 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 2001))) && (((d_moy#500 = 2) && (ss_addr_sk#136 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :  :           :  +- Project [i_item_id#565]
               :  :           :     +- Filter i_color#581 IN (slate,blanched,burnished)
               :  :           :        +- SubqueryAlias `item`
               :  :           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- Join Inner
               :  :              :  :  :- SubqueryAlias `store_sales`
               :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :              :  :  +- SubqueryAlias `date_dim`
               :  :              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              :  +- SubqueryAlias `customer_address`
               :  :              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  :              +- SubqueryAlias `item`
               :  :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- Project [i_item_id#565, total_sales#31909]
               :     +- SubqueryAlias `cs`
               :        +- Aggregate [i_item_id#565], [i_item_id#565, sum(cs_ext_sales_price#23) AS total_sales#31909]
               :           +- Filter (((i_item_id#565 IN (list#31910 []) && (cs_item_sk#15 = i_item_sk#564)) && ((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 2001))) && (((d_moy#500 = 2) && (cs_bill_addr_sk#6 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :              :  +- Project [i_item_id#565]
               :              :     +- Filter i_color#581 IN (slate,blanched,burnished)
               :              :        +- SubqueryAlias `item`
               :              :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- Join Inner
               :                 :  :  :- SubqueryAlias `catalog_sales`
               :                 :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :  :  +- SubqueryAlias `date_dim`
               :                 :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :  +- SubqueryAlias `customer_address`
               :                 :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :                 +- SubqueryAlias `item`
               :                    +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Project [i_item_id#565, total_sales#31911]
                  +- SubqueryAlias `ws`
                     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ws_ext_sales_price#239) AS total_sales#31911]
                        +- Filter (((i_item_id#565 IN (list#31912 []) && (ws_item_sk#219 = i_item_sk#564)) && ((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 2001))) && (((d_moy#500 = 2) && (ws_bill_addr_sk#223 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
                           :  +- Project [i_item_id#565]
                           :     +- Filter i_color#581 IN (slate,blanched,burnished)
                           :        +- SubqueryAlias `item`
                           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `web_sales`
                              :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :  +- SubqueryAlias `date_dim`
                              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `customer_address`
                              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:25:56 INFO Query: 
== Query: q56-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [total_sales#31920 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565], [i_item_id#565, sum(total_sales#31921) AS total_sales#31920]
         +- SubqueryAlias `tmp1`
            +- Union
               :- Union
               :  :- Project [i_item_id#565, total_sales#31921]
               :  :  +- SubqueryAlias `ss`
               :  :     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ss_ext_sales_price#145) AS total_sales#31921]
               :  :        +- Filter (((i_item_id#565 IN (list#31922 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 2001))) && (((d_moy#500 = 2) && (ss_addr_sk#136 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :  :           :  +- Project [i_item_id#565]
               :  :           :     +- Filter i_color#581 IN (slate,blanched,burnished)
               :  :           :        +- SubqueryAlias `item`
               :  :           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- Join Inner
               :  :              :  :  :- SubqueryAlias `store_sales`
               :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :              :  :  +- SubqueryAlias `date_dim`
               :  :              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              :  +- SubqueryAlias `customer_address`
               :  :              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  :              +- SubqueryAlias `item`
               :  :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- Project [i_item_id#565, total_sales#31923]
               :     +- SubqueryAlias `cs`
               :        +- Aggregate [i_item_id#565], [i_item_id#565, sum(cs_ext_sales_price#23) AS total_sales#31923]
               :           +- Filter (((i_item_id#565 IN (list#31924 []) && (cs_item_sk#15 = i_item_sk#564)) && ((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 2001))) && (((d_moy#500 = 2) && (cs_bill_addr_sk#6 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :              :  +- Project [i_item_id#565]
               :              :     +- Filter i_color#581 IN (slate,blanched,burnished)
               :              :        +- SubqueryAlias `item`
               :              :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- Join Inner
               :                 :  :  :- SubqueryAlias `catalog_sales`
               :                 :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :  :  +- SubqueryAlias `date_dim`
               :                 :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :  +- SubqueryAlias `customer_address`
               :                 :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :                 +- SubqueryAlias `item`
               :                    +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Project [i_item_id#565, total_sales#31925]
                  +- SubqueryAlias `ws`
                     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ws_ext_sales_price#239) AS total_sales#31925]
                        +- Filter (((i_item_id#565 IN (list#31926 []) && (ws_item_sk#219 = i_item_sk#564)) && ((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 2001))) && (((d_moy#500 = 2) && (ws_bill_addr_sk#223 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
                           :  +- Project [i_item_id#565]
                           :     +- Filter i_color#581 IN (slate,blanched,burnished)
                           :        +- SubqueryAlias `item`
                           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `web_sales`
                              :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :  +- SubqueryAlias `date_dim`
                              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `customer_address`
                              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 5.0785031179999995s
Running execution q57-v2.4 iteration: 1, StandardRun=true
19/09/08 18:26:04 INFO Query: 
== Query: q57-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#33094 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#33095 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, cc_name#338 ASC NULLS FIRST], true
      +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, avg_monthly_sales#33095, sum_sales#33094, psum#33097, nsum#33098]
         +- Filter (((d_year#498 = 1999) && (cast(avg_monthly_sales#33095 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6)))) && (cast(CASE WHEN (cast(avg_monthly_sales#33095 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#33094 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#33095 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#33095 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16))))
            +- SubqueryAlias `v2`
               +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, avg_monthly_sales#33095, sum_sales#33094, sum_sales#33306 AS psum#33097, sum_sales#33793 AS nsum#33098]
                  +- Filter ((((i_category#576 = i_category#33413) && (i_category#576 = i_category#33900)) && ((i_brand#572 = i_brand#33409) && (i_brand#572 = i_brand#33896))) && (((cc_name#338 = cc_name#33575) && (cc_name#338 = cc_name#34062)) && ((rn#33096 = (rn#33210 + 1)) && (rn#33096 = (rn#33697 - 1)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `v1`
                        :  :  +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, sum_sales#33094, avg_monthly_sales#33095, rn#33096]
                        :  :     +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, sum_sales#33094, _w0#33108, rn#33096, avg_monthly_sales#33095, avg_monthly_sales#33095, rn#33096]
                        :  :        +- Window [avg(_w0#33108) windowspecdefinition(i_category#576, i_brand#572, cc_name#338, d_year#498, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#33095], [i_category#576, i_brand#572, cc_name#338, d_year#498]
                        :  :           +- Window [rank(d_year#498, d_moy#500) windowspecdefinition(i_category#576, i_brand#572, cc_name#338, d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#33096], [i_category#576, i_brand#572, cc_name#338], [d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST]
                        :  :              +- Aggregate [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500], [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, sum(cs_sales_price#21) AS sum_sales#33094, sum(cs_sales_price#21) AS _w0#33108]
                        :  :                 +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((cc_call_center_sk#332 = cs_call_center_sk#11) && (((d_year#498 = 1999) || ((d_year#498 = (1999 - 1)) && (d_moy#500 = 12))) || ((d_year#498 = (1999 + 1)) && (d_moy#500 = 1)))))
                        :  :                    +- Join Inner
                        :  :                       :- Join Inner
                        :  :                       :  :- Join Inner
                        :  :                       :  :  :- SubqueryAlias `item`
                        :  :                       :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        :  :                       :  :  +- SubqueryAlias `catalog_sales`
                        :  :                       :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :                       :  +- SubqueryAlias `date_dim`
                        :  :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :                       +- SubqueryAlias `call_center`
                        :  :                          +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet
                        :  +- SubqueryAlias `v1_lag`
                        :     +- SubqueryAlias `v1`
                        :        +- Project [i_category#33413, i_brand#33409, cc_name#33575, d_year#33500, d_moy#33502, sum_sales#33306, avg_monthly_sales#33113, rn#33210]
                        :           +- Project [i_category#33413, i_brand#33409, cc_name#33575, d_year#33500, d_moy#33502, sum_sales#33306, _w0#33307, rn#33210, avg_monthly_sales#33113, avg_monthly_sales#33113, rn#33210]
                        :              +- Window [avg(_w0#33307) windowspecdefinition(i_category#33413, i_brand#33409, cc_name#33575, d_year#33500, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#33113], [i_category#33413, i_brand#33409, cc_name#33575, d_year#33500]
                        :                 +- Window [rank(d_year#33500, d_moy#33502) windowspecdefinition(i_category#33413, i_brand#33409, cc_name#33575, d_year#33500 ASC NULLS FIRST, d_moy#33502 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#33210], [i_category#33413, i_brand#33409, cc_name#33575], [d_year#33500 ASC NULLS FIRST, d_moy#33502 ASC NULLS FIRST]
                        :                    +- Aggregate [i_category#33413, i_brand#33409, cc_name#33575, d_year#33500, d_moy#33502], [i_category#33413, i_brand#33409, cc_name#33575, d_year#33500, d_moy#33502, sum(cs_sales_price#21) AS sum_sales#33306, sum(cs_sales_price#21) AS _w0#33307]
                        :                       +- Filter (((cs_item_sk#15 = i_item_sk#33401) && (cs_sold_date_sk#0 = d_date_sk#33494)) && ((cc_call_center_sk#33569 = cs_call_center_sk#11) && (((d_year#33500 = 1999) || ((d_year#33500 = (1999 - 1)) && (d_moy#33502 = 12))) || ((d_year#33500 = (1999 + 1)) && (d_moy#33502 = 1)))))
                        :                          +- Join Inner
                        :                             :- Join Inner
                        :                             :  :- Join Inner
                        :                             :  :  :- SubqueryAlias `item`
                        :                             :  :  :  +- Relation[i_item_sk#33401,i_item_id#33402,i_rec_start_date#33403,i_rec_end_date#33404,i_item_desc#33405,i_current_price#33406,i_wholesale_cost#33407,i_brand_id#33408,i_brand#33409,i_class_id#33410,i_class#33411,i_category_id#33412,i_category#33413,i_manufact_id#33414,i_manufact#33415,i_size#33416,i_formulation#33417,i_color#33418,i_units#33419,i_container#33420,i_manager_id#33421,i_product_name#33422] parquet
                        :                             :  :  +- SubqueryAlias `catalog_sales`
                        :                             :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :                             :  +- SubqueryAlias `date_dim`
                        :                             :     +- Relation[d_date_sk#33494,d_date_id#33495,d_date#33496,d_month_seq#33497,d_week_seq#33498,d_quarter_seq#33499,d_year#33500,d_dow#33501,d_moy#33502,d_dom#33503,d_qoy#33504,d_fy_year#33505,d_fy_quarter_seq#33506,d_fy_week_seq#33507,d_day_name#33508,d_quarter_name#33509,d_holiday#33510,d_weekend#33511,d_following_holiday#33512,d_first_dom#33513,d_last_dom#33514,d_same_day_ly#33515,d_same_day_lq#33516,d_current_day#33517,... 4 more fields] parquet
                        :                             +- SubqueryAlias `call_center`
                        :                                +- Relation[cc_call_center_sk#33569,cc_call_center_id#33570,cc_rec_start_date#33571,cc_rec_end_date#33572,cc_closed_date_sk#33573,cc_open_date_sk#33574,cc_name#33575,cc_class#33576,cc_employees#33577,cc_sq_ft#33578,cc_hours#33579,cc_manager#33580,cc_mkt_id#33581,cc_mkt_class#33582,cc_mkt_desc#33583,cc_market_manager#33584,cc_division#33585,cc_division_name#33586,cc_company#33587,cc_company_name#33588,cc_street_number#33589,cc_street_name#33590,cc_street_type#33591,cc_suite_number#33592,... 7 more fields] parquet
                        +- SubqueryAlias `v1_lead`
                           +- SubqueryAlias `v1`
                              +- Project [i_category#33900, i_brand#33896, cc_name#34062, d_year#33987, d_moy#33989, sum_sales#33793, avg_monthly_sales#33600, rn#33697]
                                 +- Project [i_category#33900, i_brand#33896, cc_name#34062, d_year#33987, d_moy#33989, sum_sales#33793, _w0#33794, rn#33697, avg_monthly_sales#33600, avg_monthly_sales#33600, rn#33697]
                                    +- Window [avg(_w0#33794) windowspecdefinition(i_category#33900, i_brand#33896, cc_name#34062, d_year#33987, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#33600], [i_category#33900, i_brand#33896, cc_name#34062, d_year#33987]
                                       +- Window [rank(d_year#33987, d_moy#33989) windowspecdefinition(i_category#33900, i_brand#33896, cc_name#34062, d_year#33987 ASC NULLS FIRST, d_moy#33989 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#33697], [i_category#33900, i_brand#33896, cc_name#34062], [d_year#33987 ASC NULLS FIRST, d_moy#33989 ASC NULLS FIRST]
                                          +- Aggregate [i_category#33900, i_brand#33896, cc_name#34062, d_year#33987, d_moy#33989], [i_category#33900, i_brand#33896, cc_name#34062, d_year#33987, d_moy#33989, sum(cs_sales_price#21) AS sum_sales#33793, sum(cs_sales_price#21) AS _w0#33794]
                                             +- Filter (((cs_item_sk#15 = i_item_sk#33888) && (cs_sold_date_sk#0 = d_date_sk#33981)) && ((cc_call_center_sk#34056 = cs_call_center_sk#11) && (((d_year#33987 = 1999) || ((d_year#33987 = (1999 - 1)) && (d_moy#33989 = 12))) || ((d_year#33987 = (1999 + 1)) && (d_moy#33989 = 1)))))
                                                +- Join Inner
                                                   :- Join Inner
                                                   :  :- Join Inner
                                                   :  :  :- SubqueryAlias `item`
                                                   :  :  :  +- Relation[i_item_sk#33888,i_item_id#33889,i_rec_start_date#33890,i_rec_end_date#33891,i_item_desc#33892,i_current_price#33893,i_wholesale_cost#33894,i_brand_id#33895,i_brand#33896,i_class_id#33897,i_class#33898,i_category_id#33899,i_category#33900,i_manufact_id#33901,i_manufact#33902,i_size#33903,i_formulation#33904,i_color#33905,i_units#33906,i_container#33907,i_manager_id#33908,i_product_name#33909] parquet
                                                   :  :  +- SubqueryAlias `catalog_sales`
                                                   :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                                                   :  +- SubqueryAlias `date_dim`
                                                   :     +- Relation[d_date_sk#33981,d_date_id#33982,d_date#33983,d_month_seq#33984,d_week_seq#33985,d_quarter_seq#33986,d_year#33987,d_dow#33988,d_moy#33989,d_dom#33990,d_qoy#33991,d_fy_year#33992,d_fy_quarter_seq#33993,d_fy_week_seq#33994,d_day_name#33995,d_quarter_name#33996,d_holiday#33997,d_weekend#33998,d_following_holiday#33999,d_first_dom#34000,d_last_dom#34001,d_same_day_ly#34002,d_same_day_lq#34003,d_current_day#34004,... 4 more fields] parquet
                                                   +- SubqueryAlias `call_center`
                                                      +- Relation[cc_call_center_sk#34056,cc_call_center_id#34057,cc_rec_start_date#34058,cc_rec_end_date#34059,cc_closed_date_sk#34060,cc_open_date_sk#34061,cc_name#34062,cc_class#34063,cc_employees#34064,cc_sq_ft#34065,cc_hours#34066,cc_manager#34067,cc_mkt_id#34068,cc_mkt_class#34069,cc_mkt_desc#34070,cc_market_manager#34071,cc_division#34072,cc_division_name#34073,cc_company#34074,cc_company_name#34075,cc_street_number#34076,cc_street_name#34077,cc_street_type#34078,cc_suite_number#34079,... 7 more fields] parquet

     : benchmark
19/09/08 18:26:05 INFO Query: 
== Query: q57-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#34192 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#34193 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, cc_name#338 ASC NULLS FIRST], true
      +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, avg_monthly_sales#34193, sum_sales#34192, psum#34195, nsum#34196]
         +- Filter (((d_year#498 = 1999) && (cast(avg_monthly_sales#34193 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6)))) && (cast(CASE WHEN (cast(avg_monthly_sales#34193 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#34192 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#34193 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#34193 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16))))
            +- SubqueryAlias `v2`
               +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, avg_monthly_sales#34193, sum_sales#34192, sum_sales#34404 AS psum#34195, sum_sales#34891 AS nsum#34196]
                  +- Filter ((((i_category#576 = i_category#34511) && (i_category#576 = i_category#34998)) && ((i_brand#572 = i_brand#34507) && (i_brand#572 = i_brand#34994))) && (((cc_name#338 = cc_name#34673) && (cc_name#338 = cc_name#35160)) && ((rn#34194 = (rn#34308 + 1)) && (rn#34194 = (rn#34795 - 1)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `v1`
                        :  :  +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, sum_sales#34192, avg_monthly_sales#34193, rn#34194]
                        :  :     +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, sum_sales#34192, _w0#34206, rn#34194, avg_monthly_sales#34193, avg_monthly_sales#34193, rn#34194]
                        :  :        +- Window [avg(_w0#34206) windowspecdefinition(i_category#576, i_brand#572, cc_name#338, d_year#498, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#34193], [i_category#576, i_brand#572, cc_name#338, d_year#498]
                        :  :           +- Window [rank(d_year#498, d_moy#500) windowspecdefinition(i_category#576, i_brand#572, cc_name#338, d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#34194], [i_category#576, i_brand#572, cc_name#338], [d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST]
                        :  :              +- Aggregate [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500], [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, sum(cs_sales_price#21) AS sum_sales#34192, sum(cs_sales_price#21) AS _w0#34206]
                        :  :                 +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((cc_call_center_sk#332 = cs_call_center_sk#11) && (((d_year#498 = 1999) || ((d_year#498 = (1999 - 1)) && (d_moy#500 = 12))) || ((d_year#498 = (1999 + 1)) && (d_moy#500 = 1)))))
                        :  :                    +- Join Inner
                        :  :                       :- Join Inner
                        :  :                       :  :- Join Inner
                        :  :                       :  :  :- SubqueryAlias `item`
                        :  :                       :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        :  :                       :  :  +- SubqueryAlias `catalog_sales`
                        :  :                       :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :                       :  +- SubqueryAlias `date_dim`
                        :  :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :                       +- SubqueryAlias `call_center`
                        :  :                          +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet
                        :  +- SubqueryAlias `v1_lag`
                        :     +- SubqueryAlias `v1`
                        :        +- Project [i_category#34511, i_brand#34507, cc_name#34673, d_year#34598, d_moy#34600, sum_sales#34404, avg_monthly_sales#34211, rn#34308]
                        :           +- Project [i_category#34511, i_brand#34507, cc_name#34673, d_year#34598, d_moy#34600, sum_sales#34404, _w0#34405, rn#34308, avg_monthly_sales#34211, avg_monthly_sales#34211, rn#34308]
                        :              +- Window [avg(_w0#34405) windowspecdefinition(i_category#34511, i_brand#34507, cc_name#34673, d_year#34598, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#34211], [i_category#34511, i_brand#34507, cc_name#34673, d_year#34598]
                        :                 +- Window [rank(d_year#34598, d_moy#34600) windowspecdefinition(i_category#34511, i_brand#34507, cc_name#34673, d_year#34598 ASC NULLS FIRST, d_moy#34600 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#34308], [i_category#34511, i_brand#34507, cc_name#34673], [d_year#34598 ASC NULLS FIRST, d_moy#34600 ASC NULLS FIRST]
                        :                    +- Aggregate [i_category#34511, i_brand#34507, cc_name#34673, d_year#34598, d_moy#34600], [i_category#34511, i_brand#34507, cc_name#34673, d_year#34598, d_moy#34600, sum(cs_sales_price#21) AS sum_sales#34404, sum(cs_sales_price#21) AS _w0#34405]
                        :                       +- Filter (((cs_item_sk#15 = i_item_sk#34499) && (cs_sold_date_sk#0 = d_date_sk#34592)) && ((cc_call_center_sk#34667 = cs_call_center_sk#11) && (((d_year#34598 = 1999) || ((d_year#34598 = (1999 - 1)) && (d_moy#34600 = 12))) || ((d_year#34598 = (1999 + 1)) && (d_moy#34600 = 1)))))
                        :                          +- Join Inner
                        :                             :- Join Inner
                        :                             :  :- Join Inner
                        :                             :  :  :- SubqueryAlias `item`
                        :                             :  :  :  +- Relation[i_item_sk#34499,i_item_id#34500,i_rec_start_date#34501,i_rec_end_date#34502,i_item_desc#34503,i_current_price#34504,i_wholesale_cost#34505,i_brand_id#34506,i_brand#34507,i_class_id#34508,i_class#34509,i_category_id#34510,i_category#34511,i_manufact_id#34512,i_manufact#34513,i_size#34514,i_formulation#34515,i_color#34516,i_units#34517,i_container#34518,i_manager_id#34519,i_product_name#34520] parquet
                        :                             :  :  +- SubqueryAlias `catalog_sales`
                        :                             :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :                             :  +- SubqueryAlias `date_dim`
                        :                             :     +- Relation[d_date_sk#34592,d_date_id#34593,d_date#34594,d_month_seq#34595,d_week_seq#34596,d_quarter_seq#34597,d_year#34598,d_dow#34599,d_moy#34600,d_dom#34601,d_qoy#34602,d_fy_year#34603,d_fy_quarter_seq#34604,d_fy_week_seq#34605,d_day_name#34606,d_quarter_name#34607,d_holiday#34608,d_weekend#34609,d_following_holiday#34610,d_first_dom#34611,d_last_dom#34612,d_same_day_ly#34613,d_same_day_lq#34614,d_current_day#34615,... 4 more fields] parquet
                        :                             +- SubqueryAlias `call_center`
                        :                                +- Relation[cc_call_center_sk#34667,cc_call_center_id#34668,cc_rec_start_date#34669,cc_rec_end_date#34670,cc_closed_date_sk#34671,cc_open_date_sk#34672,cc_name#34673,cc_class#34674,cc_employees#34675,cc_sq_ft#34676,cc_hours#34677,cc_manager#34678,cc_mkt_id#34679,cc_mkt_class#34680,cc_mkt_desc#34681,cc_market_manager#34682,cc_division#34683,cc_division_name#34684,cc_company#34685,cc_company_name#34686,cc_street_number#34687,cc_street_name#34688,cc_street_type#34689,cc_suite_number#34690,... 7 more fields] parquet
                        +- SubqueryAlias `v1_lead`
                           +- SubqueryAlias `v1`
                              +- Project [i_category#34998, i_brand#34994, cc_name#35160, d_year#35085, d_moy#35087, sum_sales#34891, avg_monthly_sales#34698, rn#34795]
                                 +- Project [i_category#34998, i_brand#34994, cc_name#35160, d_year#35085, d_moy#35087, sum_sales#34891, _w0#34892, rn#34795, avg_monthly_sales#34698, avg_monthly_sales#34698, rn#34795]
                                    +- Window [avg(_w0#34892) windowspecdefinition(i_category#34998, i_brand#34994, cc_name#35160, d_year#35085, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#34698], [i_category#34998, i_brand#34994, cc_name#35160, d_year#35085]
                                       +- Window [rank(d_year#35085, d_moy#35087) windowspecdefinition(i_category#34998, i_brand#34994, cc_name#35160, d_year#35085 ASC NULLS FIRST, d_moy#35087 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#34795], [i_category#34998, i_brand#34994, cc_name#35160], [d_year#35085 ASC NULLS FIRST, d_moy#35087 ASC NULLS FIRST]
                                          +- Aggregate [i_category#34998, i_brand#34994, cc_name#35160, d_year#35085, d_moy#35087], [i_category#34998, i_brand#34994, cc_name#35160, d_year#35085, d_moy#35087, sum(cs_sales_price#21) AS sum_sales#34891, sum(cs_sales_price#21) AS _w0#34892]
                                             +- Filter (((cs_item_sk#15 = i_item_sk#34986) && (cs_sold_date_sk#0 = d_date_sk#35079)) && ((cc_call_center_sk#35154 = cs_call_center_sk#11) && (((d_year#35085 = 1999) || ((d_year#35085 = (1999 - 1)) && (d_moy#35087 = 12))) || ((d_year#35085 = (1999 + 1)) && (d_moy#35087 = 1)))))
                                                +- Join Inner
                                                   :- Join Inner
                                                   :  :- Join Inner
                                                   :  :  :- SubqueryAlias `item`
                                                   :  :  :  +- Relation[i_item_sk#34986,i_item_id#34987,i_rec_start_date#34988,i_rec_end_date#34989,i_item_desc#34990,i_current_price#34991,i_wholesale_cost#34992,i_brand_id#34993,i_brand#34994,i_class_id#34995,i_class#34996,i_category_id#34997,i_category#34998,i_manufact_id#34999,i_manufact#35000,i_size#35001,i_formulation#35002,i_color#35003,i_units#35004,i_container#35005,i_manager_id#35006,i_product_name#35007] parquet
                                                   :  :  +- SubqueryAlias `catalog_sales`
                                                   :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                                                   :  +- SubqueryAlias `date_dim`
                                                   :     +- Relation[d_date_sk#35079,d_date_id#35080,d_date#35081,d_month_seq#35082,d_week_seq#35083,d_quarter_seq#35084,d_year#35085,d_dow#35086,d_moy#35087,d_dom#35088,d_qoy#35089,d_fy_year#35090,d_fy_quarter_seq#35091,d_fy_week_seq#35092,d_day_name#35093,d_quarter_name#35094,d_holiday#35095,d_weekend#35096,d_following_holiday#35097,d_first_dom#35098,d_last_dom#35099,d_same_day_ly#35100,d_same_day_lq#35101,d_current_day#35102,... 4 more fields] parquet
                                                   +- SubqueryAlias `call_center`
                                                      +- Relation[cc_call_center_sk#35154,cc_call_center_id#35155,cc_rec_start_date#35156,cc_rec_end_date#35157,cc_closed_date_sk#35158,cc_open_date_sk#35159,cc_name#35160,cc_class#35161,cc_employees#35162,cc_sq_ft#35163,cc_hours#35164,cc_manager#35165,cc_mkt_id#35166,cc_mkt_class#35167,cc_mkt_desc#35168,cc_market_manager#35169,cc_division#35170,cc_division_name#35171,cc_company#35172,cc_company_name#35173,cc_street_number#35174,cc_street_name#35175,cc_street_type#35176,cc_suite_number#35177,... 7 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 6.281811027s
Running execution q58-v2.4 iteration: 1, StandardRun=true
19/09/08 18:26:14 INFO Query: 
== Query: q58-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_id#37549 ASC NULLS FIRST, ss_item_rev#37550 ASC NULLS FIRST], true
      +- Project [item_id#37549, ss_item_rev#37550, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37550 as decimal(19,2))) / promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37550 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37554 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37558 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2)))), DecimalType(38,21)) as decimal(38,21))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(38,21)))), DecimalType(38,21)) as decimal(38,21))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(38,21)))), DecimalType(38,17)) AS ss_dev#37545, cs_item_rev#37554, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_item_rev#37554 as decimal(19,2))) / promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37550 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37554 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37558 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2)))), DecimalType(38,21)) as decimal(38,21))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(38,21)))), DecimalType(38,21)) as decimal(38,21))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(38,21)))), DecimalType(38,17)) AS cs_dev#37546, ws_item_rev#37558, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_item_rev#37558 as decimal(19,2))) / promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37550 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37554 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37558 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2)))), DecimalType(38,21)) as decimal(38,21))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(38,21)))), DecimalType(38,21)) as decimal(38,21))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(38,21)))), DecimalType(38,17)) AS ws_dev#37547, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37550 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37554 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37558 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(19,2)))), DecimalType(23,6)) AS average#37548]
         +- Filter ((((item_id#37549 = item_id#37553) && (item_id#37549 = item_id#37557)) && (((cast(ss_item_rev#37550 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37554 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ss_item_rev#37550 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37554 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))) && ((cast(ss_item_rev#37550 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37558 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ss_item_rev#37550 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37558 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))))) && ((((cast(cs_item_rev#37554 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37550 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(cs_item_rev#37554 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37550 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))) && ((cast(cs_item_rev#37554 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37558 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(cs_item_rev#37554 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37558 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3))))) && (((cast(ws_item_rev#37558 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37550 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ws_item_rev#37558 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37550 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))) && ((cast(ws_item_rev#37558 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37554 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ws_item_rev#37558 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37554 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))))))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ss_items`
               :  :  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#37549, sum(ss_ext_sales_price#145) AS ss_item_rev#37550]
               :  :     +- Filter (((ss_item_sk#132 = i_item_sk#564) && d_date#494 IN (list#37552 [])) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :        :  +- Project [d_date#494]
               :  :        :     +- Filter (d_week_seq#496 = scalar-subquery#37551 [])
               :  :        :        :  +- Project [d_week_seq#496]
               :  :        :        :     +- Filter (d_date#494 = cast(2000-01-03 as date))
               :  :        :        :        +- SubqueryAlias `date_dim`
               :  :        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        :        +- SubqueryAlias `date_dim`
               :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- SubqueryAlias `store_sales`
               :  :           :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  +- SubqueryAlias `item`
               :  :           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- SubqueryAlias `date_dim`
               :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `cs_items`
               :     +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#37553, sum(cs_ext_sales_price#23) AS cs_item_rev#37554]
               :        +- Filter (((cs_item_sk#15 = i_item_sk#564) && d_date#494 IN (list#37556 [])) && (cs_sold_date_sk#0 = d_date_sk#492))
               :           :  +- Project [d_date#494]
               :           :     +- Filter (d_week_seq#496 = scalar-subquery#37555 [])
               :           :        :  +- Project [d_week_seq#496]
               :           :        :     +- Filter (d_date#494 = cast(2000-01-03 as date))
               :           :        :        +- SubqueryAlias `date_dim`
               :           :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Join Inner
               :              :- Join Inner
               :              :  :- SubqueryAlias `catalog_sales`
               :              :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :              :  +- SubqueryAlias `item`
               :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- SubqueryAlias `date_dim`
               :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `ws_items`
                  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#37557, sum(ws_ext_sales_price#239) AS ws_item_rev#37558]
                     +- Filter (((ws_item_sk#219 = i_item_sk#564) && d_date#494 IN (list#37560 [])) && (ws_sold_date_sk#216 = d_date_sk#492))
                        :  +- Project [d_date#494]
                        :     +- Filter (d_week_seq#496 = scalar-subquery#37559 [])
                        :        :  +- Project [d_week_seq#496]
                        :        :     +- Filter (d_date#494 = cast(2000-01-03 as date))
                        :        :        +- SubqueryAlias `date_dim`
                        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `web_sales`
                           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :  +- SubqueryAlias `item`
                           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:26:14 INFO Query: 
== Query: q58-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_id#37576 ASC NULLS FIRST, ss_item_rev#37577 ASC NULLS FIRST], true
      +- Project [item_id#37576, ss_item_rev#37577, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37577 as decimal(19,2))) / promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37577 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37581 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37585 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2)))), DecimalType(38,21)) as decimal(38,21))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(38,21)))), DecimalType(38,21)) as decimal(38,21))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(38,21)))), DecimalType(38,17)) AS ss_dev#37572, cs_item_rev#37581, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_item_rev#37581 as decimal(19,2))) / promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37577 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37581 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37585 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2)))), DecimalType(38,21)) as decimal(38,21))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(38,21)))), DecimalType(38,21)) as decimal(38,21))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(38,21)))), DecimalType(38,17)) AS cs_dev#37573, ws_item_rev#37585, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_item_rev#37585 as decimal(19,2))) / promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37577 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37581 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37585 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2)))), DecimalType(38,21)) as decimal(38,21))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(38,21)))), DecimalType(38,21)) as decimal(38,21))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(38,21)))), DecimalType(38,17)) AS ws_dev#37574, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37577 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37581 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37585 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(19,2)))), DecimalType(23,6)) AS average#37575]
         +- Filter ((((item_id#37576 = item_id#37580) && (item_id#37576 = item_id#37584)) && (((cast(ss_item_rev#37577 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37581 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ss_item_rev#37577 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37581 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))) && ((cast(ss_item_rev#37577 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37585 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ss_item_rev#37577 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37585 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))))) && ((((cast(cs_item_rev#37581 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37577 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(cs_item_rev#37581 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37577 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))) && ((cast(cs_item_rev#37581 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37585 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(cs_item_rev#37581 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37585 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3))))) && (((cast(ws_item_rev#37585 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37577 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ws_item_rev#37585 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37577 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))) && ((cast(ws_item_rev#37585 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37581 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ws_item_rev#37585 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37581 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))))))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ss_items`
               :  :  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#37576, sum(ss_ext_sales_price#145) AS ss_item_rev#37577]
               :  :     +- Filter (((ss_item_sk#132 = i_item_sk#564) && d_date#494 IN (list#37579 [])) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :        :  +- Project [d_date#494]
               :  :        :     +- Filter (d_week_seq#496 = scalar-subquery#37578 [])
               :  :        :        :  +- Project [d_week_seq#496]
               :  :        :        :     +- Filter (d_date#494 = cast(2000-01-03 as date))
               :  :        :        :        +- SubqueryAlias `date_dim`
               :  :        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        :        +- SubqueryAlias `date_dim`
               :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- SubqueryAlias `store_sales`
               :  :           :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  +- SubqueryAlias `item`
               :  :           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- SubqueryAlias `date_dim`
               :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `cs_items`
               :     +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#37580, sum(cs_ext_sales_price#23) AS cs_item_rev#37581]
               :        +- Filter (((cs_item_sk#15 = i_item_sk#564) && d_date#494 IN (list#37583 [])) && (cs_sold_date_sk#0 = d_date_sk#492))
               :           :  +- Project [d_date#494]
               :           :     +- Filter (d_week_seq#496 = scalar-subquery#37582 [])
               :           :        :  +- Project [d_week_seq#496]
               :           :        :     +- Filter (d_date#494 = cast(2000-01-03 as date))
               :           :        :        +- SubqueryAlias `date_dim`
               :           :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Join Inner
               :              :- Join Inner
               :              :  :- SubqueryAlias `catalog_sales`
               :              :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :              :  +- SubqueryAlias `item`
               :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- SubqueryAlias `date_dim`
               :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `ws_items`
                  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#37584, sum(ws_ext_sales_price#239) AS ws_item_rev#37585]
                     +- Filter (((ws_item_sk#219 = i_item_sk#564) && d_date#494 IN (list#37587 [])) && (ws_sold_date_sk#216 = d_date_sk#492))
                        :  +- Project [d_date#494]
                        :     +- Filter (d_week_seq#496 = scalar-subquery#37586 [])
                        :        :  +- Project [d_week_seq#496]
                        :        :     +- Filter (d_date#494 = cast(2000-01-03 as date))
                        :        :        +- SubqueryAlias `date_dim`
                        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `web_sales`
                           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :  +- SubqueryAlias `item`
                           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 5.758942901999999s
Running execution q59-v2.4 iteration: 1, StandardRun=true
19/09/08 18:26:21 INFO Query: 
== Query: q59-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name1#37815 ASC NULLS FIRST, s_store_id1#37817 ASC NULLS FIRST, d_week_seq1#37816 ASC NULLS FIRST], true
      +- Project [s_store_name1#37815, s_store_id1#37817, d_week_seq1#37816, CheckOverflow((promote_precision(cast(sun_sales1#37818 as decimal(17,2))) / promote_precision(cast(sun_sales2#37828 as decimal(17,2)))), DecimalType(37,20)) AS (sun_sales1 / sun_sales2)#37905, CheckOverflow((promote_precision(cast(mon_sales1#37819 as decimal(17,2))) / promote_precision(cast(mon_sales2#37829 as decimal(17,2)))), DecimalType(37,20)) AS (mon_sales1 / mon_sales2)#37906, CheckOverflow((promote_precision(cast(tue_sales1#37820 as decimal(17,2))) / promote_precision(cast(tue_sales2#37830 as decimal(17,2)))), DecimalType(37,20)) AS (tue_sales1 / tue_sales2)#37907, CheckOverflow((promote_precision(cast(wed_sales1#37821 as decimal(17,2))) / promote_precision(cast(wed_sales2#37831 as decimal(17,2)))), DecimalType(37,20)) AS (wed_sales1 / wed_sales2)#37908, CheckOverflow((promote_precision(cast(thu_sales1#37822 as decimal(17,2))) / promote_precision(cast(thu_sales2#37832 as decimal(17,2)))), DecimalType(37,20)) AS (thu_sales1 / thu_sales2)#37909, CheckOverflow((promote_precision(cast(fri_sales1#37823 as decimal(17,2))) / promote_precision(cast(fri_sales2#37833 as decimal(17,2)))), DecimalType(37,20)) AS (fri_sales1 / fri_sales2)#37910, CheckOverflow((promote_precision(cast(sat_sales1#37824 as decimal(17,2))) / promote_precision(cast(sat_sales2#37834 as decimal(17,2)))), DecimalType(37,20)) AS (sat_sales1 / sat_sales2)#37911]
         +- Filter ((s_store_id1#37817 = s_store_id2#37827) && (d_week_seq1#37816 = (d_week_seq2#37826 - 52)))
            +- Join Inner
               :- SubqueryAlias `y`
               :  +- Project [s_store_name#669 AS s_store_name1#37815, d_week_seq#496 AS d_week_seq1#37816, s_store_id#665 AS s_store_id1#37817, sun_sales#37835 AS sun_sales1#37818, mon_sales#37836 AS mon_sales1#37819, tue_sales#37837 AS tue_sales1#37820, wed_sales#37838 AS wed_sales1#37821, thu_sales#37839 AS thu_sales1#37822, fri_sales#37840 AS fri_sales1#37823, sat_sales#37841 AS sat_sales1#37824]
               :     +- Filter (((d_week_seq#37853 = d_week_seq#496) && (ss_store_sk#137 = s_store_sk#664)) && ((d_month_seq#37852 >= 1212) && (d_month_seq#37852 <= (1212 + 11))))
               :        +- Join Inner
               :           :- Join Inner
               :           :  :- SubqueryAlias `wss`
               :           :  :  +- Aggregate [d_week_seq#496, ss_store_sk#137], [d_week_seq#496, ss_store_sk#137, sum(CASE WHEN (d_day_name#506 = Sunday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sun_sales#37835, sum(CASE WHEN (d_day_name#506 = Monday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS mon_sales#37836, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS tue_sales#37837, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS wed_sales#37838, sum(CASE WHEN (d_day_name#506 = Thursday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS thu_sales#37839, sum(CASE WHEN (d_day_name#506 = Friday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS fri_sales#37840, sum(CASE WHEN (d_day_name#506 = Saturday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sat_sales#37841]
               :           :  :     +- Filter (d_date_sk#492 = ss_sold_date_sk#130)
               :           :  :        +- Join Inner
               :           :  :           :- SubqueryAlias `store_sales`
               :           :  :           :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :  :           +- SubqueryAlias `date_dim`
               :           :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :  +- SubqueryAlias `store`
               :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :           +- SubqueryAlias `d`
               :              +- SubqueryAlias `date_dim`
               :                 +- Relation[d_date_sk#37849,d_date_id#37850,d_date#37851,d_month_seq#37852,d_week_seq#37853,d_quarter_seq#37854,d_year#37855,d_dow#37856,d_moy#37857,d_dom#37858,d_qoy#37859,d_fy_year#37860,d_fy_quarter_seq#37861,d_fy_week_seq#37862,d_day_name#37863,d_quarter_name#37864,d_holiday#37865,d_weekend#37866,d_following_holiday#37867,d_first_dom#37868,d_last_dom#37869,d_same_day_ly#37870,d_same_day_lq#37871,d_current_day#37872,... 4 more fields] parquet
               +- SubqueryAlias `x`
                  +- Project [s_store_name#669 AS s_store_name2#37825, d_week_seq#496 AS d_week_seq2#37826, s_store_id#665 AS s_store_id2#37827, sun_sales#37835 AS sun_sales2#37828, mon_sales#37836 AS mon_sales2#37829, tue_sales#37837 AS tue_sales2#37830, wed_sales#37838 AS wed_sales2#37831, thu_sales#37839 AS thu_sales2#37832, fri_sales#37840 AS fri_sales2#37833, sat_sales#37841 AS sat_sales2#37834]
                     +- Filter (((d_week_seq#37881 = d_week_seq#496) && (ss_store_sk#137 = s_store_sk#664)) && ((d_month_seq#37880 >= (1212 + 12)) && (d_month_seq#37880 <= (1212 + 23))))
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `wss`
                           :  :  +- Aggregate [d_week_seq#496, ss_store_sk#137], [d_week_seq#496, ss_store_sk#137, sum(CASE WHEN (d_day_name#506 = Sunday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sun_sales#37835, sum(CASE WHEN (d_day_name#506 = Monday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS mon_sales#37836, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS tue_sales#37837, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS wed_sales#37838, sum(CASE WHEN (d_day_name#506 = Thursday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS thu_sales#37839, sum(CASE WHEN (d_day_name#506 = Friday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS fri_sales#37840, sum(CASE WHEN (d_day_name#506 = Saturday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sat_sales#37841]
                           :  :     +- Filter (d_date_sk#492 = ss_sold_date_sk#130)
                           :  :        +- Join Inner
                           :  :           :- SubqueryAlias `store_sales`
                           :  :           :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :  :           +- SubqueryAlias `date_dim`
                           :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :  +- SubqueryAlias `store`
                           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           +- SubqueryAlias `d`
                              +- SubqueryAlias `date_dim`
                                 +- Relation[d_date_sk#37877,d_date_id#37878,d_date#37879,d_month_seq#37880,d_week_seq#37881,d_quarter_seq#37882,d_year#37883,d_dow#37884,d_moy#37885,d_dom#37886,d_qoy#37887,d_fy_year#37888,d_fy_quarter_seq#37889,d_fy_week_seq#37890,d_day_name#37891,d_quarter_name#37892,d_holiday#37893,d_weekend#37894,d_following_holiday#37895,d_first_dom#37896,d_last_dom#37897,d_same_day_ly#37898,d_same_day_lq#37899,d_current_day#37900,... 4 more fields] parquet

     : benchmark
19/09/08 18:26:21 INFO Query: 
== Query: q59-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name1#37922 ASC NULLS FIRST, s_store_id1#37924 ASC NULLS FIRST, d_week_seq1#37923 ASC NULLS FIRST], true
      +- Project [s_store_name1#37922, s_store_id1#37924, d_week_seq1#37923, CheckOverflow((promote_precision(cast(sun_sales1#37925 as decimal(17,2))) / promote_precision(cast(sun_sales2#37935 as decimal(17,2)))), DecimalType(37,20)) AS (sun_sales1 / sun_sales2)#38012, CheckOverflow((promote_precision(cast(mon_sales1#37926 as decimal(17,2))) / promote_precision(cast(mon_sales2#37936 as decimal(17,2)))), DecimalType(37,20)) AS (mon_sales1 / mon_sales2)#38013, CheckOverflow((promote_precision(cast(tue_sales1#37927 as decimal(17,2))) / promote_precision(cast(tue_sales2#37937 as decimal(17,2)))), DecimalType(37,20)) AS (tue_sales1 / tue_sales2)#38014, CheckOverflow((promote_precision(cast(wed_sales1#37928 as decimal(17,2))) / promote_precision(cast(wed_sales2#37938 as decimal(17,2)))), DecimalType(37,20)) AS (wed_sales1 / wed_sales2)#38015, CheckOverflow((promote_precision(cast(thu_sales1#37929 as decimal(17,2))) / promote_precision(cast(thu_sales2#37939 as decimal(17,2)))), DecimalType(37,20)) AS (thu_sales1 / thu_sales2)#38016, CheckOverflow((promote_precision(cast(fri_sales1#37930 as decimal(17,2))) / promote_precision(cast(fri_sales2#37940 as decimal(17,2)))), DecimalType(37,20)) AS (fri_sales1 / fri_sales2)#38017, CheckOverflow((promote_precision(cast(sat_sales1#37931 as decimal(17,2))) / promote_precision(cast(sat_sales2#37941 as decimal(17,2)))), DecimalType(37,20)) AS (sat_sales1 / sat_sales2)#38018]
         +- Filter ((s_store_id1#37924 = s_store_id2#37934) && (d_week_seq1#37923 = (d_week_seq2#37933 - 52)))
            +- Join Inner
               :- SubqueryAlias `y`
               :  +- Project [s_store_name#669 AS s_store_name1#37922, d_week_seq#496 AS d_week_seq1#37923, s_store_id#665 AS s_store_id1#37924, sun_sales#37942 AS sun_sales1#37925, mon_sales#37943 AS mon_sales1#37926, tue_sales#37944 AS tue_sales1#37927, wed_sales#37945 AS wed_sales1#37928, thu_sales#37946 AS thu_sales1#37929, fri_sales#37947 AS fri_sales1#37930, sat_sales#37948 AS sat_sales1#37931]
               :     +- Filter (((d_week_seq#37960 = d_week_seq#496) && (ss_store_sk#137 = s_store_sk#664)) && ((d_month_seq#37959 >= 1212) && (d_month_seq#37959 <= (1212 + 11))))
               :        +- Join Inner
               :           :- Join Inner
               :           :  :- SubqueryAlias `wss`
               :           :  :  +- Aggregate [d_week_seq#496, ss_store_sk#137], [d_week_seq#496, ss_store_sk#137, sum(CASE WHEN (d_day_name#506 = Sunday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sun_sales#37942, sum(CASE WHEN (d_day_name#506 = Monday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS mon_sales#37943, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS tue_sales#37944, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS wed_sales#37945, sum(CASE WHEN (d_day_name#506 = Thursday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS thu_sales#37946, sum(CASE WHEN (d_day_name#506 = Friday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS fri_sales#37947, sum(CASE WHEN (d_day_name#506 = Saturday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sat_sales#37948]
               :           :  :     +- Filter (d_date_sk#492 = ss_sold_date_sk#130)
               :           :  :        +- Join Inner
               :           :  :           :- SubqueryAlias `store_sales`
               :           :  :           :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :  :           +- SubqueryAlias `date_dim`
               :           :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :  +- SubqueryAlias `store`
               :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :           +- SubqueryAlias `d`
               :              +- SubqueryAlias `date_dim`
               :                 +- Relation[d_date_sk#37956,d_date_id#37957,d_date#37958,d_month_seq#37959,d_week_seq#37960,d_quarter_seq#37961,d_year#37962,d_dow#37963,d_moy#37964,d_dom#37965,d_qoy#37966,d_fy_year#37967,d_fy_quarter_seq#37968,d_fy_week_seq#37969,d_day_name#37970,d_quarter_name#37971,d_holiday#37972,d_weekend#37973,d_following_holiday#37974,d_first_dom#37975,d_last_dom#37976,d_same_day_ly#37977,d_same_day_lq#37978,d_current_day#37979,... 4 more fields] parquet
               +- SubqueryAlias `x`
                  +- Project [s_store_name#669 AS s_store_name2#37932, d_week_seq#496 AS d_week_seq2#37933, s_store_id#665 AS s_store_id2#37934, sun_sales#37942 AS sun_sales2#37935, mon_sales#37943 AS mon_sales2#37936, tue_sales#37944 AS tue_sales2#37937, wed_sales#37945 AS wed_sales2#37938, thu_sales#37946 AS thu_sales2#37939, fri_sales#37947 AS fri_sales2#37940, sat_sales#37948 AS sat_sales2#37941]
                     +- Filter (((d_week_seq#37988 = d_week_seq#496) && (ss_store_sk#137 = s_store_sk#664)) && ((d_month_seq#37987 >= (1212 + 12)) && (d_month_seq#37987 <= (1212 + 23))))
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `wss`
                           :  :  +- Aggregate [d_week_seq#496, ss_store_sk#137], [d_week_seq#496, ss_store_sk#137, sum(CASE WHEN (d_day_name#506 = Sunday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sun_sales#37942, sum(CASE WHEN (d_day_name#506 = Monday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS mon_sales#37943, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS tue_sales#37944, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS wed_sales#37945, sum(CASE WHEN (d_day_name#506 = Thursday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS thu_sales#37946, sum(CASE WHEN (d_day_name#506 = Friday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS fri_sales#37947, sum(CASE WHEN (d_day_name#506 = Saturday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sat_sales#37948]
                           :  :     +- Filter (d_date_sk#492 = ss_sold_date_sk#130)
                           :  :        +- Join Inner
                           :  :           :- SubqueryAlias `store_sales`
                           :  :           :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :  :           +- SubqueryAlias `date_dim`
                           :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :  +- SubqueryAlias `store`
                           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           +- SubqueryAlias `d`
                              +- SubqueryAlias `date_dim`
                                 +- Relation[d_date_sk#37984,d_date_id#37985,d_date#37986,d_month_seq#37987,d_week_seq#37988,d_quarter_seq#37989,d_year#37990,d_dow#37991,d_moy#37992,d_dom#37993,d_qoy#37994,d_fy_year#37995,d_fy_quarter_seq#37996,d_fy_week_seq#37997,d_day_name#37998,d_quarter_name#37999,d_holiday#38000,d_weekend#38001,d_following_holiday#38002,d_first_dom#38003,d_last_dom#38004,d_same_day_ly#38005,d_same_day_lq#38006,d_current_day#38007,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 5.378765017s
Running execution q60-v2.4 iteration: 1, StandardRun=true
19/09/08 18:26:28 INFO Query: 
== Query: q60-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST, total_sales#38315 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565], [i_item_id#565, sum(total_sales#38316) AS total_sales#38315]
         +- SubqueryAlias `tmp1`
            +- Union
               :- Union
               :  :- Project [i_item_id#565, total_sales#38316]
               :  :  +- SubqueryAlias `ss`
               :  :     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ss_ext_sales_price#145) AS total_sales#38316]
               :  :        +- Filter (((i_item_id#565 IN (list#38317 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 9) && (ss_addr_sk#136 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :  :           :  +- Project [i_item_id#565]
               :  :           :     +- Filter i_category#576 IN (Music)
               :  :           :        +- SubqueryAlias `item`
               :  :           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- Join Inner
               :  :              :  :  :- SubqueryAlias `store_sales`
               :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :              :  :  +- SubqueryAlias `date_dim`
               :  :              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              :  +- SubqueryAlias `customer_address`
               :  :              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  :              +- SubqueryAlias `item`
               :  :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- Project [i_item_id#565, total_sales#38318]
               :     +- SubqueryAlias `cs`
               :        +- Aggregate [i_item_id#565], [i_item_id#565, sum(cs_ext_sales_price#23) AS total_sales#38318]
               :           +- Filter (((i_item_id#565 IN (list#38319 []) && (cs_item_sk#15 = i_item_sk#564)) && ((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 9) && (cs_bill_addr_sk#6 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :              :  +- Project [i_item_id#565]
               :              :     +- Filter i_category#576 IN (Music)
               :              :        +- SubqueryAlias `item`
               :              :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- Join Inner
               :                 :  :  :- SubqueryAlias `catalog_sales`
               :                 :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :  :  +- SubqueryAlias `date_dim`
               :                 :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :  +- SubqueryAlias `customer_address`
               :                 :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :                 +- SubqueryAlias `item`
               :                    +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Project [i_item_id#565, total_sales#38320]
                  +- SubqueryAlias `ws`
                     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ws_ext_sales_price#239) AS total_sales#38320]
                        +- Filter (((i_item_id#565 IN (list#38321 []) && (ws_item_sk#219 = i_item_sk#564)) && ((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 9) && (ws_bill_addr_sk#223 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
                           :  +- Project [i_item_id#565]
                           :     +- Filter i_category#576 IN (Music)
                           :        +- SubqueryAlias `item`
                           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `web_sales`
                              :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :  +- SubqueryAlias `date_dim`
                              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `customer_address`
                              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:26:28 INFO Query: 
== Query: q60-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST, total_sales#38330 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565], [i_item_id#565, sum(total_sales#38331) AS total_sales#38330]
         +- SubqueryAlias `tmp1`
            +- Union
               :- Union
               :  :- Project [i_item_id#565, total_sales#38331]
               :  :  +- SubqueryAlias `ss`
               :  :     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ss_ext_sales_price#145) AS total_sales#38331]
               :  :        +- Filter (((i_item_id#565 IN (list#38332 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 9) && (ss_addr_sk#136 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :  :           :  +- Project [i_item_id#565]
               :  :           :     +- Filter i_category#576 IN (Music)
               :  :           :        +- SubqueryAlias `item`
               :  :           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- Join Inner
               :  :              :  :  :- SubqueryAlias `store_sales`
               :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :              :  :  +- SubqueryAlias `date_dim`
               :  :              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              :  +- SubqueryAlias `customer_address`
               :  :              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  :              +- SubqueryAlias `item`
               :  :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- Project [i_item_id#565, total_sales#38333]
               :     +- SubqueryAlias `cs`
               :        +- Aggregate [i_item_id#565], [i_item_id#565, sum(cs_ext_sales_price#23) AS total_sales#38333]
               :           +- Filter (((i_item_id#565 IN (list#38334 []) && (cs_item_sk#15 = i_item_sk#564)) && ((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 9) && (cs_bill_addr_sk#6 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :              :  +- Project [i_item_id#565]
               :              :     +- Filter i_category#576 IN (Music)
               :              :        +- SubqueryAlias `item`
               :              :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- Join Inner
               :                 :  :  :- SubqueryAlias `catalog_sales`
               :                 :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :  :  +- SubqueryAlias `date_dim`
               :                 :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :  +- SubqueryAlias `customer_address`
               :                 :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :                 +- SubqueryAlias `item`
               :                    +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Project [i_item_id#565, total_sales#38335]
                  +- SubqueryAlias `ws`
                     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ws_ext_sales_price#239) AS total_sales#38335]
                        +- Filter (((i_item_id#565 IN (list#38336 []) && (ws_item_sk#219 = i_item_sk#564)) && ((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 9) && (ws_bill_addr_sk#223 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
                           :  +- Project [i_item_id#565]
                           :     +- Filter i_category#576 IN (Music)
                           :        +- SubqueryAlias `item`
                           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `web_sales`
                              :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :  +- SubqueryAlias `date_dim`
                              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `customer_address`
                              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 4.704751488s
Running execution q61-v2.4 iteration: 1, StandardRun=true
19/09/08 18:26:35 INFO Query: 
== Query: q61-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [promotions#38404 ASC NULLS FIRST, total#38405 ASC NULLS FIRST], true
      +- Project [promotions#38404, total#38405, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(promotions#38404 as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(total#38405 as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) as decimal(35,20))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(35,20)))), DecimalType(38,19)) AS (CAST((CAST(CAST(promotions AS DECIMAL(15,4)) AS DECIMAL(15,4)) / CAST(CAST(total AS DECIMAL(15,4)) AS DECIMAL(15,4))) AS DECIMAL(35,20)) * CAST(CAST(100 AS DECIMAL(3,0)) AS DECIMAL(35,20)))#38408]
         +- Join Cross
            :- SubqueryAlias `promotional_sales`
            :  +- Aggregate [sum(ss_ext_sales_price#145) AS promotions#38404]
            :     +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_promo_sk#138 = p_promo_sk#608)) && (((ss_customer_sk#133 = c_customer_sk#412) && (ca_address_sk#448 = c_current_addr_sk#416)) && (ss_item_sk#132 = i_item_sk#564))) && ((((cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (i_category#576 = Jewelry)) && (((p_channel_dmail#616 = Y) || (p_channel_email#617 = Y)) || (p_channel_tv#619 = Y))) && (((cast(s_gmt_offset#691 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (d_year#498 = 1998)) && (d_moy#500 = 11))))
            :        +- Join Inner
            :           :- Join Inner
            :           :  :- Join Inner
            :           :  :  :- Join Inner
            :           :  :  :  :- Join Inner
            :           :  :  :  :  :- Join Inner
            :           :  :  :  :  :  :- SubqueryAlias `store_sales`
            :           :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :           :  :  :  :  :  +- SubqueryAlias `store`
            :           :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
            :           :  :  :  :  +- SubqueryAlias `promotion`
            :           :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
            :           :  :  :  +- SubqueryAlias `date_dim`
            :           :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :           :  :  +- SubqueryAlias `customer`
            :           :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :           :  +- SubqueryAlias `customer_address`
            :           :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            :           +- SubqueryAlias `item`
            :              +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            +- SubqueryAlias `all_sales`
               +- Aggregate [sum(ss_ext_sales_price#145) AS total#38405]
                  +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_customer_sk#133 = c_customer_sk#412)) && ((ca_address_sk#448 = c_current_addr_sk#416) && (ss_item_sk#132 = i_item_sk#564))) && ((((cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (i_category#576 = Jewelry)) && (cast(s_gmt_offset#691 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))) && ((d_year#498 = 1998) && (d_moy#500 = 11))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  +- SubqueryAlias `date_dim`
                        :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  +- SubqueryAlias `customer`
                        :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  +- SubqueryAlias `customer_address`
                        :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:26:35 INFO Query: 
== Query: q61-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [promotions#38412 ASC NULLS FIRST, total#38413 ASC NULLS FIRST], true
      +- Project [promotions#38412, total#38413, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(promotions#38412 as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(total#38413 as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) as decimal(35,20))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(35,20)))), DecimalType(38,19)) AS (CAST((CAST(CAST(promotions AS DECIMAL(15,4)) AS DECIMAL(15,4)) / CAST(CAST(total AS DECIMAL(15,4)) AS DECIMAL(15,4))) AS DECIMAL(35,20)) * CAST(CAST(100 AS DECIMAL(3,0)) AS DECIMAL(35,20)))#38416]
         +- Join Cross
            :- SubqueryAlias `promotional_sales`
            :  +- Aggregate [sum(ss_ext_sales_price#145) AS promotions#38412]
            :     +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_promo_sk#138 = p_promo_sk#608)) && (((ss_customer_sk#133 = c_customer_sk#412) && (ca_address_sk#448 = c_current_addr_sk#416)) && (ss_item_sk#132 = i_item_sk#564))) && ((((cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (i_category#576 = Jewelry)) && (((p_channel_dmail#616 = Y) || (p_channel_email#617 = Y)) || (p_channel_tv#619 = Y))) && (((cast(s_gmt_offset#691 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (d_year#498 = 1998)) && (d_moy#500 = 11))))
            :        +- Join Inner
            :           :- Join Inner
            :           :  :- Join Inner
            :           :  :  :- Join Inner
            :           :  :  :  :- Join Inner
            :           :  :  :  :  :- Join Inner
            :           :  :  :  :  :  :- SubqueryAlias `store_sales`
            :           :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :           :  :  :  :  :  +- SubqueryAlias `store`
            :           :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
            :           :  :  :  :  +- SubqueryAlias `promotion`
            :           :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
            :           :  :  :  +- SubqueryAlias `date_dim`
            :           :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :           :  :  +- SubqueryAlias `customer`
            :           :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :           :  +- SubqueryAlias `customer_address`
            :           :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            :           +- SubqueryAlias `item`
            :              +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            +- SubqueryAlias `all_sales`
               +- Aggregate [sum(ss_ext_sales_price#145) AS total#38413]
                  +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_customer_sk#133 = c_customer_sk#412)) && ((ca_address_sk#448 = c_current_addr_sk#416) && (ss_item_sk#132 = i_item_sk#564))) && ((((cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (i_category#576 = Jewelry)) && (cast(s_gmt_offset#691 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))) && ((d_year#498 = 1998) && (d_moy#500 = 11))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  +- SubqueryAlias `date_dim`
                        :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  +- SubqueryAlias `customer`
                        :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  +- SubqueryAlias `customer_address`
                        :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 6.024411151000001s
Running execution q62-v2.4 iteration: 1, StandardRun=true
19/09/08 18:26:43 INFO Query: 
== Query: q62-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [substring(w_warehouse_name, 1, 20)#38486, sm_type#654, web_name#802, 30 days#38476L, 31-60 days#38477L, 61-90 days#38478L, 91-120 days#38479L, >120 days#38480L]
      +- Sort [substring(w_warehouse_name, 1, 20)#38486 ASC NULLS FIRST, sm_type#654 ASC NULLS FIRST, web_name#802 ASC NULLS FIRST], true
         +- Aggregate [substring(w_warehouse_name#744, 1, 20), sm_type#654, web_name#802], [substring(w_warehouse_name#744, 1, 20) AS substring(w_warehouse_name, 1, 20)#38486, sm_type#654, web_name#802, sum(cast(CASE WHEN ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days#38476L, sum(cast(CASE WHEN (((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 30) && ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31-60 days#38477L, sum(cast(CASE WHEN (((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 60) && ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61-90 days#38478L, sum(cast(CASE WHEN (((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 90) && ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91-120 days#38479L, sum(cast(CASE WHEN ((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days#38480L]
            +- Filter (((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (ws_ship_date_sk#218 = d_date_sk#492)) && (ws_warehouse_sk#231 = w_warehouse_sk#742)) && ((ws_ship_mode_sk#230 = sm_ship_mode_sk#652) && (ws_web_site_sk#229 = web_site_sk#798)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `web_sales`
                  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `warehouse`
                  :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :  :  +- SubqueryAlias `ship_mode`
                  :  :     +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet
                  :  +- SubqueryAlias `web_site`
                  :     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:26:43 INFO Query: 
== Query: q62-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [substring(w_warehouse_name, 1, 20)#38508, sm_type#654, web_name#802, 30 days#38498L, 31-60 days#38499L, 61-90 days#38500L, 91-120 days#38501L, >120 days#38502L]
      +- Sort [substring(w_warehouse_name, 1, 20)#38508 ASC NULLS FIRST, sm_type#654 ASC NULLS FIRST, web_name#802 ASC NULLS FIRST], true
         +- Aggregate [substring(w_warehouse_name#744, 1, 20), sm_type#654, web_name#802], [substring(w_warehouse_name#744, 1, 20) AS substring(w_warehouse_name, 1, 20)#38508, sm_type#654, web_name#802, sum(cast(CASE WHEN ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days#38498L, sum(cast(CASE WHEN (((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 30) && ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31-60 days#38499L, sum(cast(CASE WHEN (((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 60) && ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61-90 days#38500L, sum(cast(CASE WHEN (((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 90) && ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91-120 days#38501L, sum(cast(CASE WHEN ((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days#38502L]
            +- Filter (((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (ws_ship_date_sk#218 = d_date_sk#492)) && (ws_warehouse_sk#231 = w_warehouse_sk#742)) && ((ws_ship_mode_sk#230 = sm_ship_mode_sk#652) && (ws_web_site_sk#229 = web_site_sk#798)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `web_sales`
                  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `warehouse`
                  :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :  :  +- SubqueryAlias `ship_mode`
                  :  :     +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet
                  :  +- SubqueryAlias `web_site`
                  :     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 1.993553478s
Running execution q63-v2.4 iteration: 1, StandardRun=true
19/09/08 18:26:46 INFO Query: 
== Query: q63-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_manager_id#584 ASC NULLS FIRST, avg_monthly_sales#38588 ASC NULLS FIRST, sum_sales#38587 ASC NULLS FIRST], true
      +- Project [i_manager_id#584, sum_sales#38587, avg_monthly_sales#38588]
         +- Filter (cast(CASE WHEN (cast(avg_monthly_sales#38588 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#38587 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#38588 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#38588 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16)))
            +- SubqueryAlias `tmp1`
               +- Project [i_manager_id#584, sum_sales#38587, avg_monthly_sales#38588]
                  +- Project [i_manager_id#584, sum_sales#38587, _w0#38592, avg_monthly_sales#38588, avg_monthly_sales#38588]
                     +- Window [avg(_w0#38592) windowspecdefinition(i_manager_id#584, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#38588], [i_manager_id#584]
                        +- Aggregate [i_manager_id#584, d_moy#500], [i_manager_id#584, sum(ss_sales_price#143) AS sum_sales#38587, sum(ss_sales_price#143) AS _w0#38592]
                           +- Filter ((((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_store_sk#137 = s_store_sk#664)) && (d_month_seq#495 IN (1200,(1200 + 1),(1200 + 2),(1200 + 3),(1200 + 4),(1200 + 5),(1200 + 6),(1200 + 7),(1200 + 8),(1200 + 9),(1200 + 10),(1200 + 11)) && (((i_category#576 IN (Books,Children,Electronics) && i_class#574 IN (personal,portable,reference,self-help)) && i_brand#572 IN (scholaramalgamalg #14,scholaramalgamalg #7,exportiunivamalg #9,scholaramalgamalg #9)) || ((i_category#576 IN (Women,Music,Men) && i_class#574 IN (accessories,classical,fragrances,pants)) && i_brand#572 IN (amalgimporto #1,edu packscholar #1,exportiimporto #1,importoamalg #1)))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `item`
                                 :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :  :  +- SubqueryAlias `store_sales`
                                 :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `date_dim`
                                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- SubqueryAlias `store`
                                    +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/09/08 18:26:46 INFO Query: 
== Query: q63-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_manager_id#584 ASC NULLS FIRST, avg_monthly_sales#38597 ASC NULLS FIRST, sum_sales#38596 ASC NULLS FIRST], true
      +- Project [i_manager_id#584, sum_sales#38596, avg_monthly_sales#38597]
         +- Filter (cast(CASE WHEN (cast(avg_monthly_sales#38597 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#38596 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#38597 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#38597 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16)))
            +- SubqueryAlias `tmp1`
               +- Project [i_manager_id#584, sum_sales#38596, avg_monthly_sales#38597]
                  +- Project [i_manager_id#584, sum_sales#38596, _w0#38601, avg_monthly_sales#38597, avg_monthly_sales#38597]
                     +- Window [avg(_w0#38601) windowspecdefinition(i_manager_id#584, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#38597], [i_manager_id#584]
                        +- Aggregate [i_manager_id#584, d_moy#500], [i_manager_id#584, sum(ss_sales_price#143) AS sum_sales#38596, sum(ss_sales_price#143) AS _w0#38601]
                           +- Filter ((((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_store_sk#137 = s_store_sk#664)) && (d_month_seq#495 IN (1200,(1200 + 1),(1200 + 2),(1200 + 3),(1200 + 4),(1200 + 5),(1200 + 6),(1200 + 7),(1200 + 8),(1200 + 9),(1200 + 10),(1200 + 11)) && (((i_category#576 IN (Books,Children,Electronics) && i_class#574 IN (personal,portable,reference,self-help)) && i_brand#572 IN (scholaramalgamalg #14,scholaramalgamalg #7,exportiunivamalg #9,scholaramalgamalg #9)) || ((i_category#576 IN (Women,Music,Men) && i_class#574 IN (accessories,classical,fragrances,pants)) && i_brand#572 IN (amalgimporto #1,edu packscholar #1,exportiimporto #1,importoamalg #1)))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `item`
                                 :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :  :  +- SubqueryAlias `store_sales`
                                 :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `date_dim`
                                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- SubqueryAlias `store`
                                    +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 2.685755324s
Running execution q64-v2.4 iteration: 1, StandardRun=true
19/09/08 18:26:57 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#38830 ASC NULLS FIRST, store_name#38832 ASC NULLS FIRST, cnt#38967L ASC NULLS FIRST], true
+- Project [product_name#38830, store_name#38832, store_zip#38833, b_street_number#38834, b_streen_name#38835, b_city#38836, b_zip#38837, c_street_number#38838, c_street_name#38839, c_city#38840, c_zip#38841, syear#38842, cnt#38845L, s1#38846, s2#38847, s3#38848, s1#38968, s2#38969, s3#38970, syear#38964, cnt#38967L]
   +- Filter ((((item_sk#38831 = item_sk#38953) && (syear#38842 = 1999)) && (syear#38964 = (1999 + 1))) && (((cnt#38967L <= cnt#38845L) && (store_name#38832 = store_name#38954)) && (store_zip#38833 = store_zip#38955)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#38930, ca_street_name#38931, ca_city#38934, ca_zip#38937, d_year#498, d_year#38864, d_year#38892], [i_product_name#585 AS product_name#38830, i_item_sk#564 AS item_sk#38831, s_store_name#669 AS store_name#38832, s_zip#689 AS store_zip#38833, ca_street_number#450 AS b_street_number#38834, ca_street_name#451 AS b_streen_name#38835, ca_city#454 AS b_city#38836, ca_zip#457 AS b_zip#38837, ca_street_number#38930 AS c_street_number#38838, ca_street_name#38931 AS c_street_name#38839, ca_city#38934 AS c_city#38840, ca_zip#38937 AS c_zip#38841, d_year#498 AS syear#38842, d_year#38864 AS fsyear#38843, d_year#38892 AS s2year#38844, count(1) AS cnt#38845L, sum(ss_wholesale_cost#141) AS s1#38846, sum(ss_list_price#142) AS s2#38847, sum(ss_coupon_amt#149) AS s3#38848]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#38914)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#38923) && (c_current_addr_sk#416 = ca_address_sk#38928)) && (c_first_sales_date_sk#418 = d_date_sk#38858)) && (((c_first_shipto_date_sk#417 = d_date_sk#38886) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#38924 = ib_income_band_sk#38941) && NOT (cd_marital_status#476 = cd_marital_status#38916)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#38828, refund#38829]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#38854 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#38855 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#38828, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#38829, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#38854, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#38855]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#38858,d_date_id#38859,d_date#38860,d_month_seq#38861,d_week_seq#38862,d_quarter_seq#38863,d_year#38864,d_dow#38865,d_moy#38866,d_dom#38867,d_qoy#38868,d_fy_year#38869,d_fy_quarter_seq#38870,d_fy_week_seq#38871,d_day_name#38872,d_quarter_name#38873,d_holiday#38874,d_weekend#38875,d_following_holiday#38876,d_first_dom#38877,d_last_dom#38878,d_same_day_ly#38879,d_same_day_lq#38880,d_current_day#38881,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#38886,d_date_id#38887,d_date#38888,d_month_seq#38889,d_week_seq#38890,d_quarter_seq#38891,d_year#38892,d_dow#38893,d_moy#38894,d_dom#38895,d_qoy#38896,d_fy_year#38897,d_fy_quarter_seq#38898,d_fy_week_seq#38899,d_day_name#38900,d_quarter_name#38901,d_holiday#38902,d_weekend#38903,d_following_holiday#38904,d_first_dom#38905,d_last_dom#38906,d_same_day_ly#38907,d_same_day_lq#38908,d_current_day#38909,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#38914,cd_gender#38915,cd_marital_status#38916,cd_education_status#38917,cd_purchase_estimate#38918,cd_credit_rating#38919,cd_dep_count#38920,cd_dep_employed_count#38921,cd_dep_college_count#38922] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#38923,hd_income_band_sk#38924,hd_buy_potential#38925,hd_dep_count#38926,hd_vehicle_count#38927] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#38928,ca_address_id#38929,ca_street_number#38930,ca_street_name#38931,ca_street_type#38932,ca_suite_number#38933,ca_city#38934,ca_county#38935,ca_state#38936,ca_zip#38937,ca_country#38938,ca_gmt_offset#38939,ca_location_type#38940] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#38941,ib_lower_bound#38942,ib_upper_bound#38943] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#38930, ca_street_name#38931, ca_city#38934, ca_zip#38937, d_year#498, d_year#38864, d_year#38892], [i_product_name#585 AS product_name#38952, i_item_sk#564 AS item_sk#38953, s_store_name#669 AS store_name#38954, s_zip#689 AS store_zip#38955, ca_street_number#450 AS b_street_number#38956, ca_street_name#451 AS b_streen_name#38957, ca_city#454 AS b_city#38958, ca_zip#457 AS b_zip#38959, ca_street_number#38930 AS c_street_number#38960, ca_street_name#38931 AS c_street_name#38961, ca_city#38934 AS c_city#38962, ca_zip#38937 AS c_zip#38963, d_year#498 AS syear#38964, d_year#38864 AS fsyear#38965, d_year#38892 AS s2year#38966, count(1) AS cnt#38967L, sum(ss_wholesale_cost#141) AS s1#38968, sum(ss_list_price#142) AS s2#38969, sum(ss_coupon_amt#149) AS s3#38970]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#38914)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#38923) && (c_current_addr_sk#416 = ca_address_sk#38928)) && (c_first_sales_date_sk#418 = d_date_sk#38858)) && (((c_first_shipto_date_sk#417 = d_date_sk#38886) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#38924 = ib_income_band_sk#38941) && NOT (cd_marital_status#476 = cd_marital_status#38916)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#38828, refund#38829]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#38854 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#38855 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#38828, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#38829, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#38854, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#38855]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#38858,d_date_id#38859,d_date#38860,d_month_seq#38861,d_week_seq#38862,d_quarter_seq#38863,d_year#38864,d_dow#38865,d_moy#38866,d_dom#38867,d_qoy#38868,d_fy_year#38869,d_fy_quarter_seq#38870,d_fy_week_seq#38871,d_day_name#38872,d_quarter_name#38873,d_holiday#38874,d_weekend#38875,d_following_holiday#38876,d_first_dom#38877,d_last_dom#38878,d_same_day_ly#38879,d_same_day_lq#38880,d_current_day#38881,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#38886,d_date_id#38887,d_date#38888,d_month_seq#38889,d_week_seq#38890,d_quarter_seq#38891,d_year#38892,d_dow#38893,d_moy#38894,d_dom#38895,d_qoy#38896,d_fy_year#38897,d_fy_quarter_seq#38898,d_fy_week_seq#38899,d_day_name#38900,d_quarter_name#38901,d_holiday#38902,d_weekend#38903,d_following_holiday#38904,d_first_dom#38905,d_last_dom#38906,d_same_day_ly#38907,d_same_day_lq#38908,d_current_day#38909,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#38914,cd_gender#38915,cd_marital_status#38916,cd_education_status#38917,cd_purchase_estimate#38918,cd_credit_rating#38919,cd_dep_count#38920,cd_dep_employed_count#38921,cd_dep_college_count#38922] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#38923,hd_income_band_sk#38924,hd_buy_potential#38925,hd_dep_count#38926,hd_vehicle_count#38927] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#38928,ca_address_id#38929,ca_street_number#38930,ca_street_name#38931,ca_street_type#38932,ca_suite_number#38933,ca_city#38934,ca_county#38935,ca_state#38936,ca_zip#38937,ca_country#38938,ca_gmt_offset#38939,ca_location_type#38940] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#38941,ib_lower_bound#38942,ib_upper_bound#38943] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:26:57 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#38998 ASC NULLS FIRST, store_name#39000 ASC NULLS FIRST, cnt#39135L ASC NULLS FIRST], true
+- Project [product_name#38998, store_name#39000, store_zip#39001, b_street_number#39002, b_streen_name#39003, b_city#39004, b_zip#39005, c_street_number#39006, c_street_name#39007, c_city#39008, c_zip#39009, syear#39010, cnt#39013L, s1#39014, s2#39015, s3#39016, s1#39136, s2#39137, s3#39138, syear#39132, cnt#39135L]
   +- Filter ((((item_sk#38999 = item_sk#39121) && (syear#39010 = 1999)) && (syear#39132 = (1999 + 1))) && (((cnt#39135L <= cnt#39013L) && (store_name#39000 = store_name#39122)) && (store_zip#39001 = store_zip#39123)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#39098, ca_street_name#39099, ca_city#39102, ca_zip#39105, d_year#498, d_year#39032, d_year#39060], [i_product_name#585 AS product_name#38998, i_item_sk#564 AS item_sk#38999, s_store_name#669 AS store_name#39000, s_zip#689 AS store_zip#39001, ca_street_number#450 AS b_street_number#39002, ca_street_name#451 AS b_streen_name#39003, ca_city#454 AS b_city#39004, ca_zip#457 AS b_zip#39005, ca_street_number#39098 AS c_street_number#39006, ca_street_name#39099 AS c_street_name#39007, ca_city#39102 AS c_city#39008, ca_zip#39105 AS c_zip#39009, d_year#498 AS syear#39010, d_year#39032 AS fsyear#39011, d_year#39060 AS s2year#39012, count(1) AS cnt#39013L, sum(ss_wholesale_cost#141) AS s1#39014, sum(ss_list_price#142) AS s2#39015, sum(ss_coupon_amt#149) AS s3#39016]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#39082)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#39091) && (c_current_addr_sk#416 = ca_address_sk#39096)) && (c_first_sales_date_sk#418 = d_date_sk#39026)) && (((c_first_shipto_date_sk#417 = d_date_sk#39054) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#39092 = ib_income_band_sk#39109) && NOT (cd_marital_status#476 = cd_marital_status#39084)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#38996, refund#38997]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#39022 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#39023 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#38996, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#38997, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#39022, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#39023]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#39026,d_date_id#39027,d_date#39028,d_month_seq#39029,d_week_seq#39030,d_quarter_seq#39031,d_year#39032,d_dow#39033,d_moy#39034,d_dom#39035,d_qoy#39036,d_fy_year#39037,d_fy_quarter_seq#39038,d_fy_week_seq#39039,d_day_name#39040,d_quarter_name#39041,d_holiday#39042,d_weekend#39043,d_following_holiday#39044,d_first_dom#39045,d_last_dom#39046,d_same_day_ly#39047,d_same_day_lq#39048,d_current_day#39049,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#39054,d_date_id#39055,d_date#39056,d_month_seq#39057,d_week_seq#39058,d_quarter_seq#39059,d_year#39060,d_dow#39061,d_moy#39062,d_dom#39063,d_qoy#39064,d_fy_year#39065,d_fy_quarter_seq#39066,d_fy_week_seq#39067,d_day_name#39068,d_quarter_name#39069,d_holiday#39070,d_weekend#39071,d_following_holiday#39072,d_first_dom#39073,d_last_dom#39074,d_same_day_ly#39075,d_same_day_lq#39076,d_current_day#39077,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#39082,cd_gender#39083,cd_marital_status#39084,cd_education_status#39085,cd_purchase_estimate#39086,cd_credit_rating#39087,cd_dep_count#39088,cd_dep_employed_count#39089,cd_dep_college_count#39090] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#39091,hd_income_band_sk#39092,hd_buy_potential#39093,hd_dep_count#39094,hd_vehicle_count#39095] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#39096,ca_address_id#39097,ca_street_number#39098,ca_street_name#39099,ca_street_type#39100,ca_suite_number#39101,ca_city#39102,ca_county#39103,ca_state#39104,ca_zip#39105,ca_country#39106,ca_gmt_offset#39107,ca_location_type#39108] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#39109,ib_lower_bound#39110,ib_upper_bound#39111] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#39098, ca_street_name#39099, ca_city#39102, ca_zip#39105, d_year#498, d_year#39032, d_year#39060], [i_product_name#585 AS product_name#39120, i_item_sk#564 AS item_sk#39121, s_store_name#669 AS store_name#39122, s_zip#689 AS store_zip#39123, ca_street_number#450 AS b_street_number#39124, ca_street_name#451 AS b_streen_name#39125, ca_city#454 AS b_city#39126, ca_zip#457 AS b_zip#39127, ca_street_number#39098 AS c_street_number#39128, ca_street_name#39099 AS c_street_name#39129, ca_city#39102 AS c_city#39130, ca_zip#39105 AS c_zip#39131, d_year#498 AS syear#39132, d_year#39032 AS fsyear#39133, d_year#39060 AS s2year#39134, count(1) AS cnt#39135L, sum(ss_wholesale_cost#141) AS s1#39136, sum(ss_list_price#142) AS s2#39137, sum(ss_coupon_amt#149) AS s3#39138]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#39082)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#39091) && (c_current_addr_sk#416 = ca_address_sk#39096)) && (c_first_sales_date_sk#418 = d_date_sk#39026)) && (((c_first_shipto_date_sk#417 = d_date_sk#39054) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#39092 = ib_income_band_sk#39109) && NOT (cd_marital_status#476 = cd_marital_status#39084)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#38996, refund#38997]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#39022 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#39023 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#38996, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#38997, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#39022, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#39023]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#39026,d_date_id#39027,d_date#39028,d_month_seq#39029,d_week_seq#39030,d_quarter_seq#39031,d_year#39032,d_dow#39033,d_moy#39034,d_dom#39035,d_qoy#39036,d_fy_year#39037,d_fy_quarter_seq#39038,d_fy_week_seq#39039,d_day_name#39040,d_quarter_name#39041,d_holiday#39042,d_weekend#39043,d_following_holiday#39044,d_first_dom#39045,d_last_dom#39046,d_same_day_ly#39047,d_same_day_lq#39048,d_current_day#39049,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#39054,d_date_id#39055,d_date#39056,d_month_seq#39057,d_week_seq#39058,d_quarter_seq#39059,d_year#39060,d_dow#39061,d_moy#39062,d_dom#39063,d_qoy#39064,d_fy_year#39065,d_fy_quarter_seq#39066,d_fy_week_seq#39067,d_day_name#39068,d_quarter_name#39069,d_holiday#39070,d_weekend#39071,d_following_holiday#39072,d_first_dom#39073,d_last_dom#39074,d_same_day_ly#39075,d_same_day_lq#39076,d_current_day#39077,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#39082,cd_gender#39083,cd_marital_status#39084,cd_education_status#39085,cd_purchase_estimate#39086,cd_credit_rating#39087,cd_dep_count#39088,cd_dep_employed_count#39089,cd_dep_college_count#39090] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#39091,hd_income_band_sk#39092,hd_buy_potential#39093,hd_dep_count#39094,hd_vehicle_count#39095] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#39096,ca_address_id#39097,ca_street_number#39098,ca_street_name#39099,ca_street_type#39100,ca_suite_number#39101,ca_city#39102,ca_county#39103,ca_state#39104,ca_zip#39105,ca_country#39106,ca_gmt_offset#39107,ca_location_type#39108] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#39109,ib_lower_bound#39110,ib_upper_bound#39111] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 26.952060287000002s
Running execution q65-v2.4 iteration: 1, StandardRun=true
19/09/08 18:27:32 INFO Query: 
== Query: q65-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name#669 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST], true
      +- Project [s_store_name#669, i_item_desc#568, revenue#39582, i_current_price#569, i_wholesale_cost#570, i_brand#572]
         +- Filter (((ss_store_sk#137 = ss_store_sk#39593) && (cast(revenue#39582 as decimal(23,7)) <= cast(CheckOverflow((promote_precision(cast(0.1 as decimal(21,6))) * promote_precision(cast(ave#39581 as decimal(21,6)))), DecimalType(23,7)) as decimal(23,7)))) && ((s_store_sk#664 = ss_store_sk#39593) && (i_item_sk#564 = ss_item_sk#39588)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `store`
               :  :  :  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :  :  +- SubqueryAlias `item`
               :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- SubqueryAlias `sb`
               :     +- Aggregate [ss_store_sk#137], [ss_store_sk#137, avg(revenue#39580) AS ave#39581]
               :        +- SubqueryAlias `sa`
               :           +- Aggregate [ss_store_sk#137, ss_item_sk#132], [ss_store_sk#137, ss_item_sk#132, sum(ss_sales_price#143) AS revenue#39580]
               :              +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_month_seq#495 >= 1176) && (d_month_seq#495 <= (1176 + 11))))
               :                 +- Join Inner
               :                    :- SubqueryAlias `store_sales`
               :                    :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `sc`
                  +- Aggregate [ss_store_sk#39593, ss_item_sk#39588], [ss_store_sk#39593, ss_item_sk#39588, sum(ss_sales_price#39599) AS revenue#39582]
                     +- Filter ((ss_sold_date_sk#39586 = d_date_sk#492) && ((d_month_seq#495 >= 1176) && (d_month_seq#495 <= (1176 + 11))))
                        +- Join Inner
                           :- SubqueryAlias `store_sales`
                           :  +- Relation[ss_sold_date_sk#39586,ss_sold_time_sk#39587,ss_item_sk#39588,ss_customer_sk#39589,ss_cdemo_sk#39590,ss_hdemo_sk#39591,ss_addr_sk#39592,ss_store_sk#39593,ss_promo_sk#39594,ss_ticket_number#39595L,ss_quantity#39596,ss_wholesale_cost#39597,ss_list_price#39598,ss_sales_price#39599,ss_ext_discount_amt#39600,ss_ext_sales_price#39601,ss_ext_wholesale_cost#39602,ss_ext_list_price#39603,ss_ext_tax#39604,ss_coupon_amt#39605,ss_net_paid#39606,ss_net_paid_inc_tax#39607,ss_net_profit#39608] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:27:32 INFO Query: 
== Query: q65-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name#669 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST], true
      +- Project [s_store_name#669, i_item_desc#568, revenue#39617, i_current_price#569, i_wholesale_cost#570, i_brand#572]
         +- Filter (((ss_store_sk#137 = ss_store_sk#39628) && (cast(revenue#39617 as decimal(23,7)) <= cast(CheckOverflow((promote_precision(cast(0.1 as decimal(21,6))) * promote_precision(cast(ave#39616 as decimal(21,6)))), DecimalType(23,7)) as decimal(23,7)))) && ((s_store_sk#664 = ss_store_sk#39628) && (i_item_sk#564 = ss_item_sk#39623)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `store`
               :  :  :  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :  :  +- SubqueryAlias `item`
               :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- SubqueryAlias `sb`
               :     +- Aggregate [ss_store_sk#137], [ss_store_sk#137, avg(revenue#39615) AS ave#39616]
               :        +- SubqueryAlias `sa`
               :           +- Aggregate [ss_store_sk#137, ss_item_sk#132], [ss_store_sk#137, ss_item_sk#132, sum(ss_sales_price#143) AS revenue#39615]
               :              +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_month_seq#495 >= 1176) && (d_month_seq#495 <= (1176 + 11))))
               :                 +- Join Inner
               :                    :- SubqueryAlias `store_sales`
               :                    :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `sc`
                  +- Aggregate [ss_store_sk#39628, ss_item_sk#39623], [ss_store_sk#39628, ss_item_sk#39623, sum(ss_sales_price#39634) AS revenue#39617]
                     +- Filter ((ss_sold_date_sk#39621 = d_date_sk#492) && ((d_month_seq#495 >= 1176) && (d_month_seq#495 <= (1176 + 11))))
                        +- Join Inner
                           :- SubqueryAlias `store_sales`
                           :  +- Relation[ss_sold_date_sk#39621,ss_sold_time_sk#39622,ss_item_sk#39623,ss_customer_sk#39624,ss_cdemo_sk#39625,ss_hdemo_sk#39626,ss_addr_sk#39627,ss_store_sk#39628,ss_promo_sk#39629,ss_ticket_number#39630L,ss_quantity#39631,ss_wholesale_cost#39632,ss_list_price#39633,ss_sales_price#39634,ss_ext_discount_amt#39635,ss_ext_sales_price#39636,ss_ext_wholesale_cost#39637,ss_ext_list_price#39638,ss_ext_tax#39639,ss_coupon_amt#39640,ss_net_paid#39641,ss_net_paid_inc_tax#39642,ss_net_profit#39643] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 8.626623681s
Running execution q66-v2.4 iteration: 1, StandardRun=true
19/09/08 18:27:42 INFO Query: 
== Query: q66-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, ship_carriers#40164, year#40165, jan_sales#40216, feb_sales#40217, mar_sales#40218, apr_sales#40219, may_sales#40220, jun_sales#40221, jul_sales#40222, aug_sales#40223, sep_sales#40224, oct_sales#40225, nov_sales#40226, dec_sales#40227, jan_sales_per_sq_foot#40228, feb_sales_per_sq_foot#40229, mar_sales_per_sq_foot#40230, apr_sales_per_sq_foot#40231, ... 20 more fields]
      +- Sort [w_warehouse_name#744 ASC NULLS FIRST], true
         +- Aggregate [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, ship_carriers#40164, year#40165], [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, ship_carriers#40164, year#40165, sum(jan_sales#40166) AS jan_sales#40216, sum(feb_sales#40167) AS feb_sales#40217, sum(mar_sales#40168) AS mar_sales#40218, sum(apr_sales#40169) AS apr_sales#40219, sum(may_sales#40170) AS may_sales#40220, sum(jun_sales#40171) AS jun_sales#40221, sum(jul_sales#40172) AS jul_sales#40222, sum(aug_sales#40173) AS aug_sales#40223, sum(sep_sales#40174) AS sep_sales#40224, sum(oct_sales#40175) AS oct_sales#40225, sum(nov_sales#40176) AS nov_sales#40226, sum(dec_sales#40177) AS dec_sales#40227, sum(CheckOverflow((promote_precision(cast(jan_sales#40166 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS jan_sales_per_sq_foot#40228, sum(CheckOverflow((promote_precision(cast(feb_sales#40167 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS feb_sales_per_sq_foot#40229, sum(CheckOverflow((promote_precision(cast(mar_sales#40168 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS mar_sales_per_sq_foot#40230, sum(CheckOverflow((promote_precision(cast(apr_sales#40169 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS apr_sales_per_sq_foot#40231, ... 20 more fields]
            +- SubqueryAlias `x`
               +- Union
                  :- Aggregate [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, d_year#498], [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, concat(DHL, ,, BARIAN) AS ship_carriers#40164, d_year#498 AS year#40165, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_sales#40166, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_sales#40167, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_sales#40168, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_sales#40169, sum(CASE WHEN (d_moy#500 = 5) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS may_sales#40170, sum(CASE WHEN (d_moy#500 = 6) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jun_sales#40171, sum(CASE WHEN (d_moy#500 = 7) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jul_sales#40172, sum(CASE WHEN (d_moy#500 = 8) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS aug_sales#40173, sum(CASE WHEN (d_moy#500 = 9) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS sep_sales#40174, sum(CASE WHEN (d_moy#500 = 10) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS oct_sales#40175, sum(CASE WHEN (d_moy#500 = 11) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS nov_sales#40176, sum(CASE WHEN (d_moy#500 = 12) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS dec_sales#40177, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_net#40178, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_net#40179, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_net#40180, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_net#40181, ... 8 more fields]
                  :  +- Filter ((((ws_warehouse_sk#231 = w_warehouse_sk#742) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((ws_sold_time_sk#217 = t_time_sk#722) && (ws_ship_mode_sk#230 = sm_ship_mode_sk#652))) && (((d_year#498 = 2001) && ((t_time#724 >= 30838) && (t_time#724 <= (30838 + 28800)))) && sm_carrier#656 IN (DHL,BARIAN)))
                  :     +- Join Inner
                  :        :- Join Inner
                  :        :  :- Join Inner
                  :        :  :  :- Join Inner
                  :        :  :  :  :- SubqueryAlias `web_sales`
                  :        :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :        :  :  :  +- SubqueryAlias `warehouse`
                  :        :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :        :  :  +- SubqueryAlias `date_dim`
                  :        :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :        :  +- SubqueryAlias `time_dim`
                  :        :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                  :        +- SubqueryAlias `ship_mode`
                  :           +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet
                  +- Aggregate [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, d_year#498], [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, concat(DHL, ,, BARIAN) AS ship_carriers#40190, d_year#498 AS year#40191, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_sales#40192, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_sales#40193, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_sales#40194, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_sales#40195, sum(CASE WHEN (d_moy#500 = 5) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS may_sales#40196, sum(CASE WHEN (d_moy#500 = 6) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jun_sales#40197, sum(CASE WHEN (d_moy#500 = 7) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jul_sales#40198, sum(CASE WHEN (d_moy#500 = 8) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS aug_sales#40199, sum(CASE WHEN (d_moy#500 = 9) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS sep_sales#40200, sum(CASE WHEN (d_moy#500 = 10) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS oct_sales#40201, sum(CASE WHEN (d_moy#500 = 11) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS nov_sales#40202, sum(CASE WHEN (d_moy#500 = 12) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS dec_sales#40203, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_net#40204, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_net#40205, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_net#40206, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_net#40207, ... 8 more fields]
                     +- Filter ((((cs_warehouse_sk#14 = w_warehouse_sk#742) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((cs_sold_time_sk#1 = t_time_sk#722) && (cs_ship_mode_sk#13 = sm_ship_mode_sk#652))) && (((d_year#498 = 2001) && ((t_time#724 >= 30838) && (t_time#724 <= (30838 + 28800)))) && sm_carrier#656 IN (DHL,BARIAN)))
                        +- Join Inner
                           :- Join Inner
                           :  :- Join Inner
                           :  :  :- Join Inner
                           :  :  :  :- SubqueryAlias `catalog_sales`
                           :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :  :  :  +- SubqueryAlias `warehouse`
                           :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                           :  :  +- SubqueryAlias `date_dim`
                           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :  +- SubqueryAlias `time_dim`
                           :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                           +- SubqueryAlias `ship_mode`
                              +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet

     : benchmark
19/09/08 18:27:43 INFO Query: 
== Query: q66-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, ship_carriers#40381, year#40382, jan_sales#40433, feb_sales#40434, mar_sales#40435, apr_sales#40436, may_sales#40437, jun_sales#40438, jul_sales#40439, aug_sales#40440, sep_sales#40441, oct_sales#40442, nov_sales#40443, dec_sales#40444, jan_sales_per_sq_foot#40445, feb_sales_per_sq_foot#40446, mar_sales_per_sq_foot#40447, apr_sales_per_sq_foot#40448, ... 20 more fields]
      +- Sort [w_warehouse_name#744 ASC NULLS FIRST], true
         +- Aggregate [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, ship_carriers#40381, year#40382], [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, ship_carriers#40381, year#40382, sum(jan_sales#40383) AS jan_sales#40433, sum(feb_sales#40384) AS feb_sales#40434, sum(mar_sales#40385) AS mar_sales#40435, sum(apr_sales#40386) AS apr_sales#40436, sum(may_sales#40387) AS may_sales#40437, sum(jun_sales#40388) AS jun_sales#40438, sum(jul_sales#40389) AS jul_sales#40439, sum(aug_sales#40390) AS aug_sales#40440, sum(sep_sales#40391) AS sep_sales#40441, sum(oct_sales#40392) AS oct_sales#40442, sum(nov_sales#40393) AS nov_sales#40443, sum(dec_sales#40394) AS dec_sales#40444, sum(CheckOverflow((promote_precision(cast(jan_sales#40383 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS jan_sales_per_sq_foot#40445, sum(CheckOverflow((promote_precision(cast(feb_sales#40384 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS feb_sales_per_sq_foot#40446, sum(CheckOverflow((promote_precision(cast(mar_sales#40385 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS mar_sales_per_sq_foot#40447, sum(CheckOverflow((promote_precision(cast(apr_sales#40386 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS apr_sales_per_sq_foot#40448, ... 20 more fields]
            +- SubqueryAlias `x`
               +- Union
                  :- Aggregate [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, d_year#498], [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, concat(DHL, ,, BARIAN) AS ship_carriers#40381, d_year#498 AS year#40382, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_sales#40383, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_sales#40384, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_sales#40385, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_sales#40386, sum(CASE WHEN (d_moy#500 = 5) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS may_sales#40387, sum(CASE WHEN (d_moy#500 = 6) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jun_sales#40388, sum(CASE WHEN (d_moy#500 = 7) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jul_sales#40389, sum(CASE WHEN (d_moy#500 = 8) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS aug_sales#40390, sum(CASE WHEN (d_moy#500 = 9) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS sep_sales#40391, sum(CASE WHEN (d_moy#500 = 10) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS oct_sales#40392, sum(CASE WHEN (d_moy#500 = 11) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS nov_sales#40393, sum(CASE WHEN (d_moy#500 = 12) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS dec_sales#40394, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_net#40395, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_net#40396, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_net#40397, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_net#40398, ... 8 more fields]
                  :  +- Filter ((((ws_warehouse_sk#231 = w_warehouse_sk#742) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((ws_sold_time_sk#217 = t_time_sk#722) && (ws_ship_mode_sk#230 = sm_ship_mode_sk#652))) && (((d_year#498 = 2001) && ((t_time#724 >= 30838) && (t_time#724 <= (30838 + 28800)))) && sm_carrier#656 IN (DHL,BARIAN)))
                  :     +- Join Inner
                  :        :- Join Inner
                  :        :  :- Join Inner
                  :        :  :  :- Join Inner
                  :        :  :  :  :- SubqueryAlias `web_sales`
                  :        :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :        :  :  :  +- SubqueryAlias `warehouse`
                  :        :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :        :  :  +- SubqueryAlias `date_dim`
                  :        :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :        :  +- SubqueryAlias `time_dim`
                  :        :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                  :        +- SubqueryAlias `ship_mode`
                  :           +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet
                  +- Aggregate [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, d_year#498], [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, concat(DHL, ,, BARIAN) AS ship_carriers#40407, d_year#498 AS year#40408, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_sales#40409, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_sales#40410, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_sales#40411, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_sales#40412, sum(CASE WHEN (d_moy#500 = 5) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS may_sales#40413, sum(CASE WHEN (d_moy#500 = 6) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jun_sales#40414, sum(CASE WHEN (d_moy#500 = 7) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jul_sales#40415, sum(CASE WHEN (d_moy#500 = 8) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS aug_sales#40416, sum(CASE WHEN (d_moy#500 = 9) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS sep_sales#40417, sum(CASE WHEN (d_moy#500 = 10) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS oct_sales#40418, sum(CASE WHEN (d_moy#500 = 11) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS nov_sales#40419, sum(CASE WHEN (d_moy#500 = 12) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS dec_sales#40420, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_net#40421, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_net#40422, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_net#40423, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_net#40424, ... 8 more fields]
                     +- Filter ((((cs_warehouse_sk#14 = w_warehouse_sk#742) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((cs_sold_time_sk#1 = t_time_sk#722) && (cs_ship_mode_sk#13 = sm_ship_mode_sk#652))) && (((d_year#498 = 2001) && ((t_time#724 >= 30838) && (t_time#724 <= (30838 + 28800)))) && sm_carrier#656 IN (DHL,BARIAN)))
                        +- Join Inner
                           :- Join Inner
                           :  :- Join Inner
                           :  :  :- Join Inner
                           :  :  :  :- SubqueryAlias `catalog_sales`
                           :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :  :  :  +- SubqueryAlias `warehouse`
                           :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                           :  :  +- SubqueryAlias `date_dim`
                           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :  +- SubqueryAlias `time_dim`
                           :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                           +- SubqueryAlias `ship_mode`
                              +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet

      running Thread[benchmark runner,5,main]
Execution time: 5.011651592s
Running execution q67-v2.4 iteration: 1, StandardRun=true
19/09/08 18:27:50 INFO Query: 
== Query: q67-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#41306 ASC NULLS FIRST, i_class#41307 ASC NULLS FIRST, i_brand#41308 ASC NULLS FIRST, i_product_name#41309 ASC NULLS FIRST, d_year#41310 ASC NULLS FIRST, d_qoy#41311 ASC NULLS FIRST, d_moy#41312 ASC NULLS FIRST, s_store_id#41313 ASC NULLS FIRST, sumsales#41292 ASC NULLS FIRST, rk#41293 ASC NULLS FIRST], true
      +- Project [i_category#41306, i_class#41307, i_brand#41308, i_product_name#41309, d_year#41310, d_qoy#41311, d_moy#41312, s_store_id#41313, sumsales#41292, rk#41293]
         +- Filter (rk#41293 <= 100)
            +- SubqueryAlias `dw2`
               +- Project [i_category#41306, i_class#41307, i_brand#41308, i_product_name#41309, d_year#41310, d_qoy#41311, d_moy#41312, s_store_id#41313, sumsales#41292, rk#41293]
                  +- Project [i_category#41306, i_class#41307, i_brand#41308, i_product_name#41309, d_year#41310, d_qoy#41311, d_moy#41312, s_store_id#41313, sumsales#41292, rk#41293, rk#41293]
                     +- Window [rank(sumsales#41292) windowspecdefinition(i_category#41306, sumsales#41292 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#41293], [i_category#41306], [sumsales#41292 DESC NULLS LAST]
                        +- Project [i_category#41306, i_class#41307, i_brand#41308, i_product_name#41309, d_year#41310, d_qoy#41311, d_moy#41312, s_store_id#41313, sumsales#41292]
                           +- SubqueryAlias `dw1`
                              +- Aggregate [i_category#41306, i_class#41307, i_brand#41308, i_product_name#41309, d_year#41310, d_qoy#41311, d_moy#41312, s_store_id#41313, spark_grouping_id#41297], [i_category#41306, i_class#41307, i_brand#41308, i_product_name#41309, d_year#41310, d_qoy#41311, d_moy#41312, s_store_id#41313, sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#143 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)), cast(0 as decimal(18,2)))) AS sumsales#41292]
                                 +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41298, i_class#41299, i_brand#41300, i_product_name#41301, d_year#41302, d_qoy#41303, d_moy#41304, s_store_id#41305, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41298, i_class#41299, i_brand#41300, i_product_name#41301, d_year#41302, d_qoy#41303, d_moy#41304, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41298, i_class#41299, i_brand#41300, i_product_name#41301, d_year#41302, d_qoy#41303, null, null, 3), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41298, i_class#41299, i_brand#41300, i_product_name#41301, d_year#41302, null, null, null, 7), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41298, i_class#41299, i_brand#41300, i_product_name#41301, null, null, null, null, 15), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41298, i_class#41299, i_brand#41300, null, null, null, null, null, 31), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41298, i_class#41299, null, null, null, null, null, null, 63), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41298, null, null, null, null, null, null, null, 127), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, null, null, null, null, null, null, 255)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 87 more fields]
                                    +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 86 more fields]
                                       +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_store_sk#137 = s_store_sk#664) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11)))))
                                          +- Join Inner
                                             :- Join Inner
                                             :  :- Join Inner
                                             :  :  :- SubqueryAlias `store_sales`
                                             :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                             :  :  +- SubqueryAlias `date_dim`
                                             :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                             :  +- SubqueryAlias `store`
                                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                                             +- SubqueryAlias `item`
                                                +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:27:50 INFO Query: 
== Query: q67-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#41347 ASC NULLS FIRST, i_class#41348 ASC NULLS FIRST, i_brand#41349 ASC NULLS FIRST, i_product_name#41350 ASC NULLS FIRST, d_year#41351 ASC NULLS FIRST, d_qoy#41352 ASC NULLS FIRST, d_moy#41353 ASC NULLS FIRST, s_store_id#41354 ASC NULLS FIRST, sumsales#41333 ASC NULLS FIRST, rk#41334 ASC NULLS FIRST], true
      +- Project [i_category#41347, i_class#41348, i_brand#41349, i_product_name#41350, d_year#41351, d_qoy#41352, d_moy#41353, s_store_id#41354, sumsales#41333, rk#41334]
         +- Filter (rk#41334 <= 100)
            +- SubqueryAlias `dw2`
               +- Project [i_category#41347, i_class#41348, i_brand#41349, i_product_name#41350, d_year#41351, d_qoy#41352, d_moy#41353, s_store_id#41354, sumsales#41333, rk#41334]
                  +- Project [i_category#41347, i_class#41348, i_brand#41349, i_product_name#41350, d_year#41351, d_qoy#41352, d_moy#41353, s_store_id#41354, sumsales#41333, rk#41334, rk#41334]
                     +- Window [rank(sumsales#41333) windowspecdefinition(i_category#41347, sumsales#41333 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#41334], [i_category#41347], [sumsales#41333 DESC NULLS LAST]
                        +- Project [i_category#41347, i_class#41348, i_brand#41349, i_product_name#41350, d_year#41351, d_qoy#41352, d_moy#41353, s_store_id#41354, sumsales#41333]
                           +- SubqueryAlias `dw1`
                              +- Aggregate [i_category#41347, i_class#41348, i_brand#41349, i_product_name#41350, d_year#41351, d_qoy#41352, d_moy#41353, s_store_id#41354, spark_grouping_id#41338], [i_category#41347, i_class#41348, i_brand#41349, i_product_name#41350, d_year#41351, d_qoy#41352, d_moy#41353, s_store_id#41354, sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#143 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)), cast(0 as decimal(18,2)))) AS sumsales#41333]
                                 +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41339, i_class#41340, i_brand#41341, i_product_name#41342, d_year#41343, d_qoy#41344, d_moy#41345, s_store_id#41346, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41339, i_class#41340, i_brand#41341, i_product_name#41342, d_year#41343, d_qoy#41344, d_moy#41345, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41339, i_class#41340, i_brand#41341, i_product_name#41342, d_year#41343, d_qoy#41344, null, null, 3), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41339, i_class#41340, i_brand#41341, i_product_name#41342, d_year#41343, null, null, null, 7), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41339, i_class#41340, i_brand#41341, i_product_name#41342, null, null, null, null, 15), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41339, i_class#41340, i_brand#41341, null, null, null, null, null, 31), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41339, i_class#41340, null, null, null, null, null, null, 63), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41339, null, null, null, null, null, null, null, 127), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, null, null, null, null, null, null, 255)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 87 more fields]
                                    +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 86 more fields]
                                       +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_store_sk#137 = s_store_sk#664) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11)))))
                                          +- Join Inner
                                             :- Join Inner
                                             :  :- Join Inner
                                             :  :  :- SubqueryAlias `store_sales`
                                             :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                             :  :  +- SubqueryAlias `date_dim`
                                             :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                             :  +- SubqueryAlias `store`
                                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                                             +- SubqueryAlias `item`
                                                +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 68.321441156s
Running execution q68-v2.4 iteration: 1, StandardRun=true
19/09/08 18:28:59 INFO Query: 
== Query: q68-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_last_name#421 ASC NULLS FIRST, ss_ticket_number#139L ASC NULLS FIRST], true
      +- Project [c_last_name#421, c_first_name#420, ca_city#454, bought_city#41480, ss_ticket_number#139L, extended_price#41481, extended_tax#41483, list_price#41482]
         +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && NOT (ca_city#454 = bought_city#41480))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dn`
               :  :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133, ss_addr_sk#136, ca_city#454], [ss_ticket_number#139L, ss_customer_sk#133, ca_city#454 AS bought_city#41480, sum(ss_ext_sales_price#145) AS extended_price#41481, sum(ss_ext_list_price#147) AS list_price#41482, sum(ss_ext_tax#148) AS extended_tax#41483]
               :  :     +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_hdemo_sk#135 = hd_demo_sk#548) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((d_dom#501 >= 1) && (d_dom#501 <= 2)) && ((hd_dep_count#551 = 4) || (hd_vehicle_count#552 = 3))) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_city#686 IN (Midway,Fairview))))
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- Join Inner
               :  :           :  :  :- Join Inner
               :  :           :  :  :  :- SubqueryAlias `store_sales`
               :  :           :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  :  :  +- SubqueryAlias `date_dim`
               :  :           :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           :  :  +- SubqueryAlias `store`
               :  :           :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :  :           :  +- SubqueryAlias `household_demographics`
               :  :           :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  :           +- SubqueryAlias `customer_address`
               :  :              +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer`
               :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               +- SubqueryAlias `current_addr`
                  +- SubqueryAlias `customer_address`
                     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

     : benchmark
19/09/08 18:28:59 INFO Query: 
== Query: q68-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_last_name#421 ASC NULLS FIRST, ss_ticket_number#139L ASC NULLS FIRST], true
      +- Project [c_last_name#421, c_first_name#420, ca_city#454, bought_city#41495, ss_ticket_number#139L, extended_price#41496, extended_tax#41498, list_price#41497]
         +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && NOT (ca_city#454 = bought_city#41495))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dn`
               :  :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133, ss_addr_sk#136, ca_city#454], [ss_ticket_number#139L, ss_customer_sk#133, ca_city#454 AS bought_city#41495, sum(ss_ext_sales_price#145) AS extended_price#41496, sum(ss_ext_list_price#147) AS list_price#41497, sum(ss_ext_tax#148) AS extended_tax#41498]
               :  :     +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_hdemo_sk#135 = hd_demo_sk#548) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((d_dom#501 >= 1) && (d_dom#501 <= 2)) && ((hd_dep_count#551 = 4) || (hd_vehicle_count#552 = 3))) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_city#686 IN (Midway,Fairview))))
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- Join Inner
               :  :           :  :  :- Join Inner
               :  :           :  :  :  :- SubqueryAlias `store_sales`
               :  :           :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  :  :  +- SubqueryAlias `date_dim`
               :  :           :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           :  :  +- SubqueryAlias `store`
               :  :           :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :  :           :  +- SubqueryAlias `household_demographics`
               :  :           :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  :           +- SubqueryAlias `customer_address`
               :  :              +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer`
               :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               +- SubqueryAlias `current_addr`
                  +- SubqueryAlias `customer_address`
                     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

      running Thread[benchmark runner,5,main]
Execution time: 5.099264187s
Running execution q69-v2.4 iteration: 1, StandardRun=true
19/09/08 18:29:06 INFO Query: 
== Query: q69-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cd_gender#475 ASC NULLS FIRST, cd_marital_status#476 ASC NULLS FIRST, cd_education_status#477 ASC NULLS FIRST, cd_purchase_estimate#478 ASC NULLS FIRST, cd_credit_rating#479 ASC NULLS FIRST], true
      +- Aggregate [cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479], [cd_gender#475, cd_marital_status#476, cd_education_status#477, count(1) AS cnt1#41566L, cd_purchase_estimate#478, count(1) AS cnt2#41567L, cd_credit_rating#479, count(1) AS cnt3#41568L]
         +- Filter ((((c_current_addr_sk#416 = ca_address_sk#448) && ca_state#456 IN (KY,GA,NM)) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && (exists#41569 [c_customer_sk#412] && (NOT exists#41570 [c_customer_sk#412] && NOT exists#41571 [c_customer_sk#412])))
            :  :- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 27 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = 2001) && ((d_moy#500 >= 4) && (d_moy#500 <= (4 + 2)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `store_sales`
            :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 38 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = 2001) && ((d_moy#500 >= 4) && (d_moy#500 <= (4 + 2)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `web_sales`
            :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 38 more fields]
            :     +- Filter (((outer(c_customer_sk#412) = cs_ship_customer_sk#7) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = 2001) && ((d_moy#500 >= 4) && (d_moy#500 <= (4 + 2)))))
            :        +- Join Inner
            :           :- SubqueryAlias `catalog_sales`
            :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :           +- SubqueryAlias `date_dim`
            :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `c`
               :  :  +- SubqueryAlias `customer`
               :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  +- SubqueryAlias `ca`
               :     +- SubqueryAlias `customer_address`
               :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer_demographics`
                  +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet

     : benchmark
19/09/08 18:29:06 INFO Query: 
== Query: q69-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cd_gender#475 ASC NULLS FIRST, cd_marital_status#476 ASC NULLS FIRST, cd_education_status#477 ASC NULLS FIRST, cd_purchase_estimate#478 ASC NULLS FIRST, cd_credit_rating#479 ASC NULLS FIRST], true
      +- Aggregate [cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479], [cd_gender#475, cd_marital_status#476, cd_education_status#477, count(1) AS cnt1#41583L, cd_purchase_estimate#478, count(1) AS cnt2#41584L, cd_credit_rating#479, count(1) AS cnt3#41585L]
         +- Filter ((((c_current_addr_sk#416 = ca_address_sk#448) && ca_state#456 IN (KY,GA,NM)) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && (exists#41586 [c_customer_sk#412] && (NOT exists#41587 [c_customer_sk#412] && NOT exists#41588 [c_customer_sk#412])))
            :  :- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 27 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = 2001) && ((d_moy#500 >= 4) && (d_moy#500 <= (4 + 2)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `store_sales`
            :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 38 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = 2001) && ((d_moy#500 >= 4) && (d_moy#500 <= (4 + 2)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `web_sales`
            :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 38 more fields]
            :     +- Filter (((outer(c_customer_sk#412) = cs_ship_customer_sk#7) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = 2001) && ((d_moy#500 >= 4) && (d_moy#500 <= (4 + 2)))))
            :        +- Join Inner
            :           :- SubqueryAlias `catalog_sales`
            :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :           +- SubqueryAlias `date_dim`
            :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `c`
               :  :  +- SubqueryAlias `customer`
               :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  +- SubqueryAlias `ca`
               :     +- SubqueryAlias `customer_address`
               :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer_demographics`
                  +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet

      running Thread[benchmark runner,5,main]
Execution time: 16.542661824s
Running execution q70-v2.4 iteration: 1, StandardRun=true
19/09/08 18:29:24 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#41704 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#41704 as int) = 0) THEN s_state#41726 END ASC NULLS FIRST, rank_within_parent#41705 ASC NULLS FIRST], true
      +- Project [total_sum#41703, s_state#41726, s_county#41727, lochierarchy#41704, rank_within_parent#41705]
         +- Project [total_sum#41703, s_state#41726, s_county#41727, lochierarchy#41704, _w0#41736, _w1#41740, _w2#41741, _w3#41742, rank_within_parent#41705, rank_within_parent#41705]
            +- Window [rank(_w3#41742) windowspecdefinition(_w1#41740, _w2#41741, _w3#41742 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#41705], [_w1#41740, _w2#41741], [_w3#41742 DESC NULLS LAST]
               +- Aggregate [s_state#41726, s_county#41727, spark_grouping_id#41723], [sum(ss_net_profit#152) AS total_sum#41703, s_state#41726, s_county#41727, (cast((shiftright(spark_grouping_id#41723, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#41723, 0) & 1) as tinyint)) AS lochierarchy#41704, sum(ss_net_profit#152) AS _w0#41736, (cast((shiftright(spark_grouping_id#41723, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#41723, 0) & 1) as tinyint)) AS _w1#41740, CASE WHEN (cast(cast((shiftright(spark_grouping_id#41723, 0) & 1) as tinyint) as int) = 0) THEN s_state#41726 END AS _w2#41741, sum(ss_net_profit#152) AS _w3#41742]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#41724, s_county#41725, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#41724, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#41708 [])))
                           :  +- Project [s_state#41706]
                           :     +- Filter (ranking#41707 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#41706, ranking#41707]
                           :              +- Project [s_state#41706, s_state#688, _w1#41714, ranking#41707, ranking#41707]
                           :                 +- Window [rank(_w1#41714) windowspecdefinition(s_state#688, _w1#41714 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#41707], [s_state#688], [_w1#41714 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#41706, s_state#688, sum(ss_net_profit#152) AS _w1#41714]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/09/08 18:29:24 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#41758 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#41758 as int) = 0) THEN s_state#41780 END ASC NULLS FIRST, rank_within_parent#41759 ASC NULLS FIRST], true
      +- Project [total_sum#41757, s_state#41780, s_county#41781, lochierarchy#41758, rank_within_parent#41759]
         +- Project [total_sum#41757, s_state#41780, s_county#41781, lochierarchy#41758, _w0#41790, _w1#41794, _w2#41795, _w3#41796, rank_within_parent#41759, rank_within_parent#41759]
            +- Window [rank(_w3#41796) windowspecdefinition(_w1#41794, _w2#41795, _w3#41796 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#41759], [_w1#41794, _w2#41795], [_w3#41796 DESC NULLS LAST]
               +- Aggregate [s_state#41780, s_county#41781, spark_grouping_id#41777], [sum(ss_net_profit#152) AS total_sum#41757, s_state#41780, s_county#41781, (cast((shiftright(spark_grouping_id#41777, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#41777, 0) & 1) as tinyint)) AS lochierarchy#41758, sum(ss_net_profit#152) AS _w0#41790, (cast((shiftright(spark_grouping_id#41777, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#41777, 0) & 1) as tinyint)) AS _w1#41794, CASE WHEN (cast(cast((shiftright(spark_grouping_id#41777, 0) & 1) as tinyint) as int) = 0) THEN s_state#41780 END AS _w2#41795, sum(ss_net_profit#152) AS _w3#41796]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#41778, s_county#41779, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#41778, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#41762 [])))
                           :  +- Project [s_state#41760]
                           :     +- Filter (ranking#41761 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#41760, ranking#41761]
                           :              +- Project [s_state#41760, s_state#688, _w1#41768, ranking#41761, ranking#41761]
                           :                 +- Window [rank(_w1#41768) windowspecdefinition(s_state#688, _w1#41768 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#41761], [s_state#688], [_w1#41768 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#41760, s_state#688, sum(ss_net_profit#152) AS _w1#41768]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 4.701627663s
Running execution q71-v2.4 iteration: 1, StandardRun=true
19/09/08 18:29:30 INFO Query: 
== Query: q71-v2.4 ==
Project [brand_id#41970, brand#41971, t_hour#725, t_minute#726, ext_price#41972]
+- Sort [ext_price#41972 DESC NULLS LAST, brand_id#41970 ASC NULLS FIRST], true
   +- Aggregate [i_brand#572, i_brand_id#571, t_hour#725, t_minute#726], [i_brand_id#571 AS brand_id#41970, i_brand#572 AS brand#41971, t_hour#725, t_minute#726, sum(ext_price#41958) AS ext_price#41972]
      +- Filter (((sold_item_sk#41960 = i_item_sk#564) && (i_manager_id#584 = 1)) && ((time_sk#41961 = t_time_sk#722) && ((t_meal_time#731 = breakfast) || (t_meal_time#731 = dinner))))
         +- Join Inner
            :- Join Inner
            :  :- SubqueryAlias `item`
            :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            :  +- SubqueryAlias `tmp`
            :     +- Union
            :        :- Union
            :        :  :- Project [ws_ext_sales_price#239 AS ext_price#41958, ws_sold_date_sk#216 AS sold_date_sk#41959, ws_item_sk#219 AS sold_item_sk#41960, ws_sold_time_sk#217 AS time_sk#41961]
            :        :  :  +- Filter (((d_date_sk#492 = ws_sold_date_sk#216) && (d_moy#500 = 11)) && (d_year#498 = 1999))
            :        :  :     +- Join Inner
            :        :  :        :- SubqueryAlias `web_sales`
            :        :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :        :  :        +- SubqueryAlias `date_dim`
            :        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :        :  +- Project [cs_ext_sales_price#23 AS ext_price#41962, cs_sold_date_sk#0 AS sold_date_sk#41963, cs_item_sk#15 AS sold_item_sk#41964, cs_sold_time_sk#1 AS time_sk#41965]
            :        :     +- Filter (((d_date_sk#492 = cs_sold_date_sk#0) && (d_moy#500 = 11)) && (d_year#498 = 1999))
            :        :        +- Join Inner
            :        :           :- SubqueryAlias `catalog_sales`
            :        :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :        :           +- SubqueryAlias `date_dim`
            :        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :        +- Project [ss_ext_sales_price#145 AS ext_price#41966, ss_sold_date_sk#130 AS sold_date_sk#41967, ss_item_sk#132 AS sold_item_sk#41968, ss_sold_time_sk#131 AS time_sk#41969]
            :           +- Filter (((d_date_sk#492 = ss_sold_date_sk#130) && (d_moy#500 = 11)) && (d_year#498 = 1999))
            :              +- Join Inner
            :                 :- SubqueryAlias `store_sales`
            :                 :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :                 +- SubqueryAlias `date_dim`
            :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- SubqueryAlias `time_dim`
               +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet

     : benchmark
19/09/08 18:29:30 INFO Query: 
== Query: q71-v2.4 ==
Project [brand_id#41994, brand#41995, t_hour#725, t_minute#726, ext_price#41996]
+- Sort [ext_price#41996 DESC NULLS LAST, brand_id#41994 ASC NULLS FIRST], true
   +- Aggregate [i_brand#572, i_brand_id#571, t_hour#725, t_minute#726], [i_brand_id#571 AS brand_id#41994, i_brand#572 AS brand#41995, t_hour#725, t_minute#726, sum(ext_price#41982) AS ext_price#41996]
      +- Filter (((sold_item_sk#41984 = i_item_sk#564) && (i_manager_id#584 = 1)) && ((time_sk#41985 = t_time_sk#722) && ((t_meal_time#731 = breakfast) || (t_meal_time#731 = dinner))))
         +- Join Inner
            :- Join Inner
            :  :- SubqueryAlias `item`
            :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            :  +- SubqueryAlias `tmp`
            :     +- Union
            :        :- Union
            :        :  :- Project [ws_ext_sales_price#239 AS ext_price#41982, ws_sold_date_sk#216 AS sold_date_sk#41983, ws_item_sk#219 AS sold_item_sk#41984, ws_sold_time_sk#217 AS time_sk#41985]
            :        :  :  +- Filter (((d_date_sk#492 = ws_sold_date_sk#216) && (d_moy#500 = 11)) && (d_year#498 = 1999))
            :        :  :     +- Join Inner
            :        :  :        :- SubqueryAlias `web_sales`
            :        :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :        :  :        +- SubqueryAlias `date_dim`
            :        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :        :  +- Project [cs_ext_sales_price#23 AS ext_price#41986, cs_sold_date_sk#0 AS sold_date_sk#41987, cs_item_sk#15 AS sold_item_sk#41988, cs_sold_time_sk#1 AS time_sk#41989]
            :        :     +- Filter (((d_date_sk#492 = cs_sold_date_sk#0) && (d_moy#500 = 11)) && (d_year#498 = 1999))
            :        :        +- Join Inner
            :        :           :- SubqueryAlias `catalog_sales`
            :        :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :        :           +- SubqueryAlias `date_dim`
            :        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :        +- Project [ss_ext_sales_price#145 AS ext_price#41990, ss_sold_date_sk#130 AS sold_date_sk#41991, ss_item_sk#132 AS sold_item_sk#41992, ss_sold_time_sk#131 AS time_sk#41993]
            :           +- Filter (((d_date_sk#492 = ss_sold_date_sk#130) && (d_moy#500 = 11)) && (d_year#498 = 1999))
            :              +- Join Inner
            :                 :- SubqueryAlias `store_sales`
            :                 :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :                 +- SubqueryAlias `date_dim`
            :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- SubqueryAlias `time_dim`
               +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet

      running Thread[benchmark runner,5,main]
Execution time: 4.1980774080000005s
Running execution q72-v2.4 iteration: 1, StandardRun=true
19/09/08 18:29:35 INFO Query: 
== Query: q72-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [total_cnt#42137L DESC NULLS LAST, i_item_desc#568 ASC NULLS FIRST, w_warehouse_name#744 ASC NULLS FIRST, d_week_seq#496 ASC NULLS FIRST], true
      +- Aggregate [i_item_desc#568, w_warehouse_name#744, d_week_seq#496], [i_item_desc#568, w_warehouse_name#744, d_week_seq#496, sum(cast(CASE WHEN isnull(p_promo_sk#608) THEN 1 ELSE 0 END as bigint)) AS no_promo#42135L, sum(cast(CASE WHEN isnotnull(p_promo_sk#608) THEN 1 ELSE 0 END as bigint)) AS promo#42136L, count(1) AS total_cnt#42137L]
         +- Filter ((((d_week_seq#496 = d_week_seq#42142) && (inv_quantity_on_hand#125 < cs_quantity#18)) && (d_date#42169 > cast(cast(cast(d_date#494 as date) as timestamp) + interval 5 days as date))) && (((hd_buy_potential#550 = >10000) && (d_year#498 = 1999)) && (cd_marital_status#476 = D)))
            +- Join LeftOuter, ((cr_item_sk#70 = cs_item_sk#15) && (cr_order_number#84L = cs_order_number#17L))
               :- Join LeftOuter, (cs_promo_sk#16 = p_promo_sk#608)
               :  :- Join Inner, (cs_ship_date_sk#2 = d_date_sk#42167)
               :  :  :- Join Inner, (inv_date_sk#122 = d_date_sk#42138)
               :  :  :  :- Join Inner, (cs_sold_date_sk#0 = d_date_sk#492)
               :  :  :  :  :- Join Inner, (cs_bill_hdemo_sk#5 = hd_demo_sk#548)
               :  :  :  :  :  :- Join Inner, (cs_bill_cdemo_sk#4 = cd_demo_sk#474)
               :  :  :  :  :  :  :- Join Inner, (i_item_sk#564 = cs_item_sk#15)
               :  :  :  :  :  :  :  :- Join Inner, (w_warehouse_sk#742 = inv_warehouse_sk#124)
               :  :  :  :  :  :  :  :  :- Join Inner, (cs_item_sk#15 = inv_item_sk#123)
               :  :  :  :  :  :  :  :  :  :- SubqueryAlias `catalog_sales`
               :  :  :  :  :  :  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :  :  :  :  :  :  +- SubqueryAlias `inventory`
               :  :  :  :  :  :  :  :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  :  :  :  :  :  :  :  +- SubqueryAlias `warehouse`
               :  :  :  :  :  :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
               :  :  :  :  :  :  :  +- SubqueryAlias `item`
               :  :  :  :  :  :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  :  :  :  :  +- SubqueryAlias `customer_demographics`
               :  :  :  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
               :  :  :  :  :  +- SubqueryAlias `household_demographics`
               :  :  :  :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  :  :  :  +- SubqueryAlias `d1`
               :  :  :  :     +- SubqueryAlias `date_dim`
               :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  +- SubqueryAlias `d2`
               :  :  :     +- SubqueryAlias `date_dim`
               :  :  :        +- Relation[d_date_sk#42138,d_date_id#42139,d_date#42140,d_month_seq#42141,d_week_seq#42142,d_quarter_seq#42143,d_year#42144,d_dow#42145,d_moy#42146,d_dom#42147,d_qoy#42148,d_fy_year#42149,d_fy_quarter_seq#42150,d_fy_week_seq#42151,d_day_name#42152,d_quarter_name#42153,d_holiday#42154,d_weekend#42155,d_following_holiday#42156,d_first_dom#42157,d_last_dom#42158,d_same_day_ly#42159,d_same_day_lq#42160,d_current_day#42161,... 4 more fields] parquet
               :  :  +- SubqueryAlias `d3`
               :  :     +- SubqueryAlias `date_dim`
               :  :        +- Relation[d_date_sk#42167,d_date_id#42168,d_date#42169,d_month_seq#42170,d_week_seq#42171,d_quarter_seq#42172,d_year#42173,d_dow#42174,d_moy#42175,d_dom#42176,d_qoy#42177,d_fy_year#42178,d_fy_quarter_seq#42179,d_fy_week_seq#42180,d_day_name#42181,d_quarter_name#42182,d_holiday#42183,d_weekend#42184,d_following_holiday#42185,d_first_dom#42186,d_last_dom#42187,d_same_day_ly#42188,d_same_day_lq#42189,d_current_day#42190,... 4 more fields] parquet
               :  +- SubqueryAlias `promotion`
               :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
               +- SubqueryAlias `catalog_returns`
                  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet

     : benchmark
19/09/08 18:29:36 INFO Query: 
== Query: q72-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [total_cnt#42209L DESC NULLS LAST, i_item_desc#568 ASC NULLS FIRST, w_warehouse_name#744 ASC NULLS FIRST, d_week_seq#496 ASC NULLS FIRST], true
      +- Aggregate [i_item_desc#568, w_warehouse_name#744, d_week_seq#496], [i_item_desc#568, w_warehouse_name#744, d_week_seq#496, sum(cast(CASE WHEN isnull(p_promo_sk#608) THEN 1 ELSE 0 END as bigint)) AS no_promo#42207L, sum(cast(CASE WHEN isnotnull(p_promo_sk#608) THEN 1 ELSE 0 END as bigint)) AS promo#42208L, count(1) AS total_cnt#42209L]
         +- Filter ((((d_week_seq#496 = d_week_seq#42214) && (inv_quantity_on_hand#125 < cs_quantity#18)) && (d_date#42241 > cast(cast(cast(d_date#494 as date) as timestamp) + interval 5 days as date))) && (((hd_buy_potential#550 = >10000) && (d_year#498 = 1999)) && (cd_marital_status#476 = D)))
            +- Join LeftOuter, ((cr_item_sk#70 = cs_item_sk#15) && (cr_order_number#84L = cs_order_number#17L))
               :- Join LeftOuter, (cs_promo_sk#16 = p_promo_sk#608)
               :  :- Join Inner, (cs_ship_date_sk#2 = d_date_sk#42239)
               :  :  :- Join Inner, (inv_date_sk#122 = d_date_sk#42210)
               :  :  :  :- Join Inner, (cs_sold_date_sk#0 = d_date_sk#492)
               :  :  :  :  :- Join Inner, (cs_bill_hdemo_sk#5 = hd_demo_sk#548)
               :  :  :  :  :  :- Join Inner, (cs_bill_cdemo_sk#4 = cd_demo_sk#474)
               :  :  :  :  :  :  :- Join Inner, (i_item_sk#564 = cs_item_sk#15)
               :  :  :  :  :  :  :  :- Join Inner, (w_warehouse_sk#742 = inv_warehouse_sk#124)
               :  :  :  :  :  :  :  :  :- Join Inner, (cs_item_sk#15 = inv_item_sk#123)
               :  :  :  :  :  :  :  :  :  :- SubqueryAlias `catalog_sales`
               :  :  :  :  :  :  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :  :  :  :  :  :  +- SubqueryAlias `inventory`
               :  :  :  :  :  :  :  :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  :  :  :  :  :  :  :  +- SubqueryAlias `warehouse`
               :  :  :  :  :  :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
               :  :  :  :  :  :  :  +- SubqueryAlias `item`
               :  :  :  :  :  :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  :  :  :  :  +- SubqueryAlias `customer_demographics`
               :  :  :  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
               :  :  :  :  :  +- SubqueryAlias `household_demographics`
               :  :  :  :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  :  :  :  +- SubqueryAlias `d1`
               :  :  :  :     +- SubqueryAlias `date_dim`
               :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  +- SubqueryAlias `d2`
               :  :  :     +- SubqueryAlias `date_dim`
               :  :  :        +- Relation[d_date_sk#42210,d_date_id#42211,d_date#42212,d_month_seq#42213,d_week_seq#42214,d_quarter_seq#42215,d_year#42216,d_dow#42217,d_moy#42218,d_dom#42219,d_qoy#42220,d_fy_year#42221,d_fy_quarter_seq#42222,d_fy_week_seq#42223,d_day_name#42224,d_quarter_name#42225,d_holiday#42226,d_weekend#42227,d_following_holiday#42228,d_first_dom#42229,d_last_dom#42230,d_same_day_ly#42231,d_same_day_lq#42232,d_current_day#42233,... 4 more fields] parquet
               :  :  +- SubqueryAlias `d3`
               :  :     +- SubqueryAlias `date_dim`
               :  :        +- Relation[d_date_sk#42239,d_date_id#42240,d_date#42241,d_month_seq#42242,d_week_seq#42243,d_quarter_seq#42244,d_year#42245,d_dow#42246,d_moy#42247,d_dom#42248,d_qoy#42249,d_fy_year#42250,d_fy_quarter_seq#42251,d_fy_week_seq#42252,d_day_name#42253,d_quarter_name#42254,d_holiday#42255,d_weekend#42256,d_following_holiday#42257,d_first_dom#42258,d_last_dom#42259,d_same_day_ly#42260,d_same_day_lq#42261,d_current_day#42262,... 4 more fields] parquet
               :  +- SubqueryAlias `promotion`
               :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
               +- SubqueryAlias `catalog_returns`
                  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 73.306156397s
Running execution q73-v2.4 iteration: 1, StandardRun=true
19/09/08 18:30:51 INFO Query: 
== Query: q73-v2.4 ==
Sort [cnt#42440L DESC NULLS LAST, c_last_name#421 ASC NULLS FIRST], true
+- Project [c_last_name#421, c_first_name#420, c_salutation#419, c_preferred_cust_flag#422, ss_ticket_number#139L, cnt#42440L]
   +- Filter ((ss_customer_sk#133 = c_customer_sk#412) && ((cnt#42440L >= cast(1 as bigint)) && (cnt#42440L <= cast(5 as bigint))))
      +- Join Inner
         :- SubqueryAlias `dj`
         :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133], [ss_ticket_number#139L, ss_customer_sk#133, count(1) AS cnt#42440L]
         :     +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (((d_dom#501 >= 1) && (d_dom#501 <= 2)) && ((hd_buy_potential#550 = >10000) || (hd_buy_potential#550 = unknown)))) && (((hd_vehicle_count#552 > 0) && (CASE WHEN (hd_vehicle_count#552 > 0) THEN (cast(hd_dep_count#551 as double) / cast(hd_vehicle_count#552 as double)) ELSE cast(null as double) END > cast(1 as double))) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_county#687 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
         :        +- Join Inner
         :           :- Join Inner
         :           :  :- Join Inner
         :           :  :  :- SubqueryAlias `store_sales`
         :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :           :  :  +- SubqueryAlias `date_dim`
         :           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :           :  +- SubqueryAlias `store`
         :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :           +- SubqueryAlias `household_demographics`
         :              +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         +- SubqueryAlias `customer`
            +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/09/08 18:30:51 INFO Query: 
== Query: q73-v2.4 ==
Sort [cnt#42448L DESC NULLS LAST, c_last_name#421 ASC NULLS FIRST], true
+- Project [c_last_name#421, c_first_name#420, c_salutation#419, c_preferred_cust_flag#422, ss_ticket_number#139L, cnt#42448L]
   +- Filter ((ss_customer_sk#133 = c_customer_sk#412) && ((cnt#42448L >= cast(1 as bigint)) && (cnt#42448L <= cast(5 as bigint))))
      +- Join Inner
         :- SubqueryAlias `dj`
         :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133], [ss_ticket_number#139L, ss_customer_sk#133, count(1) AS cnt#42448L]
         :     +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (((d_dom#501 >= 1) && (d_dom#501 <= 2)) && ((hd_buy_potential#550 = >10000) || (hd_buy_potential#550 = unknown)))) && (((hd_vehicle_count#552 > 0) && (CASE WHEN (hd_vehicle_count#552 > 0) THEN (cast(hd_dep_count#551 as double) / cast(hd_vehicle_count#552 as double)) ELSE cast(null as double) END > cast(1 as double))) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_county#687 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
         :        +- Join Inner
         :           :- Join Inner
         :           :  :- Join Inner
         :           :  :  :- SubqueryAlias `store_sales`
         :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :           :  :  +- SubqueryAlias `date_dim`
         :           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :           :  +- SubqueryAlias `store`
         :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :           +- SubqueryAlias `household_demographics`
         :              +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         +- SubqueryAlias `customer`
            +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 2.386211959s
Running execution q74-v2.4 iteration: 1, StandardRun=true
19/09/08 18:30:55 INFO Query: 
== Query: q74-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#42539 ASC NULLS FIRST, customer_id#42539 ASC NULLS FIRST, customer_id#42539 ASC NULLS FIRST], true
      +- Project [customer_id#42539, customer_first_name#42540, customer_last_name#42541]
         +- Filter (((((customer_id#42539 = customer_id#42525) && (customer_id#42525 = customer_id#42551)) && ((customer_id#42525 = customer_id#42545) && (sale_type#42530 = s))) && (((sale_type#42550 = w) && (sale_type#42544 = s)) && (sale_type#42556 = w))) && ((((year#42528 = 2001) && (year#42542 = (2001 + 1))) && ((year#42548 = 2001) && (year#42554 = (2001 + 1)))) && (((cast(year_total#42529 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) && (cast(year_total#42549 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2)))) && (CASE WHEN (cast(year_total#42549 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(year_total#42555 as decimal(17,2))) / promote_precision(cast(year_total#42549 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END > CASE WHEN (cast(year_total#42529 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(year_total#42543 as decimal(17,2))) / promote_precision(cast(year_total#42529 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `t_s_firstyear`
               :  :  :  +- SubqueryAlias `year_total`
               :  :  :     +- Union
               :  :  :        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42525, c_first_name#420 AS customer_first_name#42526, c_last_name#421 AS customer_last_name#42527, d_year#498 AS year#42528, sum(ss_net_paid#150) AS year_total#42529, s AS sale_type#42530]
               :  :  :        :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :  :        :     +- Join Inner
               :  :  :        :        :- Join Inner
               :  :  :        :        :  :- SubqueryAlias `customer`
               :  :  :        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :        :        :  +- SubqueryAlias `store_sales`
               :  :  :        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :        :        +- SubqueryAlias `date_dim`
               :  :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42531, c_first_name#420 AS customer_first_name#42532, c_last_name#421 AS customer_last_name#42533, d_year#498 AS year#42534, sum(ws_net_paid#245) AS year_total#42535, w AS sale_type#42536]
               :  :  :           +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :  :              +- Join Inner
               :  :  :                 :- Join Inner
               :  :  :                 :  :- SubqueryAlias `customer`
               :  :  :                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :                 :  +- SubqueryAlias `web_sales`
               :  :  :                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :                 +- SubqueryAlias `date_dim`
               :  :  :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  +- SubqueryAlias `t_s_secyear`
               :  :     +- SubqueryAlias `year_total`
               :  :        +- Union
               :  :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42539, c_first_name#420 AS customer_first_name#42540, c_last_name#421 AS customer_last_name#42541, d_year#498 AS year#42542, sum(ss_net_paid#150) AS year_total#42543, s AS sale_type#42544]
               :  :           :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :           :     +- Join Inner
               :  :           :        :- Join Inner
               :  :           :        :  :- SubqueryAlias `customer`
               :  :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :        :  +- SubqueryAlias `store_sales`
               :  :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :        +- SubqueryAlias `date_dim`
               :  :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42531, c_first_name#420 AS customer_first_name#42532, c_last_name#421 AS customer_last_name#42533, d_year#498 AS year#42534, sum(ws_net_paid#245) AS year_total#42535, w AS sale_type#42536]
               :  :              +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :                 +- Join Inner
               :  :                    :- Join Inner
               :  :                    :  :- SubqueryAlias `customer`
               :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :                    :  +- SubqueryAlias `web_sales`
               :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :                    +- SubqueryAlias `date_dim`
               :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `t_w_firstyear`
               :     +- SubqueryAlias `year_total`
               :        +- Union
               :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42545, c_first_name#420 AS customer_first_name#42546, c_last_name#421 AS customer_last_name#42547, d_year#498 AS year#42548, sum(ss_net_paid#150) AS year_total#42549, s AS sale_type#42550]
               :           :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :           :     +- Join Inner
               :           :        :- Join Inner
               :           :        :  :- SubqueryAlias `customer`
               :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :        :  +- SubqueryAlias `store_sales`
               :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42531, c_first_name#420 AS customer_first_name#42532, c_last_name#421 AS customer_last_name#42533, d_year#498 AS year#42534, sum(ws_net_paid#245) AS year_total#42535, w AS sale_type#42536]
               :              +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :                 +- Join Inner
               :                    :- Join Inner
               :                    :  :- SubqueryAlias `customer`
               :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :                    :  +- SubqueryAlias `web_sales`
               :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `t_w_secyear`
                  +- SubqueryAlias `year_total`
                     +- Union
                        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42551, c_first_name#420 AS customer_first_name#42552, c_last_name#421 AS customer_last_name#42553, d_year#498 AS year#42554, sum(ss_net_paid#150) AS year_total#42555, s AS sale_type#42556]
                        :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
                        :     +- Join Inner
                        :        :- Join Inner
                        :        :  :- SubqueryAlias `customer`
                        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :        :  +- SubqueryAlias `store_sales`
                        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42531, c_first_name#420 AS customer_first_name#42532, c_last_name#421 AS customer_last_name#42533, d_year#498 AS year#42534, sum(ws_net_paid#245) AS year_total#42535, w AS sale_type#42536]
                           +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `customer`
                                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                                 :  +- SubqueryAlias `web_sales`
                                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:30:55 INFO Query: 
== Query: q74-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#42574 ASC NULLS FIRST, customer_id#42574 ASC NULLS FIRST, customer_id#42574 ASC NULLS FIRST], true
      +- Project [customer_id#42574, customer_first_name#42575, customer_last_name#42576]
         +- Filter (((((customer_id#42574 = customer_id#42560) && (customer_id#42560 = customer_id#42586)) && ((customer_id#42560 = customer_id#42580) && (sale_type#42565 = s))) && (((sale_type#42585 = w) && (sale_type#42579 = s)) && (sale_type#42591 = w))) && ((((year#42563 = 2001) && (year#42577 = (2001 + 1))) && ((year#42583 = 2001) && (year#42589 = (2001 + 1)))) && (((cast(year_total#42564 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) && (cast(year_total#42584 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2)))) && (CASE WHEN (cast(year_total#42584 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(year_total#42590 as decimal(17,2))) / promote_precision(cast(year_total#42584 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END > CASE WHEN (cast(year_total#42564 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(year_total#42578 as decimal(17,2))) / promote_precision(cast(year_total#42564 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `t_s_firstyear`
               :  :  :  +- SubqueryAlias `year_total`
               :  :  :     +- Union
               :  :  :        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42560, c_first_name#420 AS customer_first_name#42561, c_last_name#421 AS customer_last_name#42562, d_year#498 AS year#42563, sum(ss_net_paid#150) AS year_total#42564, s AS sale_type#42565]
               :  :  :        :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :  :        :     +- Join Inner
               :  :  :        :        :- Join Inner
               :  :  :        :        :  :- SubqueryAlias `customer`
               :  :  :        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :        :        :  +- SubqueryAlias `store_sales`
               :  :  :        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :        :        +- SubqueryAlias `date_dim`
               :  :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42566, c_first_name#420 AS customer_first_name#42567, c_last_name#421 AS customer_last_name#42568, d_year#498 AS year#42569, sum(ws_net_paid#245) AS year_total#42570, w AS sale_type#42571]
               :  :  :           +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :  :              +- Join Inner
               :  :  :                 :- Join Inner
               :  :  :                 :  :- SubqueryAlias `customer`
               :  :  :                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :                 :  +- SubqueryAlias `web_sales`
               :  :  :                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :                 +- SubqueryAlias `date_dim`
               :  :  :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  +- SubqueryAlias `t_s_secyear`
               :  :     +- SubqueryAlias `year_total`
               :  :        +- Union
               :  :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42574, c_first_name#420 AS customer_first_name#42575, c_last_name#421 AS customer_last_name#42576, d_year#498 AS year#42577, sum(ss_net_paid#150) AS year_total#42578, s AS sale_type#42579]
               :  :           :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :           :     +- Join Inner
               :  :           :        :- Join Inner
               :  :           :        :  :- SubqueryAlias `customer`
               :  :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :        :  +- SubqueryAlias `store_sales`
               :  :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :        +- SubqueryAlias `date_dim`
               :  :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42566, c_first_name#420 AS customer_first_name#42567, c_last_name#421 AS customer_last_name#42568, d_year#498 AS year#42569, sum(ws_net_paid#245) AS year_total#42570, w AS sale_type#42571]
               :  :              +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :                 +- Join Inner
               :  :                    :- Join Inner
               :  :                    :  :- SubqueryAlias `customer`
               :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :                    :  +- SubqueryAlias `web_sales`
               :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :                    +- SubqueryAlias `date_dim`
               :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `t_w_firstyear`
               :     +- SubqueryAlias `year_total`
               :        +- Union
               :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42580, c_first_name#420 AS customer_first_name#42581, c_last_name#421 AS customer_last_name#42582, d_year#498 AS year#42583, sum(ss_net_paid#150) AS year_total#42584, s AS sale_type#42585]
               :           :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :           :     +- Join Inner
               :           :        :- Join Inner
               :           :        :  :- SubqueryAlias `customer`
               :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :        :  +- SubqueryAlias `store_sales`
               :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42566, c_first_name#420 AS customer_first_name#42567, c_last_name#421 AS customer_last_name#42568, d_year#498 AS year#42569, sum(ws_net_paid#245) AS year_total#42570, w AS sale_type#42571]
               :              +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :                 +- Join Inner
               :                    :- Join Inner
               :                    :  :- SubqueryAlias `customer`
               :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :                    :  +- SubqueryAlias `web_sales`
               :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `t_w_secyear`
                  +- SubqueryAlias `year_total`
                     +- Union
                        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42586, c_first_name#420 AS customer_first_name#42587, c_last_name#421 AS customer_last_name#42588, d_year#498 AS year#42589, sum(ss_net_paid#150) AS year_total#42590, s AS sale_type#42591]
                        :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
                        :     +- Join Inner
                        :        :- Join Inner
                        :        :  :- SubqueryAlias `customer`
                        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :        :  +- SubqueryAlias `store_sales`
                        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42566, c_first_name#420 AS customer_first_name#42567, c_last_name#421 AS customer_last_name#42568, d_year#498 AS year#42569, sum(ws_net_paid#245) AS year_total#42570, w AS sale_type#42571]
                           +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `customer`
                                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                                 :  +- SubqueryAlias `web_sales`
                                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 17.45870112s
Running execution q75-v2.4 iteration: 1, StandardRun=true
19/09/08 18:31:16 INFO Query: 
== Query: q75-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [sales_cnt_diff#43111L ASC NULLS FIRST], true
      +- Project [d_year#43431 AS prev_year#43107, d_year#498 AS year#43108, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, sales_cnt#43123L AS prev_yr_cnt#43109L, sales_cnt#43119L AS curr_yr_cnt#43110L, (sales_cnt#43119L - sales_cnt#43123L) AS sales_cnt_diff#43111L, CheckOverflow((promote_precision(cast(sales_amt#43120 as decimal(19,2))) - promote_precision(cast(sales_amt#43124 as decimal(19,2)))), DecimalType(19,2)) AS sales_amt_diff#43112]
         +- Filter ((((i_brand_id#571 = i_brand_id#43282) && (i_class_id#573 = i_class_id#43284)) && ((i_category_id#575 = i_category_id#43286) && (i_manufact_id#577 = i_manufact_id#43288))) && (((d_year#498 = 2002) && (d_year#43431 = (2002 - 1))) && (cast(CheckOverflow((promote_precision(cast(cast(sales_cnt#43119L as decimal(17,2)) as decimal(17,2))) / promote_precision(cast(cast(sales_cnt#43123L as decimal(17,2)) as decimal(17,2)))), DecimalType(37,20)) as decimal(37,20)) < cast(0.9 as decimal(37,20)))))
            +- Join Inner
               :- SubqueryAlias `curr_yr`
               :  +- SubqueryAlias `all_sales`
               :     +- Aggregate [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577], [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, sum(cast(sales_cnt#43113 as bigint)) AS sales_cnt#43119L, sum(sales_amt#43114) AS sales_amt#43120]
               :        +- SubqueryAlias `sales_detail`
               :           +- Distinct
               :              +- Union
               :                 :- Distinct
               :                 :  +- Union
               :                 :     :- Project [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, (cs_quantity#18 - coalesce(cr_return_quantity#85, 0)) AS sales_cnt#43113, CheckOverflow((promote_precision(cast(cs_ext_sales_price#23 as decimal(8,2))) - promote_precision(cast(coalesce(cr_return_amount#86, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43114]
               :                 :     :  +- Filter (i_category#576 = Books)
               :                 :     :     +- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
               :                 :     :        :- Join Inner, (d_date_sk#492 = cs_sold_date_sk#0)
               :                 :     :        :  :- Join Inner, (i_item_sk#564 = cs_item_sk#15)
               :                 :     :        :  :  :- SubqueryAlias `catalog_sales`
               :                 :     :        :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :     :        :  :  +- SubqueryAlias `item`
               :                 :     :        :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                 :     :        :  +- SubqueryAlias `date_dim`
               :                 :     :        :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :     :        +- SubqueryAlias `catalog_returns`
               :                 :     :           +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               :                 :     +- Project [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, (ss_quantity#140 - coalesce(sr_return_quantity#186, 0)) AS sales_cnt#43115, CheckOverflow((promote_precision(cast(ss_ext_sales_price#145 as decimal(8,2))) - promote_precision(cast(coalesce(sr_return_amt#187, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43116]
               :                 :        +- Filter (i_category#576 = Books)
               :                 :           +- Join LeftOuter, ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))
               :                 :              :- Join Inner, (d_date_sk#492 = ss_sold_date_sk#130)
               :                 :              :  :- Join Inner, (i_item_sk#564 = ss_item_sk#132)
               :                 :              :  :  :- SubqueryAlias `store_sales`
               :                 :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :                 :              :  :  +- SubqueryAlias `item`
               :                 :              :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                 :              :  +- SubqueryAlias `date_dim`
               :                 :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :              +- SubqueryAlias `store_returns`
               :                 :                 +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :                 +- Project [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, (ws_quantity#234 - coalesce(wr_return_quantity#298, 0)) AS sales_cnt#43117, CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(8,2))) - promote_precision(cast(coalesce(wr_return_amt#299, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43118]
               :                    +- Filter (i_category#576 = Books)
               :                       +- Join LeftOuter, ((ws_order_number#233L = wr_order_number#297L) && (ws_item_sk#219 = wr_item_sk#286))
               :                          :- Join Inner, (d_date_sk#492 = ws_sold_date_sk#216)
               :                          :  :- Join Inner, (i_item_sk#564 = ws_item_sk#219)
               :                          :  :  :- SubqueryAlias `web_sales`
               :                          :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                          :  :  +- SubqueryAlias `item`
               :                          :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                          :  +- SubqueryAlias `date_dim`
               :                          :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                          +- SubqueryAlias `web_returns`
               :                             +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               +- SubqueryAlias `prev_yr`
                  +- SubqueryAlias `all_sales`
                     +- Aggregate [d_year#43431, i_brand_id#43282, i_class_id#43284, i_category_id#43286, i_manufact_id#43288], [d_year#43431, i_brand_id#43282, i_class_id#43284, i_category_id#43286, i_manufact_id#43288, sum(cast(sales_cnt#43113 as bigint)) AS sales_cnt#43123L, sum(sales_amt#43114) AS sales_amt#43124]
                        +- SubqueryAlias `sales_detail`
                           +- Distinct
                              +- Union
                                 :- Distinct
                                 :  +- Union
                                 :     :- Project [d_year#43431, i_brand_id#43282, i_class_id#43284, i_category_id#43286, i_manufact_id#43288, (cs_quantity#18 - coalesce(cr_return_quantity#85, 0)) AS sales_cnt#43113, CheckOverflow((promote_precision(cast(cs_ext_sales_price#23 as decimal(8,2))) - promote_precision(cast(coalesce(cr_return_amount#86, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43114]
                                 :     :  +- Filter (i_category#43287 = Books)
                                 :     :     +- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
                                 :     :        :- Join Inner, (d_date_sk#43425 = cs_sold_date_sk#0)
                                 :     :        :  :- Join Inner, (i_item_sk#43275 = cs_item_sk#15)
                                 :     :        :  :  :- SubqueryAlias `catalog_sales`
                                 :     :        :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                                 :     :        :  :  +- SubqueryAlias `item`
                                 :     :        :  :     +- Relation[i_item_sk#43275,i_item_id#43276,i_rec_start_date#43277,i_rec_end_date#43278,i_item_desc#43279,i_current_price#43280,i_wholesale_cost#43281,i_brand_id#43282,i_brand#43283,i_class_id#43284,i_class#43285,i_category_id#43286,i_category#43287,i_manufact_id#43288,i_manufact#43289,i_size#43290,i_formulation#43291,i_color#43292,i_units#43293,i_container#43294,i_manager_id#43295,i_product_name#43296] parquet
                                 :     :        :  +- SubqueryAlias `date_dim`
                                 :     :        :     +- Relation[d_date_sk#43425,d_date_id#43426,d_date#43427,d_month_seq#43428,d_week_seq#43429,d_quarter_seq#43430,d_year#43431,d_dow#43432,d_moy#43433,d_dom#43434,d_qoy#43435,d_fy_year#43436,d_fy_quarter_seq#43437,d_fy_week_seq#43438,d_day_name#43439,d_quarter_name#43440,d_holiday#43441,d_weekend#43442,d_following_holiday#43443,d_first_dom#43444,d_last_dom#43445,d_same_day_ly#43446,d_same_day_lq#43447,d_current_day#43448,... 4 more fields] parquet
                                 :     :        +- SubqueryAlias `catalog_returns`
                                 :     :           +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                                 :     +- Project [d_year#43431, i_brand_id#43282, i_class_id#43284, i_category_id#43286, i_manufact_id#43288, (ss_quantity#140 - coalesce(sr_return_quantity#186, 0)) AS sales_cnt#43115, CheckOverflow((promote_precision(cast(ss_ext_sales_price#145 as decimal(8,2))) - promote_precision(cast(coalesce(sr_return_amt#187, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43116]
                                 :        +- Filter (i_category#43287 = Books)
                                 :           +- Join LeftOuter, ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))
                                 :              :- Join Inner, (d_date_sk#43425 = ss_sold_date_sk#130)
                                 :              :  :- Join Inner, (i_item_sk#43275 = ss_item_sk#132)
                                 :              :  :  :- SubqueryAlias `store_sales`
                                 :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :              :  :  +- SubqueryAlias `item`
                                 :              :  :     +- Relation[i_item_sk#43275,i_item_id#43276,i_rec_start_date#43277,i_rec_end_date#43278,i_item_desc#43279,i_current_price#43280,i_wholesale_cost#43281,i_brand_id#43282,i_brand#43283,i_class_id#43284,i_class#43285,i_category_id#43286,i_category#43287,i_manufact_id#43288,i_manufact#43289,i_size#43290,i_formulation#43291,i_color#43292,i_units#43293,i_container#43294,i_manager_id#43295,i_product_name#43296] parquet
                                 :              :  +- SubqueryAlias `date_dim`
                                 :              :     +- Relation[d_date_sk#43425,d_date_id#43426,d_date#43427,d_month_seq#43428,d_week_seq#43429,d_quarter_seq#43430,d_year#43431,d_dow#43432,d_moy#43433,d_dom#43434,d_qoy#43435,d_fy_year#43436,d_fy_quarter_seq#43437,d_fy_week_seq#43438,d_day_name#43439,d_quarter_name#43440,d_holiday#43441,d_weekend#43442,d_following_holiday#43443,d_first_dom#43444,d_last_dom#43445,d_same_day_ly#43446,d_same_day_lq#43447,d_current_day#43448,... 4 more fields] parquet
                                 :              +- SubqueryAlias `store_returns`
                                 :                 +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                                 +- Project [d_year#43431, i_brand_id#43282, i_class_id#43284, i_category_id#43286, i_manufact_id#43288, (ws_quantity#234 - coalesce(wr_return_quantity#298, 0)) AS sales_cnt#43117, CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(8,2))) - promote_precision(cast(coalesce(wr_return_amt#299, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43118]
                                    +- Filter (i_category#43287 = Books)
                                       +- Join LeftOuter, ((ws_order_number#233L = wr_order_number#297L) && (ws_item_sk#219 = wr_item_sk#286))
                                          :- Join Inner, (d_date_sk#43425 = ws_sold_date_sk#216)
                                          :  :- Join Inner, (i_item_sk#43275 = ws_item_sk#219)
                                          :  :  :- SubqueryAlias `web_sales`
                                          :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                          :  :  +- SubqueryAlias `item`
                                          :  :     +- Relation[i_item_sk#43275,i_item_id#43276,i_rec_start_date#43277,i_rec_end_date#43278,i_item_desc#43279,i_current_price#43280,i_wholesale_cost#43281,i_brand_id#43282,i_brand#43283,i_class_id#43284,i_class#43285,i_category_id#43286,i_category#43287,i_manufact_id#43288,i_manufact#43289,i_size#43290,i_formulation#43291,i_color#43292,i_units#43293,i_container#43294,i_manager_id#43295,i_product_name#43296] parquet
                                          :  +- SubqueryAlias `date_dim`
                                          :     +- Relation[d_date_sk#43425,d_date_id#43426,d_date#43427,d_month_seq#43428,d_week_seq#43429,d_quarter_seq#43430,d_year#43431,d_dow#43432,d_moy#43433,d_dom#43434,d_qoy#43435,d_fy_year#43436,d_fy_quarter_seq#43437,d_fy_week_seq#43438,d_day_name#43439,d_quarter_name#43440,d_holiday#43441,d_weekend#43442,d_following_holiday#43443,d_first_dom#43444,d_last_dom#43445,d_same_day_ly#43446,d_same_day_lq#43447,d_current_day#43448,... 4 more fields] parquet
                                          +- SubqueryAlias `web_returns`
                                             +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet

     : benchmark
19/09/08 18:31:16 INFO Query: 
== Query: q75-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [sales_cnt_diff#43523L ASC NULLS FIRST], true
      +- Project [d_year#43843 AS prev_year#43519, d_year#498 AS year#43520, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, sales_cnt#43535L AS prev_yr_cnt#43521L, sales_cnt#43531L AS curr_yr_cnt#43522L, (sales_cnt#43531L - sales_cnt#43535L) AS sales_cnt_diff#43523L, CheckOverflow((promote_precision(cast(sales_amt#43532 as decimal(19,2))) - promote_precision(cast(sales_amt#43536 as decimal(19,2)))), DecimalType(19,2)) AS sales_amt_diff#43524]
         +- Filter ((((i_brand_id#571 = i_brand_id#43694) && (i_class_id#573 = i_class_id#43696)) && ((i_category_id#575 = i_category_id#43698) && (i_manufact_id#577 = i_manufact_id#43700))) && (((d_year#498 = 2002) && (d_year#43843 = (2002 - 1))) && (cast(CheckOverflow((promote_precision(cast(cast(sales_cnt#43531L as decimal(17,2)) as decimal(17,2))) / promote_precision(cast(cast(sales_cnt#43535L as decimal(17,2)) as decimal(17,2)))), DecimalType(37,20)) as decimal(37,20)) < cast(0.9 as decimal(37,20)))))
            +- Join Inner
               :- SubqueryAlias `curr_yr`
               :  +- SubqueryAlias `all_sales`
               :     +- Aggregate [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577], [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, sum(cast(sales_cnt#43525 as bigint)) AS sales_cnt#43531L, sum(sales_amt#43526) AS sales_amt#43532]
               :        +- SubqueryAlias `sales_detail`
               :           +- Distinct
               :              +- Union
               :                 :- Distinct
               :                 :  +- Union
               :                 :     :- Project [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, (cs_quantity#18 - coalesce(cr_return_quantity#85, 0)) AS sales_cnt#43525, CheckOverflow((promote_precision(cast(cs_ext_sales_price#23 as decimal(8,2))) - promote_precision(cast(coalesce(cr_return_amount#86, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43526]
               :                 :     :  +- Filter (i_category#576 = Books)
               :                 :     :     +- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
               :                 :     :        :- Join Inner, (d_date_sk#492 = cs_sold_date_sk#0)
               :                 :     :        :  :- Join Inner, (i_item_sk#564 = cs_item_sk#15)
               :                 :     :        :  :  :- SubqueryAlias `catalog_sales`
               :                 :     :        :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :     :        :  :  +- SubqueryAlias `item`
               :                 :     :        :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                 :     :        :  +- SubqueryAlias `date_dim`
               :                 :     :        :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :     :        +- SubqueryAlias `catalog_returns`
               :                 :     :           +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               :                 :     +- Project [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, (ss_quantity#140 - coalesce(sr_return_quantity#186, 0)) AS sales_cnt#43527, CheckOverflow((promote_precision(cast(ss_ext_sales_price#145 as decimal(8,2))) - promote_precision(cast(coalesce(sr_return_amt#187, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43528]
               :                 :        +- Filter (i_category#576 = Books)
               :                 :           +- Join LeftOuter, ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))
               :                 :              :- Join Inner, (d_date_sk#492 = ss_sold_date_sk#130)
               :                 :              :  :- Join Inner, (i_item_sk#564 = ss_item_sk#132)
               :                 :              :  :  :- SubqueryAlias `store_sales`
               :                 :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :                 :              :  :  +- SubqueryAlias `item`
               :                 :              :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                 :              :  +- SubqueryAlias `date_dim`
               :                 :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :              +- SubqueryAlias `store_returns`
               :                 :                 +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :                 +- Project [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, (ws_quantity#234 - coalesce(wr_return_quantity#298, 0)) AS sales_cnt#43529, CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(8,2))) - promote_precision(cast(coalesce(wr_return_amt#299, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43530]
               :                    +- Filter (i_category#576 = Books)
               :                       +- Join LeftOuter, ((ws_order_number#233L = wr_order_number#297L) && (ws_item_sk#219 = wr_item_sk#286))
               :                          :- Join Inner, (d_date_sk#492 = ws_sold_date_sk#216)
               :                          :  :- Join Inner, (i_item_sk#564 = ws_item_sk#219)
               :                          :  :  :- SubqueryAlias `web_sales`
               :                          :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                          :  :  +- SubqueryAlias `item`
               :                          :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                          :  +- SubqueryAlias `date_dim`
               :                          :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                          +- SubqueryAlias `web_returns`
               :                             +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               +- SubqueryAlias `prev_yr`
                  +- SubqueryAlias `all_sales`
                     +- Aggregate [d_year#43843, i_brand_id#43694, i_class_id#43696, i_category_id#43698, i_manufact_id#43700], [d_year#43843, i_brand_id#43694, i_class_id#43696, i_category_id#43698, i_manufact_id#43700, sum(cast(sales_cnt#43525 as bigint)) AS sales_cnt#43535L, sum(sales_amt#43526) AS sales_amt#43536]
                        +- SubqueryAlias `sales_detail`
                           +- Distinct
                              +- Union
                                 :- Distinct
                                 :  +- Union
                                 :     :- Project [d_year#43843, i_brand_id#43694, i_class_id#43696, i_category_id#43698, i_manufact_id#43700, (cs_quantity#18 - coalesce(cr_return_quantity#85, 0)) AS sales_cnt#43525, CheckOverflow((promote_precision(cast(cs_ext_sales_price#23 as decimal(8,2))) - promote_precision(cast(coalesce(cr_return_amount#86, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43526]
                                 :     :  +- Filter (i_category#43699 = Books)
                                 :     :     +- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
                                 :     :        :- Join Inner, (d_date_sk#43837 = cs_sold_date_sk#0)
                                 :     :        :  :- Join Inner, (i_item_sk#43687 = cs_item_sk#15)
                                 :     :        :  :  :- SubqueryAlias `catalog_sales`
                                 :     :        :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                                 :     :        :  :  +- SubqueryAlias `item`
                                 :     :        :  :     +- Relation[i_item_sk#43687,i_item_id#43688,i_rec_start_date#43689,i_rec_end_date#43690,i_item_desc#43691,i_current_price#43692,i_wholesale_cost#43693,i_brand_id#43694,i_brand#43695,i_class_id#43696,i_class#43697,i_category_id#43698,i_category#43699,i_manufact_id#43700,i_manufact#43701,i_size#43702,i_formulation#43703,i_color#43704,i_units#43705,i_container#43706,i_manager_id#43707,i_product_name#43708] parquet
                                 :     :        :  +- SubqueryAlias `date_dim`
                                 :     :        :     +- Relation[d_date_sk#43837,d_date_id#43838,d_date#43839,d_month_seq#43840,d_week_seq#43841,d_quarter_seq#43842,d_year#43843,d_dow#43844,d_moy#43845,d_dom#43846,d_qoy#43847,d_fy_year#43848,d_fy_quarter_seq#43849,d_fy_week_seq#43850,d_day_name#43851,d_quarter_name#43852,d_holiday#43853,d_weekend#43854,d_following_holiday#43855,d_first_dom#43856,d_last_dom#43857,d_same_day_ly#43858,d_same_day_lq#43859,d_current_day#43860,... 4 more fields] parquet
                                 :     :        +- SubqueryAlias `catalog_returns`
                                 :     :           +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                                 :     +- Project [d_year#43843, i_brand_id#43694, i_class_id#43696, i_category_id#43698, i_manufact_id#43700, (ss_quantity#140 - coalesce(sr_return_quantity#186, 0)) AS sales_cnt#43527, CheckOverflow((promote_precision(cast(ss_ext_sales_price#145 as decimal(8,2))) - promote_precision(cast(coalesce(sr_return_amt#187, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43528]
                                 :        +- Filter (i_category#43699 = Books)
                                 :           +- Join LeftOuter, ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))
                                 :              :- Join Inner, (d_date_sk#43837 = ss_sold_date_sk#130)
                                 :              :  :- Join Inner, (i_item_sk#43687 = ss_item_sk#132)
                                 :              :  :  :- SubqueryAlias `store_sales`
                                 :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :              :  :  +- SubqueryAlias `item`
                                 :              :  :     +- Relation[i_item_sk#43687,i_item_id#43688,i_rec_start_date#43689,i_rec_end_date#43690,i_item_desc#43691,i_current_price#43692,i_wholesale_cost#43693,i_brand_id#43694,i_brand#43695,i_class_id#43696,i_class#43697,i_category_id#43698,i_category#43699,i_manufact_id#43700,i_manufact#43701,i_size#43702,i_formulation#43703,i_color#43704,i_units#43705,i_container#43706,i_manager_id#43707,i_product_name#43708] parquet
                                 :              :  +- SubqueryAlias `date_dim`
                                 :              :     +- Relation[d_date_sk#43837,d_date_id#43838,d_date#43839,d_month_seq#43840,d_week_seq#43841,d_quarter_seq#43842,d_year#43843,d_dow#43844,d_moy#43845,d_dom#43846,d_qoy#43847,d_fy_year#43848,d_fy_quarter_seq#43849,d_fy_week_seq#43850,d_day_name#43851,d_quarter_name#43852,d_holiday#43853,d_weekend#43854,d_following_holiday#43855,d_first_dom#43856,d_last_dom#43857,d_same_day_ly#43858,d_same_day_lq#43859,d_current_day#43860,... 4 more fields] parquet
                                 :              +- SubqueryAlias `store_returns`
                                 :                 +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                                 +- Project [d_year#43843, i_brand_id#43694, i_class_id#43696, i_category_id#43698, i_manufact_id#43700, (ws_quantity#234 - coalesce(wr_return_quantity#298, 0)) AS sales_cnt#43529, CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(8,2))) - promote_precision(cast(coalesce(wr_return_amt#299, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43530]
                                    +- Filter (i_category#43699 = Books)
                                       +- Join LeftOuter, ((ws_order_number#233L = wr_order_number#297L) && (ws_item_sk#219 = wr_item_sk#286))
                                          :- Join Inner, (d_date_sk#43837 = ws_sold_date_sk#216)
                                          :  :- Join Inner, (i_item_sk#43687 = ws_item_sk#219)
                                          :  :  :- SubqueryAlias `web_sales`
                                          :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                          :  :  +- SubqueryAlias `item`
                                          :  :     +- Relation[i_item_sk#43687,i_item_id#43688,i_rec_start_date#43689,i_rec_end_date#43690,i_item_desc#43691,i_current_price#43692,i_wholesale_cost#43693,i_brand_id#43694,i_brand#43695,i_class_id#43696,i_class#43697,i_category_id#43698,i_category#43699,i_manufact_id#43700,i_manufact#43701,i_size#43702,i_formulation#43703,i_color#43704,i_units#43705,i_container#43706,i_manager_id#43707,i_product_name#43708] parquet
                                          :  +- SubqueryAlias `date_dim`
                                          :     +- Relation[d_date_sk#43837,d_date_id#43838,d_date#43839,d_month_seq#43840,d_week_seq#43841,d_quarter_seq#43842,d_year#43843,d_dow#43844,d_moy#43845,d_dom#43846,d_qoy#43847,d_fy_year#43848,d_fy_quarter_seq#43849,d_fy_week_seq#43850,d_day_name#43851,d_quarter_name#43852,d_holiday#43853,d_weekend#43854,d_following_holiday#43855,d_first_dom#43856,d_last_dom#43857,d_same_day_ly#43858,d_same_day_lq#43859,d_current_day#43860,... 4 more fields] parquet
                                          +- SubqueryAlias `web_returns`
                                             +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet

      running Thread[benchmark runner,5,main]
Execution time: 18.909727222s
Running execution q76-v2.4 iteration: 1, StandardRun=true
19/09/08 18:31:37 INFO Query: 
== Query: q76-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [channel#44799, col_name#44800, d_year#498, d_qoy#502, i_category#576, sales_cnt#44808L, sales_amt#44809]
      +- Sort [channel#44799 ASC NULLS FIRST, col_name#44800 ASC NULLS FIRST, d_year#498 ASC NULLS FIRST, d_qoy#502 ASC NULLS FIRST, i_category#576 ASC NULLS FIRST], true
         +- Aggregate [channel#44799, col_name#44800, d_year#498, d_qoy#502, i_category#576], [channel#44799, col_name#44800, d_year#498, d_qoy#502, i_category#576, count(1) AS sales_cnt#44808L, sum(ext_sales_price#44801) AS sales_amt#44809]
            +- SubqueryAlias `foo`
               +- Union
                  :- Union
                  :  :- Project [store AS channel#44799, ss_store_sk#137 AS col_name#44800, d_year#498, d_qoy#502, i_category#576, ss_ext_sales_price#145 AS ext_sales_price#44801]
                  :  :  +- Filter ((isnull(ss_store_sk#137) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_item_sk#132 = i_item_sk#564))
                  :  :     +- Join Inner
                  :  :        :- Join Inner
                  :  :        :  :- SubqueryAlias `store_sales`
                  :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :        :  +- SubqueryAlias `item`
                  :  :        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  :  :        +- SubqueryAlias `date_dim`
                  :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- Project [web AS channel#44802, ws_ship_customer_sk#224 AS col_name#44803, d_year#498, d_qoy#502, i_category#576, ws_ext_sales_price#239 AS ext_sales_price#44804]
                  :     +- Filter ((isnull(ws_ship_customer_sk#224) && (ws_sold_date_sk#216 = d_date_sk#492)) && (ws_item_sk#219 = i_item_sk#564))
                  :        +- Join Inner
                  :           :- Join Inner
                  :           :  :- SubqueryAlias `web_sales`
                  :           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :           :  +- SubqueryAlias `item`
                  :           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  :           +- SubqueryAlias `date_dim`
                  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- Project [catalog AS channel#44805, cs_ship_addr_sk#10 AS col_name#44806, d_year#498, d_qoy#502, i_category#576, cs_ext_sales_price#23 AS ext_sales_price#44807]
                     +- Filter ((isnull(cs_ship_addr_sk#10) && (cs_sold_date_sk#0 = d_date_sk#492)) && (cs_item_sk#15 = i_item_sk#564))
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `catalog_sales`
                           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :  +- SubqueryAlias `item`
                           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:31:37 INFO Query: 
== Query: q76-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [channel#44824, col_name#44825, d_year#498, d_qoy#502, i_category#576, sales_cnt#44833L, sales_amt#44834]
      +- Sort [channel#44824 ASC NULLS FIRST, col_name#44825 ASC NULLS FIRST, d_year#498 ASC NULLS FIRST, d_qoy#502 ASC NULLS FIRST, i_category#576 ASC NULLS FIRST], true
         +- Aggregate [channel#44824, col_name#44825, d_year#498, d_qoy#502, i_category#576], [channel#44824, col_name#44825, d_year#498, d_qoy#502, i_category#576, count(1) AS sales_cnt#44833L, sum(ext_sales_price#44826) AS sales_amt#44834]
            +- SubqueryAlias `foo`
               +- Union
                  :- Union
                  :  :- Project [store AS channel#44824, ss_store_sk#137 AS col_name#44825, d_year#498, d_qoy#502, i_category#576, ss_ext_sales_price#145 AS ext_sales_price#44826]
                  :  :  +- Filter ((isnull(ss_store_sk#137) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_item_sk#132 = i_item_sk#564))
                  :  :     +- Join Inner
                  :  :        :- Join Inner
                  :  :        :  :- SubqueryAlias `store_sales`
                  :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :        :  +- SubqueryAlias `item`
                  :  :        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  :  :        +- SubqueryAlias `date_dim`
                  :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- Project [web AS channel#44827, ws_ship_customer_sk#224 AS col_name#44828, d_year#498, d_qoy#502, i_category#576, ws_ext_sales_price#239 AS ext_sales_price#44829]
                  :     +- Filter ((isnull(ws_ship_customer_sk#224) && (ws_sold_date_sk#216 = d_date_sk#492)) && (ws_item_sk#219 = i_item_sk#564))
                  :        +- Join Inner
                  :           :- Join Inner
                  :           :  :- SubqueryAlias `web_sales`
                  :           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :           :  +- SubqueryAlias `item`
                  :           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  :           +- SubqueryAlias `date_dim`
                  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- Project [catalog AS channel#44830, cs_ship_addr_sk#10 AS col_name#44831, d_year#498, d_qoy#502, i_category#576, cs_ext_sales_price#23 AS ext_sales_price#44832]
                     +- Filter ((isnull(cs_ship_addr_sk#10) && (cs_sold_date_sk#0 = d_date_sk#492)) && (cs_item_sk#15 = i_item_sk#564))
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `catalog_sales`
                           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :  +- SubqueryAlias `item`
                           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 4.02576279s
Running execution q77-v2.4 iteration: 1, StandardRun=true
19/09/08 18:31:43 INFO Query: 
== Query: q77-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#45131 ASC NULLS FIRST, id#45132 ASC NULLS FIRST], true
      +- Aggregate [channel#45131, id#45132, spark_grouping_id#45128], [channel#45131, id#45132, sum(sales#45056) AS sales#45053, sum(returns#45044) AS returns#45054, sum(profit#45123) AS profit#45055]
         +- Expand [List(channel#45042, id#45043, sales#45056, returns#45044, profit#45123, channel#45129, id#45130, 0), List(channel#45042, id#45043, sales#45056, returns#45044, profit#45123, channel#45129, null, 1), List(channel#45042, id#45043, sales#45056, returns#45044, profit#45123, null, null, 3)], [channel#45042, id#45043, sales#45056, returns#45044, profit#45123, channel#45131, id#45132, spark_grouping_id#45128]
            +- Project [channel#45042, id#45043, sales#45056, returns#45044, profit#45123, channel#45042 AS channel#45129, id#45043 AS id#45130]
               +- SubqueryAlias `x`
                  +- Union
                     :- Project [channel#45042, id#45043, sales#45056, returns#45044, profit#45123]
                     :  +- Union
                     :     :- Project [channel#45042, id#45043, sales#45056, returns#45044, cast(profit#45045 as decimal(18,2)) AS profit#45123]
                     :     :  +- Project [store channel AS channel#45042, s_store_sk#664 AS id#45043, sales#45056, coalesce(returns#45058, cast(0 as decimal(17,2))) AS returns#45044, CheckOverflow((promote_precision(cast(profit#45057 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#45059, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS profit#45045]
                     :     :     +- Join LeftOuter, (s_store_sk#664 = s_store_sk#45080)
                     :     :        :- SubqueryAlias `ss`
                     :     :        :  +- Aggregate [s_store_sk#664], [s_store_sk#664, sum(ss_ext_sales_price#145) AS sales#45056, sum(ss_net_profit#152) AS profit#45057]
                     :     :        :     +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (ss_store_sk#137 = s_store_sk#664))
                     :     :        :        +- Join Inner
                     :     :        :           :- Join Inner
                     :     :        :           :  :- SubqueryAlias `store_sales`
                     :     :        :           :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :     :        :           :  +- SubqueryAlias `date_dim`
                     :     :        :           :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :     :        :           +- SubqueryAlias `store`
                     :     :        :              +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :     :        +- SubqueryAlias `sr`
                     :     :           +- Aggregate [s_store_sk#45080], [s_store_sk#45080, sum(sr_return_amt#187) AS returns#45058, sum(sr_net_loss#195) AS profit_loss#45059]
                     :     :              +- Filter (((sr_returned_date_sk#176 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (sr_store_sk#183 = s_store_sk#45080))
                     :     :                 +- Join Inner
                     :     :                    :- Join Inner
                     :     :                    :  :- SubqueryAlias `store_returns`
                     :     :                    :  :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :     :                    :  +- SubqueryAlias `date_dim`
                     :     :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :     :                    +- SubqueryAlias `store`
                     :     :                       +- Relation[s_store_sk#45080,s_store_id#45081,s_rec_start_date#45082,s_rec_end_date#45083,s_closed_date_sk#45084,s_store_name#45085,s_number_employees#45086,s_floor_space#45087,s_hours#45088,s_manager#45089,s_market_id#45090,s_geography_class#45091,s_market_desc#45092,s_market_manager#45093,s_division_id#45094,s_division_name#45095,s_company_id#45096,s_company_name#45097,s_street_number#45098,s_street_name#45099,s_street_type#45100,s_suite_number#45101,s_city#45102,s_county#45103,... 5 more fields] parquet
                     :     +- Project [channel#45046, id#45047, sales#45060, returns#45062, profit#45048]
                     :        +- Project [catalog channel AS channel#45046, cs_call_center_sk#11 AS id#45047, sales#45060, returns#45062, CheckOverflow((promote_precision(cast(profit#45061 as decimal(18,2))) - promote_precision(cast(profit_loss#45063 as decimal(18,2)))), DecimalType(18,2)) AS profit#45048]
                     :           +- Join Cross
                     :              :- SubqueryAlias `cs`
                     :              :  +- Aggregate [cs_call_center_sk#11], [cs_call_center_sk#11, sum(cs_ext_sales_price#23) AS sales#45060, sum(cs_net_profit#33) AS profit#45061]
                     :              :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date))))
                     :              :        +- Join Inner
                     :              :           :- SubqueryAlias `catalog_sales`
                     :              :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :              :           +- SubqueryAlias `date_dim`
                     :              :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              +- SubqueryAlias `cr`
                     :                 +- Aggregate [cr_call_center_sk#79], [cr_call_center_sk#79, sum(cr_return_amount#86) AS returns#45062, sum(cr_net_loss#94) AS profit_loss#45063]
                     :                    +- Filter ((cr_returned_date_sk#68 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date))))
                     :                       +- Join Inner
                     :                          :- SubqueryAlias `catalog_returns`
                     :                          :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                     :                          +- SubqueryAlias `date_dim`
                     :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- Project [channel#45049, id#45050, sales#45064, returns#45051, cast(profit#45052 as decimal(18,2)) AS profit#45124]
                        +- Project [web channel AS channel#45049, wp_web_page_sk#770 AS id#45050, sales#45064, coalesce(returns#45066, cast(0 as decimal(17,2))) AS returns#45051, CheckOverflow((promote_precision(cast(profit#45065 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#45067, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS profit#45052]
                           +- Join LeftOuter, (wp_web_page_sk#770 = wp_web_page_sk#45109)
                              :- SubqueryAlias `ws`
                              :  +- Aggregate [wp_web_page_sk#770], [wp_web_page_sk#770, sum(ws_ext_sales_price#239) AS sales#45064, sum(ws_net_profit#249) AS profit#45065]
                              :     +- Filter (((ws_sold_date_sk#216 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (ws_web_page_sk#228 = wp_web_page_sk#770))
                              :        +- Join Inner
                              :           :- Join Inner
                              :           :  :- SubqueryAlias `web_sales`
                              :           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :           :  +- SubqueryAlias `date_dim`
                              :           :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :           +- SubqueryAlias `web_page`
                              :              +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet
                              +- SubqueryAlias `wr`
                                 +- Aggregate [wp_web_page_sk#45109], [wp_web_page_sk#45109, sum(wr_return_amt#299) AS returns#45066, sum(wr_net_loss#307) AS profit_loss#45067]
                                    +- Filter (((wr_returned_date_sk#284 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (wr_web_page_sk#295 = wp_web_page_sk#45109))
                                       +- Join Inner
                                          :- Join Inner
                                          :  :- SubqueryAlias `web_returns`
                                          :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                                          :  +- SubqueryAlias `date_dim`
                                          :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                          +- SubqueryAlias `web_page`
                                             +- Relation[wp_web_page_sk#45109,wp_web_page_id#45110,wp_rec_start_date#45111,wp_rec_end_date#45112,wp_creation_date_sk#45113,wp_access_date_sk#45114,wp_autogen_flag#45115,wp_customer_sk#45116,wp_url#45117,wp_type#45118,wp_char_count#45119,wp_link_count#45120,wp_image_count#45121,wp_max_ad_count#45122] parquet

     : benchmark
19/09/08 18:31:43 INFO Query: 
== Query: q77-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#45229 ASC NULLS FIRST, id#45230 ASC NULLS FIRST], true
      +- Aggregate [channel#45229, id#45230, spark_grouping_id#45226], [channel#45229, id#45230, sum(sales#45154) AS sales#45151, sum(returns#45142) AS returns#45152, sum(profit#45221) AS profit#45153]
         +- Expand [List(channel#45140, id#45141, sales#45154, returns#45142, profit#45221, channel#45227, id#45228, 0), List(channel#45140, id#45141, sales#45154, returns#45142, profit#45221, channel#45227, null, 1), List(channel#45140, id#45141, sales#45154, returns#45142, profit#45221, null, null, 3)], [channel#45140, id#45141, sales#45154, returns#45142, profit#45221, channel#45229, id#45230, spark_grouping_id#45226]
            +- Project [channel#45140, id#45141, sales#45154, returns#45142, profit#45221, channel#45140 AS channel#45227, id#45141 AS id#45228]
               +- SubqueryAlias `x`
                  +- Union
                     :- Project [channel#45140, id#45141, sales#45154, returns#45142, profit#45221]
                     :  +- Union
                     :     :- Project [channel#45140, id#45141, sales#45154, returns#45142, cast(profit#45143 as decimal(18,2)) AS profit#45221]
                     :     :  +- Project [store channel AS channel#45140, s_store_sk#664 AS id#45141, sales#45154, coalesce(returns#45156, cast(0 as decimal(17,2))) AS returns#45142, CheckOverflow((promote_precision(cast(profit#45155 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#45157, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS profit#45143]
                     :     :     +- Join LeftOuter, (s_store_sk#664 = s_store_sk#45178)
                     :     :        :- SubqueryAlias `ss`
                     :     :        :  +- Aggregate [s_store_sk#664], [s_store_sk#664, sum(ss_ext_sales_price#145) AS sales#45154, sum(ss_net_profit#152) AS profit#45155]
                     :     :        :     +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (ss_store_sk#137 = s_store_sk#664))
                     :     :        :        +- Join Inner
                     :     :        :           :- Join Inner
                     :     :        :           :  :- SubqueryAlias `store_sales`
                     :     :        :           :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :     :        :           :  +- SubqueryAlias `date_dim`
                     :     :        :           :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :     :        :           +- SubqueryAlias `store`
                     :     :        :              +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :     :        +- SubqueryAlias `sr`
                     :     :           +- Aggregate [s_store_sk#45178], [s_store_sk#45178, sum(sr_return_amt#187) AS returns#45156, sum(sr_net_loss#195) AS profit_loss#45157]
                     :     :              +- Filter (((sr_returned_date_sk#176 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (sr_store_sk#183 = s_store_sk#45178))
                     :     :                 +- Join Inner
                     :     :                    :- Join Inner
                     :     :                    :  :- SubqueryAlias `store_returns`
                     :     :                    :  :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :     :                    :  +- SubqueryAlias `date_dim`
                     :     :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :     :                    +- SubqueryAlias `store`
                     :     :                       +- Relation[s_store_sk#45178,s_store_id#45179,s_rec_start_date#45180,s_rec_end_date#45181,s_closed_date_sk#45182,s_store_name#45183,s_number_employees#45184,s_floor_space#45185,s_hours#45186,s_manager#45187,s_market_id#45188,s_geography_class#45189,s_market_desc#45190,s_market_manager#45191,s_division_id#45192,s_division_name#45193,s_company_id#45194,s_company_name#45195,s_street_number#45196,s_street_name#45197,s_street_type#45198,s_suite_number#45199,s_city#45200,s_county#45201,... 5 more fields] parquet
                     :     +- Project [channel#45144, id#45145, sales#45158, returns#45160, profit#45146]
                     :        +- Project [catalog channel AS channel#45144, cs_call_center_sk#11 AS id#45145, sales#45158, returns#45160, CheckOverflow((promote_precision(cast(profit#45159 as decimal(18,2))) - promote_precision(cast(profit_loss#45161 as decimal(18,2)))), DecimalType(18,2)) AS profit#45146]
                     :           +- Join Cross
                     :              :- SubqueryAlias `cs`
                     :              :  +- Aggregate [cs_call_center_sk#11], [cs_call_center_sk#11, sum(cs_ext_sales_price#23) AS sales#45158, sum(cs_net_profit#33) AS profit#45159]
                     :              :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date))))
                     :              :        +- Join Inner
                     :              :           :- SubqueryAlias `catalog_sales`
                     :              :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :              :           +- SubqueryAlias `date_dim`
                     :              :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              +- SubqueryAlias `cr`
                     :                 +- Aggregate [cr_call_center_sk#79], [cr_call_center_sk#79, sum(cr_return_amount#86) AS returns#45160, sum(cr_net_loss#94) AS profit_loss#45161]
                     :                    +- Filter ((cr_returned_date_sk#68 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date))))
                     :                       +- Join Inner
                     :                          :- SubqueryAlias `catalog_returns`
                     :                          :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                     :                          +- SubqueryAlias `date_dim`
                     :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- Project [channel#45147, id#45148, sales#45162, returns#45149, cast(profit#45150 as decimal(18,2)) AS profit#45222]
                        +- Project [web channel AS channel#45147, wp_web_page_sk#770 AS id#45148, sales#45162, coalesce(returns#45164, cast(0 as decimal(17,2))) AS returns#45149, CheckOverflow((promote_precision(cast(profit#45163 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#45165, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS profit#45150]
                           +- Join LeftOuter, (wp_web_page_sk#770 = wp_web_page_sk#45207)
                              :- SubqueryAlias `ws`
                              :  +- Aggregate [wp_web_page_sk#770], [wp_web_page_sk#770, sum(ws_ext_sales_price#239) AS sales#45162, sum(ws_net_profit#249) AS profit#45163]
                              :     +- Filter (((ws_sold_date_sk#216 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (ws_web_page_sk#228 = wp_web_page_sk#770))
                              :        +- Join Inner
                              :           :- Join Inner
                              :           :  :- SubqueryAlias `web_sales`
                              :           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :           :  +- SubqueryAlias `date_dim`
                              :           :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :           +- SubqueryAlias `web_page`
                              :              +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet
                              +- SubqueryAlias `wr`
                                 +- Aggregate [wp_web_page_sk#45207], [wp_web_page_sk#45207, sum(wr_return_amt#299) AS returns#45164, sum(wr_net_loss#307) AS profit_loss#45165]
                                    +- Filter (((wr_returned_date_sk#284 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (wr_web_page_sk#295 = wp_web_page_sk#45207))
                                       +- Join Inner
                                          :- Join Inner
                                          :  :- SubqueryAlias `web_returns`
                                          :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                                          :  +- SubqueryAlias `date_dim`
                                          :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                          +- SubqueryAlias `web_page`
                                             +- Relation[wp_web_page_sk#45207,wp_web_page_id#45208,wp_rec_start_date#45209,wp_rec_end_date#45210,wp_creation_date_sk#45211,wp_access_date_sk#45212,wp_autogen_flag#45213,wp_customer_sk#45214,wp_url#45215,wp_type#45216,wp_char_count#45217,wp_link_count#45218,wp_image_count#45219,wp_max_ad_count#45220] parquet

      running Thread[benchmark runner,5,main]
19/09/08 18:31:55 ERROR AsyncEventQueue: Dropping event from queue appStatus. This likely means one of the listeners is too slow and cannot keep up with the rate at which tasks are being started by the scheduler.
19/09/08 18:31:55 WARN AsyncEventQueue: Dropped 1 events from appStatus since Thu Jan 01 00:00:00 GMT 1970.
Execution time: 32.989649424s
Running execution q78-v2.4 iteration: 1, StandardRun=true
19/09/08 18:32:21 INFO Query: 
== Query: q78-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ss_sold_year#45550, ss_item_sk#132, ss_customer_sk#133, ratio#45533, store_qty#45534L, store_wholesale_cost#45535, store_sales_price#45536, other_chan_qty#45537L, other_chan_wholesale_cost#45538, other_chan_sales_price#45539]
      +- Sort [ss_sold_year#45550 ASC NULLS FIRST, ss_item_sk#132 ASC NULLS FIRST, ss_customer_sk#133 ASC NULLS FIRST, ss_qty#45551L DESC NULLS LAST, ss_wc#45552 DESC NULLS LAST, ss_sp#45553 DESC NULLS LAST, other_chan_qty#45537L ASC NULLS FIRST, other_chan_wholesale_cost#45538 ASC NULLS FIRST, other_chan_sales_price#45539 ASC NULLS FIRST, round((cast(ss_qty#45551L as double) / cast(coalesce((ws_qty#45542L + cs_qty#45547L), cast(1 as bigint)) as double)), 2) ASC NULLS FIRST], true
         +- Project [ss_sold_year#45550, ss_item_sk#132, ss_customer_sk#133, round((cast(ss_qty#45551L as double) / cast((coalesce(ws_qty#45542L, cast(0 as bigint)) + coalesce(cs_qty#45547L, cast(0 as bigint))) as double)), 2) AS ratio#45533, ss_qty#45551L AS store_qty#45534L, ss_wc#45552 AS store_wholesale_cost#45535, ss_sp#45553 AS store_sales_price#45536, (coalesce(ws_qty#45542L, cast(0 as bigint)) + coalesce(cs_qty#45547L, cast(0 as bigint))) AS other_chan_qty#45537L, CheckOverflow((promote_precision(cast(coalesce(ws_wc#45543, cast(0 as decimal(17,2))) as decimal(18,2))) + promote_precision(cast(coalesce(cs_wc#45548, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS other_chan_wholesale_cost#45538, CheckOverflow((promote_precision(cast(coalesce(ws_sp#45544, cast(0 as decimal(17,2))) as decimal(18,2))) + promote_precision(cast(coalesce(cs_sp#45549, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS other_chan_sales_price#45539, cs_qty#45547L, ws_qty#45542L, ss_sp#45553, ss_qty#45551L, ss_wc#45552]
            +- Filter (((coalesce(ws_qty#45542L, cast(0 as bigint)) > cast(0 as bigint)) || (coalesce(cs_qty#45547L, cast(0 as bigint)) > cast(0 as bigint))) && (ss_sold_year#45550 = 2000))
               +- Join LeftOuter, (((cs_sold_year#45545 = ss_sold_year#45550) && (cs_item_sk#15 = ss_item_sk#132)) && (cs_customer_sk#45546 = ss_customer_sk#133))
                  :- Join LeftOuter, (((ws_sold_year#45540 = ss_sold_year#45550) && (ws_item_sk#219 = ss_item_sk#132)) && (ws_customer_sk#45541 = ss_customer_sk#133))
                  :  :- SubqueryAlias `ss`
                  :  :  +- Aggregate [d_year#498, ss_item_sk#132, ss_customer_sk#133], [d_year#498 AS ss_sold_year#45550, ss_item_sk#132, ss_customer_sk#133, sum(cast(ss_quantity#140 as bigint)) AS ss_qty#45551L, sum(ss_wholesale_cost#141) AS ss_wc#45552, sum(ss_sales_price#143) AS ss_sp#45553]
                  :  :     +- Filter isnull(sr_ticket_number#185L)
                  :  :        +- Join Inner, (ss_sold_date_sk#130 = d_date_sk#492)
                  :  :           :- Join LeftOuter, ((sr_ticket_number#185L = ss_ticket_number#139L) && (ss_item_sk#132 = sr_item_sk#178))
                  :  :           :  :- SubqueryAlias `store_sales`
                  :  :           :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :           :  +- SubqueryAlias `store_returns`
                  :  :           :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :           +- SubqueryAlias `date_dim`
                  :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `ws`
                  :     +- Aggregate [d_year#498, ws_item_sk#219, ws_bill_customer_sk#220], [d_year#498 AS ws_sold_year#45540, ws_item_sk#219, ws_bill_customer_sk#220 AS ws_customer_sk#45541, sum(cast(ws_quantity#234 as bigint)) AS ws_qty#45542L, sum(ws_wholesale_cost#235) AS ws_wc#45543, sum(ws_sales_price#237) AS ws_sp#45544]
                  :        +- Filter isnull(wr_order_number#297L)
                  :           +- Join Inner, (ws_sold_date_sk#216 = d_date_sk#492)
                  :              :- Join LeftOuter, ((wr_order_number#297L = ws_order_number#233L) && (ws_item_sk#219 = wr_item_sk#286))
                  :              :  :- SubqueryAlias `web_sales`
                  :              :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :              :  +- SubqueryAlias `web_returns`
                  :              :     +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                  :              +- SubqueryAlias `date_dim`
                  :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `cs`
                     +- Aggregate [d_year#498, cs_item_sk#15, cs_bill_customer_sk#3], [d_year#498 AS cs_sold_year#45545, cs_item_sk#15, cs_bill_customer_sk#3 AS cs_customer_sk#45546, sum(cast(cs_quantity#18 as bigint)) AS cs_qty#45547L, sum(cs_wholesale_cost#19) AS cs_wc#45548, sum(cs_sales_price#21) AS cs_sp#45549]
                        +- Filter isnull(cr_order_number#84L)
                           +- Join Inner, (cs_sold_date_sk#0 = d_date_sk#492)
                              :- Join LeftOuter, ((cr_order_number#84L = cs_order_number#17L) && (cs_item_sk#15 = cr_item_sk#70))
                              :  :- SubqueryAlias `catalog_sales`
                              :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                              :  +- SubqueryAlias `catalog_returns`
                              :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                              +- SubqueryAlias `date_dim`
                                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:32:21 INFO Query: 
== Query: q78-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ss_sold_year#45590, ss_item_sk#132, ss_customer_sk#133, ratio#45573, store_qty#45574L, store_wholesale_cost#45575, store_sales_price#45576, other_chan_qty#45577L, other_chan_wholesale_cost#45578, other_chan_sales_price#45579]
      +- Sort [ss_sold_year#45590 ASC NULLS FIRST, ss_item_sk#132 ASC NULLS FIRST, ss_customer_sk#133 ASC NULLS FIRST, ss_qty#45591L DESC NULLS LAST, ss_wc#45592 DESC NULLS LAST, ss_sp#45593 DESC NULLS LAST, other_chan_qty#45577L ASC NULLS FIRST, other_chan_wholesale_cost#45578 ASC NULLS FIRST, other_chan_sales_price#45579 ASC NULLS FIRST, round((cast(ss_qty#45591L as double) / cast(coalesce((ws_qty#45582L + cs_qty#45587L), cast(1 as bigint)) as double)), 2) ASC NULLS FIRST], true
         +- Project [ss_sold_year#45590, ss_item_sk#132, ss_customer_sk#133, round((cast(ss_qty#45591L as double) / cast((coalesce(ws_qty#45582L, cast(0 as bigint)) + coalesce(cs_qty#45587L, cast(0 as bigint))) as double)), 2) AS ratio#45573, ss_qty#45591L AS store_qty#45574L, ss_wc#45592 AS store_wholesale_cost#45575, ss_sp#45593 AS store_sales_price#45576, (coalesce(ws_qty#45582L, cast(0 as bigint)) + coalesce(cs_qty#45587L, cast(0 as bigint))) AS other_chan_qty#45577L, CheckOverflow((promote_precision(cast(coalesce(ws_wc#45583, cast(0 as decimal(17,2))) as decimal(18,2))) + promote_precision(cast(coalesce(cs_wc#45588, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS other_chan_wholesale_cost#45578, CheckOverflow((promote_precision(cast(coalesce(ws_sp#45584, cast(0 as decimal(17,2))) as decimal(18,2))) + promote_precision(cast(coalesce(cs_sp#45589, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS other_chan_sales_price#45579, cs_qty#45587L, ss_sp#45593, ws_qty#45582L, ss_qty#45591L, ss_wc#45592]
            +- Filter (((coalesce(ws_qty#45582L, cast(0 as bigint)) > cast(0 as bigint)) || (coalesce(cs_qty#45587L, cast(0 as bigint)) > cast(0 as bigint))) && (ss_sold_year#45590 = 2000))
               +- Join LeftOuter, (((cs_sold_year#45585 = ss_sold_year#45590) && (cs_item_sk#15 = ss_item_sk#132)) && (cs_customer_sk#45586 = ss_customer_sk#133))
                  :- Join LeftOuter, (((ws_sold_year#45580 = ss_sold_year#45590) && (ws_item_sk#219 = ss_item_sk#132)) && (ws_customer_sk#45581 = ss_customer_sk#133))
                  :  :- SubqueryAlias `ss`
                  :  :  +- Aggregate [d_year#498, ss_item_sk#132, ss_customer_sk#133], [d_year#498 AS ss_sold_year#45590, ss_item_sk#132, ss_customer_sk#133, sum(cast(ss_quantity#140 as bigint)) AS ss_qty#45591L, sum(ss_wholesale_cost#141) AS ss_wc#45592, sum(ss_sales_price#143) AS ss_sp#45593]
                  :  :     +- Filter isnull(sr_ticket_number#185L)
                  :  :        +- Join Inner, (ss_sold_date_sk#130 = d_date_sk#492)
                  :  :           :- Join LeftOuter, ((sr_ticket_number#185L = ss_ticket_number#139L) && (ss_item_sk#132 = sr_item_sk#178))
                  :  :           :  :- SubqueryAlias `store_sales`
                  :  :           :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :           :  +- SubqueryAlias `store_returns`
                  :  :           :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :           +- SubqueryAlias `date_dim`
                  :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `ws`
                  :     +- Aggregate [d_year#498, ws_item_sk#219, ws_bill_customer_sk#220], [d_year#498 AS ws_sold_year#45580, ws_item_sk#219, ws_bill_customer_sk#220 AS ws_customer_sk#45581, sum(cast(ws_quantity#234 as bigint)) AS ws_qty#45582L, sum(ws_wholesale_cost#235) AS ws_wc#45583, sum(ws_sales_price#237) AS ws_sp#45584]
                  :        +- Filter isnull(wr_order_number#297L)
                  :           +- Join Inner, (ws_sold_date_sk#216 = d_date_sk#492)
                  :              :- Join LeftOuter, ((wr_order_number#297L = ws_order_number#233L) && (ws_item_sk#219 = wr_item_sk#286))
                  :              :  :- SubqueryAlias `web_sales`
                  :              :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :              :  +- SubqueryAlias `web_returns`
                  :              :     +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                  :              +- SubqueryAlias `date_dim`
                  :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `cs`
                     +- Aggregate [d_year#498, cs_item_sk#15, cs_bill_customer_sk#3], [d_year#498 AS cs_sold_year#45585, cs_item_sk#15, cs_bill_customer_sk#3 AS cs_customer_sk#45586, sum(cast(cs_quantity#18 as bigint)) AS cs_qty#45587L, sum(cs_wholesale_cost#19) AS cs_wc#45588, sum(cs_sales_price#21) AS cs_sp#45589]
                        +- Filter isnull(cr_order_number#84L)
                           +- Join Inner, (cs_sold_date_sk#0 = d_date_sk#492)
                              :- Join LeftOuter, ((cr_order_number#84L = cs_order_number#17L) && (cs_item_sk#15 = cr_item_sk#70))
                              :  :- SubqueryAlias `catalog_sales`
                              :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                              :  +- SubqueryAlias `catalog_returns`
                              :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                              +- SubqueryAlias `date_dim`
                                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 25.731531031s
Running execution q79-v2.4 iteration: 1, StandardRun=true
19/09/08 18:32:49 INFO Query: 
== Query: q79-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [c_last_name#421, c_first_name#420, substring(s_city, 1, 30)#45731, ss_ticket_number#139L, amt#45727, profit#45728]
      +- Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, substring(s_city#686, 1, 30) ASC NULLS FIRST, profit#45728 ASC NULLS FIRST], true
         +- Project [c_last_name#421, c_first_name#420, substring(s_city#686, 1, 30) AS substring(s_city, 1, 30)#45731, ss_ticket_number#139L, amt#45727, profit#45728, s_city#686]
            +- Filter (ss_customer_sk#133 = c_customer_sk#412)
               +- Join Inner
                  :- SubqueryAlias `ms`
                  :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133, ss_addr_sk#136, s_city#686], [ss_ticket_number#139L, ss_customer_sk#133, s_city#686, sum(ss_coupon_amt#149) AS amt#45727, sum(ss_net_profit#152) AS profit#45728]
                  :     +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_hdemo_sk#135 = hd_demo_sk#548) && ((hd_dep_count#551 = 6) || (hd_vehicle_count#552 > 2)))) && (((d_dow#499 = 1) && d_year#498 IN (1999,(1999 + 1),(1999 + 2))) && ((s_number_employees#670 >= 200) && (s_number_employees#670 <= 295))))
                  :        +- Join Inner
                  :           :- Join Inner
                  :           :  :- Join Inner
                  :           :  :  :- SubqueryAlias `store_sales`
                  :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :           :  :  +- SubqueryAlias `date_dim`
                  :           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :           :  +- SubqueryAlias `store`
                  :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  :           +- SubqueryAlias `household_demographics`
                  :              +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                  +- SubqueryAlias `customer`
                     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/09/08 18:32:49 INFO Query: 
== Query: q79-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [c_last_name#421, c_first_name#420, substring(s_city, 1, 30)#45742, ss_ticket_number#139L, amt#45738, profit#45739]
      +- Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, substring(s_city#686, 1, 30) ASC NULLS FIRST, profit#45739 ASC NULLS FIRST], true
         +- Project [c_last_name#421, c_first_name#420, substring(s_city#686, 1, 30) AS substring(s_city, 1, 30)#45742, ss_ticket_number#139L, amt#45738, profit#45739, s_city#686]
            +- Filter (ss_customer_sk#133 = c_customer_sk#412)
               +- Join Inner
                  :- SubqueryAlias `ms`
                  :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133, ss_addr_sk#136, s_city#686], [ss_ticket_number#139L, ss_customer_sk#133, s_city#686, sum(ss_coupon_amt#149) AS amt#45738, sum(ss_net_profit#152) AS profit#45739]
                  :     +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_hdemo_sk#135 = hd_demo_sk#548) && ((hd_dep_count#551 = 6) || (hd_vehicle_count#552 > 2)))) && (((d_dow#499 = 1) && d_year#498 IN (1999,(1999 + 1),(1999 + 2))) && ((s_number_employees#670 >= 200) && (s_number_employees#670 <= 295))))
                  :        +- Join Inner
                  :           :- Join Inner
                  :           :  :- Join Inner
                  :           :  :  :- SubqueryAlias `store_sales`
                  :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :           :  :  +- SubqueryAlias `date_dim`
                  :           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :           :  +- SubqueryAlias `store`
                  :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  :           +- SubqueryAlias `household_demographics`
                  :              +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                  +- SubqueryAlias `customer`
                     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 4.257252362999999s
Running execution q80-v2.4 iteration: 1, StandardRun=true
19/09/08 18:32:55 INFO Query: 
== Query: q80-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#45883 ASC NULLS FIRST, id#45884 ASC NULLS FIRST], true
      +- Aggregate [channel#45883, id#45884, spark_grouping_id#45880], [channel#45883, id#45884, sum(sales#45858) AS sales#45854, sum(returns#45859) AS returns#45855, sum(profit#45860) AS profit#45856]
         +- Expand [List(channel#45848, id#45849, sales#45858, returns#45859, profit#45860, channel#45881, id#45882, 0), List(channel#45848, id#45849, sales#45858, returns#45859, profit#45860, channel#45881, null, 1), List(channel#45848, id#45849, sales#45858, returns#45859, profit#45860, null, null, 3)], [channel#45848, id#45849, sales#45858, returns#45859, profit#45860, channel#45883, id#45884, spark_grouping_id#45880]
            +- Project [channel#45848, id#45849, sales#45858, returns#45859, profit#45860, channel#45848 AS channel#45881, id#45849 AS id#45882]
               +- SubqueryAlias `x`
                  +- Union
                     :- Union
                     :  :- Project [store channel AS channel#45848, concat(store, store_id#45857) AS id#45849, sales#45858, returns#45859, profit#45860]
                     :  :  +- SubqueryAlias `ssr`
                     :  :     +- Aggregate [s_store_id#665], [s_store_id#665 AS store_id#45857, sum(ss_ext_sales_price#145) AS sales#45858, sum(coalesce(cast(sr_return_amt#187 as decimal(12,2)), cast(0 as decimal(12,2)))) AS returns#45859, sum(CheckOverflow((promote_precision(cast(ss_net_profit#152 as decimal(13,2))) - promote_precision(cast(coalesce(cast(sr_net_loss#195 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2))) AS profit#45860]
                     :  :        +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && ((ss_store_sk#137 = s_store_sk#664) && (ss_item_sk#132 = i_item_sk#564))) && (((cast(i_current_price#569 as decimal(7,2)) > cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (ss_promo_sk#138 = p_promo_sk#608)) && (p_channel_tv#619 = N)))
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- Join Inner
                     :  :              :  :  :- Join Inner
                     :  :              :  :  :  :- Join LeftOuter, ((ss_item_sk#132 = sr_item_sk#178) && (ss_ticket_number#139L = sr_ticket_number#185L))
                     :  :              :  :  :  :  :- SubqueryAlias `store_sales`
                     :  :              :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :              :  :  :  :  +- SubqueryAlias `store_returns`
                     :  :              :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :              :  :  :  +- SubqueryAlias `date_dim`
                     :  :              :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :              :  :  +- SubqueryAlias `store`
                     :  :              :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  :              :  +- SubqueryAlias `item`
                     :  :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :              +- SubqueryAlias `promotion`
                     :  :                 +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                     :  +- Project [catalog channel AS channel#45850, concat(catalog_page, catalog_page_id#45861) AS id#45851, sales#45862, returns#45863, profit#45864]
                     :     +- SubqueryAlias `csr`
                     :        +- Aggregate [cp_catalog_page_id#395], [cp_catalog_page_id#395 AS catalog_page_id#45861, sum(cs_ext_sales_price#23) AS sales#45862, sum(coalesce(cast(cr_return_amount#86 as decimal(12,2)), cast(0 as decimal(12,2)))) AS returns#45863, sum(CheckOverflow((promote_precision(cast(cs_net_profit#33 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_net_loss#94 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2))) AS profit#45864]
                     :           +- Filter ((((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && ((cs_catalog_page_sk#12 = cp_catalog_page_sk#394) && (cs_item_sk#15 = i_item_sk#564))) && (((cast(i_current_price#569 as decimal(7,2)) > cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cs_promo_sk#16 = p_promo_sk#608)) && (p_channel_tv#619 = N)))
                     :              +- Join Inner
                     :                 :- Join Inner
                     :                 :  :- Join Inner
                     :                 :  :  :- Join Inner
                     :                 :  :  :  :- Join LeftOuter, ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                     :                 :  :  :  :  :- SubqueryAlias `catalog_sales`
                     :                 :  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :                 :  :  :  :  +- SubqueryAlias `catalog_returns`
                     :                 :  :  :  :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                     :                 :  :  :  +- SubqueryAlias `date_dim`
                     :                 :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :                 :  :  +- SubqueryAlias `catalog_page`
                     :                 :  :     +- Relation[cp_catalog_page_sk#394,cp_catalog_page_id#395,cp_start_date_sk#396,cp_end_date_sk#397,cp_department#398,cp_catalog_number#399,cp_catalog_page_number#400,cp_description#401,cp_type#402] parquet
                     :                 :  +- SubqueryAlias `item`
                     :                 :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :                 +- SubqueryAlias `promotion`
                     :                    +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                     +- Project [web channel AS channel#45852, concat(web_site, web_site_id#799) AS id#45853, sales#45865, returns#45866, profit#45867]
                        +- SubqueryAlias `wsr`
                           +- Aggregate [web_site_id#799], [web_site_id#799, sum(ws_ext_sales_price#239) AS sales#45865, sum(coalesce(cast(wr_return_amt#299 as decimal(12,2)), cast(0 as decimal(12,2)))) AS returns#45866, sum(CheckOverflow((promote_precision(cast(ws_net_profit#249 as decimal(13,2))) - promote_precision(cast(coalesce(cast(wr_net_loss#307 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2))) AS profit#45867]
                              +- Filter ((((ws_sold_date_sk#216 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && ((ws_web_site_sk#229 = web_site_sk#798) && (ws_item_sk#219 = i_item_sk#564))) && (((cast(i_current_price#569 as decimal(7,2)) > cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (ws_promo_sk#232 = p_promo_sk#608)) && (p_channel_tv#619 = N)))
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- Join Inner
                                    :  :  :- Join Inner
                                    :  :  :  :- Join LeftOuter, ((ws_item_sk#219 = wr_item_sk#286) && (ws_order_number#233L = wr_order_number#297L))
                                    :  :  :  :  :- SubqueryAlias `web_sales`
                                    :  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  :  :  :  +- SubqueryAlias `web_returns`
                                    :  :  :  :     +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                                    :  :  :  +- SubqueryAlias `date_dim`
                                    :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                    :  :  +- SubqueryAlias `web_site`
                                    :  :     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet
                                    :  +- SubqueryAlias `item`
                                    :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                    +- SubqueryAlias `promotion`
                                       +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet

     : benchmark
19/09/08 18:32:56 INFO Query: 
== Query: q80-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#45927 ASC NULLS FIRST, id#45928 ASC NULLS FIRST], true
      +- Aggregate [channel#45927, id#45928, spark_grouping_id#45924], [channel#45927, id#45928, sum(sales#45902) AS sales#45898, sum(returns#45903) AS returns#45899, sum(profit#45904) AS profit#45900]
         +- Expand [List(channel#45892, id#45893, sales#45902, returns#45903, profit#45904, channel#45925, id#45926, 0), List(channel#45892, id#45893, sales#45902, returns#45903, profit#45904, channel#45925, null, 1), List(channel#45892, id#45893, sales#45902, returns#45903, profit#45904, null, null, 3)], [channel#45892, id#45893, sales#45902, returns#45903, profit#45904, channel#45927, id#45928, spark_grouping_id#45924]
            +- Project [channel#45892, id#45893, sales#45902, returns#45903, profit#45904, channel#45892 AS channel#45925, id#45893 AS id#45926]
               +- SubqueryAlias `x`
                  +- Union
                     :- Union
                     :  :- Project [store channel AS channel#45892, concat(store, store_id#45901) AS id#45893, sales#45902, returns#45903, profit#45904]
                     :  :  +- SubqueryAlias `ssr`
                     :  :     +- Aggregate [s_store_id#665], [s_store_id#665 AS store_id#45901, sum(ss_ext_sales_price#145) AS sales#45902, sum(coalesce(cast(sr_return_amt#187 as decimal(12,2)), cast(0 as decimal(12,2)))) AS returns#45903, sum(CheckOverflow((promote_precision(cast(ss_net_profit#152 as decimal(13,2))) - promote_precision(cast(coalesce(cast(sr_net_loss#195 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2))) AS profit#45904]
                     :  :        +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && ((ss_store_sk#137 = s_store_sk#664) && (ss_item_sk#132 = i_item_sk#564))) && (((cast(i_current_price#569 as decimal(7,2)) > cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (ss_promo_sk#138 = p_promo_sk#608)) && (p_channel_tv#619 = N)))
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- Join Inner
                     :  :              :  :  :- Join Inner
                     :  :              :  :  :  :- Join LeftOuter, ((ss_item_sk#132 = sr_item_sk#178) && (ss_ticket_number#139L = sr_ticket_number#185L))
                     :  :              :  :  :  :  :- SubqueryAlias `store_sales`
                     :  :              :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :              :  :  :  :  +- SubqueryAlias `store_returns`
                     :  :              :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :              :  :  :  +- SubqueryAlias `date_dim`
                     :  :              :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :              :  :  +- SubqueryAlias `store`
                     :  :              :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  :              :  +- SubqueryAlias `item`
                     :  :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :              +- SubqueryAlias `promotion`
                     :  :                 +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                     :  +- Project [catalog channel AS channel#45894, concat(catalog_page, catalog_page_id#45905) AS id#45895, sales#45906, returns#45907, profit#45908]
                     :     +- SubqueryAlias `csr`
                     :        +- Aggregate [cp_catalog_page_id#395], [cp_catalog_page_id#395 AS catalog_page_id#45905, sum(cs_ext_sales_price#23) AS sales#45906, sum(coalesce(cast(cr_return_amount#86 as decimal(12,2)), cast(0 as decimal(12,2)))) AS returns#45907, sum(CheckOverflow((promote_precision(cast(cs_net_profit#33 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_net_loss#94 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2))) AS profit#45908]
                     :           +- Filter ((((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && ((cs_catalog_page_sk#12 = cp_catalog_page_sk#394) && (cs_item_sk#15 = i_item_sk#564))) && (((cast(i_current_price#569 as decimal(7,2)) > cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cs_promo_sk#16 = p_promo_sk#608)) && (p_channel_tv#619 = N)))
                     :              +- Join Inner
                     :                 :- Join Inner
                     :                 :  :- Join Inner
                     :                 :  :  :- Join Inner
                     :                 :  :  :  :- Join LeftOuter, ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                     :                 :  :  :  :  :- SubqueryAlias `catalog_sales`
                     :                 :  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :                 :  :  :  :  +- SubqueryAlias `catalog_returns`
                     :                 :  :  :  :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                     :                 :  :  :  +- SubqueryAlias `date_dim`
                     :                 :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :                 :  :  +- SubqueryAlias `catalog_page`
                     :                 :  :     +- Relation[cp_catalog_page_sk#394,cp_catalog_page_id#395,cp_start_date_sk#396,cp_end_date_sk#397,cp_department#398,cp_catalog_number#399,cp_catalog_page_number#400,cp_description#401,cp_type#402] parquet
                     :                 :  +- SubqueryAlias `item`
                     :                 :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :                 +- SubqueryAlias `promotion`
                     :                    +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                     +- Project [web channel AS channel#45896, concat(web_site, web_site_id#799) AS id#45897, sales#45909, returns#45910, profit#45911]
                        +- SubqueryAlias `wsr`
                           +- Aggregate [web_site_id#799], [web_site_id#799, sum(ws_ext_sales_price#239) AS sales#45909, sum(coalesce(cast(wr_return_amt#299 as decimal(12,2)), cast(0 as decimal(12,2)))) AS returns#45910, sum(CheckOverflow((promote_precision(cast(ws_net_profit#249 as decimal(13,2))) - promote_precision(cast(coalesce(cast(wr_net_loss#307 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2))) AS profit#45911]
                              +- Filter ((((ws_sold_date_sk#216 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && ((ws_web_site_sk#229 = web_site_sk#798) && (ws_item_sk#219 = i_item_sk#564))) && (((cast(i_current_price#569 as decimal(7,2)) > cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (ws_promo_sk#232 = p_promo_sk#608)) && (p_channel_tv#619 = N)))
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- Join Inner
                                    :  :  :- Join Inner
                                    :  :  :  :- Join LeftOuter, ((ws_item_sk#219 = wr_item_sk#286) && (ws_order_number#233L = wr_order_number#297L))
                                    :  :  :  :  :- SubqueryAlias `web_sales`
                                    :  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  :  :  :  +- SubqueryAlias `web_returns`
                                    :  :  :  :     +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                                    :  :  :  +- SubqueryAlias `date_dim`
                                    :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                    :  :  +- SubqueryAlias `web_site`
                                    :  :     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet
                                    :  +- SubqueryAlias `item`
                                    :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                    +- SubqueryAlias `promotion`
                                       +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet

      running Thread[benchmark runner,5,main]
Execution time: 24.475486962999998s
Running execution q81-v2.4 iteration: 1, StandardRun=true
19/09/08 18:33:23 INFO Query: 
== Query: q81-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_customer_id#413 ASC NULLS FIRST, c_salutation#419 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, c_last_name#421 ASC NULLS FIRST, ca_street_number#450 ASC NULLS FIRST, ca_street_name#451 ASC NULLS FIRST, ca_street_type#452 ASC NULLS FIRST, ca_suite_number#453 ASC NULLS FIRST, ca_city#454 ASC NULLS FIRST, ca_county#455 ASC NULLS FIRST, ca_state#456 ASC NULLS FIRST, ca_zip#457 ASC NULLS FIRST, ca_country#458 ASC NULLS FIRST, ca_gmt_offset#459 ASC NULLS FIRST, ca_location_type#460 ASC NULLS FIRST, ctr_total_return#46090 ASC NULLS FIRST], true
      +- Project [c_customer_id#413, c_salutation#419, c_first_name#420, c_last_name#421, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, ctr_total_return#46090]
         +- Filter (((cast(ctr_total_return#46090 as decimal(24,7)) > cast(scalar-subquery#46087 [ctr_state#46089] as decimal(24,7))) && (ca_address_sk#448 = c_current_addr_sk#416)) && ((ca_state#456 = GA) && (ctr_customer_sk#46088 = c_customer_sk#412)))
            :  +- Aggregate [CheckOverflow((promote_precision(cast(avg(ctr_total_return#46090) as decimal(21,6))) * promote_precision(cast(1.2 as decimal(21,6)))), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#46093]
            :     +- Filter (outer(ctr_state#46089) = ctr_state#46089)
            :        +- SubqueryAlias `ctr2`
            :           +- SubqueryAlias `customer_total_return`
            :              +- Aggregate [cr_returning_customer_sk#75, ca_state#456], [cr_returning_customer_sk#75 AS ctr_customer_sk#46088, ca_state#456 AS ctr_state#46089, sum(cr_return_amt_inc_tax#88) AS ctr_total_return#46090]
            :                 +- Filter (((cr_returned_date_sk#68 = d_date_sk#492) && (d_year#498 = 2000)) && (cr_returning_addr_sk#78 = ca_address_sk#448))
            :                    +- Join Inner
            :                       :- Join Inner
            :                       :  :- SubqueryAlias `catalog_returns`
            :                       :  :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
            :                       :  +- SubqueryAlias `date_dim`
            :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :                       +- SubqueryAlias `customer_address`
            :                          +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ctr1`
               :  :  +- SubqueryAlias `customer_total_return`
               :  :     +- Aggregate [cr_returning_customer_sk#75, ca_state#456], [cr_returning_customer_sk#75 AS ctr_customer_sk#46088, ca_state#456 AS ctr_state#46089, sum(cr_return_amt_inc_tax#88) AS ctr_total_return#46090]
               :  :        +- Filter (((cr_returned_date_sk#68 = d_date_sk#492) && (d_year#498 = 2000)) && (cr_returning_addr_sk#78 = ca_address_sk#448))
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- SubqueryAlias `catalog_returns`
               :  :              :  :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               :  :              :  +- SubqueryAlias `date_dim`
               :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              +- SubqueryAlias `customer_address`
               :  :                 +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer_address`
               :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer`
                  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/09/08 18:33:23 INFO Query: 
== Query: q81-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_customer_id#413 ASC NULLS FIRST, c_salutation#419 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, c_last_name#421 ASC NULLS FIRST, ca_street_number#450 ASC NULLS FIRST, ca_street_name#451 ASC NULLS FIRST, ca_street_type#452 ASC NULLS FIRST, ca_suite_number#453 ASC NULLS FIRST, ca_city#454 ASC NULLS FIRST, ca_county#455 ASC NULLS FIRST, ca_state#456 ASC NULLS FIRST, ca_zip#457 ASC NULLS FIRST, ca_country#458 ASC NULLS FIRST, ca_gmt_offset#459 ASC NULLS FIRST, ca_location_type#460 ASC NULLS FIRST, ctr_total_return#46113 ASC NULLS FIRST], true
      +- Project [c_customer_id#413, c_salutation#419, c_first_name#420, c_last_name#421, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, ctr_total_return#46113]
         +- Filter (((cast(ctr_total_return#46113 as decimal(24,7)) > cast(scalar-subquery#46110 [ctr_state#46112] as decimal(24,7))) && (ca_address_sk#448 = c_current_addr_sk#416)) && ((ca_state#456 = GA) && (ctr_customer_sk#46111 = c_customer_sk#412)))
            :  +- Aggregate [CheckOverflow((promote_precision(cast(avg(ctr_total_return#46113) as decimal(21,6))) * promote_precision(cast(1.2 as decimal(21,6)))), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#46116]
            :     +- Filter (outer(ctr_state#46112) = ctr_state#46112)
            :        +- SubqueryAlias `ctr2`
            :           +- SubqueryAlias `customer_total_return`
            :              +- Aggregate [cr_returning_customer_sk#75, ca_state#456], [cr_returning_customer_sk#75 AS ctr_customer_sk#46111, ca_state#456 AS ctr_state#46112, sum(cr_return_amt_inc_tax#88) AS ctr_total_return#46113]
            :                 +- Filter (((cr_returned_date_sk#68 = d_date_sk#492) && (d_year#498 = 2000)) && (cr_returning_addr_sk#78 = ca_address_sk#448))
            :                    +- Join Inner
            :                       :- Join Inner
            :                       :  :- SubqueryAlias `catalog_returns`
            :                       :  :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
            :                       :  +- SubqueryAlias `date_dim`
            :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :                       +- SubqueryAlias `customer_address`
            :                          +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ctr1`
               :  :  +- SubqueryAlias `customer_total_return`
               :  :     +- Aggregate [cr_returning_customer_sk#75, ca_state#456], [cr_returning_customer_sk#75 AS ctr_customer_sk#46111, ca_state#456 AS ctr_state#46112, sum(cr_return_amt_inc_tax#88) AS ctr_total_return#46113]
               :  :        +- Filter (((cr_returned_date_sk#68 = d_date_sk#492) && (d_year#498 = 2000)) && (cr_returning_addr_sk#78 = ca_address_sk#448))
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- SubqueryAlias `catalog_returns`
               :  :              :  :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               :  :              :  +- SubqueryAlias `date_dim`
               :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              +- SubqueryAlias `customer_address`
               :  :                 +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer_address`
               :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer`
                  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 4.987874284s
Running execution q82-v2.4 iteration: 1, StandardRun=true
19/09/08 18:33:29 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
19/09/08 18:33:29 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 5.429477146s
Running execution q83-v2.4 iteration: 1, StandardRun=true
19/09/08 18:33:36 INFO Query: 
== Query: q83-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_id#46253 ASC NULLS FIRST, sr_item_qty#46254L ASC NULLS FIRST], true
      +- Project [item_id#46253, sr_item_qty#46254L, (((cast(sr_item_qty#46254L as double) / cast(((sr_item_qty#46254L + cr_item_qty#46258L) + wr_item_qty#46262L) as double)) / cast(3.0 as double)) * cast(100 as double)) AS sr_dev#46249, cr_item_qty#46258L, (((cast(cr_item_qty#46258L as double) / cast(((sr_item_qty#46254L + cr_item_qty#46258L) + wr_item_qty#46262L) as double)) / cast(3.0 as double)) * cast(100 as double)) AS cr_dev#46250, wr_item_qty#46262L, (((cast(wr_item_qty#46262L as double) / cast(((sr_item_qty#46254L + cr_item_qty#46258L) + wr_item_qty#46262L) as double)) / cast(3.0 as double)) * cast(100 as double)) AS wr_dev#46251, CheckOverflow((promote_precision(cast(cast(((sr_item_qty#46254L + cr_item_qty#46258L) + wr_item_qty#46262L) as decimal(20,0)) as decimal(21,1))) / promote_precision(cast(3.0 as decimal(21,1)))), DecimalType(27,6)) AS average#46252]
         +- Filter ((item_id#46253 = item_id#46257) && (item_id#46253 = item_id#46261))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `sr_items`
               :  :  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#46253, sum(cast(sr_return_quantity#186 as bigint)) AS sr_item_qty#46254L]
               :  :     +- Filter (((sr_item_sk#178 = i_item_sk#564) && d_date#494 IN (list#46256 [])) && (sr_returned_date_sk#176 = d_date_sk#492))
               :  :        :  +- Project [d_date#494]
               :  :        :     +- Filter d_week_seq#496 IN (list#46255 [])
               :  :        :        :  +- Project [d_week_seq#496]
               :  :        :        :     +- Filter d_date#494 IN (cast(2000-06-30 as date),cast(2000-09-27 as date),cast(2000-11-17 as date))
               :  :        :        :        +- SubqueryAlias `date_dim`
               :  :        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        :        +- SubqueryAlias `date_dim`
               :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- SubqueryAlias `store_returns`
               :  :           :  :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :  :           :  +- SubqueryAlias `item`
               :  :           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- SubqueryAlias `date_dim`
               :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `cr_items`
               :     +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#46257, sum(cast(cr_return_quantity#85 as bigint)) AS cr_item_qty#46258L]
               :        +- Filter (((cr_item_sk#70 = i_item_sk#564) && d_date#494 IN (list#46260 [])) && (cr_returned_date_sk#68 = d_date_sk#492))
               :           :  +- Project [d_date#494]
               :           :     +- Filter d_week_seq#496 IN (list#46259 [])
               :           :        :  +- Project [d_week_seq#496]
               :           :        :     +- Filter d_date#494 IN (cast(2000-06-30 as date),cast(2000-09-27 as date),cast(2000-11-17 as date))
               :           :        :        +- SubqueryAlias `date_dim`
               :           :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Join Inner
               :              :- Join Inner
               :              :  :- SubqueryAlias `catalog_returns`
               :              :  :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               :              :  +- SubqueryAlias `item`
               :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- SubqueryAlias `date_dim`
               :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `wr_items`
                  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#46261, sum(cast(wr_return_quantity#298 as bigint)) AS wr_item_qty#46262L]
                     +- Filter (((wr_item_sk#286 = i_item_sk#564) && d_date#494 IN (list#46264 [])) && (wr_returned_date_sk#284 = d_date_sk#492))
                        :  +- Project [d_date#494]
                        :     +- Filter d_week_seq#496 IN (list#46263 [])
                        :        :  +- Project [d_week_seq#496]
                        :        :     +- Filter d_date#494 IN (cast(2000-06-30 as date),cast(2000-09-27 as date),cast(2000-11-17 as date))
                        :        :        +- SubqueryAlias `date_dim`
                        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `web_returns`
                           :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                           :  +- SubqueryAlias `item`
                           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:33:37 INFO Query: 
== Query: q83-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_id#46280 ASC NULLS FIRST, sr_item_qty#46281L ASC NULLS FIRST], true
      +- Project [item_id#46280, sr_item_qty#46281L, (((cast(sr_item_qty#46281L as double) / cast(((sr_item_qty#46281L + cr_item_qty#46285L) + wr_item_qty#46289L) as double)) / cast(3.0 as double)) * cast(100 as double)) AS sr_dev#46276, cr_item_qty#46285L, (((cast(cr_item_qty#46285L as double) / cast(((sr_item_qty#46281L + cr_item_qty#46285L) + wr_item_qty#46289L) as double)) / cast(3.0 as double)) * cast(100 as double)) AS cr_dev#46277, wr_item_qty#46289L, (((cast(wr_item_qty#46289L as double) / cast(((sr_item_qty#46281L + cr_item_qty#46285L) + wr_item_qty#46289L) as double)) / cast(3.0 as double)) * cast(100 as double)) AS wr_dev#46278, CheckOverflow((promote_precision(cast(cast(((sr_item_qty#46281L + cr_item_qty#46285L) + wr_item_qty#46289L) as decimal(20,0)) as decimal(21,1))) / promote_precision(cast(3.0 as decimal(21,1)))), DecimalType(27,6)) AS average#46279]
         +- Filter ((item_id#46280 = item_id#46284) && (item_id#46280 = item_id#46288))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `sr_items`
               :  :  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#46280, sum(cast(sr_return_quantity#186 as bigint)) AS sr_item_qty#46281L]
               :  :     +- Filter (((sr_item_sk#178 = i_item_sk#564) && d_date#494 IN (list#46283 [])) && (sr_returned_date_sk#176 = d_date_sk#492))
               :  :        :  +- Project [d_date#494]
               :  :        :     +- Filter d_week_seq#496 IN (list#46282 [])
               :  :        :        :  +- Project [d_week_seq#496]
               :  :        :        :     +- Filter d_date#494 IN (cast(2000-06-30 as date),cast(2000-09-27 as date),cast(2000-11-17 as date))
               :  :        :        :        +- SubqueryAlias `date_dim`
               :  :        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        :        +- SubqueryAlias `date_dim`
               :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- SubqueryAlias `store_returns`
               :  :           :  :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :  :           :  +- SubqueryAlias `item`
               :  :           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- SubqueryAlias `date_dim`
               :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `cr_items`
               :     +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#46284, sum(cast(cr_return_quantity#85 as bigint)) AS cr_item_qty#46285L]
               :        +- Filter (((cr_item_sk#70 = i_item_sk#564) && d_date#494 IN (list#46287 [])) && (cr_returned_date_sk#68 = d_date_sk#492))
               :           :  +- Project [d_date#494]
               :           :     +- Filter d_week_seq#496 IN (list#46286 [])
               :           :        :  +- Project [d_week_seq#496]
               :           :        :     +- Filter d_date#494 IN (cast(2000-06-30 as date),cast(2000-09-27 as date),cast(2000-11-17 as date))
               :           :        :        +- SubqueryAlias `date_dim`
               :           :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Join Inner
               :              :- Join Inner
               :              :  :- SubqueryAlias `catalog_returns`
               :              :  :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               :              :  +- SubqueryAlias `item`
               :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- SubqueryAlias `date_dim`
               :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `wr_items`
                  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#46288, sum(cast(wr_return_quantity#298 as bigint)) AS wr_item_qty#46289L]
                     +- Filter (((wr_item_sk#286 = i_item_sk#564) && d_date#494 IN (list#46291 [])) && (wr_returned_date_sk#284 = d_date_sk#492))
                        :  +- Project [d_date#494]
                        :     +- Filter d_week_seq#496 IN (list#46290 [])
                        :        :  +- Project [d_week_seq#496]
                        :        :     +- Filter d_date#494 IN (cast(2000-06-30 as date),cast(2000-09-27 as date),cast(2000-11-17 as date))
                        :        :        +- SubqueryAlias `date_dim`
                        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `web_returns`
                           :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                           :  +- SubqueryAlias `item`
                           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 3.7022770609999998s
Running execution q84-v2.4 iteration: 1, StandardRun=true
19/09/08 18:33:42 INFO Query: 
== Query: q84-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [customer_id#46377, customername#46378]
      +- Sort [c_customer_id#413 ASC NULLS FIRST], true
         +- Project [c_customer_id#413 AS customer_id#46377, ((cast(coalesce(c_last_name#421, ) as double) + cast(,  as double)) + cast(coalesce(c_first_name#420, ) as double)) AS customername#46378, c_customer_id#413]
            +- Filter ((((ca_city#454 = Edgewood) && (c_current_addr_sk#416 = ca_address_sk#448)) && ((ib_lower_bound#559 >= 38128) && (ib_upper_bound#560 <= (38128 + 50000)))) && (((ib_income_band_sk#558 = hd_income_band_sk#549) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && ((hd_demo_sk#548 = c_current_hdemo_sk#415) && (sr_cdemo_sk#180 = cd_demo_sk#474))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- SubqueryAlias `customer`
                  :  :  :  :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  :  :  :  +- SubqueryAlias `customer_address`
                  :  :  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  :  :  :  +- SubqueryAlias `customer_demographics`
                  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  +- SubqueryAlias `household_demographics`
                  :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                  :  +- SubqueryAlias `income_band`
                  :     +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                  +- SubqueryAlias `store_returns`
                     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet

     : benchmark
19/09/08 18:33:42 INFO Query: 
== Query: q84-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [customer_id#46381, customername#46382]
      +- Sort [c_customer_id#413 ASC NULLS FIRST], true
         +- Project [c_customer_id#413 AS customer_id#46381, ((cast(coalesce(c_last_name#421, ) as double) + cast(,  as double)) + cast(coalesce(c_first_name#420, ) as double)) AS customername#46382, c_customer_id#413]
            +- Filter ((((ca_city#454 = Edgewood) && (c_current_addr_sk#416 = ca_address_sk#448)) && ((ib_lower_bound#559 >= 38128) && (ib_upper_bound#560 <= (38128 + 50000)))) && (((ib_income_band_sk#558 = hd_income_band_sk#549) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && ((hd_demo_sk#548 = c_current_hdemo_sk#415) && (sr_cdemo_sk#180 = cd_demo_sk#474))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- SubqueryAlias `customer`
                  :  :  :  :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  :  :  :  +- SubqueryAlias `customer_address`
                  :  :  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  :  :  :  +- SubqueryAlias `customer_demographics`
                  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  +- SubqueryAlias `household_demographics`
                  :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                  :  +- SubqueryAlias `income_band`
                  :     +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                  +- SubqueryAlias `store_returns`
                     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet

      running Thread[benchmark runner,5,main]
Execution time: 2.503949558s
Running execution q85-v2.4 iteration: 1, StandardRun=true
19/09/08 18:33:46 INFO Query: 
== Query: q85-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [substring(r_reason_desc, 1, 20)#46445, avg(ws_quantity)#46446, avg(wr_refunded_cash)#46447, avg(wr_fee)#46448]
      +- Sort [substring(r_reason_desc, 1, 20)#46445 ASC NULLS FIRST, aggOrder#46450 ASC NULLS FIRST, avg(wr_refunded_cash)#46447 ASC NULLS FIRST, avg(wr_fee)#46448 ASC NULLS FIRST], true
         +- Aggregate [r_reason_desc#648], [substring(r_reason_desc#648, 1, 20) AS substring(r_reason_desc, 1, 20)#46445, avg(cast(ws_quantity#234 as bigint)) AS avg(ws_quantity)#46446, avg(wr_refunded_cash#304) AS avg(wr_refunded_cash)#46447, avg(wr_fee#302) AS avg(wr_fee)#46448, avg(cast(ws_quantity#234 as bigint)) AS aggOrder#46450]
            +- Filter (((((ws_web_page_sk#228 = wp_web_page_sk#770) && (ws_item_sk#219 = wr_item_sk#286)) && (ws_order_number#233L = wr_order_number#297L)) && (((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 2000)) && (cd_demo_sk#474 = wr_refunded_cdemo_sk#288))) && ((((cd_demo_sk#46433 = wr_returning_cdemo_sk#292) && (ca_address_sk#448 = wr_refunded_addr_sk#290)) && (r_reason_sk#646 = wr_reason_sk#296)) && (((((((cd_marital_status#476 = M) && (cd_marital_status#476 = cd_marital_status#46435)) && (cd_education_status#477 = Advanced Degree)) && ((cd_education_status#477 = cd_education_status#46436) && ((cast(ws_sales_price#237 as decimal(7,2)) >= cast(100.00 as decimal(7,2))) && (cast(ws_sales_price#237 as decimal(7,2)) <= cast(150.00 as decimal(7,2)))))) || ((((cd_marital_status#476 = S) && (cd_marital_status#476 = cd_marital_status#46435)) && (cd_education_status#477 = College)) && ((cd_education_status#477 = cd_education_status#46436) && ((cast(ws_sales_price#237 as decimal(7,2)) >= cast(50.00 as decimal(7,2))) && (cast(ws_sales_price#237 as decimal(7,2)) <= cast(100.00 as decimal(7,2))))))) || ((((cd_marital_status#476 = W) && (cd_marital_status#476 = cd_marital_status#46435)) && (cd_education_status#477 = 2 yr Degree)) && ((cd_education_status#477 = cd_education_status#46436) && ((cast(ws_sales_price#237 as decimal(7,2)) >= cast(150.00 as decimal(7,2))) && (cast(ws_sales_price#237 as decimal(7,2)) <= cast(200.00 as decimal(7,2))))))) && (((((ca_country#458 = United States) && ca_state#456 IN (IN,OH,NJ)) && ((cast(ws_net_profit#249 as decimal(7,2)) >= cast(cast(100 as decimal(3,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) <= cast(cast(200 as decimal(3,0)) as decimal(7,2))))) || (((ca_country#458 = United States) && ca_state#456 IN (WI,CT,KY)) && ((cast(ws_net_profit#249 as decimal(7,2)) >= cast(cast(150 as decimal(3,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) <= cast(cast(300 as decimal(3,0)) as decimal(7,2)))))) || (((ca_country#458 = United States) && ca_state#456 IN (LA,IA,AR)) && ((cast(ws_net_profit#249 as decimal(7,2)) >= cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) <= cast(cast(250 as decimal(3,0)) as decimal(7,2)))))))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias `web_sales`
                  :  :  :  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  :  :  :  :  +- SubqueryAlias `web_returns`
                  :  :  :  :  :  :     +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                  :  :  :  :  :  +- SubqueryAlias `web_page`
                  :  :  :  :  :     +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet
                  :  :  :  :  +- SubqueryAlias `cd1`
                  :  :  :  :     +- SubqueryAlias `customer_demographics`
                  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  :  +- SubqueryAlias `cd2`
                  :  :  :     +- SubqueryAlias `customer_demographics`
                  :  :  :        +- Relation[cd_demo_sk#46433,cd_gender#46434,cd_marital_status#46435,cd_education_status#46436,cd_purchase_estimate#46437,cd_credit_rating#46438,cd_dep_count#46439,cd_dep_employed_count#46440,cd_dep_college_count#46441] parquet
                  :  :  +- SubqueryAlias `customer_address`
                  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  :  +- SubqueryAlias `date_dim`
                  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `reason`
                     +- Relation[r_reason_sk#646,r_reason_id#647,r_reason_desc#648] parquet

     : benchmark
19/09/08 18:33:46 INFO Query: 
== Query: q85-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [substring(r_reason_desc, 1, 20)#46472, avg(ws_quantity)#46473, avg(wr_refunded_cash)#46474, avg(wr_fee)#46475]
      +- Sort [substring(r_reason_desc, 1, 20)#46472 ASC NULLS FIRST, aggOrder#46477 ASC NULLS FIRST, avg(wr_refunded_cash)#46474 ASC NULLS FIRST, avg(wr_fee)#46475 ASC NULLS FIRST], true
         +- Aggregate [r_reason_desc#648], [substring(r_reason_desc#648, 1, 20) AS substring(r_reason_desc, 1, 20)#46472, avg(cast(ws_quantity#234 as bigint)) AS avg(ws_quantity)#46473, avg(wr_refunded_cash#304) AS avg(wr_refunded_cash)#46474, avg(wr_fee#302) AS avg(wr_fee)#46475, avg(cast(ws_quantity#234 as bigint)) AS aggOrder#46477]
            +- Filter (((((ws_web_page_sk#228 = wp_web_page_sk#770) && (ws_item_sk#219 = wr_item_sk#286)) && (ws_order_number#233L = wr_order_number#297L)) && (((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 2000)) && (cd_demo_sk#474 = wr_refunded_cdemo_sk#288))) && ((((cd_demo_sk#46460 = wr_returning_cdemo_sk#292) && (ca_address_sk#448 = wr_refunded_addr_sk#290)) && (r_reason_sk#646 = wr_reason_sk#296)) && (((((((cd_marital_status#476 = M) && (cd_marital_status#476 = cd_marital_status#46462)) && (cd_education_status#477 = Advanced Degree)) && ((cd_education_status#477 = cd_education_status#46463) && ((cast(ws_sales_price#237 as decimal(7,2)) >= cast(100.00 as decimal(7,2))) && (cast(ws_sales_price#237 as decimal(7,2)) <= cast(150.00 as decimal(7,2)))))) || ((((cd_marital_status#476 = S) && (cd_marital_status#476 = cd_marital_status#46462)) && (cd_education_status#477 = College)) && ((cd_education_status#477 = cd_education_status#46463) && ((cast(ws_sales_price#237 as decimal(7,2)) >= cast(50.00 as decimal(7,2))) && (cast(ws_sales_price#237 as decimal(7,2)) <= cast(100.00 as decimal(7,2))))))) || ((((cd_marital_status#476 = W) && (cd_marital_status#476 = cd_marital_status#46462)) && (cd_education_status#477 = 2 yr Degree)) && ((cd_education_status#477 = cd_education_status#46463) && ((cast(ws_sales_price#237 as decimal(7,2)) >= cast(150.00 as decimal(7,2))) && (cast(ws_sales_price#237 as decimal(7,2)) <= cast(200.00 as decimal(7,2))))))) && (((((ca_country#458 = United States) && ca_state#456 IN (IN,OH,NJ)) && ((cast(ws_net_profit#249 as decimal(7,2)) >= cast(cast(100 as decimal(3,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) <= cast(cast(200 as decimal(3,0)) as decimal(7,2))))) || (((ca_country#458 = United States) && ca_state#456 IN (WI,CT,KY)) && ((cast(ws_net_profit#249 as decimal(7,2)) >= cast(cast(150 as decimal(3,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) <= cast(cast(300 as decimal(3,0)) as decimal(7,2)))))) || (((ca_country#458 = United States) && ca_state#456 IN (LA,IA,AR)) && ((cast(ws_net_profit#249 as decimal(7,2)) >= cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) <= cast(cast(250 as decimal(3,0)) as decimal(7,2)))))))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias `web_sales`
                  :  :  :  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  :  :  :  :  +- SubqueryAlias `web_returns`
                  :  :  :  :  :  :     +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                  :  :  :  :  :  +- SubqueryAlias `web_page`
                  :  :  :  :  :     +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet
                  :  :  :  :  +- SubqueryAlias `cd1`
                  :  :  :  :     +- SubqueryAlias `customer_demographics`
                  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  :  +- SubqueryAlias `cd2`
                  :  :  :     +- SubqueryAlias `customer_demographics`
                  :  :  :        +- Relation[cd_demo_sk#46460,cd_gender#46461,cd_marital_status#46462,cd_education_status#46463,cd_purchase_estimate#46464,cd_credit_rating#46465,cd_dep_count#46466,cd_dep_employed_count#46467,cd_dep_college_count#46468] parquet
                  :  :  +- SubqueryAlias `customer_address`
                  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  :  +- SubqueryAlias `date_dim`
                  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `reason`
                     +- Relation[r_reason_sk#646,r_reason_id#647,r_reason_desc#648] parquet

      running Thread[benchmark runner,5,main]
Execution time: 9.551407744s
Running execution q86-v2.4 iteration: 1, StandardRun=true
19/09/08 18:33:57 INFO Query: 
== Query: q86-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#46598 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#46598 as int) = 0) THEN i_category#46607 END ASC NULLS FIRST, rank_within_parent#46599 ASC NULLS FIRST], true
      +- Project [total_sum#46597, i_category#46607, i_class#46608, lochierarchy#46598, rank_within_parent#46599]
         +- Project [total_sum#46597, i_category#46607, i_class#46608, lochierarchy#46598, _w0#46617, _w1#46621, _w2#46622, _w3#46623, rank_within_parent#46599, rank_within_parent#46599]
            +- Window [rank(_w3#46623) windowspecdefinition(_w1#46621, _w2#46622, _w3#46623 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#46599], [_w1#46621, _w2#46622], [_w3#46623 DESC NULLS LAST]
               +- Aggregate [i_category#46607, i_class#46608, spark_grouping_id#46604], [sum(ws_net_paid#245) AS total_sum#46597, i_category#46607, i_class#46608, (cast((shiftright(spark_grouping_id#46604, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#46604, 0) & 1) as tinyint)) AS lochierarchy#46598, sum(ws_net_paid#245) AS _w0#46617, (cast((shiftright(spark_grouping_id#46604, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#46604, 0) & 1) as tinyint)) AS _w1#46621, CASE WHEN (cast(cast((shiftright(spark_grouping_id#46604, 0) & 1) as tinyint) as int) = 0) THEN i_category#46607 END AS _w2#46622, sum(ws_net_paid#245) AS _w3#46623]
                  +- Expand [List(ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ws_ext_wholesale_cost#240, ws_ext_list_price#241, ws_ext_tax#242, ws_coupon_amt#243, ws_ext_ship_cost#244, ws_net_paid#245, ws_net_paid_inc_tax#246, ws_net_paid_inc_ship#247, ws_net_paid_inc_ship_tax#248, ws_net_profit#249, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#46605, i_class#46606, 0), List(ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ws_ext_wholesale_cost#240, ws_ext_list_price#241, ws_ext_tax#242, ws_coupon_amt#243, ws_ext_ship_cost#244, ws_net_paid#245, ws_net_paid_inc_tax#246, ws_net_paid_inc_ship#247, ws_net_paid_inc_ship_tax#248, ws_net_profit#249, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#46605, null, 1), List(ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ws_ext_wholesale_cost#240, ws_ext_list_price#241, ws_ext_tax#242, ws_coupon_amt#243, ws_ext_ship_cost#244, ws_net_paid#245, ws_net_paid_inc_tax#246, ws_net_paid_inc_ship#247, ws_net_paid_inc_ship_tax#248, ws_net_profit#249, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, 3)], [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 63 more fields]
                     +- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 62 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ws_sold_date_sk#216)) && (i_item_sk#564 = ws_item_sk#219))
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `web_sales`
                              :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:33:58 INFO Query: 
== Query: q86-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#46639 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#46639 as int) = 0) THEN i_category#46648 END ASC NULLS FIRST, rank_within_parent#46640 ASC NULLS FIRST], true
      +- Project [total_sum#46638, i_category#46648, i_class#46649, lochierarchy#46639, rank_within_parent#46640]
         +- Project [total_sum#46638, i_category#46648, i_class#46649, lochierarchy#46639, _w0#46658, _w1#46662, _w2#46663, _w3#46664, rank_within_parent#46640, rank_within_parent#46640]
            +- Window [rank(_w3#46664) windowspecdefinition(_w1#46662, _w2#46663, _w3#46664 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#46640], [_w1#46662, _w2#46663], [_w3#46664 DESC NULLS LAST]
               +- Aggregate [i_category#46648, i_class#46649, spark_grouping_id#46645], [sum(ws_net_paid#245) AS total_sum#46638, i_category#46648, i_class#46649, (cast((shiftright(spark_grouping_id#46645, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#46645, 0) & 1) as tinyint)) AS lochierarchy#46639, sum(ws_net_paid#245) AS _w0#46658, (cast((shiftright(spark_grouping_id#46645, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#46645, 0) & 1) as tinyint)) AS _w1#46662, CASE WHEN (cast(cast((shiftright(spark_grouping_id#46645, 0) & 1) as tinyint) as int) = 0) THEN i_category#46648 END AS _w2#46663, sum(ws_net_paid#245) AS _w3#46664]
                  +- Expand [List(ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ws_ext_wholesale_cost#240, ws_ext_list_price#241, ws_ext_tax#242, ws_coupon_amt#243, ws_ext_ship_cost#244, ws_net_paid#245, ws_net_paid_inc_tax#246, ws_net_paid_inc_ship#247, ws_net_paid_inc_ship_tax#248, ws_net_profit#249, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#46646, i_class#46647, 0), List(ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ws_ext_wholesale_cost#240, ws_ext_list_price#241, ws_ext_tax#242, ws_coupon_amt#243, ws_ext_ship_cost#244, ws_net_paid#245, ws_net_paid_inc_tax#246, ws_net_paid_inc_ship#247, ws_net_paid_inc_ship_tax#248, ws_net_profit#249, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#46646, null, 1), List(ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ws_ext_wholesale_cost#240, ws_ext_list_price#241, ws_ext_tax#242, ws_coupon_amt#243, ws_ext_ship_cost#244, ws_net_paid#245, ws_net_paid_inc_tax#246, ws_net_paid_inc_ship#247, ws_net_paid_inc_ship_tax#248, ws_net_profit#249, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, 3)], [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 63 more fields]
                     +- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 62 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ws_sold_date_sk#216)) && (i_item_sk#564 = ws_item_sk#219))
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `web_sales`
                              :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 2.523786913s
Running execution q87-v2.4 iteration: 1, StandardRun=true
19/09/08 18:34:01 INFO Query: 
== Query: q87-v2.4 ==
Aggregate [count(1) AS count(1)#47026L]
+- SubqueryAlias `cool_cust`
   +- Except false
      :- Project [c_last_name#421, c_first_name#420, d_date#494]
      :  +- Except false
      :     :- Project [c_last_name#421, c_first_name#420, d_date#494]
      :     :  +- Distinct
      :     :     +- Project [c_last_name#421, c_first_name#420, d_date#494]
      :     :        +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_customer_sk#133 = c_customer_sk#412)) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
      :     :           +- Join Inner
      :     :              :- Join Inner
      :     :              :  :- SubqueryAlias `store_sales`
      :     :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
      :     :              :  +- SubqueryAlias `date_dim`
      :     :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
      :     :              +- SubqueryAlias `customer`
      :     :                 +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
      :     +- Project [c_last_name#46953, c_first_name#46952, d_date#46899]
      :        +- Distinct
      :           +- Project [c_last_name#46953, c_first_name#46952, d_date#46899]
      :              +- Filter (((cs_sold_date_sk#0 = d_date_sk#46897) && (cs_bill_customer_sk#3 = c_customer_sk#46944)) && ((d_month_seq#46900 >= 1200) && (d_month_seq#46900 <= (1200 + 11))))
      :                 +- Join Inner
      :                    :- Join Inner
      :                    :  :- SubqueryAlias `catalog_sales`
      :                    :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
      :                    :  +- SubqueryAlias `date_dim`
      :                    :     +- Relation[d_date_sk#46897,d_date_id#46898,d_date#46899,d_month_seq#46900,d_week_seq#46901,d_quarter_seq#46902,d_year#46903,d_dow#46904,d_moy#46905,d_dom#46906,d_qoy#46907,d_fy_year#46908,d_fy_quarter_seq#46909,d_fy_week_seq#46910,d_day_name#46911,d_quarter_name#46912,d_holiday#46913,d_weekend#46914,d_following_holiday#46915,d_first_dom#46916,d_last_dom#46917,d_same_day_ly#46918,d_same_day_lq#46919,d_current_day#46920,... 4 more fields] parquet
      :                    +- SubqueryAlias `customer`
      :                       +- Relation[c_customer_sk#46944,c_customer_id#46945,c_current_cdemo_sk#46946,c_current_hdemo_sk#46947,c_current_addr_sk#46948,c_first_shipto_date_sk#46949,c_first_sales_date_sk#46950,c_salutation#46951,c_first_name#46952,c_last_name#46953,c_preferred_cust_flag#46954,c_birth_day#46955,c_birth_month#46956,c_birth_year#46957,c_birth_country#46958,c_login#46959,c_email_address#46960,c_last_review_date#46961] parquet
      +- Project [c_last_name#47017, c_first_name#47016, d_date#46964]
         +- Distinct
            +- Project [c_last_name#47017, c_first_name#47016, d_date#46964]
               +- Filter (((ws_sold_date_sk#216 = d_date_sk#46962) && (ws_bill_customer_sk#220 = c_customer_sk#47008)) && ((d_month_seq#46965 >= 1200) && (d_month_seq#46965 <= (1200 + 11))))
                  +- Join Inner
                     :- Join Inner
                     :  :- SubqueryAlias `web_sales`
                     :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :  +- SubqueryAlias `date_dim`
                     :     +- Relation[d_date_sk#46962,d_date_id#46963,d_date#46964,d_month_seq#46965,d_week_seq#46966,d_quarter_seq#46967,d_year#46968,d_dow#46969,d_moy#46970,d_dom#46971,d_qoy#46972,d_fy_year#46973,d_fy_quarter_seq#46974,d_fy_week_seq#46975,d_day_name#46976,d_quarter_name#46977,d_holiday#46978,d_weekend#46979,d_following_holiday#46980,d_first_dom#46981,d_last_dom#46982,d_same_day_ly#46983,d_same_day_lq#46984,d_current_day#46985,... 4 more fields] parquet
                     +- SubqueryAlias `customer`
                        +- Relation[c_customer_sk#47008,c_customer_id#47009,c_current_cdemo_sk#47010,c_current_hdemo_sk#47011,c_current_addr_sk#47012,c_first_shipto_date_sk#47013,c_first_sales_date_sk#47014,c_salutation#47015,c_first_name#47016,c_last_name#47017,c_preferred_cust_flag#47018,c_birth_day#47019,c_birth_month#47020,c_birth_year#47021,c_birth_country#47022,c_login#47023,c_email_address#47024,c_last_review_date#47025] parquet

     : benchmark
19/09/08 18:34:01 INFO Query: 
== Query: q87-v2.4 ==
Aggregate [count(1) AS count(1)#47157L]
+- SubqueryAlias `cool_cust`
   +- Except false
      :- Project [c_last_name#421, c_first_name#420, d_date#494]
      :  +- Except false
      :     :- Project [c_last_name#421, c_first_name#420, d_date#494]
      :     :  +- Distinct
      :     :     +- Project [c_last_name#421, c_first_name#420, d_date#494]
      :     :        +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_customer_sk#133 = c_customer_sk#412)) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
      :     :           +- Join Inner
      :     :              :- Join Inner
      :     :              :  :- SubqueryAlias `store_sales`
      :     :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
      :     :              :  +- SubqueryAlias `date_dim`
      :     :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
      :     :              +- SubqueryAlias `customer`
      :     :                 +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
      :     +- Project [c_last_name#47084, c_first_name#47083, d_date#47030]
      :        +- Distinct
      :           +- Project [c_last_name#47084, c_first_name#47083, d_date#47030]
      :              +- Filter (((cs_sold_date_sk#0 = d_date_sk#47028) && (cs_bill_customer_sk#3 = c_customer_sk#47075)) && ((d_month_seq#47031 >= 1200) && (d_month_seq#47031 <= (1200 + 11))))
      :                 +- Join Inner
      :                    :- Join Inner
      :                    :  :- SubqueryAlias `catalog_sales`
      :                    :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
      :                    :  +- SubqueryAlias `date_dim`
      :                    :     +- Relation[d_date_sk#47028,d_date_id#47029,d_date#47030,d_month_seq#47031,d_week_seq#47032,d_quarter_seq#47033,d_year#47034,d_dow#47035,d_moy#47036,d_dom#47037,d_qoy#47038,d_fy_year#47039,d_fy_quarter_seq#47040,d_fy_week_seq#47041,d_day_name#47042,d_quarter_name#47043,d_holiday#47044,d_weekend#47045,d_following_holiday#47046,d_first_dom#47047,d_last_dom#47048,d_same_day_ly#47049,d_same_day_lq#47050,d_current_day#47051,... 4 more fields] parquet
      :                    +- SubqueryAlias `customer`
      :                       +- Relation[c_customer_sk#47075,c_customer_id#47076,c_current_cdemo_sk#47077,c_current_hdemo_sk#47078,c_current_addr_sk#47079,c_first_shipto_date_sk#47080,c_first_sales_date_sk#47081,c_salutation#47082,c_first_name#47083,c_last_name#47084,c_preferred_cust_flag#47085,c_birth_day#47086,c_birth_month#47087,c_birth_year#47088,c_birth_country#47089,c_login#47090,c_email_address#47091,c_last_review_date#47092] parquet
      +- Project [c_last_name#47148, c_first_name#47147, d_date#47095]
         +- Distinct
            +- Project [c_last_name#47148, c_first_name#47147, d_date#47095]
               +- Filter (((ws_sold_date_sk#216 = d_date_sk#47093) && (ws_bill_customer_sk#220 = c_customer_sk#47139)) && ((d_month_seq#47096 >= 1200) && (d_month_seq#47096 <= (1200 + 11))))
                  +- Join Inner
                     :- Join Inner
                     :  :- SubqueryAlias `web_sales`
                     :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :  +- SubqueryAlias `date_dim`
                     :     +- Relation[d_date_sk#47093,d_date_id#47094,d_date#47095,d_month_seq#47096,d_week_seq#47097,d_quarter_seq#47098,d_year#47099,d_dow#47100,d_moy#47101,d_dom#47102,d_qoy#47103,d_fy_year#47104,d_fy_quarter_seq#47105,d_fy_week_seq#47106,d_day_name#47107,d_quarter_name#47108,d_holiday#47109,d_weekend#47110,d_following_holiday#47111,d_first_dom#47112,d_last_dom#47113,d_same_day_ly#47114,d_same_day_lq#47115,d_current_day#47116,... 4 more fields] parquet
                     +- SubqueryAlias `customer`
                        +- Relation[c_customer_sk#47139,c_customer_id#47140,c_current_cdemo_sk#47141,c_current_hdemo_sk#47142,c_current_addr_sk#47143,c_first_shipto_date_sk#47144,c_first_sales_date_sk#47145,c_salutation#47146,c_first_name#47147,c_last_name#47148,c_preferred_cust_flag#47149,c_birth_day#47150,c_birth_month#47151,c_birth_year#47152,c_birth_country#47153,c_login#47154,c_email_address#47155,c_last_review_date#47156] parquet

      running Thread[benchmark runner,5,main]
Execution time: 11.124641964s
Running execution q88-v2.4 iteration: 1, StandardRun=true
19/09/08 18:34:15 INFO Query: 
== Query: q88-v2.4 ==
Project [h8_30_to_9#47464L, h9_to_9_30#47465L, h9_30_to_10#47466L, h10_to_10_30#47467L, h10_30_to_11#47468L, h11_to_11_30#47469L, h11_30_to_12#47470L, h12_to_12_30#47471L]
+- Join Cross
   :- Join Cross
   :  :- Join Cross
   :  :  :- Join Cross
   :  :  :  :- Join Cross
   :  :  :  :  :- Join Cross
   :  :  :  :  :  :- Join Cross
   :  :  :  :  :  :  :- SubqueryAlias `s1`
   :  :  :  :  :  :  :  +- Aggregate [count(1) AS h8_30_to_9#47464L]
   :  :  :  :  :  :  :     +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 8))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :  :  :  :        +- Join Inner
   :  :  :  :  :  :  :           :- Join Inner
   :  :  :  :  :  :  :           :  :- Join Inner
   :  :  :  :  :  :  :           :  :  :- SubqueryAlias `store_sales`
   :  :  :  :  :  :  :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :  :  :  :           :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :  :  :  :           :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :  :  :  :           :  +- SubqueryAlias `time_dim`
   :  :  :  :  :  :  :           :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :  :  :  :           +- SubqueryAlias `store`
   :  :  :  :  :  :  :              +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  :  :  :  +- SubqueryAlias `s2`
   :  :  :  :  :  :     +- Aggregate [count(1) AS h9_to_9_30#47465L]
   :  :  :  :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 9))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :  :  :           +- Join Inner
   :  :  :  :  :  :              :- Join Inner
   :  :  :  :  :  :              :  :- Join Inner
   :  :  :  :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :  :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :  :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :  :  :              +- SubqueryAlias `store`
   :  :  :  :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  :  :  +- SubqueryAlias `s3`
   :  :  :  :  :     +- Aggregate [count(1) AS h9_30_to_10#47466L]
   :  :  :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 9))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :  :           +- Join Inner
   :  :  :  :  :              :- Join Inner
   :  :  :  :  :              :  :- Join Inner
   :  :  :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :  :              +- SubqueryAlias `store`
   :  :  :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  :  +- SubqueryAlias `s4`
   :  :  :  :     +- Aggregate [count(1) AS h10_to_10_30#47467L]
   :  :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 10))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :           +- Join Inner
   :  :  :  :              :- Join Inner
   :  :  :  :              :  :- Join Inner
   :  :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :              +- SubqueryAlias `store`
   :  :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  +- SubqueryAlias `s5`
   :  :  :     +- Aggregate [count(1) AS h10_30_to_11#47468L]
   :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 10))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :           +- Join Inner
   :  :  :              :- Join Inner
   :  :  :              :  :- Join Inner
   :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :              +- SubqueryAlias `store`
   :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  +- SubqueryAlias `s6`
   :  :     +- Aggregate [count(1) AS h11_to_11_30#47469L]
   :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 11))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :           +- Join Inner
   :  :              :- Join Inner
   :  :              :  :- Join Inner
   :  :              :  :  :- SubqueryAlias `store_sales`
   :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :              :  +- SubqueryAlias `time_dim`
   :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :              +- SubqueryAlias `store`
   :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  +- SubqueryAlias `s7`
   :     +- Aggregate [count(1) AS h11_30_to_12#47470L]
   :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 11))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :           +- Join Inner
   :              :- Join Inner
   :              :  :- Join Inner
   :              :  :  :- SubqueryAlias `store_sales`
   :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :              :  :  +- SubqueryAlias `household_demographics`
   :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :              :  +- SubqueryAlias `time_dim`
   :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :              +- SubqueryAlias `store`
   :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   +- SubqueryAlias `s8`
      +- Aggregate [count(1) AS h12_to_12_30#47471L]
         +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 12))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `store_sales`
               :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  +- SubqueryAlias `household_demographics`
               :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  +- SubqueryAlias `time_dim`
               :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
               +- SubqueryAlias `store`
                  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/09/08 18:34:15 INFO Query: 
== Query: q88-v2.4 ==
Project [h8_30_to_9#47488L, h9_to_9_30#47489L, h9_30_to_10#47490L, h10_to_10_30#47491L, h10_30_to_11#47492L, h11_to_11_30#47493L, h11_30_to_12#47494L, h12_to_12_30#47495L]
+- Join Cross
   :- Join Cross
   :  :- Join Cross
   :  :  :- Join Cross
   :  :  :  :- Join Cross
   :  :  :  :  :- Join Cross
   :  :  :  :  :  :- Join Cross
   :  :  :  :  :  :  :- SubqueryAlias `s1`
   :  :  :  :  :  :  :  +- Aggregate [count(1) AS h8_30_to_9#47488L]
   :  :  :  :  :  :  :     +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 8))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :  :  :  :        +- Join Inner
   :  :  :  :  :  :  :           :- Join Inner
   :  :  :  :  :  :  :           :  :- Join Inner
   :  :  :  :  :  :  :           :  :  :- SubqueryAlias `store_sales`
   :  :  :  :  :  :  :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :  :  :  :           :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :  :  :  :           :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :  :  :  :           :  +- SubqueryAlias `time_dim`
   :  :  :  :  :  :  :           :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :  :  :  :           +- SubqueryAlias `store`
   :  :  :  :  :  :  :              +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  :  :  :  +- SubqueryAlias `s2`
   :  :  :  :  :  :     +- Aggregate [count(1) AS h9_to_9_30#47489L]
   :  :  :  :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 9))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :  :  :           +- Join Inner
   :  :  :  :  :  :              :- Join Inner
   :  :  :  :  :  :              :  :- Join Inner
   :  :  :  :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :  :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :  :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :  :  :              +- SubqueryAlias `store`
   :  :  :  :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  :  :  +- SubqueryAlias `s3`
   :  :  :  :  :     +- Aggregate [count(1) AS h9_30_to_10#47490L]
   :  :  :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 9))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :  :           +- Join Inner
   :  :  :  :  :              :- Join Inner
   :  :  :  :  :              :  :- Join Inner
   :  :  :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :  :              +- SubqueryAlias `store`
   :  :  :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  :  +- SubqueryAlias `s4`
   :  :  :  :     +- Aggregate [count(1) AS h10_to_10_30#47491L]
   :  :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 10))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :           +- Join Inner
   :  :  :  :              :- Join Inner
   :  :  :  :              :  :- Join Inner
   :  :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :              +- SubqueryAlias `store`
   :  :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  +- SubqueryAlias `s5`
   :  :  :     +- Aggregate [count(1) AS h10_30_to_11#47492L]
   :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 10))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :           +- Join Inner
   :  :  :              :- Join Inner
   :  :  :              :  :- Join Inner
   :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :              +- SubqueryAlias `store`
   :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  +- SubqueryAlias `s6`
   :  :     +- Aggregate [count(1) AS h11_to_11_30#47493L]
   :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 11))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :           +- Join Inner
   :  :              :- Join Inner
   :  :              :  :- Join Inner
   :  :              :  :  :- SubqueryAlias `store_sales`
   :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :              :  +- SubqueryAlias `time_dim`
   :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :              +- SubqueryAlias `store`
   :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  +- SubqueryAlias `s7`
   :     +- Aggregate [count(1) AS h11_30_to_12#47494L]
   :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 11))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :           +- Join Inner
   :              :- Join Inner
   :              :  :- Join Inner
   :              :  :  :- SubqueryAlias `store_sales`
   :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :              :  :  +- SubqueryAlias `household_demographics`
   :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :              :  +- SubqueryAlias `time_dim`
   :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :              +- SubqueryAlias `store`
   :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   +- SubqueryAlias `s8`
      +- Aggregate [count(1) AS h12_to_12_30#47495L]
         +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 12))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `store_sales`
               :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  +- SubqueryAlias `household_demographics`
               :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  +- SubqueryAlias `time_dim`
               :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
               +- SubqueryAlias `store`
                  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 6.870936458s
Running execution q89-v2.4 iteration: 1, StandardRun=true
19/09/08 18:34:25 INFO Query: 
== Query: q89-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#47593 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#47594 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
      +- Project [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum_sales#47593, avg_monthly_sales#47594]
         +- Filter (cast(CASE WHEN NOT (cast(avg_monthly_sales#47594 as decimal(21,6)) = cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#47593 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#47594 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#47594 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16)))
            +- SubqueryAlias `tmp1`
               +- Project [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum_sales#47593, avg_monthly_sales#47594]
                  +- Project [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum_sales#47593, _w0#47598, avg_monthly_sales#47594, avg_monthly_sales#47594]
                     +- Window [avg(_w0#47598) windowspecdefinition(i_category#576, i_brand#572, s_store_name#669, s_company_name#681, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#47594], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681]
                        +- Aggregate [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500], [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum(ss_sales_price#143) AS sum_sales#47593, sum(ss_sales_price#143) AS _w0#47598]
                           +- Filter ((((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_store_sk#137 = s_store_sk#664)) && (d_year#498 IN (1999) && ((i_category#576 IN (Books,Electronics,Sports) && i_class#574 IN (computers,stereo,football)) || (i_category#576 IN (Men,Jewelry,Women) && i_class#574 IN (shirts,birdal,dresses)))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `item`
                                 :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :  :  +- SubqueryAlias `store_sales`
                                 :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `date_dim`
                                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- SubqueryAlias `store`
                                    +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/09/08 18:34:25 INFO Query: 
== Query: q89-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#47607 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#47608 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
      +- Project [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum_sales#47607, avg_monthly_sales#47608]
         +- Filter (cast(CASE WHEN NOT (cast(avg_monthly_sales#47608 as decimal(21,6)) = cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#47607 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#47608 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#47608 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16)))
            +- SubqueryAlias `tmp1`
               +- Project [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum_sales#47607, avg_monthly_sales#47608]
                  +- Project [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum_sales#47607, _w0#47612, avg_monthly_sales#47608, avg_monthly_sales#47608]
                     +- Window [avg(_w0#47612) windowspecdefinition(i_category#576, i_brand#572, s_store_name#669, s_company_name#681, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#47608], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681]
                        +- Aggregate [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500], [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum(ss_sales_price#143) AS sum_sales#47607, sum(ss_sales_price#143) AS _w0#47612]
                           +- Filter ((((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_store_sk#137 = s_store_sk#664)) && (d_year#498 IN (1999) && ((i_category#576 IN (Books,Electronics,Sports) && i_class#574 IN (computers,stereo,football)) || (i_category#576 IN (Men,Jewelry,Women) && i_class#574 IN (shirts,birdal,dresses)))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `item`
                                 :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :  :  +- SubqueryAlias `store_sales`
                                 :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `date_dim`
                                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- SubqueryAlias `store`
                                    +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 3.2277917670000003s
Running execution q90-v2.4 iteration: 1, StandardRun=true
19/09/08 18:34:30 INFO Query: 
== Query: q90-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [am_pm_ratio#47664 ASC NULLS FIRST], true
      +- Project [CheckOverflow((promote_precision(cast(cast(amc#47662L as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(pmc#47663L as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS am_pm_ratio#47664]
         +- Join Cross
            :- SubqueryAlias `at`
            :  +- Aggregate [count(1) AS amc#47662L]
            :     +- Filter ((((ws_sold_time_sk#217 = t_time_sk#722) && (ws_ship_hdemo_sk#226 = hd_demo_sk#548)) && (ws_web_page_sk#228 = wp_web_page_sk#770)) && ((((t_hour#725 >= 8) && (t_hour#725 <= (8 + 1))) && (hd_dep_count#551 = 6)) && ((wp_char_count#780 >= 5000) && (wp_char_count#780 <= 5200))))
            :        +- Join Inner
            :           :- Join Inner
            :           :  :- Join Inner
            :           :  :  :- SubqueryAlias `web_sales`
            :           :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :           :  :  +- SubqueryAlias `household_demographics`
            :           :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
            :           :  +- SubqueryAlias `time_dim`
            :           :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
            :           +- SubqueryAlias `web_page`
            :              +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet
            +- SubqueryAlias `pt`
               +- Aggregate [count(1) AS pmc#47663L]
                  +- Filter ((((ws_sold_time_sk#217 = t_time_sk#722) && (ws_ship_hdemo_sk#226 = hd_demo_sk#548)) && (ws_web_page_sk#228 = wp_web_page_sk#770)) && ((((t_hour#725 >= 19) && (t_hour#725 <= (19 + 1))) && (hd_dep_count#551 = 6)) && ((wp_char_count#780 >= 5000) && (wp_char_count#780 <= 5200))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- SubqueryAlias `web_sales`
                        :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  :  +- SubqueryAlias `household_demographics`
                        :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  +- SubqueryAlias `time_dim`
                        :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                        +- SubqueryAlias `web_page`
                           +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet

     : benchmark
19/09/08 18:34:30 INFO Query: 
== Query: q90-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [am_pm_ratio#47670 ASC NULLS FIRST], true
      +- Project [CheckOverflow((promote_precision(cast(cast(amc#47668L as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(pmc#47669L as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS am_pm_ratio#47670]
         +- Join Cross
            :- SubqueryAlias `at`
            :  +- Aggregate [count(1) AS amc#47668L]
            :     +- Filter ((((ws_sold_time_sk#217 = t_time_sk#722) && (ws_ship_hdemo_sk#226 = hd_demo_sk#548)) && (ws_web_page_sk#228 = wp_web_page_sk#770)) && ((((t_hour#725 >= 8) && (t_hour#725 <= (8 + 1))) && (hd_dep_count#551 = 6)) && ((wp_char_count#780 >= 5000) && (wp_char_count#780 <= 5200))))
            :        +- Join Inner
            :           :- Join Inner
            :           :  :- Join Inner
            :           :  :  :- SubqueryAlias `web_sales`
            :           :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :           :  :  +- SubqueryAlias `household_demographics`
            :           :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
            :           :  +- SubqueryAlias `time_dim`
            :           :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
            :           +- SubqueryAlias `web_page`
            :              +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet
            +- SubqueryAlias `pt`
               +- Aggregate [count(1) AS pmc#47669L]
                  +- Filter ((((ws_sold_time_sk#217 = t_time_sk#722) && (ws_ship_hdemo_sk#226 = hd_demo_sk#548)) && (ws_web_page_sk#228 = wp_web_page_sk#770)) && ((((t_hour#725 >= 19) && (t_hour#725 <= (19 + 1))) && (hd_dep_count#551 = 6)) && ((wp_char_count#780 >= 5000) && (wp_char_count#780 <= 5200))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- SubqueryAlias `web_sales`
                        :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  :  +- SubqueryAlias `household_demographics`
                        :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  +- SubqueryAlias `time_dim`
                        :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                        +- SubqueryAlias `web_page`
                           +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet

      running Thread[benchmark runner,5,main]
Execution time: 2.2527292510000003s
Running execution q91-v2.4 iteration: 1, StandardRun=true
19/09/08 18:34:33 INFO Query: 
== Query: q91-v2.4 ==
Project [Call_Center#47704, Call_Center_Name#47705, Manager#47706, Returns_Loss#47707]
+- Sort [Returns_Loss#47707 DESC NULLS LAST], true
   +- Aggregate [cc_call_center_id#333, cc_name#338, cc_manager#343, cd_marital_status#476, cd_education_status#477], [cc_call_center_id#333 AS Call_Center#47704, cc_name#338 AS Call_Center_Name#47705, cc_manager#343 AS Manager#47706, sum(cr_net_loss#94) AS Returns_Loss#47707]
      +- Filter (((((cr_call_center_sk#79 = cc_call_center_sk#332) && (cr_returned_date_sk#68 = d_date_sk#492)) && (cr_returning_customer_sk#75 = c_customer_sk#412)) && (((cd_demo_sk#474 = c_current_cdemo_sk#414) && (hd_demo_sk#548 = c_current_hdemo_sk#415)) && (ca_address_sk#448 = c_current_addr_sk#416))) && ((((d_year#498 = 1998) && (d_moy#500 = 11)) && (((cd_marital_status#476 = M) && (cd_education_status#477 = Unknown)) || ((cd_marital_status#476 = W) && (cd_education_status#477 = Advanced Degree)))) && (hd_buy_potential#550 LIKE Unknown% && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-7 as decimal(1,0)) as decimal(5,2))))))
         +- Join Inner
            :- Join Inner
            :  :- Join Inner
            :  :  :- Join Inner
            :  :  :  :- Join Inner
            :  :  :  :  :- Join Inner
            :  :  :  :  :  :- SubqueryAlias `call_center`
            :  :  :  :  :  :  +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet
            :  :  :  :  :  +- SubqueryAlias `catalog_returns`
            :  :  :  :  :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
            :  :  :  :  +- SubqueryAlias `date_dim`
            :  :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  :  :  +- SubqueryAlias `customer`
            :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :  :  +- SubqueryAlias `customer_address`
            :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            :  +- SubqueryAlias `customer_demographics`
            :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
            +- SubqueryAlias `household_demographics`
               +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet

     : benchmark
19/09/08 18:34:33 INFO Query: 
== Query: q91-v2.4 ==
Project [Call_Center#47715, Call_Center_Name#47716, Manager#47717, Returns_Loss#47718]
+- Sort [Returns_Loss#47718 DESC NULLS LAST], true
   +- Aggregate [cc_call_center_id#333, cc_name#338, cc_manager#343, cd_marital_status#476, cd_education_status#477], [cc_call_center_id#333 AS Call_Center#47715, cc_name#338 AS Call_Center_Name#47716, cc_manager#343 AS Manager#47717, sum(cr_net_loss#94) AS Returns_Loss#47718]
      +- Filter (((((cr_call_center_sk#79 = cc_call_center_sk#332) && (cr_returned_date_sk#68 = d_date_sk#492)) && (cr_returning_customer_sk#75 = c_customer_sk#412)) && (((cd_demo_sk#474 = c_current_cdemo_sk#414) && (hd_demo_sk#548 = c_current_hdemo_sk#415)) && (ca_address_sk#448 = c_current_addr_sk#416))) && ((((d_year#498 = 1998) && (d_moy#500 = 11)) && (((cd_marital_status#476 = M) && (cd_education_status#477 = Unknown)) || ((cd_marital_status#476 = W) && (cd_education_status#477 = Advanced Degree)))) && (hd_buy_potential#550 LIKE Unknown% && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-7 as decimal(1,0)) as decimal(5,2))))))
         +- Join Inner
            :- Join Inner
            :  :- Join Inner
            :  :  :- Join Inner
            :  :  :  :- Join Inner
            :  :  :  :  :- Join Inner
            :  :  :  :  :  :- SubqueryAlias `call_center`
            :  :  :  :  :  :  +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet
            :  :  :  :  :  +- SubqueryAlias `catalog_returns`
            :  :  :  :  :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
            :  :  :  :  +- SubqueryAlias `date_dim`
            :  :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  :  :  +- SubqueryAlias `customer`
            :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :  :  +- SubqueryAlias `customer_address`
            :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            :  +- SubqueryAlias `customer_demographics`
            :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
            +- SubqueryAlias `household_demographics`
               +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet

      running Thread[benchmark runner,5,main]
Execution time: 3.0039026730000002s
Running execution q92-v2.4 iteration: 1, StandardRun=true
19/09/08 18:34:37 INFO Query: 
== Query: q92-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [Excess Discount Amount#47766]
      +- Sort [Excess Discount Amount#47766 ASC NULLS FIRST], true
         +- Aggregate [sum(ws_ext_discount_amt#238) AS Excess Discount Amount#47766]
            +- Filter ((((i_manufact_id#577 = 350) && (i_item_sk#564 = ws_item_sk#219)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && ((d_date_sk#492 = ws_sold_date_sk#216) && (cast(ws_ext_discount_amt#238 as decimal(14,7)) > cast(scalar-subquery#47767 [i_item_sk#564] as decimal(14,7)))))
               :  +- Aggregate [CheckOverflow((promote_precision(cast(1.3 as decimal(11,6))) * promote_precision(cast(avg(ws_ext_discount_amt#238) as decimal(11,6)))), DecimalType(14,7)) AS (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(ws_ext_discount_amt) AS DECIMAL(11,6)))#47769]
               :     +- Filter (((ws_item_sk#219 = outer(i_item_sk#564)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && (d_date_sk#492 = ws_sold_date_sk#216))
               :        +- Join Inner
               :           :- SubqueryAlias `web_sales`
               :           :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :           +- SubqueryAlias `date_dim`
               :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- SubqueryAlias `web_sales`
                  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:34:37 INFO Query: 
== Query: q92-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [Excess Discount Amount#47774]
      +- Sort [Excess Discount Amount#47774 ASC NULLS FIRST], true
         +- Aggregate [sum(ws_ext_discount_amt#238) AS Excess Discount Amount#47774]
            +- Filter ((((i_manufact_id#577 = 350) && (i_item_sk#564 = ws_item_sk#219)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && ((d_date_sk#492 = ws_sold_date_sk#216) && (cast(ws_ext_discount_amt#238 as decimal(14,7)) > cast(scalar-subquery#47775 [i_item_sk#564] as decimal(14,7)))))
               :  +- Aggregate [CheckOverflow((promote_precision(cast(1.3 as decimal(11,6))) * promote_precision(cast(avg(ws_ext_discount_amt#238) as decimal(11,6)))), DecimalType(14,7)) AS (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(ws_ext_discount_amt) AS DECIMAL(11,6)))#47777]
               :     +- Filter (((ws_item_sk#219 = outer(i_item_sk#564)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && (d_date_sk#492 = ws_sold_date_sk#216))
               :        +- Join Inner
               :           :- SubqueryAlias `web_sales`
               :           :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :           +- SubqueryAlias `date_dim`
               :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- SubqueryAlias `web_sales`
                  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 2.2611387300000003s
Running execution q93-v2.4 iteration: 1, StandardRun=true
19/09/08 18:34:41 INFO Query: 
== Query: q93-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [sumsales#47816 ASC NULLS FIRST, ss_customer_sk#133 ASC NULLS FIRST], true
      +- Aggregate [ss_customer_sk#133], [ss_customer_sk#133, sum(act_sales#47815) AS sumsales#47816]
         +- SubqueryAlias `t`
            +- Project [ss_item_sk#132, ss_ticket_number#139L, ss_customer_sk#133, CASE WHEN isnotnull(sr_return_quantity#186) THEN CheckOverflow((promote_precision(cast(cast((ss_quantity#140 - sr_return_quantity#186) as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)) ELSE CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)) END AS act_sales#47815]
               +- Filter ((sr_reason_sk#184 = r_reason_sk#646) && (r_reason_desc#648 = reason 28))
                  +- Join Inner
                     :- Join LeftOuter, ((sr_item_sk#178 = ss_item_sk#132) && (sr_ticket_number#185L = ss_ticket_number#139L))
                     :  :- SubqueryAlias `store_sales`
                     :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  +- SubqueryAlias `store_returns`
                     :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     +- SubqueryAlias `reason`
                        +- Relation[r_reason_sk#646,r_reason_id#647,r_reason_desc#648] parquet

     : benchmark
19/09/08 18:34:41 INFO Query: 
== Query: q93-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [sumsales#47823 ASC NULLS FIRST, ss_customer_sk#133 ASC NULLS FIRST], true
      +- Aggregate [ss_customer_sk#133], [ss_customer_sk#133, sum(act_sales#47822) AS sumsales#47823]
         +- SubqueryAlias `t`
            +- Project [ss_item_sk#132, ss_ticket_number#139L, ss_customer_sk#133, CASE WHEN isnotnull(sr_return_quantity#186) THEN CheckOverflow((promote_precision(cast(cast((ss_quantity#140 - sr_return_quantity#186) as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)) ELSE CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)) END AS act_sales#47822]
               +- Filter ((sr_reason_sk#184 = r_reason_sk#646) && (r_reason_desc#648 = reason 28))
                  +- Join Inner
                     :- Join LeftOuter, ((sr_item_sk#178 = ss_item_sk#132) && (sr_ticket_number#185L = ss_ticket_number#139L))
                     :  :- SubqueryAlias `store_sales`
                     :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  +- SubqueryAlias `store_returns`
                     :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     +- SubqueryAlias `reason`
                        +- Relation[r_reason_sk#646,r_reason_id#647,r_reason_desc#648] parquet

      running Thread[benchmark runner,5,main]
Execution time: 12.289529012000001s
Running execution q94-v2.4 iteration: 1, StandardRun=true
19/09/08 18:34:54 INFO Query: 
== Query: q94-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [order count#47901L, total shipping cost#47902, total net profit#47903]
      +- Sort [order count#47901L ASC NULLS FIRST], true
         +- Aggregate [count(distinct ws_order_number#233L) AS order count#47901L, sum(ws_ext_ship_cost#244) AS total shipping cost#47902, sum(ws_net_profit#249) AS total net profit#47903]
            +- Filter (((((d_date#494 >= cast(1999-02-01 as date)) && (d_date#494 <= cast(cast(cast(1999-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))) && (ws_ship_date_sk#218 = d_date_sk#492)) && ((ws_ship_addr_sk#227 = ca_address_sk#448) && (ca_state#456 = IL))) && (((ws_web_site_sk#229 = web_site_sk#798) && (web_company_name#812 = pri)) && (exists#47904 [ws_order_number#233L && ws_warehouse_sk#231] && NOT exists#47905 [ws_order_number#233L])))
               :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 10 more fields]
               :  :  +- Filter ((outer(ws_order_number#233L) = ws_order_number#233L) && NOT (outer(ws_warehouse_sk#231) = ws_warehouse_sk#231))
               :  :     +- SubqueryAlias `ws2`
               :  :        +- SubqueryAlias `web_sales`
               :  :           +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  +- Project [wr_returned_date_sk#284, wr_returned_time_sk#285, wr_item_sk#286, wr_refunded_customer_sk#287, wr_refunded_cdemo_sk#288, wr_refunded_hdemo_sk#289, wr_refunded_addr_sk#290, wr_returning_customer_sk#291, wr_returning_cdemo_sk#292, wr_returning_hdemo_sk#293, wr_returning_addr_sk#294, wr_web_page_sk#295, wr_reason_sk#296, wr_order_number#297L, wr_return_quantity#298, wr_return_amt#299, wr_return_tax#300, wr_return_amt_inc_tax#301, wr_fee#302, wr_return_ship_cost#303, wr_refunded_cash#304, wr_reversed_charge#305, wr_account_credit#306, wr_net_loss#307]
               :     +- Filter (outer(ws_order_number#233L) = wr_order_number#297L)
               :        +- SubqueryAlias `wr1`
               :           +- SubqueryAlias `web_returns`
               :              +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `ws1`
                  :  :  :  +- SubqueryAlias `web_sales`
                  :  :  :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `web_site`
                     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet

     : benchmark
19/09/08 18:34:54 INFO Query: 
== Query: q94-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [order count#47914L, total shipping cost#47915, total net profit#47916]
      +- Sort [order count#47914L ASC NULLS FIRST], true
         +- Aggregate [count(distinct ws_order_number#233L) AS order count#47914L, sum(ws_ext_ship_cost#244) AS total shipping cost#47915, sum(ws_net_profit#249) AS total net profit#47916]
            +- Filter (((((d_date#494 >= cast(1999-02-01 as date)) && (d_date#494 <= cast(cast(cast(1999-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))) && (ws_ship_date_sk#218 = d_date_sk#492)) && ((ws_ship_addr_sk#227 = ca_address_sk#448) && (ca_state#456 = IL))) && (((ws_web_site_sk#229 = web_site_sk#798) && (web_company_name#812 = pri)) && (exists#47917 [ws_order_number#233L && ws_warehouse_sk#231] && NOT exists#47918 [ws_order_number#233L])))
               :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 10 more fields]
               :  :  +- Filter ((outer(ws_order_number#233L) = ws_order_number#233L) && NOT (outer(ws_warehouse_sk#231) = ws_warehouse_sk#231))
               :  :     +- SubqueryAlias `ws2`
               :  :        +- SubqueryAlias `web_sales`
               :  :           +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  +- Project [wr_returned_date_sk#284, wr_returned_time_sk#285, wr_item_sk#286, wr_refunded_customer_sk#287, wr_refunded_cdemo_sk#288, wr_refunded_hdemo_sk#289, wr_refunded_addr_sk#290, wr_returning_customer_sk#291, wr_returning_cdemo_sk#292, wr_returning_hdemo_sk#293, wr_returning_addr_sk#294, wr_web_page_sk#295, wr_reason_sk#296, wr_order_number#297L, wr_return_quantity#298, wr_return_amt#299, wr_return_tax#300, wr_return_amt_inc_tax#301, wr_fee#302, wr_return_ship_cost#303, wr_refunded_cash#304, wr_reversed_charge#305, wr_account_credit#306, wr_net_loss#307]
               :     +- Filter (outer(ws_order_number#233L) = wr_order_number#297L)
               :        +- SubqueryAlias `wr1`
               :           +- SubqueryAlias `web_returns`
               :              +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `ws1`
                  :  :  :  +- SubqueryAlias `web_sales`
                  :  :  :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `web_site`
                     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 5.6416731129999995s
Running execution q95-v2.4 iteration: 1, StandardRun=true
19/09/08 18:35:01 INFO Query: 
== Query: q95-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [order count#48054L, total shipping cost#48055, total net profit#48056]
      +- Sort [order count#48054L ASC NULLS FIRST], true
         +- Aggregate [count(distinct ws_order_number#233L) AS order count#48054L, sum(ws_ext_ship_cost#244) AS total shipping cost#48055, sum(ws_net_profit#249) AS total net profit#48056]
            +- Filter (((((d_date#494 >= cast(1999-02-01 as date)) && (d_date#494 <= cast(cast(cast(1999-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))) && (ws_ship_date_sk#218 = d_date_sk#492)) && ((ws_ship_addr_sk#227 = ca_address_sk#448) && (ca_state#456 = IL))) && (((ws_web_site_sk#229 = web_site_sk#798) && (web_company_name#812 = pri)) && (ws_order_number#233L IN (list#48057 []) && ws_order_number#233L IN (list#48058 []))))
               :  :- Project [ws_order_number#233L]
               :  :  +- SubqueryAlias `ws_wh`
               :  :     +- Project [ws_order_number#233L, ws_warehouse_sk#231 AS wh1#48059, ws_warehouse_sk#48076 AS wh2#48060]
               :  :        +- Filter ((ws_order_number#233L = ws_order_number#48078L) && NOT (ws_warehouse_sk#231 = ws_warehouse_sk#48076))
               :  :           +- Join Inner
               :  :              :- SubqueryAlias `ws1`
               :  :              :  +- SubqueryAlias `web_sales`
               :  :              :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :              +- SubqueryAlias `ws2`
               :  :                 +- SubqueryAlias `web_sales`
               :  :                    +- Relation[ws_sold_date_sk#48061,ws_sold_time_sk#48062,ws_ship_date_sk#48063,ws_item_sk#48064,ws_bill_customer_sk#48065,ws_bill_cdemo_sk#48066,ws_bill_hdemo_sk#48067,ws_bill_addr_sk#48068,ws_ship_customer_sk#48069,ws_ship_cdemo_sk#48070,ws_ship_hdemo_sk#48071,ws_ship_addr_sk#48072,ws_web_page_sk#48073,ws_web_site_sk#48074,ws_ship_mode_sk#48075,ws_warehouse_sk#48076,ws_promo_sk#48077,ws_order_number#48078L,ws_quantity#48079,ws_wholesale_cost#48080,ws_list_price#48081,ws_sales_price#48082,ws_ext_discount_amt#48083,ws_ext_sales_price#48084,... 10 more fields] parquet
               :  +- Project [wr_order_number#297L]
               :     +- Filter (wr_order_number#297L = ws_order_number#233L)
               :        +- Join Inner
               :           :- SubqueryAlias `web_returns`
               :           :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               :           +- SubqueryAlias `ws_wh`
               :              +- Project [ws_order_number#233L, ws_warehouse_sk#231 AS wh1#48059, ws_warehouse_sk#48076 AS wh2#48060]
               :                 +- Filter ((ws_order_number#233L = ws_order_number#48078L) && NOT (ws_warehouse_sk#231 = ws_warehouse_sk#48076))
               :                    +- Join Inner
               :                       :- SubqueryAlias `ws1`
               :                       :  +- SubqueryAlias `web_sales`
               :                       :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                       +- SubqueryAlias `ws2`
               :                          +- SubqueryAlias `web_sales`
               :                             +- Relation[ws_sold_date_sk#48061,ws_sold_time_sk#48062,ws_ship_date_sk#48063,ws_item_sk#48064,ws_bill_customer_sk#48065,ws_bill_cdemo_sk#48066,ws_bill_hdemo_sk#48067,ws_bill_addr_sk#48068,ws_ship_customer_sk#48069,ws_ship_cdemo_sk#48070,ws_ship_hdemo_sk#48071,ws_ship_addr_sk#48072,ws_web_page_sk#48073,ws_web_site_sk#48074,ws_ship_mode_sk#48075,ws_warehouse_sk#48076,ws_promo_sk#48077,ws_order_number#48078L,ws_quantity#48079,ws_wholesale_cost#48080,ws_list_price#48081,ws_sales_price#48082,ws_ext_discount_amt#48083,ws_ext_sales_price#48084,... 10 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `ws1`
                  :  :  :  +- SubqueryAlias `web_sales`
                  :  :  :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `web_site`
                     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet

     : benchmark
19/09/08 18:35:01 INFO Query: 
== Query: q95-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [order count#48103L, total shipping cost#48104, total net profit#48105]
      +- Sort [order count#48103L ASC NULLS FIRST], true
         +- Aggregate [count(distinct ws_order_number#233L) AS order count#48103L, sum(ws_ext_ship_cost#244) AS total shipping cost#48104, sum(ws_net_profit#249) AS total net profit#48105]
            +- Filter (((((d_date#494 >= cast(1999-02-01 as date)) && (d_date#494 <= cast(cast(cast(1999-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))) && (ws_ship_date_sk#218 = d_date_sk#492)) && ((ws_ship_addr_sk#227 = ca_address_sk#448) && (ca_state#456 = IL))) && (((ws_web_site_sk#229 = web_site_sk#798) && (web_company_name#812 = pri)) && (ws_order_number#233L IN (list#48106 []) && ws_order_number#233L IN (list#48107 []))))
               :  :- Project [ws_order_number#233L]
               :  :  +- SubqueryAlias `ws_wh`
               :  :     +- Project [ws_order_number#233L, ws_warehouse_sk#231 AS wh1#48108, ws_warehouse_sk#48125 AS wh2#48109]
               :  :        +- Filter ((ws_order_number#233L = ws_order_number#48127L) && NOT (ws_warehouse_sk#231 = ws_warehouse_sk#48125))
               :  :           +- Join Inner
               :  :              :- SubqueryAlias `ws1`
               :  :              :  +- SubqueryAlias `web_sales`
               :  :              :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :              +- SubqueryAlias `ws2`
               :  :                 +- SubqueryAlias `web_sales`
               :  :                    +- Relation[ws_sold_date_sk#48110,ws_sold_time_sk#48111,ws_ship_date_sk#48112,ws_item_sk#48113,ws_bill_customer_sk#48114,ws_bill_cdemo_sk#48115,ws_bill_hdemo_sk#48116,ws_bill_addr_sk#48117,ws_ship_customer_sk#48118,ws_ship_cdemo_sk#48119,ws_ship_hdemo_sk#48120,ws_ship_addr_sk#48121,ws_web_page_sk#48122,ws_web_site_sk#48123,ws_ship_mode_sk#48124,ws_warehouse_sk#48125,ws_promo_sk#48126,ws_order_number#48127L,ws_quantity#48128,ws_wholesale_cost#48129,ws_list_price#48130,ws_sales_price#48131,ws_ext_discount_amt#48132,ws_ext_sales_price#48133,... 10 more fields] parquet
               :  +- Project [wr_order_number#297L]
               :     +- Filter (wr_order_number#297L = ws_order_number#233L)
               :        +- Join Inner
               :           :- SubqueryAlias `web_returns`
               :           :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               :           +- SubqueryAlias `ws_wh`
               :              +- Project [ws_order_number#233L, ws_warehouse_sk#231 AS wh1#48108, ws_warehouse_sk#48125 AS wh2#48109]
               :                 +- Filter ((ws_order_number#233L = ws_order_number#48127L) && NOT (ws_warehouse_sk#231 = ws_warehouse_sk#48125))
               :                    +- Join Inner
               :                       :- SubqueryAlias `ws1`
               :                       :  +- SubqueryAlias `web_sales`
               :                       :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                       +- SubqueryAlias `ws2`
               :                          +- SubqueryAlias `web_sales`
               :                             +- Relation[ws_sold_date_sk#48110,ws_sold_time_sk#48111,ws_ship_date_sk#48112,ws_item_sk#48113,ws_bill_customer_sk#48114,ws_bill_cdemo_sk#48115,ws_bill_hdemo_sk#48116,ws_bill_addr_sk#48117,ws_ship_customer_sk#48118,ws_ship_cdemo_sk#48119,ws_ship_hdemo_sk#48120,ws_ship_addr_sk#48121,ws_web_page_sk#48122,ws_web_site_sk#48123,ws_ship_mode_sk#48124,ws_warehouse_sk#48125,ws_promo_sk#48126,ws_order_number#48127L,ws_quantity#48128,ws_wholesale_cost#48129,ws_list_price#48130,ws_sales_price#48131,ws_ext_discount_amt#48132,ws_ext_sales_price#48133,... 10 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `ws1`
                  :  :  :  +- SubqueryAlias `web_sales`
                  :  :  :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `web_site`
                     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 18.904776922s
Running execution q96-v2.4 iteration: 1, StandardRun=true
19/09/08 18:35:22 INFO Query: 
== Query: q96-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [count(1)#48269L]
      +- Sort [count(1)#48269L ASC NULLS FIRST], true
         +- Aggregate [count(1) AS count(1)#48269L]
            +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 20))) && (((t_minute#726 >= 30) && (hd_dep_count#551 = 7)) && (s_store_name#669 = ese)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  +- SubqueryAlias `household_demographics`
                  :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                  :  +- SubqueryAlias `time_dim`
                  :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                  +- SubqueryAlias `store`
                     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/09/08 18:35:22 INFO Query: 
== Query: q96-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [count(1)#48274L]
      +- Sort [count(1)#48274L ASC NULLS FIRST], true
         +- Aggregate [count(1) AS count(1)#48274L]
            +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 20))) && (((t_minute#726 >= 30) && (hd_dep_count#551 = 7)) && (s_store_name#669 = ese)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  +- SubqueryAlias `household_demographics`
                  :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                  :  +- SubqueryAlias `time_dim`
                  :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                  +- SubqueryAlias `store`
                     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 1.779113071s
Running execution q97-v2.4 iteration: 1, StandardRun=true
19/09/08 18:35:24 INFO Query: 
== Query: q97-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [sum(cast(CASE WHEN (isnotnull(customer_sk#48312) && isnull(customer_sk#48314)) THEN 1 ELSE 0 END as bigint)) AS store_only#48309L, sum(cast(CASE WHEN (isnull(customer_sk#48312) && isnotnull(customer_sk#48314)) THEN 1 ELSE 0 END as bigint)) AS catalog_only#48310L, sum(cast(CASE WHEN (isnotnull(customer_sk#48312) && isnotnull(customer_sk#48314)) THEN 1 ELSE 0 END as bigint)) AS store_and_catalog#48311L]
      +- Join FullOuter, ((customer_sk#48312 = customer_sk#48314) && (item_sk#48313 = item_sk#48315))
         :- SubqueryAlias `ssci`
         :  +- Aggregate [ss_customer_sk#133, ss_item_sk#132], [ss_customer_sk#133 AS customer_sk#48312, ss_item_sk#132 AS item_sk#48313]
         :     +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
         :        +- Join Inner
         :           :- SubqueryAlias `store_sales`
         :           :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :           +- SubqueryAlias `date_dim`
         :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- SubqueryAlias `csci`
            +- Aggregate [cs_bill_customer_sk#3, cs_item_sk#15], [cs_bill_customer_sk#3 AS customer_sk#48314, cs_item_sk#15 AS item_sk#48315]
               +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
                  +- Join Inner
                     :- SubqueryAlias `catalog_sales`
                     :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:35:24 INFO Query: 
== Query: q97-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [sum(cast(CASE WHEN (isnotnull(customer_sk#48325) && isnull(customer_sk#48327)) THEN 1 ELSE 0 END as bigint)) AS store_only#48322L, sum(cast(CASE WHEN (isnull(customer_sk#48325) && isnotnull(customer_sk#48327)) THEN 1 ELSE 0 END as bigint)) AS catalog_only#48323L, sum(cast(CASE WHEN (isnotnull(customer_sk#48325) && isnotnull(customer_sk#48327)) THEN 1 ELSE 0 END as bigint)) AS store_and_catalog#48324L]
      +- Join FullOuter, ((customer_sk#48325 = customer_sk#48327) && (item_sk#48326 = item_sk#48328))
         :- SubqueryAlias `ssci`
         :  +- Aggregate [ss_customer_sk#133, ss_item_sk#132], [ss_customer_sk#133 AS customer_sk#48325, ss_item_sk#132 AS item_sk#48326]
         :     +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
         :        +- Join Inner
         :           :- SubqueryAlias `store_sales`
         :           :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :           +- SubqueryAlias `date_dim`
         :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- SubqueryAlias `csci`
            +- Aggregate [cs_bill_customer_sk#3, cs_item_sk#15], [cs_bill_customer_sk#3 AS customer_sk#48327, cs_item_sk#15 AS item_sk#48328]
               +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
                  +- Join Inner
                     :- SubqueryAlias `catalog_sales`
                     :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 6.900208618s
Running execution q98-v2.4 iteration: 1, StandardRun=true
19/09/08 18:35:32 INFO Query: 
== Query: q98-v2.4 ==
Project [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#48385, revenueratio#48386]
+- Sort [i_category#576 ASC NULLS FIRST, i_class#574 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, revenueratio#48386 ASC NULLS FIRST], true
   +- Project [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#48385, revenueratio#48386, i_item_id#565]
      +- Project [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#48385, _w0#48391, _w1#48392, _we0#48393, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(_w0#48391 as decimal(17,2))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(17,2)))), DecimalType(21,2)) as decimal(27,2))) / promote_precision(cast(_we0#48393 as decimal(27,2)))), DecimalType(38,17)) AS revenueratio#48386, i_item_id#565]
         +- Window [sum(_w1#48392) windowspecdefinition(i_class#574, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#48393], [i_class#574]
            +- Aggregate [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569], [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, sum(ss_ext_sales_price#145) AS itemrevenue#48385, sum(ss_ext_sales_price#145) AS _w0#48391, sum(ss_ext_sales_price#145) AS _w1#48392, i_item_id#565]
               +- Filter (((ss_item_sk#132 = i_item_sk#564) && i_category#576 IN (Sports,Books,Home)) && ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_date#494 >= cast(1999-02-22 as date)) && (d_date#494 <= cast(cast(cast(1999-02-22 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                  +- Join Inner
                     :- Join Inner
                     :  :- SubqueryAlias `store_sales`
                     :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  +- SubqueryAlias `item`
                     :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:35:32 INFO Query: 
== Query: q98-v2.4 ==
Project [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#48400, revenueratio#48401]
+- Sort [i_category#576 ASC NULLS FIRST, i_class#574 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, revenueratio#48401 ASC NULLS FIRST], true
   +- Project [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#48400, revenueratio#48401, i_item_id#565]
      +- Project [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#48400, _w0#48406, _w1#48407, _we0#48408, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(_w0#48406 as decimal(17,2))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(17,2)))), DecimalType(21,2)) as decimal(27,2))) / promote_precision(cast(_we0#48408 as decimal(27,2)))), DecimalType(38,17)) AS revenueratio#48401, i_item_id#565]
         +- Window [sum(_w1#48407) windowspecdefinition(i_class#574, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#48408], [i_class#574]
            +- Aggregate [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569], [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, sum(ss_ext_sales_price#145) AS itemrevenue#48400, sum(ss_ext_sales_price#145) AS _w0#48406, sum(ss_ext_sales_price#145) AS _w1#48407, i_item_id#565]
               +- Filter (((ss_item_sk#132 = i_item_sk#564) && i_category#576 IN (Sports,Books,Home)) && ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_date#494 >= cast(1999-02-22 as date)) && (d_date#494 <= cast(cast(cast(1999-02-22 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                  +- Join Inner
                     :- Join Inner
                     :  :- SubqueryAlias `store_sales`
                     :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  +- SubqueryAlias `item`
                     :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 3.896314665s
Running execution q99-v2.4 iteration: 1, StandardRun=true
19/09/08 18:35:37 INFO Query: 
== Query: q99-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [substring(w_warehouse_name, 1, 20)#48491, sm_type#654, cc_name#338, 30 days#48481L, 31-60 days#48482L, 61-90 days#48483L, 91-120 days#48484L, >120 days#48485L]
      +- Sort [substring(w_warehouse_name, 1, 20)#48491 ASC NULLS FIRST, sm_type#654 ASC NULLS FIRST, cc_name#338 ASC NULLS FIRST], true
         +- Aggregate [substring(w_warehouse_name#744, 1, 20), sm_type#654, cc_name#338], [substring(w_warehouse_name#744, 1, 20) AS substring(w_warehouse_name, 1, 20)#48491, sm_type#654, cc_name#338, sum(cast(CASE WHEN ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days#48481L, sum(cast(CASE WHEN (((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 30) && ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31-60 days#48482L, sum(cast(CASE WHEN (((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 60) && ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61-90 days#48483L, sum(cast(CASE WHEN (((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 90) && ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91-120 days#48484L, sum(cast(CASE WHEN ((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days#48485L]
            +- Filter (((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (cs_ship_date_sk#2 = d_date_sk#492)) && (cs_warehouse_sk#14 = w_warehouse_sk#742)) && ((cs_ship_mode_sk#13 = sm_ship_mode_sk#652) && (cs_call_center_sk#11 = cc_call_center_sk#332)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `warehouse`
                  :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :  :  +- SubqueryAlias `ship_mode`
                  :  :     +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet
                  :  +- SubqueryAlias `call_center`
                  :     +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:35:37 INFO Query: 
== Query: q99-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [substring(w_warehouse_name, 1, 20)#48513, sm_type#654, cc_name#338, 30 days#48503L, 31-60 days#48504L, 61-90 days#48505L, 91-120 days#48506L, >120 days#48507L]
      +- Sort [substring(w_warehouse_name, 1, 20)#48513 ASC NULLS FIRST, sm_type#654 ASC NULLS FIRST, cc_name#338 ASC NULLS FIRST], true
         +- Aggregate [substring(w_warehouse_name#744, 1, 20), sm_type#654, cc_name#338], [substring(w_warehouse_name#744, 1, 20) AS substring(w_warehouse_name, 1, 20)#48513, sm_type#654, cc_name#338, sum(cast(CASE WHEN ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days#48503L, sum(cast(CASE WHEN (((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 30) && ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31-60 days#48504L, sum(cast(CASE WHEN (((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 60) && ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61-90 days#48505L, sum(cast(CASE WHEN (((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 90) && ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91-120 days#48506L, sum(cast(CASE WHEN ((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days#48507L]
            +- Filter (((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (cs_ship_date_sk#2 = d_date_sk#492)) && (cs_warehouse_sk#14 = w_warehouse_sk#742)) && ((cs_ship_mode_sk#13 = sm_ship_mode_sk#652) && (cs_call_center_sk#11 = cc_call_center_sk#332)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `warehouse`
                  :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :  :  +- SubqueryAlias `ship_mode`
                  :  :     +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet
                  :  +- SubqueryAlias `call_center`
                  :     +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 2.3988773780000003s
Running execution ss_max-v2.4 iteration: 1, StandardRun=true
19/09/08 18:35:41 INFO Query: 
== Query: ss_max-v2.4 ==
Aggregate [count(1) AS total#48643L, count(ss_sold_date_sk#130) AS not_null_total#48644L, count(distinct ss_sold_date_sk#130) AS unique_days#48645L, max(ss_sold_date_sk#130) AS max_ss_sold_date_sk#48646, max(ss_sold_time_sk#131) AS max_ss_sold_time_sk#48647, max(ss_item_sk#132) AS max_ss_item_sk#48648, max(ss_customer_sk#133) AS max_ss_customer_sk#48649, max(ss_cdemo_sk#134) AS max_ss_cdemo_sk#48650, max(ss_hdemo_sk#135) AS max_ss_hdemo_sk#48651, max(ss_addr_sk#136) AS max_ss_addr_sk#48652, max(ss_store_sk#137) AS max_ss_store_sk#48653, max(ss_promo_sk#138) AS max_ss_promo_sk#48654]
+- SubqueryAlias `store_sales`
   +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
19/09/08 18:35:41 INFO Query: 
== Query: ss_max-v2.4 ==
Aggregate [count(1) AS total#48679L, count(ss_sold_date_sk#130) AS not_null_total#48680L, count(distinct ss_sold_date_sk#130) AS unique_days#48681L, max(ss_sold_date_sk#130) AS max_ss_sold_date_sk#48682, max(ss_sold_time_sk#131) AS max_ss_sold_time_sk#48683, max(ss_item_sk#132) AS max_ss_item_sk#48684, max(ss_customer_sk#133) AS max_ss_customer_sk#48685, max(ss_cdemo_sk#134) AS max_ss_cdemo_sk#48686, max(ss_hdemo_sk#135) AS max_ss_hdemo_sk#48687, max(ss_addr_sk#136) AS max_ss_addr_sk#48688, max(ss_store_sk#137) AS max_ss_store_sk#48689, max(ss_promo_sk#138) AS max_ss_promo_sk#48690]
+- SubqueryAlias `store_sales`
   +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 3.347483059s
Results written to table: 'sqlPerformance' at s3a://spark-k8s-data/TPCDS-TEST-100G-RESULT/timestamp=1567966421659
19/09/08 18:35:45 WARN TaskSetManager: Stage 1168 contains a task of very large size (3350 KB). The maximum recommended task size is 100 KB.
19/09/08 18:35:46 WARN AbstractS3ACommitter: Task committer attempt_20190908183545_0000_m_000000_0: No pending uploads to commit
Reading result at s3a://spark-k8s-data/TPCDS-TEST-100G-RESULT/timestamp=1567966421659
+--------------------+---------+--------------------+------+-------------+
|       configuration|iteration|             results|  tags|    timestamp|
+--------------------+---------+--------------------+------+-------------+
|[80, [spark-de702...|        1|[[0.008242, [], 2...|[true]|1567966421659|
+--------------------+---------+--------------------+------+-------------+

+---------+---------+------------------+
|iteration|queryName|  executionSeconds|
+---------+---------+------------------+
|        1|  q1-v2.4|23.286073167999998|
|        1|  q2-v2.4|       7.677093639|
|        1|  q3-v2.4|       3.731308309|
|        1|  q4-v2.4|50.148098798999996|
|        1|  q5-v2.4|11.724827730000001|
|        1|  q6-v2.4|      15.019081014|
|        1|  q7-v2.4|       4.964337759|
|        1|  q8-v2.4|       6.643368553|
|        1|  q9-v2.4|       8.766031709|
|        1| q10-v2.4|       11.52746475|
|        1| q11-v2.4|      18.138428886|
|        1| q12-v2.4|       3.145186824|
|        1| q13-v2.4|       7.456327457|
|        1|q14a-v2.4|      39.169428831|
|        1|q14b-v2.4|       31.38250116|
|        1| q15-v2.4|       5.874261235|
|        1| q16-v2.4| 8.838998014000001|
|        1| q17-v2.4|      14.536631893|
|        1| q18-v2.4|        7.77794147|
|        1| q19-v2.4|       4.452127045|
+---------+---------+------------------+
only showing top 20 rows

Final results at s3a://spark-k8s-data/TPCDS-TEST-100G-RESULT/timestamp=1567966421659
19/09/08 18:35:50 WARN AbstractS3ACommitter: Task committer attempt_20190908183548_0000_m_000000_0: No pending uploads to commit
+-----------+--------------------+-----------------+-----------------+
|  queryName|medianRuntimeSeconds|minRuntimeSeconds|maxRuntimeSeconds|
+-----------+--------------------+-----------------+-----------------+
|    q1-v2.4|                23.0|               23|               23|
|   q10-v2.4|                11.0|               11|               11|
|   q11-v2.4|                18.0|               18|               18|
|   q12-v2.4|                 3.0|                3|                3|
|   q13-v2.4|                 7.0|                7|                7|
|  q14a-v2.4|                39.0|               39|               39|
|  q14b-v2.4|                31.0|               31|               31|
|   q15-v2.4|                 5.0|                5|                5|
|   q16-v2.4|                 8.0|                8|                8|
|   q17-v2.4|                14.0|               14|               14|
|   q18-v2.4|                 7.0|                7|                7|
|   q19-v2.4|                 4.0|                4|                4|
|    q2-v2.4|                 7.0|                7|                7|
|   q20-v2.4|                 4.0|                4|                4|
|   q21-v2.4|                 2.0|                2|                2|
|   q22-v2.4|                11.0|               11|               11|
|  q23a-v2.4|                32.0|               32|               32|
|  q23b-v2.4|                29.0|               29|               29|
|  q24a-v2.4|                20.0|               20|               20|
|  q24b-v2.4|                18.0|               18|               18|
|   q25-v2.4|                14.0|               14|               14|
|   q26-v2.4|                 2.0|                2|                2|
|   q27-v2.4|                 3.0|                3|                3|
|   q28-v2.4|                 9.0|                9|                9|
|   q29-v2.4|                14.0|               14|               14|
|    q3-v2.4|                 3.0|                3|                3|
|   q30-v2.4|                 5.0|                5|                5|
|   q31-v2.4|                10.0|               10|               10|
|   q32-v2.4|                 3.0|                3|                3|
|   q33-v2.4|                 5.0|                5|                5|
|   q34-v2.4|                 3.0|                3|                3|
|   q35-v2.4|                 7.0|                7|                7|
|   q36-v2.4|                 4.0|                4|                4|
|   q37-v2.4|                 3.0|                3|                3|
|   q38-v2.4|                 9.0|                9|                9|
|  q39a-v2.4|                16.0|               16|               16|
|  q39b-v2.4|                14.0|               14|               14|
|    q4-v2.4|                50.0|               50|               50|
|   q40-v2.4|                 5.0|                5|                5|
|   q41-v2.4|                 1.0|                1|                1|
|   q42-v2.4|                 1.0|                1|                1|
|   q43-v2.4|                 2.0|                2|                2|
|   q44-v2.4|                 4.0|                4|                4|
|   q45-v2.4|                 4.0|                4|                4|
|   q46-v2.4|                 5.0|                5|                5|
|   q47-v2.4|                 8.0|                8|                8|
|   q48-v2.4|                 6.0|                6|                6|
|   q49-v2.4|                 9.0|                9|                9|
|    q5-v2.4|                11.0|               11|               11|
|   q50-v2.4|                 7.0|                7|                7|
|   q51-v2.4|                11.0|               11|               11|
|   q52-v2.4|                 2.0|                2|                2|
|   q53-v2.4|                 2.0|                2|                2|
|   q54-v2.4|                 9.0|                9|                9|
|   q55-v2.4|                 1.0|                1|                1|
|   q56-v2.4|                 5.0|                5|                5|
|   q57-v2.4|                 6.0|                6|                6|
|   q58-v2.4|                 5.0|                5|                5|
|   q59-v2.4|                 5.0|                5|                5|
|    q6-v2.4|                15.0|               15|               15|
|   q60-v2.4|                 4.0|                4|                4|
|   q61-v2.4|                 6.0|                6|                6|
|   q62-v2.4|                 1.0|                1|                1|
|   q63-v2.4|                 2.0|                2|                2|
|   q64-v2.4|                26.0|               26|               26|
|   q65-v2.4|                 8.0|                8|                8|
|   q66-v2.4|                 5.0|                5|                5|
|   q67-v2.4|                68.0|               68|               68|
|   q68-v2.4|                 5.0|                5|                5|
|   q69-v2.4|                16.0|               16|               16|
|    q7-v2.4|                 4.0|                4|                4|
|   q70-v2.4|                 4.0|                4|                4|
|   q71-v2.4|                 4.0|                4|                4|
|   q72-v2.4|                73.0|               73|               73|
|   q73-v2.4|                 2.0|                2|                2|
|   q74-v2.4|                17.0|               17|               17|
|   q75-v2.4|                18.0|               18|               18|
|   q76-v2.4|                 4.0|                4|                4|
|   q77-v2.4|                32.0|               32|               32|
|   q78-v2.4|                25.0|               25|               25|
|   q79-v2.4|                 4.0|                4|                4|
|    q8-v2.4|                 6.0|                6|                6|
|   q80-v2.4|                24.0|               24|               24|
|   q81-v2.4|                 4.0|                4|                4|
|   q82-v2.4|                 5.0|                5|                5|
|   q83-v2.4|                 3.0|                3|                3|
|   q84-v2.4|                 2.0|                2|                2|
|   q85-v2.4|                 9.0|                9|                9|
|   q86-v2.4|                 2.0|                2|                2|
|   q87-v2.4|                11.0|               11|               11|
|   q88-v2.4|                 6.0|                6|                6|
|   q89-v2.4|                 3.0|                3|                3|
|    q9-v2.4|                 8.0|                8|                8|
|   q90-v2.4|                 2.0|                2|                2|
|   q91-v2.4|                 3.0|                3|                3|
|   q92-v2.4|                 2.0|                2|                2|
|   q93-v2.4|                12.0|               12|               12|
|   q94-v2.4|                 5.0|                5|                5|
|   q95-v2.4|                18.0|               18|               18|
|   q96-v2.4|                 1.0|                1|                1|
|   q97-v2.4|                 6.0|                6|                6|
|   q98-v2.4|                 3.0|                3|                3|
|   q99-v2.4|                 2.0|                2|                2|
|ss_max-v2.4|                 3.0|                3|                3|
+-----------+--------------------+-----------------+-----------------+

19/09/08 18:35:52 WARN StageMetrics: Stage metrics data refreshed into temp view PerfStageMetrics

Scheduling mode = FIFO
Spark Context default degree of parallelism = 80
Aggregated Spark stage metrics:
numStages => 1091
sum(numTasks) => 147770
elapsedTime => 1319163 (22 min)
sum(stageDuration) => 2071566 (35 min)
sum(executorRunTime) => 57698442 (16.0 h)
sum(executorCpuTime) => 44504500 (12.4 h)
sum(executorDeserializeTime) => 1280682 (21 min)
sum(executorDeserializeCpuTime) => 776662 (13 min)
sum(resultSerializationTime) => 9751 (10 s)
sum(jvmGCTime) => 767900 (13 min)
sum(shuffleFetchWaitTime) => 1911258 (32 min)
sum(shuffleWriteTime) => 1801140 (30 min)
max(resultSize) => 620714863 (591.0 MB)
sum(numUpdatedBlockStatuses) => 0
sum(diskBytesSpilled) => 0 (0 Bytes)
sum(memoryBytesSpilled) => 0 (0 Bytes)
max(peakExecutionMemory) => 660030357504
sum(recordsRead) => 49840770837
sum(bytesRead) => 295576546423 (275.0 GB)
sum(recordsWritten) => 105
sum(bytesWritten) => 3415413 (3.0 MB)
sum(shuffleTotalBytesRead) => 292159219707 (272.0 GB)
sum(shuffleTotalBlocksFetched) => 9828200
sum(shuffleLocalBlocksFetched) => 209497
sum(shuffleRemoteBlocksFetched) => 9618703
sum(shuffleBytesWritten) => 264441391093 (246.0 GB)
sum(shuffleRecordsWritten) => 13327793013
19/09/08 18:35:53 WARN AbstractS3ACommitter: Task committer attempt_20190908183552_0000_m_000000_0: No pending uploads to commit
19/09/08 18:35:53 WARN ExecutorPodsWatchSnapshotSource: Kubernetes client has been closed (this is expected if the application is shutting down.)
