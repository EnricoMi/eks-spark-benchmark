++ id -u
+ myuid=0
++ id -g
+ mygid=0
+ set +e
++ getent passwd 0
+ uidentry=root:x:0:0:root:/root:/bin/ash
+ set -e
+ '[' -z root:x:0:0:root:/root:/bin/ash ']'
+ SPARK_K8S_CMD=driver
+ case "$SPARK_K8S_CMD" in
+ shift 1
+ SPARK_CLASSPATH=':/opt/spark/jars/*'
+ env
+ grep SPARK_JAVA_OPT_
+ sort -t_ -k4 -n
+ sed 's/[^=]*=\(.*\)/\1/g'
+ readarray -t SPARK_EXECUTOR_JAVA_OPTS
+ '[' -n '' ']'
+ '[' -n '' ']'
+ PYSPARK_ARGS=
+ '[' -n '' ']'
+ R_ARGS=
+ '[' -n '' ']'
+ '[' '' == 2 ']'
+ '[' '' == 3 ']'
+ case "$SPARK_K8S_CMD" in
+ CMD=("$SPARK_HOME/bin/spark-submit" --conf "spark.driver.bindAddress=$SPARK_DRIVER_BIND_ADDRESS" --deploy-mode client "$@")
+ exec /sbin/tini -s -- /opt/spark/bin/spark-submit --conf spark.driver.bindAddress=192.168.61.233 --deploy-mode client --properties-file /opt/spark/conf/spark.properties --class com.amazonaws.eks.tpcds.BenchmarkSparkSQL spark-internal s3a://spark-k8s-data/TPCDS-TEST-1T s3a://spark-k8s-data/TPCDS-TEST-1T-RESULT /opt/tpcds-kit/tools 1000 1 false '' true
19/09/08 18:48:08 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
DATA DIR is s3a://spark-k8s-data/TPCDS-TEST-1T
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
19/09/08 18:48:08 INFO SparkContext: Running Spark version 2.4.5-SNAPSHOT
19/09/08 18:48:08 INFO SparkContext: Submitted application: TPCDS SQL Benchmark 1000 GB
19/09/08 18:48:08 INFO SecurityManager: Changing view acls to: root
19/09/08 18:48:08 INFO SecurityManager: Changing modify acls to: root
19/09/08 18:48:08 INFO SecurityManager: Changing view acls groups to:
19/09/08 18:48:08 INFO SecurityManager: Changing modify acls groups to:
19/09/08 18:48:08 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(root); groups with view permissions: Set(); users  with modify permissions: Set(root); groups with modify permissions: Set()
19/09/08 18:48:09 INFO Utils: Successfully started service 'sparkDriver' on port 7078.
19/09/08 18:48:09 INFO SparkEnv: Registering MapOutputTracker
19/09/08 18:48:09 INFO SparkEnv: Registering BlockManagerMaster
19/09/08 18:48:09 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
19/09/08 18:48:09 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
19/09/08 18:48:09 INFO DiskBlockManager: Created local directory at /var/data/spark-4b40c3a3-d94c-42b2-88d1-ff2c1a63c2d4/blockmgr-8943bf29-29f2-452a-bf1e-5e6dfae34ae6
19/09/08 18:48:09 INFO MemoryStore: MemoryStore started with capacity 4.0 GB
19/09/08 18:48:09 INFO SparkEnv: Registering OutputCommitCoordinator
19/09/08 18:48:09 INFO Utils: Successfully started service 'SparkUI' on port 4040.
19/09/08 18:48:09 INFO SparkUI: Bound SparkUI to 0.0.0.0, and started at http://tpcds-benchmark-1t-1567968484516-driver-svc.default.svc:4040
19/09/08 18:48:09 INFO SparkContext: Added JAR file:///opt/spark/examples/jars/eks-spark-examples-assembly-1.0.jar at spark://tpcds-benchmark-1t-1567968484516-driver-svc.default.svc:7078/jars/eks-spark-examples-assembly-1.0.jar with timestamp 1567968489409
19/09/08 18:48:10 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:48:10 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 7079.
19/09/08 18:48:10 INFO NettyBlockTransferService: Server created on tpcds-benchmark-1t-1567968484516-driver-svc.default.svc:7079
19/09/08 18:48:10 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
19/09/08 18:48:10 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, tpcds-benchmark-1t-1567968484516-driver-svc.default.svc, 7079, None)
19/09/08 18:48:10 INFO BlockManagerMasterEndpoint: Registering block manager tpcds-benchmark-1t-1567968484516-driver-svc.default.svc:7079 with 4.0 GB RAM, BlockManagerId(driver, tpcds-benchmark-1t-1567968484516-driver-svc.default.svc, 7079, None)
19/09/08 18:48:10 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, tpcds-benchmark-1t-1567968484516-driver-svc.default.svc, 7079, None)
19/09/08 18:48:10 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, tpcds-benchmark-1t-1567968484516-driver-svc.default.svc, 7079, None)
19/09/08 18:48:13 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:48:13 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.0.99:37342) with ID 3
19/09/08 18:48:13 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.20.8:58096) with ID 5
19/09/08 18:48:13 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.11.61:34244) with ID 1
19/09/08 18:48:13 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.39.93:38270) with ID 2
19/09/08 18:48:13 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.57.164:39934) with ID 4
19/09/08 18:48:14 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.0.99:36455 with 4.3 GB RAM, BlockManagerId(3, 192.168.0.99, 36455, None)
19/09/08 18:48:14 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.20.8:36755 with 4.3 GB RAM, BlockManagerId(5, 192.168.20.8, 36755, None)
19/09/08 18:48:14 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.11.61:39319 with 4.3 GB RAM, BlockManagerId(1, 192.168.11.61, 39319, None)
19/09/08 18:48:14 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.39.93:33759 with 4.3 GB RAM, BlockManagerId(2, 192.168.39.93, 33759, None)
19/09/08 18:48:14 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.57.164:35599 with 4.3 GB RAM, BlockManagerId(4, 192.168.57.164, 35599, None)
19/09/08 18:48:16 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.12.106:60586) with ID 6
19/09/08 18:48:16 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:48:17 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.12.106:41207 with 4.3 GB RAM, BlockManagerId(6, 192.168.12.106, 41207, None)
19/09/08 18:48:17 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.37.187:40052) with ID 7
19/09/08 18:48:17 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.37.252:41572) with ID 9
19/09/08 18:48:17 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.62.250:45724) with ID 10
19/09/08 18:48:17 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.25.84:43768) with ID 8
19/09/08 18:48:17 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.37.187:41863 with 4.3 GB RAM, BlockManagerId(7, 192.168.37.187, 41863, None)
19/09/08 18:48:17 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.37.252:38705 with 4.3 GB RAM, BlockManagerId(9, 192.168.37.252, 38705, None)
19/09/08 18:48:17 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.25.84:34241 with 4.3 GB RAM, BlockManagerId(8, 192.168.25.84, 34241, None)
19/09/08 18:48:17 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.62.250:40713 with 4.3 GB RAM, BlockManagerId(10, 192.168.62.250, 40713, None)
19/09/08 18:48:20 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:48:20 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.56.194:58966) with ID 13
19/09/08 18:48:20 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.56.2:35040) with ID 15
19/09/08 18:48:20 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.42.137:53068) with ID 14
19/09/08 18:48:20 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.56.194:42011 with 4.3 GB RAM, BlockManagerId(13, 192.168.56.194, 42011, None)
19/09/08 18:48:20 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.20.73:58664) with ID 11
19/09/08 18:48:20 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.56.2:37227 with 4.3 GB RAM, BlockManagerId(15, 192.168.56.2, 37227, None)
19/09/08 18:48:20 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.42.137:33973 with 4.3 GB RAM, BlockManagerId(14, 192.168.42.137, 33973, None)
19/09/08 18:48:20 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.20.73:42699 with 4.3 GB RAM, BlockManagerId(11, 192.168.20.73, 42699, None)
19/09/08 18:48:20 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.3.250:38352) with ID 12
19/09/08 18:48:20 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.3.250:33769 with 4.3 GB RAM, BlockManagerId(12, 192.168.3.250, 33769, None)
19/09/08 18:48:23 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:48:23 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.17.74:35596) with ID 17
19/09/08 18:48:23 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.4.207:47284) with ID 18
19/09/08 18:48:23 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.22.62:46114) with ID 16
19/09/08 18:48:23 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.17.74:45263 with 4.3 GB RAM, BlockManagerId(17, 192.168.17.74, 45263, None)
19/09/08 18:48:23 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.53.62:59934) with ID 19
19/09/08 18:48:23 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.4.207:46351 with 4.3 GB RAM, BlockManagerId(18, 192.168.4.207, 46351, None)
19/09/08 18:48:23 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.22.62:45993 with 4.3 GB RAM, BlockManagerId(16, 192.168.22.62, 45993, None)
19/09/08 18:48:23 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.38.66:51704) with ID 20
19/09/08 18:48:23 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.53.62:36443 with 4.3 GB RAM, BlockManagerId(19, 192.168.53.62, 36443, None)
19/09/08 18:48:23 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.38.66:36385 with 4.3 GB RAM, BlockManagerId(20, 192.168.38.66, 36385, None)
19/09/08 18:48:26 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:48:26 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.48.158:36304) with ID 24
19/09/08 18:48:26 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.45.171:33156) with ID 21
19/09/08 18:48:26 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.54.132:49562) with ID 23
19/09/08 18:48:26 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.25.101:46640) with ID 22
19/09/08 18:48:26 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.48.158:44959 with 4.3 GB RAM, BlockManagerId(24, 192.168.48.158, 44959, None)
19/09/08 18:48:26 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.45.171:45187 with 4.3 GB RAM, BlockManagerId(21, 192.168.45.171, 45187, None)
19/09/08 18:48:26 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.54.132:37251 with 4.3 GB RAM, BlockManagerId(23, 192.168.54.132, 37251, None)
19/09/08 18:48:26 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.25.101:40679 with 4.3 GB RAM, BlockManagerId(22, 192.168.25.101, 40679, None)
19/09/08 18:48:26 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.8.56:48702) with ID 25
19/09/08 18:48:27 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.8.56:33757 with 4.3 GB RAM, BlockManagerId(25, 192.168.8.56, 33757, None)
19/09/08 18:48:29 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:48:29 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.23.123:58048) with ID 27
19/09/08 18:48:29 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.59.81:35428) with ID 26
19/09/08 18:48:29 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.37.213:51072) with ID 30
19/09/08 18:48:29 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.60.169:57258) with ID 28
19/09/08 18:48:29 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.23.123:33975 with 4.3 GB RAM, BlockManagerId(27, 192.168.23.123, 33975, None)
19/09/08 18:48:29 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.59.81:46491 with 4.3 GB RAM, BlockManagerId(26, 192.168.59.81, 46491, None)
19/09/08 18:48:29 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.49.225:44508) with ID 29
19/09/08 18:48:29 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.37.213:43269 with 4.3 GB RAM, BlockManagerId(30, 192.168.37.213, 43269, None)
19/09/08 18:48:29 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.60.169:39119 with 4.3 GB RAM, BlockManagerId(28, 192.168.60.169, 39119, None)
19/09/08 18:48:30 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.49.225:37489 with 4.3 GB RAM, BlockManagerId(29, 192.168.49.225, 37489, None)
19/09/08 18:48:31 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:48:32 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.37.69:60574) with ID 34
19/09/08 18:48:32 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.2.135:58326) with ID 33
19/09/08 18:48:32 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.6.189:57596) with ID 31
19/09/08 18:48:32 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.30.121:56648) with ID 32
19/09/08 18:48:32 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.2.135:37697 with 4.3 GB RAM, BlockManagerId(33, 192.168.2.135, 37697, None)
19/09/08 18:48:33 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.37.69:36803 with 4.3 GB RAM, BlockManagerId(34, 192.168.37.69, 36803, None)
19/09/08 18:48:33 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.6.189:42447 with 4.3 GB RAM, BlockManagerId(31, 192.168.6.189, 42447, None)
19/09/08 18:48:33 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.16.108:41608) with ID 35
19/09/08 18:48:33 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.30.121:46823 with 4.3 GB RAM, BlockManagerId(32, 192.168.30.121, 46823, None)
19/09/08 18:48:33 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.16.108:38207 with 4.3 GB RAM, BlockManagerId(35, 192.168.16.108, 38207, None)
19/09/08 18:48:34 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:48:35 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.14.171:49630) with ID 36
19/09/08 18:48:35 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.16.16:36110) with ID 37
19/09/08 18:48:35 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.27.141:54174) with ID 38
19/09/08 18:48:35 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.14.171:45321 with 4.3 GB RAM, BlockManagerId(36, 192.168.14.171, 45321, None)
19/09/08 18:48:35 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.16.16:36727 with 4.3 GB RAM, BlockManagerId(37, 192.168.16.16, 36727, None)
19/09/08 18:48:35 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.60.98:36786) with ID 40
19/09/08 18:48:35 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.27.141:36723 with 4.3 GB RAM, BlockManagerId(38, 192.168.27.141, 36723, None)
19/09/08 18:48:35 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.60.98:38955 with 4.3 GB RAM, BlockManagerId(40, 192.168.60.98, 38955, None)
19/09/08 18:48:35 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.11.65:56580) with ID 39
19/09/08 18:48:35 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.11.65:44237 with 4.3 GB RAM, BlockManagerId(39, 192.168.11.65, 44237, None)
19/09/08 18:48:37 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:48:38 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.24.41:55090) with ID 41
19/09/08 18:48:38 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.8.187:47184) with ID 42
19/09/08 18:48:38 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.53.162:58316) with ID 44
19/09/08 18:48:38 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.54.68:44834) with ID 45
19/09/08 18:48:38 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.62.105:40184) with ID 43
19/09/08 18:48:38 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.24.41:38415 with 4.3 GB RAM, BlockManagerId(41, 192.168.24.41, 38415, None)
19/09/08 18:48:38 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.8.187:44667 with 4.3 GB RAM, BlockManagerId(42, 192.168.8.187, 44667, None)
19/09/08 18:48:38 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.53.162:43219 with 4.3 GB RAM, BlockManagerId(44, 192.168.53.162, 43219, None)
19/09/08 18:48:38 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.54.68:39301 with 4.3 GB RAM, BlockManagerId(45, 192.168.54.68, 39301, None)
19/09/08 18:48:38 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.62.105:34311 with 4.3 GB RAM, BlockManagerId(43, 192.168.62.105, 34311, None)
19/09/08 18:48:39 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/09/08 18:48:40 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.45.183:59516) with ID 46
19/09/08 18:48:40 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.12.97:58686) with ID 47
19/09/08 18:48:40 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.30.220:48592) with ID 50
19/09/08 18:48:40 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.26.220:57968) with ID 49
19/09/08 18:48:40 INFO KubernetesClusterSchedulerBackend: SchedulerBackend is ready for scheduling beginning after waiting maxRegisteredResourcesWaitingTime: 30000(ms)
19/09/08 18:48:40 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.58.158:48090) with ID 48
19/09/08 18:48:40 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.30.220:36351 with 4.3 GB RAM, BlockManagerId(50, 192.168.30.220, 36351, None)
19/09/08 18:48:40 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.12.97:41423 with 4.3 GB RAM, BlockManagerId(47, 192.168.12.97, 41423, None)
19/09/08 18:48:40 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.45.183:40455 with 4.3 GB RAM, BlockManagerId(46, 192.168.45.183, 40455, None)
19/09/08 18:48:40 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.26.220:44817 with 4.3 GB RAM, BlockManagerId(49, 192.168.26.220, 44817, None)
Only WARN
Creating temporary table catalog_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/catalog_sales.
19/09/08 18:48:40 INFO TPCDSTables: Creating temporary table catalog_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/catalog_sales.
19/09/08 18:48:41 WARN MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-s3a-file-system.properties,hadoop-metrics2.properties
19/09/08 18:48:48 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
Creating temporary table catalog_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/catalog_returns.
19/09/08 18:48:48 INFO TPCDSTables: Creating temporary table catalog_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/catalog_returns.
Creating temporary table inventory using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/inventory.
19/09/08 18:48:51 INFO TPCDSTables: Creating temporary table inventory using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/inventory.
Creating temporary table store_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/store_sales.
19/09/08 18:48:54 INFO TPCDSTables: Creating temporary table store_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/store_sales.
Creating temporary table store_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/store_returns.
19/09/08 18:48:57 INFO TPCDSTables: Creating temporary table store_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/store_returns.
Creating temporary table web_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/web_sales.
19/09/08 18:49:01 INFO TPCDSTables: Creating temporary table web_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/web_sales.
Creating temporary table web_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/web_returns.
19/09/08 18:49:04 INFO TPCDSTables: Creating temporary table web_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/web_returns.
Creating temporary table call_center using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/call_center.
19/09/08 18:49:07 INFO TPCDSTables: Creating temporary table call_center using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/call_center.
Creating temporary table catalog_page using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/catalog_page.
19/09/08 18:49:10 INFO TPCDSTables: Creating temporary table catalog_page using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/catalog_page.
Creating temporary table customer using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/customer.
19/09/08 18:49:13 INFO TPCDSTables: Creating temporary table customer using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/customer.
Creating temporary table customer_address using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/customer_address.
19/09/08 18:49:16 INFO TPCDSTables: Creating temporary table customer_address using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/customer_address.
Creating temporary table customer_demographics using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/customer_demographics.
19/09/08 18:49:19 INFO TPCDSTables: Creating temporary table customer_demographics using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/customer_demographics.
Creating temporary table date_dim using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/date_dim.
19/09/08 18:49:22 INFO TPCDSTables: Creating temporary table date_dim using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/date_dim.
Creating temporary table household_demographics using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/household_demographics.
19/09/08 18:49:25 INFO TPCDSTables: Creating temporary table household_demographics using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/household_demographics.
Creating temporary table income_band using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/income_band.
19/09/08 18:49:28 INFO TPCDSTables: Creating temporary table income_band using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/income_band.
Creating temporary table item using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/item.
19/09/08 18:49:31 INFO TPCDSTables: Creating temporary table item using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/item.
Creating temporary table promotion using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/promotion.
19/09/08 18:49:34 INFO TPCDSTables: Creating temporary table promotion using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/promotion.
Creating temporary table reason using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/reason.
19/09/08 18:49:37 INFO TPCDSTables: Creating temporary table reason using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/reason.
Creating temporary table ship_mode using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/ship_mode.
19/09/08 18:49:40 INFO TPCDSTables: Creating temporary table ship_mode using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/ship_mode.
Creating temporary table store using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/store.
19/09/08 18:49:41 INFO TPCDSTables: Creating temporary table store using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/store.
Creating temporary table time_dim using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/time_dim.
19/09/08 18:49:44 INFO TPCDSTables: Creating temporary table time_dim using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/time_dim.
Creating temporary table warehouse using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/warehouse.
19/09/08 18:49:46 INFO TPCDSTables: Creating temporary table warehouse using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/warehouse.
Creating temporary table web_page using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/web_page.
19/09/08 18:49:50 INFO TPCDSTables: Creating temporary table web_page using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/web_page.
Creating temporary table web_site using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/web_site.
19/09/08 18:49:50 INFO TPCDSTables: Creating temporary table web_site using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/web_site.
Couldn't read table customer_total_return and its not defined as a Benchmark.Table.
Table store exists.
Table customer exists.
Couldn't read table wswscs and its not defined as a Benchmark.Table.
Table date_dim exists.
Table store_sales exists.
Table item exists.
Couldn't read table year_total and its not defined as a Benchmark.Table.
Couldn't read table ssr and its not defined as a Benchmark.Table.
Couldn't read table csr and its not defined as a Benchmark.Table.
Couldn't read table wsr and its not defined as a Benchmark.Table.
Table customer_address exists.
Table customer_demographics exists.
Table promotion exists.
Table reason exists.
Table web_sales exists.
Table household_demographics exists.
Table catalog_sales exists.
Table call_center exists.
Table store_returns exists.
Table inventory exists.
Table warehouse exists.
Couldn't read table ssales and its not defined as a Benchmark.Table.
Couldn't read table ss and its not defined as a Benchmark.Table.
Couldn't read table ws and its not defined as a Benchmark.Table.
Couldn't read table cs and its not defined as a Benchmark.Table.
Couldn't read table inv and its not defined as a Benchmark.Table.
Table catalog_returns exists.
Couldn't read table v2 and its not defined as a Benchmark.Table.
Table web_returns exists.
Couldn't read table web_v1 and its not defined as a Benchmark.Table.
Couldn't read table store_v1 and its not defined as a Benchmark.Table.
Couldn't read table segments and its not defined as a Benchmark.Table.
Couldn't read table ss_items and its not defined as a Benchmark.Table.
Couldn't read table cs_items and its not defined as a Benchmark.Table.
Couldn't read table ws_items and its not defined as a Benchmark.Table.
Couldn't read table wss and its not defined as a Benchmark.Table.
Table ship_mode exists.
Table web_site exists.
Couldn't read table cross_sales and its not defined as a Benchmark.Table.
Table time_dim exists.
Couldn't read table all_sales and its not defined as a Benchmark.Table.
Couldn't read table sr and its not defined as a Benchmark.Table.
Couldn't read table cr and its not defined as a Benchmark.Table.
Couldn't read table wr and its not defined as a Benchmark.Table.
Couldn't read table sr_items and its not defined as a Benchmark.Table.
Couldn't read table cr_items and its not defined as a Benchmark.Table.
Couldn't read table wr_items and its not defined as a Benchmark.Table.
Table income_band exists.
Table web_page exists.
Couldn't read table ssci and its not defined as a Benchmark.Table.
Couldn't read table csci and its not defined as a Benchmark.Table.
Running execution q1-v2.4 iteration: 1, StandardRun=true
19/09/08 18:50:04 INFO Query:
== Query: q1-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_customer_id#413 ASC NULLS FIRST], true
      +- Project [c_customer_id#413]
         +- Filter (((cast(ctr_total_return#8593 as decimal(24,7)) > cast(scalar-subquery#8590 [ctr_store_sk#8592] as decimal(24,7))) && (s_store_sk#664 = ctr_store_sk#8592)) && ((s_state#688 = TN) && (ctr_customer_sk#8591 = c_customer_sk#412)))
            :  +- Aggregate [CheckOverflow((promote_precision(cast(avg(ctr_total_return#8593) as decimal(21,6))) * promote_precision(cast(1.2 as decimal(21,6)))), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#8596]
            :     +- Filter (outer(ctr_store_sk#8592) = ctr_store_sk#8592)
            :        +- SubqueryAlias `ctr2`
            :           +- SubqueryAlias `customer_total_return`
            :              +- Aggregate [sr_customer_sk#179, sr_store_sk#183], [sr_customer_sk#179 AS ctr_customer_sk#8591, sr_store_sk#183 AS ctr_store_sk#8592, sum(sr_return_amt#187) AS ctr_total_return#8593]
            :                 +- Filter ((sr_returned_date_sk#176 = d_date_sk#492) && (d_year#498 = 2000))
            :                    +- Join Inner
            :                       :- SubqueryAlias `store_returns`
            :                       :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
            :                       +- SubqueryAlias `date_dim`
            :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ctr1`
               :  :  +- SubqueryAlias `customer_total_return`
               :  :     +- Aggregate [sr_customer_sk#179, sr_store_sk#183], [sr_customer_sk#179 AS ctr_customer_sk#8591, sr_store_sk#183 AS ctr_store_sk#8592, sum(sr_return_amt#187) AS ctr_total_return#8593]
               :  :        +- Filter ((sr_returned_date_sk#176 = d_date_sk#492) && (d_year#498 = 2000))
               :  :           +- Join Inner
               :  :              :- SubqueryAlias `store_returns`
               :  :              :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :  :              +- SubqueryAlias `date_dim`
               :  :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store`
               :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               +- SubqueryAlias `customer`
                  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/09/08 18:50:04 INFO Query:
== Query: q1-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_customer_id#413 ASC NULLS FIRST], true
      +- Project [c_customer_id#413]
         +- Filter (((cast(ctr_total_return#8601 as decimal(24,7)) > cast(scalar-subquery#8598 [ctr_store_sk#8600] as decimal(24,7))) && (s_store_sk#664 = ctr_store_sk#8600)) && ((s_state#688 = TN) && (ctr_customer_sk#8599 = c_customer_sk#412)))
            :  +- Aggregate [CheckOverflow((promote_precision(cast(avg(ctr_total_return#8601) as decimal(21,6))) * promote_precision(cast(1.2 as decimal(21,6)))), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#8604]
            :     +- Filter (outer(ctr_store_sk#8600) = ctr_store_sk#8600)
            :        +- SubqueryAlias `ctr2`
            :           +- SubqueryAlias `customer_total_return`
            :              +- Aggregate [sr_customer_sk#179, sr_store_sk#183], [sr_customer_sk#179 AS ctr_customer_sk#8599, sr_store_sk#183 AS ctr_store_sk#8600, sum(sr_return_amt#187) AS ctr_total_return#8601]
            :                 +- Filter ((sr_returned_date_sk#176 = d_date_sk#492) && (d_year#498 = 2000))
            :                    +- Join Inner
            :                       :- SubqueryAlias `store_returns`
            :                       :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
            :                       +- SubqueryAlias `date_dim`
            :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ctr1`
               :  :  +- SubqueryAlias `customer_total_return`
               :  :     +- Aggregate [sr_customer_sk#179, sr_store_sk#183], [sr_customer_sk#179 AS ctr_customer_sk#8599, sr_store_sk#183 AS ctr_store_sk#8600, sum(sr_return_amt#187) AS ctr_total_return#8601]
               :  :        +- Filter ((sr_returned_date_sk#176 = d_date_sk#492) && (d_year#498 = 2000))
               :  :           +- Join Inner
               :  :              :- SubqueryAlias `store_returns`
               :  :              :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :  :              +- SubqueryAlias `date_dim`
               :  :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store`
               :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               +- SubqueryAlias `customer`
                  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 34.231924574s
Running execution q2-v2.4 iteration: 1, StandardRun=true
19/09/08 18:50:40 INFO Query:
== Query: q2-v2.4 ==
Sort [d_week_seq1#8781 ASC NULLS FIRST], true
+- Project [d_week_seq1#8781, round(CheckOverflow((promote_precision(cast(sun_sales1#8782 as decimal(17,2))) / promote_precision(cast(sun_sales2#8790 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((sun_sales1 / sun_sales2), 2)#8871, round(CheckOverflow((promote_precision(cast(mon_sales1#8783 as decimal(17,2))) / promote_precision(cast(mon_sales2#8791 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((mon_sales1 / mon_sales2), 2)#8872, round(CheckOverflow((promote_precision(cast(tue_sales1#8784 as decimal(17,2))) / promote_precision(cast(tue_sales2#8792 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((tue_sales1 / tue_sales2), 2)#8873, round(CheckOverflow((promote_precision(cast(wed_sales1#8785 as decimal(17,2))) / promote_precision(cast(wed_sales2#8793 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((wed_sales1 / wed_sales2), 2)#8874, round(CheckOverflow((promote_precision(cast(thu_sales1#8786 as decimal(17,2))) / promote_precision(cast(thu_sales2#8794 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((thu_sales1 / thu_sales2), 2)#8875, round(CheckOverflow((promote_precision(cast(fri_sales1#8787 as decimal(17,2))) / promote_precision(cast(fri_sales2#8795 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((fri_sales1 / fri_sales2), 2)#8876, round(CheckOverflow((promote_precision(cast(sat_sales1#8788 as decimal(17,2))) / promote_precision(cast(sat_sales2#8796 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((sat_sales1 / sat_sales2), 2)#8877]
   +- Filter (d_week_seq1#8781 = (d_week_seq2#8789 - 53))
      +- Join Inner
         :- SubqueryAlias `y`
         :  +- Project [d_week_seq#496 AS d_week_seq1#8781, sun_sales#8801 AS sun_sales1#8782, mon_sales#8802 AS mon_sales1#8783, tue_sales#8803 AS tue_sales1#8784, wed_sales#8804 AS wed_sales1#8785, thu_sales#8805 AS thu_sales1#8786, fri_sales#8806 AS fri_sales1#8787, sat_sales#8807 AS sat_sales1#8788]
         :     +- Filter ((d_week_seq#8819 = d_week_seq#496) && (d_year#8821 = 2001))
         :        +- Join Inner
         :           :- SubqueryAlias `wswscs`
         :           :  +- Aggregate [d_week_seq#496], [d_week_seq#496, sum(CASE WHEN (d_day_name#506 = Sunday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS sun_sales#8801, sum(CASE WHEN (d_day_name#506 = Monday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS mon_sales#8802, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS tue_sales#8803, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS wed_sales#8804, sum(CASE WHEN (d_day_name#506 = Thursday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS thu_sales#8805, sum(CASE WHEN (d_day_name#506 = Friday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS fri_sales#8806, sum(CASE WHEN (d_day_name#506 = Saturday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS sat_sales#8807]
         :           :     +- Filter (d_date_sk#492 = sold_date_sk#8797)
         :           :        +- Join Inner
         :           :           :- SubqueryAlias `wscs`
         :           :           :  +- Project [sold_date_sk#8797, sales_price#8798]
         :           :           :     +- SubqueryAlias `x`
         :           :           :        +- Union
         :           :           :           :- Project [ws_sold_date_sk#216 AS sold_date_sk#8797, ws_ext_sales_price#239 AS sales_price#8798]
         :           :           :           :  +- SubqueryAlias `web_sales`
         :           :           :           :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
         :           :           :           +- Project [cs_sold_date_sk#0 AS sold_date_sk#8799, cs_ext_sales_price#23 AS sales_price#8800]
         :           :           :              +- SubqueryAlias `catalog_sales`
         :           :           :                 +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :           :           +- SubqueryAlias `date_dim`
         :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :           +- SubqueryAlias `date_dim`
         :              +- Relation[d_date_sk#8815,d_date_id#8816,d_date#8817,d_month_seq#8818,d_week_seq#8819,d_quarter_seq#8820,d_year#8821,d_dow#8822,d_moy#8823,d_dom#8824,d_qoy#8825,d_fy_year#8826,d_fy_quarter_seq#8827,d_fy_week_seq#8828,d_day_name#8829,d_quarter_name#8830,d_holiday#8831,d_weekend#8832,d_following_holiday#8833,d_first_dom#8834,d_last_dom#8835,d_same_day_ly#8836,d_same_day_lq#8837,d_current_day#8838,... 4 more fields] parquet
         +- SubqueryAlias `z`
            +- Project [d_week_seq#496 AS d_week_seq2#8789, sun_sales#8801 AS sun_sales2#8790, mon_sales#8802 AS mon_sales2#8791, tue_sales#8803 AS tue_sales2#8792, wed_sales#8804 AS wed_sales2#8793, thu_sales#8805 AS thu_sales2#8794, fri_sales#8806 AS fri_sales2#8795, sat_sales#8807 AS sat_sales2#8796]
               +- Filter ((d_week_seq#8847 = d_week_seq#496) && (d_year#8849 = (2001 + 1)))
                  +- Join Inner
                     :- SubqueryAlias `wswscs`
                     :  +- Aggregate [d_week_seq#496], [d_week_seq#496, sum(CASE WHEN (d_day_name#506 = Sunday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS sun_sales#8801, sum(CASE WHEN (d_day_name#506 = Monday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS mon_sales#8802, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS tue_sales#8803, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS wed_sales#8804, sum(CASE WHEN (d_day_name#506 = Thursday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS thu_sales#8805, sum(CASE WHEN (d_day_name#506 = Friday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS fri_sales#8806, sum(CASE WHEN (d_day_name#506 = Saturday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS sat_sales#8807]
                     :     +- Filter (d_date_sk#492 = sold_date_sk#8797)
                     :        +- Join Inner
                     :           :- SubqueryAlias `wscs`
                     :           :  +- Project [sold_date_sk#8797, sales_price#8798]
                     :           :     +- SubqueryAlias `x`
                     :           :        +- Union
                     :           :           :- Project [ws_sold_date_sk#216 AS sold_date_sk#8797, ws_ext_sales_price#239 AS sales_price#8798]
                     :           :           :  +- SubqueryAlias `web_sales`
                     :           :           :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :           :           +- Project [cs_sold_date_sk#0 AS sold_date_sk#8799, cs_ext_sales_price#23 AS sales_price#8800]
                     :           :              +- SubqueryAlias `catalog_sales`
                     :           :                 +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :           +- SubqueryAlias `date_dim`
                     :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#8843,d_date_id#8844,d_date#8845,d_month_seq#8846,d_week_seq#8847,d_quarter_seq#8848,d_year#8849,d_dow#8850,d_moy#8851,d_dom#8852,d_qoy#8853,d_fy_year#8854,d_fy_quarter_seq#8855,d_fy_week_seq#8856,d_day_name#8857,d_quarter_name#8858,d_holiday#8859,d_weekend#8860,d_following_holiday#8861,d_first_dom#8862,d_last_dom#8863,d_same_day_ly#8864,d_same_day_lq#8865,d_current_day#8866,... 4 more fields] parquet

     : benchmark
19/09/08 18:50:40 INFO Query:
== Query: q2-v2.4 ==
Sort [d_week_seq1#8886 ASC NULLS FIRST], true
+- Project [d_week_seq1#8886, round(CheckOverflow((promote_precision(cast(sun_sales1#8887 as decimal(17,2))) / promote_precision(cast(sun_sales2#8895 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((sun_sales1 / sun_sales2), 2)#8976, round(CheckOverflow((promote_precision(cast(mon_sales1#8888 as decimal(17,2))) / promote_precision(cast(mon_sales2#8896 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((mon_sales1 / mon_sales2), 2)#8977, round(CheckOverflow((promote_precision(cast(tue_sales1#8889 as decimal(17,2))) / promote_precision(cast(tue_sales2#8897 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((tue_sales1 / tue_sales2), 2)#8978, round(CheckOverflow((promote_precision(cast(wed_sales1#8890 as decimal(17,2))) / promote_precision(cast(wed_sales2#8898 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((wed_sales1 / wed_sales2), 2)#8979, round(CheckOverflow((promote_precision(cast(thu_sales1#8891 as decimal(17,2))) / promote_precision(cast(thu_sales2#8899 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((thu_sales1 / thu_sales2), 2)#8980, round(CheckOverflow((promote_precision(cast(fri_sales1#8892 as decimal(17,2))) / promote_precision(cast(fri_sales2#8900 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((fri_sales1 / fri_sales2), 2)#8981, round(CheckOverflow((promote_precision(cast(sat_sales1#8893 as decimal(17,2))) / promote_precision(cast(sat_sales2#8901 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((sat_sales1 / sat_sales2), 2)#8982]
   +- Filter (d_week_seq1#8886 = (d_week_seq2#8894 - 53))
      +- Join Inner
         :- SubqueryAlias `y`
         :  +- Project [d_week_seq#496 AS d_week_seq1#8886, sun_sales#8906 AS sun_sales1#8887, mon_sales#8907 AS mon_sales1#8888, tue_sales#8908 AS tue_sales1#8889, wed_sales#8909 AS wed_sales1#8890, thu_sales#8910 AS thu_sales1#8891, fri_sales#8911 AS fri_sales1#8892, sat_sales#8912 AS sat_sales1#8893]
         :     +- Filter ((d_week_seq#8924 = d_week_seq#496) && (d_year#8926 = 2001))
         :        +- Join Inner
         :           :- SubqueryAlias `wswscs`
         :           :  +- Aggregate [d_week_seq#496], [d_week_seq#496, sum(CASE WHEN (d_day_name#506 = Sunday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS sun_sales#8906, sum(CASE WHEN (d_day_name#506 = Monday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS mon_sales#8907, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS tue_sales#8908, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS wed_sales#8909, sum(CASE WHEN (d_day_name#506 = Thursday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS thu_sales#8910, sum(CASE WHEN (d_day_name#506 = Friday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS fri_sales#8911, sum(CASE WHEN (d_day_name#506 = Saturday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS sat_sales#8912]
         :           :     +- Filter (d_date_sk#492 = sold_date_sk#8902)
         :           :        +- Join Inner
         :           :           :- SubqueryAlias `wscs`
         :           :           :  +- Project [sold_date_sk#8902, sales_price#8903]
         :           :           :     +- SubqueryAlias `x`
         :           :           :        +- Union
         :           :           :           :- Project [ws_sold_date_sk#216 AS sold_date_sk#8902, ws_ext_sales_price#239 AS sales_price#8903]
         :           :           :           :  +- SubqueryAlias `web_sales`
         :           :           :           :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
         :           :           :           +- Project [cs_sold_date_sk#0 AS sold_date_sk#8904, cs_ext_sales_price#23 AS sales_price#8905]
         :           :           :              +- SubqueryAlias `catalog_sales`
         :           :           :                 +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :           :           +- SubqueryAlias `date_dim`
         :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :           +- SubqueryAlias `date_dim`
         :              +- Relation[d_date_sk#8920,d_date_id#8921,d_date#8922,d_month_seq#8923,d_week_seq#8924,d_quarter_seq#8925,d_year#8926,d_dow#8927,d_moy#8928,d_dom#8929,d_qoy#8930,d_fy_year#8931,d_fy_quarter_seq#8932,d_fy_week_seq#8933,d_day_name#8934,d_quarter_name#8935,d_holiday#8936,d_weekend#8937,d_following_holiday#8938,d_first_dom#8939,d_last_dom#8940,d_same_day_ly#8941,d_same_day_lq#8942,d_current_day#8943,... 4 more fields] parquet
         +- SubqueryAlias `z`
            +- Project [d_week_seq#496 AS d_week_seq2#8894, sun_sales#8906 AS sun_sales2#8895, mon_sales#8907 AS mon_sales2#8896, tue_sales#8908 AS tue_sales2#8897, wed_sales#8909 AS wed_sales2#8898, thu_sales#8910 AS thu_sales2#8899, fri_sales#8911 AS fri_sales2#8900, sat_sales#8912 AS sat_sales2#8901]
               +- Filter ((d_week_seq#8952 = d_week_seq#496) && (d_year#8954 = (2001 + 1)))
                  +- Join Inner
                     :- SubqueryAlias `wswscs`
                     :  +- Aggregate [d_week_seq#496], [d_week_seq#496, sum(CASE WHEN (d_day_name#506 = Sunday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS sun_sales#8906, sum(CASE WHEN (d_day_name#506 = Monday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS mon_sales#8907, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS tue_sales#8908, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS wed_sales#8909, sum(CASE WHEN (d_day_name#506 = Thursday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS thu_sales#8910, sum(CASE WHEN (d_day_name#506 = Friday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS fri_sales#8911, sum(CASE WHEN (d_day_name#506 = Saturday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS sat_sales#8912]
                     :     +- Filter (d_date_sk#492 = sold_date_sk#8902)
                     :        +- Join Inner
                     :           :- SubqueryAlias `wscs`
                     :           :  +- Project [sold_date_sk#8902, sales_price#8903]
                     :           :     +- SubqueryAlias `x`
                     :           :        +- Union
                     :           :           :- Project [ws_sold_date_sk#216 AS sold_date_sk#8902, ws_ext_sales_price#239 AS sales_price#8903]
                     :           :           :  +- SubqueryAlias `web_sales`
                     :           :           :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :           :           +- Project [cs_sold_date_sk#0 AS sold_date_sk#8904, cs_ext_sales_price#23 AS sales_price#8905]
                     :           :              +- SubqueryAlias `catalog_sales`
                     :           :                 +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :           +- SubqueryAlias `date_dim`
                     :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#8948,d_date_id#8949,d_date#8950,d_month_seq#8951,d_week_seq#8952,d_quarter_seq#8953,d_year#8954,d_dow#8955,d_moy#8956,d_dom#8957,d_qoy#8958,d_fy_year#8959,d_fy_quarter_seq#8960,d_fy_week_seq#8961,d_day_name#8962,d_quarter_name#8963,d_holiday#8964,d_weekend#8965,d_following_holiday#8966,d_first_dom#8967,d_last_dom#8968,d_same_day_ly#8969,d_same_day_lq#8970,d_current_day#8971,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 22.007735606999997s
Running execution q3-v2.4 iteration: 1, StandardRun=true
19/09/08 18:51:03 INFO Query:
== Query: q3-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [d_year#498 ASC NULLS FIRST, sum_agg#9259 DESC NULLS LAST, brand_id#9257 ASC NULLS FIRST], true
      +- Aggregate [d_year#498, i_brand#572, i_brand_id#571], [d_year#498, i_brand_id#571 AS brand_id#9257, i_brand#572 AS brand#9258, sum(ss_ext_sales_price#145) AS sum_agg#9259]
         +- Filter (((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && ((i_manufact_id#577 = 128) && (d_moy#500 = 11)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dt`
               :  :  +- SubqueryAlias `date_dim`
               :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:51:03 INFO Query:
== Query: q3-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [d_year#498 ASC NULLS FIRST, sum_agg#9270 DESC NULLS LAST, brand_id#9268 ASC NULLS FIRST], true
      +- Aggregate [d_year#498, i_brand#572, i_brand_id#571], [d_year#498, i_brand_id#571 AS brand_id#9268, i_brand#572 AS brand#9269, sum(ss_ext_sales_price#145) AS sum_agg#9270]
         +- Filter (((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && ((i_manufact_id#577 = 128) && (d_moy#500 = 11)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dt`
               :  :  +- SubqueryAlias `date_dim`
               :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 12.847368397s
Running execution q4-v2.4 iteration: 1, StandardRun=true
19/09/08 18:51:19 INFO Query:
== Query: q4-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#9447 ASC NULLS FIRST, customer_first_name#9448 ASC NULLS FIRST, customer_last_name#9449 ASC NULLS FIRST, customer_preferred_cust_flag#9450 ASC NULLS FIRST], true
      +- Project [customer_id#9447, customer_first_name#9448, customer_last_name#9449, customer_preferred_cust_flag#9450]
         +- Filter ((((((customer_id#9447 = customer_id#9414) && (customer_id#9414 = customer_id#9467)) && (customer_id#9414 = customer_id#9457)) && (((customer_id#9414 = customer_id#9477) && (customer_id#9414 = customer_id#9487)) && (sale_type#9423 = s))) && ((((sale_type#9466 = c) && (sale_type#9486 = w)) && (sale_type#9456 = s)) && ((sale_type#9476 = c) && (sale_type#9496 = w)))) && (((((dyear#9421 = 2001) && (dyear#9454 = (2001 + 1))) && (dyear#9464 = 2001)) && (((dyear#9474 = (2001 + 1)) && (dyear#9484 = 2001)) && (dyear#9494 = (2001 + 1)))) && ((((cast(year_total#9422 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) && (cast(year_total#9465 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6)))) && (cast(year_total#9485 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6)))) && ((CASE WHEN (cast(year_total#9465 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9475 as decimal(24,6))) / promote_precision(cast(year_total#9465 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END > CASE WHEN (cast(year_total#9422 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9455 as decimal(24,6))) / promote_precision(cast(year_total#9422 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END) && (CASE WHEN (cast(year_total#9465 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9475 as decimal(24,6))) / promote_precision(cast(year_total#9465 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END > CASE WHEN (cast(year_total#9485 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9495 as decimal(24,6))) / promote_precision(cast(year_total#9485 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END)))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- Join Inner
               :  :  :  :- Join Inner
               :  :  :  :  :- SubqueryAlias `t_s_firstyear`
               :  :  :  :  :  +- SubqueryAlias `year_total`
               :  :  :  :  :     +- Union
               :  :  :  :  :        :- Union
               :  :  :  :  :        :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9414, c_first_name#420 AS customer_first_name#9415, c_last_name#421 AS customer_last_name#9416, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9417, c_birth_country#426 AS customer_birth_country#9418, c_login#427 AS customer_login#9419, c_email_address#428 AS customer_email_address#9420, d_year#498 AS dyear#9421, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9422, s AS sale_type#9423]
               :  :  :  :  :        :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :  :  :        :  :     +- Join Inner
               :  :  :  :  :        :  :        :- Join Inner
               :  :  :  :  :        :  :        :  :- SubqueryAlias `customer`
               :  :  :  :  :        :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :  :        :  :        :  +- SubqueryAlias `store_sales`
               :  :  :  :  :        :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  :  :        :  :        +- SubqueryAlias `date_dim`
               :  :  :  :  :        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  :        :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9424, c_first_name#420 AS customer_first_name#9425, c_last_name#421 AS customer_last_name#9426, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9427, c_birth_country#426 AS customer_birth_country#9428, c_login#427 AS customer_login#9429, c_email_address#428 AS customer_email_address#9430, d_year#498 AS dyear#9431, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9432, c AS sale_type#9433]
               :  :  :  :  :        :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :  :  :  :        :        +- Join Inner
               :  :  :  :  :        :           :- Join Inner
               :  :  :  :  :        :           :  :- SubqueryAlias `customer`
               :  :  :  :  :        :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :  :        :           :  +- SubqueryAlias `catalog_sales`
               :  :  :  :  :        :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :  :        :           +- SubqueryAlias `date_dim`
               :  :  :  :  :        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  :        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9434, c_first_name#420 AS customer_first_name#9435, c_last_name#421 AS customer_last_name#9436, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9437, c_birth_country#426 AS customer_birth_country#9438, c_login#427 AS customer_login#9439, c_email_address#428 AS customer_email_address#9440, d_year#498 AS dyear#9441, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9442, w AS sale_type#9443]
               :  :  :  :  :           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :  :  :              +- Join Inner
               :  :  :  :  :                 :- Join Inner
               :  :  :  :  :                 :  :- SubqueryAlias `customer`
               :  :  :  :  :                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :  :                 :  +- SubqueryAlias `web_sales`
               :  :  :  :  :                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :  :  :                 +- SubqueryAlias `date_dim`
               :  :  :  :  :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  +- SubqueryAlias `t_s_secyear`
               :  :  :  :     +- SubqueryAlias `year_total`
               :  :  :  :        +- Union
               :  :  :  :           :- Union
               :  :  :  :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9447, c_first_name#420 AS customer_first_name#9448, c_last_name#421 AS customer_last_name#9449, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9450, c_birth_country#426 AS customer_birth_country#9451, c_login#427 AS customer_login#9452, c_email_address#428 AS customer_email_address#9453, d_year#498 AS dyear#9454, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9455, s AS sale_type#9456]
               :  :  :  :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :  :           :  :     +- Join Inner
               :  :  :  :           :  :        :- Join Inner
               :  :  :  :           :  :        :  :- SubqueryAlias `customer`
               :  :  :  :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :           :  :        :  +- SubqueryAlias `store_sales`
               :  :  :  :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  :           :  :        +- SubqueryAlias `date_dim`
               :  :  :  :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9424, c_first_name#420 AS customer_first_name#9425, c_last_name#421 AS customer_last_name#9426, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9427, c_birth_country#426 AS customer_birth_country#9428, c_login#427 AS customer_login#9429, c_email_address#428 AS customer_email_address#9430, d_year#498 AS dyear#9431, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9432, c AS sale_type#9433]
               :  :  :  :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :  :  :           :        +- Join Inner
               :  :  :  :           :           :- Join Inner
               :  :  :  :           :           :  :- SubqueryAlias `customer`
               :  :  :  :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :           :           :  +- SubqueryAlias `catalog_sales`
               :  :  :  :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :           :           +- SubqueryAlias `date_dim`
               :  :  :  :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9434, c_first_name#420 AS customer_first_name#9435, c_last_name#421 AS customer_last_name#9436, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9437, c_birth_country#426 AS customer_birth_country#9438, c_login#427 AS customer_login#9439, c_email_address#428 AS customer_email_address#9440, d_year#498 AS dyear#9441, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9442, w AS sale_type#9443]
               :  :  :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :  :                 +- Join Inner
               :  :  :  :                    :- Join Inner
               :  :  :  :                    :  :- SubqueryAlias `customer`
               :  :  :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :                    :  +- SubqueryAlias `web_sales`
               :  :  :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :  :                    +- SubqueryAlias `date_dim`
               :  :  :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  +- SubqueryAlias `t_c_firstyear`
               :  :  :     +- SubqueryAlias `year_total`
               :  :  :        +- Union
               :  :  :           :- Union
               :  :  :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9457, c_first_name#420 AS customer_first_name#9458, c_last_name#421 AS customer_last_name#9459, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9460, c_birth_country#426 AS customer_birth_country#9461, c_login#427 AS customer_login#9462, c_email_address#428 AS customer_email_address#9463, d_year#498 AS dyear#9464, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9465, s AS sale_type#9466]
               :  :  :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :           :  :     +- Join Inner
               :  :  :           :  :        :- Join Inner
               :  :  :           :  :        :  :- SubqueryAlias `customer`
               :  :  :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :           :  :        :  +- SubqueryAlias `store_sales`
               :  :  :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :           :  :        +- SubqueryAlias `date_dim`
               :  :  :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9424, c_first_name#420 AS customer_first_name#9425, c_last_name#421 AS customer_last_name#9426, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9427, c_birth_country#426 AS customer_birth_country#9428, c_login#427 AS customer_login#9429, c_email_address#428 AS customer_email_address#9430, d_year#498 AS dyear#9431, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9432, c AS sale_type#9433]
               :  :  :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :  :           :        +- Join Inner
               :  :  :           :           :- Join Inner
               :  :  :           :           :  :- SubqueryAlias `customer`
               :  :  :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :           :           :  +- SubqueryAlias `catalog_sales`
               :  :  :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :           :           +- SubqueryAlias `date_dim`
               :  :  :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9434, c_first_name#420 AS customer_first_name#9435, c_last_name#421 AS customer_last_name#9436, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9437, c_birth_country#426 AS customer_birth_country#9438, c_login#427 AS customer_login#9439, c_email_address#428 AS customer_email_address#9440, d_year#498 AS dyear#9441, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9442, w AS sale_type#9443]
               :  :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :                 +- Join Inner
               :  :  :                    :- Join Inner
               :  :  :                    :  :- SubqueryAlias `customer`
               :  :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :                    :  +- SubqueryAlias `web_sales`
               :  :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :                    +- SubqueryAlias `date_dim`
               :  :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  +- SubqueryAlias `t_c_secyear`
               :  :     +- SubqueryAlias `year_total`
               :  :        +- Union
               :  :           :- Union
               :  :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9467, c_first_name#420 AS customer_first_name#9468, c_last_name#421 AS customer_last_name#9469, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9470, c_birth_country#426 AS customer_birth_country#9471, c_login#427 AS customer_login#9472, c_email_address#428 AS customer_email_address#9473, d_year#498 AS dyear#9474, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9475, s AS sale_type#9476]
               :  :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :           :  :     +- Join Inner
               :  :           :  :        :- Join Inner
               :  :           :  :        :  :- SubqueryAlias `customer`
               :  :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :  :        :  +- SubqueryAlias `store_sales`
               :  :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  :        +- SubqueryAlias `date_dim`
               :  :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9424, c_first_name#420 AS customer_first_name#9425, c_last_name#421 AS customer_last_name#9426, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9427, c_birth_country#426 AS customer_birth_country#9428, c_login#427 AS customer_login#9429, c_email_address#428 AS customer_email_address#9430, d_year#498 AS dyear#9431, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9432, c AS sale_type#9433]
               :  :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :           :        +- Join Inner
               :  :           :           :- Join Inner
               :  :           :           :  :- SubqueryAlias `customer`
               :  :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :           :  +- SubqueryAlias `catalog_sales`
               :  :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :           :           +- SubqueryAlias `date_dim`
               :  :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9434, c_first_name#420 AS customer_first_name#9435, c_last_name#421 AS customer_last_name#9436, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9437, c_birth_country#426 AS customer_birth_country#9438, c_login#427 AS customer_login#9439, c_email_address#428 AS customer_email_address#9440, d_year#498 AS dyear#9441, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9442, w AS sale_type#9443]
               :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :                 +- Join Inner
               :  :                    :- Join Inner
               :  :                    :  :- SubqueryAlias `customer`
               :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :                    :  +- SubqueryAlias `web_sales`
               :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :                    +- SubqueryAlias `date_dim`
               :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `t_w_firstyear`
               :     +- SubqueryAlias `year_total`
               :        +- Union
               :           :- Union
               :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9477, c_first_name#420 AS customer_first_name#9478, c_last_name#421 AS customer_last_name#9479, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9480, c_birth_country#426 AS customer_birth_country#9481, c_login#427 AS customer_login#9482, c_email_address#428 AS customer_email_address#9483, d_year#498 AS dyear#9484, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9485, s AS sale_type#9486]
               :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :           :  :     +- Join Inner
               :           :  :        :- Join Inner
               :           :  :        :  :- SubqueryAlias `customer`
               :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :  :        :  +- SubqueryAlias `store_sales`
               :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :  :        +- SubqueryAlias `date_dim`
               :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9424, c_first_name#420 AS customer_first_name#9425, c_last_name#421 AS customer_last_name#9426, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9427, c_birth_country#426 AS customer_birth_country#9428, c_login#427 AS customer_login#9429, c_email_address#428 AS customer_email_address#9430, d_year#498 AS dyear#9431, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9432, c AS sale_type#9433]
               :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :           :        +- Join Inner
               :           :           :- Join Inner
               :           :           :  :- SubqueryAlias `customer`
               :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :           :  +- SubqueryAlias `catalog_sales`
               :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :           :           +- SubqueryAlias `date_dim`
               :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9434, c_first_name#420 AS customer_first_name#9435, c_last_name#421 AS customer_last_name#9436, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9437, c_birth_country#426 AS customer_birth_country#9438, c_login#427 AS customer_login#9439, c_email_address#428 AS customer_email_address#9440, d_year#498 AS dyear#9441, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9442, w AS sale_type#9443]
               :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :                 +- Join Inner
               :                    :- Join Inner
               :                    :  :- SubqueryAlias `customer`
               :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :                    :  +- SubqueryAlias `web_sales`
               :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `t_w_secyear`
                  +- SubqueryAlias `year_total`
                     +- Union
                        :- Union
                        :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9487, c_first_name#420 AS customer_first_name#9488, c_last_name#421 AS customer_last_name#9489, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9490, c_birth_country#426 AS customer_birth_country#9491, c_login#427 AS customer_login#9492, c_email_address#428 AS customer_email_address#9493, d_year#498 AS dyear#9494, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9495, s AS sale_type#9496]
                        :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
                        :  :     +- Join Inner
                        :  :        :- Join Inner
                        :  :        :  :- SubqueryAlias `customer`
                        :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :        :  +- SubqueryAlias `store_sales`
                        :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :        +- SubqueryAlias `date_dim`
                        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9424, c_first_name#420 AS customer_first_name#9425, c_last_name#421 AS customer_last_name#9426, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9427, c_birth_country#426 AS customer_birth_country#9428, c_login#427 AS customer_login#9429, c_email_address#428 AS customer_email_address#9430, d_year#498 AS dyear#9431, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9432, c AS sale_type#9433]
                        :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
                        :        +- Join Inner
                        :           :- Join Inner
                        :           :  :- SubqueryAlias `customer`
                        :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :           :  +- SubqueryAlias `catalog_sales`
                        :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :           +- SubqueryAlias `date_dim`
                        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9434, c_first_name#420 AS customer_first_name#9435, c_last_name#421 AS customer_last_name#9436, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9437, c_birth_country#426 AS customer_birth_country#9438, c_login#427 AS customer_login#9439, c_email_address#428 AS customer_email_address#9440, d_year#498 AS dyear#9441, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9442, w AS sale_type#9443]
                           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `customer`
                                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                                 :  +- SubqueryAlias `web_sales`
                                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 18:51:20 INFO Query:
== Query: q4-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#9534 ASC NULLS FIRST, customer_first_name#9535 ASC NULLS FIRST, customer_last_name#9536 ASC NULLS FIRST, customer_preferred_cust_flag#9537 ASC NULLS FIRST], true
      +- Project [customer_id#9534, customer_first_name#9535, customer_last_name#9536, customer_preferred_cust_flag#9537]
         +- Filter ((((((customer_id#9534 = customer_id#9501) && (customer_id#9501 = customer_id#9554)) && (customer_id#9501 = customer_id#9544)) && (((customer_id#9501 = customer_id#9564) && (customer_id#9501 = customer_id#9574)) && (sale_type#9510 = s))) && ((((sale_type#9553 = c) && (sale_type#9573 = w)) && (sale_type#9543 = s)) && ((sale_type#9563 = c) && (sale_type#9583 = w)))) && (((((dyear#9508 = 2001) && (dyear#9541 = (2001 + 1))) && (dyear#9551 = 2001)) && (((dyear#9561 = (2001 + 1)) && (dyear#9571 = 2001)) && (dyear#9581 = (2001 + 1)))) && ((((cast(year_total#9509 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) && (cast(year_total#9552 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6)))) && (cast(year_total#9572 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6)))) && ((CASE WHEN (cast(year_total#9552 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9562 as decimal(24,6))) / promote_precision(cast(year_total#9552 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END > CASE WHEN (cast(year_total#9509 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9542 as decimal(24,6))) / promote_precision(cast(year_total#9509 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END) && (CASE WHEN (cast(year_total#9552 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9562 as decimal(24,6))) / promote_precision(cast(year_total#9552 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END > CASE WHEN (cast(year_total#9572 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9582 as decimal(24,6))) / promote_precision(cast(year_total#9572 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END)))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- Join Inner
               :  :  :  :- Join Inner
               :  :  :  :  :- SubqueryAlias `t_s_firstyear`
               :  :  :  :  :  +- SubqueryAlias `year_total`
               :  :  :  :  :     +- Union
               :  :  :  :  :        :- Union
               :  :  :  :  :        :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9501, c_first_name#420 AS customer_first_name#9502, c_last_name#421 AS customer_last_name#9503, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9504, c_birth_country#426 AS customer_birth_country#9505, c_login#427 AS customer_login#9506, c_email_address#428 AS customer_email_address#9507, d_year#498 AS dyear#9508, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9509, s AS sale_type#9510]
               :  :  :  :  :        :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :  :  :        :  :     +- Join Inner
               :  :  :  :  :        :  :        :- Join Inner
               :  :  :  :  :        :  :        :  :- SubqueryAlias `customer`
               :  :  :  :  :        :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :  :        :  :        :  +- SubqueryAlias `store_sales`
               :  :  :  :  :        :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  :  :        :  :        +- SubqueryAlias `date_dim`
               :  :  :  :  :        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  :        :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9511, c_first_name#420 AS customer_first_name#9512, c_last_name#421 AS customer_last_name#9513, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9514, c_birth_country#426 AS customer_birth_country#9515, c_login#427 AS customer_login#9516, c_email_address#428 AS customer_email_address#9517, d_year#498 AS dyear#9518, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9519, c AS sale_type#9520]
               :  :  :  :  :        :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :  :  :  :        :        +- Join Inner
               :  :  :  :  :        :           :- Join Inner
               :  :  :  :  :        :           :  :- SubqueryAlias `customer`
               :  :  :  :  :        :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :  :        :           :  +- SubqueryAlias `catalog_sales`
               :  :  :  :  :        :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :  :        :           +- SubqueryAlias `date_dim`
               :  :  :  :  :        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  :        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9521, c_first_name#420 AS customer_first_name#9522, c_last_name#421 AS customer_last_name#9523, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9524, c_birth_country#426 AS customer_birth_country#9525, c_login#427 AS customer_login#9526, c_email_address#428 AS customer_email_address#9527, d_year#498 AS dyear#9528, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9529, w AS sale_type#9530]
               :  :  :  :  :           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :  :  :              +- Join Inner
               :  :  :  :  :                 :- Join Inner
               :  :  :  :  :                 :  :- SubqueryAlias `customer`
               :  :  :  :  :                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :  :                 :  +- SubqueryAlias `web_sales`
               :  :  :  :  :                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :  :  :                 +- SubqueryAlias `date_dim`
               :  :  :  :  :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  +- SubqueryAlias `t_s_secyear`
               :  :  :  :     +- SubqueryAlias `year_total`
               :  :  :  :        +- Union
               :  :  :  :           :- Union
               :  :  :  :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9534, c_first_name#420 AS customer_first_name#9535, c_last_name#421 AS customer_last_name#9536, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9537, c_birth_country#426 AS customer_birth_country#9538, c_login#427 AS customer_login#9539, c_email_address#428 AS customer_email_address#9540, d_year#498 AS dyear#9541, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9542, s AS sale_type#9543]
               :  :  :  :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :  :           :  :     +- Join Inner
               :  :  :  :           :  :        :- Join Inner
               :  :  :  :           :  :        :  :- SubqueryAlias `customer`
               :  :  :  :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :           :  :        :  +- SubqueryAlias `store_sales`
               :  :  :  :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  :           :  :        +- SubqueryAlias `date_dim`
               :  :  :  :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9511, c_first_name#420 AS customer_first_name#9512, c_last_name#421 AS customer_last_name#9513, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9514, c_birth_country#426 AS customer_birth_country#9515, c_login#427 AS customer_login#9516, c_email_address#428 AS customer_email_address#9517, d_year#498 AS dyear#9518, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9519, c AS sale_type#9520]
               :  :  :  :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :  :  :           :        +- Join Inner
               :  :  :  :           :           :- Join Inner
               :  :  :  :           :           :  :- SubqueryAlias `customer`
               :  :  :  :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :           :           :  +- SubqueryAlias `catalog_sales`
               :  :  :  :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :           :           +- SubqueryAlias `date_dim`
               :  :  :  :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9521, c_first_name#420 AS customer_first_name#9522, c_last_name#421 AS customer_last_name#9523, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9524, c_birth_country#426 AS customer_birth_country#9525, c_login#427 AS customer_login#9526, c_email_address#428 AS customer_email_address#9527, d_year#498 AS dyear#9528, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9529, w AS sale_type#9530]
               :  :  :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :  :                 +- Join Inner
               :  :  :  :                    :- Join Inner
               :  :  :  :                    :  :- SubqueryAlias `customer`
               :  :  :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :                    :  +- SubqueryAlias `web_sales`
               :  :  :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :  :                    +- SubqueryAlias `date_dim`
               :  :  :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  +- SubqueryAlias `t_c_firstyear`
               :  :  :     +- SubqueryAlias `year_total`
               :  :  :        +- Union
               :  :  :           :- Union
               :  :  :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9544, c_first_name#420 AS customer_first_name#9545, c_last_name#421 AS customer_last_name#9546, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9547, c_birth_country#426 AS customer_birth_country#9548, c_login#427 AS customer_login#9549, c_email_address#428 AS customer_email_address#9550, d_year#498 AS dyear#9551, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9552, s AS sale_type#9553]
               :  :  :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :           :  :     +- Join Inner
               :  :  :           :  :        :- Join Inner
               :  :  :           :  :        :  :- SubqueryAlias `customer`
               :  :  :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :           :  :        :  +- SubqueryAlias `store_sales`
               :  :  :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :           :  :        +- SubqueryAlias `date_dim`
               :  :  :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9511, c_first_name#420 AS customer_first_name#9512, c_last_name#421 AS customer_last_name#9513, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9514, c_birth_country#426 AS customer_birth_country#9515, c_login#427 AS customer_login#9516, c_email_address#428 AS customer_email_address#9517, d_year#498 AS dyear#9518, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9519, c AS sale_type#9520]
               :  :  :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :  :           :        +- Join Inner
               :  :  :           :           :- Join Inner
               :  :  :           :           :  :- SubqueryAlias `customer`
               :  :  :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :           :           :  +- SubqueryAlias `catalog_sales`
               :  :  :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :           :           +- SubqueryAlias `date_dim`
               :  :  :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9521, c_first_name#420 AS customer_first_name#9522, c_last_name#421 AS customer_last_name#9523, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9524, c_birth_country#426 AS customer_birth_country#9525, c_login#427 AS customer_login#9526, c_email_address#428 AS customer_email_address#9527, d_year#498 AS dyear#9528, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9529, w AS sale_type#9530]
               :  :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :                 +- Join Inner
               :  :  :                    :- Join Inner
               :  :  :                    :  :- SubqueryAlias `customer`
               :  :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :                    :  +- SubqueryAlias `web_sales`
               :  :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :                    +- SubqueryAlias `date_dim`
               :  :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  +- SubqueryAlias `t_c_secyear`
               :  :     +- SubqueryAlias `year_total`
               :  :        +- Union
               :  :           :- Union
               :  :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9554, c_first_name#420 AS customer_first_name#9555, c_last_name#421 AS customer_last_name#9556, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9557, c_birth_country#426 AS customer_birth_country#9558, c_login#427 AS customer_login#9559, c_email_address#428 AS customer_email_address#9560, d_year#498 AS dyear#9561, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9562, s AS sale_type#9563]
               :  :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :           :  :     +- Join Inner
               :  :           :  :        :- Join Inner
               :  :           :  :        :  :- SubqueryAlias `customer`
               :  :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :  :        :  +- SubqueryAlias `store_sales`
               :  :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  :        +- SubqueryAlias `date_dim`
               :  :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9511, c_first_name#420 AS customer_first_name#9512, c_last_name#421 AS customer_last_name#9513, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9514, c_birth_country#426 AS customer_birth_country#9515, c_login#427 AS customer_login#9516, c_email_address#428 AS customer_email_address#9517, d_year#498 AS dyear#9518, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9519, c AS sale_type#9520]
               :  :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :           :        +- Join Inner
               :  :           :           :- Join Inner
               :  :           :           :  :- SubqueryAlias `customer`
               :  :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :           :  +- SubqueryAlias `catalog_sales`
               :  :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :           :           +- SubqueryAlias `date_dim`
               :  :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9521, c_first_name#420 AS customer_first_name#9522, c_last_name#421 AS customer_last_name#9523, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9524, c_birth_country#426 AS customer_birth_country#9525, c_login#427 AS customer_login#9526, c_email_address#428 AS customer_email_address#9527, d_year#498 AS dyear#9528, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9529, w AS sale_type#9530]
               :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :                 +- Join Inner
               :  :                    :- Join Inner
               :  :                    :  :- SubqueryAlias `customer`
               :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :                    :  +- SubqueryAlias `web_sales`
               :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :                    +- SubqueryAlias `date_dim`
               :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `t_w_firstyear`
               :     +- SubqueryAlias `year_total`
               :        +- Union
               :           :- Union
               :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9564, c_first_name#420 AS customer_first_name#9565, c_last_name#421 AS customer_last_name#9566, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9567, c_birth_country#426 AS customer_birth_country#9568, c_login#427 AS customer_login#9569, c_email_address#428 AS customer_email_address#9570, d_year#498 AS dyear#9571, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9572, s AS sale_type#9573]
               :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :           :  :     +- Join Inner
               :           :  :        :- Join Inner
               :           :  :        :  :- SubqueryAlias `customer`
               :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :  :        :  +- SubqueryAlias `store_sales`
               :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :  :        +- SubqueryAlias `date_dim`
               :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9511, c_first_name#420 AS customer_first_name#9512, c_last_name#421 AS customer_last_name#9513, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9514, c_birth_country#426 AS customer_birth_country#9515, c_login#427 AS customer_login#9516, c_email_address#428 AS customer_email_address#9517, d_year#498 AS dyear#9518, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9519, c AS sale_type#9520]
               :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :           :        +- Join Inner
               :           :           :- Join Inner
               :           :           :  :- SubqueryAlias `customer`
               :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :           :  +- SubqueryAlias `catalog_sales`
               :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :           :           +- SubqueryAlias `date_dim`
               :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9521, c_first_name#420 AS customer_first_name#9522, c_last_name#421 AS customer_last_name#9523, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9524, c_birth_country#426 AS customer_birth_country#9525, c_login#427 AS customer_login#9526, c_email_address#428 AS customer_email_address#9527, d_year#498 AS dyear#9528, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9529, w AS sale_type#9530]
               :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :                 +- Join Inner
               :                    :- Join Inner
               :                    :  :- SubqueryAlias `customer`
               :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :                    :  +- SubqueryAlias `web_sales`
               :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `t_w_secyear`
                  +- SubqueryAlias `year_total`
                     +- Union
                        :- Union
                        :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9574, c_first_name#420 AS customer_first_name#9575, c_last_name#421 AS customer_last_name#9576, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9577, c_birth_country#426 AS customer_birth_country#9578, c_login#427 AS customer_login#9579, c_email_address#428 AS customer_email_address#9580, d_year#498 AS dyear#9581, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9582, s AS sale_type#9583]
                        :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
                        :  :     +- Join Inner
                        :  :        :- Join Inner
                        :  :        :  :- SubqueryAlias `customer`
                        :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :        :  +- SubqueryAlias `store_sales`
                        :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :        +- SubqueryAlias `date_dim`
                        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9511, c_first_name#420 AS customer_first_name#9512, c_last_name#421 AS customer_last_name#9513, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9514, c_birth_country#426 AS customer_birth_country#9515, c_login#427 AS customer_login#9516, c_email_address#428 AS customer_email_address#9517, d_year#498 AS dyear#9518, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9519, c AS sale_type#9520]
                        :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
                        :        +- Join Inner
                        :           :- Join Inner
                        :           :  :- SubqueryAlias `customer`
                        :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :           :  +- SubqueryAlias `catalog_sales`
                        :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :           +- SubqueryAlias `date_dim`
                        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9521, c_first_name#420 AS customer_first_name#9522, c_last_name#421 AS customer_last_name#9523, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9524, c_birth_country#426 AS customer_birth_country#9525, c_login#427 AS customer_login#9526, c_email_address#428 AS customer_email_address#9527, d_year#498 AS dyear#9528, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9529, w AS sale_type#9530]
                           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `customer`
                                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                                 :  +- SubqueryAlias `web_sales`
                                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 268.65036112999996s
Running execution q5-v2.4 iteration: 1, StandardRun=true
19/09/08 18:55:52 INFO Query:
== Query: q5-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#9985 ASC NULLS FIRST, id#9986 ASC NULLS FIRST], true
      +- Aggregate [channel#9985, id#9986, spark_grouping_id#9982], [channel#9985, id#9986, sum(sales#9931) AS sales#9916, sum(returns#9933) AS returns#9917, sum(profit#9909) AS profit#9918]
         +- Expand [List(channel#9907, id#9908, sales#9931, returns#9933, profit#9909, channel#9983, id#9984, 0), List(channel#9907, id#9908, sales#9931, returns#9933, profit#9909, channel#9983, null, 1), List(channel#9907, id#9908, sales#9931, returns#9933, profit#9909, null, null, 3)], [channel#9907, id#9908, sales#9931, returns#9933, profit#9909, channel#9985, id#9986, spark_grouping_id#9982]
            +- Project [channel#9907, id#9908, sales#9931, returns#9933, profit#9909, channel#9907 AS channel#9983, id#9908 AS id#9984]
               +- SubqueryAlias `x`
                  +- Union
                     :- Union
                     :  :- Project [store channel AS channel#9907, concat(store, s_store_id#665) AS id#9908, sales#9931, returns#9933, CheckOverflow((promote_precision(cast(profit#9932 as decimal(18,2))) - promote_precision(cast(profit_loss#9934 as decimal(18,2)))), DecimalType(18,2)) AS profit#9909]
                     :  :  +- SubqueryAlias `ssr`
                     :  :     +- Aggregate [s_store_id#665], [s_store_id#665, sum(sales_price#9921) AS sales#9931, sum(profit#9922) AS profit#9932, sum(return_amt#9923) AS returns#9933, sum(net_loss#9924) AS profit_loss#9934]
                     :  :        +- Filter (((date_sk#9920 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 2 weeks as date)))) && (store_sk#9919 = s_store_sk#664))
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- SubqueryAlias `salesreturns`
                     :  :              :  :  +- Union
                     :  :              :  :     :- Project [ss_store_sk#137 AS store_sk#9919, ss_sold_date_sk#130 AS date_sk#9920, ss_ext_sales_price#145 AS sales_price#9921, ss_net_profit#152 AS profit#9922, cast(0 as decimal(7,2)) AS return_amt#9923, cast(0 as decimal(7,2)) AS net_loss#9924]
                     :  :              :  :     :  +- SubqueryAlias `store_sales`
                     :  :              :  :     :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :              :  :     +- Project [sr_store_sk#183 AS store_sk#9925, sr_returned_date_sk#176 AS date_sk#9926, cast(0 as decimal(7,2)) AS sales_price#9927, cast(0 as decimal(7,2)) AS profit#9928, sr_return_amt#187 AS return_amt#9929, sr_net_loss#195 AS net_loss#9930]
                     :  :              :  :        +- SubqueryAlias `store_returns`
                     :  :              :  :           +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :              :  +- SubqueryAlias `date_dim`
                     :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :              +- SubqueryAlias `store`
                     :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  +- Project [catalog channel AS channel#9910, concat(catalog_page, cp_catalog_page_id#395) AS id#9911, sales#9947, returns#9949, CheckOverflow((promote_precision(cast(profit#9948 as decimal(18,2))) - promote_precision(cast(profit_loss#9950 as decimal(18,2)))), DecimalType(18,2)) AS profit#9912]
                     :     +- SubqueryAlias `csr`
                     :        +- Aggregate [cp_catalog_page_id#395], [cp_catalog_page_id#395, sum(sales_price#9937) AS sales#9947, sum(profit#9938) AS profit#9948, sum(return_amt#9939) AS returns#9949, sum(net_loss#9940) AS profit_loss#9950]
                     :           +- Filter (((date_sk#9936 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 2 weeks as date)))) && (page_sk#9935 = cp_catalog_page_sk#394))
                     :              +- Join Inner
                     :                 :- Join Inner
                     :                 :  :- SubqueryAlias `salesreturns`
                     :                 :  :  +- Union
                     :                 :  :     :- Project [cs_catalog_page_sk#12 AS page_sk#9935, cs_sold_date_sk#0 AS date_sk#9936, cs_ext_sales_price#23 AS sales_price#9937, cs_net_profit#33 AS profit#9938, cast(0 as decimal(7,2)) AS return_amt#9939, cast(0 as decimal(7,2)) AS net_loss#9940]
                     :                 :  :     :  +- SubqueryAlias `catalog_sales`
                     :                 :  :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :                 :  :     +- Project [cr_catalog_page_sk#80 AS page_sk#9941, cr_returned_date_sk#68 AS date_sk#9942, cast(0 as decimal(7,2)) AS sales_price#9943, cast(0 as decimal(7,2)) AS profit#9944, cr_return_amount#86 AS return_amt#9945, cr_net_loss#94 AS net_loss#9946]
                     :                 :  :        +- SubqueryAlias `catalog_returns`
                     :                 :  :           +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                     :                 :  +- SubqueryAlias `date_dim`
                     :                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :                 +- SubqueryAlias `catalog_page`
                     :                    +- Relation[cp_catalog_page_sk#394,cp_catalog_page_id#395,cp_start_date_sk#396,cp_end_date_sk#397,cp_department#398,cp_catalog_number#399,cp_catalog_page_number#400,cp_description#401,cp_type#402] parquet
                     +- Project [web channel AS channel#9913, concat(web_site, web_site_id#799) AS id#9914, sales#9963, returns#9965, CheckOverflow((promote_precision(cast(profit#9964 as decimal(18,2))) - promote_precision(cast(profit_loss#9966 as decimal(18,2)))), DecimalType(18,2)) AS profit#9915]
                        +- SubqueryAlias `wsr`
                           +- Aggregate [web_site_id#799], [web_site_id#799, sum(sales_price#9953) AS sales#9963, sum(profit#9954) AS profit#9964, sum(return_amt#9955) AS returns#9965, sum(net_loss#9956) AS profit_loss#9966]
                              +- Filter (((date_sk#9952 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 2 weeks as date)))) && (wsr_web_site_sk#9951 = web_site_sk#798))
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- SubqueryAlias `salesreturns`
                                    :  :  +- Union
                                    :  :     :- Project [ws_web_site_sk#229 AS wsr_web_site_sk#9951, ws_sold_date_sk#216 AS date_sk#9952, ws_ext_sales_price#239 AS sales_price#9953, ws_net_profit#249 AS profit#9954, cast(0 as decimal(7,2)) AS return_amt#9955, cast(0 as decimal(7,2)) AS net_loss#9956]
                                    :  :     :  +- SubqueryAlias `web_sales`
                                    :  :     :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  :     +- Project [ws_web_site_sk#229 AS wsr_web_site_sk#9957, wr_returned_date_sk#284 AS date_sk#9958, cast(0 as decimal(7,2)) AS sales_price#9959, cast(0 as decimal(7,2)) AS profit#9960, wr_return_amt#299 AS return_amt#9961, wr_net_loss#307 AS net_loss#9962]
                                    :  :        +- Join LeftOuter, ((wr_item_sk#286 = ws_item_sk#219) && (wr_order_number#297L = ws_order_number#233L))
                                    :  :           :- SubqueryAlias `web_returns`
                                    :  :           :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                                    :  :           +- SubqueryAlias `web_sales`
                                    :  :              +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  +- SubqueryAlias `date_dim`
                                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                    +- SubqueryAlias `web_site`
                                       +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet

     : benchmark
19/09/08 18:55:52 INFO Query:
== Query: q5-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#10072 ASC NULLS FIRST, id#10073 ASC NULLS FIRST], true
      +- Aggregate [channel#10072, id#10073, spark_grouping_id#10069], [channel#10072, id#10073, sum(sales#10018) AS sales#10003, sum(returns#10020) AS returns#10004, sum(profit#9996) AS profit#10005]
         +- Expand [List(channel#9994, id#9995, sales#10018, returns#10020, profit#9996, channel#10070, id#10071, 0), List(channel#9994, id#9995, sales#10018, returns#10020, profit#9996, channel#10070, null, 1), List(channel#9994, id#9995, sales#10018, returns#10020, profit#9996, null, null, 3)], [channel#9994, id#9995, sales#10018, returns#10020, profit#9996, channel#10072, id#10073, spark_grouping_id#10069]
            +- Project [channel#9994, id#9995, sales#10018, returns#10020, profit#9996, channel#9994 AS channel#10070, id#9995 AS id#10071]
               +- SubqueryAlias `x`
                  +- Union
                     :- Union
                     :  :- Project [store channel AS channel#9994, concat(store, s_store_id#665) AS id#9995, sales#10018, returns#10020, CheckOverflow((promote_precision(cast(profit#10019 as decimal(18,2))) - promote_precision(cast(profit_loss#10021 as decimal(18,2)))), DecimalType(18,2)) AS profit#9996]
                     :  :  +- SubqueryAlias `ssr`
                     :  :     +- Aggregate [s_store_id#665], [s_store_id#665, sum(sales_price#10008) AS sales#10018, sum(profit#10009) AS profit#10019, sum(return_amt#10010) AS returns#10020, sum(net_loss#10011) AS profit_loss#10021]
                     :  :        +- Filter (((date_sk#10007 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 2 weeks as date)))) && (store_sk#10006 = s_store_sk#664))
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- SubqueryAlias `salesreturns`
                     :  :              :  :  +- Union
                     :  :              :  :     :- Project [ss_store_sk#137 AS store_sk#10006, ss_sold_date_sk#130 AS date_sk#10007, ss_ext_sales_price#145 AS sales_price#10008, ss_net_profit#152 AS profit#10009, cast(0 as decimal(7,2)) AS return_amt#10010, cast(0 as decimal(7,2)) AS net_loss#10011]
                     :  :              :  :     :  +- SubqueryAlias `store_sales`
                     :  :              :  :     :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :              :  :     +- Project [sr_store_sk#183 AS store_sk#10012, sr_returned_date_sk#176 AS date_sk#10013, cast(0 as decimal(7,2)) AS sales_price#10014, cast(0 as decimal(7,2)) AS profit#10015, sr_return_amt#187 AS return_amt#10016, sr_net_loss#195 AS net_loss#10017]
                     :  :              :  :        +- SubqueryAlias `store_returns`
                     :  :              :  :           +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :              :  +- SubqueryAlias `date_dim`
                     :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :              +- SubqueryAlias `store`
                     :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  +- Project [catalog channel AS channel#9997, concat(catalog_page, cp_catalog_page_id#395) AS id#9998, sales#10034, returns#10036, CheckOverflow((promote_precision(cast(profit#10035 as decimal(18,2))) - promote_precision(cast(profit_loss#10037 as decimal(18,2)))), DecimalType(18,2)) AS profit#9999]
                     :     +- SubqueryAlias `csr`
                     :        +- Aggregate [cp_catalog_page_id#395], [cp_catalog_page_id#395, sum(sales_price#10024) AS sales#10034, sum(profit#10025) AS profit#10035, sum(return_amt#10026) AS returns#10036, sum(net_loss#10027) AS profit_loss#10037]
                     :           +- Filter (((date_sk#10023 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 2 weeks as date)))) && (page_sk#10022 = cp_catalog_page_sk#394))
                     :              +- Join Inner
                     :                 :- Join Inner
                     :                 :  :- SubqueryAlias `salesreturns`
                     :                 :  :  +- Union
                     :                 :  :     :- Project [cs_catalog_page_sk#12 AS page_sk#10022, cs_sold_date_sk#0 AS date_sk#10023, cs_ext_sales_price#23 AS sales_price#10024, cs_net_profit#33 AS profit#10025, cast(0 as decimal(7,2)) AS return_amt#10026, cast(0 as decimal(7,2)) AS net_loss#10027]
                     :                 :  :     :  +- SubqueryAlias `catalog_sales`
                     :                 :  :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :                 :  :     +- Project [cr_catalog_page_sk#80 AS page_sk#10028, cr_returned_date_sk#68 AS date_sk#10029, cast(0 as decimal(7,2)) AS sales_price#10030, cast(0 as decimal(7,2)) AS profit#10031, cr_return_amount#86 AS return_amt#10032, cr_net_loss#94 AS net_loss#10033]
                     :                 :  :        +- SubqueryAlias `catalog_returns`
                     :                 :  :           +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                     :                 :  +- SubqueryAlias `date_dim`
                     :                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :                 +- SubqueryAlias `catalog_page`
                     :                    +- Relation[cp_catalog_page_sk#394,cp_catalog_page_id#395,cp_start_date_sk#396,cp_end_date_sk#397,cp_department#398,cp_catalog_number#399,cp_catalog_page_number#400,cp_description#401,cp_type#402] parquet
                     +- Project [web channel AS channel#10000, concat(web_site, web_site_id#799) AS id#10001, sales#10050, returns#10052, CheckOverflow((promote_precision(cast(profit#10051 as decimal(18,2))) - promote_precision(cast(profit_loss#10053 as decimal(18,2)))), DecimalType(18,2)) AS profit#10002]
                        +- SubqueryAlias `wsr`
                           +- Aggregate [web_site_id#799], [web_site_id#799, sum(sales_price#10040) AS sales#10050, sum(profit#10041) AS profit#10051, sum(return_amt#10042) AS returns#10052, sum(net_loss#10043) AS profit_loss#10053]
                              +- Filter (((date_sk#10039 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 2 weeks as date)))) && (wsr_web_site_sk#10038 = web_site_sk#798))
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- SubqueryAlias `salesreturns`
                                    :  :  +- Union
                                    :  :     :- Project [ws_web_site_sk#229 AS wsr_web_site_sk#10038, ws_sold_date_sk#216 AS date_sk#10039, ws_ext_sales_price#239 AS sales_price#10040, ws_net_profit#249 AS profit#10041, cast(0 as decimal(7,2)) AS return_amt#10042, cast(0 as decimal(7,2)) AS net_loss#10043]
                                    :  :     :  +- SubqueryAlias `web_sales`
                                    :  :     :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  :     +- Project [ws_web_site_sk#229 AS wsr_web_site_sk#10044, wr_returned_date_sk#284 AS date_sk#10045, cast(0 as decimal(7,2)) AS sales_price#10046, cast(0 as decimal(7,2)) AS profit#10047, wr_return_amt#299 AS return_amt#10048, wr_net_loss#307 AS net_loss#10049]
                                    :  :        +- Join LeftOuter, ((wr_item_sk#286 = ws_item_sk#219) && (wr_order_number#297L = ws_order_number#233L))
                                    :  :           :- SubqueryAlias `web_returns`
                                    :  :           :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                                    :  :           +- SubqueryAlias `web_sales`
                                    :  :              +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  +- SubqueryAlias `date_dim`
                                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                    +- SubqueryAlias `web_site`
                                       +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 63.173913617s
Running execution q6-v2.4 iteration: 1, StandardRun=true
19/09/08 18:56:58 INFO Query:
== Query: q6-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cnt#10307L ASC NULLS FIRST], true
      +- Project [state#10306, cnt#10307L]
         +- Filter (cnt#10307L >= cast(10 as bigint))
            +- SubqueryAlias `x`
               +- Aggregate [ca_state#456], [ca_state#456 AS state#10306, count(1) AS cnt#10307L]
                  +- Filter ((((ca_address_sk#448 = c_current_addr_sk#416) && (c_customer_sk#412 = ss_customer_sk#133)) && (ss_sold_date_sk#130 = d_date_sk#492)) && (((ss_item_sk#132 = i_item_sk#564) && (d_month_seq#495 = scalar-subquery#10308 [])) && (cast(i_current_price#569 as decimal(14,7)) > cast(CheckOverflow((promote_precision(cast(1.2 as decimal(11,6))) * promote_precision(cast(scalar-subquery#10309 [i_category#576] as decimal(11,6)))), DecimalType(14,7)) as decimal(14,7)))))
                     :  :- Distinct
                     :  :  +- Project [d_month_seq#495]
                     :  :     +- Filter ((d_year#498 = 2001) && (d_moy#500 = 1))
                     :  :        +- SubqueryAlias `date_dim`
                     :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- Aggregate [avg(i_current_price#569) AS avg(i_current_price)#10312]
                     :     +- Filter (i_category#576 = outer(i_category#576))
                     :        +- SubqueryAlias `j`
                     :           +- SubqueryAlias `item`
                     :              +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- SubqueryAlias `a`
                        :  :  :  :  +- SubqueryAlias `customer_address`
                        :  :  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `c`
                        :  :  :     +- SubqueryAlias `customer`
                        :  :  :        +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  +- SubqueryAlias `s`
                        :  :     +- SubqueryAlias `store_sales`
                        :  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  +- SubqueryAlias `d`
                        :     +- SubqueryAlias `date_dim`
                        :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- SubqueryAlias `i`
                           +- SubqueryAlias `item`
                              +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 18:56:58 INFO Query:
== Query: q6-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cnt#10316L ASC NULLS FIRST], true
      +- Project [state#10315, cnt#10316L]
         +- Filter (cnt#10316L >= cast(10 as bigint))
            +- SubqueryAlias `x`
               +- Aggregate [ca_state#456], [ca_state#456 AS state#10315, count(1) AS cnt#10316L]
                  +- Filter ((((ca_address_sk#448 = c_current_addr_sk#416) && (c_customer_sk#412 = ss_customer_sk#133)) && (ss_sold_date_sk#130 = d_date_sk#492)) && (((ss_item_sk#132 = i_item_sk#564) && (d_month_seq#495 = scalar-subquery#10317 [])) && (cast(i_current_price#569 as decimal(14,7)) > cast(CheckOverflow((promote_precision(cast(1.2 as decimal(11,6))) * promote_precision(cast(scalar-subquery#10318 [i_category#576] as decimal(11,6)))), DecimalType(14,7)) as decimal(14,7)))))
                     :  :- Distinct
                     :  :  +- Project [d_month_seq#495]
                     :  :     +- Filter ((d_year#498 = 2001) && (d_moy#500 = 1))
                     :  :        +- SubqueryAlias `date_dim`
                     :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- Aggregate [avg(i_current_price#569) AS avg(i_current_price)#10321]
                     :     +- Filter (i_category#576 = outer(i_category#576))
                     :        +- SubqueryAlias `j`
                     :           +- SubqueryAlias `item`
                     :              +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- SubqueryAlias `a`
                        :  :  :  :  +- SubqueryAlias `customer_address`
                        :  :  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `c`
                        :  :  :     +- SubqueryAlias `customer`
                        :  :  :        +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  +- SubqueryAlias `s`
                        :  :     +- SubqueryAlias `store_sales`
                        :  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  +- SubqueryAlias `d`
                        :     +- SubqueryAlias `date_dim`
                        :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- SubqueryAlias `i`
                           +- SubqueryAlias `item`
                              +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 55.365758087s
Running execution q7-v2.4 iteration: 1, StandardRun=true
19/09/08 18:57:54 INFO Query:
== Query: q7-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, agg1#10380, agg2#10381, agg3#10382, agg4#10383]
      +- Sort [i_item_id#565 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565], [i_item_id#565, avg(cast(ss_quantity#140 as bigint)) AS agg1#10380, avg(ss_list_price#142) AS agg2#10381, avg(ss_coupon_amt#149) AS agg3#10382, avg(ss_sales_price#143) AS agg4#10383]
            +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && (ss_cdemo_sk#134 = cd_demo_sk#474)) && ((ss_promo_sk#138 = p_promo_sk#608) && (cd_gender#475 = M))) && (((cd_marital_status#476 = S) && (cd_education_status#477 = College)) && (((p_channel_email#617 = N) || (p_channel_event#622 = N)) && (d_year#498 = 2000))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  +- SubqueryAlias `customer_demographics`
                  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `promotion`
                     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet

     : benchmark
19/09/08 18:57:54 INFO Query:
== Query: q7-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, agg1#10394, agg2#10395, agg3#10396, agg4#10397]
      +- Sort [i_item_id#565 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565], [i_item_id#565, avg(cast(ss_quantity#140 as bigint)) AS agg1#10394, avg(ss_list_price#142) AS agg2#10395, avg(ss_coupon_amt#149) AS agg3#10396, avg(ss_sales_price#143) AS agg4#10397]
            +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && (ss_cdemo_sk#134 = cd_demo_sk#474)) && ((ss_promo_sk#138 = p_promo_sk#608) && (cd_gender#475 = M))) && (((cd_marital_status#476 = S) && (cd_education_status#477 = College)) && (((p_channel_email#617 = N) || (p_channel_event#622 = N)) && (d_year#498 = 2000))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  +- SubqueryAlias `customer_demographics`
                  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `promotion`
                     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet

      running Thread[benchmark runner,5,main]
Execution time: 19.272139716s
Running execution q8-v2.4 iteration: 1, StandardRun=true
19/09/08 18:58:15 INFO Query:
== Query: q8-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [s_store_name#669, sum(ss_net_profit)#10486]
      +- Sort [s_store_name#669 ASC NULLS FIRST], true
         +- Aggregate [s_store_name#669], [s_store_name#669, sum(ss_net_profit#152) AS sum(ss_net_profit)#10486]
            +- Filter ((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (d_qoy#502 = 2)) && ((d_year#498 = 1998) && (substring(s_zip#689, 1, 2) = substring(ca_zip#10476, 1, 2))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `store`
                  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  +- SubqueryAlias `V1`
                     +- Project [ca_zip#10476]
                        +- SubqueryAlias `A2`
                           +- Intersect false
                              :- Project [substring(ca_zip#457, 1, 5) AS ca_zip#10476]
                              :  +- Filter substring(ca_zip#457, 1, 5) IN (24128,76232,65084,87816,83926,77556,20548,26231,43848,15126,91137,61265,98294,25782,17920,18426,98235,40081,84093,28577,55565,17183,54601,67897,22752,86284,18376,38607,45200,21756,29741,96765,23932,89360,29839,25989,28898,91068,72550,10390,18845,47770,82636,41367,76638,86198,81312,37126,39192,88424,72175,81426,53672,10445,42666,66864,66708,41248,48583,82276,18842,78890,49448,14089,38122,34425,79077,19849,43285,39861,66162,77610,13695,99543,83444,83041,12305,57665,68341,25003,57834,62878,49130,81096,18840,27700,23470,50412,21195,16021,76107,71954,68309,18119,98359,64544,10336,86379,27068,39736,98569,28915,24206,56529,57647,54917,42961,91110,63981,14922,36420,23006,67467,32754,30903,20260,31671,51798,72325,85816,68621,13955,36446,41766,68806,16725,15146,22744,35850,88086,51649,18270,52867,39972,96976,63792,11376,94898,13595,10516,90225,58943,39371,94945,28587,96576,57855,28488,26105,83933,25858,34322,44438,73171,30122,34102,22685,71256,78451,54364,13354,45375,40558,56458,28286,45266,47305,69399,83921,26233,11101,15371,69913,35942,15882,25631,24610,44165,99076,33786,70738,26653,14328,72305,62496,22152,10144,64147,48425,14663,21076,18799,30450,63089,81019,68893,24996,51200,51211,45692,92712,70466,79994,22437,25280,38935,71791,73134,56571,14060,19505,72425,56575,74351,68786,51650,20004,18383,76614,11634,18906,15765,41368,73241,76698,78567,97189,28545,76231,75691,22246,51061,90578,56691,68014,51103,94167,57047,14867,73520,15734,63435,25733,35474,24676,94627,53535,17879,15559,53268,59166,11928,59402,33282,45721,43933,68101,33515,36634,71286,19736,58058,55253,67473,41918,19515,36495,19430,22351,77191,91393,49156,50298,87501,18652,53179,18767,63193,23968,65164,68880,21286,72823,58470,67301,13394,31016,70372,67030,40604,24317,45748,39127,26065,77721,31029,31880,60576,24671,45549,13376,50016,33123,19769,22927,97789,46081,72151,15723,46136,51949,68100,96888,64528,14171,79777,28709,11489,25103,32213,78668,22245,15798,27156,37930,62971,21337,51622,67853,10567,38415,15455,58263,42029,60279,37125,56240,88190,50308,26859,64457,89091,82136,62377,36233,63837,58078,17043,30010,60099,28810,98025,29178,87343,73273,30469,64034,39516,86057,21309,90257,67875,40162,11356,73650,61810,72013,30431,22461,19512,13375,55307,30625,83849,68908,26689,96451,38193,46820,88885,84935,69035,83144,47537,56616,94983,48033,69952,25486,61547,27385,61860,58048,56910,16807,17871,35258,31387,35458,35576)
                              :     +- SubqueryAlias `customer_address`
                              :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- Project [ca_zip#10477]
                                 +- SubqueryAlias `A1`
                                    +- Project [ca_zip#10477, cnt#10478L]
                                       +- Filter (count(1)#10482L > cast(10 as bigint))
                                          +- Aggregate [ca_zip#457], [substring(ca_zip#457, 1, 5) AS ca_zip#10477, count(1) AS cnt#10478L, count(1) AS count(1)#10482L]
                                             +- Filter ((ca_address_sk#448 = c_current_addr_sk#416) && (c_preferred_cust_flag#422 = Y))
                                                +- Join Inner
                                                   :- SubqueryAlias `customer_address`
                                                   :  +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                                                   +- SubqueryAlias `customer`
                                                      +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/09/08 18:58:15 INFO Query:
== Query: q8-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [s_store_name#669, sum(ss_net_profit)#10505]
      +- Sort [s_store_name#669 ASC NULLS FIRST], true
         +- Aggregate [s_store_name#669], [s_store_name#669, sum(ss_net_profit#152) AS sum(ss_net_profit)#10505]
            +- Filter ((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (d_qoy#502 = 2)) && ((d_year#498 = 1998) && (substring(s_zip#689, 1, 2) = substring(ca_zip#10495, 1, 2))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `store`
                  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  +- SubqueryAlias `V1`
                     +- Project [ca_zip#10495]
                        +- SubqueryAlias `A2`
                           +- Intersect false
                              :- Project [substring(ca_zip#457, 1, 5) AS ca_zip#10495]
                              :  +- Filter substring(ca_zip#457, 1, 5) IN (24128,76232,65084,87816,83926,77556,20548,26231,43848,15126,91137,61265,98294,25782,17920,18426,98235,40081,84093,28577,55565,17183,54601,67897,22752,86284,18376,38607,45200,21756,29741,96765,23932,89360,29839,25989,28898,91068,72550,10390,18845,47770,82636,41367,76638,86198,81312,37126,39192,88424,72175,81426,53672,10445,42666,66864,66708,41248,48583,82276,18842,78890,49448,14089,38122,34425,79077,19849,43285,39861,66162,77610,13695,99543,83444,83041,12305,57665,68341,25003,57834,62878,49130,81096,18840,27700,23470,50412,21195,16021,76107,71954,68309,18119,98359,64544,10336,86379,27068,39736,98569,28915,24206,56529,57647,54917,42961,91110,63981,14922,36420,23006,67467,32754,30903,20260,31671,51798,72325,85816,68621,13955,36446,41766,68806,16725,15146,22744,35850,88086,51649,18270,52867,39972,96976,63792,11376,94898,13595,10516,90225,58943,39371,94945,28587,96576,57855,28488,26105,83933,25858,34322,44438,73171,30122,34102,22685,71256,78451,54364,13354,45375,40558,56458,28286,45266,47305,69399,83921,26233,11101,15371,69913,35942,15882,25631,24610,44165,99076,33786,70738,26653,14328,72305,62496,22152,10144,64147,48425,14663,21076,18799,30450,63089,81019,68893,24996,51200,51211,45692,92712,70466,79994,22437,25280,38935,71791,73134,56571,14060,19505,72425,56575,74351,68786,51650,20004,18383,76614,11634,18906,15765,41368,73241,76698,78567,97189,28545,76231,75691,22246,51061,90578,56691,68014,51103,94167,57047,14867,73520,15734,63435,25733,35474,24676,94627,53535,17879,15559,53268,59166,11928,59402,33282,45721,43933,68101,33515,36634,71286,19736,58058,55253,67473,41918,19515,36495,19430,22351,77191,91393,49156,50298,87501,18652,53179,18767,63193,23968,65164,68880,21286,72823,58470,67301,13394,31016,70372,67030,40604,24317,45748,39127,26065,77721,31029,31880,60576,24671,45549,13376,50016,33123,19769,22927,97789,46081,72151,15723,46136,51949,68100,96888,64528,14171,79777,28709,11489,25103,32213,78668,22245,15798,27156,37930,62971,21337,51622,67853,10567,38415,15455,58263,42029,60279,37125,56240,88190,50308,26859,64457,89091,82136,62377,36233,63837,58078,17043,30010,60099,28810,98025,29178,87343,73273,30469,64034,39516,86057,21309,90257,67875,40162,11356,73650,61810,72013,30431,22461,19512,13375,55307,30625,83849,68908,26689,96451,38193,46820,88885,84935,69035,83144,47537,56616,94983,48033,69952,25486,61547,27385,61860,58048,56910,16807,17871,35258,31387,35458,35576)
                              :     +- SubqueryAlias `customer_address`
                              :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- Project [ca_zip#10496]
                                 +- SubqueryAlias `A1`
                                    +- Project [ca_zip#10496, cnt#10497L]
                                       +- Filter (count(1)#10501L > cast(10 as bigint))
                                          +- Aggregate [ca_zip#457], [substring(ca_zip#457, 1, 5) AS ca_zip#10496, count(1) AS cnt#10497L, count(1) AS count(1)#10501L]
                                             +- Filter ((ca_address_sk#448 = c_current_addr_sk#416) && (c_preferred_cust_flag#422 = Y))
                                                +- Join Inner
                                                   :- SubqueryAlias `customer_address`
                                                   :  +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                                                   +- SubqueryAlias `customer`
                                                      +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 14.825732599s
Running execution q9-v2.4 iteration: 1, StandardRun=true
19/09/08 18:58:32 INFO Query:
== Query: q9-v2.4 ==
Project [CASE WHEN (scalar-subquery#10702 [] > cast(74129 as bigint)) THEN scalar-subquery#10703 [] ELSE scalar-subquery#10704 [] END AS bucket1#10705, CASE WHEN (scalar-subquery#10706 [] > cast(122840 as bigint)) THEN scalar-subquery#10707 [] ELSE scalar-subquery#10708 [] END AS bucket2#10709, CASE WHEN (scalar-subquery#10710 [] > cast(56580 as bigint)) THEN scalar-subquery#10711 [] ELSE scalar-subquery#10712 [] END AS bucket3#10713, CASE WHEN (scalar-subquery#10714 [] > cast(10097 as bigint)) THEN scalar-subquery#10715 [] ELSE scalar-subquery#10716 [] END AS bucket4#10717, CASE WHEN (scalar-subquery#10718 [] > cast(165306 as bigint)) THEN scalar-subquery#10719 [] ELSE scalar-subquery#10720 [] END AS bucket5#10721]
:  :- Aggregate [count(1) AS count(1)#10723L]
:  :  +- Filter ((ss_quantity#140 >= 1) && (ss_quantity#140 <= 20))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10725]
:  :  +- Filter ((ss_quantity#140 >= 1) && (ss_quantity#140 <= 20))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10727]
:  :  +- Filter ((ss_quantity#140 >= 1) && (ss_quantity#140 <= 20))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10729L]
:  :  +- Filter ((ss_quantity#140 >= 21) && (ss_quantity#140 <= 40))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10731]
:  :  +- Filter ((ss_quantity#140 >= 21) && (ss_quantity#140 <= 40))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10733]
:  :  +- Filter ((ss_quantity#140 >= 21) && (ss_quantity#140 <= 40))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10735L]
:  :  +- Filter ((ss_quantity#140 >= 41) && (ss_quantity#140 <= 60))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10737]
:  :  +- Filter ((ss_quantity#140 >= 41) && (ss_quantity#140 <= 60))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10739]
:  :  +- Filter ((ss_quantity#140 >= 41) && (ss_quantity#140 <= 60))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10741L]
:  :  +- Filter ((ss_quantity#140 >= 61) && (ss_quantity#140 <= 80))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10743]
:  :  +- Filter ((ss_quantity#140 >= 61) && (ss_quantity#140 <= 80))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10745]
:  :  +- Filter ((ss_quantity#140 >= 61) && (ss_quantity#140 <= 80))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10747L]
:  :  +- Filter ((ss_quantity#140 >= 81) && (ss_quantity#140 <= 100))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10749]
:  :  +- Filter ((ss_quantity#140 >= 81) && (ss_quantity#140 <= 100))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  +- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10751]
:     +- Filter ((ss_quantity#140 >= 81) && (ss_quantity#140 <= 100))
:        +- SubqueryAlias `store_sales`
:           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
+- Filter (r_reason_sk#646 = 1)
   +- SubqueryAlias `reason`
      +- Relation[r_reason_sk#646,r_reason_id#647,r_reason_desc#648] parquet

     : benchmark
19/09/08 18:58:32 INFO Query:
== Query: q9-v2.4 ==
Project [CASE WHEN (scalar-subquery#10757 [] > cast(74129 as bigint)) THEN scalar-subquery#10758 [] ELSE scalar-subquery#10759 [] END AS bucket1#10760, CASE WHEN (scalar-subquery#10761 [] > cast(122840 as bigint)) THEN scalar-subquery#10762 [] ELSE scalar-subquery#10763 [] END AS bucket2#10764, CASE WHEN (scalar-subquery#10765 [] > cast(56580 as bigint)) THEN scalar-subquery#10766 [] ELSE scalar-subquery#10767 [] END AS bucket3#10768, CASE WHEN (scalar-subquery#10769 [] > cast(10097 as bigint)) THEN scalar-subquery#10770 [] ELSE scalar-subquery#10771 [] END AS bucket4#10772, CASE WHEN (scalar-subquery#10773 [] > cast(165306 as bigint)) THEN scalar-subquery#10774 [] ELSE scalar-subquery#10775 [] END AS bucket5#10776]
:  :- Aggregate [count(1) AS count(1)#10778L]
:  :  +- Filter ((ss_quantity#140 >= 1) && (ss_quantity#140 <= 20))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10780]
:  :  +- Filter ((ss_quantity#140 >= 1) && (ss_quantity#140 <= 20))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10782]
:  :  +- Filter ((ss_quantity#140 >= 1) && (ss_quantity#140 <= 20))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10784L]
:  :  +- Filter ((ss_quantity#140 >= 21) && (ss_quantity#140 <= 40))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10786]
:  :  +- Filter ((ss_quantity#140 >= 21) && (ss_quantity#140 <= 40))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10788]
:  :  +- Filter ((ss_quantity#140 >= 21) && (ss_quantity#140 <= 40))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10790L]
:  :  +- Filter ((ss_quantity#140 >= 41) && (ss_quantity#140 <= 60))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10792]
:  :  +- Filter ((ss_quantity#140 >= 41) && (ss_quantity#140 <= 60))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10794]
:  :  +- Filter ((ss_quantity#140 >= 41) && (ss_quantity#140 <= 60))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10796L]
:  :  +- Filter ((ss_quantity#140 >= 61) && (ss_quantity#140 <= 80))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10798]
:  :  +- Filter ((ss_quantity#140 >= 61) && (ss_quantity#140 <= 80))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10800]
:  :  +- Filter ((ss_quantity#140 >= 61) && (ss_quantity#140 <= 80))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10802L]
:  :  +- Filter ((ss_quantity#140 >= 81) && (ss_quantity#140 <= 100))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10804]
:  :  +- Filter ((ss_quantity#140 >= 81) && (ss_quantity#140 <= 100))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  +- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10806]
:     +- Filter ((ss_quantity#140 >= 81) && (ss_quantity#140 <= 100))
:        +- SubqueryAlias `store_sales`
:           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
+- Filter (r_reason_sk#646 = 1)
   +- SubqueryAlias `reason`
      +- Relation[r_reason_sk#646,r_reason_id#647,r_reason_desc#648] parquet

      running Thread[benchmark runner,5,main]
Execution time: 64.590482742s
Running execution q10-v2.4 iteration: 1, StandardRun=true
19/09/08 18:59:38 INFO Query:
== Query: q10-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cd_gender#475 ASC NULLS FIRST, cd_marital_status#476 ASC NULLS FIRST, cd_education_status#477 ASC NULLS FIRST, cd_purchase_estimate#478 ASC NULLS FIRST, cd_credit_rating#479 ASC NULLS FIRST, cd_dep_count#480 ASC NULLS FIRST, cd_dep_employed_count#481 ASC NULLS FIRST, cd_dep_college_count#482 ASC NULLS FIRST], true
      +- Aggregate [cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482], [cd_gender#475, cd_marital_status#476, cd_education_status#477, count(1) AS cnt1#11046L, cd_purchase_estimate#478, count(1) AS cnt2#11047L, cd_credit_rating#479, count(1) AS cnt3#11048L, cd_dep_count#480, count(1) AS cnt4#11049L, cd_dep_employed_count#481, count(1) AS cnt5#11050L, cd_dep_college_count#482, count(1) AS cnt6#11051L]
         +- Filter ((((c_current_addr_sk#416 = ca_address_sk#448) && ca_county#455 IN (Rush County,Toole County,Jefferson County,Dona Ana County,La Porte County)) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && (exists#11052 [c_customer_sk#412] && (exists#11053 [c_customer_sk#412] || exists#11054 [c_customer_sk#412])))
            :  :- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 27 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = 2002) && ((d_moy#500 >= 1) && (d_moy#500 <= (1 + 3)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `store_sales`
            :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 38 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = 2002) && ((d_moy#500 >= 1) && (d_moy#500 <= (1 + 3)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `web_sales`
            :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 38 more fields]
            :     +- Filter (((outer(c_customer_sk#412) = cs_ship_customer_sk#7) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = 2002) && ((d_moy#500 >= 1) && (d_moy#500 <= (1 + 3)))))
            :        +- Join Inner
            :           :- SubqueryAlias `catalog_sales`
            :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :           +- SubqueryAlias `date_dim`
            :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `c`
               :  :  +- SubqueryAlias `customer`
               :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  +- SubqueryAlias `ca`
               :     +- SubqueryAlias `customer_address`
               :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer_demographics`
                  +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet

     : benchmark
19/09/08 18:59:38 INFO Query:
== Query: q10-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cd_gender#475 ASC NULLS FIRST, cd_marital_status#476 ASC NULLS FIRST, cd_education_status#477 ASC NULLS FIRST, cd_purchase_estimate#478 ASC NULLS FIRST, cd_credit_rating#479 ASC NULLS FIRST, cd_dep_count#480 ASC NULLS FIRST, cd_dep_employed_count#481 ASC NULLS FIRST, cd_dep_college_count#482 ASC NULLS FIRST], true
      +- Aggregate [cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482], [cd_gender#475, cd_marital_status#476, cd_education_status#477, count(1) AS cnt1#11075L, cd_purchase_estimate#478, count(1) AS cnt2#11076L, cd_credit_rating#479, count(1) AS cnt3#11077L, cd_dep_count#480, count(1) AS cnt4#11078L, cd_dep_employed_count#481, count(1) AS cnt5#11079L, cd_dep_college_count#482, count(1) AS cnt6#11080L]
         +- Filter ((((c_current_addr_sk#416 = ca_address_sk#448) && ca_county#455 IN (Rush County,Toole County,Jefferson County,Dona Ana County,La Porte County)) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && (exists#11081 [c_customer_sk#412] && (exists#11082 [c_customer_sk#412] || exists#11083 [c_customer_sk#412])))
            :  :- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 27 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = 2002) && ((d_moy#500 >= 1) && (d_moy#500 <= (1 + 3)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `store_sales`
            :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 38 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = 2002) && ((d_moy#500 >= 1) && (d_moy#500 <= (1 + 3)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `web_sales`
            :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 38 more fields]
            :     +- Filter (((outer(c_customer_sk#412) = cs_ship_customer_sk#7) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = 2002) && ((d_moy#500 >= 1) && (d_moy#500 <= (1 + 3)))))
            :        +- Join Inner
            :           :- SubqueryAlias `catalog_sales`
            :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :           +- SubqueryAlias `date_dim`
            :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `c`
               :  :  +- SubqueryAlias `customer`
               :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  +- SubqueryAlias `ca`
               :     +- SubqueryAlias `customer_address`
               :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer_demographics`
                  +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet

      running Thread[benchmark runner,5,main]
Execution time: 21.724999276s
Running execution q11-v2.4 iteration: 1, StandardRun=true
19/09/08 19:00:02 INFO Query:
== Query: q11-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#11260 ASC NULLS FIRST, customer_first_name#11261 ASC NULLS FIRST, customer_last_name#11262 ASC NULLS FIRST, customer_preferred_cust_flag#11263 ASC NULLS FIRST], true
      +- Project [customer_id#11260, customer_first_name#11261, customer_last_name#11262, customer_preferred_cust_flag#11263]
         +- Filter (((((customer_id#11260 = customer_id#11238) && (customer_id#11238 = customer_id#11280)) && ((customer_id#11238 = customer_id#11270) && (sale_type#11247 = s))) && (((sale_type#11279 = w) && (sale_type#11269 = s)) && (sale_type#11289 = w))) && ((((dyear#11245 = 2001) && (dyear#11267 = (2001 + 1))) && ((dyear#11277 = 2001) && (dyear#11287 = (2001 + 1)))) && (((cast(year_total#11246 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2))) && (cast(year_total#11278 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2)))) && (CASE WHEN (cast(year_total#11278 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2))) THEN CheckOverflow((promote_precision(cast(year_total#11288 as decimal(18,2))) / promote_precision(cast(year_total#11278 as decimal(18,2)))), DecimalType(38,20)) ELSE cast(0.0 as decimal(38,20)) END > CASE WHEN (cast(year_total#11246 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2))) THEN CheckOverflow((promote_precision(cast(year_total#11268 as decimal(18,2))) / promote_precision(cast(year_total#11246 as decimal(18,2)))), DecimalType(38,20)) ELSE cast(0.0 as decimal(38,20)) END))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `t_s_firstyear`
               :  :  :  +- SubqueryAlias `year_total`
               :  :  :     +- Union
               :  :  :        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11238, c_first_name#420 AS customer_first_name#11239, c_last_name#421 AS customer_last_name#11240, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11241, c_birth_country#426 AS customer_birth_country#11242, c_login#427 AS customer_login#11243, c_email_address#428 AS customer_email_address#11244, d_year#498 AS dyear#11245, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11246, s AS sale_type#11247]
               :  :  :        :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :        :     +- Join Inner
               :  :  :        :        :- Join Inner
               :  :  :        :        :  :- SubqueryAlias `customer`
               :  :  :        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :        :        :  +- SubqueryAlias `store_sales`
               :  :  :        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :        :        +- SubqueryAlias `date_dim`
               :  :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11248, c_first_name#420 AS customer_first_name#11249, c_last_name#421 AS customer_last_name#11250, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11251, c_birth_country#426 AS customer_birth_country#11252, c_login#427 AS customer_login#11253, c_email_address#428 AS customer_email_address#11254, d_year#498 AS dyear#11255, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11256, w AS sale_type#11257]
               :  :  :           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :              +- Join Inner
               :  :  :                 :- Join Inner
               :  :  :                 :  :- SubqueryAlias `customer`
               :  :  :                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :                 :  +- SubqueryAlias `web_sales`
               :  :  :                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :                 +- SubqueryAlias `date_dim`
               :  :  :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  +- SubqueryAlias `t_s_secyear`
               :  :     +- SubqueryAlias `year_total`
               :  :        +- Union
               :  :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11260, c_first_name#420 AS customer_first_name#11261, c_last_name#421 AS customer_last_name#11262, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11263, c_birth_country#426 AS customer_birth_country#11264, c_login#427 AS customer_login#11265, c_email_address#428 AS customer_email_address#11266, d_year#498 AS dyear#11267, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11268, s AS sale_type#11269]
               :  :           :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :           :     +- Join Inner
               :  :           :        :- Join Inner
               :  :           :        :  :- SubqueryAlias `customer`
               :  :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :        :  +- SubqueryAlias `store_sales`
               :  :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :        +- SubqueryAlias `date_dim`
               :  :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11248, c_first_name#420 AS customer_first_name#11249, c_last_name#421 AS customer_last_name#11250, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11251, c_birth_country#426 AS customer_birth_country#11252, c_login#427 AS customer_login#11253, c_email_address#428 AS customer_email_address#11254, d_year#498 AS dyear#11255, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11256, w AS sale_type#11257]
               :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :                 +- Join Inner
               :  :                    :- Join Inner
               :  :                    :  :- SubqueryAlias `customer`
               :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :                    :  +- SubqueryAlias `web_sales`
               :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :                    +- SubqueryAlias `date_dim`
               :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `t_w_firstyear`
               :     +- SubqueryAlias `year_total`
               :        +- Union
               :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11270, c_first_name#420 AS customer_first_name#11271, c_last_name#421 AS customer_last_name#11272, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11273, c_birth_country#426 AS customer_birth_country#11274, c_login#427 AS customer_login#11275, c_email_address#428 AS customer_email_address#11276, d_year#498 AS dyear#11277, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11278, s AS sale_type#11279]
               :           :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :           :     +- Join Inner
               :           :        :- Join Inner
               :           :        :  :- SubqueryAlias `customer`
               :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :        :  +- SubqueryAlias `store_sales`
               :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11248, c_first_name#420 AS customer_first_name#11249, c_last_name#421 AS customer_last_name#11250, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11251, c_birth_country#426 AS customer_birth_country#11252, c_login#427 AS customer_login#11253, c_email_address#428 AS customer_email_address#11254, d_year#498 AS dyear#11255, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11256, w AS sale_type#11257]
               :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :                 +- Join Inner
               :                    :- Join Inner
               :                    :  :- SubqueryAlias `customer`
               :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :                    :  +- SubqueryAlias `web_sales`
               :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `t_w_secyear`
                  +- SubqueryAlias `year_total`
                     +- Union
                        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11280, c_first_name#420 AS customer_first_name#11281, c_last_name#421 AS customer_last_name#11282, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11283, c_birth_country#426 AS customer_birth_country#11284, c_login#427 AS customer_login#11285, c_email_address#428 AS customer_email_address#11286, d_year#498 AS dyear#11287, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11288, s AS sale_type#11289]
                        :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
                        :     +- Join Inner
                        :        :- Join Inner
                        :        :  :- SubqueryAlias `customer`
                        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :        :  +- SubqueryAlias `store_sales`
                        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11248, c_first_name#420 AS customer_first_name#11249, c_last_name#421 AS customer_last_name#11250, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11251, c_birth_country#426 AS customer_birth_country#11252, c_login#427 AS customer_login#11253, c_email_address#428 AS customer_email_address#11254, d_year#498 AS dyear#11255, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11256, w AS sale_type#11257]
                           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `customer`
                                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                                 :  +- SubqueryAlias `web_sales`
                                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 19:00:02 INFO Query:
== Query: q11-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#11316 ASC NULLS FIRST, customer_first_name#11317 ASC NULLS FIRST, customer_last_name#11318 ASC NULLS FIRST, customer_preferred_cust_flag#11319 ASC NULLS FIRST], true
      +- Project [customer_id#11316, customer_first_name#11317, customer_last_name#11318, customer_preferred_cust_flag#11319]
         +- Filter (((((customer_id#11316 = customer_id#11294) && (customer_id#11294 = customer_id#11336)) && ((customer_id#11294 = customer_id#11326) && (sale_type#11303 = s))) && (((sale_type#11335 = w) && (sale_type#11325 = s)) && (sale_type#11345 = w))) && ((((dyear#11301 = 2001) && (dyear#11323 = (2001 + 1))) && ((dyear#11333 = 2001) && (dyear#11343 = (2001 + 1)))) && (((cast(year_total#11302 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2))) && (cast(year_total#11334 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2)))) && (CASE WHEN (cast(year_total#11334 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2))) THEN CheckOverflow((promote_precision(cast(year_total#11344 as decimal(18,2))) / promote_precision(cast(year_total#11334 as decimal(18,2)))), DecimalType(38,20)) ELSE cast(0.0 as decimal(38,20)) END > CASE WHEN (cast(year_total#11302 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2))) THEN CheckOverflow((promote_precision(cast(year_total#11324 as decimal(18,2))) / promote_precision(cast(year_total#11302 as decimal(18,2)))), DecimalType(38,20)) ELSE cast(0.0 as decimal(38,20)) END))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `t_s_firstyear`
               :  :  :  +- SubqueryAlias `year_total`
               :  :  :     +- Union
               :  :  :        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11294, c_first_name#420 AS customer_first_name#11295, c_last_name#421 AS customer_last_name#11296, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11297, c_birth_country#426 AS customer_birth_country#11298, c_login#427 AS customer_login#11299, c_email_address#428 AS customer_email_address#11300, d_year#498 AS dyear#11301, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11302, s AS sale_type#11303]
               :  :  :        :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :        :     +- Join Inner
               :  :  :        :        :- Join Inner
               :  :  :        :        :  :- SubqueryAlias `customer`
               :  :  :        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :        :        :  +- SubqueryAlias `store_sales`
               :  :  :        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :        :        +- SubqueryAlias `date_dim`
               :  :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11304, c_first_name#420 AS customer_first_name#11305, c_last_name#421 AS customer_last_name#11306, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11307, c_birth_country#426 AS customer_birth_country#11308, c_login#427 AS customer_login#11309, c_email_address#428 AS customer_email_address#11310, d_year#498 AS dyear#11311, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11312, w AS sale_type#11313]
               :  :  :           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :              +- Join Inner
               :  :  :                 :- Join Inner
               :  :  :                 :  :- SubqueryAlias `customer`
               :  :  :                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :                 :  +- SubqueryAlias `web_sales`
               :  :  :                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :                 +- SubqueryAlias `date_dim`
               :  :  :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  +- SubqueryAlias `t_s_secyear`
               :  :     +- SubqueryAlias `year_total`
               :  :        +- Union
               :  :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11316, c_first_name#420 AS customer_first_name#11317, c_last_name#421 AS customer_last_name#11318, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11319, c_birth_country#426 AS customer_birth_country#11320, c_login#427 AS customer_login#11321, c_email_address#428 AS customer_email_address#11322, d_year#498 AS dyear#11323, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11324, s AS sale_type#11325]
               :  :           :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :           :     +- Join Inner
               :  :           :        :- Join Inner
               :  :           :        :  :- SubqueryAlias `customer`
               :  :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :        :  +- SubqueryAlias `store_sales`
               :  :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :        +- SubqueryAlias `date_dim`
               :  :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11304, c_first_name#420 AS customer_first_name#11305, c_last_name#421 AS customer_last_name#11306, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11307, c_birth_country#426 AS customer_birth_country#11308, c_login#427 AS customer_login#11309, c_email_address#428 AS customer_email_address#11310, d_year#498 AS dyear#11311, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11312, w AS sale_type#11313]
               :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :                 +- Join Inner
               :  :                    :- Join Inner
               :  :                    :  :- SubqueryAlias `customer`
               :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :                    :  +- SubqueryAlias `web_sales`
               :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :                    +- SubqueryAlias `date_dim`
               :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `t_w_firstyear`
               :     +- SubqueryAlias `year_total`
               :        +- Union
               :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11326, c_first_name#420 AS customer_first_name#11327, c_last_name#421 AS customer_last_name#11328, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11329, c_birth_country#426 AS customer_birth_country#11330, c_login#427 AS customer_login#11331, c_email_address#428 AS customer_email_address#11332, d_year#498 AS dyear#11333, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11334, s AS sale_type#11335]
               :           :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :           :     +- Join Inner
               :           :        :- Join Inner
               :           :        :  :- SubqueryAlias `customer`
               :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :        :  +- SubqueryAlias `store_sales`
               :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11304, c_first_name#420 AS customer_first_name#11305, c_last_name#421 AS customer_last_name#11306, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11307, c_birth_country#426 AS customer_birth_country#11308, c_login#427 AS customer_login#11309, c_email_address#428 AS customer_email_address#11310, d_year#498 AS dyear#11311, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11312, w AS sale_type#11313]
               :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :                 +- Join Inner
               :                    :- Join Inner
               :                    :  :- SubqueryAlias `customer`
               :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :                    :  +- SubqueryAlias `web_sales`
               :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `t_w_secyear`
                  +- SubqueryAlias `year_total`
                     +- Union
                        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11336, c_first_name#420 AS customer_first_name#11337, c_last_name#421 AS customer_last_name#11338, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11339, c_birth_country#426 AS customer_birth_country#11340, c_login#427 AS customer_login#11341, c_email_address#428 AS customer_email_address#11342, d_year#498 AS dyear#11343, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11344, s AS sale_type#11345]
                        :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
                        :     +- Join Inner
                        :        :- Join Inner
                        :        :  :- SubqueryAlias `customer`
                        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :        :  +- SubqueryAlias `store_sales`
                        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11304, c_first_name#420 AS customer_first_name#11305, c_last_name#421 AS customer_last_name#11306, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11307, c_birth_country#426 AS customer_birth_country#11308, c_login#427 AS customer_login#11309, c_email_address#428 AS customer_email_address#11310, d_year#498 AS dyear#11311, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11312, w AS sale_type#11313]
                           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `customer`
                                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                                 :  +- SubqueryAlias `web_sales`
                                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 86.635199495s
Running execution q12-v2.4 iteration: 1, StandardRun=true
19/09/08 19:01:31 INFO Query:
== Query: q12-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#576 ASC NULLS FIRST, i_class#574 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, revenueratio#11497 ASC NULLS FIRST], true
      +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#11496, revenueratio#11497]
         +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#11496, _w0#11502, _w1#11503, _we0#11504, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(_w0#11502 as decimal(17,2))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(17,2)))), DecimalType(21,2)) as decimal(27,2))) / promote_precision(cast(_we0#11504 as decimal(27,2)))), DecimalType(38,17)) AS revenueratio#11497]
            +- Window [sum(_w1#11503) windowspecdefinition(i_class#574, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#11504], [i_class#574]
               +- Aggregate [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569], [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, sum(ws_ext_sales_price#239) AS itemrevenue#11496, sum(ws_ext_sales_price#239) AS _w0#11502, sum(ws_ext_sales_price#239) AS _w1#11503]
                  +- Filter (((ws_item_sk#219 = i_item_sk#564) && i_category#576 IN (Sports,Books,Home)) && ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_date#494 >= cast(1999-02-22 as date)) && (d_date#494 <= cast(cast(cast(1999-02-22 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `web_sales`
                        :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  +- SubqueryAlias `item`
                        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 19:01:31 INFO Query:
== Query: q12-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#576 ASC NULLS FIRST, i_class#574 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, revenueratio#11513 ASC NULLS FIRST], true
      +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#11512, revenueratio#11513]
         +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#11512, _w0#11518, _w1#11519, _we0#11520, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(_w0#11518 as decimal(17,2))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(17,2)))), DecimalType(21,2)) as decimal(27,2))) / promote_precision(cast(_we0#11520 as decimal(27,2)))), DecimalType(38,17)) AS revenueratio#11513]
            +- Window [sum(_w1#11519) windowspecdefinition(i_class#574, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#11520], [i_class#574]
               +- Aggregate [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569], [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, sum(ws_ext_sales_price#239) AS itemrevenue#11512, sum(ws_ext_sales_price#239) AS _w0#11518, sum(ws_ext_sales_price#239) AS _w1#11519]
                  +- Filter (((ws_item_sk#219 = i_item_sk#564) && i_category#576 IN (Sports,Books,Home)) && ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_date#494 >= cast(1999-02-22 as date)) && (d_date#494 <= cast(cast(cast(1999-02-22 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `web_sales`
                        :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  +- SubqueryAlias `item`
                        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 6.817133044s
Running execution q13-v2.4 iteration: 1, StandardRun=true
19/09/08 19:01:39 INFO Query:
== Query: q13-v2.4 ==
Aggregate [avg(cast(ss_quantity#140 as bigint)) AS avg(ss_quantity)#11593, avg(ss_ext_sales_price#145) AS avg(ss_ext_sales_price)#11594, avg(ss_ext_wholesale_cost#146) AS avg(ss_ext_wholesale_cost)#11595, sum(ss_ext_wholesale_cost#146) AS sum(ss_ext_wholesale_cost)#11596]
+- Filter ((((s_store_sk#664 = ss_store_sk#137) && (ss_sold_date_sk#130 = d_date_sk#492)) && (d_year#498 = 2001)) && (((((((ss_hdemo_sk#135 = hd_demo_sk#548) && (cd_demo_sk#474 = ss_cdemo_sk#134)) && (cd_marital_status#476 = M)) && (((cd_education_status#477 = Advanced Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(100.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(150.00 as decimal(7,2))))) && (hd_dep_count#551 = 3))) || ((((ss_hdemo_sk#135 = hd_demo_sk#548) && (cd_demo_sk#474 = ss_cdemo_sk#134)) && (cd_marital_status#476 = S)) && (((cd_education_status#477 = College) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(50.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(100.00 as decimal(7,2))))) && (hd_dep_count#551 = 1)))) || ((((ss_hdemo_sk#135 = hd_demo_sk#548) && (cd_demo_sk#474 = ss_cdemo_sk#134)) && (cd_marital_status#476 = W)) && (((cd_education_status#477 = 2 yr Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(150.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(200.00 as decimal(7,2))))) && (hd_dep_count#551 = 1)))) && (((((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (TX,OH,TX) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(100 as decimal(3,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(200 as decimal(3,0)) as decimal(7,2)))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (OR,NM,KY) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(150 as decimal(3,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(300 as decimal(3,0)) as decimal(7,2))))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (VA,TX,MS) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(250 as decimal(3,0)) as decimal(7,2)))))))))
   +- Join Inner
      :- Join Inner
      :  :- Join Inner
      :  :  :- Join Inner
      :  :  :  :- Join Inner
      :  :  :  :  :- SubqueryAlias `store_sales`
      :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
      :  :  :  :  +- SubqueryAlias `store`
      :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
      :  :  :  +- SubqueryAlias `customer_demographics`
      :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
      :  :  +- SubqueryAlias `household_demographics`
      :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
      :  +- SubqueryAlias `customer_address`
      :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
      +- SubqueryAlias `date_dim`
         +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 19:01:39 INFO Query:
== Query: q13-v2.4 ==
Aggregate [avg(cast(ss_quantity#140 as bigint)) AS avg(ss_quantity)#11605, avg(ss_ext_sales_price#145) AS avg(ss_ext_sales_price)#11606, avg(ss_ext_wholesale_cost#146) AS avg(ss_ext_wholesale_cost)#11607, sum(ss_ext_wholesale_cost#146) AS sum(ss_ext_wholesale_cost)#11608]
+- Filter ((((s_store_sk#664 = ss_store_sk#137) && (ss_sold_date_sk#130 = d_date_sk#492)) && (d_year#498 = 2001)) && (((((((ss_hdemo_sk#135 = hd_demo_sk#548) && (cd_demo_sk#474 = ss_cdemo_sk#134)) && (cd_marital_status#476 = M)) && (((cd_education_status#477 = Advanced Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(100.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(150.00 as decimal(7,2))))) && (hd_dep_count#551 = 3))) || ((((ss_hdemo_sk#135 = hd_demo_sk#548) && (cd_demo_sk#474 = ss_cdemo_sk#134)) && (cd_marital_status#476 = S)) && (((cd_education_status#477 = College) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(50.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(100.00 as decimal(7,2))))) && (hd_dep_count#551 = 1)))) || ((((ss_hdemo_sk#135 = hd_demo_sk#548) && (cd_demo_sk#474 = ss_cdemo_sk#134)) && (cd_marital_status#476 = W)) && (((cd_education_status#477 = 2 yr Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(150.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(200.00 as decimal(7,2))))) && (hd_dep_count#551 = 1)))) && (((((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (TX,OH,TX) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(100 as decimal(3,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(200 as decimal(3,0)) as decimal(7,2)))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (OR,NM,KY) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(150 as decimal(3,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(300 as decimal(3,0)) as decimal(7,2))))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (VA,TX,MS) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(250 as decimal(3,0)) as decimal(7,2)))))))))
   +- Join Inner
      :- Join Inner
      :  :- Join Inner
      :  :  :- Join Inner
      :  :  :  :- Join Inner
      :  :  :  :  :- SubqueryAlias `store_sales`
      :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
      :  :  :  :  +- SubqueryAlias `store`
      :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
      :  :  :  +- SubqueryAlias `customer_demographics`
      :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
      :  :  +- SubqueryAlias `household_demographics`
      :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
      :  +- SubqueryAlias `customer_address`
      :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
      +- SubqueryAlias `date_dim`
         +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 69.940721246s
Running execution q14a-v2.4 iteration: 1, StandardRun=true
19/09/08 19:02:53 INFO Query:
== Query: q14a-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#11832 ASC NULLS FIRST, i_brand_id#11833 ASC NULLS FIRST, i_class_id#11834 ASC NULLS FIRST, i_category_id#11835 ASC NULLS FIRST], true
      +- Aggregate [channel#11832, i_brand_id#11833, i_class_id#11834, i_category_id#11835, spark_grouping_id#11827], [channel#11832, i_brand_id#11833, i_class_id#11834, i_category_id#11835, sum(sales#11779) AS sum(sales)#11822, sum(number_sales#11780L) AS sum(number_sales)#11823L]
         +- Expand [List(channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, channel#11828, i_brand_id#11829, i_class_id#11830, i_category_id#11831, 0), List(channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, channel#11828, i_brand_id#11829, i_class_id#11830, null, 1), List(channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, channel#11828, i_brand_id#11829, null, null, 3), List(channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, channel#11828, null, null, null, 7), List(channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, null, null, null, null, 15)], [channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, channel#11832, i_brand_id#11833, i_class_id#11834, i_category_id#11835, spark_grouping_id#11827]
            +- Project [channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, channel#11778 AS channel#11828, i_brand_id#571 AS i_brand_id#11829, i_class_id#573 AS i_class_id#11830, i_category_id#575 AS i_category_id#11831]
               +- SubqueryAlias `y`
                  +- Union
                     :- Union
                     :  :- Project [channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L]
                     :  :  +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#11813 as decimal(32,6)) > cast(scalar-subquery#11782 [] as decimal(32,6)))
                     :  :     :  +- Project [average_sales#11803]
                     :  :     :     +- SubqueryAlias `avg_sales`
                     :  :     :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#11797 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#11798 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#11803]
                     :  :     :           +- SubqueryAlias `x`
                     :  :     :              +- Union
                     :  :     :                 :- Union
                     :  :     :                 :  :- Project [ss_quantity#140 AS quantity#11797, ss_list_price#142 AS list_price#11798]
                     :  :     :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= 2001)))
                     :  :     :                 :  :     +- Join Inner
                     :  :     :                 :  :        :- SubqueryAlias `store_sales`
                     :  :     :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :     :                 :  :        +- SubqueryAlias `date_dim`
                     :  :     :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :     :                 :  +- Project [cs_quantity#18 AS quantity#11799, cs_list_price#20 AS list_price#11800]
                     :  :     :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :     :                 :        +- Join Inner
                     :  :     :                 :           :- SubqueryAlias `catalog_sales`
                     :  :     :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :  :     :                 :           +- SubqueryAlias `date_dim`
                     :  :     :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :     :                 +- Project [ws_quantity#234 AS quantity#11801, ws_list_price#236 AS list_price#11802]
                     :  :     :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :     :                       +- Join Inner
                     :  :     :                          :- SubqueryAlias `web_sales`
                     :  :     :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :  :     :                          +- SubqueryAlias `date_dim`
                     :  :     :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :     +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [store AS channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sales#11779, count(1) AS number_sales#11780L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#11813]
                     :  :        +- Filter (((ss_item_sk#132 IN (list#11781 []) && (ss_item_sk#132 = i_item_sk#564)) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = (1999 + 2)) && (d_moy#500 = 11)))
                     :  :           :  +- Project [ss_item_sk#11796]
                     :  :           :     +- SubqueryAlias `cross_items`
                     :  :           :        +- Project [i_item_sk#564 AS ss_item_sk#11796]
                     :  :           :           +- Filter (((i_brand_id#571 = brand_id#11793) && (i_class_id#573 = class_id#11794)) && (i_category_id#575 = category_id#11795))
                     :  :           :              +- Join Inner
                     :  :           :                 :- SubqueryAlias `item`
                     :  :           :                 :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                 +- SubqueryAlias `x`
                     :  :           :                    +- Intersect false
                     :  :           :                       :- Intersect false
                     :  :           :                       :  :- Project [i_brand_id#571 AS brand_id#11793, i_class_id#573 AS class_id#11794, i_category_id#575 AS category_id#11795]
                     :  :           :                       :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :           :                       :  :     +- Join Inner
                     :  :           :                       :  :        :- Join Inner
                     :  :           :                       :  :        :  :- SubqueryAlias `store_sales`
                     :  :           :                       :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :           :                       :  :        :  +- SubqueryAlias `iss`
                     :  :           :                       :  :        :     +- SubqueryAlias `item`
                     :  :           :                       :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                       :  :        +- SubqueryAlias `d1`
                     :  :           :                       :  :           +- SubqueryAlias `date_dim`
                     :  :           :                       :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :           :                       :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :  :           :                       :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :           :                       :        +- Join Inner
                     :  :           :                       :           :- Join Inner
                     :  :           :                       :           :  :- SubqueryAlias `catalog_sales`
                     :  :           :                       :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :  :           :                       :           :  +- SubqueryAlias `ics`
                     :  :           :                       :           :     +- SubqueryAlias `item`
                     :  :           :                       :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                       :           +- SubqueryAlias `d2`
                     :  :           :                       :              +- SubqueryAlias `date_dim`
                     :  :           :                       :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :           :                       +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :  :           :                          +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :           :                             +- Join Inner
                     :  :           :                                :- Join Inner
                     :  :           :                                :  :- SubqueryAlias `web_sales`
                     :  :           :                                :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :  :           :                                :  +- SubqueryAlias `iws`
                     :  :           :                                :     +- SubqueryAlias `item`
                     :  :           :                                :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                                +- SubqueryAlias `d3`
                     :  :           :                                   +- SubqueryAlias `date_dim`
                     :  :           :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- SubqueryAlias `store_sales`
                     :  :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :              :  +- SubqueryAlias `item`
                     :  :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :              +- SubqueryAlias `date_dim`
                     :  :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- Project [channel#11783, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11784, number_sales#11785L]
                     :     +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2)))#11816 as decimal(32,6)) > cast(scalar-subquery#11787 [] as decimal(32,6)))
                     :        :  +- Project [average_sales#11803]
                     :        :     +- SubqueryAlias `avg_sales`
                     :        :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#11797 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#11798 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#11803]
                     :        :           +- SubqueryAlias `x`
                     :        :              +- Union
                     :        :                 :- Union
                     :        :                 :  :- Project [ss_quantity#140 AS quantity#11797, ss_list_price#142 AS list_price#11798]
                     :        :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= 2001)))
                     :        :                 :  :     +- Join Inner
                     :        :                 :  :        :- SubqueryAlias `store_sales`
                     :        :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :        :                 :  :        +- SubqueryAlias `date_dim`
                     :        :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :        :                 :  +- Project [cs_quantity#18 AS quantity#11799, cs_list_price#20 AS list_price#11800]
                     :        :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :        :                 :        +- Join Inner
                     :        :                 :           :- SubqueryAlias `catalog_sales`
                     :        :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :        :                 :           +- SubqueryAlias `date_dim`
                     :        :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :        :                 +- Project [ws_quantity#234 AS quantity#11801, ws_list_price#236 AS list_price#11802]
                     :        :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :        :                       +- Join Inner
                     :        :                          :- SubqueryAlias `web_sales`
                     :        :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :        :                          +- SubqueryAlias `date_dim`
                     :        :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :        +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [catalog AS channel#11783, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2))) AS sales#11784, count(1) AS number_sales#11785L, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2)))#11816]
                     :           +- Filter (((cs_item_sk#15 IN (list#11786 []) && (cs_item_sk#15 = i_item_sk#564)) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = (1999 + 2)) && (d_moy#500 = 11)))
                     :              :  +- Project [ss_item_sk#11796]
                     :              :     +- SubqueryAlias `cross_items`
                     :              :        +- Project [i_item_sk#564 AS ss_item_sk#11796]
                     :              :           +- Filter (((i_brand_id#571 = brand_id#11793) && (i_class_id#573 = class_id#11794)) && (i_category_id#575 = category_id#11795))
                     :              :              +- Join Inner
                     :              :                 :- SubqueryAlias `item`
                     :              :                 :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                 +- SubqueryAlias `x`
                     :              :                    +- Intersect false
                     :              :                       :- Intersect false
                     :              :                       :  :- Project [i_brand_id#571 AS brand_id#11793, i_class_id#573 AS class_id#11794, i_category_id#575 AS category_id#11795]
                     :              :                       :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :              :                       :  :     +- Join Inner
                     :              :                       :  :        :- Join Inner
                     :              :                       :  :        :  :- SubqueryAlias `store_sales`
                     :              :                       :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :              :                       :  :        :  +- SubqueryAlias `iss`
                     :              :                       :  :        :     +- SubqueryAlias `item`
                     :              :                       :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                       :  :        +- SubqueryAlias `d1`
                     :              :                       :  :           +- SubqueryAlias `date_dim`
                     :              :                       :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              :                       :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :              :                       :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :              :                       :        +- Join Inner
                     :              :                       :           :- Join Inner
                     :              :                       :           :  :- SubqueryAlias `catalog_sales`
                     :              :                       :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :              :                       :           :  +- SubqueryAlias `ics`
                     :              :                       :           :     +- SubqueryAlias `item`
                     :              :                       :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                       :           +- SubqueryAlias `d2`
                     :              :                       :              +- SubqueryAlias `date_dim`
                     :              :                       :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              :                       +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :              :                          +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :              :                             +- Join Inner
                     :              :                                :- Join Inner
                     :              :                                :  :- SubqueryAlias `web_sales`
                     :              :                                :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :              :                                :  +- SubqueryAlias `iws`
                     :              :                                :     +- SubqueryAlias `item`
                     :              :                                :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                                +- SubqueryAlias `d3`
                     :              :                                   +- SubqueryAlias `date_dim`
                     :              :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              +- Join Inner
                     :                 :- Join Inner
                     :                 :  :- SubqueryAlias `catalog_sales`
                     :                 :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :                 :  +- SubqueryAlias `item`
                     :                 :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :                 +- SubqueryAlias `date_dim`
                     :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- Project [channel#11788, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11789, number_sales#11790L]
                        +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2)))#11819 as decimal(32,6)) > cast(scalar-subquery#11792 [] as decimal(32,6)))
                           :  +- Project [average_sales#11803]
                           :     +- SubqueryAlias `avg_sales`
                           :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#11797 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#11798 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#11803]
                           :           +- SubqueryAlias `x`
                           :              +- Union
                           :                 :- Union
                           :                 :  :- Project [ss_quantity#140 AS quantity#11797, ss_list_price#142 AS list_price#11798]
                           :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= 2001)))
                           :                 :  :     +- Join Inner
                           :                 :  :        :- SubqueryAlias `store_sales`
                           :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                 :  :        +- SubqueryAlias `date_dim`
                           :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :                 :  +- Project [cs_quantity#18 AS quantity#11799, cs_list_price#20 AS list_price#11800]
                           :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                           :                 :        +- Join Inner
                           :                 :           :- SubqueryAlias `catalog_sales`
                           :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :                 :           +- SubqueryAlias `date_dim`
                           :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :                 +- Project [ws_quantity#234 AS quantity#11801, ws_list_price#236 AS list_price#11802]
                           :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                           :                       +- Join Inner
                           :                          :- SubqueryAlias `web_sales`
                           :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :                          +- SubqueryAlias `date_dim`
                           :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [web AS channel#11788, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2))) AS sales#11789, count(1) AS number_sales#11790L, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2)))#11819]
                              +- Filter (((ws_item_sk#219 IN (list#11791 []) && (ws_item_sk#219 = i_item_sk#564)) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = (1999 + 2)) && (d_moy#500 = 11)))
                                 :  +- Project [ss_item_sk#11796]
                                 :     +- SubqueryAlias `cross_items`
                                 :        +- Project [i_item_sk#564 AS ss_item_sk#11796]
                                 :           +- Filter (((i_brand_id#571 = brand_id#11793) && (i_class_id#573 = class_id#11794)) && (i_category_id#575 = category_id#11795))
                                 :              +- Join Inner
                                 :                 :- SubqueryAlias `item`
                                 :                 :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                 +- SubqueryAlias `x`
                                 :                    +- Intersect false
                                 :                       :- Intersect false
                                 :                       :  :- Project [i_brand_id#571 AS brand_id#11793, i_class_id#573 AS class_id#11794, i_category_id#575 AS category_id#11795]
                                 :                       :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                                 :                       :  :     +- Join Inner
                                 :                       :  :        :- Join Inner
                                 :                       :  :        :  :- SubqueryAlias `store_sales`
                                 :                       :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :                       :  :        :  +- SubqueryAlias `iss`
                                 :                       :  :        :     +- SubqueryAlias `item`
                                 :                       :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                       :  :        +- SubqueryAlias `d1`
                                 :                       :  :           +- SubqueryAlias `date_dim`
                                 :                       :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 :                       :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                                 :                       :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                                 :                       :        +- Join Inner
                                 :                       :           :- Join Inner
                                 :                       :           :  :- SubqueryAlias `catalog_sales`
                                 :                       :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                                 :                       :           :  +- SubqueryAlias `ics`
                                 :                       :           :     +- SubqueryAlias `item`
                                 :                       :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                       :           +- SubqueryAlias `d2`
                                 :                       :              +- SubqueryAlias `date_dim`
                                 :                       :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 :                       +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                                 :                          +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                                 :                             +- Join Inner
                                 :                                :- Join Inner
                                 :                                :  :- SubqueryAlias `web_sales`
                                 :                                :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 :                                :  +- SubqueryAlias `iws`
                                 :                                :     +- SubqueryAlias `item`
                                 :                                :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                                +- SubqueryAlias `d3`
                                 :                                   +- SubqueryAlias `date_dim`
                                 :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- SubqueryAlias `web_sales`
                                    :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  +- SubqueryAlias `item`
                                    :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                    +- SubqueryAlias `date_dim`
                                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 19:02:53 INFO Query:
== Query: q14a-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#11915 ASC NULLS FIRST, i_brand_id#11916 ASC NULLS FIRST, i_class_id#11917 ASC NULLS FIRST, i_category_id#11918 ASC NULLS FIRST], true
      +- Aggregate [channel#11915, i_brand_id#11916, i_class_id#11917, i_category_id#11918, spark_grouping_id#11910], [channel#11915, i_brand_id#11916, i_class_id#11917, i_category_id#11918, sum(sales#11862) AS sum(sales)#11905, sum(number_sales#11863L) AS sum(number_sales)#11906L]
         +- Expand [List(channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, channel#11911, i_brand_id#11912, i_class_id#11913, i_category_id#11914, 0), List(channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, channel#11911, i_brand_id#11912, i_class_id#11913, null, 1), List(channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, channel#11911, i_brand_id#11912, null, null, 3), List(channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, channel#11911, null, null, null, 7), List(channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, null, null, null, null, 15)], [channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, channel#11915, i_brand_id#11916, i_class_id#11917, i_category_id#11918, spark_grouping_id#11910]
            +- Project [channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, channel#11861 AS channel#11911, i_brand_id#571 AS i_brand_id#11912, i_class_id#573 AS i_class_id#11913, i_category_id#575 AS i_category_id#11914]
               +- SubqueryAlias `y`
                  +- Union
                     :- Union
                     :  :- Project [channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L]
                     :  :  +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#11896 as decimal(32,6)) > cast(scalar-subquery#11865 [] as decimal(32,6)))
                     :  :     :  +- Project [average_sales#11886]
                     :  :     :     +- SubqueryAlias `avg_sales`
                     :  :     :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#11880 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#11881 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#11886]
                     :  :     :           +- SubqueryAlias `x`
                     :  :     :              +- Union
                     :  :     :                 :- Union
                     :  :     :                 :  :- Project [ss_quantity#140 AS quantity#11880, ss_list_price#142 AS list_price#11881]
                     :  :     :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= 2001)))
                     :  :     :                 :  :     +- Join Inner
                     :  :     :                 :  :        :- SubqueryAlias `store_sales`
                     :  :     :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :     :                 :  :        +- SubqueryAlias `date_dim`
                     :  :     :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :     :                 :  +- Project [cs_quantity#18 AS quantity#11882, cs_list_price#20 AS list_price#11883]
                     :  :     :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :     :                 :        +- Join Inner
                     :  :     :                 :           :- SubqueryAlias `catalog_sales`
                     :  :     :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :  :     :                 :           +- SubqueryAlias `date_dim`
                     :  :     :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :     :                 +- Project [ws_quantity#234 AS quantity#11884, ws_list_price#236 AS list_price#11885]
                     :  :     :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :     :                       +- Join Inner
                     :  :     :                          :- SubqueryAlias `web_sales`
                     :  :     :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :  :     :                          +- SubqueryAlias `date_dim`
                     :  :     :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :     +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [store AS channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sales#11862, count(1) AS number_sales#11863L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#11896]
                     :  :        +- Filter (((ss_item_sk#132 IN (list#11864 []) && (ss_item_sk#132 = i_item_sk#564)) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = (1999 + 2)) && (d_moy#500 = 11)))
                     :  :           :  +- Project [ss_item_sk#11879]
                     :  :           :     +- SubqueryAlias `cross_items`
                     :  :           :        +- Project [i_item_sk#564 AS ss_item_sk#11879]
                     :  :           :           +- Filter (((i_brand_id#571 = brand_id#11876) && (i_class_id#573 = class_id#11877)) && (i_category_id#575 = category_id#11878))
                     :  :           :              +- Join Inner
                     :  :           :                 :- SubqueryAlias `item`
                     :  :           :                 :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                 +- SubqueryAlias `x`
                     :  :           :                    +- Intersect false
                     :  :           :                       :- Intersect false
                     :  :           :                       :  :- Project [i_brand_id#571 AS brand_id#11876, i_class_id#573 AS class_id#11877, i_category_id#575 AS category_id#11878]
                     :  :           :                       :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :           :                       :  :     +- Join Inner
                     :  :           :                       :  :        :- Join Inner
                     :  :           :                       :  :        :  :- SubqueryAlias `store_sales`
                     :  :           :                       :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :           :                       :  :        :  +- SubqueryAlias `iss`
                     :  :           :                       :  :        :     +- SubqueryAlias `item`
                     :  :           :                       :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                       :  :        +- SubqueryAlias `d1`
                     :  :           :                       :  :           +- SubqueryAlias `date_dim`
                     :  :           :                       :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :           :                       :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :  :           :                       :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :           :                       :        +- Join Inner
                     :  :           :                       :           :- Join Inner
                     :  :           :                       :           :  :- SubqueryAlias `catalog_sales`
                     :  :           :                       :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :  :           :                       :           :  +- SubqueryAlias `ics`
                     :  :           :                       :           :     +- SubqueryAlias `item`
                     :  :           :                       :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                       :           +- SubqueryAlias `d2`
                     :  :           :                       :              +- SubqueryAlias `date_dim`
                     :  :           :                       :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :           :                       +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :  :           :                          +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :           :                             +- Join Inner
                     :  :           :                                :- Join Inner
                     :  :           :                                :  :- SubqueryAlias `web_sales`
                     :  :           :                                :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :  :           :                                :  +- SubqueryAlias `iws`
                     :  :           :                                :     +- SubqueryAlias `item`
                     :  :           :                                :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                                +- SubqueryAlias `d3`
                     :  :           :                                   +- SubqueryAlias `date_dim`
                     :  :           :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- SubqueryAlias `store_sales`
                     :  :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :              :  +- SubqueryAlias `item`
                     :  :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :              +- SubqueryAlias `date_dim`
                     :  :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- Project [channel#11866, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11867, number_sales#11868L]
                     :     +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2)))#11899 as decimal(32,6)) > cast(scalar-subquery#11870 [] as decimal(32,6)))
                     :        :  +- Project [average_sales#11886]
                     :        :     +- SubqueryAlias `avg_sales`
                     :        :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#11880 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#11881 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#11886]
                     :        :           +- SubqueryAlias `x`
                     :        :              +- Union
                     :        :                 :- Union
                     :        :                 :  :- Project [ss_quantity#140 AS quantity#11880, ss_list_price#142 AS list_price#11881]
                     :        :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= 2001)))
                     :        :                 :  :     +- Join Inner
                     :        :                 :  :        :- SubqueryAlias `store_sales`
                     :        :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :        :                 :  :        +- SubqueryAlias `date_dim`
                     :        :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :        :                 :  +- Project [cs_quantity#18 AS quantity#11882, cs_list_price#20 AS list_price#11883]
                     :        :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :        :                 :        +- Join Inner
                     :        :                 :           :- SubqueryAlias `catalog_sales`
                     :        :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :        :                 :           +- SubqueryAlias `date_dim`
                     :        :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :        :                 +- Project [ws_quantity#234 AS quantity#11884, ws_list_price#236 AS list_price#11885]
                     :        :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :        :                       +- Join Inner
                     :        :                          :- SubqueryAlias `web_sales`
                     :        :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :        :                          +- SubqueryAlias `date_dim`
                     :        :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :        +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [catalog AS channel#11866, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2))) AS sales#11867, count(1) AS number_sales#11868L, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2)))#11899]
                     :           +- Filter (((cs_item_sk#15 IN (list#11869 []) && (cs_item_sk#15 = i_item_sk#564)) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = (1999 + 2)) && (d_moy#500 = 11)))
                     :              :  +- Project [ss_item_sk#11879]
                     :              :     +- SubqueryAlias `cross_items`
                     :              :        +- Project [i_item_sk#564 AS ss_item_sk#11879]
                     :              :           +- Filter (((i_brand_id#571 = brand_id#11876) && (i_class_id#573 = class_id#11877)) && (i_category_id#575 = category_id#11878))
                     :              :              +- Join Inner
                     :              :                 :- SubqueryAlias `item`
                     :              :                 :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                 +- SubqueryAlias `x`
                     :              :                    +- Intersect false
                     :              :                       :- Intersect false
                     :              :                       :  :- Project [i_brand_id#571 AS brand_id#11876, i_class_id#573 AS class_id#11877, i_category_id#575 AS category_id#11878]
                     :              :                       :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :              :                       :  :     +- Join Inner
                     :              :                       :  :        :- Join Inner
                     :              :                       :  :        :  :- SubqueryAlias `store_sales`
                     :              :                       :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :              :                       :  :        :  +- SubqueryAlias `iss`
                     :              :                       :  :        :     +- SubqueryAlias `item`
                     :              :                       :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                       :  :        +- SubqueryAlias `d1`
                     :              :                       :  :           +- SubqueryAlias `date_dim`
                     :              :                       :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              :                       :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :              :                       :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :              :                       :        +- Join Inner
                     :              :                       :           :- Join Inner
                     :              :                       :           :  :- SubqueryAlias `catalog_sales`
                     :              :                       :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :              :                       :           :  +- SubqueryAlias `ics`
                     :              :                       :           :     +- SubqueryAlias `item`
                     :              :                       :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                       :           +- SubqueryAlias `d2`
                     :              :                       :              +- SubqueryAlias `date_dim`
                     :              :                       :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              :                       +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :              :                          +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :              :                             +- Join Inner
                     :              :                                :- Join Inner
                     :              :                                :  :- SubqueryAlias `web_sales`
                     :              :                                :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :              :                                :  +- SubqueryAlias `iws`
                     :              :                                :     +- SubqueryAlias `item`
                     :              :                                :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                                +- SubqueryAlias `d3`
                     :              :                                   +- SubqueryAlias `date_dim`
                     :              :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              +- Join Inner
                     :                 :- Join Inner
                     :                 :  :- SubqueryAlias `catalog_sales`
                     :                 :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :                 :  +- SubqueryAlias `item`
                     :                 :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :                 +- SubqueryAlias `date_dim`
                     :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- Project [channel#11871, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11872, number_sales#11873L]
                        +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2)))#11902 as decimal(32,6)) > cast(scalar-subquery#11875 [] as decimal(32,6)))
                           :  +- Project [average_sales#11886]
                           :     +- SubqueryAlias `avg_sales`
                           :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#11880 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#11881 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#11886]
                           :           +- SubqueryAlias `x`
                           :              +- Union
                           :                 :- Union
                           :                 :  :- Project [ss_quantity#140 AS quantity#11880, ss_list_price#142 AS list_price#11881]
                           :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= 2001)))
                           :                 :  :     +- Join Inner
                           :                 :  :        :- SubqueryAlias `store_sales`
                           :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                 :  :        +- SubqueryAlias `date_dim`
                           :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :                 :  +- Project [cs_quantity#18 AS quantity#11882, cs_list_price#20 AS list_price#11883]
                           :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                           :                 :        +- Join Inner
                           :                 :           :- SubqueryAlias `catalog_sales`
                           :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :                 :           +- SubqueryAlias `date_dim`
                           :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :                 +- Project [ws_quantity#234 AS quantity#11884, ws_list_price#236 AS list_price#11885]
                           :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                           :                       +- Join Inner
                           :                          :- SubqueryAlias `web_sales`
                           :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :                          +- SubqueryAlias `date_dim`
                           :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [web AS channel#11871, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2))) AS sales#11872, count(1) AS number_sales#11873L, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2)))#11902]
                              +- Filter (((ws_item_sk#219 IN (list#11874 []) && (ws_item_sk#219 = i_item_sk#564)) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = (1999 + 2)) && (d_moy#500 = 11)))
                                 :  +- Project [ss_item_sk#11879]
                                 :     +- SubqueryAlias `cross_items`
                                 :        +- Project [i_item_sk#564 AS ss_item_sk#11879]
                                 :           +- Filter (((i_brand_id#571 = brand_id#11876) && (i_class_id#573 = class_id#11877)) && (i_category_id#575 = category_id#11878))
                                 :              +- Join Inner
                                 :                 :- SubqueryAlias `item`
                                 :                 :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                 +- SubqueryAlias `x`
                                 :                    +- Intersect false
                                 :                       :- Intersect false
                                 :                       :  :- Project [i_brand_id#571 AS brand_id#11876, i_class_id#573 AS class_id#11877, i_category_id#575 AS category_id#11878]
                                 :                       :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                                 :                       :  :     +- Join Inner
                                 :                       :  :        :- Join Inner
                                 :                       :  :        :  :- SubqueryAlias `store_sales`
                                 :                       :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :                       :  :        :  +- SubqueryAlias `iss`
                                 :                       :  :        :     +- SubqueryAlias `item`
                                 :                       :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                       :  :        +- SubqueryAlias `d1`
                                 :                       :  :           +- SubqueryAlias `date_dim`
                                 :                       :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 :                       :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                                 :                       :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                                 :                       :        +- Join Inner
                                 :                       :           :- Join Inner
                                 :                       :           :  :- SubqueryAlias `catalog_sales`
                                 :                       :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                                 :                       :           :  +- SubqueryAlias `ics`
                                 :                       :           :     +- SubqueryAlias `item`
                                 :                       :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                       :           +- SubqueryAlias `d2`
                                 :                       :              +- SubqueryAlias `date_dim`
                                 :                       :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 :                       +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                                 :                          +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                                 :                             +- Join Inner
                                 :                                :- Join Inner
                                 :                                :  :- SubqueryAlias `web_sales`
                                 :                                :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 :                                :  +- SubqueryAlias `iws`
                                 :                                :     +- SubqueryAlias `item`
                                 :                                :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                                +- SubqueryAlias `d3`
                                 :                                   +- SubqueryAlias `date_dim`
                                 :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- SubqueryAlias `web_sales`
                                    :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  +- SubqueryAlias `item`
                                    :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                    +- SubqueryAlias `date_dim`
                                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 258.786406474s
Running execution q14b-v2.4 iteration: 1, StandardRun=true
19/09/08 19:07:19 INFO Query:
== Query: q14b-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#12248 ASC NULLS FIRST, i_brand_id#571 ASC NULLS FIRST, i_class_id#573 ASC NULLS FIRST, i_category_id#575 ASC NULLS FIRST], true
      +- Project [channel#12248, i_brand_id#571, i_class_id#573, i_category_id#575, sales#12249, number_sales#12250L, channel#12254, i_brand_id#12289, i_class_id#12291, i_category_id#12293, sales#12255, number_sales#12256L]
         +- Filter (((i_brand_id#571 = i_brand_id#12289) && (i_class_id#573 = i_class_id#12291)) && (i_category_id#575 = i_category_id#12293))
            +- Join Inner
               :- SubqueryAlias `this_year`
               :  +- Project [channel#12248, i_brand_id#571, i_class_id#573, i_category_id#575, sales#12249, number_sales#12250L]
               :     +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12278 as decimal(32,6)) > cast(scalar-subquery#12253 [] as decimal(32,6)))
               :        :  +- Project [average_sales#12270]
               :        :     +- SubqueryAlias `avg_sales`
               :        :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#12264 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#12265 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#12270]
               :        :           +- SubqueryAlias `x`
               :        :              +- Union
               :        :                 :- Union
               :        :                 :  :- Project [ss_quantity#140 AS quantity#12264, ss_list_price#142 AS list_price#12265]
               :        :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :        :                 :  :     +- Join Inner
               :        :                 :  :        :- SubqueryAlias `store_sales`
               :        :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :        :                 :  :        +- SubqueryAlias `date_dim`
               :        :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :        :                 :  +- Project [cs_quantity#18 AS quantity#12266, cs_list_price#20 AS list_price#12267]
               :        :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :        :                 :        +- Join Inner
               :        :                 :           :- SubqueryAlias `catalog_sales`
               :        :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :        :                 :           +- SubqueryAlias `date_dim`
               :        :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :        :                 +- Project [ws_quantity#234 AS quantity#12268, ws_list_price#236 AS list_price#12269]
               :        :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :        :                       +- Join Inner
               :        :                          :- SubqueryAlias `web_sales`
               :        :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :        :                          +- SubqueryAlias `date_dim`
               :        :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :        +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [store AS channel#12248, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sales#12249, count(1) AS number_sales#12250L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12278]
               :           +- Filter ((ss_item_sk#132 IN (list#12251 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_week_seq#496 = scalar-subquery#12252 [])))
               :              :  :- Project [ss_item_sk#12263]
               :              :  :  +- SubqueryAlias `cross_items`
               :              :  :     +- Project [i_item_sk#564 AS ss_item_sk#12263]
               :              :  :        +- Filter (((i_brand_id#571 = brand_id#12260) && (i_class_id#573 = class_id#12261)) && (i_category_id#575 = category_id#12262))
               :              :  :           +- Join Inner
               :              :  :              :- SubqueryAlias `item`
               :              :  :              :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :              +- SubqueryAlias `x`
               :              :  :                 +- Intersect false
               :              :  :                    :- Intersect false
               :              :  :                    :  :- Project [i_brand_id#571 AS brand_id#12260, i_class_id#573 AS class_id#12261, i_category_id#575 AS category_id#12262]
               :              :  :                    :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :              :  :                    :  :     +- Join Inner
               :              :  :                    :  :        :- Join Inner
               :              :  :                    :  :        :  :- SubqueryAlias `store_sales`
               :              :  :                    :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :              :  :                    :  :        :  +- SubqueryAlias `iss`
               :              :  :                    :  :        :     +- SubqueryAlias `item`
               :              :  :                    :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :                    :  :        +- SubqueryAlias `d1`
               :              :  :                    :  :           +- SubqueryAlias `date_dim`
               :              :  :                    :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              :  :                    :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
               :              :  :                    :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :              :  :                    :        +- Join Inner
               :              :  :                    :           :- Join Inner
               :              :  :                    :           :  :- SubqueryAlias `catalog_sales`
               :              :  :                    :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :              :  :                    :           :  +- SubqueryAlias `ics`
               :              :  :                    :           :     +- SubqueryAlias `item`
               :              :  :                    :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :                    :           +- SubqueryAlias `d2`
               :              :  :                    :              +- SubqueryAlias `date_dim`
               :              :  :                    :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              :  :                    +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
               :              :  :                       +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :              :  :                          +- Join Inner
               :              :  :                             :- Join Inner
               :              :  :                             :  :- SubqueryAlias `web_sales`
               :              :  :                             :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :              :  :                             :  +- SubqueryAlias `iws`
               :              :  :                             :     +- SubqueryAlias `item`
               :              :  :                             :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :                             +- SubqueryAlias `d3`
               :              :  :                                +- SubqueryAlias `date_dim`
               :              :  :                                   +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              :  +- Project [d_week_seq#496]
               :              :     +- Filter (((d_year#498 = (1999 + 1)) && (d_moy#500 = 12)) && (d_dom#501 = 11))
               :              :        +- SubqueryAlias `date_dim`
               :              :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- SubqueryAlias `store_sales`
               :                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :                 :  +- SubqueryAlias `item`
               :                 :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                 +- SubqueryAlias `date_dim`
               :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `last_year`
                  +- Project [channel#12254, i_brand_id#12289, i_class_id#12291, i_category_id#12293, sales#12255, number_sales#12256L]
                     +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12281 as decimal(32,6)) > cast(scalar-subquery#12259 [] as decimal(32,6)))
                        :  +- Project [average_sales#12270]
                        :     +- SubqueryAlias `avg_sales`
                        :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#12264 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#12265 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#12270]
                        :           +- SubqueryAlias `x`
                        :              +- Union
                        :                 :- Union
                        :                 :  :- Project [ss_quantity#140 AS quantity#12264, ss_list_price#142 AS list_price#12265]
                        :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                        :                 :  :     +- Join Inner
                        :                 :  :        :- SubqueryAlias `store_sales`
                        :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :                 :  :        +- SubqueryAlias `date_dim`
                        :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :                 :  +- Project [cs_quantity#18 AS quantity#12266, cs_list_price#20 AS list_price#12267]
                        :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                        :                 :        +- Join Inner
                        :                 :           :- SubqueryAlias `catalog_sales`
                        :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :                 :           +- SubqueryAlias `date_dim`
                        :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :                 +- Project [ws_quantity#234 AS quantity#12268, ws_list_price#236 AS list_price#12269]
                        :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                        :                       +- Join Inner
                        :                          :- SubqueryAlias `web_sales`
                        :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :                          +- SubqueryAlias `date_dim`
                        :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [i_brand_id#12289, i_class_id#12291, i_category_id#12293], [store AS channel#12254, i_brand_id#12289, i_class_id#12291, i_category_id#12293, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sales#12255, count(1) AS number_sales#12256L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12281]
                           +- Filter ((ss_item_sk#132 IN (list#12257 []) && (ss_item_sk#132 = i_item_sk#12282)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_week_seq#496 = scalar-subquery#12258 [])))
                              :  :- Project [ss_item_sk#12263]
                              :  :  +- SubqueryAlias `cross_items`
                              :  :     +- Project [i_item_sk#564 AS ss_item_sk#12263]
                              :  :        +- Filter (((i_brand_id#571 = brand_id#12260) && (i_class_id#573 = class_id#12261)) && (i_category_id#575 = category_id#12262))
                              :  :           +- Join Inner
                              :  :              :- SubqueryAlias `item`
                              :  :              :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :              +- SubqueryAlias `x`
                              :  :                 +- Intersect false
                              :  :                    :- Intersect false
                              :  :                    :  :- Project [i_brand_id#571 AS brand_id#12260, i_class_id#573 AS class_id#12261, i_category_id#575 AS category_id#12262]
                              :  :                    :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                              :  :                    :  :     +- Join Inner
                              :  :                    :  :        :- Join Inner
                              :  :                    :  :        :  :- SubqueryAlias `store_sales`
                              :  :                    :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  :                    :  :        :  +- SubqueryAlias `iss`
                              :  :                    :  :        :     +- SubqueryAlias `item`
                              :  :                    :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :                    :  :        +- SubqueryAlias `d1`
                              :  :                    :  :           +- SubqueryAlias `date_dim`
                              :  :                    :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  :                    :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                              :  :                    :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                              :  :                    :        +- Join Inner
                              :  :                    :           :- Join Inner
                              :  :                    :           :  :- SubqueryAlias `catalog_sales`
                              :  :                    :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                              :  :                    :           :  +- SubqueryAlias `ics`
                              :  :                    :           :     +- SubqueryAlias `item`
                              :  :                    :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :                    :           +- SubqueryAlias `d2`
                              :  :                    :              +- SubqueryAlias `date_dim`
                              :  :                    :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  :                    +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                              :  :                       +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                              :  :                          +- Join Inner
                              :  :                             :- Join Inner
                              :  :                             :  :- SubqueryAlias `web_sales`
                              :  :                             :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :                             :  +- SubqueryAlias `iws`
                              :  :                             :     +- SubqueryAlias `item`
                              :  :                             :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :                             +- SubqueryAlias `d3`
                              :  :                                +- SubqueryAlias `date_dim`
                              :  :                                   +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- Project [d_week_seq#496]
                              :     +- Filter (((d_year#498 = 1999) && (d_moy#500 = 12)) && (d_dom#501 = 11))
                              :        +- SubqueryAlias `date_dim`
                              :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `store_sales`
                                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `item`
                                 :     +- Relation[i_item_sk#12282,i_item_id#12283,i_rec_start_date#12284,i_rec_end_date#12285,i_item_desc#12286,i_current_price#12287,i_wholesale_cost#12288,i_brand_id#12289,i_brand#12290,i_class_id#12291,i_class#12292,i_category_id#12293,i_category#12294,i_manufact_id#12295,i_manufact#12296,i_size#12297,i_formulation#12298,i_color#12299,i_units#12300,i_container#12301,i_manager_id#12302,i_product_name#12303] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 19:07:19 INFO Query:
== Query: q14b-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#12320 ASC NULLS FIRST, i_brand_id#571 ASC NULLS FIRST, i_class_id#573 ASC NULLS FIRST, i_category_id#575 ASC NULLS FIRST], true
      +- Project [channel#12320, i_brand_id#571, i_class_id#573, i_category_id#575, sales#12321, number_sales#12322L, channel#12326, i_brand_id#12361, i_class_id#12363, i_category_id#12365, sales#12327, number_sales#12328L]
         +- Filter (((i_brand_id#571 = i_brand_id#12361) && (i_class_id#573 = i_class_id#12363)) && (i_category_id#575 = i_category_id#12365))
            +- Join Inner
               :- SubqueryAlias `this_year`
               :  +- Project [channel#12320, i_brand_id#571, i_class_id#573, i_category_id#575, sales#12321, number_sales#12322L]
               :     +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12350 as decimal(32,6)) > cast(scalar-subquery#12325 [] as decimal(32,6)))
               :        :  +- Project [average_sales#12342]
               :        :     +- SubqueryAlias `avg_sales`
               :        :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#12336 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#12337 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#12342]
               :        :           +- SubqueryAlias `x`
               :        :              +- Union
               :        :                 :- Union
               :        :                 :  :- Project [ss_quantity#140 AS quantity#12336, ss_list_price#142 AS list_price#12337]
               :        :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :        :                 :  :     +- Join Inner
               :        :                 :  :        :- SubqueryAlias `store_sales`
               :        :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :        :                 :  :        +- SubqueryAlias `date_dim`
               :        :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :        :                 :  +- Project [cs_quantity#18 AS quantity#12338, cs_list_price#20 AS list_price#12339]
               :        :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :        :                 :        +- Join Inner
               :        :                 :           :- SubqueryAlias `catalog_sales`
               :        :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :        :                 :           +- SubqueryAlias `date_dim`
               :        :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :        :                 +- Project [ws_quantity#234 AS quantity#12340, ws_list_price#236 AS list_price#12341]
               :        :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :        :                       +- Join Inner
               :        :                          :- SubqueryAlias `web_sales`
               :        :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :        :                          +- SubqueryAlias `date_dim`
               :        :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :        +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [store AS channel#12320, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sales#12321, count(1) AS number_sales#12322L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12350]
               :           +- Filter ((ss_item_sk#132 IN (list#12323 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_week_seq#496 = scalar-subquery#12324 [])))
               :              :  :- Project [ss_item_sk#12335]
               :              :  :  +- SubqueryAlias `cross_items`
               :              :  :     +- Project [i_item_sk#564 AS ss_item_sk#12335]
               :              :  :        +- Filter (((i_brand_id#571 = brand_id#12332) && (i_class_id#573 = class_id#12333)) && (i_category_id#575 = category_id#12334))
               :              :  :           +- Join Inner
               :              :  :              :- SubqueryAlias `item`
               :              :  :              :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :              +- SubqueryAlias `x`
               :              :  :                 +- Intersect false
               :              :  :                    :- Intersect false
               :              :  :                    :  :- Project [i_brand_id#571 AS brand_id#12332, i_class_id#573 AS class_id#12333, i_category_id#575 AS category_id#12334]
               :              :  :                    :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :              :  :                    :  :     +- Join Inner
               :              :  :                    :  :        :- Join Inner
               :              :  :                    :  :        :  :- SubqueryAlias `store_sales`
               :              :  :                    :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :              :  :                    :  :        :  +- SubqueryAlias `iss`
               :              :  :                    :  :        :     +- SubqueryAlias `item`
               :              :  :                    :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :                    :  :        +- SubqueryAlias `d1`
               :              :  :                    :  :           +- SubqueryAlias `date_dim`
               :              :  :                    :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              :  :                    :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
               :              :  :                    :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :              :  :                    :        +- Join Inner
               :              :  :                    :           :- Join Inner
               :              :  :                    :           :  :- SubqueryAlias `catalog_sales`
               :              :  :                    :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :              :  :                    :           :  +- SubqueryAlias `ics`
               :              :  :                    :           :     +- SubqueryAlias `item`
               :              :  :                    :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :                    :           +- SubqueryAlias `d2`
               :              :  :                    :              +- SubqueryAlias `date_dim`
               :              :  :                    :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              :  :                    +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
               :              :  :                       +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :              :  :                          +- Join Inner
               :              :  :                             :- Join Inner
               :              :  :                             :  :- SubqueryAlias `web_sales`
               :              :  :                             :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :              :  :                             :  +- SubqueryAlias `iws`
               :              :  :                             :     +- SubqueryAlias `item`
               :              :  :                             :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :                             +- SubqueryAlias `d3`
               :              :  :                                +- SubqueryAlias `date_dim`
               :              :  :                                   +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              :  +- Project [d_week_seq#496]
               :              :     +- Filter (((d_year#498 = (1999 + 1)) && (d_moy#500 = 12)) && (d_dom#501 = 11))
               :              :        +- SubqueryAlias `date_dim`
               :              :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- SubqueryAlias `store_sales`
               :                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :                 :  +- SubqueryAlias `item`
               :                 :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                 +- SubqueryAlias `date_dim`
               :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `last_year`
                  +- Project [channel#12326, i_brand_id#12361, i_class_id#12363, i_category_id#12365, sales#12327, number_sales#12328L]
                     +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12353 as decimal(32,6)) > cast(scalar-subquery#12331 [] as decimal(32,6)))
                        :  +- Project [average_sales#12342]
                        :     +- SubqueryAlias `avg_sales`
                        :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#12336 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#12337 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#12342]
                        :           +- SubqueryAlias `x`
                        :              +- Union
                        :                 :- Union
                        :                 :  :- Project [ss_quantity#140 AS quantity#12336, ss_list_price#142 AS list_price#12337]
                        :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                        :                 :  :     +- Join Inner
                        :                 :  :        :- SubqueryAlias `store_sales`
                        :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :                 :  :        +- SubqueryAlias `date_dim`
                        :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :                 :  +- Project [cs_quantity#18 AS quantity#12338, cs_list_price#20 AS list_price#12339]
                        :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                        :                 :        +- Join Inner
                        :                 :           :- SubqueryAlias `catalog_sales`
                        :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :                 :           +- SubqueryAlias `date_dim`
                        :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :                 +- Project [ws_quantity#234 AS quantity#12340, ws_list_price#236 AS list_price#12341]
                        :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                        :                       +- Join Inner
                        :                          :- SubqueryAlias `web_sales`
                        :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :                          +- SubqueryAlias `date_dim`
                        :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [i_brand_id#12361, i_class_id#12363, i_category_id#12365], [store AS channel#12326, i_brand_id#12361, i_class_id#12363, i_category_id#12365, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sales#12327, count(1) AS number_sales#12328L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12353]
                           +- Filter ((ss_item_sk#132 IN (list#12329 []) && (ss_item_sk#132 = i_item_sk#12354)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_week_seq#496 = scalar-subquery#12330 [])))
                              :  :- Project [ss_item_sk#12335]
                              :  :  +- SubqueryAlias `cross_items`
                              :  :     +- Project [i_item_sk#564 AS ss_item_sk#12335]
                              :  :        +- Filter (((i_brand_id#571 = brand_id#12332) && (i_class_id#573 = class_id#12333)) && (i_category_id#575 = category_id#12334))
                              :  :           +- Join Inner
                              :  :              :- SubqueryAlias `item`
                              :  :              :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :              +- SubqueryAlias `x`
                              :  :                 +- Intersect false
                              :  :                    :- Intersect false
                              :  :                    :  :- Project [i_brand_id#571 AS brand_id#12332, i_class_id#573 AS class_id#12333, i_category_id#575 AS category_id#12334]
                              :  :                    :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                              :  :                    :  :     +- Join Inner
                              :  :                    :  :        :- Join Inner
                              :  :                    :  :        :  :- SubqueryAlias `store_sales`
                              :  :                    :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  :                    :  :        :  +- SubqueryAlias `iss`
                              :  :                    :  :        :     +- SubqueryAlias `item`
                              :  :                    :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :                    :  :        +- SubqueryAlias `d1`
                              :  :                    :  :           +- SubqueryAlias `date_dim`
                              :  :                    :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  :                    :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                              :  :                    :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                              :  :                    :        +- Join Inner
                              :  :                    :           :- Join Inner
                              :  :                    :           :  :- SubqueryAlias `catalog_sales`
                              :  :                    :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                              :  :                    :           :  +- SubqueryAlias `ics`
                              :  :                    :           :     +- SubqueryAlias `item`
                              :  :                    :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :                    :           +- SubqueryAlias `d2`
                              :  :                    :              +- SubqueryAlias `date_dim`
                              :  :                    :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  :                    +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                              :  :                       +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                              :  :                          +- Join Inner
                              :  :                             :- Join Inner
                              :  :                             :  :- SubqueryAlias `web_sales`
                              :  :                             :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :                             :  +- SubqueryAlias `iws`
                              :  :                             :     +- SubqueryAlias `item`
                              :  :                             :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :                             +- SubqueryAlias `d3`
                              :  :                                +- SubqueryAlias `date_dim`
                              :  :                                   +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- Project [d_week_seq#496]
                              :     +- Filter (((d_year#498 = 1999) && (d_moy#500 = 12)) && (d_dom#501 = 11))
                              :        +- SubqueryAlias `date_dim`
                              :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `store_sales`
                                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `item`
                                 :     +- Relation[i_item_sk#12354,i_item_id#12355,i_rec_start_date#12356,i_rec_end_date#12357,i_item_desc#12358,i_current_price#12359,i_wholesale_cost#12360,i_brand_id#12361,i_brand#12362,i_class_id#12363,i_class#12364,i_category_id#12365,i_category#12366,i_manufact_id#12367,i_manufact#12368,i_size#12369,i_formulation#12370,i_color#12371,i_units#12372,i_container#12373,i_manager_id#12374,i_product_name#12375] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 220.800127259s
Running execution q15-v2.4 iteration: 1, StandardRun=true
19/09/08 19:11:03 INFO Query:
== Query: q15-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ca_zip#457, sum(cs_sales_price)#12567]
      +- Sort [ca_zip#457 ASC NULLS FIRST], true
         +- Aggregate [ca_zip#457], [ca_zip#457, sum(cs_sales_price#21) AS sum(cs_sales_price)#12567]
            +- Filter ((((cs_bill_customer_sk#3 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && ((substring(ca_zip#457, 1, 5) IN (85669,86197,88274,83405,86475,85392,85460,80348,81792) || ca_state#456 IN (CA,WA,GA)) || (cast(cs_sales_price#21 as decimal(7,2)) > cast(cast(500 as decimal(3,0)) as decimal(7,2))))) && (((cs_sold_date_sk#0 = d_date_sk#492) && (d_qoy#502 = 2)) && (d_year#498 = 2001)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `customer`
                  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 19:11:03 INFO Query:
== Query: q15-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ca_zip#457, sum(cs_sales_price)#12572]
      +- Sort [ca_zip#457 ASC NULLS FIRST], true
         +- Aggregate [ca_zip#457], [ca_zip#457, sum(cs_sales_price#21) AS sum(cs_sales_price)#12572]
            +- Filter ((((cs_bill_customer_sk#3 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && ((substring(ca_zip#457, 1, 5) IN (85669,86197,88274,83405,86475,85392,85460,80348,81792) || ca_state#456 IN (CA,WA,GA)) || (cast(cs_sales_price#21 as decimal(7,2)) > cast(cast(500 as decimal(3,0)) as decimal(7,2))))) && (((cs_sold_date_sk#0 = d_date_sk#492) && (d_qoy#502 = 2)) && (d_year#498 = 2001)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `customer`
                  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 42.183746129s
Running execution q16-v2.4 iteration: 1, StandardRun=true
19/09/08 19:11:47 INFO Query:
== Query: q16-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [order count#12644L, total shipping cost#12645, total net profit#12646]
      +- Sort [order count#12644L ASC NULLS FIRST], true
         +- Aggregate [count(distinct cs_order_number#17L) AS order count#12644L, sum(cs_ext_ship_cost#28) AS total shipping cost#12645, sum(cs_net_profit#33) AS total net profit#12646]
            +- Filter (((((d_date#494 >= cast(2002-02-01 as date)) && (d_date#494 <= cast(cast(cast(2002-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))) && (cs_ship_date_sk#2 = d_date_sk#492)) && ((cs_ship_addr_sk#10 = ca_address_sk#448) && (ca_state#456 = GA))) && (((cs_call_center_sk#11 = cc_call_center_sk#332) && cc_county#357 IN (Williamson County,Williamson County,Williamson County,Williamson County,Williamson County)) && (exists#12647 [cs_order_number#17L && cs_warehouse_sk#14] && NOT exists#12648 [cs_order_number#17L])))
               :  :- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 10 more fields]
               :  :  +- Filter ((outer(cs_order_number#17L) = cs_order_number#17L) && NOT (outer(cs_warehouse_sk#14) = cs_warehouse_sk#14))
               :  :     +- SubqueryAlias `cs2`
               :  :        +- SubqueryAlias `catalog_sales`
               :  :           +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  +- Project [cr_returned_date_sk#68, cr_returned_time_sk#69, cr_item_sk#70, cr_refunded_customer_sk#71, cr_refunded_cdemo_sk#72, cr_refunded_hdemo_sk#73, cr_refunded_addr_sk#74, cr_returning_customer_sk#75, cr_returning_cdemo_sk#76, cr_returning_hdemo_sk#77, cr_returning_addr_sk#78, cr_call_center_sk#79, cr_catalog_page_sk#80, cr_ship_mode_sk#81, cr_warehouse_sk#82, cr_reason_sk#83, cr_order_number#84L, cr_return_quantity#85, cr_return_amount#86, cr_return_tax#87, cr_return_amt_inc_tax#88, cr_fee#89, cr_return_ship_cost#90, cr_refunded_cash#91, ... 3 more fields]
               :     +- Filter (outer(cs_order_number#17L) = cr_order_number#84L)
               :        +- SubqueryAlias `cr1`
               :           +- SubqueryAlias `catalog_returns`
               :              +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `cs1`
                  :  :  :  +- SubqueryAlias `catalog_sales`
                  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `call_center`
                     +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet

     : benchmark
19/09/08 19:11:47 INFO Query:
== Query: q16-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [order count#12657L, total shipping cost#12658, total net profit#12659]
      +- Sort [order count#12657L ASC NULLS FIRST], true
         +- Aggregate [count(distinct cs_order_number#17L) AS order count#12657L, sum(cs_ext_ship_cost#28) AS total shipping cost#12658, sum(cs_net_profit#33) AS total net profit#12659]
            +- Filter (((((d_date#494 >= cast(2002-02-01 as date)) && (d_date#494 <= cast(cast(cast(2002-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))) && (cs_ship_date_sk#2 = d_date_sk#492)) && ((cs_ship_addr_sk#10 = ca_address_sk#448) && (ca_state#456 = GA))) && (((cs_call_center_sk#11 = cc_call_center_sk#332) && cc_county#357 IN (Williamson County,Williamson County,Williamson County,Williamson County,Williamson County)) && (exists#12660 [cs_order_number#17L && cs_warehouse_sk#14] && NOT exists#12661 [cs_order_number#17L])))
               :  :- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 10 more fields]
               :  :  +- Filter ((outer(cs_order_number#17L) = cs_order_number#17L) && NOT (outer(cs_warehouse_sk#14) = cs_warehouse_sk#14))
               :  :     +- SubqueryAlias `cs2`
               :  :        +- SubqueryAlias `catalog_sales`
               :  :           +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  +- Project [cr_returned_date_sk#68, cr_returned_time_sk#69, cr_item_sk#70, cr_refunded_customer_sk#71, cr_refunded_cdemo_sk#72, cr_refunded_hdemo_sk#73, cr_refunded_addr_sk#74, cr_returning_customer_sk#75, cr_returning_cdemo_sk#76, cr_returning_hdemo_sk#77, cr_returning_addr_sk#78, cr_call_center_sk#79, cr_catalog_page_sk#80, cr_ship_mode_sk#81, cr_warehouse_sk#82, cr_reason_sk#83, cr_order_number#84L, cr_return_quantity#85, cr_return_amount#86, cr_return_tax#87, cr_return_amt_inc_tax#88, cr_fee#89, cr_return_ship_cost#90, cr_refunded_cash#91, ... 3 more fields]
               :     +- Filter (outer(cs_order_number#17L) = cr_order_number#84L)
               :        +- SubqueryAlias `cr1`
               :           +- SubqueryAlias `catalog_returns`
               :              +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `cs1`
                  :  :  :  +- SubqueryAlias `catalog_sales`
                  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `call_center`
                     +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 58.827638955000005s
Running execution q17-v2.4 iteration: 1, StandardRun=true
19/09/08 19:12:47 INFO Query:
== Query: q17-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, s_state#688 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, s_state#688], [i_item_id#565, i_item_desc#568, s_state#688, count(ss_quantity#140) AS store_sales_quantitycount#13048L, avg(cast(ss_quantity#140 as bigint)) AS store_sales_quantityave#13049, stddev_samp(cast(ss_quantity#140 as double)) AS store_sales_quantitystdev#13050, (stddev_samp(cast(ss_quantity#140 as double)) / avg(cast(ss_quantity#140 as bigint))) AS store_sales_quantitycov#13051, count(sr_return_quantity#186) AS as_store_returns_quantitycount#13052L, avg(cast(sr_return_quantity#186 as bigint)) AS as_store_returns_quantityave#13053, stddev_samp(cast(sr_return_quantity#186 as double)) AS as_store_returns_quantitystdev#13054, (stddev_samp(cast(sr_return_quantity#186 as double)) / avg(cast(sr_return_quantity#186 as bigint))) AS store_returns_quantitycov#13055, count(cs_quantity#18) AS catalog_sales_quantitycount#13056L, avg(cast(cs_quantity#18 as bigint)) AS catalog_sales_quantityave#13057, (stddev_samp(cast(cs_quantity#18 as double)) / avg(cast(cs_quantity#18 as bigint))) AS catalog_sales_quantitystdev#13058, (stddev_samp(cast(cs_quantity#18 as double)) / avg(cast(cs_quantity#18 as bigint))) AS catalog_sales_quantitycov#13059]
         +- Filter (((((d_quarter_name#507 = 2001Q1) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((i_item_sk#564 = ss_item_sk#132) && (s_store_sk#664 = ss_store_sk#137))) && (((ss_customer_sk#133 = sr_customer_sk#179) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L))) && ((((sr_returned_date_sk#176 = d_date_sk#13060) && d_quarter_name#13075 IN (2001Q1,2001Q2,2001Q3)) && (sr_customer_sk#179 = cs_bill_customer_sk#3)) && (((sr_item_sk#178 = cs_item_sk#15) && (cs_sold_date_sk#0 = d_date_sk#13088)) && d_quarter_name#13103 IN (2001Q1,2001Q2,2001Q3))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- Join Inner
               :  :  :  :- Join Inner
               :  :  :  :  :- Join Inner
               :  :  :  :  :  :- Join Inner
               :  :  :  :  :  :  :- SubqueryAlias `store_sales`
               :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  :  :  :  +- SubqueryAlias `store_returns`
               :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :  :  :  :  :  +- SubqueryAlias `catalog_sales`
               :  :  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :  +- SubqueryAlias `d1`
               :  :  :  :     +- SubqueryAlias `date_dim`
               :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  +- SubqueryAlias `d2`
               :  :  :     +- SubqueryAlias `date_dim`
               :  :  :        +- Relation[d_date_sk#13060,d_date_id#13061,d_date#13062,d_month_seq#13063,d_week_seq#13064,d_quarter_seq#13065,d_year#13066,d_dow#13067,d_moy#13068,d_dom#13069,d_qoy#13070,d_fy_year#13071,d_fy_quarter_seq#13072,d_fy_week_seq#13073,d_day_name#13074,d_quarter_name#13075,d_holiday#13076,d_weekend#13077,d_following_holiday#13078,d_first_dom#13079,d_last_dom#13080,d_same_day_ly#13081,d_same_day_lq#13082,d_current_day#13083,... 4 more fields] parquet
               :  :  +- SubqueryAlias `d3`
               :  :     +- SubqueryAlias `date_dim`
               :  :        +- Relation[d_date_sk#13088,d_date_id#13089,d_date#13090,d_month_seq#13091,d_week_seq#13092,d_quarter_seq#13093,d_year#13094,d_dow#13095,d_moy#13096,d_dom#13097,d_qoy#13098,d_fy_year#13099,d_fy_quarter_seq#13100,d_fy_week_seq#13101,d_day_name#13102,d_quarter_name#13103,d_holiday#13104,d_weekend#13105,d_following_holiday#13106,d_first_dom#13107,d_last_dom#13108,d_same_day_ly#13109,d_same_day_lq#13110,d_current_day#13111,... 4 more fields] parquet
               :  +- SubqueryAlias `store`
               :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 19:12:47 INFO Query:
== Query: q17-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, s_state#688 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, s_state#688], [i_item_id#565, i_item_desc#568, s_state#688, count(ss_quantity#140) AS store_sales_quantitycount#13291L, avg(cast(ss_quantity#140 as bigint)) AS store_sales_quantityave#13292, stddev_samp(cast(ss_quantity#140 as double)) AS store_sales_quantitystdev#13293, (stddev_samp(cast(ss_quantity#140 as double)) / avg(cast(ss_quantity#140 as bigint))) AS store_sales_quantitycov#13294, count(sr_return_quantity#186) AS as_store_returns_quantitycount#13295L, avg(cast(sr_return_quantity#186 as bigint)) AS as_store_returns_quantityave#13296, stddev_samp(cast(sr_return_quantity#186 as double)) AS as_store_returns_quantitystdev#13297, (stddev_samp(cast(sr_return_quantity#186 as double)) / avg(cast(sr_return_quantity#186 as bigint))) AS store_returns_quantitycov#13298, count(cs_quantity#18) AS catalog_sales_quantitycount#13299L, avg(cast(cs_quantity#18 as bigint)) AS catalog_sales_quantityave#13300, (stddev_samp(cast(cs_quantity#18 as double)) / avg(cast(cs_quantity#18 as bigint))) AS catalog_sales_quantitystdev#13301, (stddev_samp(cast(cs_quantity#18 as double)) / avg(cast(cs_quantity#18 as bigint))) AS catalog_sales_quantitycov#13302]
         +- Filter (((((d_quarter_name#507 = 2001Q1) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((i_item_sk#564 = ss_item_sk#132) && (s_store_sk#664 = ss_store_sk#137))) && (((ss_customer_sk#133 = sr_customer_sk#179) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L))) && ((((sr_returned_date_sk#176 = d_date_sk#13303) && d_quarter_name#13318 IN (2001Q1,2001Q2,2001Q3)) && (sr_customer_sk#179 = cs_bill_customer_sk#3)) && (((sr_item_sk#178 = cs_item_sk#15) && (cs_sold_date_sk#0 = d_date_sk#13331)) && d_quarter_name#13346 IN (2001Q1,2001Q2,2001Q3))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- Join Inner
               :  :  :  :- Join Inner
               :  :  :  :  :- Join Inner
               :  :  :  :  :  :- Join Inner
               :  :  :  :  :  :  :- SubqueryAlias `store_sales`
               :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  :  :  :  +- SubqueryAlias `store_returns`
               :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :  :  :  :  :  +- SubqueryAlias `catalog_sales`
               :  :  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :  +- SubqueryAlias `d1`
               :  :  :  :     +- SubqueryAlias `date_dim`
               :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  +- SubqueryAlias `d2`
               :  :  :     +- SubqueryAlias `date_dim`
               :  :  :        +- Relation[d_date_sk#13303,d_date_id#13304,d_date#13305,d_month_seq#13306,d_week_seq#13307,d_quarter_seq#13308,d_year#13309,d_dow#13310,d_moy#13311,d_dom#13312,d_qoy#13313,d_fy_year#13314,d_fy_quarter_seq#13315,d_fy_week_seq#13316,d_day_name#13317,d_quarter_name#13318,d_holiday#13319,d_weekend#13320,d_following_holiday#13321,d_first_dom#13322,d_last_dom#13323,d_same_day_ly#13324,d_same_day_lq#13325,d_current_day#13326,... 4 more fields] parquet
               :  :  +- SubqueryAlias `d3`
               :  :     +- SubqueryAlias `date_dim`
               :  :        +- Relation[d_date_sk#13331,d_date_id#13332,d_date#13333,d_month_seq#13334,d_week_seq#13335,d_quarter_seq#13336,d_year#13337,d_dow#13338,d_moy#13339,d_dom#13340,d_qoy#13341,d_fy_year#13342,d_fy_quarter_seq#13343,d_fy_week_seq#13344,d_day_name#13345,d_quarter_name#13346,d_holiday#13347,d_weekend#13348,d_following_holiday#13349,d_first_dom#13350,d_last_dom#13351,d_same_day_ly#13352,d_same_day_lq#13353,d_current_day#13354,... 4 more fields] parquet
               :  +- SubqueryAlias `store`
               :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 123.863407076s
Running execution q18-v2.4 iteration: 1, StandardRun=true
19/09/08 19:14:52 INFO Query:
== Query: q18-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ca_country#14191 ASC NULLS FIRST, ca_state#14192 ASC NULLS FIRST, ca_county#14193 ASC NULLS FIRST, i_item_id#14190 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#14190, ca_country#14191, ca_state#14192, ca_county#14193, spark_grouping_id#14185], [i_item_id#14190, ca_country#14191, ca_state#14192, ca_county#14193, avg(cast(cs_quantity#18 as decimal(12,2))) AS agg1#14162, avg(cast(cs_list_price#20 as decimal(12,2))) AS agg2#14163, avg(cast(cs_coupon_amt#27 as decimal(12,2))) AS agg3#14164, avg(cast(cs_sales_price#21 as decimal(12,2))) AS agg4#14165, avg(cast(cs_net_profit#33 as decimal(12,2))) AS agg5#14166, avg(cast(c_birth_year#425 as decimal(12,2))) AS agg6#14167, avg(cast(cd_dep_count#480 as decimal(12,2))) AS agg7#14168]
         +- Expand [List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14169, cd_gender#14170, cd_marital_status#14171, cd_education_status#14172, cd_purchase_estimate#14173, cd_credit_rating#14174, cd_dep_count#14175, cd_dep_employed_count#14176, cd_dep_college_count#14177, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14186, ca_country#14187, ca_state#14188, ca_county#14189, 0), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14169, cd_gender#14170, cd_marital_status#14171, cd_education_status#14172, cd_purchase_estimate#14173, cd_credit_rating#14174, cd_dep_count#14175, cd_dep_employed_count#14176, cd_dep_college_count#14177, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14186, ca_country#14187, ca_state#14188, null, 1), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14169, cd_gender#14170, cd_marital_status#14171, cd_education_status#14172, cd_purchase_estimate#14173, cd_credit_rating#14174, cd_dep_count#14175, cd_dep_employed_count#14176, cd_dep_college_count#14177, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14186, ca_country#14187, null, null, 3), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14169, cd_gender#14170, cd_marital_status#14171, cd_education_status#14172, cd_purchase_estimate#14173, cd_credit_rating#14174, cd_dep_count#14175, cd_dep_employed_count#14176, cd_dep_college_count#14177, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14186, null, null, null, 7), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14169, cd_gender#14170, cd_marital_status#14171, cd_education_status#14172, cd_purchase_estimate#14173, cd_credit_rating#14174, cd_dep_count#14175, cd_dep_employed_count#14176, cd_dep_college_count#14177, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, null, null, 15)], [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 114 more fields]
            +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 113 more fields]
               +- Filter (((((cs_sold_date_sk#0 = d_date_sk#492) && (cs_item_sk#15 = i_item_sk#564)) && (cs_bill_cdemo_sk#4 = cd_demo_sk#474)) && (((cs_bill_customer_sk#3 = c_customer_sk#412) && (cd_gender#475 = F)) && (cd_education_status#477 = Unknown))) && ((((c_current_cdemo_sk#414 = cd_demo_sk#14169) && (c_current_addr_sk#416 = ca_address_sk#448)) && c_birth_month#424 IN (1,6,8,9,12,2)) && ((d_year#498 = 1998) && ca_state#456 IN (MS,IN,ND,OK,NM,VA,MS))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- Join Inner
                     :  :  :  :  :  :- SubqueryAlias `catalog_sales`
                     :  :  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :  :  :  :  :  +- SubqueryAlias `cd1`
                     :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                     :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                     :  :  :  :  +- SubqueryAlias `cd2`
                     :  :  :  :     +- SubqueryAlias `customer_demographics`
                     :  :  :  :        +- Relation[cd_demo_sk#14169,cd_gender#14170,cd_marital_status#14171,cd_education_status#14172,cd_purchase_estimate#14173,cd_credit_rating#14174,cd_dep_count#14175,cd_dep_employed_count#14176,cd_dep_college_count#14177] parquet
                     :  :  :  +- SubqueryAlias `customer`
                     :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     :  :  +- SubqueryAlias `customer_address`
                     :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                     :  +- SubqueryAlias `date_dim`
                     :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- SubqueryAlias `item`
                        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 19:14:52 INFO Query:
== Query: q18-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ca_country#14238 ASC NULLS FIRST, ca_state#14239 ASC NULLS FIRST, ca_county#14240 ASC NULLS FIRST, i_item_id#14237 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#14237, ca_country#14238, ca_state#14239, ca_county#14240, spark_grouping_id#14232], [i_item_id#14237, ca_country#14238, ca_state#14239, ca_county#14240, avg(cast(cs_quantity#18 as decimal(12,2))) AS agg1#14209, avg(cast(cs_list_price#20 as decimal(12,2))) AS agg2#14210, avg(cast(cs_coupon_amt#27 as decimal(12,2))) AS agg3#14211, avg(cast(cs_sales_price#21 as decimal(12,2))) AS agg4#14212, avg(cast(cs_net_profit#33 as decimal(12,2))) AS agg5#14213, avg(cast(c_birth_year#425 as decimal(12,2))) AS agg6#14214, avg(cast(cd_dep_count#480 as decimal(12,2))) AS agg7#14215]
         +- Expand [List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14216, cd_gender#14217, cd_marital_status#14218, cd_education_status#14219, cd_purchase_estimate#14220, cd_credit_rating#14221, cd_dep_count#14222, cd_dep_employed_count#14223, cd_dep_college_count#14224, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14233, ca_country#14234, ca_state#14235, ca_county#14236, 0), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14216, cd_gender#14217, cd_marital_status#14218, cd_education_status#14219, cd_purchase_estimate#14220, cd_credit_rating#14221, cd_dep_count#14222, cd_dep_employed_count#14223, cd_dep_college_count#14224, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14233, ca_country#14234, ca_state#14235, null, 1), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14216, cd_gender#14217, cd_marital_status#14218, cd_education_status#14219, cd_purchase_estimate#14220, cd_credit_rating#14221, cd_dep_count#14222, cd_dep_employed_count#14223, cd_dep_college_count#14224, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14233, ca_country#14234, null, null, 3), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14216, cd_gender#14217, cd_marital_status#14218, cd_education_status#14219, cd_purchase_estimate#14220, cd_credit_rating#14221, cd_dep_count#14222, cd_dep_employed_count#14223, cd_dep_college_count#14224, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14233, null, null, null, 7), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14216, cd_gender#14217, cd_marital_status#14218, cd_education_status#14219, cd_purchase_estimate#14220, cd_credit_rating#14221, cd_dep_count#14222, cd_dep_employed_count#14223, cd_dep_college_count#14224, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, null, null, 15)], [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 114 more fields]
            +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 113 more fields]
               +- Filter (((((cs_sold_date_sk#0 = d_date_sk#492) && (cs_item_sk#15 = i_item_sk#564)) && (cs_bill_cdemo_sk#4 = cd_demo_sk#474)) && (((cs_bill_customer_sk#3 = c_customer_sk#412) && (cd_gender#475 = F)) && (cd_education_status#477 = Unknown))) && ((((c_current_cdemo_sk#414 = cd_demo_sk#14216) && (c_current_addr_sk#416 = ca_address_sk#448)) && c_birth_month#424 IN (1,6,8,9,12,2)) && ((d_year#498 = 1998) && ca_state#456 IN (MS,IN,ND,OK,NM,VA,MS))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- Join Inner
                     :  :  :  :  :  :- SubqueryAlias `catalog_sales`
                     :  :  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :  :  :  :  :  +- SubqueryAlias `cd1`
                     :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                     :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                     :  :  :  :  +- SubqueryAlias `cd2`
                     :  :  :  :     +- SubqueryAlias `customer_demographics`
                     :  :  :  :        +- Relation[cd_demo_sk#14216,cd_gender#14217,cd_marital_status#14218,cd_education_status#14219,cd_purchase_estimate#14220,cd_credit_rating#14221,cd_dep_count#14222,cd_dep_employed_count#14223,cd_dep_college_count#14224] parquet
                     :  :  :  +- SubqueryAlias `customer`
                     :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     :  :  +- SubqueryAlias `customer_address`
                     :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                     :  +- SubqueryAlias `date_dim`
                     :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- SubqueryAlias `item`
                        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 24.178040590000002s
Running execution q19-v2.4 iteration: 1, StandardRun=true
19/09/08 19:15:18 INFO Query:
== Query: q19-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ext_price#14397 DESC NULLS LAST, brand#14396 ASC NULLS FIRST, brand_id#14395 ASC NULLS FIRST, i_manufact_id#577 ASC NULLS FIRST, i_manufact#578 ASC NULLS FIRST], true
      +- Aggregate [i_brand#572, i_brand_id#571, i_manufact_id#577, i_manufact#578], [i_brand_id#571 AS brand_id#14395, i_brand#572 AS brand#14396, i_manufact_id#577, i_manufact#578, sum(ss_ext_sales_price#145) AS ext_price#14397]
         +- Filter (((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 8)) && ((d_moy#500 = 11) && (d_year#498 = 1998))) && (((ss_customer_sk#133 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && (NOT (substring(ca_zip#457, 1, 5) = substring(s_zip#689, 1, 5)) && (ss_store_sk#137 = s_store_sk#664))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- Join Inner
               :  :  :  :- Join Inner
               :  :  :  :  :- SubqueryAlias `date_dim`
               :  :  :  :  :  +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  +- SubqueryAlias `store_sales`
               :  :  :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  +- SubqueryAlias `item`
               :  :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `customer`
               :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  +- SubqueryAlias `customer_address`
               :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `store`
                  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/09/08 19:15:18 INFO Query:
== Query: q19-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ext_price#14411 DESC NULLS LAST, brand#14410 ASC NULLS FIRST, brand_id#14409 ASC NULLS FIRST, i_manufact_id#577 ASC NULLS FIRST, i_manufact#578 ASC NULLS FIRST], true
      +- Aggregate [i_brand#572, i_brand_id#571, i_manufact_id#577, i_manufact#578], [i_brand_id#571 AS brand_id#14409, i_brand#572 AS brand#14410, i_manufact_id#577, i_manufact#578, sum(ss_ext_sales_price#145) AS ext_price#14411]
         +- Filter (((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 8)) && ((d_moy#500 = 11) && (d_year#498 = 1998))) && (((ss_customer_sk#133 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && (NOT (substring(ca_zip#457, 1, 5) = substring(s_zip#689, 1, 5)) && (ss_store_sk#137 = s_store_sk#664))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- Join Inner
               :  :  :  :- Join Inner
               :  :  :  :  :- SubqueryAlias `date_dim`
               :  :  :  :  :  +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  +- SubqueryAlias `store_sales`
               :  :  :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  +- SubqueryAlias `item`
               :  :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `customer`
               :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  +- SubqueryAlias `customer_address`
               :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `store`
                  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 15.92696997s
Running execution q20-v2.4 iteration: 1, StandardRun=true
19/09/08 19:15:35 INFO Query:
== Query: q20-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#576 ASC NULLS FIRST, i_class#574 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, revenueratio#14473 ASC NULLS FIRST], true
      +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#14472, revenueratio#14473]
         +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#14472, _w0#14478, _w1#14479, _we0#14480, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(_w0#14478 as decimal(17,2))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(17,2)))), DecimalType(21,2)) as decimal(27,2))) / promote_precision(cast(_we0#14480 as decimal(27,2)))), DecimalType(38,17)) AS revenueratio#14473]
            +- Window [sum(_w1#14479) windowspecdefinition(i_class#574, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#14480], [i_class#574]
               +- Aggregate [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569], [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, sum(cs_ext_sales_price#23) AS itemrevenue#14472, sum(cs_ext_sales_price#23) AS _w0#14478, sum(cs_ext_sales_price#23) AS _w1#14479]
                  +- Filter (((cs_item_sk#15 = i_item_sk#564) && i_category#576 IN (Sports,Books,Home)) && ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(1999-02-22 as date)) && (d_date#494 <= cast(cast(cast(1999-02-22 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `catalog_sales`
                        :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  +- SubqueryAlias `item`
                        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 19:15:35 INFO Query:
== Query: q20-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#576 ASC NULLS FIRST, i_class#574 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, revenueratio#14489 ASC NULLS FIRST], true
      +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#14488, revenueratio#14489]
         +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#14488, _w0#14494, _w1#14495, _we0#14496, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(_w0#14494 as decimal(17,2))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(17,2)))), DecimalType(21,2)) as decimal(27,2))) / promote_precision(cast(_we0#14496 as decimal(27,2)))), DecimalType(38,17)) AS revenueratio#14489]
            +- Window [sum(_w1#14495) windowspecdefinition(i_class#574, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#14496], [i_class#574]
               +- Aggregate [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569], [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, sum(cs_ext_sales_price#23) AS itemrevenue#14488, sum(cs_ext_sales_price#23) AS _w0#14494, sum(cs_ext_sales_price#23) AS _w1#14495]
                  +- Filter (((cs_item_sk#15 = i_item_sk#564) && i_category#576 IN (Sports,Books,Home)) && ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(1999-02-22 as date)) && (d_date#494 <= cast(cast(cast(1999-02-22 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `catalog_sales`
                        :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  +- SubqueryAlias `item`
                        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 7.63015824s
Running execution q21-v2.4 iteration: 1, StandardRun=true
19/09/08 19:15:44 INFO Query:
== Query: q21-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [w_warehouse_name#744 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST], true
      +- Project [w_warehouse_name#744, i_item_id#565, inv_before#14551L, inv_after#14552L]
         +- Filter ((CASE WHEN (inv_before#14551L > cast(0 as bigint)) THEN (cast(inv_after#14552L as double) / cast(inv_before#14551L as double)) ELSE cast(null as double) END >= cast(CheckOverflow((promote_precision(cast(2.0 as decimal(2,1))) / promote_precision(cast(3.0 as decimal(2,1)))), DecimalType(8,6)) as double)) && (CASE WHEN (inv_before#14551L > cast(0 as bigint)) THEN (cast(inv_after#14552L as double) / cast(inv_before#14551L as double)) ELSE cast(null as double) END <= cast(CheckOverflow((promote_precision(cast(3.0 as decimal(2,1))) / promote_precision(cast(2.0 as decimal(2,1)))), DecimalType(8,6)) as double)))
            +- SubqueryAlias `x`
               +- Aggregate [w_warehouse_name#744, i_item_id#565], [w_warehouse_name#744, i_item_id#565, sum(cast(CASE WHEN (cast(d_date#494 as date) < cast(2000-03-11 as date)) THEN inv_quantity_on_hand#125 ELSE 0 END as bigint)) AS inv_before#14551L, sum(cast(CASE WHEN (cast(d_date#494 as date) >= cast(2000-03-11 as date)) THEN inv_quantity_on_hand#125 ELSE 0 END as bigint)) AS inv_after#14552L]
                  +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(0.99 as decimal(7,2))) && (cast(i_current_price#569 as decimal(7,2)) <= cast(1.49 as decimal(7,2)))) && (i_item_sk#564 = inv_item_sk#123)) && (inv_warehouse_sk#124 = w_warehouse_sk#742)) && ((inv_date_sk#122 = d_date_sk#492) && ((d_date#494 >= cast(cast(cast(2000-03-11 as date) as timestamp) - interval 4 weeks 2 days as date)) && (d_date#494 <= cast(cast(cast(2000-03-11 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- SubqueryAlias `inventory`
                        :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                        :  :  +- SubqueryAlias `warehouse`
                        :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                        :  +- SubqueryAlias `item`
                        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 19:15:44 INFO Query:
== Query: q21-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [w_warehouse_name#744 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST], true
      +- Project [w_warehouse_name#744, i_item_id#565, inv_before#14559L, inv_after#14560L]
         +- Filter ((CASE WHEN (inv_before#14559L > cast(0 as bigint)) THEN (cast(inv_after#14560L as double) / cast(inv_before#14559L as double)) ELSE cast(null as double) END >= cast(CheckOverflow((promote_precision(cast(2.0 as decimal(2,1))) / promote_precision(cast(3.0 as decimal(2,1)))), DecimalType(8,6)) as double)) && (CASE WHEN (inv_before#14559L > cast(0 as bigint)) THEN (cast(inv_after#14560L as double) / cast(inv_before#14559L as double)) ELSE cast(null as double) END <= cast(CheckOverflow((promote_precision(cast(3.0 as decimal(2,1))) / promote_precision(cast(2.0 as decimal(2,1)))), DecimalType(8,6)) as double)))
            +- SubqueryAlias `x`
               +- Aggregate [w_warehouse_name#744, i_item_id#565], [w_warehouse_name#744, i_item_id#565, sum(cast(CASE WHEN (cast(d_date#494 as date) < cast(2000-03-11 as date)) THEN inv_quantity_on_hand#125 ELSE 0 END as bigint)) AS inv_before#14559L, sum(cast(CASE WHEN (cast(d_date#494 as date) >= cast(2000-03-11 as date)) THEN inv_quantity_on_hand#125 ELSE 0 END as bigint)) AS inv_after#14560L]
                  +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(0.99 as decimal(7,2))) && (cast(i_current_price#569 as decimal(7,2)) <= cast(1.49 as decimal(7,2)))) && (i_item_sk#564 = inv_item_sk#123)) && (inv_warehouse_sk#124 = w_warehouse_sk#742)) && ((inv_date_sk#122 = d_date_sk#492) && ((d_date#494 >= cast(cast(cast(2000-03-11 as date) as timestamp) - interval 4 weeks 2 days as date)) && (d_date#494 <= cast(cast(cast(2000-03-11 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- SubqueryAlias `inventory`
                        :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                        :  :  +- SubqueryAlias `warehouse`
                        :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                        :  +- SubqueryAlias `item`
                        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 5.87263106s
Running execution q22-v2.4 iteration: 1, StandardRun=true
19/09/08 19:15:51 INFO Query:
== Query: q22-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [qoh#14613 ASC NULLS FIRST, i_product_name#14620 ASC NULLS FIRST, i_brand#14621 ASC NULLS FIRST, i_class#14622 ASC NULLS FIRST, i_category#14623 ASC NULLS FIRST], true
      +- Aggregate [i_product_name#14620, i_brand#14621, i_class#14622, i_category#14623, spark_grouping_id#14615], [i_product_name#14620, i_brand#14621, i_class#14622, i_category#14623, avg(cast(inv_quantity_on_hand#125 as bigint)) AS qoh#14613]
         +- Expand [List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14616, i_brand#14617, i_class#14618, i_category#14619, 0), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14616, i_brand#14617, i_class#14618, null, 1), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14616, i_brand#14617, null, null, 3), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14616, null, null, null, 7), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, null, null, null, null, 15)], [inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, ... 49 more fields]
            +- Project [inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, ... 48 more fields]
               +- Filter (((inv_date_sk#122 = d_date_sk#492) && (inv_item_sk#123 = i_item_sk#564)) && ((inv_warehouse_sk#124 = w_warehouse_sk#742) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11)))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- SubqueryAlias `inventory`
                     :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                     :  :  +- SubqueryAlias `date_dim`
                     :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- SubqueryAlias `item`
                     :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     +- SubqueryAlias `warehouse`
                        +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet

     : benchmark
19/09/08 19:15:51 INFO Query:
== Query: q22-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [qoh#14634 ASC NULLS FIRST, i_product_name#14641 ASC NULLS FIRST, i_brand#14642 ASC NULLS FIRST, i_class#14643 ASC NULLS FIRST, i_category#14644 ASC NULLS FIRST], true
      +- Aggregate [i_product_name#14641, i_brand#14642, i_class#14643, i_category#14644, spark_grouping_id#14636], [i_product_name#14641, i_brand#14642, i_class#14643, i_category#14644, avg(cast(inv_quantity_on_hand#125 as bigint)) AS qoh#14634]
         +- Expand [List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14637, i_brand#14638, i_class#14639, i_category#14640, 0), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14637, i_brand#14638, i_class#14639, null, 1), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14637, i_brand#14638, null, null, 3), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14637, null, null, null, 7), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, null, null, null, null, 15)], [inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, ... 49 more fields]
            +- Project [inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, ... 48 more fields]
               +- Filter (((inv_date_sk#122 = d_date_sk#492) && (inv_item_sk#123 = i_item_sk#564)) && ((inv_warehouse_sk#124 = w_warehouse_sk#742) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11)))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- SubqueryAlias `inventory`
                     :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                     :  :  +- SubqueryAlias `date_dim`
                     :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- SubqueryAlias `item`
                     :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     +- SubqueryAlias `warehouse`
                        +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet

      running Thread[benchmark runner,5,main]
Execution time: 18.75074137s
Running execution q23a-v2.4 iteration: 1, StandardRun=true
19/09/08 19:16:11 INFO Query:
== Query: q23a-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [sum(sales#14759) AS sum(sales)#14794]
      +- SubqueryAlias `x`
         +- Union
            :- Project [CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2)) AS sales#14759]
            :  +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (cs_sold_date_sk#0 = d_date_sk#492)) && (cs_item_sk#15 IN (list#14760 []) && cs_bill_customer_sk#3 IN (list#14761 [])))
            :     :  :- Project [item_sk#14766]
            :     :  :  +- SubqueryAlias `frequent_ss_items`
            :     :  :     +- Project [itemdesc#14765, item_sk#14766, solddate#14767, cnt#14768L]
            :     :  :        +- Filter (count(1)#14776L > cast(4 as bigint))
            :     :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#14765, i_item_sk#564 AS item_sk#14766, d_date#494 AS solddate#14767, count(1) AS cnt#14768L, count(1) AS count(1)#14776L]
            :     :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
            :     :  :                 +- Join Inner
            :     :  :                    :- Join Inner
            :     :  :                    :  :- SubqueryAlias `store_sales`
            :     :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :  :                    :  +- SubqueryAlias `date_dim`
            :     :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     :  :                    +- SubqueryAlias `item`
            :     :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            :     :  +- Project [c_customer_sk#412]
            :     :     +- SubqueryAlias `best_ss_customer`
            :     :        +- Project [c_customer_sk#412, ssales#14771]
            :     :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14783 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#14772 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
            :     :              :  +- Project [tpcds_cmax#14770]
            :     :              :     +- SubqueryAlias `max_store_sales`
            :     :              :        +- Aggregate [max(csales#14769) AS tpcds_cmax#14770]
            :     :              :           +- SubqueryAlias `x`
            :     :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#14769]
            :     :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
            :     :              :                    +- Join Inner
            :     :              :                       :- Join Inner
            :     :              :                       :  :- SubqueryAlias `store_sales`
            :     :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :              :                       :  +- SubqueryAlias `customer`
            :     :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :     :              :                       +- SubqueryAlias `date_dim`
            :     :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#14771, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14783]
            :     :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
            :     :                    +- Join Inner
            :     :                       :- SubqueryAlias `store_sales`
            :     :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :                       +- SubqueryAlias `customer`
            :     :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :     +- Join Inner
            :        :- SubqueryAlias `catalog_sales`
            :        :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :        +- SubqueryAlias `date_dim`
            :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Project [CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2)) AS sales#14762]
               +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (ws_sold_date_sk#216 = d_date_sk#492)) && (ws_item_sk#219 IN (list#14763 []) && ws_bill_customer_sk#220 IN (list#14764 [])))
                  :  :- Project [item_sk#14766]
                  :  :  +- SubqueryAlias `frequent_ss_items`
                  :  :     +- Project [itemdesc#14765, item_sk#14766, solddate#14767, cnt#14768L]
                  :  :        +- Filter (count(1)#14776L > cast(4 as bigint))
                  :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#14765, i_item_sk#564 AS item_sk#14766, d_date#494 AS solddate#14767, count(1) AS cnt#14768L, count(1) AS count(1)#14776L]
                  :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                  :  :                 +- Join Inner
                  :  :                    :- Join Inner
                  :  :                    :  :- SubqueryAlias `store_sales`
                  :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :                    :  +- SubqueryAlias `date_dim`
                  :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  :                    +- SubqueryAlias `item`
                  :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  :  +- Project [c_customer_sk#412]
                  :     +- SubqueryAlias `best_ss_customer`
                  :        +- Project [c_customer_sk#412, ssales#14771]
                  :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14783 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#14772 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
                  :              :  +- Project [tpcds_cmax#14770]
                  :              :     +- SubqueryAlias `max_store_sales`
                  :              :        +- Aggregate [max(csales#14769) AS tpcds_cmax#14770]
                  :              :           +- SubqueryAlias `x`
                  :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#14769]
                  :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                  :              :                    +- Join Inner
                  :              :                       :- Join Inner
                  :              :                       :  :- SubqueryAlias `store_sales`
                  :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :              :                       :  +- SubqueryAlias `customer`
                  :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :              :                       +- SubqueryAlias `date_dim`
                  :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#14771, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14783]
                  :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
                  :                    +- Join Inner
                  :                       :- SubqueryAlias `store_sales`
                  :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :                       +- SubqueryAlias `customer`
                  :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  +- Join Inner
                     :- SubqueryAlias `web_sales`
                     :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 19:16:11 INFO Query:
== Query: q23a-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [sum(sales#14796) AS sum(sales)#14831]
      +- SubqueryAlias `x`
         +- Union
            :- Project [CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2)) AS sales#14796]
            :  +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (cs_sold_date_sk#0 = d_date_sk#492)) && (cs_item_sk#15 IN (list#14797 []) && cs_bill_customer_sk#3 IN (list#14798 [])))
            :     :  :- Project [item_sk#14803]
            :     :  :  +- SubqueryAlias `frequent_ss_items`
            :     :  :     +- Project [itemdesc#14802, item_sk#14803, solddate#14804, cnt#14805L]
            :     :  :        +- Filter (count(1)#14813L > cast(4 as bigint))
            :     :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#14802, i_item_sk#564 AS item_sk#14803, d_date#494 AS solddate#14804, count(1) AS cnt#14805L, count(1) AS count(1)#14813L]
            :     :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
            :     :  :                 +- Join Inner
            :     :  :                    :- Join Inner
            :     :  :                    :  :- SubqueryAlias `store_sales`
            :     :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :  :                    :  +- SubqueryAlias `date_dim`
            :     :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     :  :                    +- SubqueryAlias `item`
            :     :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            :     :  +- Project [c_customer_sk#412]
            :     :     +- SubqueryAlias `best_ss_customer`
            :     :        +- Project [c_customer_sk#412, ssales#14808]
            :     :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14820 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#14809 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
            :     :              :  +- Project [tpcds_cmax#14807]
            :     :              :     +- SubqueryAlias `max_store_sales`
            :     :              :        +- Aggregate [max(csales#14806) AS tpcds_cmax#14807]
            :     :              :           +- SubqueryAlias `x`
            :     :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#14806]
            :     :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
            :     :              :                    +- Join Inner
            :     :              :                       :- Join Inner
            :     :              :                       :  :- SubqueryAlias `store_sales`
            :     :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :              :                       :  +- SubqueryAlias `customer`
            :     :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :     :              :                       +- SubqueryAlias `date_dim`
            :     :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#14808, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14820]
            :     :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
            :     :                    +- Join Inner
            :     :                       :- SubqueryAlias `store_sales`
            :     :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :                       +- SubqueryAlias `customer`
            :     :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :     +- Join Inner
            :        :- SubqueryAlias `catalog_sales`
            :        :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :        +- SubqueryAlias `date_dim`
            :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Project [CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2)) AS sales#14799]
               +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (ws_sold_date_sk#216 = d_date_sk#492)) && (ws_item_sk#219 IN (list#14800 []) && ws_bill_customer_sk#220 IN (list#14801 [])))
                  :  :- Project [item_sk#14803]
                  :  :  +- SubqueryAlias `frequent_ss_items`
                  :  :     +- Project [itemdesc#14802, item_sk#14803, solddate#14804, cnt#14805L]
                  :  :        +- Filter (count(1)#14813L > cast(4 as bigint))
                  :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#14802, i_item_sk#564 AS item_sk#14803, d_date#494 AS solddate#14804, count(1) AS cnt#14805L, count(1) AS count(1)#14813L]
                  :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                  :  :                 +- Join Inner
                  :  :                    :- Join Inner
                  :  :                    :  :- SubqueryAlias `store_sales`
                  :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :                    :  +- SubqueryAlias `date_dim`
                  :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  :                    +- SubqueryAlias `item`
                  :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  :  +- Project [c_customer_sk#412]
                  :     +- SubqueryAlias `best_ss_customer`
                  :        +- Project [c_customer_sk#412, ssales#14808]
                  :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14820 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#14809 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
                  :              :  +- Project [tpcds_cmax#14807]
                  :              :     +- SubqueryAlias `max_store_sales`
                  :              :        +- Aggregate [max(csales#14806) AS tpcds_cmax#14807]
                  :              :           +- SubqueryAlias `x`
                  :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#14806]
                  :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                  :              :                    +- Join Inner
                  :              :                       :- Join Inner
                  :              :                       :  :- SubqueryAlias `store_sales`
                  :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :              :                       :  +- SubqueryAlias `customer`
                  :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :              :                       +- SubqueryAlias `date_dim`
                  :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#14808, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14820]
                  :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
                  :                    +- Join Inner
                  :                       :- SubqueryAlias `store_sales`
                  :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :                       +- SubqueryAlias `customer`
                  :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  +- Join Inner
                     :- SubqueryAlias `web_sales`
                     :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 356.048664282s
Running execution q23b-v2.4 iteration: 1, StandardRun=true
19/09/08 19:22:10 INFO Query:
== Query: q23b-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, sales#14993 ASC NULLS FIRST], true
      +- Project [c_last_name#421, c_first_name#420, sales#14993]
         +- SubqueryAlias `y`
            +- Union
               :- Aggregate [c_last_name#421, c_first_name#420], [c_last_name#421, c_first_name#420, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2))) AS sales#14993]
               :  +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((cs_item_sk#15 IN (list#14994 []) && cs_bill_customer_sk#3 IN (list#14995 [])) && (cs_bill_customer_sk#3 = c_customer_sk#412)))
               :     :  :- Project [item_sk#15000]
               :     :  :  +- SubqueryAlias `frequent_ss_items`
               :     :  :     +- Project [itemdesc#14999, item_sk#15000, solddate#15001, cnt#15002L]
               :     :  :        +- Filter (count(1)#15010L > cast(4 as bigint))
               :     :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#14999, i_item_sk#564 AS item_sk#15000, d_date#494 AS solddate#15001, count(1) AS cnt#15002L, count(1) AS count(1)#15010L]
               :     :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
               :     :  :                 +- Join Inner
               :     :  :                    :- Join Inner
               :     :  :                    :  :- SubqueryAlias `store_sales`
               :     :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :     :  :                    :  +- SubqueryAlias `date_dim`
               :     :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :     :  :                    +- SubqueryAlias `item`
               :     :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :     :  +- Project [c_customer_sk#412]
               :     :     +- SubqueryAlias `best_ss_customer`
               :     :        +- Project [c_customer_sk#412, ssales#15005]
               :     :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#15017 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#15006 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
               :     :              :  +- Project [tpcds_cmax#15004]
               :     :              :     +- SubqueryAlias `max_store_sales`
               :     :              :        +- Aggregate [max(csales#15003) AS tpcds_cmax#15004]
               :     :              :           +- SubqueryAlias `x`
               :     :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#15003]
               :     :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
               :     :              :                    +- Join Inner
               :     :              :                       :- Join Inner
               :     :              :                       :  :- SubqueryAlias `store_sales`
               :     :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :     :              :                       :  +- SubqueryAlias `customer`
               :     :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :     :              :                       +- SubqueryAlias `date_dim`
               :     :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :     :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#15005, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#15017]
               :     :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
               :     :                    +- Join Inner
               :     :                       :- SubqueryAlias `store_sales`
               :     :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :     :                       +- SubqueryAlias `customer`
               :     :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :     +- Join Inner
               :        :- Join Inner
               :        :  :- SubqueryAlias `catalog_sales`
               :        :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :        :  +- SubqueryAlias `customer`
               :        :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :        +- SubqueryAlias `date_dim`
               :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- Aggregate [c_last_name#421, c_first_name#420], [c_last_name#421, c_first_name#420, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2))) AS sales#14996]
                  +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((ws_item_sk#219 IN (list#14997 []) && ws_bill_customer_sk#220 IN (list#14998 [])) && (ws_bill_customer_sk#220 = c_customer_sk#412)))
                     :  :- Project [item_sk#15000]
                     :  :  +- SubqueryAlias `frequent_ss_items`
                     :  :     +- Project [itemdesc#14999, item_sk#15000, solddate#15001, cnt#15002L]
                     :  :        +- Filter (count(1)#15010L > cast(4 as bigint))
                     :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#14999, i_item_sk#564 AS item_sk#15000, d_date#494 AS solddate#15001, count(1) AS cnt#15002L, count(1) AS count(1)#15010L]
                     :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                     :  :                 +- Join Inner
                     :  :                    :- Join Inner
                     :  :                    :  :- SubqueryAlias `store_sales`
                     :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :                    :  +- SubqueryAlias `date_dim`
                     :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :                    +- SubqueryAlias `item`
                     :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  +- Project [c_customer_sk#412]
                     :     +- SubqueryAlias `best_ss_customer`
                     :        +- Project [c_customer_sk#412, ssales#15005]
                     :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#15017 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#15006 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
                     :              :  +- Project [tpcds_cmax#15004]
                     :              :     +- SubqueryAlias `max_store_sales`
                     :              :        +- Aggregate [max(csales#15003) AS tpcds_cmax#15004]
                     :              :           +- SubqueryAlias `x`
                     :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#15003]
                     :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                     :              :                    +- Join Inner
                     :              :                       :- Join Inner
                     :              :                       :  :- SubqueryAlias `store_sales`
                     :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :              :                       :  +- SubqueryAlias `customer`
                     :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     :              :                       +- SubqueryAlias `date_dim`
                     :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#15005, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#15017]
                     :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
                     :                    +- Join Inner
                     :                       :- SubqueryAlias `store_sales`
                     :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :                       +- SubqueryAlias `customer`
                     :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `web_sales`
                        :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  +- SubqueryAlias `customer`
                        :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 19:22:10 INFO Query:
== Query: q23b-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, sales#15032 ASC NULLS FIRST], true
      +- Project [c_last_name#421, c_first_name#420, sales#15032]
         +- SubqueryAlias `y`
            +- Union
               :- Aggregate [c_last_name#421, c_first_name#420], [c_last_name#421, c_first_name#420, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2))) AS sales#15032]
               :  +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((cs_item_sk#15 IN (list#15033 []) && cs_bill_customer_sk#3 IN (list#15034 [])) && (cs_bill_customer_sk#3 = c_customer_sk#412)))
               :     :  :- Project [item_sk#15039]
               :     :  :  +- SubqueryAlias `frequent_ss_items`
               :     :  :     +- Project [itemdesc#15038, item_sk#15039, solddate#15040, cnt#15041L]
               :     :  :        +- Filter (count(1)#15049L > cast(4 as bigint))
               :     :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#15038, i_item_sk#564 AS item_sk#15039, d_date#494 AS solddate#15040, count(1) AS cnt#15041L, count(1) AS count(1)#15049L]
               :     :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
               :     :  :                 +- Join Inner
               :     :  :                    :- Join Inner
               :     :  :                    :  :- SubqueryAlias `store_sales`
               :     :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :     :  :                    :  +- SubqueryAlias `date_dim`
               :     :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :     :  :                    +- SubqueryAlias `item`
               :     :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :     :  +- Project [c_customer_sk#412]
               :     :     +- SubqueryAlias `best_ss_customer`
               :     :        +- Project [c_customer_sk#412, ssales#15044]
               :     :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#15056 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#15045 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
               :     :              :  +- Project [tpcds_cmax#15043]
               :     :              :     +- SubqueryAlias `max_store_sales`
               :     :              :        +- Aggregate [max(csales#15042) AS tpcds_cmax#15043]
               :     :              :           +- SubqueryAlias `x`
               :     :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#15042]
               :     :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
               :     :              :                    +- Join Inner
               :     :              :                       :- Join Inner
               :     :              :                       :  :- SubqueryAlias `store_sales`
               :     :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :     :              :                       :  +- SubqueryAlias `customer`
               :     :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :     :              :                       +- SubqueryAlias `date_dim`
               :     :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :     :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#15044, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#15056]
               :     :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
               :     :                    +- Join Inner
               :     :                       :- SubqueryAlias `store_sales`
               :     :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :     :                       +- SubqueryAlias `customer`
               :     :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :     +- Join Inner
               :        :- Join Inner
               :        :  :- SubqueryAlias `catalog_sales`
               :        :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :        :  +- SubqueryAlias `customer`
               :        :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :        +- SubqueryAlias `date_dim`
               :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- Aggregate [c_last_name#421, c_first_name#420], [c_last_name#421, c_first_name#420, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2))) AS sales#15035]
                  +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((ws_item_sk#219 IN (list#15036 []) && ws_bill_customer_sk#220 IN (list#15037 [])) && (ws_bill_customer_sk#220 = c_customer_sk#412)))
                     :  :- Project [item_sk#15039]
                     :  :  +- SubqueryAlias `frequent_ss_items`
                     :  :     +- Project [itemdesc#15038, item_sk#15039, solddate#15040, cnt#15041L]
                     :  :        +- Filter (count(1)#15049L > cast(4 as bigint))
                     :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#15038, i_item_sk#564 AS item_sk#15039, d_date#494 AS solddate#15040, count(1) AS cnt#15041L, count(1) AS count(1)#15049L]
                     :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                     :  :                 +- Join Inner
                     :  :                    :- Join Inner
                     :  :                    :  :- SubqueryAlias `store_sales`
                     :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :                    :  +- SubqueryAlias `date_dim`
                     :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :                    +- SubqueryAlias `item`
                     :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  +- Project [c_customer_sk#412]
                     :     +- SubqueryAlias `best_ss_customer`
                     :        +- Project [c_customer_sk#412, ssales#15044]
                     :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#15056 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#15045 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
                     :              :  +- Project [tpcds_cmax#15043]
                     :              :     +- SubqueryAlias `max_store_sales`
                     :              :        +- Aggregate [max(csales#15042) AS tpcds_cmax#15043]
                     :              :           +- SubqueryAlias `x`
                     :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#15042]
                     :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                     :              :                    +- Join Inner
                     :              :                       :- Join Inner
                     :              :                       :  :- SubqueryAlias `store_sales`
                     :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :              :                       :  +- SubqueryAlias `customer`
                     :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     :              :                       +- SubqueryAlias `date_dim`
                     :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#15044, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#15056]
                     :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
                     :                    +- Join Inner
                     :                       :- SubqueryAlias `store_sales`
                     :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :                       +- SubqueryAlias `customer`
                     :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `web_sales`
                        :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  +- SubqueryAlias `customer`
                        :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 271.29222407400005s
Running execution q24a-v2.4 iteration: 1, StandardRun=true
19/09/08 19:26:45 INFO Query:
== Query: q24a-v2.4 ==
Project [c_last_name#421, c_first_name#420, s_store_name#669, paid#15201]
+- Filter (cast(sum(netpaid#15203)#15210 as decimal(33,8)) > cast(scalar-subquery#15202 [] as decimal(33,8)))
   :  +- Aggregate [CheckOverflow((promote_precision(cast(0.05 as decimal(21,6))) * promote_precision(cast(avg(netpaid#15203) as decimal(21,6)))), DecimalType(24,8)) AS (CAST(0.05 AS DECIMAL(21,6)) * CAST(avg(netpaid) AS DECIMAL(21,6)))#15207]
   :     +- SubqueryAlias `ssales`
   :        +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15203]
   :           +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
   :              +- Join Inner
   :                 :- Join Inner
   :                 :  :- Join Inner
   :                 :  :  :- Join Inner
   :                 :  :  :  :- Join Inner
   :                 :  :  :  :  :- SubqueryAlias `store_sales`
   :                 :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :                 :  :  :  :  +- SubqueryAlias `store_returns`
   :                 :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
   :                 :  :  :  +- SubqueryAlias `store`
   :                 :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :                 :  :  +- SubqueryAlias `item`
   :                 :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
   :                 :  +- SubqueryAlias `customer`
   :                 :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
   :                 +- SubqueryAlias `customer_address`
   :                    +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
   +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669], [c_last_name#421, c_first_name#420, s_store_name#669, sum(netpaid#15203) AS paid#15201, sum(netpaid#15203) AS sum(netpaid#15203)#15210]
      +- Filter (i_color#581 = pale)
         +- SubqueryAlias `ssales`
            +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15203]
               +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- SubqueryAlias `store_sales`
                     :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :  :  :  +- SubqueryAlias `store_returns`
                     :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :  :  +- SubqueryAlias `store`
                     :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  :  +- SubqueryAlias `item`
                     :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  +- SubqueryAlias `customer`
                     :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     +- SubqueryAlias `customer_address`
                        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

     : benchmark
19/09/08 19:26:45 INFO Query:
== Query: q24a-v2.4 ==
Project [c_last_name#421, c_first_name#420, s_store_name#669, paid#15216]
+- Filter (cast(sum(netpaid#15218)#15225 as decimal(33,8)) > cast(scalar-subquery#15217 [] as decimal(33,8)))
   :  +- Aggregate [CheckOverflow((promote_precision(cast(0.05 as decimal(21,6))) * promote_precision(cast(avg(netpaid#15218) as decimal(21,6)))), DecimalType(24,8)) AS (CAST(0.05 AS DECIMAL(21,6)) * CAST(avg(netpaid) AS DECIMAL(21,6)))#15222]
   :     +- SubqueryAlias `ssales`
   :        +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15218]
   :           +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
   :              +- Join Inner
   :                 :- Join Inner
   :                 :  :- Join Inner
   :                 :  :  :- Join Inner
   :                 :  :  :  :- Join Inner
   :                 :  :  :  :  :- SubqueryAlias `store_sales`
   :                 :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :                 :  :  :  :  +- SubqueryAlias `store_returns`
   :                 :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
   :                 :  :  :  +- SubqueryAlias `store`
   :                 :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :                 :  :  +- SubqueryAlias `item`
   :                 :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
   :                 :  +- SubqueryAlias `customer`
   :                 :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
   :                 +- SubqueryAlias `customer_address`
   :                    +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
   +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669], [c_last_name#421, c_first_name#420, s_store_name#669, sum(netpaid#15218) AS paid#15216, sum(netpaid#15218) AS sum(netpaid#15218)#15225]
      +- Filter (i_color#581 = pale)
         +- SubqueryAlias `ssales`
            +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15218]
               +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- SubqueryAlias `store_sales`
                     :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :  :  :  +- SubqueryAlias `store_returns`
                     :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :  :  +- SubqueryAlias `store`
                     :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  :  +- SubqueryAlias `item`
                     :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  +- SubqueryAlias `customer`
                     :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     +- SubqueryAlias `customer_address`
                        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

      running Thread[benchmark runner,5,main]
Execution time: 146.92622378299998s
Running execution q24b-v2.4 iteration: 1, StandardRun=true
19/09/08 19:29:14 INFO Query:
== Query: q24b-v2.4 ==
Project [c_last_name#421, c_first_name#420, s_store_name#669, paid#15297]
+- Filter (cast(sum(netpaid#15299)#15306 as decimal(33,8)) > cast(scalar-subquery#15298 [] as decimal(33,8)))
   :  +- Aggregate [CheckOverflow((promote_precision(cast(0.05 as decimal(21,6))) * promote_precision(cast(avg(netpaid#15299) as decimal(21,6)))), DecimalType(24,8)) AS (CAST(0.05 AS DECIMAL(21,6)) * CAST(avg(netpaid) AS DECIMAL(21,6)))#15303]
   :     +- SubqueryAlias `ssales`
   :        +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15299]
   :           +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
   :              +- Join Inner
   :                 :- Join Inner
   :                 :  :- Join Inner
   :                 :  :  :- Join Inner
   :                 :  :  :  :- Join Inner
   :                 :  :  :  :  :- SubqueryAlias `store_sales`
   :                 :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :                 :  :  :  :  +- SubqueryAlias `store_returns`
   :                 :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
   :                 :  :  :  +- SubqueryAlias `store`
   :                 :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :                 :  :  +- SubqueryAlias `item`
   :                 :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
   :                 :  +- SubqueryAlias `customer`
   :                 :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
   :                 +- SubqueryAlias `customer_address`
   :                    +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
   +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669], [c_last_name#421, c_first_name#420, s_store_name#669, sum(netpaid#15299) AS paid#15297, sum(netpaid#15299) AS sum(netpaid#15299)#15306]
      +- Filter (i_color#581 = chiffon)
         +- SubqueryAlias `ssales`
            +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15299]
               +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- SubqueryAlias `store_sales`
                     :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :  :  :  +- SubqueryAlias `store_returns`
                     :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :  :  +- SubqueryAlias `store`
                     :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  :  +- SubqueryAlias `item`
                     :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  +- SubqueryAlias `customer`
                     :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     +- SubqueryAlias `customer_address`
                        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

     : benchmark
19/09/08 19:29:14 INFO Query:
== Query: q24b-v2.4 ==
Project [c_last_name#421, c_first_name#420, s_store_name#669, paid#15312]
+- Filter (cast(sum(netpaid#15314)#15321 as decimal(33,8)) > cast(scalar-subquery#15313 [] as decimal(33,8)))
   :  +- Aggregate [CheckOverflow((promote_precision(cast(0.05 as decimal(21,6))) * promote_precision(cast(avg(netpaid#15314) as decimal(21,6)))), DecimalType(24,8)) AS (CAST(0.05 AS DECIMAL(21,6)) * CAST(avg(netpaid) AS DECIMAL(21,6)))#15318]
   :     +- SubqueryAlias `ssales`
   :        +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15314]
   :           +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
   :              +- Join Inner
   :                 :- Join Inner
   :                 :  :- Join Inner
   :                 :  :  :- Join Inner
   :                 :  :  :  :- Join Inner
   :                 :  :  :  :  :- SubqueryAlias `store_sales`
   :                 :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :                 :  :  :  :  +- SubqueryAlias `store_returns`
   :                 :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
   :                 :  :  :  +- SubqueryAlias `store`
   :                 :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :                 :  :  +- SubqueryAlias `item`
   :                 :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
   :                 :  +- SubqueryAlias `customer`
   :                 :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
   :                 +- SubqueryAlias `customer_address`
   :                    +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
   +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669], [c_last_name#421, c_first_name#420, s_store_name#669, sum(netpaid#15314) AS paid#15312, sum(netpaid#15314) AS sum(netpaid#15314)#15321]
      +- Filter (i_color#581 = chiffon)
         +- SubqueryAlias `ssales`
            +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15314]
               +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- SubqueryAlias `store_sales`
                     :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :  :  :  +- SubqueryAlias `store_returns`
                     :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :  :  +- SubqueryAlias `store`
                     :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  :  +- SubqueryAlias `item`
                     :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  +- SubqueryAlias `customer`
                     :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     +- SubqueryAlias `customer_address`
                        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

      running Thread[benchmark runner,5,main]
Execution time: 134.64600397200002s
Running execution q25-v2.4 iteration: 1, StandardRun=true
19/09/08 19:31:31 INFO Query:
== Query: q25-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, store_sales_profit#15447, store_returns_loss#15448, catalog_sales_profit#15449]
      +- Sort [i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, s_store_id#665 ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669], [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, sum(ss_net_profit#152) AS store_sales_profit#15447, sum(sr_net_loss#195) AS store_returns_loss#15448, sum(cs_net_profit#33) AS catalog_sales_profit#15449]
            +- Filter (((((d_moy#500 = 4) && (d_year#498 = 2001)) && ((d_date_sk#492 = ss_sold_date_sk#130) && (i_item_sk#564 = ss_item_sk#132))) && (((s_store_sk#664 = ss_store_sk#137) && (ss_customer_sk#133 = sr_customer_sk#179)) && ((ss_item_sk#132 = sr_item_sk#178) && (ss_ticket_number#139L = sr_ticket_number#185L)))) && ((((sr_returned_date_sk#176 = d_date_sk#15450) && ((d_moy#15458 >= 4) && (d_moy#15458 <= 10))) && ((d_year#15456 = 2001) && (sr_customer_sk#179 = cs_bill_customer_sk#3))) && (((sr_item_sk#178 = cs_item_sk#15) && (cs_sold_date_sk#0 = d_date_sk#15478)) && (((d_moy#15486 >= 4) && (d_moy#15486 <= 10)) && (d_year#15484 = 2001)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :  :  :  :  +- SubqueryAlias `catalog_sales`
                  :  :  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  :  +- SubqueryAlias `d1`
                  :  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  :  :  +- SubqueryAlias `d2`
                  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :        +- Relation[d_date_sk#15450,d_date_id#15451,d_date#15452,d_month_seq#15453,d_week_seq#15454,d_quarter_seq#15455,d_year#15456,d_dow#15457,d_moy#15458,d_dom#15459,d_qoy#15460,d_fy_year#15461,d_fy_quarter_seq#15462,d_fy_week_seq#15463,d_day_name#15464,d_quarter_name#15465,d_holiday#15466,d_weekend#15467,d_following_holiday#15468,d_first_dom#15469,d_last_dom#15470,d_same_day_ly#15471,d_same_day_lq#15472,d_current_day#15473,... 4 more fields] parquet
                  :  :  +- SubqueryAlias `d3`
                  :  :     +- SubqueryAlias `date_dim`
                  :  :        +- Relation[d_date_sk#15478,d_date_id#15479,d_date#15480,d_month_seq#15481,d_week_seq#15482,d_quarter_seq#15483,d_year#15484,d_dow#15485,d_moy#15486,d_dom#15487,d_qoy#15488,d_fy_year#15489,d_fy_quarter_seq#15490,d_fy_week_seq#15491,d_day_name#15492,d_quarter_name#15493,d_holiday#15494,d_weekend#15495,d_following_holiday#15496,d_first_dom#15497,d_last_dom#15498,d_same_day_ly#15499,d_same_day_lq#15500,d_current_day#15501,... 4 more fields] parquet
                  :  +- SubqueryAlias `store`
                  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 19:31:31 INFO Query:
== Query: q25-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, store_sales_profit#15520, store_returns_loss#15521, catalog_sales_profit#15522]
      +- Sort [i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, s_store_id#665 ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669], [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, sum(ss_net_profit#152) AS store_sales_profit#15520, sum(sr_net_loss#195) AS store_returns_loss#15521, sum(cs_net_profit#33) AS catalog_sales_profit#15522]
            +- Filter (((((d_moy#500 = 4) && (d_year#498 = 2001)) && ((d_date_sk#492 = ss_sold_date_sk#130) && (i_item_sk#564 = ss_item_sk#132))) && (((s_store_sk#664 = ss_store_sk#137) && (ss_customer_sk#133 = sr_customer_sk#179)) && ((ss_item_sk#132 = sr_item_sk#178) && (ss_ticket_number#139L = sr_ticket_number#185L)))) && ((((sr_returned_date_sk#176 = d_date_sk#15523) && ((d_moy#15531 >= 4) && (d_moy#15531 <= 10))) && ((d_year#15529 = 2001) && (sr_customer_sk#179 = cs_bill_customer_sk#3))) && (((sr_item_sk#178 = cs_item_sk#15) && (cs_sold_date_sk#0 = d_date_sk#15551)) && (((d_moy#15559 >= 4) && (d_moy#15559 <= 10)) && (d_year#15557 = 2001)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :  :  :  :  +- SubqueryAlias `catalog_sales`
                  :  :  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  :  +- SubqueryAlias `d1`
                  :  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  :  :  +- SubqueryAlias `d2`
                  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :        +- Relation[d_date_sk#15523,d_date_id#15524,d_date#15525,d_month_seq#15526,d_week_seq#15527,d_quarter_seq#15528,d_year#15529,d_dow#15530,d_moy#15531,d_dom#15532,d_qoy#15533,d_fy_year#15534,d_fy_quarter_seq#15535,d_fy_week_seq#15536,d_day_name#15537,d_quarter_name#15538,d_holiday#15539,d_weekend#15540,d_following_holiday#15541,d_first_dom#15542,d_last_dom#15543,d_same_day_ly#15544,d_same_day_lq#15545,d_current_day#15546,... 4 more fields] parquet
                  :  :  +- SubqueryAlias `d3`
                  :  :     +- SubqueryAlias `date_dim`
                  :  :        +- Relation[d_date_sk#15551,d_date_id#15552,d_date#15553,d_month_seq#15554,d_week_seq#15555,d_quarter_seq#15556,d_year#15557,d_dow#15558,d_moy#15559,d_dom#15560,d_qoy#15561,d_fy_year#15562,d_fy_quarter_seq#15563,d_fy_week_seq#15564,d_day_name#15565,d_quarter_name#15566,d_holiday#15567,d_weekend#15568,d_following_holiday#15569,d_first_dom#15570,d_last_dom#15571,d_same_day_ly#15572,d_same_day_lq#15573,d_current_day#15574,... 4 more fields] parquet
                  :  +- SubqueryAlias `store`
                  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 423.747177679s
Running execution q26-v2.4 iteration: 1, StandardRun=true
19/09/08 19:38:36 INFO Query:
== Query: q26-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, agg1#15776, agg2#15777, agg3#15778, agg4#15779]
      +- Sort [i_item_id#565 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565], [i_item_id#565, avg(cast(cs_quantity#18 as bigint)) AS agg1#15776, avg(cs_list_price#20) AS agg2#15777, avg(cs_coupon_amt#27) AS agg3#15778, avg(cs_sales_price#21) AS agg4#15779]
            +- Filter (((((cs_sold_date_sk#0 = d_date_sk#492) && (cs_item_sk#15 = i_item_sk#564)) && (cs_bill_cdemo_sk#4 = cd_demo_sk#474)) && ((cs_promo_sk#16 = p_promo_sk#608) && (cd_gender#475 = M))) && (((cd_marital_status#476 = S) && (cd_education_status#477 = College)) && (((p_channel_email#617 = N) || (p_channel_event#622 = N)) && (d_year#498 = 2000))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `customer_demographics`
                  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `promotion`
                     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet

     : benchmark
19/09/08 19:38:36 INFO Query:
== Query: q26-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, agg1#15790, agg2#15791, agg3#15792, agg4#15793]
      +- Sort [i_item_id#565 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565], [i_item_id#565, avg(cast(cs_quantity#18 as bigint)) AS agg1#15790, avg(cs_list_price#20) AS agg2#15791, avg(cs_coupon_amt#27) AS agg3#15792, avg(cs_sales_price#21) AS agg4#15793]
            +- Filter (((((cs_sold_date_sk#0 = d_date_sk#492) && (cs_item_sk#15 = i_item_sk#564)) && (cs_bill_cdemo_sk#4 = cd_demo_sk#474)) && ((cs_promo_sk#16 = p_promo_sk#608) && (cd_gender#475 = M))) && (((cd_marital_status#476 = S) && (cd_education_status#477 = College)) && (((p_channel_email#617 = N) || (p_channel_event#622 = N)) && (d_year#498 = 2000))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `customer_demographics`
                  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `promotion`
                     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet

      running Thread[benchmark runner,5,main]
Execution time: 13.516916837999998s
Running execution q27-v2.4 iteration: 1, StandardRun=true
19/09/08 19:38:51 INFO Query:
== Query: q27-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#15901 ASC NULLS FIRST, s_state#15902 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#15901, s_state#15902, spark_grouping_id#15898], [i_item_id#15901, s_state#15902, cast((shiftright(spark_grouping_id#15898, 0) & 1) as tinyint) AS g_state#15889, avg(cast(ss_quantity#140 as bigint)) AS agg1#15890, avg(ss_list_price#142) AS agg2#15891, avg(ss_coupon_amt#149) AS agg3#15892, avg(ss_sales_price#143) AS agg4#15893]
         +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#15899, s_state#15900, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#15899, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, ... 90 more fields]
            +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, ... 89 more fields]
               +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_cdemo_sk#134 = cd_demo_sk#474) && (cd_gender#475 = M))) && (((cd_marital_status#476 = S) && (cd_education_status#477 = College)) && ((d_year#498 = 2002) && s_state#688 IN (TN,TN,TN,TN,TN,TN))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- SubqueryAlias `store_sales`
                     :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :  :  +- SubqueryAlias `customer_demographics`
                     :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                     :  :  +- SubqueryAlias `date_dim`
                     :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- SubqueryAlias `store`
                     :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     +- SubqueryAlias `item`
                        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 19:38:51 INFO Query:
== Query: q27-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#15925 ASC NULLS FIRST, s_state#15926 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#15925, s_state#15926, spark_grouping_id#15922], [i_item_id#15925, s_state#15926, cast((shiftright(spark_grouping_id#15922, 0) & 1) as tinyint) AS g_state#15913, avg(cast(ss_quantity#140 as bigint)) AS agg1#15914, avg(ss_list_price#142) AS agg2#15915, avg(ss_coupon_amt#149) AS agg3#15916, avg(ss_sales_price#143) AS agg4#15917]
         +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#15923, s_state#15924, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#15923, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, ... 90 more fields]
            +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, ... 89 more fields]
               +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_cdemo_sk#134 = cd_demo_sk#474) && (cd_gender#475 = M))) && (((cd_marital_status#476 = S) && (cd_education_status#477 = College)) && ((d_year#498 = 2002) && s_state#688 IN (TN,TN,TN,TN,TN,TN))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- SubqueryAlias `store_sales`
                     :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :  :  +- SubqueryAlias `customer_demographics`
                     :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                     :  :  +- SubqueryAlias `date_dim`
                     :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- SubqueryAlias `store`
                     :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     +- SubqueryAlias `item`
                        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 18.047947381s
Running execution q28-v2.4 iteration: 1, StandardRun=true
19/09/08 19:39:11 INFO Query:
== Query: q28-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [B1_LP#16176, B1_CNT#16177L, B1_CNTD#16178L, B2_LP#16179, B2_CNT#16180L, B2_CNTD#16181L, B3_LP#16182, B3_CNT#16183L, B3_CNTD#16184L, B4_LP#16185, B4_CNT#16186L, B4_CNTD#16187L, B5_LP#16188, B5_CNT#16189L, B5_CNTD#16190L, B6_LP#16191, B6_CNT#16192L, B6_CNTD#16193L]
      +- Join Cross
         :- Join Cross
         :  :- Join Cross
         :  :  :- Join Cross
         :  :  :  :- Join Cross
         :  :  :  :  :- SubqueryAlias `B1`
         :  :  :  :  :  +- Aggregate [avg(ss_list_price#142) AS B1_LP#16176, count(ss_list_price#142) AS B1_CNT#16177L, count(distinct ss_list_price#142) AS B1_CNTD#16178L]
         :  :  :  :  :     +- Filter (((ss_quantity#140 >= 0) && (ss_quantity#140 <= 5)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(8 as decimal(1,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((8 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(459 as decimal(3,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((459 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(57 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((57 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :  :  :  :        +- SubqueryAlias `store_sales`
         :  :  :  :  :           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  :  +- SubqueryAlias `B2`
         :  :  :  :     +- Aggregate [avg(ss_list_price#142) AS B2_LP#16179, count(ss_list_price#142) AS B2_CNT#16180L, count(distinct ss_list_price#142) AS B2_CNTD#16181L]
         :  :  :  :        +- Filter (((ss_quantity#140 >= 6) && (ss_quantity#140 <= 10)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(90 as decimal(2,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((90 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(2323 as decimal(4,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((2323 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(31 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((31 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :  :  :           +- SubqueryAlias `store_sales`
         :  :  :  :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  +- SubqueryAlias `B3`
         :  :  :     +- Aggregate [avg(ss_list_price#142) AS B3_LP#16182, count(ss_list_price#142) AS B3_CNT#16183L, count(distinct ss_list_price#142) AS B3_CNTD#16184L]
         :  :  :        +- Filter (((ss_quantity#140 >= 11) && (ss_quantity#140 <= 15)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(142 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((142 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(12214 as decimal(5,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((12214 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(79 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((79 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :  :           +- SubqueryAlias `store_sales`
         :  :  :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  +- SubqueryAlias `B4`
         :  :     +- Aggregate [avg(ss_list_price#142) AS B4_LP#16185, count(ss_list_price#142) AS B4_CNT#16186L, count(distinct ss_list_price#142) AS B4_CNTD#16187L]
         :  :        +- Filter (((ss_quantity#140 >= 16) && (ss_quantity#140 <= 20)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(135 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((135 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(6071 as decimal(4,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((6071 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(38 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((38 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :           +- SubqueryAlias `store_sales`
         :  :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  +- SubqueryAlias `B5`
         :     +- Aggregate [avg(ss_list_price#142) AS B5_LP#16188, count(ss_list_price#142) AS B5_CNT#16189L, count(distinct ss_list_price#142) AS B5_CNTD#16190L]
         :        +- Filter (((ss_quantity#140 >= 21) && (ss_quantity#140 <= 25)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(122 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((122 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(836 as decimal(3,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((836 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(17 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((17 + 20) as decimal(10,0)) as decimal(12,2))))))
         :           +- SubqueryAlias `store_sales`
         :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         +- SubqueryAlias `B6`
            +- Aggregate [avg(ss_list_price#142) AS B6_LP#16191, count(ss_list_price#142) AS B6_CNT#16192L, count(distinct ss_list_price#142) AS B6_CNTD#16193L]
               +- Filter (((ss_quantity#140 >= 26) && (ss_quantity#140 <= 30)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(154 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((154 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(7326 as decimal(4,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((7326 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(7 as decimal(1,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((7 + 20) as decimal(10,0)) as decimal(12,2))))))
                  +- SubqueryAlias `store_sales`
                     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
19/09/08 19:39:11 INFO Query:
== Query: q28-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [B1_LP#16230, B1_CNT#16231L, B1_CNTD#16232L, B2_LP#16233, B2_CNT#16234L, B2_CNTD#16235L, B3_LP#16236, B3_CNT#16237L, B3_CNTD#16238L, B4_LP#16239, B4_CNT#16240L, B4_CNTD#16241L, B5_LP#16242, B5_CNT#16243L, B5_CNTD#16244L, B6_LP#16245, B6_CNT#16246L, B6_CNTD#16247L]
      +- Join Cross
         :- Join Cross
         :  :- Join Cross
         :  :  :- Join Cross
         :  :  :  :- Join Cross
         :  :  :  :  :- SubqueryAlias `B1`
         :  :  :  :  :  +- Aggregate [avg(ss_list_price#142) AS B1_LP#16230, count(ss_list_price#142) AS B1_CNT#16231L, count(distinct ss_list_price#142) AS B1_CNTD#16232L]
         :  :  :  :  :     +- Filter (((ss_quantity#140 >= 0) && (ss_quantity#140 <= 5)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(8 as decimal(1,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((8 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(459 as decimal(3,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((459 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(57 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((57 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :  :  :  :        +- SubqueryAlias `store_sales`
         :  :  :  :  :           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  :  +- SubqueryAlias `B2`
         :  :  :  :     +- Aggregate [avg(ss_list_price#142) AS B2_LP#16233, count(ss_list_price#142) AS B2_CNT#16234L, count(distinct ss_list_price#142) AS B2_CNTD#16235L]
         :  :  :  :        +- Filter (((ss_quantity#140 >= 6) && (ss_quantity#140 <= 10)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(90 as decimal(2,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((90 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(2323 as decimal(4,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((2323 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(31 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((31 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :  :  :           +- SubqueryAlias `store_sales`
         :  :  :  :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  +- SubqueryAlias `B3`
         :  :  :     +- Aggregate [avg(ss_list_price#142) AS B3_LP#16236, count(ss_list_price#142) AS B3_CNT#16237L, count(distinct ss_list_price#142) AS B3_CNTD#16238L]
         :  :  :        +- Filter (((ss_quantity#140 >= 11) && (ss_quantity#140 <= 15)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(142 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((142 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(12214 as decimal(5,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((12214 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(79 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((79 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :  :           +- SubqueryAlias `store_sales`
         :  :  :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  +- SubqueryAlias `B4`
         :  :     +- Aggregate [avg(ss_list_price#142) AS B4_LP#16239, count(ss_list_price#142) AS B4_CNT#16240L, count(distinct ss_list_price#142) AS B4_CNTD#16241L]
         :  :        +- Filter (((ss_quantity#140 >= 16) && (ss_quantity#140 <= 20)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(135 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((135 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(6071 as decimal(4,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((6071 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(38 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((38 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :           +- SubqueryAlias `store_sales`
         :  :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  +- SubqueryAlias `B5`
         :     +- Aggregate [avg(ss_list_price#142) AS B5_LP#16242, count(ss_list_price#142) AS B5_CNT#16243L, count(distinct ss_list_price#142) AS B5_CNTD#16244L]
         :        +- Filter (((ss_quantity#140 >= 21) && (ss_quantity#140 <= 25)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(122 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((122 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(836 as decimal(3,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((836 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(17 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((17 + 20) as decimal(10,0)) as decimal(12,2))))))
         :           +- SubqueryAlias `store_sales`
         :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         +- SubqueryAlias `B6`
            +- Aggregate [avg(ss_list_price#142) AS B6_LP#16245, count(ss_list_price#142) AS B6_CNT#16246L, count(distinct ss_list_price#142) AS B6_CNTD#16247L]
               +- Filter (((ss_quantity#140 >= 26) && (ss_quantity#140 <= 30)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(154 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((154 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(7326 as decimal(4,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((7326 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(7 as decimal(1,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((7 + 20) as decimal(10,0)) as decimal(12,2))))))
                  +- SubqueryAlias `store_sales`
                     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 52.297144851s
Running execution q29-v2.4 iteration: 1, StandardRun=true
19/09/08 19:40:04 INFO Query:
== Query: q29-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, store_sales_quantity#16592L, store_returns_quantity#16593L, catalog_sales_quantity#16594L]
      +- Sort [i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, s_store_id#665 ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669], [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, sum(cast(ss_quantity#140 as bigint)) AS store_sales_quantity#16592L, sum(cast(sr_return_quantity#186 as bigint)) AS store_returns_quantity#16593L, sum(cast(cs_quantity#18 as bigint)) AS catalog_sales_quantity#16594L]
            +- Filter (((((d_moy#500 = 9) && (d_year#498 = 1999)) && ((d_date_sk#492 = ss_sold_date_sk#130) && (i_item_sk#564 = ss_item_sk#132))) && (((s_store_sk#664 = ss_store_sk#137) && (ss_customer_sk#133 = sr_customer_sk#179)) && ((ss_item_sk#132 = sr_item_sk#178) && (ss_ticket_number#139L = sr_ticket_number#185L)))) && ((((sr_returned_date_sk#176 = d_date_sk#16595) && ((d_moy#16603 >= 9) && (d_moy#16603 <= (9 + 3)))) && ((d_year#16601 = 1999) && (sr_customer_sk#179 = cs_bill_customer_sk#3))) && (((sr_item_sk#178 = cs_item_sk#15) && (cs_sold_date_sk#0 = d_date_sk#16623)) && d_year#16629 IN (1999,(1999 + 1),(1999 + 2)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :  :  :  :  +- SubqueryAlias `catalog_sales`
                  :  :  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  :  +- SubqueryAlias `d1`
                  :  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  :  :  +- SubqueryAlias `d2`
                  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :        +- Relation[d_date_sk#16595,d_date_id#16596,d_date#16597,d_month_seq#16598,d_week_seq#16599,d_quarter_seq#16600,d_year#16601,d_dow#16602,d_moy#16603,d_dom#16604,d_qoy#16605,d_fy_year#16606,d_fy_quarter_seq#16607,d_fy_week_seq#16608,d_day_name#16609,d_quarter_name#16610,d_holiday#16611,d_weekend#16612,d_following_holiday#16613,d_first_dom#16614,d_last_dom#16615,d_same_day_ly#16616,d_same_day_lq#16617,d_current_day#16618,... 4 more fields] parquet
                  :  :  +- SubqueryAlias `d3`
                  :  :     +- SubqueryAlias `date_dim`
                  :  :        +- Relation[d_date_sk#16623,d_date_id#16624,d_date#16625,d_month_seq#16626,d_week_seq#16627,d_quarter_seq#16628,d_year#16629,d_dow#16630,d_moy#16631,d_dom#16632,d_qoy#16633,d_fy_year#16634,d_fy_quarter_seq#16635,d_fy_week_seq#16636,d_day_name#16637,d_quarter_name#16638,d_holiday#16639,d_weekend#16640,d_following_holiday#16641,d_first_dom#16642,d_last_dom#16643,d_same_day_ly#16644,d_same_day_lq#16645,d_current_day#16646,... 4 more fields] parquet
                  :  +- SubqueryAlias `store`
                  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 19:40:04 INFO Query:
== Query: q29-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, store_sales_quantity#16665L, store_returns_quantity#16666L, catalog_sales_quantity#16667L]
      +- Sort [i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, s_store_id#665 ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669], [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, sum(cast(ss_quantity#140 as bigint)) AS store_sales_quantity#16665L, sum(cast(sr_return_quantity#186 as bigint)) AS store_returns_quantity#16666L, sum(cast(cs_quantity#18 as bigint)) AS catalog_sales_quantity#16667L]
            +- Filter (((((d_moy#500 = 9) && (d_year#498 = 1999)) && ((d_date_sk#492 = ss_sold_date_sk#130) && (i_item_sk#564 = ss_item_sk#132))) && (((s_store_sk#664 = ss_store_sk#137) && (ss_customer_sk#133 = sr_customer_sk#179)) && ((ss_item_sk#132 = sr_item_sk#178) && (ss_ticket_number#139L = sr_ticket_number#185L)))) && ((((sr_returned_date_sk#176 = d_date_sk#16668) && ((d_moy#16676 >= 9) && (d_moy#16676 <= (9 + 3)))) && ((d_year#16674 = 1999) && (sr_customer_sk#179 = cs_bill_customer_sk#3))) && (((sr_item_sk#178 = cs_item_sk#15) && (cs_sold_date_sk#0 = d_date_sk#16696)) && d_year#16702 IN (1999,(1999 + 1),(1999 + 2)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :  :  :  :  +- SubqueryAlias `catalog_sales`
                  :  :  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  :  +- SubqueryAlias `d1`
                  :  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  :  :  +- SubqueryAlias `d2`
                  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :        +- Relation[d_date_sk#16668,d_date_id#16669,d_date#16670,d_month_seq#16671,d_week_seq#16672,d_quarter_seq#16673,d_year#16674,d_dow#16675,d_moy#16676,d_dom#16677,d_qoy#16678,d_fy_year#16679,d_fy_quarter_seq#16680,d_fy_week_seq#16681,d_day_name#16682,d_quarter_name#16683,d_holiday#16684,d_weekend#16685,d_following_holiday#16686,d_first_dom#16687,d_last_dom#16688,d_same_day_ly#16689,d_same_day_lq#16690,d_current_day#16691,... 4 more fields] parquet
                  :  :  +- SubqueryAlias `d3`
                  :  :     +- SubqueryAlias `date_dim`
                  :  :        +- Relation[d_date_sk#16696,d_date_id#16697,d_date#16698,d_month_seq#16699,d_week_seq#16700,d_quarter_seq#16701,d_year#16702,d_dow#16703,d_moy#16704,d_dom#16705,d_qoy#16706,d_fy_year#16707,d_fy_quarter_seq#16708,d_fy_week_seq#16709,d_day_name#16710,d_quarter_name#16711,d_holiday#16712,d_weekend#16713,d_following_holiday#16714,d_first_dom#16715,d_last_dom#16716,d_same_day_ly#16717,d_same_day_lq#16718,d_current_day#16719,... 4 more fields] parquet
                  :  +- SubqueryAlias `store`
                  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 114.90023106400001s
Running execution q30-v2.4 iteration: 1, StandardRun=true
19/09/08 19:42:01 INFO Query:
== Query: q30-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_customer_id#413 ASC NULLS FIRST, c_salutation#419 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, c_last_name#421 ASC NULLS FIRST, c_preferred_cust_flag#422 ASC NULLS FIRST, c_birth_day#423 ASC NULLS FIRST, c_birth_month#424 ASC NULLS FIRST, c_birth_year#425 ASC NULLS FIRST, c_birth_country#426 ASC NULLS FIRST, c_login#427 ASC NULLS FIRST, c_email_address#428 ASC NULLS FIRST, c_last_review_date#429 ASC NULLS FIRST, ctr_total_return#16925 ASC NULLS FIRST], true
      +- Project [c_customer_id#413, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ctr_total_return#16925]
         +- Filter (((cast(ctr_total_return#16925 as decimal(24,7)) > cast(scalar-subquery#16922 [ctr_state#16924] as decimal(24,7))) && (ca_address_sk#448 = c_current_addr_sk#416)) && ((ca_state#456 = GA) && (ctr_customer_sk#16923 = c_customer_sk#412)))
            :  +- Aggregate [CheckOverflow((promote_precision(cast(avg(ctr_total_return#16925) as decimal(21,6))) * promote_precision(cast(1.2 as decimal(21,6)))), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#16928]
            :     +- Filter (outer(ctr_state#16924) = ctr_state#16924)
            :        +- SubqueryAlias `ctr2`
            :           +- SubqueryAlias `customer_total_return`
            :              +- Aggregate [wr_returning_customer_sk#291, ca_state#456], [wr_returning_customer_sk#291 AS ctr_customer_sk#16923, ca_state#456 AS ctr_state#16924, sum(wr_return_amt#299) AS ctr_total_return#16925]
            :                 +- Filter (((wr_returned_date_sk#284 = d_date_sk#492) && (d_year#498 = 2002)) && (wr_returning_addr_sk#294 = ca_address_sk#448))
            :                    +- Join Inner
            :                       :- Join Inner
            :                       :  :- SubqueryAlias `web_returns`
            :                       :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
            :                       :  +- SubqueryAlias `date_dim`
            :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :                       +- SubqueryAlias `customer_address`
            :                          +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ctr1`
               :  :  +- SubqueryAlias `customer_total_return`
               :  :     +- Aggregate [wr_returning_customer_sk#291, ca_state#456], [wr_returning_customer_sk#291 AS ctr_customer_sk#16923, ca_state#456 AS ctr_state#16924, sum(wr_return_amt#299) AS ctr_total_return#16925]
               :  :        +- Filter (((wr_returned_date_sk#284 = d_date_sk#492) && (d_year#498 = 2002)) && (wr_returning_addr_sk#294 = ca_address_sk#448))
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- SubqueryAlias `web_returns`
               :  :              :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               :  :              :  +- SubqueryAlias `date_dim`
               :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              +- SubqueryAlias `customer_address`
               :  :                 +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer_address`
               :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer`
                  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/09/08 19:42:01 INFO Query:
== Query: q30-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_customer_id#413 ASC NULLS FIRST, c_salutation#419 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, c_last_name#421 ASC NULLS FIRST, c_preferred_cust_flag#422 ASC NULLS FIRST, c_birth_day#423 ASC NULLS FIRST, c_birth_month#424 ASC NULLS FIRST, c_birth_year#425 ASC NULLS FIRST, c_birth_country#426 ASC NULLS FIRST, c_login#427 ASC NULLS FIRST, c_email_address#428 ASC NULLS FIRST, c_last_review_date#429 ASC NULLS FIRST, ctr_total_return#16945 ASC NULLS FIRST], true
      +- Project [c_customer_id#413, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ctr_total_return#16945]
         +- Filter (((cast(ctr_total_return#16945 as decimal(24,7)) > cast(scalar-subquery#16942 [ctr_state#16944] as decimal(24,7))) && (ca_address_sk#448 = c_current_addr_sk#416)) && ((ca_state#456 = GA) && (ctr_customer_sk#16943 = c_customer_sk#412)))
            :  +- Aggregate [CheckOverflow((promote_precision(cast(avg(ctr_total_return#16945) as decimal(21,6))) * promote_precision(cast(1.2 as decimal(21,6)))), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#16948]
            :     +- Filter (outer(ctr_state#16944) = ctr_state#16944)
            :        +- SubqueryAlias `ctr2`
            :           +- SubqueryAlias `customer_total_return`
            :              +- Aggregate [wr_returning_customer_sk#291, ca_state#456], [wr_returning_customer_sk#291 AS ctr_customer_sk#16943, ca_state#456 AS ctr_state#16944, sum(wr_return_amt#299) AS ctr_total_return#16945]
            :                 +- Filter (((wr_returned_date_sk#284 = d_date_sk#492) && (d_year#498 = 2002)) && (wr_returning_addr_sk#294 = ca_address_sk#448))
            :                    +- Join Inner
            :                       :- Join Inner
            :                       :  :- SubqueryAlias `web_returns`
            :                       :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
            :                       :  +- SubqueryAlias `date_dim`
            :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :                       +- SubqueryAlias `customer_address`
            :                          +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ctr1`
               :  :  +- SubqueryAlias `customer_total_return`
               :  :     +- Aggregate [wr_returning_customer_sk#291, ca_state#456], [wr_returning_customer_sk#291 AS ctr_customer_sk#16943, ca_state#456 AS ctr_state#16944, sum(wr_return_amt#299) AS ctr_total_return#16945]
               :  :        +- Filter (((wr_returned_date_sk#284 = d_date_sk#492) && (d_year#498 = 2002)) && (wr_returning_addr_sk#294 = ca_address_sk#448))
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- SubqueryAlias `web_returns`
               :  :              :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               :  :              :  +- SubqueryAlias `date_dim`
               :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              +- SubqueryAlias `customer_address`
               :  :                 +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer_address`
               :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer`
                  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 18.270043031s
Running execution q31-v2.4 iteration: 1, StandardRun=true
19/09/08 19:42:21 INFO Query:
== Query: q31-v2.4 ==
Sort [ca_county#455 ASC NULLS FIRST], true
+- Project [ca_county#455, d_year#498, CheckOverflow((promote_precision(cast(web_sales#17743 as decimal(17,2))) / promote_precision(cast(web_sales#17494 as decimal(17,2)))), DecimalType(37,20)) AS web_q1_q2_increase#17489, CheckOverflow((promote_precision(cast(store_sales#17497 as decimal(17,2))) / promote_precision(cast(store_sales#17493 as decimal(17,2)))), DecimalType(37,20)) AS store_q1_q2_increase#17490, CheckOverflow((promote_precision(cast(web_sales#17839 as decimal(17,2))) / promote_precision(cast(web_sales#17743 as decimal(17,2)))), DecimalType(37,20)) AS web_q2_q3_increase#17491, CheckOverflow((promote_precision(cast(store_sales#17593 as decimal(17,2))) / promote_precision(cast(store_sales#17497 as decimal(17,2)))), DecimalType(37,20)) AS store_q2_q3_increase#17492]
   +- Filter ((((((d_qoy#502 = 1) && (d_year#498 = 2000)) && (ca_county#455 = ca_county#17587)) && ((d_qoy#17549 = 2) && (d_year#17545 = 2000))) && ((((ca_county#17587 = ca_county#17683) && (d_qoy#17645 = 3)) && (d_year#17641 = 2000)) && ((ca_county#455 = ca_county#17737) && (d_qoy#17699 = 1)))) && (((((d_year#17695 = 2000) && (ca_county#17737 = ca_county#17833)) && (d_qoy#17795 = 2)) && ((d_year#17791 = 2000) && (ca_county#17737 = ca_county#17929))) && (((d_qoy#17891 = 3) && (d_year#17887 = 2000)) && ((CASE WHEN (cast(web_sales#17494 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(web_sales#17743 as decimal(17,2))) / promote_precision(cast(web_sales#17494 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END > CASE WHEN (cast(store_sales#17493 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(store_sales#17497 as decimal(17,2))) / promote_precision(cast(store_sales#17493 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END) && (CASE WHEN (cast(web_sales#17743 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(web_sales#17839 as decimal(17,2))) / promote_precision(cast(web_sales#17743 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END > CASE WHEN (cast(store_sales#17497 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(store_sales#17593 as decimal(17,2))) / promote_precision(cast(store_sales#17497 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END)))))
      +- Join Inner
         :- Join Inner
         :  :- Join Inner
         :  :  :- Join Inner
         :  :  :  :- Join Inner
         :  :  :  :  :- SubqueryAlias `ss1`
         :  :  :  :  :  +- SubqueryAlias `ss`
         :  :  :  :  :     +- Aggregate [ca_county#455, d_qoy#502, d_year#498], [ca_county#455, d_qoy#502, d_year#498, sum(ss_ext_sales_price#145) AS store_sales#17493]
         :  :  :  :  :        +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && (ss_addr_sk#136 = ca_address_sk#448))
         :  :  :  :  :           +- Join Inner
         :  :  :  :  :              :- Join Inner
         :  :  :  :  :              :  :- SubqueryAlias `store_sales`
         :  :  :  :  :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  :  :              :  +- SubqueryAlias `date_dim`
         :  :  :  :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :  :  :  :  :              +- SubqueryAlias `customer_address`
         :  :  :  :  :                 +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :  :  :  :  +- SubqueryAlias `ss2`
         :  :  :  :     +- SubqueryAlias `ss`
         :  :  :  :        +- Aggregate [ca_county#17587, d_qoy#17549, d_year#17545], [ca_county#17587, d_qoy#17549, d_year#17545, sum(ss_ext_sales_price#145) AS store_sales#17497]
         :  :  :  :           +- Filter ((ss_sold_date_sk#130 = d_date_sk#17539) && (ss_addr_sk#136 = ca_address_sk#17580))
         :  :  :  :              +- Join Inner
         :  :  :  :                 :- Join Inner
         :  :  :  :                 :  :- SubqueryAlias `store_sales`
         :  :  :  :                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  :                 :  +- SubqueryAlias `date_dim`
         :  :  :  :                 :     +- Relation[d_date_sk#17539,d_date_id#17540,d_date#17541,d_month_seq#17542,d_week_seq#17543,d_quarter_seq#17544,d_year#17545,d_dow#17546,d_moy#17547,d_dom#17548,d_qoy#17549,d_fy_year#17550,d_fy_quarter_seq#17551,d_fy_week_seq#17552,d_day_name#17553,d_quarter_name#17554,d_holiday#17555,d_weekend#17556,d_following_holiday#17557,d_first_dom#17558,d_last_dom#17559,d_same_day_ly#17560,d_same_day_lq#17561,d_current_day#17562,... 4 more fields] parquet
         :  :  :  :                 +- SubqueryAlias `customer_address`
         :  :  :  :                    +- Relation[ca_address_sk#17580,ca_address_id#17581,ca_street_number#17582,ca_street_name#17583,ca_street_type#17584,ca_suite_number#17585,ca_city#17586,ca_county#17587,ca_state#17588,ca_zip#17589,ca_country#17590,ca_gmt_offset#17591,ca_location_type#17592] parquet
         :  :  :  +- SubqueryAlias `ss3`
         :  :  :     +- SubqueryAlias `ss`
         :  :  :        +- Aggregate [ca_county#17683, d_qoy#17645, d_year#17641], [ca_county#17683, d_qoy#17645, d_year#17641, sum(ss_ext_sales_price#145) AS store_sales#17593]
         :  :  :           +- Filter ((ss_sold_date_sk#130 = d_date_sk#17635) && (ss_addr_sk#136 = ca_address_sk#17676))
         :  :  :              +- Join Inner
         :  :  :                 :- Join Inner
         :  :  :                 :  :- SubqueryAlias `store_sales`
         :  :  :                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :                 :  +- SubqueryAlias `date_dim`
         :  :  :                 :     +- Relation[d_date_sk#17635,d_date_id#17636,d_date#17637,d_month_seq#17638,d_week_seq#17639,d_quarter_seq#17640,d_year#17641,d_dow#17642,d_moy#17643,d_dom#17644,d_qoy#17645,d_fy_year#17646,d_fy_quarter_seq#17647,d_fy_week_seq#17648,d_day_name#17649,d_quarter_name#17650,d_holiday#17651,d_weekend#17652,d_following_holiday#17653,d_first_dom#17654,d_last_dom#17655,d_same_day_ly#17656,d_same_day_lq#17657,d_current_day#17658,... 4 more fields] parquet
         :  :  :                 +- SubqueryAlias `customer_address`
         :  :  :                    +- Relation[ca_address_sk#17676,ca_address_id#17677,ca_street_number#17678,ca_street_name#17679,ca_street_type#17680,ca_suite_number#17681,ca_city#17682,ca_county#17683,ca_state#17684,ca_zip#17685,ca_country#17686,ca_gmt_offset#17687,ca_location_type#17688] parquet
         :  :  +- SubqueryAlias `ws1`
         :  :     +- SubqueryAlias `ws`
         :  :        +- Aggregate [ca_county#17737, d_qoy#17699, d_year#17695], [ca_county#17737, d_qoy#17699, d_year#17695, sum(ws_ext_sales_price#239) AS web_sales#17494]
         :  :           +- Filter ((ws_sold_date_sk#216 = d_date_sk#17689) && (ws_bill_addr_sk#223 = ca_address_sk#17730))
         :  :              +- Join Inner
         :  :                 :- Join Inner
         :  :                 :  :- SubqueryAlias `web_sales`
         :  :                 :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
         :  :                 :  +- SubqueryAlias `date_dim`
         :  :                 :     +- Relation[d_date_sk#17689,d_date_id#17690,d_date#17691,d_month_seq#17692,d_week_seq#17693,d_quarter_seq#17694,d_year#17695,d_dow#17696,d_moy#17697,d_dom#17698,d_qoy#17699,d_fy_year#17700,d_fy_quarter_seq#17701,d_fy_week_seq#17702,d_day_name#17703,d_quarter_name#17704,d_holiday#17705,d_weekend#17706,d_following_holiday#17707,d_first_dom#17708,d_last_dom#17709,d_same_day_ly#17710,d_same_day_lq#17711,d_current_day#17712,... 4 more fields] parquet
         :  :                 +- SubqueryAlias `customer_address`
         :  :                    +- Relation[ca_address_sk#17730,ca_address_id#17731,ca_street_number#17732,ca_street_name#17733,ca_street_type#17734,ca_suite_number#17735,ca_city#17736,ca_county#17737,ca_state#17738,ca_zip#17739,ca_country#17740,ca_gmt_offset#17741,ca_location_type#17742] parquet
         :  +- SubqueryAlias `ws2`
         :     +- SubqueryAlias `ws`
         :        +- Aggregate [ca_county#17833, d_qoy#17795, d_year#17791], [ca_county#17833, d_qoy#17795, d_year#17791, sum(ws_ext_sales_price#239) AS web_sales#17743]
         :           +- Filter ((ws_sold_date_sk#216 = d_date_sk#17785) && (ws_bill_addr_sk#223 = ca_address_sk#17826))
         :              +- Join Inner
         :                 :- Join Inner
         :                 :  :- SubqueryAlias `web_sales`
         :                 :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
         :                 :  +- SubqueryAlias `date_dim`
         :                 :     +- Relation[d_date_sk#17785,d_date_id#17786,d_date#17787,d_month_seq#17788,d_week_seq#17789,d_quarter_seq#17790,d_year#17791,d_dow#17792,d_moy#17793,d_dom#17794,d_qoy#17795,d_fy_year#17796,d_fy_quarter_seq#17797,d_fy_week_seq#17798,d_day_name#17799,d_quarter_name#17800,d_holiday#17801,d_weekend#17802,d_following_holiday#17803,d_first_dom#17804,d_last_dom#17805,d_same_day_ly#17806,d_same_day_lq#17807,d_current_day#17808,... 4 more fields] parquet
         :                 +- SubqueryAlias `customer_address`
         :                    +- Relation[ca_address_sk#17826,ca_address_id#17827,ca_street_number#17828,ca_street_name#17829,ca_street_type#17830,ca_suite_number#17831,ca_city#17832,ca_county#17833,ca_state#17834,ca_zip#17835,ca_country#17836,ca_gmt_offset#17837,ca_location_type#17838] parquet
         +- SubqueryAlias `ws3`
            +- SubqueryAlias `ws`
               +- Aggregate [ca_county#17929, d_qoy#17891, d_year#17887], [ca_county#17929, d_qoy#17891, d_year#17887, sum(ws_ext_sales_price#239) AS web_sales#17839]
                  +- Filter ((ws_sold_date_sk#216 = d_date_sk#17881) && (ws_bill_addr_sk#223 = ca_address_sk#17922))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `web_sales`
                        :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  +- SubqueryAlias `date_dim`
                        :     +- Relation[d_date_sk#17881,d_date_id#17882,d_date#17883,d_month_seq#17884,d_week_seq#17885,d_quarter_seq#17886,d_year#17887,d_dow#17888,d_moy#17889,d_dom#17890,d_qoy#17891,d_fy_year#17892,d_fy_quarter_seq#17893,d_fy_week_seq#17894,d_day_name#17895,d_quarter_name#17896,d_holiday#17897,d_weekend#17898,d_following_holiday#17899,d_first_dom#17900,d_last_dom#17901,d_same_day_ly#17902,d_same_day_lq#17903,d_current_day#17904,... 4 more fields] parquet
                        +- SubqueryAlias `customer_address`
                           +- Relation[ca_address_sk#17922,ca_address_id#17923,ca_street_number#17924,ca_street_name#17925,ca_street_type#17926,ca_suite_number#17927,ca_city#17928,ca_county#17929,ca_state#17930,ca_zip#17931,ca_country#17932,ca_gmt_offset#17933,ca_location_type#17934] parquet

     : benchmark
19/09/08 19:42:22 INFO Query:
== Query: q31-v2.4 ==
Sort [ca_county#455 ASC NULLS FIRST], true
+- Project [ca_county#455, d_year#498, CheckOverflow((promote_precision(cast(web_sales#18195 as decimal(17,2))) / promote_precision(cast(web_sales#17946 as decimal(17,2)))), DecimalType(37,20)) AS web_q1_q2_increase#17941, CheckOverflow((promote_precision(cast(store_sales#17949 as decimal(17,2))) / promote_precision(cast(store_sales#17945 as decimal(17,2)))), DecimalType(37,20)) AS store_q1_q2_increase#17942, CheckOverflow((promote_precision(cast(web_sales#18291 as decimal(17,2))) / promote_precision(cast(web_sales#18195 as decimal(17,2)))), DecimalType(37,20)) AS web_q2_q3_increase#17943, CheckOverflow((promote_precision(cast(store_sales#18045 as decimal(17,2))) / promote_precision(cast(store_sales#17949 as decimal(17,2)))), DecimalType(37,20)) AS store_q2_q3_increase#17944]
   +- Filter ((((((d_qoy#502 = 1) && (d_year#498 = 2000)) && (ca_county#455 = ca_county#18039)) && ((d_qoy#18001 = 2) && (d_year#17997 = 2000))) && ((((ca_county#18039 = ca_county#18135) && (d_qoy#18097 = 3)) && (d_year#18093 = 2000)) && ((ca_county#455 = ca_county#18189) && (d_qoy#18151 = 1)))) && (((((d_year#18147 = 2000) && (ca_county#18189 = ca_county#18285)) && (d_qoy#18247 = 2)) && ((d_year#18243 = 2000) && (ca_county#18189 = ca_county#18381))) && (((d_qoy#18343 = 3) && (d_year#18339 = 2000)) && ((CASE WHEN (cast(web_sales#17946 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(web_sales#18195 as decimal(17,2))) / promote_precision(cast(web_sales#17946 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END > CASE WHEN (cast(store_sales#17945 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(store_sales#17949 as decimal(17,2))) / promote_precision(cast(store_sales#17945 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END) && (CASE WHEN (cast(web_sales#18195 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(web_sales#18291 as decimal(17,2))) / promote_precision(cast(web_sales#18195 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END > CASE WHEN (cast(store_sales#17949 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(store_sales#18045 as decimal(17,2))) / promote_precision(cast(store_sales#17949 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END)))))
      +- Join Inner
         :- Join Inner
         :  :- Join Inner
         :  :  :- Join Inner
         :  :  :  :- Join Inner
         :  :  :  :  :- SubqueryAlias `ss1`
         :  :  :  :  :  +- SubqueryAlias `ss`
         :  :  :  :  :     +- Aggregate [ca_county#455, d_qoy#502, d_year#498], [ca_county#455, d_qoy#502, d_year#498, sum(ss_ext_sales_price#145) AS store_sales#17945]
         :  :  :  :  :        +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && (ss_addr_sk#136 = ca_address_sk#448))
         :  :  :  :  :           +- Join Inner
         :  :  :  :  :              :- Join Inner
         :  :  :  :  :              :  :- SubqueryAlias `store_sales`
         :  :  :  :  :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  :  :              :  +- SubqueryAlias `date_dim`
         :  :  :  :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :  :  :  :  :              +- SubqueryAlias `customer_address`
         :  :  :  :  :                 +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :  :  :  :  +- SubqueryAlias `ss2`
         :  :  :  :     +- SubqueryAlias `ss`
         :  :  :  :        +- Aggregate [ca_county#18039, d_qoy#18001, d_year#17997], [ca_county#18039, d_qoy#18001, d_year#17997, sum(ss_ext_sales_price#145) AS store_sales#17949]
         :  :  :  :           +- Filter ((ss_sold_date_sk#130 = d_date_sk#17991) && (ss_addr_sk#136 = ca_address_sk#18032))
         :  :  :  :              +- Join Inner
         :  :  :  :                 :- Join Inner
         :  :  :  :                 :  :- SubqueryAlias `store_sales`
         :  :  :  :                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  :                 :  +- SubqueryAlias `date_dim`
         :  :  :  :                 :     +- Relation[d_date_sk#17991,d_date_id#17992,d_date#17993,d_month_seq#17994,d_week_seq#17995,d_quarter_seq#17996,d_year#17997,d_dow#17998,d_moy#17999,d_dom#18000,d_qoy#18001,d_fy_year#18002,d_fy_quarter_seq#18003,d_fy_week_seq#18004,d_day_name#18005,d_quarter_name#18006,d_holiday#18007,d_weekend#18008,d_following_holiday#18009,d_first_dom#18010,d_last_dom#18011,d_same_day_ly#18012,d_same_day_lq#18013,d_current_day#18014,... 4 more fields] parquet
         :  :  :  :                 +- SubqueryAlias `customer_address`
         :  :  :  :                    +- Relation[ca_address_sk#18032,ca_address_id#18033,ca_street_number#18034,ca_street_name#18035,ca_street_type#18036,ca_suite_number#18037,ca_city#18038,ca_county#18039,ca_state#18040,ca_zip#18041,ca_country#18042,ca_gmt_offset#18043,ca_location_type#18044] parquet
         :  :  :  +- SubqueryAlias `ss3`
         :  :  :     +- SubqueryAlias `ss`
         :  :  :        +- Aggregate [ca_county#18135, d_qoy#18097, d_year#18093], [ca_county#18135, d_qoy#18097, d_year#18093, sum(ss_ext_sales_price#145) AS store_sales#18045]
         :  :  :           +- Filter ((ss_sold_date_sk#130 = d_date_sk#18087) && (ss_addr_sk#136 = ca_address_sk#18128))
         :  :  :              +- Join Inner
         :  :  :                 :- Join Inner
         :  :  :                 :  :- SubqueryAlias `store_sales`
         :  :  :                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :                 :  +- SubqueryAlias `date_dim`
         :  :  :                 :     +- Relation[d_date_sk#18087,d_date_id#18088,d_date#18089,d_month_seq#18090,d_week_seq#18091,d_quarter_seq#18092,d_year#18093,d_dow#18094,d_moy#18095,d_dom#18096,d_qoy#18097,d_fy_year#18098,d_fy_quarter_seq#18099,d_fy_week_seq#18100,d_day_name#18101,d_quarter_name#18102,d_holiday#18103,d_weekend#18104,d_following_holiday#18105,d_first_dom#18106,d_last_dom#18107,d_same_day_ly#18108,d_same_day_lq#18109,d_current_day#18110,... 4 more fields] parquet
         :  :  :                 +- SubqueryAlias `customer_address`
         :  :  :                    +- Relation[ca_address_sk#18128,ca_address_id#18129,ca_street_number#18130,ca_street_name#18131,ca_street_type#18132,ca_suite_number#18133,ca_city#18134,ca_county#18135,ca_state#18136,ca_zip#18137,ca_country#18138,ca_gmt_offset#18139,ca_location_type#18140] parquet
         :  :  +- SubqueryAlias `ws1`
         :  :     +- SubqueryAlias `ws`
         :  :        +- Aggregate [ca_county#18189, d_qoy#18151, d_year#18147], [ca_county#18189, d_qoy#18151, d_year#18147, sum(ws_ext_sales_price#239) AS web_sales#17946]
         :  :           +- Filter ((ws_sold_date_sk#216 = d_date_sk#18141) && (ws_bill_addr_sk#223 = ca_address_sk#18182))
         :  :              +- Join Inner
         :  :                 :- Join Inner
         :  :                 :  :- SubqueryAlias `web_sales`
         :  :                 :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
         :  :                 :  +- SubqueryAlias `date_dim`
         :  :                 :     +- Relation[d_date_sk#18141,d_date_id#18142,d_date#18143,d_month_seq#18144,d_week_seq#18145,d_quarter_seq#18146,d_year#18147,d_dow#18148,d_moy#18149,d_dom#18150,d_qoy#18151,d_fy_year#18152,d_fy_quarter_seq#18153,d_fy_week_seq#18154,d_day_name#18155,d_quarter_name#18156,d_holiday#18157,d_weekend#18158,d_following_holiday#18159,d_first_dom#18160,d_last_dom#18161,d_same_day_ly#18162,d_same_day_lq#18163,d_current_day#18164,... 4 more fields] parquet
         :  :                 +- SubqueryAlias `customer_address`
         :  :                    +- Relation[ca_address_sk#18182,ca_address_id#18183,ca_street_number#18184,ca_street_name#18185,ca_street_type#18186,ca_suite_number#18187,ca_city#18188,ca_county#18189,ca_state#18190,ca_zip#18191,ca_country#18192,ca_gmt_offset#18193,ca_location_type#18194] parquet
         :  +- SubqueryAlias `ws2`
         :     +- SubqueryAlias `ws`
         :        +- Aggregate [ca_county#18285, d_qoy#18247, d_year#18243], [ca_county#18285, d_qoy#18247, d_year#18243, sum(ws_ext_sales_price#239) AS web_sales#18195]
         :           +- Filter ((ws_sold_date_sk#216 = d_date_sk#18237) && (ws_bill_addr_sk#223 = ca_address_sk#18278))
         :              +- Join Inner
         :                 :- Join Inner
         :                 :  :- SubqueryAlias `web_sales`
         :                 :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
         :                 :  +- SubqueryAlias `date_dim`
         :                 :     +- Relation[d_date_sk#18237,d_date_id#18238,d_date#18239,d_month_seq#18240,d_week_seq#18241,d_quarter_seq#18242,d_year#18243,d_dow#18244,d_moy#18245,d_dom#18246,d_qoy#18247,d_fy_year#18248,d_fy_quarter_seq#18249,d_fy_week_seq#18250,d_day_name#18251,d_quarter_name#18252,d_holiday#18253,d_weekend#18254,d_following_holiday#18255,d_first_dom#18256,d_last_dom#18257,d_same_day_ly#18258,d_same_day_lq#18259,d_current_day#18260,... 4 more fields] parquet
         :                 +- SubqueryAlias `customer_address`
         :                    +- Relation[ca_address_sk#18278,ca_address_id#18279,ca_street_number#18280,ca_street_name#18281,ca_street_type#18282,ca_suite_number#18283,ca_city#18284,ca_county#18285,ca_state#18286,ca_zip#18287,ca_country#18288,ca_gmt_offset#18289,ca_location_type#18290] parquet
         +- SubqueryAlias `ws3`
            +- SubqueryAlias `ws`
               +- Aggregate [ca_county#18381, d_qoy#18343, d_year#18339], [ca_county#18381, d_qoy#18343, d_year#18339, sum(ws_ext_sales_price#239) AS web_sales#18291]
                  +- Filter ((ws_sold_date_sk#216 = d_date_sk#18333) && (ws_bill_addr_sk#223 = ca_address_sk#18374))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `web_sales`
                        :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  +- SubqueryAlias `date_dim`
                        :     +- Relation[d_date_sk#18333,d_date_id#18334,d_date#18335,d_month_seq#18336,d_week_seq#18337,d_quarter_seq#18338,d_year#18339,d_dow#18340,d_moy#18341,d_dom#18342,d_qoy#18343,d_fy_year#18344,d_fy_quarter_seq#18345,d_fy_week_seq#18346,d_day_name#18347,d_quarter_name#18348,d_holiday#18349,d_weekend#18350,d_following_holiday#18351,d_first_dom#18352,d_last_dom#18353,d_same_day_ly#18354,d_same_day_lq#18355,d_current_day#18356,... 4 more fields] parquet
                        +- SubqueryAlias `customer_address`
                           +- Relation[ca_address_sk#18374,ca_address_id#18375,ca_street_number#18376,ca_street_name#18377,ca_street_type#18378,ca_suite_number#18379,ca_city#18380,ca_county#18381,ca_state#18382,ca_zip#18383,ca_country#18384,ca_gmt_offset#18385,ca_location_type#18386] parquet

      running Thread[benchmark runner,5,main]
Execution time: 44.579343376s
Running execution q32-v2.4 iteration: 1, StandardRun=true
19/09/08 19:43:09 INFO Query:
== Query: q32-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [sum(cs_ext_discount_amt#22) AS excess discount amount#19334]
      +- Filter ((((i_manufact_id#577 = 977) && (i_item_sk#564 = cs_item_sk#15)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && ((d_date_sk#492 = cs_sold_date_sk#0) && (cast(cs_ext_discount_amt#22 as decimal(14,7)) > cast(scalar-subquery#19335 [i_item_sk#564] as decimal(14,7)))))
         :  +- Aggregate [CheckOverflow((promote_precision(cast(1.3 as decimal(11,6))) * promote_precision(cast(avg(cs_ext_discount_amt#22) as decimal(11,6)))), DecimalType(14,7)) AS (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(cs_ext_discount_amt) AS DECIMAL(11,6)))#19337]
         :     +- Filter (((cs_item_sk#15 = outer(i_item_sk#564)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && (d_date_sk#492 = cs_sold_date_sk#0))
         :        +- Join Inner
         :           :- SubqueryAlias `catalog_sales`
         :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :           +- SubqueryAlias `date_dim`
         :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- Join Inner
            :- Join Inner
            :  :- SubqueryAlias `catalog_sales`
            :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :  +- SubqueryAlias `item`
            :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            +- SubqueryAlias `date_dim`
               +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 19:43:09 INFO Query:
== Query: q32-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [sum(cs_ext_discount_amt#22) AS excess discount amount#19340]
      +- Filter ((((i_manufact_id#577 = 977) && (i_item_sk#564 = cs_item_sk#15)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && ((d_date_sk#492 = cs_sold_date_sk#0) && (cast(cs_ext_discount_amt#22 as decimal(14,7)) > cast(scalar-subquery#19341 [i_item_sk#564] as decimal(14,7)))))
         :  +- Aggregate [CheckOverflow((promote_precision(cast(1.3 as decimal(11,6))) * promote_precision(cast(avg(cs_ext_discount_amt#22) as decimal(11,6)))), DecimalType(14,7)) AS (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(cs_ext_discount_amt) AS DECIMAL(11,6)))#19343]
         :     +- Filter (((cs_item_sk#15 = outer(i_item_sk#564)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && (d_date_sk#492 = cs_sold_date_sk#0))
         :        +- Join Inner
         :           :- SubqueryAlias `catalog_sales`
         :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :           +- SubqueryAlias `date_dim`
         :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- Join Inner
            :- Join Inner
            :  :- SubqueryAlias `catalog_sales`
            :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :  +- SubqueryAlias `item`
            :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            +- SubqueryAlias `date_dim`
               +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 12.645047194s
Running execution q33-v2.4 iteration: 1, StandardRun=true
19/09/08 19:43:23 INFO Query:
== Query: q33-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [total_sales#19394 ASC NULLS FIRST], true
      +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(total_sales#19395) AS total_sales#19394]
         +- SubqueryAlias `tmp1`
            +- Union
               :- Union
               :  :- Project [i_manufact_id#577, total_sales#19395]
               :  :  +- SubqueryAlias `ss`
               :  :     +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(ss_ext_sales_price#145) AS total_sales#19395]
               :  :        +- Filter (((i_manufact_id#577 IN (list#19396 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 5) && (ss_addr_sk#136 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :  :           :  +- Project [i_manufact_id#577]
               :  :           :     +- Filter i_category#576 IN (Electronics)
               :  :           :        +- SubqueryAlias `item`
               :  :           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- Join Inner
               :  :              :  :  :- SubqueryAlias `store_sales`
               :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :              :  :  +- SubqueryAlias `date_dim`
               :  :              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              :  +- SubqueryAlias `customer_address`
               :  :              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  :              +- SubqueryAlias `item`
               :  :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- Project [i_manufact_id#577, total_sales#19397]
               :     +- SubqueryAlias `cs`
               :        +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(cs_ext_sales_price#23) AS total_sales#19397]
               :           +- Filter (((i_manufact_id#577 IN (list#19398 []) && (cs_item_sk#15 = i_item_sk#564)) && ((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 5) && (cs_bill_addr_sk#6 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :              :  +- Project [i_manufact_id#577]
               :              :     +- Filter i_category#576 IN (Electronics)
               :              :        +- SubqueryAlias `item`
               :              :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- Join Inner
               :                 :  :  :- SubqueryAlias `catalog_sales`
               :                 :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :  :  +- SubqueryAlias `date_dim`
               :                 :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :  +- SubqueryAlias `customer_address`
               :                 :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :                 +- SubqueryAlias `item`
               :                    +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Project [i_manufact_id#577, total_sales#19399]
                  +- SubqueryAlias `ws`
                     +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(ws_ext_sales_price#239) AS total_sales#19399]
                        +- Filter (((i_manufact_id#577 IN (list#19400 []) && (ws_item_sk#219 = i_item_sk#564)) && ((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 5) && (ws_bill_addr_sk#223 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
                           :  +- Project [i_manufact_id#577]
                           :     +- Filter i_category#576 IN (Electronics)
                           :        +- SubqueryAlias `item`
                           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `web_sales`
                              :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :  +- SubqueryAlias `date_dim`
                              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `customer_address`
                              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 19:43:23 INFO Query:
== Query: q33-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [total_sales#19408 ASC NULLS FIRST], true
      +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(total_sales#19409) AS total_sales#19408]
         +- SubqueryAlias `tmp1`
            +- Union
               :- Union
               :  :- Project [i_manufact_id#577, total_sales#19409]
               :  :  +- SubqueryAlias `ss`
               :  :     +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(ss_ext_sales_price#145) AS total_sales#19409]
               :  :        +- Filter (((i_manufact_id#577 IN (list#19410 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 5) && (ss_addr_sk#136 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :  :           :  +- Project [i_manufact_id#577]
               :  :           :     +- Filter i_category#576 IN (Electronics)
               :  :           :        +- SubqueryAlias `item`
               :  :           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- Join Inner
               :  :              :  :  :- SubqueryAlias `store_sales`
               :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :              :  :  +- SubqueryAlias `date_dim`
               :  :              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              :  +- SubqueryAlias `customer_address`
               :  :              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  :              +- SubqueryAlias `item`
               :  :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- Project [i_manufact_id#577, total_sales#19411]
               :     +- SubqueryAlias `cs`
               :        +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(cs_ext_sales_price#23) AS total_sales#19411]
               :           +- Filter (((i_manufact_id#577 IN (list#19412 []) && (cs_item_sk#15 = i_item_sk#564)) && ((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 5) && (cs_bill_addr_sk#6 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :              :  +- Project [i_manufact_id#577]
               :              :     +- Filter i_category#576 IN (Electronics)
               :              :        +- SubqueryAlias `item`
               :              :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- Join Inner
               :                 :  :  :- SubqueryAlias `catalog_sales`
               :                 :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :  :  +- SubqueryAlias `date_dim`
               :                 :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :  +- SubqueryAlias `customer_address`
               :                 :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :                 +- SubqueryAlias `item`
               :                    +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Project [i_manufact_id#577, total_sales#19413]
                  +- SubqueryAlias `ws`
                     +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(ws_ext_sales_price#239) AS total_sales#19413]
                        +- Filter (((i_manufact_id#577 IN (list#19414 []) && (ws_item_sk#219 = i_item_sk#564)) && ((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 5) && (ws_bill_addr_sk#223 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
                           :  +- Project [i_manufact_id#577]
                           :     +- Filter i_category#576 IN (Electronics)
                           :        +- SubqueryAlias `item`
                           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `web_sales`
                              :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :  +- SubqueryAlias `date_dim`
                              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `customer_address`
                              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 23.424295879000002s
Running execution q34-v2.4 iteration: 1, StandardRun=true
19/09/08 19:43:48 INFO Query:
== Query: q34-v2.4 ==
Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, c_salutation#419 ASC NULLS FIRST, c_preferred_cust_flag#422 DESC NULLS LAST, ss_ticket_number#139L ASC NULLS FIRST], true
+- Project [c_last_name#421, c_first_name#420, c_salutation#419, c_preferred_cust_flag#422, ss_ticket_number#139L, cnt#19475L]
   +- Filter ((ss_customer_sk#133 = c_customer_sk#412) && ((cnt#19475L >= cast(15 as bigint)) && (cnt#19475L <= cast(20 as bigint))))
      +- Join Inner
         :- SubqueryAlias `dn`
         :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133], [ss_ticket_number#139L, ss_customer_sk#133, count(1) AS cnt#19475L]
         :     +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((((d_dom#501 >= 1) && (d_dom#501 <= 3)) || ((d_dom#501 >= 25) && (d_dom#501 <= 28))) && ((hd_buy_potential#550 = >10000) || (hd_buy_potential#550 = unknown)))) && (((hd_vehicle_count#552 > 0) && (CASE WHEN (hd_vehicle_count#552 > 0) THEN (cast(hd_dep_count#551 as double) / cast(hd_vehicle_count#552 as double)) ELSE cast(null as double) END > cast(1.2 as double))) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_county#687 IN (Williamson County,Williamson County,Williamson County,Williamson County,Williamson County,Williamson County,Williamson County,Williamson County))))
         :        +- Join Inner
         :           :- Join Inner
         :           :  :- Join Inner
         :           :  :  :- SubqueryAlias `store_sales`
         :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :           :  :  +- SubqueryAlias `date_dim`
         :           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :           :  +- SubqueryAlias `store`
         :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :           +- SubqueryAlias `household_demographics`
         :              +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         +- SubqueryAlias `customer`
            +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/09/08 19:43:48 INFO Query:
== Query: q34-v2.4 ==
Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, c_salutation#419 ASC NULLS FIRST, c_preferred_cust_flag#422 DESC NULLS LAST, ss_ticket_number#139L ASC NULLS FIRST], true
+- Project [c_last_name#421, c_first_name#420, c_salutation#419, c_preferred_cust_flag#422, ss_ticket_number#139L, cnt#19483L]
   +- Filter ((ss_customer_sk#133 = c_customer_sk#412) && ((cnt#19483L >= cast(15 as bigint)) && (cnt#19483L <= cast(20 as bigint))))
      +- Join Inner
         :- SubqueryAlias `dn`
         :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133], [ss_ticket_number#139L, ss_customer_sk#133, count(1) AS cnt#19483L]
         :     +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((((d_dom#501 >= 1) && (d_dom#501 <= 3)) || ((d_dom#501 >= 25) && (d_dom#501 <= 28))) && ((hd_buy_potential#550 = >10000) || (hd_buy_potential#550 = unknown)))) && (((hd_vehicle_count#552 > 0) && (CASE WHEN (hd_vehicle_count#552 > 0) THEN (cast(hd_dep_count#551 as double) / cast(hd_vehicle_count#552 as double)) ELSE cast(null as double) END > cast(1.2 as double))) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_county#687 IN (Williamson County,Williamson County,Williamson County,Williamson County,Williamson County,Williamson County,Williamson County,Williamson County))))
         :        +- Join Inner
         :           :- Join Inner
         :           :  :- Join Inner
         :           :  :  :- SubqueryAlias `store_sales`
         :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :           :  :  +- SubqueryAlias `date_dim`
         :           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :           :  +- SubqueryAlias `store`
         :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :           +- SubqueryAlias `household_demographics`
         :              +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         +- SubqueryAlias `customer`
            +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 10.782171854s
Running execution q35-v2.4 iteration: 1, StandardRun=true
19/09/08 19:44:00 INFO Query:
== Query: q35-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ca_state#456, cd_gender#475, cd_marital_status#476, cd_dep_count#480, cnt1#19589L, min(cd_dep_count)#19607, max(cd_dep_count)#19608, avg(cd_dep_count)#19609, cd_dep_employed_count#481, cnt2#19590L, min(cd_dep_employed_count)#19610, max(cd_dep_employed_count)#19611, avg(cd_dep_employed_count)#19612, cd_dep_college_count#482, cnt3#19591L, min(cd_dep_college_count)#19613, max(cd_dep_college_count)#19614, avg(cd_dep_college_count)#19615]
      +- Sort [ca_state#456 ASC NULLS FIRST, cd_gender#475 ASC NULLS FIRST, cd_marital_status#476 ASC NULLS FIRST, cd_dep_count#480 ASC NULLS FIRST, cd_dep_employed_count#481 ASC NULLS FIRST, cd_dep_college_count#482 ASC NULLS FIRST], true
         +- Aggregate [ca_state#456, cd_gender#475, cd_marital_status#476, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482], [ca_state#456, cd_gender#475, cd_marital_status#476, cd_dep_count#480, count(1) AS cnt1#19589L, min(cd_dep_count#480) AS min(cd_dep_count)#19607, max(cd_dep_count#480) AS max(cd_dep_count)#19608, avg(cast(cd_dep_count#480 as bigint)) AS avg(cd_dep_count)#19609, cd_dep_employed_count#481, count(1) AS cnt2#19590L, min(cd_dep_employed_count#481) AS min(cd_dep_employed_count)#19610, max(cd_dep_employed_count#481) AS max(cd_dep_employed_count)#19611, avg(cast(cd_dep_employed_count#481 as bigint)) AS avg(cd_dep_employed_count)#19612, cd_dep_college_count#482, count(1) AS cnt3#19591L, min(cd_dep_college_count#482) AS min(cd_dep_college_count)#19613, max(cd_dep_college_count#482) AS max(cd_dep_college_count)#19614, avg(cast(cd_dep_college_count#482 as bigint)) AS avg(cd_dep_college_count)#19615]
            +- Filter (((c_current_addr_sk#416 = ca_address_sk#448) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && (exists#19592 [c_customer_sk#412] && (exists#19593 [c_customer_sk#412] || exists#19594 [c_customer_sk#412])))
               :  :- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 27 more fields]
               :  :  +- Filter (((outer(c_customer_sk#412) = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = 2002) && (d_qoy#502 < 4)))
               :  :     +- Join Inner
               :  :        :- SubqueryAlias `store_sales`
               :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :        +- SubqueryAlias `date_dim`
               :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 38 more fields]
               :  :  +- Filter (((outer(c_customer_sk#412) = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = 2002) && (d_qoy#502 < 4)))
               :  :     +- Join Inner
               :  :        :- SubqueryAlias `web_sales`
               :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :        +- SubqueryAlias `date_dim`
               :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 38 more fields]
               :     +- Filter (((outer(c_customer_sk#412) = cs_ship_customer_sk#7) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = 2002) && (d_qoy#502 < 4)))
               :        +- Join Inner
               :           :- SubqueryAlias `catalog_sales`
               :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :           +- SubqueryAlias `date_dim`
               :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- SubqueryAlias `c`
                  :  :  +- SubqueryAlias `customer`
                  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  +- SubqueryAlias `ca`
                  :     +- SubqueryAlias `customer_address`
                  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `customer_demographics`
                     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet

     : benchmark
19/09/08 19:44:00 INFO Query:
== Query: q35-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ca_state#456, cd_gender#475, cd_marital_status#476, cd_dep_count#480, cnt1#19640L, min(cd_dep_count)#19658, max(cd_dep_count)#19659, avg(cd_dep_count)#19660, cd_dep_employed_count#481, cnt2#19641L, min(cd_dep_employed_count)#19661, max(cd_dep_employed_count)#19662, avg(cd_dep_employed_count)#19663, cd_dep_college_count#482, cnt3#19642L, min(cd_dep_college_count)#19664, max(cd_dep_college_count)#19665, avg(cd_dep_college_count)#19666]
      +- Sort [ca_state#456 ASC NULLS FIRST, cd_gender#475 ASC NULLS FIRST, cd_marital_status#476 ASC NULLS FIRST, cd_dep_count#480 ASC NULLS FIRST, cd_dep_employed_count#481 ASC NULLS FIRST, cd_dep_college_count#482 ASC NULLS FIRST], true
         +- Aggregate [ca_state#456, cd_gender#475, cd_marital_status#476, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482], [ca_state#456, cd_gender#475, cd_marital_status#476, cd_dep_count#480, count(1) AS cnt1#19640L, min(cd_dep_count#480) AS min(cd_dep_count)#19658, max(cd_dep_count#480) AS max(cd_dep_count)#19659, avg(cast(cd_dep_count#480 as bigint)) AS avg(cd_dep_count)#19660, cd_dep_employed_count#481, count(1) AS cnt2#19641L, min(cd_dep_employed_count#481) AS min(cd_dep_employed_count)#19661, max(cd_dep_employed_count#481) AS max(cd_dep_employed_count)#19662, avg(cast(cd_dep_employed_count#481 as bigint)) AS avg(cd_dep_employed_count)#19663, cd_dep_college_count#482, count(1) AS cnt3#19642L, min(cd_dep_college_count#482) AS min(cd_dep_college_count)#19664, max(cd_dep_college_count#482) AS max(cd_dep_college_count)#19665, avg(cast(cd_dep_college_count#482 as bigint)) AS avg(cd_dep_college_count)#19666]
            +- Filter (((c_current_addr_sk#416 = ca_address_sk#448) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && (exists#19643 [c_customer_sk#412] && (exists#19644 [c_customer_sk#412] || exists#19645 [c_customer_sk#412])))
               :  :- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 27 more fields]
               :  :  +- Filter (((outer(c_customer_sk#412) = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = 2002) && (d_qoy#502 < 4)))
               :  :     +- Join Inner
               :  :        :- SubqueryAlias `store_sales`
               :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :        +- SubqueryAlias `date_dim`
               :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 38 more fields]
               :  :  +- Filter (((outer(c_customer_sk#412) = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = 2002) && (d_qoy#502 < 4)))
               :  :     +- Join Inner
               :  :        :- SubqueryAlias `web_sales`
               :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :        +- SubqueryAlias `date_dim`
               :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 38 more fields]
               :     +- Filter (((outer(c_customer_sk#412) = cs_ship_customer_sk#7) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = 2002) && (d_qoy#502 < 4)))
               :        +- Join Inner
               :           :- SubqueryAlias `catalog_sales`
               :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :           +- SubqueryAlias `date_dim`
               :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- SubqueryAlias `c`
                  :  :  +- SubqueryAlias `customer`
                  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  +- SubqueryAlias `ca`
                  :     +- SubqueryAlias `customer_address`
                  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `customer_demographics`
                     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet

      running Thread[benchmark runner,5,main]
Execution time: 24.310923612s
Running execution q36-v2.4 iteration: 1, StandardRun=true
19/09/08 19:44:26 INFO Query:
== Query: q36-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#19870 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#19870 as int) = 0) THEN i_category#19881 END ASC NULLS FIRST, rank_within_parent#19871 ASC NULLS FIRST], true
      +- Project [gross_margin#19869, i_category#19881, i_class#19882, lochierarchy#19870, rank_within_parent#19871]
         +- Project [gross_margin#19869, i_category#19881, i_class#19882, lochierarchy#19870, _w0#19891, _w1#19895, _w2#19896, _w3#19897, rank_within_parent#19871, rank_within_parent#19871]
            +- Window [rank(_w3#19897) windowspecdefinition(_w1#19895, _w2#19896, _w3#19897 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#19871], [_w1#19895, _w2#19896], [_w3#19897 ASC NULLS FIRST]
               +- Aggregate [i_category#19881, i_class#19882, spark_grouping_id#19878], [CheckOverflow((promote_precision(cast(sum(ss_net_profit#152) as decimal(17,2))) / promote_precision(cast(sum(ss_ext_sales_price#145) as decimal(17,2)))), DecimalType(37,20)) AS gross_margin#19869, i_category#19881, i_class#19882, (cast((shiftright(spark_grouping_id#19878, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#19878, 0) & 1) as tinyint)) AS lochierarchy#19870, CheckOverflow((promote_precision(cast(sum(ss_net_profit#152) as decimal(17,2))) / promote_precision(cast(sum(ss_ext_sales_price#145) as decimal(17,2)))), DecimalType(37,20)) AS _w0#19891, (cast((shiftright(spark_grouping_id#19878, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#19878, 0) & 1) as tinyint)) AS _w1#19895, CASE WHEN (cast(cast((shiftright(spark_grouping_id#19878, 0) & 1) as tinyint) as int) = 0) THEN i_category#19881 END AS _w2#19896, CheckOverflow((promote_precision(cast(sum(ss_net_profit#152) as decimal(17,2))) / promote_precision(cast(sum(ss_ext_sales_price#145) as decimal(17,2)))), DecimalType(37,20)) AS _w3#19897]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_category#19879, i_class#19880, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_category#19879, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 81 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 80 more fields]
                        +- Filter ((((d_year#498 = 2001) && (d_date_sk#492 = ss_sold_date_sk#130)) && (i_item_sk#564 = ss_item_sk#132)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (TN,TN,TN,TN,TN,TN,TN,TN)))
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `store_sales`
                              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  :  +- SubqueryAlias `d1`
                              :  :     +- SubqueryAlias `date_dim`
                              :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `item`
                              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/09/08 19:44:26 INFO Query:
== Query: q36-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#19913 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#19913 as int) = 0) THEN i_category#19924 END ASC NULLS FIRST, rank_within_parent#19914 ASC NULLS FIRST], true
      +- Project [gross_margin#19912, i_category#19924, i_class#19925, lochierarchy#19913, rank_within_parent#19914]
         +- Project [gross_margin#19912, i_category#19924, i_class#19925, lochierarchy#19913, _w0#19934, _w1#19938, _w2#19939, _w3#19940, rank_within_parent#19914, rank_within_parent#19914]
            +- Window [rank(_w3#19940) windowspecdefinition(_w1#19938, _w2#19939, _w3#19940 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#19914], [_w1#19938, _w2#19939], [_w3#19940 ASC NULLS FIRST]
               +- Aggregate [i_category#19924, i_class#19925, spark_grouping_id#19921], [CheckOverflow((promote_precision(cast(sum(ss_net_profit#152) as decimal(17,2))) / promote_precision(cast(sum(ss_ext_sales_price#145) as decimal(17,2)))), DecimalType(37,20)) AS gross_margin#19912, i_category#19924, i_class#19925, (cast((shiftright(spark_grouping_id#19921, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#19921, 0) & 1) as tinyint)) AS lochierarchy#19913, CheckOverflow((promote_precision(cast(sum(ss_net_profit#152) as decimal(17,2))) / promote_precision(cast(sum(ss_ext_sales_price#145) as decimal(17,2)))), DecimalType(37,20)) AS _w0#19934, (cast((shiftright(spark_grouping_id#19921, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#19921, 0) & 1) as tinyint)) AS _w1#19938, CASE WHEN (cast(cast((shiftright(spark_grouping_id#19921, 0) & 1) as tinyint) as int) = 0) THEN i_category#19924 END AS _w2#19939, CheckOverflow((promote_precision(cast(sum(ss_net_profit#152) as decimal(17,2))) / promote_precision(cast(sum(ss_ext_sales_price#145) as decimal(17,2)))), DecimalType(37,20)) AS _w3#19940]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_category#19922, i_class#19923, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_category#19922, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 81 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 80 more fields]
                        +- Filter ((((d_year#498 = 2001) && (d_date_sk#492 = ss_sold_date_sk#130)) && (i_item_sk#564 = ss_item_sk#132)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (TN,TN,TN,TN,TN,TN,TN,TN)))
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `store_sales`
                              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  :  +- SubqueryAlias `d1`
                              :  :     +- SubqueryAlias `date_dim`
                              :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `item`
                              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 13.991212363s
Running execution q37-v2.4 iteration: 1, StandardRun=true
19/09/08 19:44:41 INFO Query:
== Query: q37-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(68 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((68 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-02-01 as date)) && (d_date#494 <= cast(cast(cast(2000-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (677,940,694,808) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (cs_item_sk#15 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `catalog_sales`
                  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet

     : benchmark
19/09/08 19:44:41 INFO Query:
== Query: q37-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(68 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((68 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-02-01 as date)) && (d_date#494 <= cast(cast(cast(2000-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (677,940,694,808) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (cs_item_sk#15 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `catalog_sales`
                  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 15.607845964000001s
Running execution q38-v2.4 iteration: 1, StandardRun=true
19/09/08 19:44:58 INFO Query:
== Query: q38-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [count(1) AS count(1)#20324L]
      +- SubqueryAlias `hot_cust`
         +- Intersect false
            :- Project [c_last_name#421, c_first_name#420, d_date#494]
            :  +- Intersect false
            :     :- Project [c_last_name#421, c_first_name#420, d_date#494]
            :     :  +- Distinct
            :     :     +- Project [c_last_name#421, c_first_name#420, d_date#494]
            :     :        +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_customer_sk#133 = c_customer_sk#412)) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
            :     :           +- Join Inner
            :     :              :- Join Inner
            :     :              :  :- SubqueryAlias `store_sales`
            :     :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :              :  +- SubqueryAlias `date_dim`
            :     :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     :              +- SubqueryAlias `customer`
            :     :                 +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :     +- Project [c_last_name#20251, c_first_name#20250, d_date#20197]
            :        +- Distinct
            :           +- Project [c_last_name#20251, c_first_name#20250, d_date#20197]
            :              +- Filter (((cs_sold_date_sk#0 = d_date_sk#20195) && (cs_bill_customer_sk#3 = c_customer_sk#20242)) && ((d_month_seq#20198 >= 1200) && (d_month_seq#20198 <= (1200 + 11))))
            :                 +- Join Inner
            :                    :- Join Inner
            :                    :  :- SubqueryAlias `catalog_sales`
            :                    :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :                    :  +- SubqueryAlias `date_dim`
            :                    :     +- Relation[d_date_sk#20195,d_date_id#20196,d_date#20197,d_month_seq#20198,d_week_seq#20199,d_quarter_seq#20200,d_year#20201,d_dow#20202,d_moy#20203,d_dom#20204,d_qoy#20205,d_fy_year#20206,d_fy_quarter_seq#20207,d_fy_week_seq#20208,d_day_name#20209,d_quarter_name#20210,d_holiday#20211,d_weekend#20212,d_following_holiday#20213,d_first_dom#20214,d_last_dom#20215,d_same_day_ly#20216,d_same_day_lq#20217,d_current_day#20218,... 4 more fields] parquet
            :                    +- SubqueryAlias `customer`
            :                       +- Relation[c_customer_sk#20242,c_customer_id#20243,c_current_cdemo_sk#20244,c_current_hdemo_sk#20245,c_current_addr_sk#20246,c_first_shipto_date_sk#20247,c_first_sales_date_sk#20248,c_salutation#20249,c_first_name#20250,c_last_name#20251,c_preferred_cust_flag#20252,c_birth_day#20253,c_birth_month#20254,c_birth_year#20255,c_birth_country#20256,c_login#20257,c_email_address#20258,c_last_review_date#20259] parquet
            +- Project [c_last_name#20315, c_first_name#20314, d_date#20262]
               +- Distinct
                  +- Project [c_last_name#20315, c_first_name#20314, d_date#20262]
                     +- Filter (((ws_sold_date_sk#216 = d_date_sk#20260) && (ws_bill_customer_sk#220 = c_customer_sk#20306)) && ((d_month_seq#20263 >= 1200) && (d_month_seq#20263 <= (1200 + 11))))
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `web_sales`
                           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :  +- SubqueryAlias `date_dim`
                           :     +- Relation[d_date_sk#20260,d_date_id#20261,d_date#20262,d_month_seq#20263,d_week_seq#20264,d_quarter_seq#20265,d_year#20266,d_dow#20267,d_moy#20268,d_dom#20269,d_qoy#20270,d_fy_year#20271,d_fy_quarter_seq#20272,d_fy_week_seq#20273,d_day_name#20274,d_quarter_name#20275,d_holiday#20276,d_weekend#20277,d_following_holiday#20278,d_first_dom#20279,d_last_dom#20280,d_same_day_ly#20281,d_same_day_lq#20282,d_current_day#20283,... 4 more fields] parquet
                           +- SubqueryAlias `customer`
                              +- Relation[c_customer_sk#20306,c_customer_id#20307,c_current_cdemo_sk#20308,c_current_hdemo_sk#20309,c_current_addr_sk#20310,c_first_shipto_date_sk#20311,c_first_sales_date_sk#20312,c_salutation#20313,c_first_name#20314,c_last_name#20315,c_preferred_cust_flag#20316,c_birth_day#20317,c_birth_month#20318,c_birth_year#20319,c_birth_country#20320,c_login#20321,c_email_address#20322,c_last_review_date#20323] parquet

     : benchmark
19/09/08 19:44:58 INFO Query:
== Query: q38-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [count(1) AS count(1)#20455L]
      +- SubqueryAlias `hot_cust`
         +- Intersect false
            :- Project [c_last_name#421, c_first_name#420, d_date#494]
            :  +- Intersect false
            :     :- Project [c_last_name#421, c_first_name#420, d_date#494]
            :     :  +- Distinct
            :     :     +- Project [c_last_name#421, c_first_name#420, d_date#494]
            :     :        +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_customer_sk#133 = c_customer_sk#412)) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
            :     :           +- Join Inner
            :     :              :- Join Inner
            :     :              :  :- SubqueryAlias `store_sales`
            :     :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :              :  +- SubqueryAlias `date_dim`
            :     :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     :              +- SubqueryAlias `customer`
            :     :                 +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :     +- Project [c_last_name#20382, c_first_name#20381, d_date#20328]
            :        +- Distinct
            :           +- Project [c_last_name#20382, c_first_name#20381, d_date#20328]
            :              +- Filter (((cs_sold_date_sk#0 = d_date_sk#20326) && (cs_bill_customer_sk#3 = c_customer_sk#20373)) && ((d_month_seq#20329 >= 1200) && (d_month_seq#20329 <= (1200 + 11))))
            :                 +- Join Inner
            :                    :- Join Inner
            :                    :  :- SubqueryAlias `catalog_sales`
            :                    :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :                    :  +- SubqueryAlias `date_dim`
            :                    :     +- Relation[d_date_sk#20326,d_date_id#20327,d_date#20328,d_month_seq#20329,d_week_seq#20330,d_quarter_seq#20331,d_year#20332,d_dow#20333,d_moy#20334,d_dom#20335,d_qoy#20336,d_fy_year#20337,d_fy_quarter_seq#20338,d_fy_week_seq#20339,d_day_name#20340,d_quarter_name#20341,d_holiday#20342,d_weekend#20343,d_following_holiday#20344,d_first_dom#20345,d_last_dom#20346,d_same_day_ly#20347,d_same_day_lq#20348,d_current_day#20349,... 4 more fields] parquet
            :                    +- SubqueryAlias `customer`
            :                       +- Relation[c_customer_sk#20373,c_customer_id#20374,c_current_cdemo_sk#20375,c_current_hdemo_sk#20376,c_current_addr_sk#20377,c_first_shipto_date_sk#20378,c_first_sales_date_sk#20379,c_salutation#20380,c_first_name#20381,c_last_name#20382,c_preferred_cust_flag#20383,c_birth_day#20384,c_birth_month#20385,c_birth_year#20386,c_birth_country#20387,c_login#20388,c_email_address#20389,c_last_review_date#20390] parquet
            +- Project [c_last_name#20446, c_first_name#20445, d_date#20393]
               +- Distinct
                  +- Project [c_last_name#20446, c_first_name#20445, d_date#20393]
                     +- Filter (((ws_sold_date_sk#216 = d_date_sk#20391) && (ws_bill_customer_sk#220 = c_customer_sk#20437)) && ((d_month_seq#20394 >= 1200) && (d_month_seq#20394 <= (1200 + 11))))
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `web_sales`
                           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :  +- SubqueryAlias `date_dim`
                           :     +- Relation[d_date_sk#20391,d_date_id#20392,d_date#20393,d_month_seq#20394,d_week_seq#20395,d_quarter_seq#20396,d_year#20397,d_dow#20398,d_moy#20399,d_dom#20400,d_qoy#20401,d_fy_year#20402,d_fy_quarter_seq#20403,d_fy_week_seq#20404,d_day_name#20405,d_quarter_name#20406,d_holiday#20407,d_weekend#20408,d_following_holiday#20409,d_first_dom#20410,d_last_dom#20411,d_same_day_ly#20412,d_same_day_lq#20413,d_current_day#20414,... 4 more fields] parquet
                           +- SubqueryAlias `customer`
                              +- Relation[c_customer_sk#20437,c_customer_id#20438,c_current_cdemo_sk#20439,c_current_hdemo_sk#20440,c_current_addr_sk#20441,c_first_shipto_date_sk#20442,c_first_sales_date_sk#20443,c_salutation#20444,c_first_name#20445,c_last_name#20446,c_preferred_cust_flag#20447,c_birth_day#20448,c_birth_month#20449,c_birth_year#20450,c_birth_country#20451,c_login#20452,c_email_address#20453,c_last_review_date#20454] parquet

      running Thread[benchmark runner,5,main]
Execution time: 31.884605569999998s
Running execution q39a-v2.4 iteration: 1, StandardRun=true
19/09/08 19:45:31 INFO Query:
== Query: q39a-v2.4 ==
Sort [w_warehouse_sk#742 ASC NULLS FIRST, i_item_sk#564 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, mean#21097 ASC NULLS FIRST, cov#21098 ASC NULLS FIRST, d_moy#21372 ASC NULLS FIRST, mean#21193 ASC NULLS FIRST, cov#21125 ASC NULLS FIRST], true
+- Project [w_warehouse_sk#742, i_item_sk#564, d_moy#500, mean#21097, cov#21098, w_warehouse_sk#21322, i_item_sk#21258, d_moy#21372, mean#21193, cov#21125]
   +- Filter (((i_item_sk#564 = i_item_sk#21258) && (w_warehouse_sk#742 = w_warehouse_sk#21322)) && ((d_moy#500 = 1) && (d_moy#21372 = (1 + 1))))
      +- Join Inner
         :- SubqueryAlias `inv1`
         :  +- SubqueryAlias `inv`
         :     +- Project [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stdev#21096, mean#21097, CASE WHEN (mean#21097 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#21096 / mean#21097) END AS cov#21098]
         :        +- Filter (CASE WHEN (mean#21097 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#21096 / mean#21097) END > cast(1 as double))
         :           +- SubqueryAlias `foo`
         :              +- Aggregate [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500], [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#21096, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#21097]
         :                 +- Filter (((inv_item_sk#123 = i_item_sk#564) && (inv_warehouse_sk#124 = w_warehouse_sk#742)) && ((inv_date_sk#122 = d_date_sk#492) && (d_year#498 = 2001)))
         :                    +- Join Inner
         :                       :- Join Inner
         :                       :  :- Join Inner
         :                       :  :  :- SubqueryAlias `inventory`
         :                       :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
         :                       :  :  +- SubqueryAlias `item`
         :                       :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         :                       :  +- SubqueryAlias `warehouse`
         :                       :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
         :                       +- SubqueryAlias `date_dim`
         :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- SubqueryAlias `inv2`
            +- SubqueryAlias `inv`
               +- Project [w_warehouse_name#21324, w_warehouse_sk#21322, i_item_sk#21258, d_moy#21372, stdev#21192, mean#21193, CASE WHEN (mean#21193 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#21192 / mean#21193) END AS cov#21125]
                  +- Filter (CASE WHEN (mean#21193 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#21192 / mean#21193) END > cast(1 as double))
                     +- SubqueryAlias `foo`
                        +- Aggregate [w_warehouse_name#21324, w_warehouse_sk#21322, i_item_sk#21258, d_moy#21372], [w_warehouse_name#21324, w_warehouse_sk#21322, i_item_sk#21258, d_moy#21372, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#21192, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#21193]
                           +- Filter (((inv_item_sk#123 = i_item_sk#21258) && (inv_warehouse_sk#124 = w_warehouse_sk#21322)) && ((inv_date_sk#122 = d_date_sk#21364) && (d_year#21370 = 2001)))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `inventory`
                                 :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                                 :  :  +- SubqueryAlias `item`
                                 :  :     +- Relation[i_item_sk#21258,i_item_id#21259,i_rec_start_date#21260,i_rec_end_date#21261,i_item_desc#21262,i_current_price#21263,i_wholesale_cost#21264,i_brand_id#21265,i_brand#21266,i_class_id#21267,i_class#21268,i_category_id#21269,i_category#21270,i_manufact_id#21271,i_manufact#21272,i_size#21273,i_formulation#21274,i_color#21275,i_units#21276,i_container#21277,i_manager_id#21278,i_product_name#21279] parquet
                                 :  +- SubqueryAlias `warehouse`
                                 :     +- Relation[w_warehouse_sk#21322,w_warehouse_id#21323,w_warehouse_name#21324,w_warehouse_sq_ft#21325,w_street_number#21326,w_street_name#21327,w_street_type#21328,w_suite_number#21329,w_city#21330,w_county#21331,w_state#21332,w_zip#21333,w_country#21334,w_gmt_offset#21335] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#21364,d_date_id#21365,d_date#21366,d_month_seq#21367,d_week_seq#21368,d_quarter_seq#21369,d_year#21370,d_dow#21371,d_moy#21372,d_dom#21373,d_qoy#21374,d_fy_year#21375,d_fy_quarter_seq#21376,d_fy_week_seq#21377,d_day_name#21378,d_quarter_name#21379,d_holiday#21380,d_weekend#21381,d_following_holiday#21382,d_first_dom#21383,d_last_dom#21384,d_same_day_ly#21385,d_same_day_lq#21386,d_current_day#21387,... 4 more fields] parquet

     : benchmark
19/09/08 19:45:31 INFO Query:
== Query: q39a-v2.4 ==
Sort [w_warehouse_sk#742 ASC NULLS FIRST, i_item_sk#564 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, mean#21403 ASC NULLS FIRST, cov#21404 ASC NULLS FIRST, d_moy#21678 ASC NULLS FIRST, mean#21499 ASC NULLS FIRST, cov#21431 ASC NULLS FIRST], true
+- Project [w_warehouse_sk#742, i_item_sk#564, d_moy#500, mean#21403, cov#21404, w_warehouse_sk#21628, i_item_sk#21564, d_moy#21678, mean#21499, cov#21431]
   +- Filter (((i_item_sk#564 = i_item_sk#21564) && (w_warehouse_sk#742 = w_warehouse_sk#21628)) && ((d_moy#500 = 1) && (d_moy#21678 = (1 + 1))))
      +- Join Inner
         :- SubqueryAlias `inv1`
         :  +- SubqueryAlias `inv`
         :     +- Project [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stdev#21402, mean#21403, CASE WHEN (mean#21403 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#21402 / mean#21403) END AS cov#21404]
         :        +- Filter (CASE WHEN (mean#21403 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#21402 / mean#21403) END > cast(1 as double))
         :           +- SubqueryAlias `foo`
         :              +- Aggregate [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500], [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#21402, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#21403]
         :                 +- Filter (((inv_item_sk#123 = i_item_sk#564) && (inv_warehouse_sk#124 = w_warehouse_sk#742)) && ((inv_date_sk#122 = d_date_sk#492) && (d_year#498 = 2001)))
         :                    +- Join Inner
         :                       :- Join Inner
         :                       :  :- Join Inner
         :                       :  :  :- SubqueryAlias `inventory`
         :                       :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
         :                       :  :  +- SubqueryAlias `item`
         :                       :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         :                       :  +- SubqueryAlias `warehouse`
         :                       :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
         :                       +- SubqueryAlias `date_dim`
         :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- SubqueryAlias `inv2`
            +- SubqueryAlias `inv`
               +- Project [w_warehouse_name#21630, w_warehouse_sk#21628, i_item_sk#21564, d_moy#21678, stdev#21498, mean#21499, CASE WHEN (mean#21499 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#21498 / mean#21499) END AS cov#21431]
                  +- Filter (CASE WHEN (mean#21499 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#21498 / mean#21499) END > cast(1 as double))
                     +- SubqueryAlias `foo`
                        +- Aggregate [w_warehouse_name#21630, w_warehouse_sk#21628, i_item_sk#21564, d_moy#21678], [w_warehouse_name#21630, w_warehouse_sk#21628, i_item_sk#21564, d_moy#21678, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#21498, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#21499]
                           +- Filter (((inv_item_sk#123 = i_item_sk#21564) && (inv_warehouse_sk#124 = w_warehouse_sk#21628)) && ((inv_date_sk#122 = d_date_sk#21670) && (d_year#21676 = 2001)))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `inventory`
                                 :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                                 :  :  +- SubqueryAlias `item`
                                 :  :     +- Relation[i_item_sk#21564,i_item_id#21565,i_rec_start_date#21566,i_rec_end_date#21567,i_item_desc#21568,i_current_price#21569,i_wholesale_cost#21570,i_brand_id#21571,i_brand#21572,i_class_id#21573,i_class#21574,i_category_id#21575,i_category#21576,i_manufact_id#21577,i_manufact#21578,i_size#21579,i_formulation#21580,i_color#21581,i_units#21582,i_container#21583,i_manager_id#21584,i_product_name#21585] parquet
                                 :  +- SubqueryAlias `warehouse`
                                 :     +- Relation[w_warehouse_sk#21628,w_warehouse_id#21629,w_warehouse_name#21630,w_warehouse_sq_ft#21631,w_street_number#21632,w_street_name#21633,w_street_type#21634,w_suite_number#21635,w_city#21636,w_county#21637,w_state#21638,w_zip#21639,w_country#21640,w_gmt_offset#21641] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#21670,d_date_id#21671,d_date#21672,d_month_seq#21673,d_week_seq#21674,d_quarter_seq#21675,d_year#21676,d_dow#21677,d_moy#21678,d_dom#21679,d_qoy#21680,d_fy_year#21681,d_fy_quarter_seq#21682,d_fy_week_seq#21683,d_day_name#21684,d_quarter_name#21685,d_holiday#21686,d_weekend#21687,d_following_holiday#21688,d_first_dom#21689,d_last_dom#21690,d_same_day_ly#21691,d_same_day_lq#21692,d_current_day#21693,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 9.152519593000001s
Running execution q39b-v2.4 iteration: 1, StandardRun=true
19/09/08 19:45:42 INFO Query:
== Query: q39b-v2.4 ==
Sort [w_warehouse_sk#742 ASC NULLS FIRST, i_item_sk#564 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, mean#22764 ASC NULLS FIRST, cov#22765 ASC NULLS FIRST, d_moy#23039 ASC NULLS FIRST, mean#22860 ASC NULLS FIRST, cov#22792 ASC NULLS FIRST], true
+- Project [w_warehouse_sk#742, i_item_sk#564, d_moy#500, mean#22764, cov#22765, w_warehouse_sk#22989, i_item_sk#22925, d_moy#23039, mean#22860, cov#22792]
   +- Filter ((((i_item_sk#564 = i_item_sk#22925) && (w_warehouse_sk#742 = w_warehouse_sk#22989)) && (d_moy#500 = 1)) && ((d_moy#23039 = (1 + 1)) && (cov#22765 > cast(1.5 as double))))
      +- Join Inner
         :- SubqueryAlias `inv1`
         :  +- SubqueryAlias `inv`
         :     +- Project [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stdev#22763, mean#22764, CASE WHEN (mean#22764 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#22763 / mean#22764) END AS cov#22765]
         :        +- Filter (CASE WHEN (mean#22764 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#22763 / mean#22764) END > cast(1 as double))
         :           +- SubqueryAlias `foo`
         :              +- Aggregate [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500], [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#22763, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#22764]
         :                 +- Filter (((inv_item_sk#123 = i_item_sk#564) && (inv_warehouse_sk#124 = w_warehouse_sk#742)) && ((inv_date_sk#122 = d_date_sk#492) && (d_year#498 = 2001)))
         :                    +- Join Inner
         :                       :- Join Inner
         :                       :  :- Join Inner
         :                       :  :  :- SubqueryAlias `inventory`
         :                       :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
         :                       :  :  +- SubqueryAlias `item`
         :                       :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         :                       :  +- SubqueryAlias `warehouse`
         :                       :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
         :                       +- SubqueryAlias `date_dim`
         :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- SubqueryAlias `inv2`
            +- SubqueryAlias `inv`
               +- Project [w_warehouse_name#22991, w_warehouse_sk#22989, i_item_sk#22925, d_moy#23039, stdev#22859, mean#22860, CASE WHEN (mean#22860 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#22859 / mean#22860) END AS cov#22792]
                  +- Filter (CASE WHEN (mean#22860 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#22859 / mean#22860) END > cast(1 as double))
                     +- SubqueryAlias `foo`
                        +- Aggregate [w_warehouse_name#22991, w_warehouse_sk#22989, i_item_sk#22925, d_moy#23039], [w_warehouse_name#22991, w_warehouse_sk#22989, i_item_sk#22925, d_moy#23039, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#22859, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#22860]
                           +- Filter (((inv_item_sk#123 = i_item_sk#22925) && (inv_warehouse_sk#124 = w_warehouse_sk#22989)) && ((inv_date_sk#122 = d_date_sk#23031) && (d_year#23037 = 2001)))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `inventory`
                                 :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                                 :  :  +- SubqueryAlias `item`
                                 :  :     +- Relation[i_item_sk#22925,i_item_id#22926,i_rec_start_date#22927,i_rec_end_date#22928,i_item_desc#22929,i_current_price#22930,i_wholesale_cost#22931,i_brand_id#22932,i_brand#22933,i_class_id#22934,i_class#22935,i_category_id#22936,i_category#22937,i_manufact_id#22938,i_manufact#22939,i_size#22940,i_formulation#22941,i_color#22942,i_units#22943,i_container#22944,i_manager_id#22945,i_product_name#22946] parquet
                                 :  +- SubqueryAlias `warehouse`
                                 :     +- Relation[w_warehouse_sk#22989,w_warehouse_id#22990,w_warehouse_name#22991,w_warehouse_sq_ft#22992,w_street_number#22993,w_street_name#22994,w_street_type#22995,w_suite_number#22996,w_city#22997,w_county#22998,w_state#22999,w_zip#23000,w_country#23001,w_gmt_offset#23002] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#23031,d_date_id#23032,d_date#23033,d_month_seq#23034,d_week_seq#23035,d_quarter_seq#23036,d_year#23037,d_dow#23038,d_moy#23039,d_dom#23040,d_qoy#23041,d_fy_year#23042,d_fy_quarter_seq#23043,d_fy_week_seq#23044,d_day_name#23045,d_quarter_name#23046,d_holiday#23047,d_weekend#23048,d_following_holiday#23049,d_first_dom#23050,d_last_dom#23051,d_same_day_ly#23052,d_same_day_lq#23053,d_current_day#23054,... 4 more fields] parquet

     : benchmark
19/09/08 19:45:42 INFO Query:
== Query: q39b-v2.4 ==
Sort [w_warehouse_sk#742 ASC NULLS FIRST, i_item_sk#564 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, mean#23070 ASC NULLS FIRST, cov#23071 ASC NULLS FIRST, d_moy#23345 ASC NULLS FIRST, mean#23166 ASC NULLS FIRST, cov#23098 ASC NULLS FIRST], true
+- Project [w_warehouse_sk#742, i_item_sk#564, d_moy#500, mean#23070, cov#23071, w_warehouse_sk#23295, i_item_sk#23231, d_moy#23345, mean#23166, cov#23098]
   +- Filter ((((i_item_sk#564 = i_item_sk#23231) && (w_warehouse_sk#742 = w_warehouse_sk#23295)) && (d_moy#500 = 1)) && ((d_moy#23345 = (1 + 1)) && (cov#23071 > cast(1.5 as double))))
      +- Join Inner
         :- SubqueryAlias `inv1`
         :  +- SubqueryAlias `inv`
         :     +- Project [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stdev#23069, mean#23070, CASE WHEN (mean#23070 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#23069 / mean#23070) END AS cov#23071]
         :        +- Filter (CASE WHEN (mean#23070 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#23069 / mean#23070) END > cast(1 as double))
         :           +- SubqueryAlias `foo`
         :              +- Aggregate [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500], [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#23069, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#23070]
         :                 +- Filter (((inv_item_sk#123 = i_item_sk#564) && (inv_warehouse_sk#124 = w_warehouse_sk#742)) && ((inv_date_sk#122 = d_date_sk#492) && (d_year#498 = 2001)))
         :                    +- Join Inner
         :                       :- Join Inner
         :                       :  :- Join Inner
         :                       :  :  :- SubqueryAlias `inventory`
         :                       :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
         :                       :  :  +- SubqueryAlias `item`
         :                       :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         :                       :  +- SubqueryAlias `warehouse`
         :                       :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
         :                       +- SubqueryAlias `date_dim`
         :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- SubqueryAlias `inv2`
            +- SubqueryAlias `inv`
               +- Project [w_warehouse_name#23297, w_warehouse_sk#23295, i_item_sk#23231, d_moy#23345, stdev#23165, mean#23166, CASE WHEN (mean#23166 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#23165 / mean#23166) END AS cov#23098]
                  +- Filter (CASE WHEN (mean#23166 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#23165 / mean#23166) END > cast(1 as double))
                     +- SubqueryAlias `foo`
                        +- Aggregate [w_warehouse_name#23297, w_warehouse_sk#23295, i_item_sk#23231, d_moy#23345], [w_warehouse_name#23297, w_warehouse_sk#23295, i_item_sk#23231, d_moy#23345, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#23165, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#23166]
                           +- Filter (((inv_item_sk#123 = i_item_sk#23231) && (inv_warehouse_sk#124 = w_warehouse_sk#23295)) && ((inv_date_sk#122 = d_date_sk#23337) && (d_year#23343 = 2001)))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `inventory`
                                 :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                                 :  :  +- SubqueryAlias `item`
                                 :  :     +- Relation[i_item_sk#23231,i_item_id#23232,i_rec_start_date#23233,i_rec_end_date#23234,i_item_desc#23235,i_current_price#23236,i_wholesale_cost#23237,i_brand_id#23238,i_brand#23239,i_class_id#23240,i_class#23241,i_category_id#23242,i_category#23243,i_manufact_id#23244,i_manufact#23245,i_size#23246,i_formulation#23247,i_color#23248,i_units#23249,i_container#23250,i_manager_id#23251,i_product_name#23252] parquet
                                 :  +- SubqueryAlias `warehouse`
                                 :     +- Relation[w_warehouse_sk#23295,w_warehouse_id#23296,w_warehouse_name#23297,w_warehouse_sq_ft#23298,w_street_number#23299,w_street_name#23300,w_street_type#23301,w_suite_number#23302,w_city#23303,w_county#23304,w_state#23305,w_zip#23306,w_country#23307,w_gmt_offset#23308] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#23337,d_date_id#23338,d_date#23339,d_month_seq#23340,d_week_seq#23341,d_quarter_seq#23342,d_year#23343,d_dow#23344,d_moy#23345,d_dom#23346,d_qoy#23347,d_fy_year#23348,d_fy_quarter_seq#23349,d_fy_week_seq#23350,d_day_name#23351,d_quarter_name#23352,d_holiday#23353,d_weekend#23354,d_following_holiday#23355,d_first_dom#23356,d_last_dom#23357,d_same_day_ly#23358,d_same_day_lq#23359,d_current_day#23360,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 8.035343152000001s
Running execution q40-v2.4 iteration: 1, StandardRun=true
19/09/08 19:45:51 INFO Query:
== Query: q40-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [w_state#752, i_item_id#565, sales_before#24070, sales_after#24071]
      +- Sort [w_state#752 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST], true
         +- Aggregate [w_state#752, i_item_id#565], [w_state#752, i_item_id#565, sum(CASE WHEN (cast(d_date#494 as date) < cast(2000-03-11 as date)) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_refunded_cash#91 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2)) ELSE cast(0 as decimal(13,2)) END) AS sales_before#24070, sum(CASE WHEN (cast(d_date#494 as date) >= cast(2000-03-11 as date)) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_refunded_cash#91 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2)) ELSE cast(0 as decimal(13,2)) END) AS sales_after#24071]
            +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(0.99 as decimal(7,2))) && (cast(i_current_price#569 as decimal(7,2)) <= cast(1.49 as decimal(7,2)))) && (i_item_sk#564 = cs_item_sk#15)) && (cs_warehouse_sk#14 = w_warehouse_sk#742)) && ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(cast(cast(2000-03-11 as date) as timestamp) - interval 4 weeks 2 days as date)) && (d_date#494 <= cast(cast(cast(2000-03-11 as date) as timestamp) + interval 4 weeks 2 days as date)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
                  :  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `catalog_returns`
                  :  :  :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                  :  :  +- SubqueryAlias `warehouse`
                  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 19:45:52 INFO Query:
== Query: q40-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [w_state#752, i_item_id#565, sales_before#24080, sales_after#24081]
      +- Sort [w_state#752 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST], true
         +- Aggregate [w_state#752, i_item_id#565], [w_state#752, i_item_id#565, sum(CASE WHEN (cast(d_date#494 as date) < cast(2000-03-11 as date)) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_refunded_cash#91 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2)) ELSE cast(0 as decimal(13,2)) END) AS sales_before#24080, sum(CASE WHEN (cast(d_date#494 as date) >= cast(2000-03-11 as date)) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_refunded_cash#91 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2)) ELSE cast(0 as decimal(13,2)) END) AS sales_after#24081]
            +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(0.99 as decimal(7,2))) && (cast(i_current_price#569 as decimal(7,2)) <= cast(1.49 as decimal(7,2)))) && (i_item_sk#564 = cs_item_sk#15)) && (cs_warehouse_sk#14 = w_warehouse_sk#742)) && ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(cast(cast(2000-03-11 as date) as timestamp) - interval 4 weeks 2 days as date)) && (d_date#494 <= cast(cast(cast(2000-03-11 as date) as timestamp) + interval 4 weeks 2 days as date)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
                  :  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `catalog_returns`
                  :  :  :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                  :  :  +- SubqueryAlias `warehouse`
                  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 35.187362717999996s
Running execution q41-v2.4 iteration: 1, StandardRun=true
19/09/08 19:46:28 INFO Query:
== Query: q41-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_product_name#585 ASC NULLS FIRST], true
      +- Distinct
         +- Project [i_product_name#585]
            +- Filter (((i_manufact_id#577 >= 738) && (i_manufact_id#577 <= (738 + 40))) && (scalar-subquery#24124 [i_manufact#578 && i_manufact#578] > cast(0 as bigint)))
               :  +- Aggregate [count(1) AS item_cnt#24123L]
               :     +- Filter (((i_manufact#578 = outer(i_manufact#578)) && (((((i_category#576 = Women) && ((i_color#581 = powder) || (i_color#581 = khaki))) && (((i_units#582 = Ounce) || (i_units#582 = Oz)) && ((i_size#579 = medium) || (i_size#579 = extra large)))) || (((i_category#576 = Women) && ((i_color#581 = brown) || (i_color#581 = honeydew))) && (((i_units#582 = Bunch) || (i_units#582 = Ton)) && ((i_size#579 = N/A) || (i_size#579 = small))))) || ((((i_category#576 = Men) && ((i_color#581 = floral) || (i_color#581 = deep))) && (((i_units#582 = N/A) || (i_units#582 = Dozen)) && ((i_size#579 = petite) || (i_size#579 = large)))) || (((i_category#576 = Men) && ((i_color#581 = light) || (i_color#581 = cornflower))) && (((i_units#582 = Box) || (i_units#582 = Pound)) && ((i_size#579 = medium) || (i_size#579 = extra large))))))) || ((i_manufact#578 = outer(i_manufact#578)) && (((((i_category#576 = Women) && ((i_color#581 = midnight) || (i_color#581 = snow))) && (((i_units#582 = Pallet) || (i_units#582 = Gross)) && ((i_size#579 = medium) || (i_size#579 = extra large)))) || (((i_category#576 = Women) && ((i_color#581 = cyan) || (i_color#581 = papaya))) && (((i_units#582 = Cup) || (i_units#582 = Dram)) && ((i_size#579 = N/A) || (i_size#579 = small))))) || ((((i_category#576 = Men) && ((i_color#581 = orange) || (i_color#581 = frosted))) && (((i_units#582 = Each) || (i_units#582 = Tbl)) && ((i_size#579 = petite) || (i_size#579 = large)))) || (((i_category#576 = Men) && ((i_color#581 = forest) || (i_color#581 = ghost))) && (((i_units#582 = Lb) || (i_units#582 = Bundle)) && ((i_size#579 = medium) || (i_size#579 = extra large))))))))
               :        +- SubqueryAlias `item`
               :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- SubqueryAlias `i1`
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 19:46:28 INFO Query:
== Query: q41-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_product_name#585 ASC NULLS FIRST], true
      +- Distinct
         +- Project [i_product_name#585]
            +- Filter (((i_manufact_id#577 >= 738) && (i_manufact_id#577 <= (738 + 40))) && (scalar-subquery#24128 [i_manufact#578 && i_manufact#578] > cast(0 as bigint)))
               :  +- Aggregate [count(1) AS item_cnt#24127L]
               :     +- Filter (((i_manufact#578 = outer(i_manufact#578)) && (((((i_category#576 = Women) && ((i_color#581 = powder) || (i_color#581 = khaki))) && (((i_units#582 = Ounce) || (i_units#582 = Oz)) && ((i_size#579 = medium) || (i_size#579 = extra large)))) || (((i_category#576 = Women) && ((i_color#581 = brown) || (i_color#581 = honeydew))) && (((i_units#582 = Bunch) || (i_units#582 = Ton)) && ((i_size#579 = N/A) || (i_size#579 = small))))) || ((((i_category#576 = Men) && ((i_color#581 = floral) || (i_color#581 = deep))) && (((i_units#582 = N/A) || (i_units#582 = Dozen)) && ((i_size#579 = petite) || (i_size#579 = large)))) || (((i_category#576 = Men) && ((i_color#581 = light) || (i_color#581 = cornflower))) && (((i_units#582 = Box) || (i_units#582 = Pound)) && ((i_size#579 = medium) || (i_size#579 = extra large))))))) || ((i_manufact#578 = outer(i_manufact#578)) && (((((i_category#576 = Women) && ((i_color#581 = midnight) || (i_color#581 = snow))) && (((i_units#582 = Pallet) || (i_units#582 = Gross)) && ((i_size#579 = medium) || (i_size#579 = extra large)))) || (((i_category#576 = Women) && ((i_color#581 = cyan) || (i_color#581 = papaya))) && (((i_units#582 = Cup) || (i_units#582 = Dram)) && ((i_size#579 = N/A) || (i_size#579 = small))))) || ((((i_category#576 = Men) && ((i_color#581 = orange) || (i_color#581 = frosted))) && (((i_units#582 = Each) || (i_units#582 = Tbl)) && ((i_size#579 = petite) || (i_size#579 = large)))) || (((i_category#576 = Men) && ((i_color#581 = forest) || (i_color#581 = ghost))) && (((i_units#582 = Lb) || (i_units#582 = Bundle)) && ((i_size#579 = medium) || (i_size#579 = extra large))))))))
               :        +- SubqueryAlias `item`
               :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- SubqueryAlias `i1`
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 2.184788301s
Running execution q42-v2.4 iteration: 1, StandardRun=true
19/09/08 19:46:31 INFO Query:
== Query: q42-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [d_year#498, i_category_id#575, i_category#576, sum(ss_ext_sales_price)#24158]
      +- Sort [sum(ss_ext_sales_price)#24158 DESC NULLS LAST, d_year#498 ASC NULLS FIRST, i_category_id#575 ASC NULLS FIRST, i_category#576 ASC NULLS FIRST], true
         +- Aggregate [d_year#498, i_category_id#575, i_category#576], [d_year#498, i_category_id#575, i_category#576, sum(ss_ext_sales_price#145) AS sum(ss_ext_sales_price)#24158]
            +- Filter ((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 1)) && ((d_moy#500 = 11) && (d_year#498 = 2000)))
               +- Join Inner
                  :- Join Inner
                  :  :- SubqueryAlias `dt`
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `store_sales`
                  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 19:46:31 INFO Query:
== Query: q42-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [d_year#498, i_category_id#575, i_category#576, sum(ss_ext_sales_price)#24169]
      +- Sort [sum(ss_ext_sales_price)#24169 DESC NULLS LAST, d_year#498 ASC NULLS FIRST, i_category_id#575 ASC NULLS FIRST, i_category#576 ASC NULLS FIRST], true
         +- Aggregate [d_year#498, i_category_id#575, i_category#576], [d_year#498, i_category_id#575, i_category#576, sum(ss_ext_sales_price#145) AS sum(ss_ext_sales_price)#24169]
            +- Filter ((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 1)) && ((d_moy#500 = 11) && (d_year#498 = 2000)))
               +- Join Inner
                  :- Join Inner
                  :  :- SubqueryAlias `dt`
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `store_sales`
                  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 9.244635066999999s
Running execution q43-v2.4 iteration: 1, StandardRun=true
19/09/08 19:46:41 INFO Query:
== Query: q43-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name#669 ASC NULLS FIRST, s_store_id#665 ASC NULLS FIRST, sun_sales#24250 ASC NULLS FIRST, mon_sales#24251 ASC NULLS FIRST, tue_sales#24252 ASC NULLS FIRST, wed_sales#24253 ASC NULLS FIRST, thu_sales#24254 ASC NULLS FIRST, fri_sales#24255 ASC NULLS FIRST, sat_sales#24256 ASC NULLS FIRST], true
      +- Aggregate [s_store_name#669, s_store_id#665], [s_store_name#669, s_store_id#665, sum(CASE WHEN (d_day_name#506 = Sunday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sun_sales#24250, sum(CASE WHEN (d_day_name#506 = Monday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS mon_sales#24251, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS tue_sales#24252, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS wed_sales#24253, sum(CASE WHEN (d_day_name#506 = Thursday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS thu_sales#24254, sum(CASE WHEN (d_day_name#506 = Friday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS fri_sales#24255, sum(CASE WHEN (d_day_name#506 = Saturday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sat_sales#24256]
         +- Filter (((d_date_sk#492 = ss_sold_date_sk#130) && (s_store_sk#664 = ss_store_sk#137)) && ((cast(s_gmt_offset#691 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (d_year#498 = 2000)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `date_dim`
               :  :  +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `store`
                  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/09/08 19:46:41 INFO Query:
== Query: q43-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name#669 ASC NULLS FIRST, s_store_id#665 ASC NULLS FIRST, sun_sales#24282 ASC NULLS FIRST, mon_sales#24283 ASC NULLS FIRST, tue_sales#24284 ASC NULLS FIRST, wed_sales#24285 ASC NULLS FIRST, thu_sales#24286 ASC NULLS FIRST, fri_sales#24287 ASC NULLS FIRST, sat_sales#24288 ASC NULLS FIRST], true
      +- Aggregate [s_store_name#669, s_store_id#665], [s_store_name#669, s_store_id#665, sum(CASE WHEN (d_day_name#506 = Sunday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sun_sales#24282, sum(CASE WHEN (d_day_name#506 = Monday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS mon_sales#24283, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS tue_sales#24284, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS wed_sales#24285, sum(CASE WHEN (d_day_name#506 = Thursday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS thu_sales#24286, sum(CASE WHEN (d_day_name#506 = Friday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS fri_sales#24287, sum(CASE WHEN (d_day_name#506 = Saturday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sat_sales#24288]
         +- Filter (((d_date_sk#492 = ss_sold_date_sk#130) && (s_store_sk#664 = ss_store_sk#137)) && ((cast(s_gmt_offset#691 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (d_year#498 = 2000)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `date_dim`
               :  :  +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `store`
                  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 9.19588049s
Running execution q44-v2.4 iteration: 1, StandardRun=true
19/09/08 19:46:51 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 19:46:51 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 19:46:51 INFO Query:
== Query: q44-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [rnk#24504 ASC NULLS FIRST], true
      +- Project [rnk#24504, i_product_name#585 AS best_performing#24510, i_product_name#24555 AS worst_performing#24511]
         +- Filter (((rnk#24504 = rnk#24509) && (i_item_sk#564 = item_sk#24500)) && (i_item_sk#24534 = item_sk#24505))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `asceding`
               :  :  :  +- Project [item_sk#24500, rnk#24504]
               :  :  :     +- Filter (rnk#24504 < 11)
               :  :  :        +- SubqueryAlias `V11`
               :  :  :           +- Project [item_sk#24500, rnk#24504]
               :  :  :              +- Project [item_sk#24500, rank_col#24501, rnk#24504, rnk#24504]
               :  :  :                 +- Window [rank(rank_col#24501) windowspecdefinition(rank_col#24501 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rnk#24504], [rank_col#24501 ASC NULLS FIRST]
               :  :  :                    +- Project [item_sk#24500, rank_col#24501]
               :  :  :                       +- SubqueryAlias `V1`
               :  :  :                          +- Project [item_sk#24500, rank_col#24501]
               :  :  :                             +- Filter (cast(avg(ss_net_profit#152)#24522 as decimal(13,7)) > cast(CheckOverflow((promote_precision(cast(0.9 as decimal(11,6))) * promote_precision(cast(scalar-subquery#24503 [] as decimal(11,6)))), DecimalType(13,7)) as decimal(13,7)))
               :  :  :                                :  +- Aggregate [ss_store_sk#137], [avg(ss_net_profit#152) AS rank_col#24502]
               :  :  :                                :     +- Filter ((ss_store_sk#137 = 4) && isnull(ss_addr_sk#136))
               :  :  :                                :        +- SubqueryAlias `store_sales`
               :  :  :                                :           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :                                +- Aggregate [ss_item_sk#132], [ss_item_sk#132 AS item_sk#24500, avg(ss_net_profit#152) AS rank_col#24501, avg(ss_net_profit#152) AS avg(ss_net_profit#152)#24522]
               :  :  :                                   +- Filter (ss_store_sk#137 = 4)
               :  :  :                                      +- SubqueryAlias `ss1`
               :  :  :                                         +- SubqueryAlias `store_sales`
               :  :  :                                            +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  +- SubqueryAlias `descending`
               :  :     +- Project [item_sk#24505, rnk#24509]
               :  :        +- Filter (rnk#24509 < 11)
               :  :           +- SubqueryAlias `V21`
               :  :              +- Project [item_sk#24505, rnk#24509]
               :  :                 +- Project [item_sk#24505, rank_col#24506, rnk#24509, rnk#24509]
               :  :                    +- Window [rank(rank_col#24506) windowspecdefinition(rank_col#24506 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rnk#24509], [rank_col#24506 DESC NULLS LAST]
               :  :                       +- Project [item_sk#24505, rank_col#24506]
               :  :                          +- SubqueryAlias `V2`
               :  :                             +- Project [item_sk#24505, rank_col#24506]
               :  :                                +- Filter (cast(avg(ss_net_profit#152)#24525 as decimal(13,7)) > cast(CheckOverflow((promote_precision(cast(0.9 as decimal(11,6))) * promote_precision(cast(scalar-subquery#24508 [] as decimal(11,6)))), DecimalType(13,7)) as decimal(13,7)))
               :  :                                   :  +- Aggregate [ss_store_sk#137], [avg(ss_net_profit#152) AS rank_col#24507]
               :  :                                   :     +- Filter ((ss_store_sk#137 = 4) && isnull(ss_addr_sk#136))
               :  :                                   :        +- SubqueryAlias `store_sales`
               :  :                                   :           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :                                   +- Aggregate [ss_item_sk#132], [ss_item_sk#132 AS item_sk#24505, avg(ss_net_profit#152) AS rank_col#24506, avg(ss_net_profit#152) AS avg(ss_net_profit#152)#24525]
               :  :                                      +- Filter (ss_store_sk#137 = 4)
               :  :                                         +- SubqueryAlias `ss1`
               :  :                                            +- SubqueryAlias `store_sales`
               :  :                                               +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  +- SubqueryAlias `i1`
               :     +- SubqueryAlias `item`
               :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- SubqueryAlias `i2`
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#24534,i_item_id#24535,i_rec_start_date#24536,i_rec_end_date#24537,i_item_desc#24538,i_current_price#24539,i_wholesale_cost#24540,i_brand_id#24541,i_brand#24542,i_class_id#24543,i_class#24544,i_category_id#24545,i_category#24546,i_manufact_id#24547,i_manufact#24548,i_size#24549,i_formulation#24550,i_color#24551,i_units#24552,i_container#24553,i_manager_id#24554,i_product_name#24555] parquet

     : benchmark
19/09/08 19:46:51 INFO Query:
== Query: q44-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [rnk#24579 ASC NULLS FIRST], true
      +- Project [rnk#24579, i_product_name#585 AS best_performing#24585, i_product_name#24630 AS worst_performing#24586]
         +- Filter (((rnk#24579 = rnk#24584) && (i_item_sk#564 = item_sk#24575)) && (i_item_sk#24609 = item_sk#24580))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `asceding`
               :  :  :  +- Project [item_sk#24575, rnk#24579]
               :  :  :     +- Filter (rnk#24579 < 11)
               :  :  :        +- SubqueryAlias `V11`
               :  :  :           +- Project [item_sk#24575, rnk#24579]
               :  :  :              +- Project [item_sk#24575, rank_col#24576, rnk#24579, rnk#24579]
               :  :  :                 +- Window [rank(rank_col#24576) windowspecdefinition(rank_col#24576 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rnk#24579], [rank_col#24576 ASC NULLS FIRST]
               :  :  :                    +- Project [item_sk#24575, rank_col#24576]
               :  :  :                       +- SubqueryAlias `V1`
               :  :  :                          +- Project [item_sk#24575, rank_col#24576]
               :  :  :                             +- Filter (cast(avg(ss_net_profit#152)#24597 as decimal(13,7)) > cast(CheckOverflow((promote_precision(cast(0.9 as decimal(11,6))) * promote_precision(cast(scalar-subquery#24578 [] as decimal(11,6)))), DecimalType(13,7)) as decimal(13,7)))
               :  :  :                                :  +- Aggregate [ss_store_sk#137], [avg(ss_net_profit#152) AS rank_col#24577]
               :  :  :                                :     +- Filter ((ss_store_sk#137 = 4) && isnull(ss_addr_sk#136))
               :  :  :                                :        +- SubqueryAlias `store_sales`
               :  :  :                                :           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :                                +- Aggregate [ss_item_sk#132], [ss_item_sk#132 AS item_sk#24575, avg(ss_net_profit#152) AS rank_col#24576, avg(ss_net_profit#152) AS avg(ss_net_profit#152)#24597]
               :  :  :                                   +- Filter (ss_store_sk#137 = 4)
               :  :  :                                      +- SubqueryAlias `ss1`
               :  :  :                                         +- SubqueryAlias `store_sales`
               :  :  :                                            +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  +- SubqueryAlias `descending`
               :  :     +- Project [item_sk#24580, rnk#24584]
               :  :        +- Filter (rnk#24584 < 11)
               :  :           +- SubqueryAlias `V21`
               :  :              +- Project [item_sk#24580, rnk#24584]
               :  :                 +- Project [item_sk#24580, rank_col#24581, rnk#24584, rnk#24584]
               :  :                    +- Window [rank(rank_col#24581) windowspecdefinition(rank_col#24581 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rnk#24584], [rank_col#24581 DESC NULLS LAST]
               :  :                       +- Project [item_sk#24580, rank_col#24581]
               :  :                          +- SubqueryAlias `V2`
               :  :                             +- Project [item_sk#24580, rank_col#24581]
               :  :                                +- Filter (cast(avg(ss_net_profit#152)#24600 as decimal(13,7)) > cast(CheckOverflow((promote_precision(cast(0.9 as decimal(11,6))) * promote_precision(cast(scalar-subquery#24583 [] as decimal(11,6)))), DecimalType(13,7)) as decimal(13,7)))
               :  :                                   :  +- Aggregate [ss_store_sk#137], [avg(ss_net_profit#152) AS rank_col#24582]
               :  :                                   :     +- Filter ((ss_store_sk#137 = 4) && isnull(ss_addr_sk#136))
               :  :                                   :        +- SubqueryAlias `store_sales`
               :  :                                   :           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :                                   +- Aggregate [ss_item_sk#132], [ss_item_sk#132 AS item_sk#24580, avg(ss_net_profit#152) AS rank_col#24581, avg(ss_net_profit#152) AS avg(ss_net_profit#152)#24600]
               :  :                                      +- Filter (ss_store_sk#137 = 4)
               :  :                                         +- SubqueryAlias `ss1`
               :  :                                            +- SubqueryAlias `store_sales`
               :  :                                               +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  +- SubqueryAlias `i1`
               :     +- SubqueryAlias `item`
               :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- SubqueryAlias `i2`
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#24609,i_item_id#24610,i_rec_start_date#24611,i_rec_end_date#24612,i_item_desc#24613,i_current_price#24614,i_wholesale_cost#24615,i_brand_id#24616,i_brand#24617,i_class_id#24618,i_class#24619,i_category_id#24620,i_category#24621,i_manufact_id#24622,i_manufact#24623,i_size#24624,i_formulation#24625,i_color#24626,i_units#24627,i_container#24628,i_manager_id#24629,i_product_name#24630] parquet

      running Thread[benchmark runner,5,main]
19/09/08 19:46:52 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 19:46:52 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
Execution time: 21.9705783s
Running execution q45-v2.4 iteration: 1, StandardRun=true
19/09/08 19:47:15 INFO Query:
== Query: q45-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ca_zip#457, ca_city#454, sum(ws_sales_price)#24847]
      +- Sort [ca_zip#457 ASC NULLS FIRST, ca_city#454 ASC NULLS FIRST], true
         +- Aggregate [ca_zip#457, ca_city#454], [ca_zip#457, ca_city#454, sum(ws_sales_price#237) AS sum(ws_sales_price)#24847]
            +- Filter ((((ws_bill_customer_sk#220 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && ((ws_item_sk#219 = i_item_sk#564) && (substring(ca_zip#457, 1, 5) IN (85669,86197,88274,83405,86475,85392,85460,80348,81792) || i_item_id#565 IN (list#24845 [])))) && (((ws_sold_date_sk#216 = d_date_sk#492) && (d_qoy#502 = 2)) && (d_year#498 = 2001)))
               :  +- Project [i_item_id#565]
               :     +- Filter i_item_sk#564 IN (2,3,5,7,11,13,17,19,23,29)
               :        +- SubqueryAlias `item`
               :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `web_sales`
                  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `customer`
                  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  :  +- SubqueryAlias `customer_address`
                  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  :  +- SubqueryAlias `date_dim`
                  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 19:47:15 INFO Query:
== Query: q45-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ca_zip#457, ca_city#454, sum(ws_sales_price)#24855]
      +- Sort [ca_zip#457 ASC NULLS FIRST, ca_city#454 ASC NULLS FIRST], true
         +- Aggregate [ca_zip#457, ca_city#454], [ca_zip#457, ca_city#454, sum(ws_sales_price#237) AS sum(ws_sales_price)#24855]
            +- Filter ((((ws_bill_customer_sk#220 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && ((ws_item_sk#219 = i_item_sk#564) && (substring(ca_zip#457, 1, 5) IN (85669,86197,88274,83405,86475,85392,85460,80348,81792) || i_item_id#565 IN (list#24853 [])))) && (((ws_sold_date_sk#216 = d_date_sk#492) && (d_qoy#502 = 2)) && (d_year#498 = 2001)))
               :  +- Project [i_item_id#565]
               :     +- Filter i_item_sk#564 IN (2,3,5,7,11,13,17,19,23,29)
               :        +- SubqueryAlias `item`
               :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `web_sales`
                  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `customer`
                  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  :  +- SubqueryAlias `customer_address`
                  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  :  +- SubqueryAlias `date_dim`
                  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 23.333574693s
Running execution q46-v2.4 iteration: 1, StandardRun=true
19/09/08 19:47:39 INFO Query:
== Query: q46-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, ca_city#454 ASC NULLS FIRST, bought_city#24898 ASC NULLS FIRST, ss_ticket_number#139L ASC NULLS FIRST], true
      +- Project [c_last_name#421, c_first_name#420, ca_city#454, bought_city#24898, ss_ticket_number#139L, amt#24899, profit#24900]
         +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && NOT (ca_city#454 = bought_city#24898))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dn`
               :  :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133, ss_addr_sk#136, ca_city#454], [ss_ticket_number#139L, ss_customer_sk#133, ca_city#454 AS bought_city#24898, sum(ss_coupon_amt#149) AS amt#24899, sum(ss_net_profit#152) AS profit#24900]
               :  :     +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_hdemo_sk#135 = hd_demo_sk#548) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((hd_dep_count#551 = 4) || (hd_vehicle_count#552 = 3)) && d_dow#499 IN (6,0)) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_city#686 IN (Fairview,Midway,Fairview,Fairview,Fairview))))
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- Join Inner
               :  :           :  :  :- Join Inner
               :  :           :  :  :  :- SubqueryAlias `store_sales`
               :  :           :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  :  :  +- SubqueryAlias `date_dim`
               :  :           :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           :  :  +- SubqueryAlias `store`
               :  :           :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :  :           :  +- SubqueryAlias `household_demographics`
               :  :           :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  :           +- SubqueryAlias `customer_address`
               :  :              +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer`
               :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               +- SubqueryAlias `current_addr`
                  +- SubqueryAlias `customer_address`
                     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

     : benchmark
19/09/08 19:47:39 INFO Query:
== Query: q46-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, ca_city#454 ASC NULLS FIRST, bought_city#24910 ASC NULLS FIRST, ss_ticket_number#139L ASC NULLS FIRST], true
      +- Project [c_last_name#421, c_first_name#420, ca_city#454, bought_city#24910, ss_ticket_number#139L, amt#24911, profit#24912]
         +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && NOT (ca_city#454 = bought_city#24910))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dn`
               :  :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133, ss_addr_sk#136, ca_city#454], [ss_ticket_number#139L, ss_customer_sk#133, ca_city#454 AS bought_city#24910, sum(ss_coupon_amt#149) AS amt#24911, sum(ss_net_profit#152) AS profit#24912]
               :  :     +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_hdemo_sk#135 = hd_demo_sk#548) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((hd_dep_count#551 = 4) || (hd_vehicle_count#552 = 3)) && d_dow#499 IN (6,0)) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_city#686 IN (Fairview,Midway,Fairview,Fairview,Fairview))))
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- Join Inner
               :  :           :  :  :- Join Inner
               :  :           :  :  :  :- SubqueryAlias `store_sales`
               :  :           :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  :  :  +- SubqueryAlias `date_dim`
               :  :           :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           :  :  +- SubqueryAlias `store`
               :  :           :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :  :           :  +- SubqueryAlias `household_demographics`
               :  :           :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  :           +- SubqueryAlias `customer_address`
               :  :              +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer`
               :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               +- SubqueryAlias `current_addr`
                  +- SubqueryAlias `customer_address`
                     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

      running Thread[benchmark runner,5,main]
Execution time: 17.924774891000002s
Running execution q47-v2.4 iteration: 1, StandardRun=true
19/09/08 19:48:00 INFO Query:
== Query: q47-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#26045 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#26046 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
      +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, avg_monthly_sales#26046, sum_sales#26045, psum#26048, nsum#26049]
         +- Filter (((d_year#498 = 1999) && (cast(avg_monthly_sales#26046 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6)))) && (cast(CASE WHEN (cast(avg_monthly_sales#26046 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#26045 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#26046 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#26046 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16))))
            +- SubqueryAlias `v2`
               +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, avg_monthly_sales#26046, sum_sales#26045, sum_sales#26253 AS psum#26048, sum_sales#26728 AS nsum#26049]
                  +- Filter (((((i_category#576 = i_category#26358) && (i_category#576 = i_category#26833)) && (i_brand#572 = i_brand#26354)) && ((i_brand#572 = i_brand#26829) && (s_store_name#669 = s_store_name#26515))) && ((((s_store_name#669 = s_store_name#26990) && (s_company_name#681 = s_company_name#26527)) && (s_company_name#681 = s_company_name#27002)) && ((rn#26047 = (rn#26159 + 1)) && (rn#26047 = (rn#26634 - 1)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `v1`
                        :  :  +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, sum_sales#26045, avg_monthly_sales#26046, rn#26047]
                        :  :     +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, sum_sales#26045, _w0#26059, rn#26047, avg_monthly_sales#26046, avg_monthly_sales#26046, rn#26047]
                        :  :        +- Window [avg(_w0#26059) windowspecdefinition(i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#26046], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498]
                        :  :           +- Window [rank(d_year#498, d_moy#500) windowspecdefinition(i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#26047], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681], [d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST]
                        :  :              +- Aggregate [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, sum(ss_sales_price#143) AS sum_sales#26045, sum(ss_sales_price#143) AS _w0#26059]
                        :  :                 +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((ss_store_sk#137 = s_store_sk#664) && (((d_year#498 = 1999) || ((d_year#498 = (1999 - 1)) && (d_moy#500 = 12))) || ((d_year#498 = (1999 + 1)) && (d_moy#500 = 1)))))
                        :  :                    +- Join Inner
                        :  :                       :- Join Inner
                        :  :                       :  :- Join Inner
                        :  :                       :  :  :- SubqueryAlias `item`
                        :  :                       :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        :  :                       :  :  +- SubqueryAlias `store_sales`
                        :  :                       :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :                       :  +- SubqueryAlias `date_dim`
                        :  :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :                       +- SubqueryAlias `store`
                        :  :                          +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  +- SubqueryAlias `v1_lag`
                        :     +- SubqueryAlias `v1`
                        :        +- Project [i_category#26358, i_brand#26354, s_store_name#26515, s_company_name#26527, d_year#26443, d_moy#26445, sum_sales#26253, avg_monthly_sales#26064, rn#26159]
                        :           +- Project [i_category#26358, i_brand#26354, s_store_name#26515, s_company_name#26527, d_year#26443, d_moy#26445, sum_sales#26253, _w0#26254, rn#26159, avg_monthly_sales#26064, avg_monthly_sales#26064, rn#26159]
                        :              +- Window [avg(_w0#26254) windowspecdefinition(i_category#26358, i_brand#26354, s_store_name#26515, s_company_name#26527, d_year#26443, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#26064], [i_category#26358, i_brand#26354, s_store_name#26515, s_company_name#26527, d_year#26443]
                        :                 +- Window [rank(d_year#26443, d_moy#26445) windowspecdefinition(i_category#26358, i_brand#26354, s_store_name#26515, s_company_name#26527, d_year#26443 ASC NULLS FIRST, d_moy#26445 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#26159], [i_category#26358, i_brand#26354, s_store_name#26515, s_company_name#26527], [d_year#26443 ASC NULLS FIRST, d_moy#26445 ASC NULLS FIRST]
                        :                    +- Aggregate [i_category#26358, i_brand#26354, s_store_name#26515, s_company_name#26527, d_year#26443, d_moy#26445], [i_category#26358, i_brand#26354, s_store_name#26515, s_company_name#26527, d_year#26443, d_moy#26445, sum(ss_sales_price#143) AS sum_sales#26253, sum(ss_sales_price#143) AS _w0#26254]
                        :                       +- Filter (((ss_item_sk#132 = i_item_sk#26346) && (ss_sold_date_sk#130 = d_date_sk#26437)) && ((ss_store_sk#137 = s_store_sk#26510) && (((d_year#26443 = 1999) || ((d_year#26443 = (1999 - 1)) && (d_moy#26445 = 12))) || ((d_year#26443 = (1999 + 1)) && (d_moy#26445 = 1)))))
                        :                          +- Join Inner
                        :                             :- Join Inner
                        :                             :  :- Join Inner
                        :                             :  :  :- SubqueryAlias `item`
                        :                             :  :  :  +- Relation[i_item_sk#26346,i_item_id#26347,i_rec_start_date#26348,i_rec_end_date#26349,i_item_desc#26350,i_current_price#26351,i_wholesale_cost#26352,i_brand_id#26353,i_brand#26354,i_class_id#26355,i_class#26356,i_category_id#26357,i_category#26358,i_manufact_id#26359,i_manufact#26360,i_size#26361,i_formulation#26362,i_color#26363,i_units#26364,i_container#26365,i_manager_id#26366,i_product_name#26367] parquet
                        :                             :  :  +- SubqueryAlias `store_sales`
                        :                             :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :                             :  +- SubqueryAlias `date_dim`
                        :                             :     +- Relation[d_date_sk#26437,d_date_id#26438,d_date#26439,d_month_seq#26440,d_week_seq#26441,d_quarter_seq#26442,d_year#26443,d_dow#26444,d_moy#26445,d_dom#26446,d_qoy#26447,d_fy_year#26448,d_fy_quarter_seq#26449,d_fy_week_seq#26450,d_day_name#26451,d_quarter_name#26452,d_holiday#26453,d_weekend#26454,d_following_holiday#26455,d_first_dom#26456,d_last_dom#26457,d_same_day_ly#26458,d_same_day_lq#26459,d_current_day#26460,... 4 more fields] parquet
                        :                             +- SubqueryAlias `store`
                        :                                +- Relation[s_store_sk#26510,s_store_id#26511,s_rec_start_date#26512,s_rec_end_date#26513,s_closed_date_sk#26514,s_store_name#26515,s_number_employees#26516,s_floor_space#26517,s_hours#26518,s_manager#26519,s_market_id#26520,s_geography_class#26521,s_market_desc#26522,s_market_manager#26523,s_division_id#26524,s_division_name#26525,s_company_id#26526,s_company_name#26527,s_street_number#26528,s_street_name#26529,s_street_type#26530,s_suite_number#26531,s_city#26532,s_county#26533,... 5 more fields] parquet
                        +- SubqueryAlias `v1_lead`
                           +- SubqueryAlias `v1`
                              +- Project [i_category#26833, i_brand#26829, s_store_name#26990, s_company_name#27002, d_year#26918, d_moy#26920, sum_sales#26728, avg_monthly_sales#26539, rn#26634]
                                 +- Project [i_category#26833, i_brand#26829, s_store_name#26990, s_company_name#27002, d_year#26918, d_moy#26920, sum_sales#26728, _w0#26729, rn#26634, avg_monthly_sales#26539, avg_monthly_sales#26539, rn#26634]
                                    +- Window [avg(_w0#26729) windowspecdefinition(i_category#26833, i_brand#26829, s_store_name#26990, s_company_name#27002, d_year#26918, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#26539], [i_category#26833, i_brand#26829, s_store_name#26990, s_company_name#27002, d_year#26918]
                                       +- Window [rank(d_year#26918, d_moy#26920) windowspecdefinition(i_category#26833, i_brand#26829, s_store_name#26990, s_company_name#27002, d_year#26918 ASC NULLS FIRST, d_moy#26920 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#26634], [i_category#26833, i_brand#26829, s_store_name#26990, s_company_name#27002], [d_year#26918 ASC NULLS FIRST, d_moy#26920 ASC NULLS FIRST]
                                          +- Aggregate [i_category#26833, i_brand#26829, s_store_name#26990, s_company_name#27002, d_year#26918, d_moy#26920], [i_category#26833, i_brand#26829, s_store_name#26990, s_company_name#27002, d_year#26918, d_moy#26920, sum(ss_sales_price#143) AS sum_sales#26728, sum(ss_sales_price#143) AS _w0#26729]
                                             +- Filter (((ss_item_sk#132 = i_item_sk#26821) && (ss_sold_date_sk#130 = d_date_sk#26912)) && ((ss_store_sk#137 = s_store_sk#26985) && (((d_year#26918 = 1999) || ((d_year#26918 = (1999 - 1)) && (d_moy#26920 = 12))) || ((d_year#26918 = (1999 + 1)) && (d_moy#26920 = 1)))))
                                                +- Join Inner
                                                   :- Join Inner
                                                   :  :- Join Inner
                                                   :  :  :- SubqueryAlias `item`
                                                   :  :  :  +- Relation[i_item_sk#26821,i_item_id#26822,i_rec_start_date#26823,i_rec_end_date#26824,i_item_desc#26825,i_current_price#26826,i_wholesale_cost#26827,i_brand_id#26828,i_brand#26829,i_class_id#26830,i_class#26831,i_category_id#26832,i_category#26833,i_manufact_id#26834,i_manufact#26835,i_size#26836,i_formulation#26837,i_color#26838,i_units#26839,i_container#26840,i_manager_id#26841,i_product_name#26842] parquet
                                                   :  :  +- SubqueryAlias `store_sales`
                                                   :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                                   :  +- SubqueryAlias `date_dim`
                                                   :     +- Relation[d_date_sk#26912,d_date_id#26913,d_date#26914,d_month_seq#26915,d_week_seq#26916,d_quarter_seq#26917,d_year#26918,d_dow#26919,d_moy#26920,d_dom#26921,d_qoy#26922,d_fy_year#26923,d_fy_quarter_seq#26924,d_fy_week_seq#26925,d_day_name#26926,d_quarter_name#26927,d_holiday#26928,d_weekend#26929,d_following_holiday#26930,d_first_dom#26931,d_last_dom#26932,d_same_day_ly#26933,d_same_day_lq#26934,d_current_day#26935,... 4 more fields] parquet
                                                   +- SubqueryAlias `store`
                                                      +- Relation[s_store_sk#26985,s_store_id#26986,s_rec_start_date#26987,s_rec_end_date#26988,s_closed_date_sk#26989,s_store_name#26990,s_number_employees#26991,s_floor_space#26992,s_hours#26993,s_manager#26994,s_market_id#26995,s_geography_class#26996,s_market_desc#26997,s_market_manager#26998,s_division_id#26999,s_division_name#27000,s_company_id#27001,s_company_name#27002,s_street_number#27003,s_street_name#27004,s_street_type#27005,s_suite_number#27006,s_city#27007,s_county#27008,... 5 more fields] parquet

     : benchmark
19/09/08 19:48:00 INFO Query:
== Query: q47-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#27120 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#27121 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
      +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, avg_monthly_sales#27121, sum_sales#27120, psum#27123, nsum#27124]
         +- Filter (((d_year#498 = 1999) && (cast(avg_monthly_sales#27121 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6)))) && (cast(CASE WHEN (cast(avg_monthly_sales#27121 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#27120 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#27121 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#27121 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16))))
            +- SubqueryAlias `v2`
               +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, avg_monthly_sales#27121, sum_sales#27120, sum_sales#27328 AS psum#27123, sum_sales#27803 AS nsum#27124]
                  +- Filter (((((i_category#576 = i_category#27433) && (i_category#576 = i_category#27908)) && (i_brand#572 = i_brand#27429)) && ((i_brand#572 = i_brand#27904) && (s_store_name#669 = s_store_name#27590))) && ((((s_store_name#669 = s_store_name#28065) && (s_company_name#681 = s_company_name#27602)) && (s_company_name#681 = s_company_name#28077)) && ((rn#27122 = (rn#27234 + 1)) && (rn#27122 = (rn#27709 - 1)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `v1`
                        :  :  +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, sum_sales#27120, avg_monthly_sales#27121, rn#27122]
                        :  :     +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, sum_sales#27120, _w0#27134, rn#27122, avg_monthly_sales#27121, avg_monthly_sales#27121, rn#27122]
                        :  :        +- Window [avg(_w0#27134) windowspecdefinition(i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#27121], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498]
                        :  :           +- Window [rank(d_year#498, d_moy#500) windowspecdefinition(i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#27122], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681], [d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST]
                        :  :              +- Aggregate [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, sum(ss_sales_price#143) AS sum_sales#27120, sum(ss_sales_price#143) AS _w0#27134]
                        :  :                 +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((ss_store_sk#137 = s_store_sk#664) && (((d_year#498 = 1999) || ((d_year#498 = (1999 - 1)) && (d_moy#500 = 12))) || ((d_year#498 = (1999 + 1)) && (d_moy#500 = 1)))))
                        :  :                    +- Join Inner
                        :  :                       :- Join Inner
                        :  :                       :  :- Join Inner
                        :  :                       :  :  :- SubqueryAlias `item`
                        :  :                       :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        :  :                       :  :  +- SubqueryAlias `store_sales`
                        :  :                       :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :                       :  +- SubqueryAlias `date_dim`
                        :  :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :                       +- SubqueryAlias `store`
                        :  :                          +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  +- SubqueryAlias `v1_lag`
                        :     +- SubqueryAlias `v1`
                        :        +- Project [i_category#27433, i_brand#27429, s_store_name#27590, s_company_name#27602, d_year#27518, d_moy#27520, sum_sales#27328, avg_monthly_sales#27139, rn#27234]
                        :           +- Project [i_category#27433, i_brand#27429, s_store_name#27590, s_company_name#27602, d_year#27518, d_moy#27520, sum_sales#27328, _w0#27329, rn#27234, avg_monthly_sales#27139, avg_monthly_sales#27139, rn#27234]
                        :              +- Window [avg(_w0#27329) windowspecdefinition(i_category#27433, i_brand#27429, s_store_name#27590, s_company_name#27602, d_year#27518, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#27139], [i_category#27433, i_brand#27429, s_store_name#27590, s_company_name#27602, d_year#27518]
                        :                 +- Window [rank(d_year#27518, d_moy#27520) windowspecdefinition(i_category#27433, i_brand#27429, s_store_name#27590, s_company_name#27602, d_year#27518 ASC NULLS FIRST, d_moy#27520 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#27234], [i_category#27433, i_brand#27429, s_store_name#27590, s_company_name#27602], [d_year#27518 ASC NULLS FIRST, d_moy#27520 ASC NULLS FIRST]
                        :                    +- Aggregate [i_category#27433, i_brand#27429, s_store_name#27590, s_company_name#27602, d_year#27518, d_moy#27520], [i_category#27433, i_brand#27429, s_store_name#27590, s_company_name#27602, d_year#27518, d_moy#27520, sum(ss_sales_price#143) AS sum_sales#27328, sum(ss_sales_price#143) AS _w0#27329]
                        :                       +- Filter (((ss_item_sk#132 = i_item_sk#27421) && (ss_sold_date_sk#130 = d_date_sk#27512)) && ((ss_store_sk#137 = s_store_sk#27585) && (((d_year#27518 = 1999) || ((d_year#27518 = (1999 - 1)) && (d_moy#27520 = 12))) || ((d_year#27518 = (1999 + 1)) && (d_moy#27520 = 1)))))
                        :                          +- Join Inner
                        :                             :- Join Inner
                        :                             :  :- Join Inner
                        :                             :  :  :- SubqueryAlias `item`
                        :                             :  :  :  +- Relation[i_item_sk#27421,i_item_id#27422,i_rec_start_date#27423,i_rec_end_date#27424,i_item_desc#27425,i_current_price#27426,i_wholesale_cost#27427,i_brand_id#27428,i_brand#27429,i_class_id#27430,i_class#27431,i_category_id#27432,i_category#27433,i_manufact_id#27434,i_manufact#27435,i_size#27436,i_formulation#27437,i_color#27438,i_units#27439,i_container#27440,i_manager_id#27441,i_product_name#27442] parquet
                        :                             :  :  +- SubqueryAlias `store_sales`
                        :                             :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :                             :  +- SubqueryAlias `date_dim`
                        :                             :     +- Relation[d_date_sk#27512,d_date_id#27513,d_date#27514,d_month_seq#27515,d_week_seq#27516,d_quarter_seq#27517,d_year#27518,d_dow#27519,d_moy#27520,d_dom#27521,d_qoy#27522,d_fy_year#27523,d_fy_quarter_seq#27524,d_fy_week_seq#27525,d_day_name#27526,d_quarter_name#27527,d_holiday#27528,d_weekend#27529,d_following_holiday#27530,d_first_dom#27531,d_last_dom#27532,d_same_day_ly#27533,d_same_day_lq#27534,d_current_day#27535,... 4 more fields] parquet
                        :                             +- SubqueryAlias `store`
                        :                                +- Relation[s_store_sk#27585,s_store_id#27586,s_rec_start_date#27587,s_rec_end_date#27588,s_closed_date_sk#27589,s_store_name#27590,s_number_employees#27591,s_floor_space#27592,s_hours#27593,s_manager#27594,s_market_id#27595,s_geography_class#27596,s_market_desc#27597,s_market_manager#27598,s_division_id#27599,s_division_name#27600,s_company_id#27601,s_company_name#27602,s_street_number#27603,s_street_name#27604,s_street_type#27605,s_suite_number#27606,s_city#27607,s_county#27608,... 5 more fields] parquet
                        +- SubqueryAlias `v1_lead`
                           +- SubqueryAlias `v1`
                              +- Project [i_category#27908, i_brand#27904, s_store_name#28065, s_company_name#28077, d_year#27993, d_moy#27995, sum_sales#27803, avg_monthly_sales#27614, rn#27709]
                                 +- Project [i_category#27908, i_brand#27904, s_store_name#28065, s_company_name#28077, d_year#27993, d_moy#27995, sum_sales#27803, _w0#27804, rn#27709, avg_monthly_sales#27614, avg_monthly_sales#27614, rn#27709]
                                    +- Window [avg(_w0#27804) windowspecdefinition(i_category#27908, i_brand#27904, s_store_name#28065, s_company_name#28077, d_year#27993, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#27614], [i_category#27908, i_brand#27904, s_store_name#28065, s_company_name#28077, d_year#27993]
                                       +- Window [rank(d_year#27993, d_moy#27995) windowspecdefinition(i_category#27908, i_brand#27904, s_store_name#28065, s_company_name#28077, d_year#27993 ASC NULLS FIRST, d_moy#27995 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#27709], [i_category#27908, i_brand#27904, s_store_name#28065, s_company_name#28077], [d_year#27993 ASC NULLS FIRST, d_moy#27995 ASC NULLS FIRST]
                                          +- Aggregate [i_category#27908, i_brand#27904, s_store_name#28065, s_company_name#28077, d_year#27993, d_moy#27995], [i_category#27908, i_brand#27904, s_store_name#28065, s_company_name#28077, d_year#27993, d_moy#27995, sum(ss_sales_price#143) AS sum_sales#27803, sum(ss_sales_price#143) AS _w0#27804]
                                             +- Filter (((ss_item_sk#132 = i_item_sk#27896) && (ss_sold_date_sk#130 = d_date_sk#27987)) && ((ss_store_sk#137 = s_store_sk#28060) && (((d_year#27993 = 1999) || ((d_year#27993 = (1999 - 1)) && (d_moy#27995 = 12))) || ((d_year#27993 = (1999 + 1)) && (d_moy#27995 = 1)))))
                                                +- Join Inner
                                                   :- Join Inner
                                                   :  :- Join Inner
                                                   :  :  :- SubqueryAlias `item`
                                                   :  :  :  +- Relation[i_item_sk#27896,i_item_id#27897,i_rec_start_date#27898,i_rec_end_date#27899,i_item_desc#27900,i_current_price#27901,i_wholesale_cost#27902,i_brand_id#27903,i_brand#27904,i_class_id#27905,i_class#27906,i_category_id#27907,i_category#27908,i_manufact_id#27909,i_manufact#27910,i_size#27911,i_formulation#27912,i_color#27913,i_units#27914,i_container#27915,i_manager_id#27916,i_product_name#27917] parquet
                                                   :  :  +- SubqueryAlias `store_sales`
                                                   :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                                   :  +- SubqueryAlias `date_dim`
                                                   :     +- Relation[d_date_sk#27987,d_date_id#27988,d_date#27989,d_month_seq#27990,d_week_seq#27991,d_quarter_seq#27992,d_year#27993,d_dow#27994,d_moy#27995,d_dom#27996,d_qoy#27997,d_fy_year#27998,d_fy_quarter_seq#27999,d_fy_week_seq#28000,d_day_name#28001,d_quarter_name#28002,d_holiday#28003,d_weekend#28004,d_following_holiday#28005,d_first_dom#28006,d_last_dom#28007,d_same_day_ly#28008,d_same_day_lq#28009,d_current_day#28010,... 4 more fields] parquet
                                                   +- SubqueryAlias `store`
                                                      +- Relation[s_store_sk#28060,s_store_id#28061,s_rec_start_date#28062,s_rec_end_date#28063,s_closed_date_sk#28064,s_store_name#28065,s_number_employees#28066,s_floor_space#28067,s_hours#28068,s_manager#28069,s_market_id#28070,s_geography_class#28071,s_market_desc#28072,s_market_manager#28073,s_division_id#28074,s_division_name#28075,s_company_id#28076,s_company_name#28077,s_street_number#28078,s_street_name#28079,s_street_type#28080,s_suite_number#28081,s_city#28082,s_county#28083,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 27.913619764s
Running execution q48-v2.4 iteration: 1, StandardRun=true
19/09/08 19:48:30 INFO Query:
== Query: q48-v2.4 ==
Aggregate [sum(cast(ss_quantity#140 as bigint)) AS sum(ss_quantity)#30371L]
+- Filter ((((s_store_sk#664 = ss_store_sk#137) && (ss_sold_date_sk#130 = d_date_sk#492)) && (d_year#498 = 2000)) && ((((((cd_demo_sk#474 = ss_cdemo_sk#134) && (cd_marital_status#476 = M)) && ((cd_education_status#477 = 4 yr Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(100.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(150.00 as decimal(7,2)))))) || (((cd_demo_sk#474 = ss_cdemo_sk#134) && (cd_marital_status#476 = D)) && ((cd_education_status#477 = 2 yr Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(50.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(100.00 as decimal(7,2))))))) || (((cd_demo_sk#474 = ss_cdemo_sk#134) && (cd_marital_status#476 = S)) && ((cd_education_status#477 = College) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(150.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(200.00 as decimal(7,2))))))) && (((((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (CO,OH,TX) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(2000 as decimal(4,0)) as decimal(7,2)))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (OR,MN,KY) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(150 as decimal(3,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(3000 as decimal(4,0)) as decimal(7,2))))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (VA,CA,MS) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(25000 as decimal(5,0)) as decimal(7,2)))))))))
   +- Join Inner
      :- Join Inner
      :  :- Join Inner
      :  :  :- Join Inner
      :  :  :  :- SubqueryAlias `store_sales`
      :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
      :  :  :  +- SubqueryAlias `store`
      :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
      :  :  +- SubqueryAlias `customer_demographics`
      :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
      :  +- SubqueryAlias `customer_address`
      :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
      +- SubqueryAlias `date_dim`
         +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 19:48:30 INFO Query:
== Query: q48-v2.4 ==
Aggregate [sum(cast(ss_quantity#140 as bigint)) AS sum(ss_quantity)#30374L]
+- Filter ((((s_store_sk#664 = ss_store_sk#137) && (ss_sold_date_sk#130 = d_date_sk#492)) && (d_year#498 = 2000)) && ((((((cd_demo_sk#474 = ss_cdemo_sk#134) && (cd_marital_status#476 = M)) && ((cd_education_status#477 = 4 yr Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(100.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(150.00 as decimal(7,2)))))) || (((cd_demo_sk#474 = ss_cdemo_sk#134) && (cd_marital_status#476 = D)) && ((cd_education_status#477 = 2 yr Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(50.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(100.00 as decimal(7,2))))))) || (((cd_demo_sk#474 = ss_cdemo_sk#134) && (cd_marital_status#476 = S)) && ((cd_education_status#477 = College) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(150.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(200.00 as decimal(7,2))))))) && (((((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (CO,OH,TX) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(2000 as decimal(4,0)) as decimal(7,2)))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (OR,MN,KY) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(150 as decimal(3,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(3000 as decimal(4,0)) as decimal(7,2))))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (VA,CA,MS) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(25000 as decimal(5,0)) as decimal(7,2)))))))))
   +- Join Inner
      :- Join Inner
      :  :- Join Inner
      :  :  :- Join Inner
      :  :  :  :- SubqueryAlias `store_sales`
      :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
      :  :  :  +- SubqueryAlias `store`
      :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
      :  :  +- SubqueryAlias `customer_demographics`
      :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
      :  +- SubqueryAlias `customer_address`
      :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
      +- SubqueryAlias `date_dim`
         +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 21.302550845000003s
Running execution q49-v2.4 iteration: 1, StandardRun=true
19/09/08 19:48:53 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 19:48:53 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 19:48:53 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 19:48:53 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 19:48:53 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 19:48:53 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 19:48:54 INFO Query:
== Query: q49-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#30539 ASC NULLS FIRST, return_rank#30537 ASC NULLS FIRST, currency_rank#30538 ASC NULLS FIRST], true
      +- Distinct
         +- Union
            :- Distinct
            :  +- Union
            :     :- Project [web AS channel#30539, item#30534, return_ratio#30535, return_rank#30537, currency_rank#30538]
            :     :  +- Filter ((return_rank#30537 <= 10) || (currency_rank#30538 <= 10))
            :     :     +- SubqueryAlias `web`
            :     :        +- Project [item#30534, return_ratio#30535, currency_ratio#30536, return_rank#30537, currency_rank#30538]
            :     :           +- Project [item#30534, return_ratio#30535, currency_ratio#30536, currency_rank#30538, return_rank#30537, return_rank#30537, currency_rank#30538]
            :     :              +- Window [rank(return_ratio#30535) windowspecdefinition(return_ratio#30535 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#30537], [return_ratio#30535 ASC NULLS FIRST]
            :     :                 +- Window [rank(currency_ratio#30536) windowspecdefinition(currency_ratio#30536 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#30538], [currency_ratio#30536 ASC NULLS FIRST]
            :     :                    +- Project [item#30534, return_ratio#30535, currency_ratio#30536]
            :     :                       +- SubqueryAlias `in_web`
            :     :                          +- Aggregate [ws_item_sk#219], [ws_item_sk#219 AS item#30534, CheckOverflow((promote_precision(cast(cast(sum(cast(coalesce(wr_return_quantity#298, 0) as bigint)) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(cast(coalesce(ws_quantity#234, 0) as bigint)) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#30535, CheckOverflow((promote_precision(cast(cast(sum(coalesce(cast(wr_return_amt#299 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(coalesce(cast(ws_net_paid#245 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#30536]
            :     :                             +- Filter ((((cast(wr_return_amt#299 as decimal(7,2)) > cast(cast(10000 as decimal(5,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) > cast(cast(1 as decimal(1,0)) as decimal(7,2)))) && ((cast(ws_net_paid#245 as decimal(7,2)) > cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (ws_quantity#234 > 0))) && (((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 2001)) && (d_moy#500 = 12)))
            :     :                                +- Join Inner
            :     :                                   :- Join LeftOuter, ((ws_order_number#233L = wr_order_number#297L) && (ws_item_sk#219 = wr_item_sk#286))
            :     :                                   :  :- SubqueryAlias `ws`
            :     :                                   :  :  +- SubqueryAlias `web_sales`
            :     :                                   :  :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :     :                                   :  +- SubqueryAlias `wr`
            :     :                                   :     +- SubqueryAlias `web_returns`
            :     :                                   :        +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
            :     :                                   +- SubqueryAlias `date_dim`
            :     :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     +- Project [catalog AS channel#30545, item#30540, return_ratio#30541, return_rank#30543, currency_rank#30544]
            :        +- Filter ((return_rank#30543 <= 10) || (currency_rank#30544 <= 10))
            :           +- SubqueryAlias `catalog`
            :              +- Project [item#30540, return_ratio#30541, currency_ratio#30542, return_rank#30543, currency_rank#30544]
            :                 +- Project [item#30540, return_ratio#30541, currency_ratio#30542, return_rank#30543, currency_rank#30544, return_rank#30543, currency_rank#30544]
            :                    +- Window [rank(currency_ratio#30542) windowspecdefinition(currency_ratio#30542 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#30544], [currency_ratio#30542 ASC NULLS FIRST]
            :                       +- Window [rank(return_ratio#30541) windowspecdefinition(return_ratio#30541 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#30543], [return_ratio#30541 ASC NULLS FIRST]
            :                          +- Project [item#30540, return_ratio#30541, currency_ratio#30542]
            :                             +- SubqueryAlias `in_cat`
            :                                +- Aggregate [cs_item_sk#15], [cs_item_sk#15 AS item#30540, CheckOverflow((promote_precision(cast(cast(sum(cast(coalesce(cr_return_quantity#85, 0) as bigint)) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(cast(coalesce(cs_quantity#18, 0) as bigint)) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#30541, CheckOverflow((promote_precision(cast(cast(sum(coalesce(cast(cr_return_amount#86 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(coalesce(cast(cs_net_paid#29 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#30542]
            :                                   +- Filter ((((cast(cr_return_amount#86 as decimal(7,2)) > cast(cast(10000 as decimal(5,0)) as decimal(7,2))) && (cast(cs_net_profit#33 as decimal(7,2)) > cast(cast(1 as decimal(1,0)) as decimal(7,2)))) && ((cast(cs_net_paid#29 as decimal(7,2)) > cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (cs_quantity#18 > 0))) && (((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 2001)) && (d_moy#500 = 12)))
            :                                      +- Join Inner
            :                                         :- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
            :                                         :  :- SubqueryAlias `cs`
            :                                         :  :  +- SubqueryAlias `catalog_sales`
            :                                         :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :                                         :  +- SubqueryAlias `cr`
            :                                         :     +- SubqueryAlias `catalog_returns`
            :                                         :        +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
            :                                         +- SubqueryAlias `date_dim`
            :                                            +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Project [store AS channel#30551, item#30546, return_ratio#30547, return_rank#30549, currency_rank#30550]
               +- Filter ((return_rank#30549 <= 10) || (currency_rank#30550 <= 10))
                  +- SubqueryAlias `store`
                     +- Project [item#30546, return_ratio#30547, currency_ratio#30548, return_rank#30549, currency_rank#30550]
                        +- Project [item#30546, return_ratio#30547, currency_ratio#30548, currency_rank#30550, return_rank#30549, return_rank#30549, currency_rank#30550]
                           +- Window [rank(return_ratio#30547) windowspecdefinition(return_ratio#30547 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#30549], [return_ratio#30547 ASC NULLS FIRST]
                              +- Window [rank(currency_ratio#30548) windowspecdefinition(currency_ratio#30548 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#30550], [currency_ratio#30548 ASC NULLS FIRST]
                                 +- Project [item#30546, return_ratio#30547, currency_ratio#30548]
                                    +- SubqueryAlias `in_store`
                                       +- Aggregate [ss_item_sk#132], [ss_item_sk#132 AS item#30546, CheckOverflow((promote_precision(cast(cast(sum(cast(coalesce(sr_return_quantity#186, 0) as bigint)) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(cast(coalesce(ss_quantity#140, 0) as bigint)) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#30547, CheckOverflow((promote_precision(cast(cast(sum(coalesce(cast(sr_return_amt#187 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(coalesce(cast(ss_net_paid#150 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#30548]
                                          +- Filter ((((cast(sr_return_amt#187 as decimal(7,2)) > cast(cast(10000 as decimal(5,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) > cast(cast(1 as decimal(1,0)) as decimal(7,2)))) && ((cast(ss_net_paid#150 as decimal(7,2)) > cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (ss_quantity#140 > 0))) && (((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 2001)) && (d_moy#500 = 12)))
                                             +- Join Inner
                                                :- Join LeftOuter, ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))
                                                :  :- SubqueryAlias `sts`
                                                :  :  +- SubqueryAlias `store_sales`
                                                :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                                :  +- SubqueryAlias `sr`
                                                :     +- SubqueryAlias `store_returns`
                                                :        +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                                                +- SubqueryAlias `date_dim`
                                                   +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 19:48:54 INFO Query:
== Query: q49-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#30640 ASC NULLS FIRST, return_rank#30638 ASC NULLS FIRST, currency_rank#30639 ASC NULLS FIRST], true
      +- Distinct
         +- Union
            :- Distinct
            :  +- Union
            :     :- Project [web AS channel#30640, item#30635, return_ratio#30636, return_rank#30638, currency_rank#30639]
            :     :  +- Filter ((return_rank#30638 <= 10) || (currency_rank#30639 <= 10))
            :     :     +- SubqueryAlias `web`
            :     :        +- Project [item#30635, return_ratio#30636, currency_ratio#30637, return_rank#30638, currency_rank#30639]
            :     :           +- Project [item#30635, return_ratio#30636, currency_ratio#30637, return_rank#30638, currency_rank#30639, return_rank#30638, currency_rank#30639]
            :     :              +- Window [rank(currency_ratio#30637) windowspecdefinition(currency_ratio#30637 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#30639], [currency_ratio#30637 ASC NULLS FIRST]
            :     :                 +- Window [rank(return_ratio#30636) windowspecdefinition(return_ratio#30636 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#30638], [return_ratio#30636 ASC NULLS FIRST]
            :     :                    +- Project [item#30635, return_ratio#30636, currency_ratio#30637]
            :     :                       +- SubqueryAlias `in_web`
            :     :                          +- Aggregate [ws_item_sk#219], [ws_item_sk#219 AS item#30635, CheckOverflow((promote_precision(cast(cast(sum(cast(coalesce(wr_return_quantity#298, 0) as bigint)) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(cast(coalesce(ws_quantity#234, 0) as bigint)) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#30636, CheckOverflow((promote_precision(cast(cast(sum(coalesce(cast(wr_return_amt#299 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(coalesce(cast(ws_net_paid#245 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#30637]
            :     :                             +- Filter ((((cast(wr_return_amt#299 as decimal(7,2)) > cast(cast(10000 as decimal(5,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) > cast(cast(1 as decimal(1,0)) as decimal(7,2)))) && ((cast(ws_net_paid#245 as decimal(7,2)) > cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (ws_quantity#234 > 0))) && (((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 2001)) && (d_moy#500 = 12)))
            :     :                                +- Join Inner
            :     :                                   :- Join LeftOuter, ((ws_order_number#233L = wr_order_number#297L) && (ws_item_sk#219 = wr_item_sk#286))
            :     :                                   :  :- SubqueryAlias `ws`
            :     :                                   :  :  +- SubqueryAlias `web_sales`
            :     :                                   :  :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :     :                                   :  +- SubqueryAlias `wr`
            :     :                                   :     +- SubqueryAlias `web_returns`
            :     :                                   :        +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
            :     :                                   +- SubqueryAlias `date_dim`
            :     :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     +- Project [catalog AS channel#30646, item#30641, return_ratio#30642, return_rank#30644, currency_rank#30645]
            :        +- Filter ((return_rank#30644 <= 10) || (currency_rank#30645 <= 10))
            :           +- SubqueryAlias `catalog`
            :              +- Project [item#30641, return_ratio#30642, currency_ratio#30643, return_rank#30644, currency_rank#30645]
            :                 +- Project [item#30641, return_ratio#30642, currency_ratio#30643, currency_rank#30645, return_rank#30644, return_rank#30644, currency_rank#30645]
            :                    +- Window [rank(return_ratio#30642) windowspecdefinition(return_ratio#30642 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#30644], [return_ratio#30642 ASC NULLS FIRST]
            :                       +- Window [rank(currency_ratio#30643) windowspecdefinition(currency_ratio#30643 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#30645], [currency_ratio#30643 ASC NULLS FIRST]
            :                          +- Project [item#30641, return_ratio#30642, currency_ratio#30643]
            :                             +- SubqueryAlias `in_cat`
            :                                +- Aggregate [cs_item_sk#15], [cs_item_sk#15 AS item#30641, CheckOverflow((promote_precision(cast(cast(sum(cast(coalesce(cr_return_quantity#85, 0) as bigint)) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(cast(coalesce(cs_quantity#18, 0) as bigint)) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#30642, CheckOverflow((promote_precision(cast(cast(sum(coalesce(cast(cr_return_amount#86 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(coalesce(cast(cs_net_paid#29 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#30643]
            :                                   +- Filter ((((cast(cr_return_amount#86 as decimal(7,2)) > cast(cast(10000 as decimal(5,0)) as decimal(7,2))) && (cast(cs_net_profit#33 as decimal(7,2)) > cast(cast(1 as decimal(1,0)) as decimal(7,2)))) && ((cast(cs_net_paid#29 as decimal(7,2)) > cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (cs_quantity#18 > 0))) && (((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 2001)) && (d_moy#500 = 12)))
            :                                      +- Join Inner
            :                                         :- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
            :                                         :  :- SubqueryAlias `cs`
            :                                         :  :  +- SubqueryAlias `catalog_sales`
            :                                         :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :                                         :  +- SubqueryAlias `cr`
            :                                         :     +- SubqueryAlias `catalog_returns`
            :                                         :        +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
            :                                         +- SubqueryAlias `date_dim`
            :                                            +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Project [store AS channel#30652, item#30647, return_ratio#30648, return_rank#30650, currency_rank#30651]
               +- Filter ((return_rank#30650 <= 10) || (currency_rank#30651 <= 10))
                  +- SubqueryAlias `store`
                     +- Project [item#30647, return_ratio#30648, currency_ratio#30649, return_rank#30650, currency_rank#30651]
                        +- Project [item#30647, return_ratio#30648, currency_ratio#30649, currency_rank#30651, return_rank#30650, return_rank#30650, currency_rank#30651]
                           +- Window [rank(return_ratio#30648) windowspecdefinition(return_ratio#30648 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#30650], [return_ratio#30648 ASC NULLS FIRST]
                              +- Window [rank(currency_ratio#30649) windowspecdefinition(currency_ratio#30649 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#30651], [currency_ratio#30649 ASC NULLS FIRST]
                                 +- Project [item#30647, return_ratio#30648, currency_ratio#30649]
                                    +- SubqueryAlias `in_store`
                                       +- Aggregate [ss_item_sk#132], [ss_item_sk#132 AS item#30647, CheckOverflow((promote_precision(cast(cast(sum(cast(coalesce(sr_return_quantity#186, 0) as bigint)) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(cast(coalesce(ss_quantity#140, 0) as bigint)) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#30648, CheckOverflow((promote_precision(cast(cast(sum(coalesce(cast(sr_return_amt#187 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(coalesce(cast(ss_net_paid#150 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#30649]
                                          +- Filter ((((cast(sr_return_amt#187 as decimal(7,2)) > cast(cast(10000 as decimal(5,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) > cast(cast(1 as decimal(1,0)) as decimal(7,2)))) && ((cast(ss_net_paid#150 as decimal(7,2)) > cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (ss_quantity#140 > 0))) && (((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 2001)) && (d_moy#500 = 12)))
                                             +- Join Inner
                                                :- Join LeftOuter, ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))
                                                :  :- SubqueryAlias `sts`
                                                :  :  +- SubqueryAlias `store_sales`
                                                :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                                :  +- SubqueryAlias `sr`
                                                :     +- SubqueryAlias `store_returns`
                                                :        +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                                                +- SubqueryAlias `date_dim`
                                                   +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
19/09/08 19:48:54 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 19:48:54 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 19:48:54 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 19:48:54 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 19:48:54 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/09/08 19:48:54 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
Execution time: 51.084603331s
Running execution q50-v2.4 iteration: 1, StandardRun=true
19/09/08 19:49:46 INFO Query:
== Query: q50-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [s_store_name#669, s_company_id#680, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, 30 days#31060L, 31-60 days#31061L, 61-90 days#31062L, 91-120 days#31063L, >120 days#31064L]
      +- Sort [s_store_name#669 ASC NULLS FIRST, s_company_id#680 ASC NULLS FIRST, s_street_number#682 ASC NULLS FIRST, s_street_name#683 ASC NULLS FIRST, s_street_type#684 ASC NULLS FIRST, s_suite_number#685 ASC NULLS FIRST, s_city#686 ASC NULLS FIRST, s_county#687 ASC NULLS FIRST, s_state#688 ASC NULLS FIRST, s_zip#689 ASC NULLS FIRST], true
         +- Aggregate [s_store_name#669, s_company_id#680, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689], [s_store_name#669, s_company_id#680, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, sum(cast(CASE WHEN ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days#31060L, sum(cast(CASE WHEN (((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 30) && ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31-60 days#31061L, sum(cast(CASE WHEN (((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 60) && ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61-90 days#31062L, sum(cast(CASE WHEN (((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 90) && ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91-120 days#31063L, sum(cast(CASE WHEN ((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days#31064L]
            +- Filter ((((d_year#31071 = 2001) && (d_moy#31073 = 8)) && ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))) && (((ss_sold_date_sk#130 = d_date_sk#492) && (sr_returned_date_sk#176 = d_date_sk#31065)) && ((ss_customer_sk#133 = sr_customer_sk#179) && (ss_store_sk#137 = s_store_sk#664))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  +- SubqueryAlias `store_returns`
                  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :  +- SubqueryAlias `store`
                  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  :  +- SubqueryAlias `d1`
                  :     +- SubqueryAlias `date_dim`
                  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `d2`
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#31065,d_date_id#31066,d_date#31067,d_month_seq#31068,d_week_seq#31069,d_quarter_seq#31070,d_year#31071,d_dow#31072,d_moy#31073,d_dom#31074,d_qoy#31075,d_fy_year#31076,d_fy_quarter_seq#31077,d_fy_week_seq#31078,d_day_name#31079,d_quarter_name#31080,d_holiday#31081,d_weekend#31082,d_following_holiday#31083,d_first_dom#31084,d_last_dom#31085,d_same_day_ly#31086,d_same_day_lq#31087,d_current_day#31088,... 4 more fields] parquet

     : benchmark
19/09/08 19:49:46 INFO Query:
== Query: q50-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [s_store_name#669, s_company_id#680, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, 30 days#31123L, 31-60 days#31124L, 61-90 days#31125L, 91-120 days#31126L, >120 days#31127L]
      +- Sort [s_store_name#669 ASC NULLS FIRST, s_company_id#680 ASC NULLS FIRST, s_street_number#682 ASC NULLS FIRST, s_street_name#683 ASC NULLS FIRST, s_street_type#684 ASC NULLS FIRST, s_suite_number#685 ASC NULLS FIRST, s_city#686 ASC NULLS FIRST, s_county#687 ASC NULLS FIRST, s_state#688 ASC NULLS FIRST, s_zip#689 ASC NULLS FIRST], true
         +- Aggregate [s_store_name#669, s_company_id#680, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689], [s_store_name#669, s_company_id#680, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, sum(cast(CASE WHEN ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days#31123L, sum(cast(CASE WHEN (((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 30) && ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31-60 days#31124L, sum(cast(CASE WHEN (((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 60) && ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61-90 days#31125L, sum(cast(CASE WHEN (((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 90) && ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91-120 days#31126L, sum(cast(CASE WHEN ((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days#31127L]
            +- Filter ((((d_year#31134 = 2001) && (d_moy#31136 = 8)) && ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))) && (((ss_sold_date_sk#130 = d_date_sk#492) && (sr_returned_date_sk#176 = d_date_sk#31128)) && ((ss_customer_sk#133 = sr_customer_sk#179) && (ss_store_sk#137 = s_store_sk#664))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  +- SubqueryAlias `store_returns`
                  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :  +- SubqueryAlias `store`
                  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  :  +- SubqueryAlias `d1`
                  :     +- SubqueryAlias `date_dim`
                  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `d2`
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#31128,d_date_id#31129,d_date#31130,d_month_seq#31131,d_week_seq#31132,d_quarter_seq#31133,d_year#31134,d_dow#31135,d_moy#31136,d_dom#31137,d_qoy#31138,d_fy_year#31139,d_fy_quarter_seq#31140,d_fy_week_seq#31141,d_day_name#31142,d_quarter_name#31143,d_holiday#31144,d_weekend#31145,d_following_holiday#31146,d_first_dom#31147,d_last_dom#31148,d_same_day_ly#31149,d_same_day_lq#31150,d_current_day#31151,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 46.569571237999995s
Running execution q51-v2.4 iteration: 1, StandardRun=true
19/09/08 19:50:34 INFO Query:
== Query: q51-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_sk#31383 ASC NULLS FIRST, d_date#31384 ASC NULLS FIRST], true
      +- Project [item_sk#31383, d_date#31384, web_sales#31385, store_sales#31386, web_cumulative#31387, store_cumulative#31388]
         +- Filter (web_cumulative#31387 > store_cumulative#31388)
            +- SubqueryAlias `y`
               +- Project [item_sk#31383, d_date#31384, web_sales#31385, store_sales#31386, web_cumulative#31387, store_cumulative#31388]
                  +- Project [item_sk#31383, d_date#31384, web_sales#31385, store_sales#31386, web_cumulative#31387, store_cumulative#31388, web_cumulative#31387, store_cumulative#31388]
                     +- Window [max(web_sales#31385) windowspecdefinition(item_sk#31383, d_date#31384 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS web_cumulative#31387, max(store_sales#31386) windowspecdefinition(item_sk#31383, d_date#31384 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS store_cumulative#31388], [item_sk#31383], [d_date#31384 ASC NULLS FIRST]
                        +- Project [item_sk#31383, d_date#31384, web_sales#31385, store_sales#31386]
                           +- SubqueryAlias `x`
                              +- Project [CASE WHEN isnotnull(item_sk#31389) THEN item_sk#31389 ELSE item_sk#31391 END AS item_sk#31383, CASE WHEN isnotnull(d_date#494) THEN d_date#494 ELSE d_date#31401 END AS d_date#31384, cume_sales#31390 AS web_sales#31385, cume_sales#31392 AS store_sales#31386]
                                 +- Join FullOuter, ((item_sk#31389 = item_sk#31391) && (d_date#494 = d_date#31401))
                                    :- SubqueryAlias `web`
                                    :  +- SubqueryAlias `web_v1`
                                    :     +- Project [item_sk#31389, d_date#494, cume_sales#31390]
                                    :        +- Project [item_sk#31389, d_date#494, _w0#31395, ws_item_sk#219, cume_sales#31390, cume_sales#31390]
                                    :           +- Window [sum(_w0#31395) windowspecdefinition(ws_item_sk#219, d_date#494 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#31390], [ws_item_sk#219], [d_date#494 ASC NULLS FIRST]
                                    :              +- Aggregate [ws_item_sk#219, d_date#494], [ws_item_sk#219 AS item_sk#31389, d_date#494, sum(ws_sales_price#237) AS _w0#31395, ws_item_sk#219]
                                    :                 +- Filter (((ws_sold_date_sk#216 = d_date_sk#492) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11)))) && isnotnull(ws_item_sk#219))
                                    :                    +- Join Inner
                                    :                       :- SubqueryAlias `web_sales`
                                    :                       :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :                       +- SubqueryAlias `date_dim`
                                    :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                    +- SubqueryAlias `store`
                                       +- SubqueryAlias `store_v1`
                                          +- Project [item_sk#31391, d_date#31401, cume_sales#31392]
                                             +- Project [item_sk#31391, d_date#31401, _w0#31398, ss_item_sk#132, cume_sales#31392, cume_sales#31392]
                                                +- Window [sum(_w0#31398) windowspecdefinition(ss_item_sk#132, d_date#31401 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#31392], [ss_item_sk#132], [d_date#31401 ASC NULLS FIRST]
                                                   +- Aggregate [ss_item_sk#132, d_date#31401], [ss_item_sk#132 AS item_sk#31391, d_date#31401, sum(ss_sales_price#143) AS _w0#31398, ss_item_sk#132]
                                                      +- Filter (((ss_sold_date_sk#130 = d_date_sk#31399) && ((d_month_seq#31402 >= 1200) && (d_month_seq#31402 <= (1200 + 11)))) && isnotnull(ss_item_sk#132))
                                                         +- Join Inner
                                                            :- SubqueryAlias `store_sales`
                                                            :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                                            +- SubqueryAlias `date_dim`
                                                               +- Relation[d_date_sk#31399,d_date_id#31400,d_date#31401,d_month_seq#31402,d_week_seq#31403,d_quarter_seq#31404,d_year#31405,d_dow#31406,d_moy#31407,d_dom#31408,d_qoy#31409,d_fy_year#31410,d_fy_quarter_seq#31411,d_fy_week_seq#31412,d_day_name#31413,d_quarter_name#31414,d_holiday#31415,d_weekend#31416,d_following_holiday#31417,d_first_dom#31418,d_last_dom#31419,d_same_day_ly#31420,d_same_day_lq#31421,d_current_day#31422,... 4 more fields] parquet

     : benchmark
19/09/08 19:50:34 INFO Query:
== Query: q51-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_sk#31435 ASC NULLS FIRST, d_date#31436 ASC NULLS FIRST], true
      +- Project [item_sk#31435, d_date#31436, web_sales#31437, store_sales#31438, web_cumulative#31439, store_cumulative#31440]
         +- Filter (web_cumulative#31439 > store_cumulative#31440)
            +- SubqueryAlias `y`
               +- Project [item_sk#31435, d_date#31436, web_sales#31437, store_sales#31438, web_cumulative#31439, store_cumulative#31440]
                  +- Project [item_sk#31435, d_date#31436, web_sales#31437, store_sales#31438, web_cumulative#31439, store_cumulative#31440, web_cumulative#31439, store_cumulative#31440]
                     +- Window [max(web_sales#31437) windowspecdefinition(item_sk#31435, d_date#31436 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS web_cumulative#31439, max(store_sales#31438) windowspecdefinition(item_sk#31435, d_date#31436 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS store_cumulative#31440], [item_sk#31435], [d_date#31436 ASC NULLS FIRST]
                        +- Project [item_sk#31435, d_date#31436, web_sales#31437, store_sales#31438]
                           +- SubqueryAlias `x`
                              +- Project [CASE WHEN isnotnull(item_sk#31441) THEN item_sk#31441 ELSE item_sk#31443 END AS item_sk#31435, CASE WHEN isnotnull(d_date#494) THEN d_date#494 ELSE d_date#31453 END AS d_date#31436, cume_sales#31442 AS web_sales#31437, cume_sales#31444 AS store_sales#31438]
                                 +- Join FullOuter, ((item_sk#31441 = item_sk#31443) && (d_date#494 = d_date#31453))
                                    :- SubqueryAlias `web`
                                    :  +- SubqueryAlias `web_v1`
                                    :     +- Project [item_sk#31441, d_date#494, cume_sales#31442]
                                    :        +- Project [item_sk#31441, d_date#494, _w0#31447, ws_item_sk#219, cume_sales#31442, cume_sales#31442]
                                    :           +- Window [sum(_w0#31447) windowspecdefinition(ws_item_sk#219, d_date#494 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#31442], [ws_item_sk#219], [d_date#494 ASC NULLS FIRST]
                                    :              +- Aggregate [ws_item_sk#219, d_date#494], [ws_item_sk#219 AS item_sk#31441, d_date#494, sum(ws_sales_price#237) AS _w0#31447, ws_item_sk#219]
                                    :                 +- Filter (((ws_sold_date_sk#216 = d_date_sk#492) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11)))) && isnotnull(ws_item_sk#219))
                                    :                    +- Join Inner
                                    :                       :- SubqueryAlias `web_sales`
                                    :                       :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :                       +- SubqueryAlias `date_dim`
                                    :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                    +- SubqueryAlias `store`
                                       +- SubqueryAlias `store_v1`
                                          +- Project [item_sk#31443, d_date#31453, cume_sales#31444]
                                             +- Project [item_sk#31443, d_date#31453, _w0#31450, ss_item_sk#132, cume_sales#31444, cume_sales#31444]
                                                +- Window [sum(_w0#31450) windowspecdefinition(ss_item_sk#132, d_date#31453 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#31444], [ss_item_sk#132], [d_date#31453 ASC NULLS FIRST]
                                                   +- Aggregate [ss_item_sk#132, d_date#31453], [ss_item_sk#132 AS item_sk#31443, d_date#31453, sum(ss_sales_price#143) AS _w0#31450, ss_item_sk#132]
                                                      +- Filter (((ss_sold_date_sk#130 = d_date_sk#31451) && ((d_month_seq#31454 >= 1200) && (d_month_seq#31454 <= (1200 + 11)))) && isnotnull(ss_item_sk#132))
                                                         +- Join Inner
                                                            :- SubqueryAlias `store_sales`
                                                            :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                                            +- SubqueryAlias `date_dim`
                                                               +- Relation[d_date_sk#31451,d_date_id#31452,d_date#31453,d_month_seq#31454,d_week_seq#31455,d_quarter_seq#31456,d_year#31457,d_dow#31458,d_moy#31459,d_dom#31460,d_qoy#31461,d_fy_year#31462,d_fy_quarter_seq#31463,d_fy_week_seq#31464,d_day_name#31465,d_quarter_name#31466,d_holiday#31467,d_weekend#31468,d_following_holiday#31469,d_first_dom#31470,d_last_dom#31471,d_same_day_ly#31472,d_same_day_lq#31473,d_current_day#31474,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 32.533508212s
Running execution q52-v2.4 iteration: 1, StandardRun=true
19/09/08 19:51:08 INFO Query:
== Query: q52-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [d_year#498 ASC NULLS FIRST, ext_price#31615 DESC NULLS LAST, brand_id#31613 ASC NULLS FIRST], true
      +- Aggregate [d_year#498, i_brand#572, i_brand_id#571], [d_year#498, i_brand_id#571 AS brand_id#31613, i_brand#572 AS brand#31614, sum(ss_ext_sales_price#145) AS ext_price#31615]
         +- Filter ((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 1)) && ((d_moy#500 = 11) && (d_year#498 = 2000)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dt`
               :  :  +- SubqueryAlias `date_dim`
               :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 19:51:08 INFO Query:
== Query: q52-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [d_year#498 ASC NULLS FIRST, ext_price#31626 DESC NULLS LAST, brand_id#31624 ASC NULLS FIRST], true
      +- Aggregate [d_year#498, i_brand#572, i_brand_id#571], [d_year#498, i_brand_id#571 AS brand_id#31624, i_brand#572 AS brand#31625, sum(ss_ext_sales_price#145) AS ext_price#31626]
         +- Filter ((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 1)) && ((d_moy#500 = 11) && (d_year#498 = 2000)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dt`
               :  :  +- SubqueryAlias `date_dim`
               :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 10.25866691s
Running execution q53-v2.4 iteration: 1, StandardRun=true
19/09/08 19:51:19 INFO Query:
== Query: q53-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [avg_quarterly_sales#31672 ASC NULLS FIRST, sum_sales#31671 ASC NULLS FIRST, i_manufact_id#577 ASC NULLS FIRST], true
      +- Project [i_manufact_id#577, sum_sales#31671, avg_quarterly_sales#31672]
         +- Filter (cast(CASE WHEN (cast(avg_quarterly_sales#31672 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#31671 as decimal(22,6))) - promote_precision(cast(avg_quarterly_sales#31672 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_quarterly_sales#31672 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16)))
            +- SubqueryAlias `tmp1`
               +- Project [i_manufact_id#577, sum_sales#31671, avg_quarterly_sales#31672]
                  +- Project [i_manufact_id#577, sum_sales#31671, _w0#31676, avg_quarterly_sales#31672, avg_quarterly_sales#31672]
                     +- Window [avg(_w0#31676) windowspecdefinition(i_manufact_id#577, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_quarterly_sales#31672], [i_manufact_id#577]
                        +- Aggregate [i_manufact_id#577, d_qoy#502], [i_manufact_id#577, sum(ss_sales_price#143) AS sum_sales#31671, sum(ss_sales_price#143) AS _w0#31676]
                           +- Filter ((((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_store_sk#137 = s_store_sk#664)) && (d_month_seq#495 IN (1200,(1200 + 1),(1200 + 2),(1200 + 3),(1200 + 4),(1200 + 5),(1200 + 6),(1200 + 7),(1200 + 8),(1200 + 9),(1200 + 10),(1200 + 11)) && (((i_category#576 IN (Books,Children,Electronics) && i_class#574 IN (personal,portable,reference,self-help)) && i_brand#572 IN (scholaramalgamalg #14,scholaramalgamalg #7,exportiunivamalg #9,scholaramalgamalg #9)) || ((i_category#576 IN (Women,Music,Men) && i_class#574 IN (accessories,classical,fragrances,pants)) && i_brand#572 IN (amalgimporto #1,edu packscholar #1,exportiimporto #1,importoamalg #1)))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `item`
                                 :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :  :  +- SubqueryAlias `store_sales`
                                 :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `date_dim`
                                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- SubqueryAlias `store`
                                    +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/09/08 19:51:19 INFO Query:
== Query: q53-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [avg_quarterly_sales#31681 ASC NULLS FIRST, sum_sales#31680 ASC NULLS FIRST, i_manufact_id#577 ASC NULLS FIRST], true
      +- Project [i_manufact_id#577, sum_sales#31680, avg_quarterly_sales#31681]
         +- Filter (cast(CASE WHEN (cast(avg_quarterly_sales#31681 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#31680 as decimal(22,6))) - promote_precision(cast(avg_quarterly_sales#31681 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_quarterly_sales#31681 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16)))
            +- SubqueryAlias `tmp1`
               +- Project [i_manufact_id#577, sum_sales#31680, avg_quarterly_sales#31681]
                  +- Project [i_manufact_id#577, sum_sales#31680, _w0#31685, avg_quarterly_sales#31681, avg_quarterly_sales#31681]
                     +- Window [avg(_w0#31685) windowspecdefinition(i_manufact_id#577, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_quarterly_sales#31681], [i_manufact_id#577]
                        +- Aggregate [i_manufact_id#577, d_qoy#502], [i_manufact_id#577, sum(ss_sales_price#143) AS sum_sales#31680, sum(ss_sales_price#143) AS _w0#31685]
                           +- Filter ((((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_store_sk#137 = s_store_sk#664)) && (d_month_seq#495 IN (1200,(1200 + 1),(1200 + 2),(1200 + 3),(1200 + 4),(1200 + 5),(1200 + 6),(1200 + 7),(1200 + 8),(1200 + 9),(1200 + 10),(1200 + 11)) && (((i_category#576 IN (Books,Children,Electronics) && i_class#574 IN (personal,portable,reference,self-help)) && i_brand#572 IN (scholaramalgamalg #14,scholaramalgamalg #7,exportiunivamalg #9,scholaramalgamalg #9)) || ((i_category#576 IN (Women,Music,Men) && i_class#574 IN (accessories,classical,fragrances,pants)) && i_brand#572 IN (amalgimporto #1,edu packscholar #1,exportiimporto #1,importoamalg #1)))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `item`
                                 :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :  :  +- SubqueryAlias `store_sales`
                                 :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `date_dim`
                                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- SubqueryAlias `store`
                                    +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 12.560822632999999s
Running execution q54-v2.4 iteration: 1, StandardRun=true
19/09/08 19:51:33 INFO Query:
== Query: q54-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [segment#31746 ASC NULLS FIRST, num_customers#31735L ASC NULLS FIRST], true
      +- Aggregate [segment#31746], [segment#31746, count(1) AS num_customers#31735L, (segment#31746 * 50) AS segment_base#31736]
         +- SubqueryAlias `segments`
            +- Project [cast(CheckOverflow((promote_precision(cast(revenue#31743 as decimal(17,2))) / promote_precision(cast(cast(50 as decimal(2,0)) as decimal(17,2)))), DecimalType(21,6)) as int) AS segment#31746]
               +- SubqueryAlias `my_revenue`
                  +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(ss_ext_sales_price#145) AS revenue#31743]
                     +- Filter ((((c_current_addr_sk#416 = ca_address_sk#448) && (ca_county#455 = s_county#687)) && (ca_state#456 = s_state#688)) && (((ss_sold_date_sk#130 = d_date_sk#492) && (c_customer_sk#412 = ss_customer_sk#133)) && ((d_month_seq#495 >= scalar-subquery#31744 []) && (d_month_seq#495 <= scalar-subquery#31745 []))))
                        :  :- Distinct
                        :  :  +- Project [(d_month_seq#495 + 1) AS (d_month_seq + 1)#31747]
                        :  :     +- Filter ((d_year#498 = 1998) && (d_moy#500 = 12))
                        :  :        +- SubqueryAlias `date_dim`
                        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  +- Distinct
                        :     +- Project [(d_month_seq#495 + 3) AS (d_month_seq + 3)#31748]
                        :        +- Filter ((d_year#498 = 1998) && (d_moy#500 = 12))
                        :           +- SubqueryAlias `date_dim`
                        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Join Inner
                           :- Join Inner
                           :  :- Join Inner
                           :  :  :- Join Inner
                           :  :  :  :- SubqueryAlias `my_customers`
                           :  :  :  :  +- Distinct
                           :  :  :  :     +- Project [c_customer_sk#412, c_current_addr_sk#416]
                           :  :  :  :        +- Filter ((((sold_date_sk#31737 = d_date_sk#492) && (item_sk#31739 = i_item_sk#564)) && ((i_category#576 = Women) && (i_class#574 = maternity))) && (((c_customer_sk#412 = customer_sk#31738) && (d_moy#500 = 12)) && (d_year#498 = 1998)))
                           :  :  :  :           +- Join Inner
                           :  :  :  :              :- Join Inner
                           :  :  :  :              :  :- Join Inner
                           :  :  :  :              :  :  :- SubqueryAlias `cs_or_ws_sales`
                           :  :  :  :              :  :  :  +- Union
                           :  :  :  :              :  :  :     :- Project [cs_sold_date_sk#0 AS sold_date_sk#31737, cs_bill_customer_sk#3 AS customer_sk#31738, cs_item_sk#15 AS item_sk#31739]
                           :  :  :  :              :  :  :     :  +- SubqueryAlias `catalog_sales`
                           :  :  :  :              :  :  :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :  :  :  :              :  :  :     +- Project [ws_sold_date_sk#216 AS sold_date_sk#31740, ws_bill_customer_sk#220 AS customer_sk#31741, ws_item_sk#219 AS item_sk#31742]
                           :  :  :  :              :  :  :        +- SubqueryAlias `web_sales`
                           :  :  :  :              :  :  :           +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :  :  :  :              :  :  +- SubqueryAlias `item`
                           :  :  :  :              :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           :  :  :  :              :  +- SubqueryAlias `date_dim`
                           :  :  :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :  :  :  :              +- SubqueryAlias `customer`
                           :  :  :  :                 +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                           :  :  :  +- SubqueryAlias `store_sales`
                           :  :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :  :  +- SubqueryAlias `customer_address`
                           :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                           :  +- SubqueryAlias `store`
                           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 19:51:33 INFO Query:
== Query: q54-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [segment#31767 ASC NULLS FIRST, num_customers#31756L ASC NULLS FIRST], true
      +- Aggregate [segment#31767], [segment#31767, count(1) AS num_customers#31756L, (segment#31767 * 50) AS segment_base#31757]
         +- SubqueryAlias `segments`
            +- Project [cast(CheckOverflow((promote_precision(cast(revenue#31764 as decimal(17,2))) / promote_precision(cast(cast(50 as decimal(2,0)) as decimal(17,2)))), DecimalType(21,6)) as int) AS segment#31767]
               +- SubqueryAlias `my_revenue`
                  +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(ss_ext_sales_price#145) AS revenue#31764]
                     +- Filter ((((c_current_addr_sk#416 = ca_address_sk#448) && (ca_county#455 = s_county#687)) && (ca_state#456 = s_state#688)) && (((ss_sold_date_sk#130 = d_date_sk#492) && (c_customer_sk#412 = ss_customer_sk#133)) && ((d_month_seq#495 >= scalar-subquery#31765 []) && (d_month_seq#495 <= scalar-subquery#31766 []))))
                        :  :- Distinct
                        :  :  +- Project [(d_month_seq#495 + 1) AS (d_month_seq + 1)#31768]
                        :  :     +- Filter ((d_year#498 = 1998) && (d_moy#500 = 12))
                        :  :        +- SubqueryAlias `date_dim`
                        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  +- Distinct
                        :     +- Project [(d_month_seq#495 + 3) AS (d_month_seq + 3)#31769]
                        :        +- Filter ((d_year#498 = 1998) && (d_moy#500 = 12))
                        :           +- SubqueryAlias `date_dim`
                        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Join Inner
                           :- Join Inner
                           :  :- Join Inner
                           :  :  :- Join Inner
                           :  :  :  :- SubqueryAlias `my_customers`
                           :  :  :  :  +- Distinct
                           :  :  :  :     +- Project [c_customer_sk#412, c_current_addr_sk#416]
                           :  :  :  :        +- Filter ((((sold_date_sk#31758 = d_date_sk#492) && (item_sk#31760 = i_item_sk#564)) && ((i_category#576 = Women) && (i_class#574 = maternity))) && (((c_customer_sk#412 = customer_sk#31759) && (d_moy#500 = 12)) && (d_year#498 = 1998)))
                           :  :  :  :           +- Join Inner
                           :  :  :  :              :- Join Inner
                           :  :  :  :              :  :- Join Inner
                           :  :  :  :              :  :  :- SubqueryAlias `cs_or_ws_sales`
                           :  :  :  :              :  :  :  +- Union
                           :  :  :  :              :  :  :     :- Project [cs_sold_date_sk#0 AS sold_date_sk#31758, cs_bill_customer_sk#3 AS customer_sk#31759, cs_item_sk#15 AS item_sk#31760]
                           :  :  :  :              :  :  :     :  +- SubqueryAlias `catalog_sales`
                           :  :  :  :              :  :  :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :  :  :  :              :  :  :     +- Project [ws_sold_date_sk#216 AS sold_date_sk#31761, ws_bill_customer_sk#220 AS customer_sk#31762, ws_item_sk#219 AS item_sk#31763]
                           :  :  :  :              :  :  :        +- SubqueryAlias `web_sales`
                           :  :  :  :              :  :  :           +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :  :  :  :              :  :  +- SubqueryAlias `item`
                           :  :  :  :              :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           :  :  :  :              :  +- SubqueryAlias `date_dim`
                           :  :  :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :  :  :  :              +- SubqueryAlias `customer`
                           :  :  :  :                 +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                           :  :  :  +- SubqueryAlias `store_sales`
                           :  :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :  :  +- SubqueryAlias `customer_address`
                           :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                           :  +- SubqueryAlias `store`
                           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 51.559114391s
Running execution q55-v2.4 iteration: 1, StandardRun=true
19/09/08 19:52:26 INFO Query:
== Query: q55-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ext_price#31837 DESC NULLS LAST, brand_id#31835 ASC NULLS FIRST], true
      +- Aggregate [i_brand#572, i_brand_id#571], [i_brand_id#571 AS brand_id#31835, i_brand#572 AS brand#31836, sum(ss_ext_sales_price#145) AS ext_price#31837]
         +- Filter ((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 28)) && ((d_moy#500 = 11) && (d_year#498 = 1999)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `date_dim`
               :  :  +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 19:52:26 INFO Query:
== Query: q55-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ext_price#31846 DESC NULLS LAST, brand_id#31844 ASC NULLS FIRST], true
      +- Aggregate [i_brand#572, i_brand_id#571], [i_brand_id#571 AS brand_id#31844, i_brand#572 AS brand#31845, sum(ss_ext_sales_price#145) AS ext_price#31846]
         +- Filter ((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 28)) && ((d_moy#500 = 11) && (d_year#498 = 1999)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `date_dim`
               :  :  +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 10.055349685s
Running execution q56-v2.4 iteration: 1, StandardRun=true
19/09/08 19:52:37 INFO Query:
== Query: q56-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [total_sales#31902 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565], [i_item_id#565, sum(total_sales#31903) AS total_sales#31902]
         +- SubqueryAlias `tmp1`
            +- Union
               :- Union
               :  :- Project [i_item_id#565, total_sales#31903]
               :  :  +- SubqueryAlias `ss`
               :  :     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ss_ext_sales_price#145) AS total_sales#31903]
               :  :        +- Filter (((i_item_id#565 IN (list#31904 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 2001))) && (((d_moy#500 = 2) && (ss_addr_sk#136 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :  :           :  +- Project [i_item_id#565]
               :  :           :     +- Filter i_color#581 IN (slate,blanched,burnished)
               :  :           :        +- SubqueryAlias `item`
               :  :           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- Join Inner
               :  :              :  :  :- SubqueryAlias `store_sales`
               :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :              :  :  +- SubqueryAlias `date_dim`
               :  :              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              :  +- SubqueryAlias `customer_address`
               :  :              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  :              +- SubqueryAlias `item`
               :  :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- Project [i_item_id#565, total_sales#31905]
               :     +- SubqueryAlias `cs`
               :        +- Aggregate [i_item_id#565], [i_item_id#565, sum(cs_ext_sales_price#23) AS total_sales#31905]
               :           +- Filter (((i_item_id#565 IN (list#31906 []) && (cs_item_sk#15 = i_item_sk#564)) && ((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 2001))) && (((d_moy#500 = 2) && (cs_bill_addr_sk#6 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :              :  +- Project [i_item_id#565]
               :              :     +- Filter i_color#581 IN (slate,blanched,burnished)
               :              :        +- SubqueryAlias `item`
               :              :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- Join Inner
               :                 :  :  :- SubqueryAlias `catalog_sales`
               :                 :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :  :  +- SubqueryAlias `date_dim`
               :                 :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :  +- SubqueryAlias `customer_address`
               :                 :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :                 +- SubqueryAlias `item`
               :                    +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Project [i_item_id#565, total_sales#31907]
                  +- SubqueryAlias `ws`
                     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ws_ext_sales_price#239) AS total_sales#31907]
                        +- Filter (((i_item_id#565 IN (list#31908 []) && (ws_item_sk#219 = i_item_sk#564)) && ((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 2001))) && (((d_moy#500 = 2) && (ws_bill_addr_sk#223 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
                           :  +- Project [i_item_id#565]
                           :     +- Filter i_color#581 IN (slate,blanched,burnished)
                           :        +- SubqueryAlias `item`
                           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `web_sales`
                              :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :  +- SubqueryAlias `date_dim`
                              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `customer_address`
                              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 19:52:38 INFO Query:
== Query: q56-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [total_sales#31916 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565], [i_item_id#565, sum(total_sales#31917) AS total_sales#31916]
         +- SubqueryAlias `tmp1`
            +- Union
               :- Union
               :  :- Project [i_item_id#565, total_sales#31917]
               :  :  +- SubqueryAlias `ss`
               :  :     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ss_ext_sales_price#145) AS total_sales#31917]
               :  :        +- Filter (((i_item_id#565 IN (list#31918 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 2001))) && (((d_moy#500 = 2) && (ss_addr_sk#136 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :  :           :  +- Project [i_item_id#565]
               :  :           :     +- Filter i_color#581 IN (slate,blanched,burnished)
               :  :           :        +- SubqueryAlias `item`
               :  :           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- Join Inner
               :  :              :  :  :- SubqueryAlias `store_sales`
               :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :              :  :  +- SubqueryAlias `date_dim`
               :  :              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              :  +- SubqueryAlias `customer_address`
               :  :              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  :              +- SubqueryAlias `item`
               :  :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- Project [i_item_id#565, total_sales#31919]
               :     +- SubqueryAlias `cs`
               :        +- Aggregate [i_item_id#565], [i_item_id#565, sum(cs_ext_sales_price#23) AS total_sales#31919]
               :           +- Filter (((i_item_id#565 IN (list#31920 []) && (cs_item_sk#15 = i_item_sk#564)) && ((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 2001))) && (((d_moy#500 = 2) && (cs_bill_addr_sk#6 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :              :  +- Project [i_item_id#565]
               :              :     +- Filter i_color#581 IN (slate,blanched,burnished)
               :              :        +- SubqueryAlias `item`
               :              :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- Join Inner
               :                 :  :  :- SubqueryAlias `catalog_sales`
               :                 :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :  :  +- SubqueryAlias `date_dim`
               :                 :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :  +- SubqueryAlias `customer_address`
               :                 :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :                 +- SubqueryAlias `item`
               :                    +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Project [i_item_id#565, total_sales#31921]
                  +- SubqueryAlias `ws`
                     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ws_ext_sales_price#239) AS total_sales#31921]
                        +- Filter (((i_item_id#565 IN (list#31922 []) && (ws_item_sk#219 = i_item_sk#564)) && ((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 2001))) && (((d_moy#500 = 2) && (ws_bill_addr_sk#223 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
                           :  +- Project [i_item_id#565]
                           :     +- Filter i_color#581 IN (slate,blanched,burnished)
                           :        +- SubqueryAlias `item`
                           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `web_sales`
                              :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :  +- SubqueryAlias `date_dim`
                              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `customer_address`
                              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 23.158085404s
Running execution q57-v2.4 iteration: 1, StandardRun=true
19/09/08 19:53:04 INFO Query:
== Query: q57-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#33090 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#33091 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, cc_name#338 ASC NULLS FIRST], true
      +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, avg_monthly_sales#33091, sum_sales#33090, psum#33093, nsum#33094]
         +- Filter (((d_year#498 = 1999) && (cast(avg_monthly_sales#33091 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6)))) && (cast(CASE WHEN (cast(avg_monthly_sales#33091 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#33090 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#33091 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#33091 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16))))
            +- SubqueryAlias `v2`
               +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, avg_monthly_sales#33091, sum_sales#33090, sum_sales#33302 AS psum#33093, sum_sales#33789 AS nsum#33094]
                  +- Filter ((((i_category#576 = i_category#33409) && (i_category#576 = i_category#33896)) && ((i_brand#572 = i_brand#33405) && (i_brand#572 = i_brand#33892))) && (((cc_name#338 = cc_name#33571) && (cc_name#338 = cc_name#34058)) && ((rn#33092 = (rn#33206 + 1)) && (rn#33092 = (rn#33693 - 1)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `v1`
                        :  :  +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, sum_sales#33090, avg_monthly_sales#33091, rn#33092]
                        :  :     +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, sum_sales#33090, _w0#33104, rn#33092, avg_monthly_sales#33091, avg_monthly_sales#33091, rn#33092]
                        :  :        +- Window [avg(_w0#33104) windowspecdefinition(i_category#576, i_brand#572, cc_name#338, d_year#498, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#33091], [i_category#576, i_brand#572, cc_name#338, d_year#498]
                        :  :           +- Window [rank(d_year#498, d_moy#500) windowspecdefinition(i_category#576, i_brand#572, cc_name#338, d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#33092], [i_category#576, i_brand#572, cc_name#338], [d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST]
                        :  :              +- Aggregate [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500], [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, sum(cs_sales_price#21) AS sum_sales#33090, sum(cs_sales_price#21) AS _w0#33104]
                        :  :                 +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((cc_call_center_sk#332 = cs_call_center_sk#11) && (((d_year#498 = 1999) || ((d_year#498 = (1999 - 1)) && (d_moy#500 = 12))) || ((d_year#498 = (1999 + 1)) && (d_moy#500 = 1)))))
                        :  :                    +- Join Inner
                        :  :                       :- Join Inner
                        :  :                       :  :- Join Inner
                        :  :                       :  :  :- SubqueryAlias `item`
                        :  :                       :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        :  :                       :  :  +- SubqueryAlias `catalog_sales`
                        :  :                       :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :                       :  +- SubqueryAlias `date_dim`
                        :  :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :                       +- SubqueryAlias `call_center`
                        :  :                          +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet
                        :  +- SubqueryAlias `v1_lag`
                        :     +- SubqueryAlias `v1`
                        :        +- Project [i_category#33409, i_brand#33405, cc_name#33571, d_year#33496, d_moy#33498, sum_sales#33302, avg_monthly_sales#33109, rn#33206]
                        :           +- Project [i_category#33409, i_brand#33405, cc_name#33571, d_year#33496, d_moy#33498, sum_sales#33302, _w0#33303, rn#33206, avg_monthly_sales#33109, avg_monthly_sales#33109, rn#33206]
                        :              +- Window [avg(_w0#33303) windowspecdefinition(i_category#33409, i_brand#33405, cc_name#33571, d_year#33496, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#33109], [i_category#33409, i_brand#33405, cc_name#33571, d_year#33496]
                        :                 +- Window [rank(d_year#33496, d_moy#33498) windowspecdefinition(i_category#33409, i_brand#33405, cc_name#33571, d_year#33496 ASC NULLS FIRST, d_moy#33498 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#33206], [i_category#33409, i_brand#33405, cc_name#33571], [d_year#33496 ASC NULLS FIRST, d_moy#33498 ASC NULLS FIRST]
                        :                    +- Aggregate [i_category#33409, i_brand#33405, cc_name#33571, d_year#33496, d_moy#33498], [i_category#33409, i_brand#33405, cc_name#33571, d_year#33496, d_moy#33498, sum(cs_sales_price#21) AS sum_sales#33302, sum(cs_sales_price#21) AS _w0#33303]
                        :                       +- Filter (((cs_item_sk#15 = i_item_sk#33397) && (cs_sold_date_sk#0 = d_date_sk#33490)) && ((cc_call_center_sk#33565 = cs_call_center_sk#11) && (((d_year#33496 = 1999) || ((d_year#33496 = (1999 - 1)) && (d_moy#33498 = 12))) || ((d_year#33496 = (1999 + 1)) && (d_moy#33498 = 1)))))
                        :                          +- Join Inner
                        :                             :- Join Inner
                        :                             :  :- Join Inner
                        :                             :  :  :- SubqueryAlias `item`
                        :                             :  :  :  +- Relation[i_item_sk#33397,i_item_id#33398,i_rec_start_date#33399,i_rec_end_date#33400,i_item_desc#33401,i_current_price#33402,i_wholesale_cost#33403,i_brand_id#33404,i_brand#33405,i_class_id#33406,i_class#33407,i_category_id#33408,i_category#33409,i_manufact_id#33410,i_manufact#33411,i_size#33412,i_formulation#33413,i_color#33414,i_units#33415,i_container#33416,i_manager_id#33417,i_product_name#33418] parquet
                        :                             :  :  +- SubqueryAlias `catalog_sales`
                        :                             :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :                             :  +- SubqueryAlias `date_dim`
                        :                             :     +- Relation[d_date_sk#33490,d_date_id#33491,d_date#33492,d_month_seq#33493,d_week_seq#33494,d_quarter_seq#33495,d_year#33496,d_dow#33497,d_moy#33498,d_dom#33499,d_qoy#33500,d_fy_year#33501,d_fy_quarter_seq#33502,d_fy_week_seq#33503,d_day_name#33504,d_quarter_name#33505,d_holiday#33506,d_weekend#33507,d_following_holiday#33508,d_first_dom#33509,d_last_dom#33510,d_same_day_ly#33511,d_same_day_lq#33512,d_current_day#33513,... 4 more fields] parquet
                        :                             +- SubqueryAlias `call_center`
                        :                                +- Relation[cc_call_center_sk#33565,cc_call_center_id#33566,cc_rec_start_date#33567,cc_rec_end_date#33568,cc_closed_date_sk#33569,cc_open_date_sk#33570,cc_name#33571,cc_class#33572,cc_employees#33573,cc_sq_ft#33574,cc_hours#33575,cc_manager#33576,cc_mkt_id#33577,cc_mkt_class#33578,cc_mkt_desc#33579,cc_market_manager#33580,cc_division#33581,cc_division_name#33582,cc_company#33583,cc_company_name#33584,cc_street_number#33585,cc_street_name#33586,cc_street_type#33587,cc_suite_number#33588,... 7 more fields] parquet
                        +- SubqueryAlias `v1_lead`
                           +- SubqueryAlias `v1`
                              +- Project [i_category#33896, i_brand#33892, cc_name#34058, d_year#33983, d_moy#33985, sum_sales#33789, avg_monthly_sales#33596, rn#33693]
                                 +- Project [i_category#33896, i_brand#33892, cc_name#34058, d_year#33983, d_moy#33985, sum_sales#33789, _w0#33790, rn#33693, avg_monthly_sales#33596, avg_monthly_sales#33596, rn#33693]
                                    +- Window [avg(_w0#33790) windowspecdefinition(i_category#33896, i_brand#33892, cc_name#34058, d_year#33983, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#33596], [i_category#33896, i_brand#33892, cc_name#34058, d_year#33983]
                                       +- Window [rank(d_year#33983, d_moy#33985) windowspecdefinition(i_category#33896, i_brand#33892, cc_name#34058, d_year#33983 ASC NULLS FIRST, d_moy#33985 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#33693], [i_category#33896, i_brand#33892, cc_name#34058], [d_year#33983 ASC NULLS FIRST, d_moy#33985 ASC NULLS FIRST]
                                          +- Aggregate [i_category#33896, i_brand#33892, cc_name#34058, d_year#33983, d_moy#33985], [i_category#33896, i_brand#33892, cc_name#34058, d_year#33983, d_moy#33985, sum(cs_sales_price#21) AS sum_sales#33789, sum(cs_sales_price#21) AS _w0#33790]
                                             +- Filter (((cs_item_sk#15 = i_item_sk#33884) && (cs_sold_date_sk#0 = d_date_sk#33977)) && ((cc_call_center_sk#34052 = cs_call_center_sk#11) && (((d_year#33983 = 1999) || ((d_year#33983 = (1999 - 1)) && (d_moy#33985 = 12))) || ((d_year#33983 = (1999 + 1)) && (d_moy#33985 = 1)))))
                                                +- Join Inner
                                                   :- Join Inner
                                                   :  :- Join Inner
                                                   :  :  :- SubqueryAlias `item`
                                                   :  :  :  +- Relation[i_item_sk#33884,i_item_id#33885,i_rec_start_date#33886,i_rec_end_date#33887,i_item_desc#33888,i_current_price#33889,i_wholesale_cost#33890,i_brand_id#33891,i_brand#33892,i_class_id#33893,i_class#33894,i_category_id#33895,i_category#33896,i_manufact_id#33897,i_manufact#33898,i_size#33899,i_formulation#33900,i_color#33901,i_units#33902,i_container#33903,i_manager_id#33904,i_product_name#33905] parquet
                                                   :  :  +- SubqueryAlias `catalog_sales`
                                                   :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                                                   :  +- SubqueryAlias `date_dim`
                                                   :     +- Relation[d_date_sk#33977,d_date_id#33978,d_date#33979,d_month_seq#33980,d_week_seq#33981,d_quarter_seq#33982,d_year#33983,d_dow#33984,d_moy#33985,d_dom#33986,d_qoy#33987,d_fy_year#33988,d_fy_quarter_seq#33989,d_fy_week_seq#33990,d_day_name#33991,d_quarter_name#33992,d_holiday#33993,d_weekend#33994,d_following_holiday#33995,d_first_dom#33996,d_last_dom#33997,d_same_day_ly#33998,d_same_day_lq#33999,d_current_day#34000,... 4 more fields] parquet
                                                   +- SubqueryAlias `call_center`
                                                      +- Relation[cc_call_center_sk#34052,cc_call_center_id#34053,cc_rec_start_date#34054,cc_rec_end_date#34055,cc_closed_date_sk#34056,cc_open_date_sk#34057,cc_name#34058,cc_class#34059,cc_employees#34060,cc_sq_ft#34061,cc_hours#34062,cc_manager#34063,cc_mkt_id#34064,cc_mkt_class#34065,cc_mkt_desc#34066,cc_market_manager#34067,cc_division#34068,cc_division_name#34069,cc_company#34070,cc_company_name#34071,cc_street_number#34072,cc_street_name#34073,cc_street_type#34074,cc_suite_number#34075,... 7 more fields] parquet

     : benchmark
19/09/08 19:53:04 INFO Query:
== Query: q57-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#34188 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#34189 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, cc_name#338 ASC NULLS FIRST], true
      +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, avg_monthly_sales#34189, sum_sales#34188, psum#34191, nsum#34192]
         +- Filter (((d_year#498 = 1999) && (cast(avg_monthly_sales#34189 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6)))) && (cast(CASE WHEN (cast(avg_monthly_sales#34189 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#34188 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#34189 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#34189 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16))))
            +- SubqueryAlias `v2`
               +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, avg_monthly_sales#34189, sum_sales#34188, sum_sales#34400 AS psum#34191, sum_sales#34887 AS nsum#34192]
                  +- Filter ((((i_category#576 = i_category#34507) && (i_category#576 = i_category#34994)) && ((i_brand#572 = i_brand#34503) && (i_brand#572 = i_brand#34990))) && (((cc_name#338 = cc_name#34669) && (cc_name#338 = cc_name#35156)) && ((rn#34190 = (rn#34304 + 1)) && (rn#34190 = (rn#34791 - 1)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `v1`
                        :  :  +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, sum_sales#34188, avg_monthly_sales#34189, rn#34190]
                        :  :     +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, sum_sales#34188, _w0#34202, rn#34190, avg_monthly_sales#34189, avg_monthly_sales#34189, rn#34190]
                        :  :        +- Window [avg(_w0#34202) windowspecdefinition(i_category#576, i_brand#572, cc_name#338, d_year#498, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#34189], [i_category#576, i_brand#572, cc_name#338, d_year#498]
                        :  :           +- Window [rank(d_year#498, d_moy#500) windowspecdefinition(i_category#576, i_brand#572, cc_name#338, d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#34190], [i_category#576, i_brand#572, cc_name#338], [d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST]
                        :  :              +- Aggregate [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500], [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, sum(cs_sales_price#21) AS sum_sales#34188, sum(cs_sales_price#21) AS _w0#34202]
                        :  :                 +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((cc_call_center_sk#332 = cs_call_center_sk#11) && (((d_year#498 = 1999) || ((d_year#498 = (1999 - 1)) && (d_moy#500 = 12))) || ((d_year#498 = (1999 + 1)) && (d_moy#500 = 1)))))
                        :  :                    +- Join Inner
                        :  :                       :- Join Inner
                        :  :                       :  :- Join Inner
                        :  :                       :  :  :- SubqueryAlias `item`
                        :  :                       :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        :  :                       :  :  +- SubqueryAlias `catalog_sales`
                        :  :                       :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :                       :  +- SubqueryAlias `date_dim`
                        :  :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :                       +- SubqueryAlias `call_center`
                        :  :                          +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet
                        :  +- SubqueryAlias `v1_lag`
                        :     +- SubqueryAlias `v1`
                        :        +- Project [i_category#34507, i_brand#34503, cc_name#34669, d_year#34594, d_moy#34596, sum_sales#34400, avg_monthly_sales#34207, rn#34304]
                        :           +- Project [i_category#34507, i_brand#34503, cc_name#34669, d_year#34594, d_moy#34596, sum_sales#34400, _w0#34401, rn#34304, avg_monthly_sales#34207, avg_monthly_sales#34207, rn#34304]
                        :              +- Window [avg(_w0#34401) windowspecdefinition(i_category#34507, i_brand#34503, cc_name#34669, d_year#34594, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#34207], [i_category#34507, i_brand#34503, cc_name#34669, d_year#34594]
                        :                 +- Window [rank(d_year#34594, d_moy#34596) windowspecdefinition(i_category#34507, i_brand#34503, cc_name#34669, d_year#34594 ASC NULLS FIRST, d_moy#34596 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#34304], [i_category#34507, i_brand#34503, cc_name#34669], [d_year#34594 ASC NULLS FIRST, d_moy#34596 ASC NULLS FIRST]
                        :                    +- Aggregate [i_category#34507, i_brand#34503, cc_name#34669, d_year#34594, d_moy#34596], [i_category#34507, i_brand#34503, cc_name#34669, d_year#34594, d_moy#34596, sum(cs_sales_price#21) AS sum_sales#34400, sum(cs_sales_price#21) AS _w0#34401]
                        :                       +- Filter (((cs_item_sk#15 = i_item_sk#34495) && (cs_sold_date_sk#0 = d_date_sk#34588)) && ((cc_call_center_sk#34663 = cs_call_center_sk#11) && (((d_year#34594 = 1999) || ((d_year#34594 = (1999 - 1)) && (d_moy#34596 = 12))) || ((d_year#34594 = (1999 + 1)) && (d_moy#34596 = 1)))))
                        :                          +- Join Inner
                        :                             :- Join Inner
                        :                             :  :- Join Inner
                        :                             :  :  :- SubqueryAlias `item`
                        :                             :  :  :  +- Relation[i_item_sk#34495,i_item_id#34496,i_rec_start_date#34497,i_rec_end_date#34498,i_item_desc#34499,i_current_price#34500,i_wholesale_cost#34501,i_brand_id#34502,i_brand#34503,i_class_id#34504,i_class#34505,i_category_id#34506,i_category#34507,i_manufact_id#34508,i_manufact#34509,i_size#34510,i_formulation#34511,i_color#34512,i_units#34513,i_container#34514,i_manager_id#34515,i_product_name#34516] parquet
                        :                             :  :  +- SubqueryAlias `catalog_sales`
                        :                             :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :                             :  +- SubqueryAlias `date_dim`
                        :                             :     +- Relation[d_date_sk#34588,d_date_id#34589,d_date#34590,d_month_seq#34591,d_week_seq#34592,d_quarter_seq#34593,d_year#34594,d_dow#34595,d_moy#34596,d_dom#34597,d_qoy#34598,d_fy_year#34599,d_fy_quarter_seq#34600,d_fy_week_seq#34601,d_day_name#34602,d_quarter_name#34603,d_holiday#34604,d_weekend#34605,d_following_holiday#34606,d_first_dom#34607,d_last_dom#34608,d_same_day_ly#34609,d_same_day_lq#34610,d_current_day#34611,... 4 more fields] parquet
                        :                             +- SubqueryAlias `call_center`
                        :                                +- Relation[cc_call_center_sk#34663,cc_call_center_id#34664,cc_rec_start_date#34665,cc_rec_end_date#34666,cc_closed_date_sk#34667,cc_open_date_sk#34668,cc_name#34669,cc_class#34670,cc_employees#34671,cc_sq_ft#34672,cc_hours#34673,cc_manager#34674,cc_mkt_id#34675,cc_mkt_class#34676,cc_mkt_desc#34677,cc_market_manager#34678,cc_division#34679,cc_division_name#34680,cc_company#34681,cc_company_name#34682,cc_street_number#34683,cc_street_name#34684,cc_street_type#34685,cc_suite_number#34686,... 7 more fields] parquet
                        +- SubqueryAlias `v1_lead`
                           +- SubqueryAlias `v1`
                              +- Project [i_category#34994, i_brand#34990, cc_name#35156, d_year#35081, d_moy#35083, sum_sales#34887, avg_monthly_sales#34694, rn#34791]
                                 +- Project [i_category#34994, i_brand#34990, cc_name#35156, d_year#35081, d_moy#35083, sum_sales#34887, _w0#34888, rn#34791, avg_monthly_sales#34694, avg_monthly_sales#34694, rn#34791]
                                    +- Window [avg(_w0#34888) windowspecdefinition(i_category#34994, i_brand#34990, cc_name#35156, d_year#35081, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#34694], [i_category#34994, i_brand#34990, cc_name#35156, d_year#35081]
                                       +- Window [rank(d_year#35081, d_moy#35083) windowspecdefinition(i_category#34994, i_brand#34990, cc_name#35156, d_year#35081 ASC NULLS FIRST, d_moy#35083 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#34791], [i_category#34994, i_brand#34990, cc_name#35156], [d_year#35081 ASC NULLS FIRST, d_moy#35083 ASC NULLS FIRST]
                                          +- Aggregate [i_category#34994, i_brand#34990, cc_name#35156, d_year#35081, d_moy#35083], [i_category#34994, i_brand#34990, cc_name#35156, d_year#35081, d_moy#35083, sum(cs_sales_price#21) AS sum_sales#34887, sum(cs_sales_price#21) AS _w0#34888]
                                             +- Filter (((cs_item_sk#15 = i_item_sk#34982) && (cs_sold_date_sk#0 = d_date_sk#35075)) && ((cc_call_center_sk#35150 = cs_call_center_sk#11) && (((d_year#35081 = 1999) || ((d_year#35081 = (1999 - 1)) && (d_moy#35083 = 12))) || ((d_year#35081 = (1999 + 1)) && (d_moy#35083 = 1)))))
                                                +- Join Inner
                                                   :- Join Inner
                                                   :  :- Join Inner
                                                   :  :  :- SubqueryAlias `item`
                                                   :  :  :  +- Relation[i_item_sk#34982,i_item_id#34983,i_rec_start_date#34984,i_rec_end_date#34985,i_item_desc#34986,i_current_price#34987,i_wholesale_cost#34988,i_brand_id#34989,i_brand#34990,i_class_id#34991,i_class#34992,i_category_id#34993,i_category#34994,i_manufact_id#34995,i_manufact#34996,i_size#34997,i_formulation#34998,i_color#34999,i_units#35000,i_container#35001,i_manager_id#35002,i_product_name#35003] parquet
                                                   :  :  +- SubqueryAlias `catalog_sales`
                                                   :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                                                   :  +- SubqueryAlias `date_dim`
                                                   :     +- Relation[d_date_sk#35075,d_date_id#35076,d_date#35077,d_month_seq#35078,d_week_seq#35079,d_quarter_seq#35080,d_year#35081,d_dow#35082,d_moy#35083,d_dom#35084,d_qoy#35085,d_fy_year#35086,d_fy_quarter_seq#35087,d_fy_week_seq#35088,d_day_name#35089,d_quarter_name#35090,d_holiday#35091,d_weekend#35092,d_following_holiday#35093,d_first_dom#35094,d_last_dom#35095,d_same_day_ly#35096,d_same_day_lq#35097,d_current_day#35098,... 4 more fields] parquet
                                                   +- SubqueryAlias `call_center`
                                                      +- Relation[cc_call_center_sk#35150,cc_call_center_id#35151,cc_rec_start_date#35152,cc_rec_end_date#35153,cc_closed_date_sk#35154,cc_open_date_sk#35155,cc_name#35156,cc_class#35157,cc_employees#35158,cc_sq_ft#35159,cc_hours#35160,cc_manager#35161,cc_mkt_id#35162,cc_mkt_class#35163,cc_mkt_desc#35164,cc_market_manager#35165,cc_division#35166,cc_division_name#35167,cc_company#35168,cc_company_name#35169,cc_street_number#35170,cc_street_name#35171,cc_street_type#35172,cc_suite_number#35173,... 7 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 14.584598666s
Running execution q58-v2.4 iteration: 1, StandardRun=true
19/09/08 19:53:21 INFO Query:
== Query: q58-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_id#37545 ASC NULLS FIRST, ss_item_rev#37546 ASC NULLS FIRST], true
      +- Project [item_id#37545, ss_item_rev#37546, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37546 as decimal(19,2))) / promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37546 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37550 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37554 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2)))), DecimalType(38,21)) as decimal(38,21))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(38,21)))), DecimalType(38,21)) as decimal(38,21))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(38,21)))), DecimalType(38,17)) AS ss_dev#37541, cs_item_rev#37550, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_item_rev#37550 as decimal(19,2))) / promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37546 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37550 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37554 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2)))), DecimalType(38,21)) as decimal(38,21))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(38,21)))), DecimalType(38,21)) as decimal(38,21))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(38,21)))), DecimalType(38,17)) AS cs_dev#37542, ws_item_rev#37554, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_item_rev#37554 as decimal(19,2))) / promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37546 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37550 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37554 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2)))), DecimalType(38,21)) as decimal(38,21))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(38,21)))), DecimalType(38,21)) as decimal(38,21))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(38,21)))), DecimalType(38,17)) AS ws_dev#37543, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37546 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37550 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37554 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(19,2)))), DecimalType(23,6)) AS average#37544]
         +- Filter ((((item_id#37545 = item_id#37549) && (item_id#37545 = item_id#37553)) && (((cast(ss_item_rev#37546 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37550 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ss_item_rev#37546 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37550 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))) && ((cast(ss_item_rev#37546 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37554 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ss_item_rev#37546 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37554 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))))) && ((((cast(cs_item_rev#37550 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37546 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(cs_item_rev#37550 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37546 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))) && ((cast(cs_item_rev#37550 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37554 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(cs_item_rev#37550 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37554 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3))))) && (((cast(ws_item_rev#37554 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37546 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ws_item_rev#37554 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37546 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))) && ((cast(ws_item_rev#37554 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37550 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ws_item_rev#37554 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37550 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))))))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ss_items`
               :  :  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#37545, sum(ss_ext_sales_price#145) AS ss_item_rev#37546]
               :  :     +- Filter (((ss_item_sk#132 = i_item_sk#564) && d_date#494 IN (list#37548 [])) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :        :  +- Project [d_date#494]
               :  :        :     +- Filter (d_week_seq#496 = scalar-subquery#37547 [])
               :  :        :        :  +- Project [d_week_seq#496]
               :  :        :        :     +- Filter (d_date#494 = cast(2000-01-03 as date))
               :  :        :        :        +- SubqueryAlias `date_dim`
               :  :        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        :        +- SubqueryAlias `date_dim`
               :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- SubqueryAlias `store_sales`
               :  :           :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  +- SubqueryAlias `item`
               :  :           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- SubqueryAlias `date_dim`
               :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `cs_items`
               :     +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#37549, sum(cs_ext_sales_price#23) AS cs_item_rev#37550]
               :        +- Filter (((cs_item_sk#15 = i_item_sk#564) && d_date#494 IN (list#37552 [])) && (cs_sold_date_sk#0 = d_date_sk#492))
               :           :  +- Project [d_date#494]
               :           :     +- Filter (d_week_seq#496 = scalar-subquery#37551 [])
               :           :        :  +- Project [d_week_seq#496]
               :           :        :     +- Filter (d_date#494 = cast(2000-01-03 as date))
               :           :        :        +- SubqueryAlias `date_dim`
               :           :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Join Inner
               :              :- Join Inner
               :              :  :- SubqueryAlias `catalog_sales`
               :              :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :              :  +- SubqueryAlias `item`
               :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- SubqueryAlias `date_dim`
               :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `ws_items`
                  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#37553, sum(ws_ext_sales_price#239) AS ws_item_rev#37554]
                     +- Filter (((ws_item_sk#219 = i_item_sk#564) && d_date#494 IN (list#37556 [])) && (ws_sold_date_sk#216 = d_date_sk#492))
                        :  +- Project [d_date#494]
                        :     +- Filter (d_week_seq#496 = scalar-subquery#37555 [])
                        :        :  +- Project [d_week_seq#496]
                        :        :     +- Filter (d_date#494 = cast(2000-01-03 as date))
                        :        :        +- SubqueryAlias `date_dim`
                        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `web_sales`
                           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :  +- SubqueryAlias `item`
                           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 19:53:21 INFO Query:
== Query: q58-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_id#37572 ASC NULLS FIRST, ss_item_rev#37573 ASC NULLS FIRST], true
      +- Project [item_id#37572, ss_item_rev#37573, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37573 as decimal(19,2))) / promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37573 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37577 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37581 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2)))), DecimalType(38,21)) as decimal(38,21))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(38,21)))), DecimalType(38,21)) as decimal(38,21))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(38,21)))), DecimalType(38,17)) AS ss_dev#37568, cs_item_rev#37577, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_item_rev#37577 as decimal(19,2))) / promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37573 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37577 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37581 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2)))), DecimalType(38,21)) as decimal(38,21))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(38,21)))), DecimalType(38,21)) as decimal(38,21))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(38,21)))), DecimalType(38,17)) AS cs_dev#37569, ws_item_rev#37581, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_item_rev#37581 as decimal(19,2))) / promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37573 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37577 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37581 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2)))), DecimalType(38,21)) as decimal(38,21))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(38,21)))), DecimalType(38,21)) as decimal(38,21))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(38,21)))), DecimalType(38,17)) AS ws_dev#37570, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37573 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37577 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37581 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(19,2)))), DecimalType(23,6)) AS average#37571]
         +- Filter ((((item_id#37572 = item_id#37576) && (item_id#37572 = item_id#37580)) && (((cast(ss_item_rev#37573 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37577 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ss_item_rev#37573 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37577 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))) && ((cast(ss_item_rev#37573 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37581 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ss_item_rev#37573 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37581 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))))) && ((((cast(cs_item_rev#37577 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37573 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(cs_item_rev#37577 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37573 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))) && ((cast(cs_item_rev#37577 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37581 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(cs_item_rev#37577 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37581 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3))))) && (((cast(ws_item_rev#37581 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37573 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ws_item_rev#37581 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37573 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))) && ((cast(ws_item_rev#37581 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37577 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ws_item_rev#37581 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37577 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))))))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ss_items`
               :  :  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#37572, sum(ss_ext_sales_price#145) AS ss_item_rev#37573]
               :  :     +- Filter (((ss_item_sk#132 = i_item_sk#564) && d_date#494 IN (list#37575 [])) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :        :  +- Project [d_date#494]
               :  :        :     +- Filter (d_week_seq#496 = scalar-subquery#37574 [])
               :  :        :        :  +- Project [d_week_seq#496]
               :  :        :        :     +- Filter (d_date#494 = cast(2000-01-03 as date))
               :  :        :        :        +- SubqueryAlias `date_dim`
               :  :        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        :        +- SubqueryAlias `date_dim`
               :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- SubqueryAlias `store_sales`
               :  :           :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  +- SubqueryAlias `item`
               :  :           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- SubqueryAlias `date_dim`
               :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `cs_items`
               :     +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#37576, sum(cs_ext_sales_price#23) AS cs_item_rev#37577]
               :        +- Filter (((cs_item_sk#15 = i_item_sk#564) && d_date#494 IN (list#37579 [])) && (cs_sold_date_sk#0 = d_date_sk#492))
               :           :  +- Project [d_date#494]
               :           :     +- Filter (d_week_seq#496 = scalar-subquery#37578 [])
               :           :        :  +- Project [d_week_seq#496]
               :           :        :     +- Filter (d_date#494 = cast(2000-01-03 as date))
               :           :        :        +- SubqueryAlias `date_dim`
               :           :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Join Inner
               :              :- Join Inner
               :              :  :- SubqueryAlias `catalog_sales`
               :              :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :              :  +- SubqueryAlias `item`
               :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- SubqueryAlias `date_dim`
               :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `ws_items`
                  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#37580, sum(ws_ext_sales_price#239) AS ws_item_rev#37581]
                     +- Filter (((ws_item_sk#219 = i_item_sk#564) && d_date#494 IN (list#37583 [])) && (ws_sold_date_sk#216 = d_date_sk#492))
                        :  +- Project [d_date#494]
                        :     +- Filter (d_week_seq#496 = scalar-subquery#37582 [])
                        :        :  +- Project [d_week_seq#496]
                        :        :     +- Filter (d_date#494 = cast(2000-01-03 as date))
                        :        :        +- SubqueryAlias `date_dim`
                        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `web_sales`
                           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :  +- SubqueryAlias `item`
                           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 20.282178006s
Running execution q59-v2.4 iteration: 1, StandardRun=true
19/09/08 19:53:44 INFO Query:
== Query: q59-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name1#37811 ASC NULLS FIRST, s_store_id1#37813 ASC NULLS FIRST, d_week_seq1#37812 ASC NULLS FIRST], true
      +- Project [s_store_name1#37811, s_store_id1#37813, d_week_seq1#37812, CheckOverflow((promote_precision(cast(sun_sales1#37814 as decimal(17,2))) / promote_precision(cast(sun_sales2#37824 as decimal(17,2)))), DecimalType(37,20)) AS (sun_sales1 / sun_sales2)#37901, CheckOverflow((promote_precision(cast(mon_sales1#37815 as decimal(17,2))) / promote_precision(cast(mon_sales2#37825 as decimal(17,2)))), DecimalType(37,20)) AS (mon_sales1 / mon_sales2)#37902, CheckOverflow((promote_precision(cast(tue_sales1#37816 as decimal(17,2))) / promote_precision(cast(tue_sales2#37826 as decimal(17,2)))), DecimalType(37,20)) AS (tue_sales1 / tue_sales2)#37903, CheckOverflow((promote_precision(cast(wed_sales1#37817 as decimal(17,2))) / promote_precision(cast(wed_sales2#37827 as decimal(17,2)))), DecimalType(37,20)) AS (wed_sales1 / wed_sales2)#37904, CheckOverflow((promote_precision(cast(thu_sales1#37818 as decimal(17,2))) / promote_precision(cast(thu_sales2#37828 as decimal(17,2)))), DecimalType(37,20)) AS (thu_sales1 / thu_sales2)#37905, CheckOverflow((promote_precision(cast(fri_sales1#37819 as decimal(17,2))) / promote_precision(cast(fri_sales2#37829 as decimal(17,2)))), DecimalType(37,20)) AS (fri_sales1 / fri_sales2)#37906, CheckOverflow((promote_precision(cast(sat_sales1#37820 as decimal(17,2))) / promote_precision(cast(sat_sales2#37830 as decimal(17,2)))), DecimalType(37,20)) AS (sat_sales1 / sat_sales2)#37907]
         +- Filter ((s_store_id1#37813 = s_store_id2#37823) && (d_week_seq1#37812 = (d_week_seq2#37822 - 52)))
            +- Join Inner
               :- SubqueryAlias `y`
               :  +- Project [s_store_name#669 AS s_store_name1#37811, d_week_seq#496 AS d_week_seq1#37812, s_store_id#665 AS s_store_id1#37813, sun_sales#37831 AS sun_sales1#37814, mon_sales#37832 AS mon_sales1#37815, tue_sales#37833 AS tue_sales1#37816, wed_sales#37834 AS wed_sales1#37817, thu_sales#37835 AS thu_sales1#37818, fri_sales#37836 AS fri_sales1#37819, sat_sales#37837 AS sat_sales1#37820]
               :     +- Filter (((d_week_seq#37849 = d_week_seq#496) && (ss_store_sk#137 = s_store_sk#664)) && ((d_month_seq#37848 >= 1212) && (d_month_seq#37848 <= (1212 + 11))))
               :        +- Join Inner
               :           :- Join Inner
               :           :  :- SubqueryAlias `wss`
               :           :  :  +- Aggregate [d_week_seq#496, ss_store_sk#137], [d_week_seq#496, ss_store_sk#137, sum(CASE WHEN (d_day_name#506 = Sunday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sun_sales#37831, sum(CASE WHEN (d_day_name#506 = Monday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS mon_sales#37832, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS tue_sales#37833, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS wed_sales#37834, sum(CASE WHEN (d_day_name#506 = Thursday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS thu_sales#37835, sum(CASE WHEN (d_day_name#506 = Friday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS fri_sales#37836, sum(CASE WHEN (d_day_name#506 = Saturday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sat_sales#37837]
               :           :  :     +- Filter (d_date_sk#492 = ss_sold_date_sk#130)
               :           :  :        +- Join Inner
               :           :  :           :- SubqueryAlias `store_sales`
               :           :  :           :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :  :           +- SubqueryAlias `date_dim`
               :           :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :  +- SubqueryAlias `store`
               :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :           +- SubqueryAlias `d`
               :              +- SubqueryAlias `date_dim`
               :                 +- Relation[d_date_sk#37845,d_date_id#37846,d_date#37847,d_month_seq#37848,d_week_seq#37849,d_quarter_seq#37850,d_year#37851,d_dow#37852,d_moy#37853,d_dom#37854,d_qoy#37855,d_fy_year#37856,d_fy_quarter_seq#37857,d_fy_week_seq#37858,d_day_name#37859,d_quarter_name#37860,d_holiday#37861,d_weekend#37862,d_following_holiday#37863,d_first_dom#37864,d_last_dom#37865,d_same_day_ly#37866,d_same_day_lq#37867,d_current_day#37868,... 4 more fields] parquet
               +- SubqueryAlias `x`
                  +- Project [s_store_name#669 AS s_store_name2#37821, d_week_seq#496 AS d_week_seq2#37822, s_store_id#665 AS s_store_id2#37823, sun_sales#37831 AS sun_sales2#37824, mon_sales#37832 AS mon_sales2#37825, tue_sales#37833 AS tue_sales2#37826, wed_sales#37834 AS wed_sales2#37827, thu_sales#37835 AS thu_sales2#37828, fri_sales#37836 AS fri_sales2#37829, sat_sales#37837 AS sat_sales2#37830]
                     +- Filter (((d_week_seq#37877 = d_week_seq#496) && (ss_store_sk#137 = s_store_sk#664)) && ((d_month_seq#37876 >= (1212 + 12)) && (d_month_seq#37876 <= (1212 + 23))))
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `wss`
                           :  :  +- Aggregate [d_week_seq#496, ss_store_sk#137], [d_week_seq#496, ss_store_sk#137, sum(CASE WHEN (d_day_name#506 = Sunday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sun_sales#37831, sum(CASE WHEN (d_day_name#506 = Monday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS mon_sales#37832, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS tue_sales#37833, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS wed_sales#37834, sum(CASE WHEN (d_day_name#506 = Thursday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS thu_sales#37835, sum(CASE WHEN (d_day_name#506 = Friday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS fri_sales#37836, sum(CASE WHEN (d_day_name#506 = Saturday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sat_sales#37837]
                           :  :     +- Filter (d_date_sk#492 = ss_sold_date_sk#130)
                           :  :        +- Join Inner
                           :  :           :- SubqueryAlias `store_sales`
                           :  :           :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :  :           +- SubqueryAlias `date_dim`
                           :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :  +- SubqueryAlias `store`
                           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           +- SubqueryAlias `d`
                              +- SubqueryAlias `date_dim`
                                 +- Relation[d_date_sk#37873,d_date_id#37874,d_date#37875,d_month_seq#37876,d_week_seq#37877,d_quarter_seq#37878,d_year#37879,d_dow#37880,d_moy#37881,d_dom#37882,d_qoy#37883,d_fy_year#37884,d_fy_quarter_seq#37885,d_fy_week_seq#37886,d_day_name#37887,d_quarter_name#37888,d_holiday#37889,d_weekend#37890,d_following_holiday#37891,d_first_dom#37892,d_last_dom#37893,d_same_day_ly#37894,d_same_day_lq#37895,d_current_day#37896,... 4 more fields] parquet

     : benchmark
19/09/08 19:53:44 INFO Query:
== Query: q59-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name1#37918 ASC NULLS FIRST, s_store_id1#37920 ASC NULLS FIRST, d_week_seq1#37919 ASC NULLS FIRST], true
      +- Project [s_store_name1#37918, s_store_id1#37920, d_week_seq1#37919, CheckOverflow((promote_precision(cast(sun_sales1#37921 as decimal(17,2))) / promote_precision(cast(sun_sales2#37931 as decimal(17,2)))), DecimalType(37,20)) AS (sun_sales1 / sun_sales2)#38008, CheckOverflow((promote_precision(cast(mon_sales1#37922 as decimal(17,2))) / promote_precision(cast(mon_sales2#37932 as decimal(17,2)))), DecimalType(37,20)) AS (mon_sales1 / mon_sales2)#38009, CheckOverflow((promote_precision(cast(tue_sales1#37923 as decimal(17,2))) / promote_precision(cast(tue_sales2#37933 as decimal(17,2)))), DecimalType(37,20)) AS (tue_sales1 / tue_sales2)#38010, CheckOverflow((promote_precision(cast(wed_sales1#37924 as decimal(17,2))) / promote_precision(cast(wed_sales2#37934 as decimal(17,2)))), DecimalType(37,20)) AS (wed_sales1 / wed_sales2)#38011, CheckOverflow((promote_precision(cast(thu_sales1#37925 as decimal(17,2))) / promote_precision(cast(thu_sales2#37935 as decimal(17,2)))), DecimalType(37,20)) AS (thu_sales1 / thu_sales2)#38012, CheckOverflow((promote_precision(cast(fri_sales1#37926 as decimal(17,2))) / promote_precision(cast(fri_sales2#37936 as decimal(17,2)))), DecimalType(37,20)) AS (fri_sales1 / fri_sales2)#38013, CheckOverflow((promote_precision(cast(sat_sales1#37927 as decimal(17,2))) / promote_precision(cast(sat_sales2#37937 as decimal(17,2)))), DecimalType(37,20)) AS (sat_sales1 / sat_sales2)#38014]
         +- Filter ((s_store_id1#37920 = s_store_id2#37930) && (d_week_seq1#37919 = (d_week_seq2#37929 - 52)))
            +- Join Inner
               :- SubqueryAlias `y`
               :  +- Project [s_store_name#669 AS s_store_name1#37918, d_week_seq#496 AS d_week_seq1#37919, s_store_id#665 AS s_store_id1#37920, sun_sales#37938 AS sun_sales1#37921, mon_sales#37939 AS mon_sales1#37922, tue_sales#37940 AS tue_sales1#37923, wed_sales#37941 AS wed_sales1#37924, thu_sales#37942 AS thu_sales1#37925, fri_sales#37943 AS fri_sales1#37926, sat_sales#37944 AS sat_sales1#37927]
               :     +- Filter (((d_week_seq#37956 = d_week_seq#496) && (ss_store_sk#137 = s_store_sk#664)) && ((d_month_seq#37955 >= 1212) && (d_month_seq#37955 <= (1212 + 11))))
               :        +- Join Inner
               :           :- Join Inner
               :           :  :- SubqueryAlias `wss`
               :           :  :  +- Aggregate [d_week_seq#496, ss_store_sk#137], [d_week_seq#496, ss_store_sk#137, sum(CASE WHEN (d_day_name#506 = Sunday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sun_sales#37938, sum(CASE WHEN (d_day_name#506 = Monday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS mon_sales#37939, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS tue_sales#37940, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS wed_sales#37941, sum(CASE WHEN (d_day_name#506 = Thursday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS thu_sales#37942, sum(CASE WHEN (d_day_name#506 = Friday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS fri_sales#37943, sum(CASE WHEN (d_day_name#506 = Saturday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sat_sales#37944]
               :           :  :     +- Filter (d_date_sk#492 = ss_sold_date_sk#130)
               :           :  :        +- Join Inner
               :           :  :           :- SubqueryAlias `store_sales`
               :           :  :           :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :  :           +- SubqueryAlias `date_dim`
               :           :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :  +- SubqueryAlias `store`
               :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :           +- SubqueryAlias `d`
               :              +- SubqueryAlias `date_dim`
               :                 +- Relation[d_date_sk#37952,d_date_id#37953,d_date#37954,d_month_seq#37955,d_week_seq#37956,d_quarter_seq#37957,d_year#37958,d_dow#37959,d_moy#37960,d_dom#37961,d_qoy#37962,d_fy_year#37963,d_fy_quarter_seq#37964,d_fy_week_seq#37965,d_day_name#37966,d_quarter_name#37967,d_holiday#37968,d_weekend#37969,d_following_holiday#37970,d_first_dom#37971,d_last_dom#37972,d_same_day_ly#37973,d_same_day_lq#37974,d_current_day#37975,... 4 more fields] parquet
               +- SubqueryAlias `x`
                  +- Project [s_store_name#669 AS s_store_name2#37928, d_week_seq#496 AS d_week_seq2#37929, s_store_id#665 AS s_store_id2#37930, sun_sales#37938 AS sun_sales2#37931, mon_sales#37939 AS mon_sales2#37932, tue_sales#37940 AS tue_sales2#37933, wed_sales#37941 AS wed_sales2#37934, thu_sales#37942 AS thu_sales2#37935, fri_sales#37943 AS fri_sales2#37936, sat_sales#37944 AS sat_sales2#37937]
                     +- Filter (((d_week_seq#37984 = d_week_seq#496) && (ss_store_sk#137 = s_store_sk#664)) && ((d_month_seq#37983 >= (1212 + 12)) && (d_month_seq#37983 <= (1212 + 23))))
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `wss`
                           :  :  +- Aggregate [d_week_seq#496, ss_store_sk#137], [d_week_seq#496, ss_store_sk#137, sum(CASE WHEN (d_day_name#506 = Sunday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sun_sales#37938, sum(CASE WHEN (d_day_name#506 = Monday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS mon_sales#37939, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS tue_sales#37940, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS wed_sales#37941, sum(CASE WHEN (d_day_name#506 = Thursday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS thu_sales#37942, sum(CASE WHEN (d_day_name#506 = Friday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS fri_sales#37943, sum(CASE WHEN (d_day_name#506 = Saturday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sat_sales#37944]
                           :  :     +- Filter (d_date_sk#492 = ss_sold_date_sk#130)
                           :  :        +- Join Inner
                           :  :           :- SubqueryAlias `store_sales`
                           :  :           :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :  :           +- SubqueryAlias `date_dim`
                           :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :  +- SubqueryAlias `store`
                           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           +- SubqueryAlias `d`
                              +- SubqueryAlias `date_dim`
                                 +- Relation[d_date_sk#37980,d_date_id#37981,d_date#37982,d_month_seq#37983,d_week_seq#37984,d_quarter_seq#37985,d_year#37986,d_dow#37987,d_moy#37988,d_dom#37989,d_qoy#37990,d_fy_year#37991,d_fy_quarter_seq#37992,d_fy_week_seq#37993,d_day_name#37994,d_quarter_name#37995,d_holiday#37996,d_weekend#37997,d_following_holiday#37998,d_first_dom#37999,d_last_dom#38000,d_same_day_ly#38001,d_same_day_lq#38002,d_current_day#38003,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 22.314730942999997s
Running execution q60-v2.4 iteration: 1, StandardRun=true
19/09/08 19:54:08 INFO Query:
== Query: q60-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST, total_sales#38311 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565], [i_item_id#565, sum(total_sales#38312) AS total_sales#38311]
         +- SubqueryAlias `tmp1`
            +- Union
               :- Union
               :  :- Project [i_item_id#565, total_sales#38312]
               :  :  +- SubqueryAlias `ss`
               :  :     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ss_ext_sales_price#145) AS total_sales#38312]
               :  :        +- Filter (((i_item_id#565 IN (list#38313 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 9) && (ss_addr_sk#136 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :  :           :  +- Project [i_item_id#565]
               :  :           :     +- Filter i_category#576 IN (Music)
               :  :           :        +- SubqueryAlias `item`
               :  :           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- Join Inner
               :  :              :  :  :- SubqueryAlias `store_sales`
               :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :              :  :  +- SubqueryAlias `date_dim`
               :  :              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              :  +- SubqueryAlias `customer_address`
               :  :              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  :              +- SubqueryAlias `item`
               :  :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- Project [i_item_id#565, total_sales#38314]
               :     +- SubqueryAlias `cs`
               :        +- Aggregate [i_item_id#565], [i_item_id#565, sum(cs_ext_sales_price#23) AS total_sales#38314]
               :           +- Filter (((i_item_id#565 IN (list#38315 []) && (cs_item_sk#15 = i_item_sk#564)) && ((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 9) && (cs_bill_addr_sk#6 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :              :  +- Project [i_item_id#565]
               :              :     +- Filter i_category#576 IN (Music)
               :              :        +- SubqueryAlias `item`
               :              :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- Join Inner
               :                 :  :  :- SubqueryAlias `catalog_sales`
               :                 :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :  :  +- SubqueryAlias `date_dim`
               :                 :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :  +- SubqueryAlias `customer_address`
               :                 :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :                 +- SubqueryAlias `item`
               :                    +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Project [i_item_id#565, total_sales#38316]
                  +- SubqueryAlias `ws`
                     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ws_ext_sales_price#239) AS total_sales#38316]
                        +- Filter (((i_item_id#565 IN (list#38317 []) && (ws_item_sk#219 = i_item_sk#564)) && ((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 9) && (ws_bill_addr_sk#223 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
                           :  +- Project [i_item_id#565]
                           :     +- Filter i_category#576 IN (Music)
                           :        +- SubqueryAlias `item`
                           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `web_sales`
                              :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :  +- SubqueryAlias `date_dim`
                              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `customer_address`
                              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 19:54:08 INFO Query:
== Query: q60-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST, total_sales#38326 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565], [i_item_id#565, sum(total_sales#38327) AS total_sales#38326]
         +- SubqueryAlias `tmp1`
            +- Union
               :- Union
               :  :- Project [i_item_id#565, total_sales#38327]
               :  :  +- SubqueryAlias `ss`
               :  :     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ss_ext_sales_price#145) AS total_sales#38327]
               :  :        +- Filter (((i_item_id#565 IN (list#38328 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 9) && (ss_addr_sk#136 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :  :           :  +- Project [i_item_id#565]
               :  :           :     +- Filter i_category#576 IN (Music)
               :  :           :        +- SubqueryAlias `item`
               :  :           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- Join Inner
               :  :              :  :  :- SubqueryAlias `store_sales`
               :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :              :  :  +- SubqueryAlias `date_dim`
               :  :              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              :  +- SubqueryAlias `customer_address`
               :  :              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  :              +- SubqueryAlias `item`
               :  :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- Project [i_item_id#565, total_sales#38329]
               :     +- SubqueryAlias `cs`
               :        +- Aggregate [i_item_id#565], [i_item_id#565, sum(cs_ext_sales_price#23) AS total_sales#38329]
               :           +- Filter (((i_item_id#565 IN (list#38330 []) && (cs_item_sk#15 = i_item_sk#564)) && ((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 9) && (cs_bill_addr_sk#6 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :              :  +- Project [i_item_id#565]
               :              :     +- Filter i_category#576 IN (Music)
               :              :        +- SubqueryAlias `item`
               :              :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- Join Inner
               :                 :  :  :- SubqueryAlias `catalog_sales`
               :                 :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :  :  +- SubqueryAlias `date_dim`
               :                 :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :  +- SubqueryAlias `customer_address`
               :                 :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :                 +- SubqueryAlias `item`
               :                    +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Project [i_item_id#565, total_sales#38331]
                  +- SubqueryAlias `ws`
                     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ws_ext_sales_price#239) AS total_sales#38331]
                        +- Filter (((i_item_id#565 IN (list#38332 []) && (ws_item_sk#219 = i_item_sk#564)) && ((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 9) && (ws_bill_addr_sk#223 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
                           :  +- Project [i_item_id#565]
                           :     +- Filter i_category#576 IN (Music)
                           :        +- SubqueryAlias `item`
                           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `web_sales`
                              :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :  +- SubqueryAlias `date_dim`
                              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `customer_address`
                              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 22.896330279999997s
Running execution q61-v2.4 iteration: 1, StandardRun=true
19/09/08 19:54:33 INFO Query:
== Query: q61-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [promotions#38400 ASC NULLS FIRST, total#38401 ASC NULLS FIRST], true
      +- Project [promotions#38400, total#38401, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(promotions#38400 as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(total#38401 as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) as decimal(35,20))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(35,20)))), DecimalType(38,19)) AS (CAST((CAST(CAST(promotions AS DECIMAL(15,4)) AS DECIMAL(15,4)) / CAST(CAST(total AS DECIMAL(15,4)) AS DECIMAL(15,4))) AS DECIMAL(35,20)) * CAST(CAST(100 AS DECIMAL(3,0)) AS DECIMAL(35,20)))#38404]
         +- Join Cross
            :- SubqueryAlias `promotional_sales`
            :  +- Aggregate [sum(ss_ext_sales_price#145) AS promotions#38400]
            :     +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_promo_sk#138 = p_promo_sk#608)) && (((ss_customer_sk#133 = c_customer_sk#412) && (ca_address_sk#448 = c_current_addr_sk#416)) && (ss_item_sk#132 = i_item_sk#564))) && ((((cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (i_category#576 = Jewelry)) && (((p_channel_dmail#616 = Y) || (p_channel_email#617 = Y)) || (p_channel_tv#619 = Y))) && (((cast(s_gmt_offset#691 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (d_year#498 = 1998)) && (d_moy#500 = 11))))
            :        +- Join Inner
            :           :- Join Inner
            :           :  :- Join Inner
            :           :  :  :- Join Inner
            :           :  :  :  :- Join Inner
            :           :  :  :  :  :- Join Inner
            :           :  :  :  :  :  :- SubqueryAlias `store_sales`
            :           :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :           :  :  :  :  :  +- SubqueryAlias `store`
            :           :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
            :           :  :  :  :  +- SubqueryAlias `promotion`
            :           :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
            :           :  :  :  +- SubqueryAlias `date_dim`
            :           :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :           :  :  +- SubqueryAlias `customer`
            :           :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :           :  +- SubqueryAlias `customer_address`
            :           :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            :           +- SubqueryAlias `item`
            :              +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            +- SubqueryAlias `all_sales`
               +- Aggregate [sum(ss_ext_sales_price#145) AS total#38401]
                  +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_customer_sk#133 = c_customer_sk#412)) && ((ca_address_sk#448 = c_current_addr_sk#416) && (ss_item_sk#132 = i_item_sk#564))) && ((((cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (i_category#576 = Jewelry)) && (cast(s_gmt_offset#691 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))) && ((d_year#498 = 1998) && (d_moy#500 = 11))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  +- SubqueryAlias `date_dim`
                        :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  +- SubqueryAlias `customer`
                        :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  +- SubqueryAlias `customer_address`
                        :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 19:54:33 INFO Query:
== Query: q61-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [promotions#38408 ASC NULLS FIRST, total#38409 ASC NULLS FIRST], true
      +- Project [promotions#38408, total#38409, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(promotions#38408 as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(total#38409 as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) as decimal(35,20))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(35,20)))), DecimalType(38,19)) AS (CAST((CAST(CAST(promotions AS DECIMAL(15,4)) AS DECIMAL(15,4)) / CAST(CAST(total AS DECIMAL(15,4)) AS DECIMAL(15,4))) AS DECIMAL(35,20)) * CAST(CAST(100 AS DECIMAL(3,0)) AS DECIMAL(35,20)))#38412]
         +- Join Cross
            :- SubqueryAlias `promotional_sales`
            :  +- Aggregate [sum(ss_ext_sales_price#145) AS promotions#38408]
            :     +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_promo_sk#138 = p_promo_sk#608)) && (((ss_customer_sk#133 = c_customer_sk#412) && (ca_address_sk#448 = c_current_addr_sk#416)) && (ss_item_sk#132 = i_item_sk#564))) && ((((cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (i_category#576 = Jewelry)) && (((p_channel_dmail#616 = Y) || (p_channel_email#617 = Y)) || (p_channel_tv#619 = Y))) && (((cast(s_gmt_offset#691 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (d_year#498 = 1998)) && (d_moy#500 = 11))))
            :        +- Join Inner
            :           :- Join Inner
            :           :  :- Join Inner
            :           :  :  :- Join Inner
            :           :  :  :  :- Join Inner
            :           :  :  :  :  :- Join Inner
            :           :  :  :  :  :  :- SubqueryAlias `store_sales`
            :           :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :           :  :  :  :  :  +- SubqueryAlias `store`
            :           :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
            :           :  :  :  :  +- SubqueryAlias `promotion`
            :           :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
            :           :  :  :  +- SubqueryAlias `date_dim`
            :           :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :           :  :  +- SubqueryAlias `customer`
            :           :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :           :  +- SubqueryAlias `customer_address`
            :           :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            :           +- SubqueryAlias `item`
            :              +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            +- SubqueryAlias `all_sales`
               +- Aggregate [sum(ss_ext_sales_price#145) AS total#38409]
                  +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_customer_sk#133 = c_customer_sk#412)) && ((ca_address_sk#448 = c_current_addr_sk#416) && (ss_item_sk#132 = i_item_sk#564))) && ((((cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (i_category#576 = Jewelry)) && (cast(s_gmt_offset#691 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))) && ((d_year#498 = 1998) && (d_moy#500 = 11))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  +- SubqueryAlias `date_dim`
                        :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  +- SubqueryAlias `customer`
                        :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  +- SubqueryAlias `customer_address`
                        :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 31.13008249s
Running execution q62-v2.4 iteration: 1, StandardRun=true
19/09/08 19:55:06 INFO Query:
== Query: q62-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [substring(w_warehouse_name, 1, 20)#38482, sm_type#654, web_name#802, 30 days#38472L, 31-60 days#38473L, 61-90 days#38474L, 91-120 days#38475L, >120 days#38476L]
      +- Sort [substring(w_warehouse_name, 1, 20)#38482 ASC NULLS FIRST, sm_type#654 ASC NULLS FIRST, web_name#802 ASC NULLS FIRST], true
         +- Aggregate [substring(w_warehouse_name#744, 1, 20), sm_type#654, web_name#802], [substring(w_warehouse_name#744, 1, 20) AS substring(w_warehouse_name, 1, 20)#38482, sm_type#654, web_name#802, sum(cast(CASE WHEN ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days#38472L, sum(cast(CASE WHEN (((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 30) && ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31-60 days#38473L, sum(cast(CASE WHEN (((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 60) && ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61-90 days#38474L, sum(cast(CASE WHEN (((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 90) && ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91-120 days#38475L, sum(cast(CASE WHEN ((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days#38476L]
            +- Filter (((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (ws_ship_date_sk#218 = d_date_sk#492)) && (ws_warehouse_sk#231 = w_warehouse_sk#742)) && ((ws_ship_mode_sk#230 = sm_ship_mode_sk#652) && (ws_web_site_sk#229 = web_site_sk#798)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `web_sales`
                  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `warehouse`
                  :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :  :  +- SubqueryAlias `ship_mode`
                  :  :     +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet
                  :  +- SubqueryAlias `web_site`
                  :     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 19:55:06 INFO Query:
== Query: q62-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [substring(w_warehouse_name, 1, 20)#38504, sm_type#654, web_name#802, 30 days#38494L, 31-60 days#38495L, 61-90 days#38496L, 91-120 days#38497L, >120 days#38498L]
      +- Sort [substring(w_warehouse_name, 1, 20)#38504 ASC NULLS FIRST, sm_type#654 ASC NULLS FIRST, web_name#802 ASC NULLS FIRST], true
         +- Aggregate [substring(w_warehouse_name#744, 1, 20), sm_type#654, web_name#802], [substring(w_warehouse_name#744, 1, 20) AS substring(w_warehouse_name, 1, 20)#38504, sm_type#654, web_name#802, sum(cast(CASE WHEN ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days#38494L, sum(cast(CASE WHEN (((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 30) && ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31-60 days#38495L, sum(cast(CASE WHEN (((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 60) && ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61-90 days#38496L, sum(cast(CASE WHEN (((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 90) && ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91-120 days#38497L, sum(cast(CASE WHEN ((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days#38498L]
            +- Filter (((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (ws_ship_date_sk#218 = d_date_sk#492)) && (ws_warehouse_sk#231 = w_warehouse_sk#742)) && ((ws_ship_mode_sk#230 = sm_ship_mode_sk#652) && (ws_web_site_sk#229 = web_site_sk#798)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `web_sales`
                  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `warehouse`
                  :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :  :  +- SubqueryAlias `ship_mode`
                  :  :     +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet
                  :  +- SubqueryAlias `web_site`
                  :     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 6.232561967s
Running execution q63-v2.4 iteration: 1, StandardRun=true
19/09/08 19:55:13 INFO Query:
== Query: q63-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_manager_id#584 ASC NULLS FIRST, avg_monthly_sales#38584 ASC NULLS FIRST, sum_sales#38583 ASC NULLS FIRST], true
      +- Project [i_manager_id#584, sum_sales#38583, avg_monthly_sales#38584]
         +- Filter (cast(CASE WHEN (cast(avg_monthly_sales#38584 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#38583 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#38584 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#38584 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16)))
            +- SubqueryAlias `tmp1`
               +- Project [i_manager_id#584, sum_sales#38583, avg_monthly_sales#38584]
                  +- Project [i_manager_id#584, sum_sales#38583, _w0#38588, avg_monthly_sales#38584, avg_monthly_sales#38584]
                     +- Window [avg(_w0#38588) windowspecdefinition(i_manager_id#584, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#38584], [i_manager_id#584]
                        +- Aggregate [i_manager_id#584, d_moy#500], [i_manager_id#584, sum(ss_sales_price#143) AS sum_sales#38583, sum(ss_sales_price#143) AS _w0#38588]
                           +- Filter ((((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_store_sk#137 = s_store_sk#664)) && (d_month_seq#495 IN (1200,(1200 + 1),(1200 + 2),(1200 + 3),(1200 + 4),(1200 + 5),(1200 + 6),(1200 + 7),(1200 + 8),(1200 + 9),(1200 + 10),(1200 + 11)) && (((i_category#576 IN (Books,Children,Electronics) && i_class#574 IN (personal,portable,reference,self-help)) && i_brand#572 IN (scholaramalgamalg #14,scholaramalgamalg #7,exportiunivamalg #9,scholaramalgamalg #9)) || ((i_category#576 IN (Women,Music,Men) && i_class#574 IN (accessories,classical,fragrances,pants)) && i_brand#572 IN (amalgimporto #1,edu packscholar #1,exportiimporto #1,importoamalg #1)))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `item`
                                 :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :  :  +- SubqueryAlias `store_sales`
                                 :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `date_dim`
                                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- SubqueryAlias `store`
                                    +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/09/08 19:55:13 INFO Query:
== Query: q63-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_manager_id#584 ASC NULLS FIRST, avg_monthly_sales#38593 ASC NULLS FIRST, sum_sales#38592 ASC NULLS FIRST], true
      +- Project [i_manager_id#584, sum_sales#38592, avg_monthly_sales#38593]
         +- Filter (cast(CASE WHEN (cast(avg_monthly_sales#38593 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#38592 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#38593 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#38593 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16)))
            +- SubqueryAlias `tmp1`
               +- Project [i_manager_id#584, sum_sales#38592, avg_monthly_sales#38593]
                  +- Project [i_manager_id#584, sum_sales#38592, _w0#38597, avg_monthly_sales#38593, avg_monthly_sales#38593]
                     +- Window [avg(_w0#38597) windowspecdefinition(i_manager_id#584, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#38593], [i_manager_id#584]
                        +- Aggregate [i_manager_id#584, d_moy#500], [i_manager_id#584, sum(ss_sales_price#143) AS sum_sales#38592, sum(ss_sales_price#143) AS _w0#38597]
                           +- Filter ((((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_store_sk#137 = s_store_sk#664)) && (d_month_seq#495 IN (1200,(1200 + 1),(1200 + 2),(1200 + 3),(1200 + 4),(1200 + 5),(1200 + 6),(1200 + 7),(1200 + 8),(1200 + 9),(1200 + 10),(1200 + 11)) && (((i_category#576 IN (Books,Children,Electronics) && i_class#574 IN (personal,portable,reference,self-help)) && i_brand#572 IN (scholaramalgamalg #14,scholaramalgamalg #7,exportiunivamalg #9,scholaramalgamalg #9)) || ((i_category#576 IN (Women,Music,Men) && i_class#574 IN (accessories,classical,fragrances,pants)) && i_brand#572 IN (amalgimporto #1,edu packscholar #1,exportiimporto #1,importoamalg #1)))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `item`
                                 :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :  :  +- SubqueryAlias `store_sales`
                                 :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `date_dim`
                                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- SubqueryAlias `store`
                                    +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 10.779687615999999s
Running execution q64-v2.4 iteration: 1, StandardRun=true
19/09/08 19:55:33 INFO Query:
== Query: q64-v2.4 ==
Sort [product_name#38826 ASC NULLS FIRST, store_name#38828 ASC NULLS FIRST, cnt#38963L ASC NULLS FIRST], true
+- Project [product_name#38826, store_name#38828, store_zip#38829, b_street_number#38830, b_streen_name#38831, b_city#38832, b_zip#38833, c_street_number#38834, c_street_name#38835, c_city#38836, c_zip#38837, syear#38838, cnt#38841L, s1#38842, s2#38843, s3#38844, s1#38964, s2#38965, s3#38966, syear#38960, cnt#38963L]
   +- Filter ((((item_sk#38827 = item_sk#38949) && (syear#38838 = 1999)) && (syear#38960 = (1999 + 1))) && (((cnt#38963L <= cnt#38841L) && (store_name#38828 = store_name#38950)) && (store_zip#38829 = store_zip#38951)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#38926, ca_street_name#38927, ca_city#38930, ca_zip#38933, d_year#498, d_year#38860, d_year#38888], [i_product_name#585 AS product_name#38826, i_item_sk#564 AS item_sk#38827, s_store_name#669 AS store_name#38828, s_zip#689 AS store_zip#38829, ca_street_number#450 AS b_street_number#38830, ca_street_name#451 AS b_streen_name#38831, ca_city#454 AS b_city#38832, ca_zip#457 AS b_zip#38833, ca_street_number#38926 AS c_street_number#38834, ca_street_name#38927 AS c_street_name#38835, ca_city#38930 AS c_city#38836, ca_zip#38933 AS c_zip#38837, d_year#498 AS syear#38838, d_year#38860 AS fsyear#38839, d_year#38888 AS s2year#38840, count(1) AS cnt#38841L, sum(ss_wholesale_cost#141) AS s1#38842, sum(ss_list_price#142) AS s2#38843, sum(ss_coupon_amt#149) AS s3#38844]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#38910)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#38919) && (c_current_addr_sk#416 = ca_address_sk#38924)) && (c_first_sales_date_sk#418 = d_date_sk#38854)) && (((c_first_shipto_date_sk#417 = d_date_sk#38882) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#38920 = ib_income_band_sk#38937) && NOT (cd_marital_status#476 = cd_marital_status#38912)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#38824, refund#38825]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#38850 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#38851 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#38824, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#38825, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#38850, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#38851]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#38854,d_date_id#38855,d_date#38856,d_month_seq#38857,d_week_seq#38858,d_quarter_seq#38859,d_year#38860,d_dow#38861,d_moy#38862,d_dom#38863,d_qoy#38864,d_fy_year#38865,d_fy_quarter_seq#38866,d_fy_week_seq#38867,d_day_name#38868,d_quarter_name#38869,d_holiday#38870,d_weekend#38871,d_following_holiday#38872,d_first_dom#38873,d_last_dom#38874,d_same_day_ly#38875,d_same_day_lq#38876,d_current_day#38877,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#38882,d_date_id#38883,d_date#38884,d_month_seq#38885,d_week_seq#38886,d_quarter_seq#38887,d_year#38888,d_dow#38889,d_moy#38890,d_dom#38891,d_qoy#38892,d_fy_year#38893,d_fy_quarter_seq#38894,d_fy_week_seq#38895,d_day_name#38896,d_quarter_name#38897,d_holiday#38898,d_weekend#38899,d_following_holiday#38900,d_first_dom#38901,d_last_dom#38902,d_same_day_ly#38903,d_same_day_lq#38904,d_current_day#38905,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#38910,cd_gender#38911,cd_marital_status#38912,cd_education_status#38913,cd_purchase_estimate#38914,cd_credit_rating#38915,cd_dep_count#38916,cd_dep_employed_count#38917,cd_dep_college_count#38918] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#38919,hd_income_band_sk#38920,hd_buy_potential#38921,hd_dep_count#38922,hd_vehicle_count#38923] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#38924,ca_address_id#38925,ca_street_number#38926,ca_street_name#38927,ca_street_type#38928,ca_suite_number#38929,ca_city#38930,ca_county#38931,ca_state#38932,ca_zip#38933,ca_country#38934,ca_gmt_offset#38935,ca_location_type#38936] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#38937,ib_lower_bound#38938,ib_upper_bound#38939] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#38926, ca_street_name#38927, ca_city#38930, ca_zip#38933, d_year#498, d_year#38860, d_year#38888], [i_product_name#585 AS product_name#38948, i_item_sk#564 AS item_sk#38949, s_store_name#669 AS store_name#38950, s_zip#689 AS store_zip#38951, ca_street_number#450 AS b_street_number#38952, ca_street_name#451 AS b_streen_name#38953, ca_city#454 AS b_city#38954, ca_zip#457 AS b_zip#38955, ca_street_number#38926 AS c_street_number#38956, ca_street_name#38927 AS c_street_name#38957, ca_city#38930 AS c_city#38958, ca_zip#38933 AS c_zip#38959, d_year#498 AS syear#38960, d_year#38860 AS fsyear#38961, d_year#38888 AS s2year#38962, count(1) AS cnt#38963L, sum(ss_wholesale_cost#141) AS s1#38964, sum(ss_list_price#142) AS s2#38965, sum(ss_coupon_amt#149) AS s3#38966]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#38910)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#38919) && (c_current_addr_sk#416 = ca_address_sk#38924)) && (c_first_sales_date_sk#418 = d_date_sk#38854)) && (((c_first_shipto_date_sk#417 = d_date_sk#38882) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#38920 = ib_income_band_sk#38937) && NOT (cd_marital_status#476 = cd_marital_status#38912)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#38824, refund#38825]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#38850 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#38851 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#38824, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#38825, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#38850, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#38851]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#38854,d_date_id#38855,d_date#38856,d_month_seq#38857,d_week_seq#38858,d_quarter_seq#38859,d_year#38860,d_dow#38861,d_moy#38862,d_dom#38863,d_qoy#38864,d_fy_year#38865,d_fy_quarter_seq#38866,d_fy_week_seq#38867,d_day_name#38868,d_quarter_name#38869,d_holiday#38870,d_weekend#38871,d_following_holiday#38872,d_first_dom#38873,d_last_dom#38874,d_same_day_ly#38875,d_same_day_lq#38876,d_current_day#38877,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#38882,d_date_id#38883,d_date#38884,d_month_seq#38885,d_week_seq#38886,d_quarter_seq#38887,d_year#38888,d_dow#38889,d_moy#38890,d_dom#38891,d_qoy#38892,d_fy_year#38893,d_fy_quarter_seq#38894,d_fy_week_seq#38895,d_day_name#38896,d_quarter_name#38897,d_holiday#38898,d_weekend#38899,d_following_holiday#38900,d_first_dom#38901,d_last_dom#38902,d_same_day_ly#38903,d_same_day_lq#38904,d_current_day#38905,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#38910,cd_gender#38911,cd_marital_status#38912,cd_education_status#38913,cd_purchase_estimate#38914,cd_credit_rating#38915,cd_dep_count#38916,cd_dep_employed_count#38917,cd_dep_college_count#38918] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#38919,hd_income_band_sk#38920,hd_buy_potential#38921,hd_dep_count#38922,hd_vehicle_count#38923] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#38924,ca_address_id#38925,ca_street_number#38926,ca_street_name#38927,ca_street_type#38928,ca_suite_number#38929,ca_city#38930,ca_county#38931,ca_state#38932,ca_zip#38933,ca_country#38934,ca_gmt_offset#38935,ca_location_type#38936] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#38937,ib_lower_bound#38938,ib_upper_bound#38939] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 19:55:33 INFO Query:
== Query: q64-v2.4 ==
Sort [product_name#38994 ASC NULLS FIRST, store_name#38996 ASC NULLS FIRST, cnt#39131L ASC NULLS FIRST], true
+- Project [product_name#38994, store_name#38996, store_zip#38997, b_street_number#38998, b_streen_name#38999, b_city#39000, b_zip#39001, c_street_number#39002, c_street_name#39003, c_city#39004, c_zip#39005, syear#39006, cnt#39009L, s1#39010, s2#39011, s3#39012, s1#39132, s2#39133, s3#39134, syear#39128, cnt#39131L]
   +- Filter ((((item_sk#38995 = item_sk#39117) && (syear#39006 = 1999)) && (syear#39128 = (1999 + 1))) && (((cnt#39131L <= cnt#39009L) && (store_name#38996 = store_name#39118)) && (store_zip#38997 = store_zip#39119)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#39094, ca_street_name#39095, ca_city#39098, ca_zip#39101, d_year#498, d_year#39028, d_year#39056], [i_product_name#585 AS product_name#38994, i_item_sk#564 AS item_sk#38995, s_store_name#669 AS store_name#38996, s_zip#689 AS store_zip#38997, ca_street_number#450 AS b_street_number#38998, ca_street_name#451 AS b_streen_name#38999, ca_city#454 AS b_city#39000, ca_zip#457 AS b_zip#39001, ca_street_number#39094 AS c_street_number#39002, ca_street_name#39095 AS c_street_name#39003, ca_city#39098 AS c_city#39004, ca_zip#39101 AS c_zip#39005, d_year#498 AS syear#39006, d_year#39028 AS fsyear#39007, d_year#39056 AS s2year#39008, count(1) AS cnt#39009L, sum(ss_wholesale_cost#141) AS s1#39010, sum(ss_list_price#142) AS s2#39011, sum(ss_coupon_amt#149) AS s3#39012]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#39078)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#39087) && (c_current_addr_sk#416 = ca_address_sk#39092)) && (c_first_sales_date_sk#418 = d_date_sk#39022)) && (((c_first_shipto_date_sk#417 = d_date_sk#39050) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#39088 = ib_income_band_sk#39105) && NOT (cd_marital_status#476 = cd_marital_status#39080)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#38992, refund#38993]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#39018 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#39019 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#38992, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#38993, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#39018, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#39019]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#39022,d_date_id#39023,d_date#39024,d_month_seq#39025,d_week_seq#39026,d_quarter_seq#39027,d_year#39028,d_dow#39029,d_moy#39030,d_dom#39031,d_qoy#39032,d_fy_year#39033,d_fy_quarter_seq#39034,d_fy_week_seq#39035,d_day_name#39036,d_quarter_name#39037,d_holiday#39038,d_weekend#39039,d_following_holiday#39040,d_first_dom#39041,d_last_dom#39042,d_same_day_ly#39043,d_same_day_lq#39044,d_current_day#39045,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#39050,d_date_id#39051,d_date#39052,d_month_seq#39053,d_week_seq#39054,d_quarter_seq#39055,d_year#39056,d_dow#39057,d_moy#39058,d_dom#39059,d_qoy#39060,d_fy_year#39061,d_fy_quarter_seq#39062,d_fy_week_seq#39063,d_day_name#39064,d_quarter_name#39065,d_holiday#39066,d_weekend#39067,d_following_holiday#39068,d_first_dom#39069,d_last_dom#39070,d_same_day_ly#39071,d_same_day_lq#39072,d_current_day#39073,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#39078,cd_gender#39079,cd_marital_status#39080,cd_education_status#39081,cd_purchase_estimate#39082,cd_credit_rating#39083,cd_dep_count#39084,cd_dep_employed_count#39085,cd_dep_college_count#39086] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#39087,hd_income_band_sk#39088,hd_buy_potential#39089,hd_dep_count#39090,hd_vehicle_count#39091] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#39092,ca_address_id#39093,ca_street_number#39094,ca_street_name#39095,ca_street_type#39096,ca_suite_number#39097,ca_city#39098,ca_county#39099,ca_state#39100,ca_zip#39101,ca_country#39102,ca_gmt_offset#39103,ca_location_type#39104] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#39105,ib_lower_bound#39106,ib_upper_bound#39107] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#39094, ca_street_name#39095, ca_city#39098, ca_zip#39101, d_year#498, d_year#39028, d_year#39056], [i_product_name#585 AS product_name#39116, i_item_sk#564 AS item_sk#39117, s_store_name#669 AS store_name#39118, s_zip#689 AS store_zip#39119, ca_street_number#450 AS b_street_number#39120, ca_street_name#451 AS b_streen_name#39121, ca_city#454 AS b_city#39122, ca_zip#457 AS b_zip#39123, ca_street_number#39094 AS c_street_number#39124, ca_street_name#39095 AS c_street_name#39125, ca_city#39098 AS c_city#39126, ca_zip#39101 AS c_zip#39127, d_year#498 AS syear#39128, d_year#39028 AS fsyear#39129, d_year#39056 AS s2year#39130, count(1) AS cnt#39131L, sum(ss_wholesale_cost#141) AS s1#39132, sum(ss_list_price#142) AS s2#39133, sum(ss_coupon_amt#149) AS s3#39134]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#39078)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#39087) && (c_current_addr_sk#416 = ca_address_sk#39092)) && (c_first_sales_date_sk#418 = d_date_sk#39022)) && (((c_first_shipto_date_sk#417 = d_date_sk#39050) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#39088 = ib_income_band_sk#39105) && NOT (cd_marital_status#476 = cd_marital_status#39080)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#38992, refund#38993]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#39018 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#39019 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#38992, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#38993, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#39018, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#39019]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#39022,d_date_id#39023,d_date#39024,d_month_seq#39025,d_week_seq#39026,d_quarter_seq#39027,d_year#39028,d_dow#39029,d_moy#39030,d_dom#39031,d_qoy#39032,d_fy_year#39033,d_fy_quarter_seq#39034,d_fy_week_seq#39035,d_day_name#39036,d_quarter_name#39037,d_holiday#39038,d_weekend#39039,d_following_holiday#39040,d_first_dom#39041,d_last_dom#39042,d_same_day_ly#39043,d_same_day_lq#39044,d_current_day#39045,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#39050,d_date_id#39051,d_date#39052,d_month_seq#39053,d_week_seq#39054,d_quarter_seq#39055,d_year#39056,d_dow#39057,d_moy#39058,d_dom#39059,d_qoy#39060,d_fy_year#39061,d_fy_quarter_seq#39062,d_fy_week_seq#39063,d_day_name#39064,d_quarter_name#39065,d_holiday#39066,d_weekend#39067,d_following_holiday#39068,d_first_dom#39069,d_last_dom#39070,d_same_day_ly#39071,d_same_day_lq#39072,d_current_day#39073,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#39078,cd_gender#39079,cd_marital_status#39080,cd_education_status#39081,cd_purchase_estimate#39082,cd_credit_rating#39083,cd_dep_count#39084,cd_dep_employed_count#39085,cd_dep_college_count#39086] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#39087,hd_income_band_sk#39088,hd_buy_potential#39089,hd_dep_count#39090,hd_vehicle_count#39091] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#39092,ca_address_id#39093,ca_street_number#39094,ca_street_name#39095,ca_street_type#39096,ca_suite_number#39097,ca_city#39098,ca_county#39099,ca_state#39100,ca_zip#39101,ca_country#39102,ca_gmt_offset#39103,ca_location_type#39104] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#39105,ib_lower_bound#39106,ib_upper_bound#39107] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 245.426133703s
Running execution q65-v2.4 iteration: 1, StandardRun=true
19/09/08 19:59:48 INFO Query:
== Query: q65-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name#669 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST], true
      +- Project [s_store_name#669, i_item_desc#568, revenue#39578, i_current_price#569, i_wholesale_cost#570, i_brand#572]
         +- Filter (((ss_store_sk#137 = ss_store_sk#39589) && (cast(revenue#39578 as decimal(23,7)) <= cast(CheckOverflow((promote_precision(cast(0.1 as decimal(21,6))) * promote_precision(cast(ave#39577 as decimal(21,6)))), DecimalType(23,7)) as decimal(23,7)))) && ((s_store_sk#664 = ss_store_sk#39589) && (i_item_sk#564 = ss_item_sk#39584)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `store`
               :  :  :  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :  :  +- SubqueryAlias `item`
               :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- SubqueryAlias `sb`
               :     +- Aggregate [ss_store_sk#137], [ss_store_sk#137, avg(revenue#39576) AS ave#39577]
               :        +- SubqueryAlias `sa`
               :           +- Aggregate [ss_store_sk#137, ss_item_sk#132], [ss_store_sk#137, ss_item_sk#132, sum(ss_sales_price#143) AS revenue#39576]
               :              +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_month_seq#495 >= 1176) && (d_month_seq#495 <= (1176 + 11))))
               :                 +- Join Inner
               :                    :- SubqueryAlias `store_sales`
               :                    :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `sc`
                  +- Aggregate [ss_store_sk#39589, ss_item_sk#39584], [ss_store_sk#39589, ss_item_sk#39584, sum(ss_sales_price#39595) AS revenue#39578]
                     +- Filter ((ss_sold_date_sk#39582 = d_date_sk#492) && ((d_month_seq#495 >= 1176) && (d_month_seq#495 <= (1176 + 11))))
                        +- Join Inner
                           :- SubqueryAlias `store_sales`
                           :  +- Relation[ss_sold_date_sk#39582,ss_sold_time_sk#39583,ss_item_sk#39584,ss_customer_sk#39585,ss_cdemo_sk#39586,ss_hdemo_sk#39587,ss_addr_sk#39588,ss_store_sk#39589,ss_promo_sk#39590,ss_ticket_number#39591L,ss_quantity#39592,ss_wholesale_cost#39593,ss_list_price#39594,ss_sales_price#39595,ss_ext_discount_amt#39596,ss_ext_sales_price#39597,ss_ext_wholesale_cost#39598,ss_ext_list_price#39599,ss_ext_tax#39600,ss_coupon_amt#39601,ss_net_paid#39602,ss_net_paid_inc_tax#39603,ss_net_profit#39604] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 19:59:48 INFO Query:
== Query: q65-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name#669 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST], true
      +- Project [s_store_name#669, i_item_desc#568, revenue#39613, i_current_price#569, i_wholesale_cost#570, i_brand#572]
         +- Filter (((ss_store_sk#137 = ss_store_sk#39624) && (cast(revenue#39613 as decimal(23,7)) <= cast(CheckOverflow((promote_precision(cast(0.1 as decimal(21,6))) * promote_precision(cast(ave#39612 as decimal(21,6)))), DecimalType(23,7)) as decimal(23,7)))) && ((s_store_sk#664 = ss_store_sk#39624) && (i_item_sk#564 = ss_item_sk#39619)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `store`
               :  :  :  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :  :  +- SubqueryAlias `item`
               :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- SubqueryAlias `sb`
               :     +- Aggregate [ss_store_sk#137], [ss_store_sk#137, avg(revenue#39611) AS ave#39612]
               :        +- SubqueryAlias `sa`
               :           +- Aggregate [ss_store_sk#137, ss_item_sk#132], [ss_store_sk#137, ss_item_sk#132, sum(ss_sales_price#143) AS revenue#39611]
               :              +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_month_seq#495 >= 1176) && (d_month_seq#495 <= (1176 + 11))))
               :                 +- Join Inner
               :                    :- SubqueryAlias `store_sales`
               :                    :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `sc`
                  +- Aggregate [ss_store_sk#39624, ss_item_sk#39619], [ss_store_sk#39624, ss_item_sk#39619, sum(ss_sales_price#39630) AS revenue#39613]
                     +- Filter ((ss_sold_date_sk#39617 = d_date_sk#492) && ((d_month_seq#495 >= 1176) && (d_month_seq#495 <= (1176 + 11))))
                        +- Join Inner
                           :- SubqueryAlias `store_sales`
                           :  +- Relation[ss_sold_date_sk#39617,ss_sold_time_sk#39618,ss_item_sk#39619,ss_customer_sk#39620,ss_cdemo_sk#39621,ss_hdemo_sk#39622,ss_addr_sk#39623,ss_store_sk#39624,ss_promo_sk#39625,ss_ticket_number#39626L,ss_quantity#39627,ss_wholesale_cost#39628,ss_list_price#39629,ss_sales_price#39630,ss_ext_discount_amt#39631,ss_ext_sales_price#39632,ss_ext_wholesale_cost#39633,ss_ext_list_price#39634,ss_ext_tax#39635,ss_coupon_amt#39636,ss_net_paid#39637,ss_net_paid_inc_tax#39638,ss_net_profit#39639] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 42.688935275999995s
Running execution q66-v2.4 iteration: 1, StandardRun=true
19/09/08 20:00:32 INFO Query:
== Query: q66-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, ship_carriers#40160, year#40161, jan_sales#40212, feb_sales#40213, mar_sales#40214, apr_sales#40215, may_sales#40216, jun_sales#40217, jul_sales#40218, aug_sales#40219, sep_sales#40220, oct_sales#40221, nov_sales#40222, dec_sales#40223, jan_sales_per_sq_foot#40224, feb_sales_per_sq_foot#40225, mar_sales_per_sq_foot#40226, apr_sales_per_sq_foot#40227, ... 20 more fields]
      +- Sort [w_warehouse_name#744 ASC NULLS FIRST], true
         +- Aggregate [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, ship_carriers#40160, year#40161], [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, ship_carriers#40160, year#40161, sum(jan_sales#40162) AS jan_sales#40212, sum(feb_sales#40163) AS feb_sales#40213, sum(mar_sales#40164) AS mar_sales#40214, sum(apr_sales#40165) AS apr_sales#40215, sum(may_sales#40166) AS may_sales#40216, sum(jun_sales#40167) AS jun_sales#40217, sum(jul_sales#40168) AS jul_sales#40218, sum(aug_sales#40169) AS aug_sales#40219, sum(sep_sales#40170) AS sep_sales#40220, sum(oct_sales#40171) AS oct_sales#40221, sum(nov_sales#40172) AS nov_sales#40222, sum(dec_sales#40173) AS dec_sales#40223, sum(CheckOverflow((promote_precision(cast(jan_sales#40162 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS jan_sales_per_sq_foot#40224, sum(CheckOverflow((promote_precision(cast(feb_sales#40163 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS feb_sales_per_sq_foot#40225, sum(CheckOverflow((promote_precision(cast(mar_sales#40164 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS mar_sales_per_sq_foot#40226, sum(CheckOverflow((promote_precision(cast(apr_sales#40165 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS apr_sales_per_sq_foot#40227, ... 20 more fields]
            +- SubqueryAlias `x`
               +- Union
                  :- Aggregate [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, d_year#498], [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, concat(DHL, ,, BARIAN) AS ship_carriers#40160, d_year#498 AS year#40161, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_sales#40162, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_sales#40163, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_sales#40164, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_sales#40165, sum(CASE WHEN (d_moy#500 = 5) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS may_sales#40166, sum(CASE WHEN (d_moy#500 = 6) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jun_sales#40167, sum(CASE WHEN (d_moy#500 = 7) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jul_sales#40168, sum(CASE WHEN (d_moy#500 = 8) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS aug_sales#40169, sum(CASE WHEN (d_moy#500 = 9) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS sep_sales#40170, sum(CASE WHEN (d_moy#500 = 10) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS oct_sales#40171, sum(CASE WHEN (d_moy#500 = 11) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS nov_sales#40172, sum(CASE WHEN (d_moy#500 = 12) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS dec_sales#40173, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_net#40174, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_net#40175, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_net#40176, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_net#40177, ... 8 more fields]
                  :  +- Filter ((((ws_warehouse_sk#231 = w_warehouse_sk#742) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((ws_sold_time_sk#217 = t_time_sk#722) && (ws_ship_mode_sk#230 = sm_ship_mode_sk#652))) && (((d_year#498 = 2001) && ((t_time#724 >= 30838) && (t_time#724 <= (30838 + 28800)))) && sm_carrier#656 IN (DHL,BARIAN)))
                  :     +- Join Inner
                  :        :- Join Inner
                  :        :  :- Join Inner
                  :        :  :  :- Join Inner
                  :        :  :  :  :- SubqueryAlias `web_sales`
                  :        :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :        :  :  :  +- SubqueryAlias `warehouse`
                  :        :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :        :  :  +- SubqueryAlias `date_dim`
                  :        :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :        :  +- SubqueryAlias `time_dim`
                  :        :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                  :        +- SubqueryAlias `ship_mode`
                  :           +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet
                  +- Aggregate [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, d_year#498], [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, concat(DHL, ,, BARIAN) AS ship_carriers#40186, d_year#498 AS year#40187, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_sales#40188, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_sales#40189, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_sales#40190, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_sales#40191, sum(CASE WHEN (d_moy#500 = 5) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS may_sales#40192, sum(CASE WHEN (d_moy#500 = 6) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jun_sales#40193, sum(CASE WHEN (d_moy#500 = 7) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jul_sales#40194, sum(CASE WHEN (d_moy#500 = 8) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS aug_sales#40195, sum(CASE WHEN (d_moy#500 = 9) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS sep_sales#40196, sum(CASE WHEN (d_moy#500 = 10) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS oct_sales#40197, sum(CASE WHEN (d_moy#500 = 11) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS nov_sales#40198, sum(CASE WHEN (d_moy#500 = 12) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS dec_sales#40199, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_net#40200, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_net#40201, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_net#40202, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_net#40203, ... 8 more fields]
                     +- Filter ((((cs_warehouse_sk#14 = w_warehouse_sk#742) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((cs_sold_time_sk#1 = t_time_sk#722) && (cs_ship_mode_sk#13 = sm_ship_mode_sk#652))) && (((d_year#498 = 2001) && ((t_time#724 >= 30838) && (t_time#724 <= (30838 + 28800)))) && sm_carrier#656 IN (DHL,BARIAN)))
                        +- Join Inner
                           :- Join Inner
                           :  :- Join Inner
                           :  :  :- Join Inner
                           :  :  :  :- SubqueryAlias `catalog_sales`
                           :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :  :  :  +- SubqueryAlias `warehouse`
                           :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                           :  :  +- SubqueryAlias `date_dim`
                           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :  +- SubqueryAlias `time_dim`
                           :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                           +- SubqueryAlias `ship_mode`
                              +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet

     : benchmark
19/09/08 20:00:33 INFO Query:
== Query: q66-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, ship_carriers#40377, year#40378, jan_sales#40429, feb_sales#40430, mar_sales#40431, apr_sales#40432, may_sales#40433, jun_sales#40434, jul_sales#40435, aug_sales#40436, sep_sales#40437, oct_sales#40438, nov_sales#40439, dec_sales#40440, jan_sales_per_sq_foot#40441, feb_sales_per_sq_foot#40442, mar_sales_per_sq_foot#40443, apr_sales_per_sq_foot#40444, ... 20 more fields]
      +- Sort [w_warehouse_name#744 ASC NULLS FIRST], true
         +- Aggregate [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, ship_carriers#40377, year#40378], [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, ship_carriers#40377, year#40378, sum(jan_sales#40379) AS jan_sales#40429, sum(feb_sales#40380) AS feb_sales#40430, sum(mar_sales#40381) AS mar_sales#40431, sum(apr_sales#40382) AS apr_sales#40432, sum(may_sales#40383) AS may_sales#40433, sum(jun_sales#40384) AS jun_sales#40434, sum(jul_sales#40385) AS jul_sales#40435, sum(aug_sales#40386) AS aug_sales#40436, sum(sep_sales#40387) AS sep_sales#40437, sum(oct_sales#40388) AS oct_sales#40438, sum(nov_sales#40389) AS nov_sales#40439, sum(dec_sales#40390) AS dec_sales#40440, sum(CheckOverflow((promote_precision(cast(jan_sales#40379 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS jan_sales_per_sq_foot#40441, sum(CheckOverflow((promote_precision(cast(feb_sales#40380 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS feb_sales_per_sq_foot#40442, sum(CheckOverflow((promote_precision(cast(mar_sales#40381 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS mar_sales_per_sq_foot#40443, sum(CheckOverflow((promote_precision(cast(apr_sales#40382 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS apr_sales_per_sq_foot#40444, ... 20 more fields]
            +- SubqueryAlias `x`
               +- Union
                  :- Aggregate [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, d_year#498], [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, concat(DHL, ,, BARIAN) AS ship_carriers#40377, d_year#498 AS year#40378, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_sales#40379, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_sales#40380, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_sales#40381, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_sales#40382, sum(CASE WHEN (d_moy#500 = 5) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS may_sales#40383, sum(CASE WHEN (d_moy#500 = 6) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jun_sales#40384, sum(CASE WHEN (d_moy#500 = 7) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jul_sales#40385, sum(CASE WHEN (d_moy#500 = 8) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS aug_sales#40386, sum(CASE WHEN (d_moy#500 = 9) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS sep_sales#40387, sum(CASE WHEN (d_moy#500 = 10) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS oct_sales#40388, sum(CASE WHEN (d_moy#500 = 11) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS nov_sales#40389, sum(CASE WHEN (d_moy#500 = 12) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS dec_sales#40390, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_net#40391, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_net#40392, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_net#40393, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_net#40394, ... 8 more fields]
                  :  +- Filter ((((ws_warehouse_sk#231 = w_warehouse_sk#742) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((ws_sold_time_sk#217 = t_time_sk#722) && (ws_ship_mode_sk#230 = sm_ship_mode_sk#652))) && (((d_year#498 = 2001) && ((t_time#724 >= 30838) && (t_time#724 <= (30838 + 28800)))) && sm_carrier#656 IN (DHL,BARIAN)))
                  :     +- Join Inner
                  :        :- Join Inner
                  :        :  :- Join Inner
                  :        :  :  :- Join Inner
                  :        :  :  :  :- SubqueryAlias `web_sales`
                  :        :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :        :  :  :  +- SubqueryAlias `warehouse`
                  :        :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :        :  :  +- SubqueryAlias `date_dim`
                  :        :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :        :  +- SubqueryAlias `time_dim`
                  :        :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                  :        +- SubqueryAlias `ship_mode`
                  :           +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet
                  +- Aggregate [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, d_year#498], [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, concat(DHL, ,, BARIAN) AS ship_carriers#40403, d_year#498 AS year#40404, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_sales#40405, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_sales#40406, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_sales#40407, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_sales#40408, sum(CASE WHEN (d_moy#500 = 5) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS may_sales#40409, sum(CASE WHEN (d_moy#500 = 6) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jun_sales#40410, sum(CASE WHEN (d_moy#500 = 7) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jul_sales#40411, sum(CASE WHEN (d_moy#500 = 8) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS aug_sales#40412, sum(CASE WHEN (d_moy#500 = 9) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS sep_sales#40413, sum(CASE WHEN (d_moy#500 = 10) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS oct_sales#40414, sum(CASE WHEN (d_moy#500 = 11) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS nov_sales#40415, sum(CASE WHEN (d_moy#500 = 12) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS dec_sales#40416, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_net#40417, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_net#40418, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_net#40419, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_net#40420, ... 8 more fields]
                     +- Filter ((((cs_warehouse_sk#14 = w_warehouse_sk#742) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((cs_sold_time_sk#1 = t_time_sk#722) && (cs_ship_mode_sk#13 = sm_ship_mode_sk#652))) && (((d_year#498 = 2001) && ((t_time#724 >= 30838) && (t_time#724 <= (30838 + 28800)))) && sm_carrier#656 IN (DHL,BARIAN)))
                        +- Join Inner
                           :- Join Inner
                           :  :- Join Inner
                           :  :  :- Join Inner
                           :  :  :  :- SubqueryAlias `catalog_sales`
                           :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :  :  :  +- SubqueryAlias `warehouse`
                           :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                           :  :  +- SubqueryAlias `date_dim`
                           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :  +- SubqueryAlias `time_dim`
                           :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                           +- SubqueryAlias `ship_mode`
                              +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet

      running Thread[benchmark runner,5,main]
Execution time: 18.295136364s
Running execution q67-v2.4 iteration: 1, StandardRun=true
19/09/08 20:00:53 INFO Query:
== Query: q67-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#41302 ASC NULLS FIRST, i_class#41303 ASC NULLS FIRST, i_brand#41304 ASC NULLS FIRST, i_product_name#41305 ASC NULLS FIRST, d_year#41306 ASC NULLS FIRST, d_qoy#41307 ASC NULLS FIRST, d_moy#41308 ASC NULLS FIRST, s_store_id#41309 ASC NULLS FIRST, sumsales#41288 ASC NULLS FIRST, rk#41289 ASC NULLS FIRST], true
      +- Project [i_category#41302, i_class#41303, i_brand#41304, i_product_name#41305, d_year#41306, d_qoy#41307, d_moy#41308, s_store_id#41309, sumsales#41288, rk#41289]
         +- Filter (rk#41289 <= 100)
            +- SubqueryAlias `dw2`
               +- Project [i_category#41302, i_class#41303, i_brand#41304, i_product_name#41305, d_year#41306, d_qoy#41307, d_moy#41308, s_store_id#41309, sumsales#41288, rk#41289]
                  +- Project [i_category#41302, i_class#41303, i_brand#41304, i_product_name#41305, d_year#41306, d_qoy#41307, d_moy#41308, s_store_id#41309, sumsales#41288, rk#41289, rk#41289]
                     +- Window [rank(sumsales#41288) windowspecdefinition(i_category#41302, sumsales#41288 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#41289], [i_category#41302], [sumsales#41288 DESC NULLS LAST]
                        +- Project [i_category#41302, i_class#41303, i_brand#41304, i_product_name#41305, d_year#41306, d_qoy#41307, d_moy#41308, s_store_id#41309, sumsales#41288]
                           +- SubqueryAlias `dw1`
                              +- Aggregate [i_category#41302, i_class#41303, i_brand#41304, i_product_name#41305, d_year#41306, d_qoy#41307, d_moy#41308, s_store_id#41309, spark_grouping_id#41293], [i_category#41302, i_class#41303, i_brand#41304, i_product_name#41305, d_year#41306, d_qoy#41307, d_moy#41308, s_store_id#41309, sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#143 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)), cast(0 as decimal(18,2)))) AS sumsales#41288]
                                 +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41294, i_class#41295, i_brand#41296, i_product_name#41297, d_year#41298, d_qoy#41299, d_moy#41300, s_store_id#41301, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41294, i_class#41295, i_brand#41296, i_product_name#41297, d_year#41298, d_qoy#41299, d_moy#41300, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41294, i_class#41295, i_brand#41296, i_product_name#41297, d_year#41298, d_qoy#41299, null, null, 3), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41294, i_class#41295, i_brand#41296, i_product_name#41297, d_year#41298, null, null, null, 7), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41294, i_class#41295, i_brand#41296, i_product_name#41297, null, null, null, null, 15), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41294, i_class#41295, i_brand#41296, null, null, null, null, null, 31), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41294, i_class#41295, null, null, null, null, null, null, 63), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41294, null, null, null, null, null, null, null, 127), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, null, null, null, null, null, null, 255)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 87 more fields]
                                    +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 86 more fields]
                                       +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_store_sk#137 = s_store_sk#664) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11)))))
                                          +- Join Inner
                                             :- Join Inner
                                             :  :- Join Inner
                                             :  :  :- SubqueryAlias `store_sales`
                                             :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                             :  :  +- SubqueryAlias `date_dim`
                                             :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                             :  +- SubqueryAlias `store`
                                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                                             +- SubqueryAlias `item`
                                                +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 20:00:53 INFO Query:
== Query: q67-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#41343 ASC NULLS FIRST, i_class#41344 ASC NULLS FIRST, i_brand#41345 ASC NULLS FIRST, i_product_name#41346 ASC NULLS FIRST, d_year#41347 ASC NULLS FIRST, d_qoy#41348 ASC NULLS FIRST, d_moy#41349 ASC NULLS FIRST, s_store_id#41350 ASC NULLS FIRST, sumsales#41329 ASC NULLS FIRST, rk#41330 ASC NULLS FIRST], true
      +- Project [i_category#41343, i_class#41344, i_brand#41345, i_product_name#41346, d_year#41347, d_qoy#41348, d_moy#41349, s_store_id#41350, sumsales#41329, rk#41330]
         +- Filter (rk#41330 <= 100)
            +- SubqueryAlias `dw2`
               +- Project [i_category#41343, i_class#41344, i_brand#41345, i_product_name#41346, d_year#41347, d_qoy#41348, d_moy#41349, s_store_id#41350, sumsales#41329, rk#41330]
                  +- Project [i_category#41343, i_class#41344, i_brand#41345, i_product_name#41346, d_year#41347, d_qoy#41348, d_moy#41349, s_store_id#41350, sumsales#41329, rk#41330, rk#41330]
                     +- Window [rank(sumsales#41329) windowspecdefinition(i_category#41343, sumsales#41329 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#41330], [i_category#41343], [sumsales#41329 DESC NULLS LAST]
                        +- Project [i_category#41343, i_class#41344, i_brand#41345, i_product_name#41346, d_year#41347, d_qoy#41348, d_moy#41349, s_store_id#41350, sumsales#41329]
                           +- SubqueryAlias `dw1`
                              +- Aggregate [i_category#41343, i_class#41344, i_brand#41345, i_product_name#41346, d_year#41347, d_qoy#41348, d_moy#41349, s_store_id#41350, spark_grouping_id#41334], [i_category#41343, i_class#41344, i_brand#41345, i_product_name#41346, d_year#41347, d_qoy#41348, d_moy#41349, s_store_id#41350, sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#143 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)), cast(0 as decimal(18,2)))) AS sumsales#41329]
                                 +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41335, i_class#41336, i_brand#41337, i_product_name#41338, d_year#41339, d_qoy#41340, d_moy#41341, s_store_id#41342, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41335, i_class#41336, i_brand#41337, i_product_name#41338, d_year#41339, d_qoy#41340, d_moy#41341, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41335, i_class#41336, i_brand#41337, i_product_name#41338, d_year#41339, d_qoy#41340, null, null, 3), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41335, i_class#41336, i_brand#41337, i_product_name#41338, d_year#41339, null, null, null, 7), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41335, i_class#41336, i_brand#41337, i_product_name#41338, null, null, null, null, 15), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41335, i_class#41336, i_brand#41337, null, null, null, null, null, 31), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41335, i_class#41336, null, null, null, null, null, null, 63), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41335, null, null, null, null, null, null, null, 127), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, null, null, null, null, null, null, 255)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 87 more fields]
                                    +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 86 more fields]
                                       +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_store_sk#137 = s_store_sk#664) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11)))))
                                          +- Join Inner
                                             :- Join Inner
                                             :  :- Join Inner
                                             :  :  :- SubqueryAlias `store_sales`
                                             :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                             :  :  +- SubqueryAlias `date_dim`
                                             :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                             :  +- SubqueryAlias `store`
                                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                                             +- SubqueryAlias `item`
                                                +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
19/09/08 20:09:39 ERROR TaskSchedulerImpl: Lost executor 63 on 192.168.35.237:
The executor with id 63 exited with exit code -1.
The API gave the following brief reason: Evicted
The API gave the following message: The node was low on resource: ephemeral-storage. Container executor was using 8164Ki, which exceeds its request of 0.
The API gave the following container statuses:



19/09/08 20:09:39 WARN TaskSetManager: Lost task 103.0 in stage 884.0 (TID 212570, 192.168.35.237, executor 63): ExecutorLostFailure (executor 63 exited caused by one of the running tasks) Reason:
The executor with id 63 exited with exit code -1.
The API gave the following brief reason: Evicted
The API gave the following message: The node was low on resource: ephemeral-storage. Container executor was using 8164Ki, which exceeds its request of 0.
The API gave the following container statuses:



19/09/08 20:09:48 WARN TransportChannelHandler: Exception in connection from /192.168.35.237:60686
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/09/08 20:12:46 WARN TaskSetManager: Lost task 103.1 in stage 884.0 (TID 212667, 192.168.12.97, executor 47): FetchFailed(BlockManagerId(63, 192.168.35.237, 36285, None), shuffleId=440, mapId=51, reduceId=103, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.35.237:36285
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage6.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.window.WindowExec$$anonfun$11$$anon$1.fetchNextRow(WindowExec.scala:314)
	at org.apache.spark.sql.execution.window.WindowExec$$anonfun$11$$anon$1.<init>(WindowExec.scala:323)
	at org.apache.spark.sql.execution.window.WindowExec$$anonfun$11.apply(WindowExec.scala:303)
	at org.apache.spark.sql.execution.window.WindowExec$$anonfun$11.apply(WindowExec.scala:302)
	at org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:801)
	at org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:801)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:90)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.35.237:36285
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.35.237:36285
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
Execution time: 1120.3789339149998s
Running execution q68-v2.4 iteration: 1, StandardRun=true
19/09/08 20:19:35 INFO Query:
== Query: q68-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_last_name#421 ASC NULLS FIRST, ss_ticket_number#139L ASC NULLS FIRST], true
      +- Project [c_last_name#421, c_first_name#420, ca_city#454, bought_city#41476, ss_ticket_number#139L, extended_price#41477, extended_tax#41479, list_price#41478]
         +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && NOT (ca_city#454 = bought_city#41476))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dn`
               :  :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133, ss_addr_sk#136, ca_city#454], [ss_ticket_number#139L, ss_customer_sk#133, ca_city#454 AS bought_city#41476, sum(ss_ext_sales_price#145) AS extended_price#41477, sum(ss_ext_list_price#147) AS list_price#41478, sum(ss_ext_tax#148) AS extended_tax#41479]
               :  :     +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_hdemo_sk#135 = hd_demo_sk#548) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((d_dom#501 >= 1) && (d_dom#501 <= 2)) && ((hd_dep_count#551 = 4) || (hd_vehicle_count#552 = 3))) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_city#686 IN (Midway,Fairview))))
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- Join Inner
               :  :           :  :  :- Join Inner
               :  :           :  :  :  :- SubqueryAlias `store_sales`
               :  :           :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  :  :  +- SubqueryAlias `date_dim`
               :  :           :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           :  :  +- SubqueryAlias `store`
               :  :           :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :  :           :  +- SubqueryAlias `household_demographics`
               :  :           :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  :           +- SubqueryAlias `customer_address`
               :  :              +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer`
               :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               +- SubqueryAlias `current_addr`
                  +- SubqueryAlias `customer_address`
                     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

     : benchmark
19/09/08 20:19:35 INFO Query:
== Query: q68-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_last_name#421 ASC NULLS FIRST, ss_ticket_number#139L ASC NULLS FIRST], true
      +- Project [c_last_name#421, c_first_name#420, ca_city#454, bought_city#41491, ss_ticket_number#139L, extended_price#41492, extended_tax#41494, list_price#41493]
         +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && NOT (ca_city#454 = bought_city#41491))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dn`
               :  :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133, ss_addr_sk#136, ca_city#454], [ss_ticket_number#139L, ss_customer_sk#133, ca_city#454 AS bought_city#41491, sum(ss_ext_sales_price#145) AS extended_price#41492, sum(ss_ext_list_price#147) AS list_price#41493, sum(ss_ext_tax#148) AS extended_tax#41494]
               :  :     +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_hdemo_sk#135 = hd_demo_sk#548) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((d_dom#501 >= 1) && (d_dom#501 <= 2)) && ((hd_dep_count#551 = 4) || (hd_vehicle_count#552 = 3))) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_city#686 IN (Midway,Fairview))))
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- Join Inner
               :  :           :  :  :- Join Inner
               :  :           :  :  :  :- SubqueryAlias `store_sales`
               :  :           :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  :  :  +- SubqueryAlias `date_dim`
               :  :           :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           :  :  +- SubqueryAlias `store`
               :  :           :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :  :           :  +- SubqueryAlias `household_demographics`
               :  :           :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  :           +- SubqueryAlias `customer_address`
               :  :              +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer`
               :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               +- SubqueryAlias `current_addr`
                  +- SubqueryAlias `customer_address`
                     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

      running Thread[benchmark runner,5,main]
Execution time: 24.226195135999998s
Running execution q69-v2.4 iteration: 1, StandardRun=true
19/09/08 20:20:01 INFO Query:
== Query: q69-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cd_gender#475 ASC NULLS FIRST, cd_marital_status#476 ASC NULLS FIRST, cd_education_status#477 ASC NULLS FIRST, cd_purchase_estimate#478 ASC NULLS FIRST, cd_credit_rating#479 ASC NULLS FIRST], true
      +- Aggregate [cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479], [cd_gender#475, cd_marital_status#476, cd_education_status#477, count(1) AS cnt1#41562L, cd_purchase_estimate#478, count(1) AS cnt2#41563L, cd_credit_rating#479, count(1) AS cnt3#41564L]
         +- Filter ((((c_current_addr_sk#416 = ca_address_sk#448) && ca_state#456 IN (KY,GA,NM)) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && (exists#41565 [c_customer_sk#412] && (NOT exists#41566 [c_customer_sk#412] && NOT exists#41567 [c_customer_sk#412])))
            :  :- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 27 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = 2001) && ((d_moy#500 >= 4) && (d_moy#500 <= (4 + 2)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `store_sales`
            :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 38 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = 2001) && ((d_moy#500 >= 4) && (d_moy#500 <= (4 + 2)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `web_sales`
            :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 38 more fields]
            :     +- Filter (((outer(c_customer_sk#412) = cs_ship_customer_sk#7) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = 2001) && ((d_moy#500 >= 4) && (d_moy#500 <= (4 + 2)))))
            :        +- Join Inner
            :           :- SubqueryAlias `catalog_sales`
            :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :           +- SubqueryAlias `date_dim`
            :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `c`
               :  :  +- SubqueryAlias `customer`
               :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  +- SubqueryAlias `ca`
               :     +- SubqueryAlias `customer_address`
               :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer_demographics`
                  +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet

     : benchmark
19/09/08 20:20:01 INFO Query:
== Query: q69-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cd_gender#475 ASC NULLS FIRST, cd_marital_status#476 ASC NULLS FIRST, cd_education_status#477 ASC NULLS FIRST, cd_purchase_estimate#478 ASC NULLS FIRST, cd_credit_rating#479 ASC NULLS FIRST], true
      +- Aggregate [cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479], [cd_gender#475, cd_marital_status#476, cd_education_status#477, count(1) AS cnt1#41579L, cd_purchase_estimate#478, count(1) AS cnt2#41580L, cd_credit_rating#479, count(1) AS cnt3#41581L]
         +- Filter ((((c_current_addr_sk#416 = ca_address_sk#448) && ca_state#456 IN (KY,GA,NM)) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && (exists#41582 [c_customer_sk#412] && (NOT exists#41583 [c_customer_sk#412] && NOT exists#41584 [c_customer_sk#412])))
            :  :- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 27 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = 2001) && ((d_moy#500 >= 4) && (d_moy#500 <= (4 + 2)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `store_sales`
            :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 38 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = 2001) && ((d_moy#500 >= 4) && (d_moy#500 <= (4 + 2)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `web_sales`
            :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 38 more fields]
            :     +- Filter (((outer(c_customer_sk#412) = cs_ship_customer_sk#7) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = 2001) && ((d_moy#500 >= 4) && (d_moy#500 <= (4 + 2)))))
            :        +- Join Inner
            :           :- SubqueryAlias `catalog_sales`
            :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :           +- SubqueryAlias `date_dim`
            :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `c`
               :  :  +- SubqueryAlias `customer`
               :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  +- SubqueryAlias `ca`
               :     +- SubqueryAlias `customer_address`
               :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer_demographics`
                  +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet

      running Thread[benchmark runner,5,main]
Execution time: 21.43007834s
Running execution q70-v2.4 iteration: 1, StandardRun=true
19/09/08 20:20:24 INFO Query:
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#41700 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#41700 as int) = 0) THEN s_state#41722 END ASC NULLS FIRST, rank_within_parent#41701 ASC NULLS FIRST], true
      +- Project [total_sum#41699, s_state#41722, s_county#41723, lochierarchy#41700, rank_within_parent#41701]
         +- Project [total_sum#41699, s_state#41722, s_county#41723, lochierarchy#41700, _w0#41732, _w1#41736, _w2#41737, _w3#41738, rank_within_parent#41701, rank_within_parent#41701]
            +- Window [rank(_w3#41738) windowspecdefinition(_w1#41736, _w2#41737, _w3#41738 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#41701], [_w1#41736, _w2#41737], [_w3#41738 DESC NULLS LAST]
               +- Aggregate [s_state#41722, s_county#41723, spark_grouping_id#41719], [sum(ss_net_profit#152) AS total_sum#41699, s_state#41722, s_county#41723, (cast((shiftright(spark_grouping_id#41719, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#41719, 0) & 1) as tinyint)) AS lochierarchy#41700, sum(ss_net_profit#152) AS _w0#41732, (cast((shiftright(spark_grouping_id#41719, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#41719, 0) & 1) as tinyint)) AS _w1#41736, CASE WHEN (cast(cast((shiftright(spark_grouping_id#41719, 0) & 1) as tinyint) as int) = 0) THEN s_state#41722 END AS _w2#41737, sum(ss_net_profit#152) AS _w3#41738]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#41720, s_county#41721, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#41720, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#41704 [])))
                           :  +- Project [s_state#41702]
                           :     +- Filter (ranking#41703 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#41702, ranking#41703]
                           :              +- Project [s_state#41702, s_state#688, _w1#41710, ranking#41703, ranking#41703]
                           :                 +- Window [rank(_w1#41710) windowspecdefinition(s_state#688, _w1#41710 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#41703], [s_state#688], [_w1#41710 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#41702, s_state#688, sum(ss_net_profit#152) AS _w1#41710]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/09/08 20:20:24 INFO Query:
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#41754 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#41754 as int) = 0) THEN s_state#41776 END ASC NULLS FIRST, rank_within_parent#41755 ASC NULLS FIRST], true
      +- Project [total_sum#41753, s_state#41776, s_county#41777, lochierarchy#41754, rank_within_parent#41755]
         +- Project [total_sum#41753, s_state#41776, s_county#41777, lochierarchy#41754, _w0#41786, _w1#41790, _w2#41791, _w3#41792, rank_within_parent#41755, rank_within_parent#41755]
            +- Window [rank(_w3#41792) windowspecdefinition(_w1#41790, _w2#41791, _w3#41792 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#41755], [_w1#41790, _w2#41791], [_w3#41792 DESC NULLS LAST]
               +- Aggregate [s_state#41776, s_county#41777, spark_grouping_id#41773], [sum(ss_net_profit#152) AS total_sum#41753, s_state#41776, s_county#41777, (cast((shiftright(spark_grouping_id#41773, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#41773, 0) & 1) as tinyint)) AS lochierarchy#41754, sum(ss_net_profit#152) AS _w0#41786, (cast((shiftright(spark_grouping_id#41773, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#41773, 0) & 1) as tinyint)) AS _w1#41790, CASE WHEN (cast(cast((shiftright(spark_grouping_id#41773, 0) & 1) as tinyint) as int) = 0) THEN s_state#41776 END AS _w2#41791, sum(ss_net_profit#152) AS _w3#41792]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#41774, s_county#41775, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#41774, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#41758 [])))
                           :  +- Project [s_state#41756]
                           :     +- Filter (ranking#41757 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#41756, ranking#41757]
                           :              +- Project [s_state#41756, s_state#688, _w1#41764, ranking#41757, ranking#41757]
                           :                 +- Window [rank(_w1#41764) windowspecdefinition(s_state#688, _w1#41764 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#41757], [s_state#688], [_w1#41764 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#41756, s_state#688, sum(ss_net_profit#152) AS _w1#41764]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 18.634678622s
Running execution q71-v2.4 iteration: 1, StandardRun=true
19/09/08 20:20:44 INFO Query:
== Query: q71-v2.4 ==
Project [brand_id#41966, brand#41967, t_hour#725, t_minute#726, ext_price#41968]
+- Sort [ext_price#41968 DESC NULLS LAST, brand_id#41966 ASC NULLS FIRST], true
   +- Aggregate [i_brand#572, i_brand_id#571, t_hour#725, t_minute#726], [i_brand_id#571 AS brand_id#41966, i_brand#572 AS brand#41967, t_hour#725, t_minute#726, sum(ext_price#41954) AS ext_price#41968]
      +- Filter (((sold_item_sk#41956 = i_item_sk#564) && (i_manager_id#584 = 1)) && ((time_sk#41957 = t_time_sk#722) && ((t_meal_time#731 = breakfast) || (t_meal_time#731 = dinner))))
         +- Join Inner
            :- Join Inner
            :  :- SubqueryAlias `item`
            :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            :  +- SubqueryAlias `tmp`
            :     +- Union
            :        :- Union
            :        :  :- Project [ws_ext_sales_price#239 AS ext_price#41954, ws_sold_date_sk#216 AS sold_date_sk#41955, ws_item_sk#219 AS sold_item_sk#41956, ws_sold_time_sk#217 AS time_sk#41957]
            :        :  :  +- Filter (((d_date_sk#492 = ws_sold_date_sk#216) && (d_moy#500 = 11)) && (d_year#498 = 1999))
            :        :  :     +- Join Inner
            :        :  :        :- SubqueryAlias `web_sales`
            :        :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :        :  :        +- SubqueryAlias `date_dim`
            :        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :        :  +- Project [cs_ext_sales_price#23 AS ext_price#41958, cs_sold_date_sk#0 AS sold_date_sk#41959, cs_item_sk#15 AS sold_item_sk#41960, cs_sold_time_sk#1 AS time_sk#41961]
            :        :     +- Filter (((d_date_sk#492 = cs_sold_date_sk#0) && (d_moy#500 = 11)) && (d_year#498 = 1999))
            :        :        +- Join Inner
            :        :           :- SubqueryAlias `catalog_sales`
            :        :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :        :           +- SubqueryAlias `date_dim`
            :        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :        +- Project [ss_ext_sales_price#145 AS ext_price#41962, ss_sold_date_sk#130 AS sold_date_sk#41963, ss_item_sk#132 AS sold_item_sk#41964, ss_sold_time_sk#131 AS time_sk#41965]
            :           +- Filter (((d_date_sk#492 = ss_sold_date_sk#130) && (d_moy#500 = 11)) && (d_year#498 = 1999))
            :              +- Join Inner
            :                 :- SubqueryAlias `store_sales`
            :                 :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :                 +- SubqueryAlias `date_dim`
            :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- SubqueryAlias `time_dim`
               +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet

     : benchmark
19/09/08 20:20:44 INFO Query:
== Query: q71-v2.4 ==
Project [brand_id#41990, brand#41991, t_hour#725, t_minute#726, ext_price#41992]
+- Sort [ext_price#41992 DESC NULLS LAST, brand_id#41990 ASC NULLS FIRST], true
   +- Aggregate [i_brand#572, i_brand_id#571, t_hour#725, t_minute#726], [i_brand_id#571 AS brand_id#41990, i_brand#572 AS brand#41991, t_hour#725, t_minute#726, sum(ext_price#41978) AS ext_price#41992]
      +- Filter (((sold_item_sk#41980 = i_item_sk#564) && (i_manager_id#584 = 1)) && ((time_sk#41981 = t_time_sk#722) && ((t_meal_time#731 = breakfast) || (t_meal_time#731 = dinner))))
         +- Join Inner
            :- Join Inner
            :  :- SubqueryAlias `item`
            :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            :  +- SubqueryAlias `tmp`
            :     +- Union
            :        :- Union
            :        :  :- Project [ws_ext_sales_price#239 AS ext_price#41978, ws_sold_date_sk#216 AS sold_date_sk#41979, ws_item_sk#219 AS sold_item_sk#41980, ws_sold_time_sk#217 AS time_sk#41981]
            :        :  :  +- Filter (((d_date_sk#492 = ws_sold_date_sk#216) && (d_moy#500 = 11)) && (d_year#498 = 1999))
            :        :  :     +- Join Inner
            :        :  :        :- SubqueryAlias `web_sales`
            :        :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :        :  :        +- SubqueryAlias `date_dim`
            :        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :        :  +- Project [cs_ext_sales_price#23 AS ext_price#41982, cs_sold_date_sk#0 AS sold_date_sk#41983, cs_item_sk#15 AS sold_item_sk#41984, cs_sold_time_sk#1 AS time_sk#41985]
            :        :     +- Filter (((d_date_sk#492 = cs_sold_date_sk#0) && (d_moy#500 = 11)) && (d_year#498 = 1999))
            :        :        +- Join Inner
            :        :           :- SubqueryAlias `catalog_sales`
            :        :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :        :           +- SubqueryAlias `date_dim`
            :        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :        +- Project [ss_ext_sales_price#145 AS ext_price#41986, ss_sold_date_sk#130 AS sold_date_sk#41987, ss_item_sk#132 AS sold_item_sk#41988, ss_sold_time_sk#131 AS time_sk#41989]
            :           +- Filter (((d_date_sk#492 = ss_sold_date_sk#130) && (d_moy#500 = 11)) && (d_year#498 = 1999))
            :              +- Join Inner
            :                 :- SubqueryAlias `store_sales`
            :                 :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :                 +- SubqueryAlias `date_dim`
            :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- SubqueryAlias `time_dim`
               +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet

      running Thread[benchmark runner,5,main]
Execution time: 21.102209701s
Running execution q72-v2.4 iteration: 1, StandardRun=true
19/09/08 20:21:07 INFO Query:
== Query: q72-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [total_cnt#42133L DESC NULLS LAST, i_item_desc#568 ASC NULLS FIRST, w_warehouse_name#744 ASC NULLS FIRST, d_week_seq#496 ASC NULLS FIRST], true
      +- Aggregate [i_item_desc#568, w_warehouse_name#744, d_week_seq#496], [i_item_desc#568, w_warehouse_name#744, d_week_seq#496, sum(cast(CASE WHEN isnull(p_promo_sk#608) THEN 1 ELSE 0 END as bigint)) AS no_promo#42131L, sum(cast(CASE WHEN isnotnull(p_promo_sk#608) THEN 1 ELSE 0 END as bigint)) AS promo#42132L, count(1) AS total_cnt#42133L]
         +- Filter ((((d_week_seq#496 = d_week_seq#42138) && (inv_quantity_on_hand#125 < cs_quantity#18)) && (d_date#42165 > cast(cast(cast(d_date#494 as date) as timestamp) + interval 5 days as date))) && (((hd_buy_potential#550 = >10000) && (d_year#498 = 1999)) && (cd_marital_status#476 = D)))
            +- Join LeftOuter, ((cr_item_sk#70 = cs_item_sk#15) && (cr_order_number#84L = cs_order_number#17L))
               :- Join LeftOuter, (cs_promo_sk#16 = p_promo_sk#608)
               :  :- Join Inner, (cs_ship_date_sk#2 = d_date_sk#42163)
               :  :  :- Join Inner, (inv_date_sk#122 = d_date_sk#42134)
               :  :  :  :- Join Inner, (cs_sold_date_sk#0 = d_date_sk#492)
               :  :  :  :  :- Join Inner, (cs_bill_hdemo_sk#5 = hd_demo_sk#548)
               :  :  :  :  :  :- Join Inner, (cs_bill_cdemo_sk#4 = cd_demo_sk#474)
               :  :  :  :  :  :  :- Join Inner, (i_item_sk#564 = cs_item_sk#15)
               :  :  :  :  :  :  :  :- Join Inner, (w_warehouse_sk#742 = inv_warehouse_sk#124)
               :  :  :  :  :  :  :  :  :- Join Inner, (cs_item_sk#15 = inv_item_sk#123)
               :  :  :  :  :  :  :  :  :  :- SubqueryAlias `catalog_sales`
               :  :  :  :  :  :  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :  :  :  :  :  :  +- SubqueryAlias `inventory`
               :  :  :  :  :  :  :  :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  :  :  :  :  :  :  :  +- SubqueryAlias `warehouse`
               :  :  :  :  :  :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
               :  :  :  :  :  :  :  +- SubqueryAlias `item`
               :  :  :  :  :  :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  :  :  :  :  +- SubqueryAlias `customer_demographics`
               :  :  :  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
               :  :  :  :  :  +- SubqueryAlias `household_demographics`
               :  :  :  :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  :  :  :  +- SubqueryAlias `d1`
               :  :  :  :     +- SubqueryAlias `date_dim`
               :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  +- SubqueryAlias `d2`
               :  :  :     +- SubqueryAlias `date_dim`
               :  :  :        +- Relation[d_date_sk#42134,d_date_id#42135,d_date#42136,d_month_seq#42137,d_week_seq#42138,d_quarter_seq#42139,d_year#42140,d_dow#42141,d_moy#42142,d_dom#42143,d_qoy#42144,d_fy_year#42145,d_fy_quarter_seq#42146,d_fy_week_seq#42147,d_day_name#42148,d_quarter_name#42149,d_holiday#42150,d_weekend#42151,d_following_holiday#42152,d_first_dom#42153,d_last_dom#42154,d_same_day_ly#42155,d_same_day_lq#42156,d_current_day#42157,... 4 more fields] parquet
               :  :  +- SubqueryAlias `d3`
               :  :     +- SubqueryAlias `date_dim`
               :  :        +- Relation[d_date_sk#42163,d_date_id#42164,d_date#42165,d_month_seq#42166,d_week_seq#42167,d_quarter_seq#42168,d_year#42169,d_dow#42170,d_moy#42171,d_dom#42172,d_qoy#42173,d_fy_year#42174,d_fy_quarter_seq#42175,d_fy_week_seq#42176,d_day_name#42177,d_quarter_name#42178,d_holiday#42179,d_weekend#42180,d_following_holiday#42181,d_first_dom#42182,d_last_dom#42183,d_same_day_ly#42184,d_same_day_lq#42185,d_current_day#42186,... 4 more fields] parquet
               :  +- SubqueryAlias `promotion`
               :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
               +- SubqueryAlias `catalog_returns`
                  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet

     : benchmark
19/09/08 20:21:07 INFO Query:
== Query: q72-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [total_cnt#42205L DESC NULLS LAST, i_item_desc#568 ASC NULLS FIRST, w_warehouse_name#744 ASC NULLS FIRST, d_week_seq#496 ASC NULLS FIRST], true
      +- Aggregate [i_item_desc#568, w_warehouse_name#744, d_week_seq#496], [i_item_desc#568, w_warehouse_name#744, d_week_seq#496, sum(cast(CASE WHEN isnull(p_promo_sk#608) THEN 1 ELSE 0 END as bigint)) AS no_promo#42203L, sum(cast(CASE WHEN isnotnull(p_promo_sk#608) THEN 1 ELSE 0 END as bigint)) AS promo#42204L, count(1) AS total_cnt#42205L]
         +- Filter ((((d_week_seq#496 = d_week_seq#42210) && (inv_quantity_on_hand#125 < cs_quantity#18)) && (d_date#42237 > cast(cast(cast(d_date#494 as date) as timestamp) + interval 5 days as date))) && (((hd_buy_potential#550 = >10000) && (d_year#498 = 1999)) && (cd_marital_status#476 = D)))
            +- Join LeftOuter, ((cr_item_sk#70 = cs_item_sk#15) && (cr_order_number#84L = cs_order_number#17L))
               :- Join LeftOuter, (cs_promo_sk#16 = p_promo_sk#608)
               :  :- Join Inner, (cs_ship_date_sk#2 = d_date_sk#42235)
               :  :  :- Join Inner, (inv_date_sk#122 = d_date_sk#42206)
               :  :  :  :- Join Inner, (cs_sold_date_sk#0 = d_date_sk#492)
               :  :  :  :  :- Join Inner, (cs_bill_hdemo_sk#5 = hd_demo_sk#548)
               :  :  :  :  :  :- Join Inner, (cs_bill_cdemo_sk#4 = cd_demo_sk#474)
               :  :  :  :  :  :  :- Join Inner, (i_item_sk#564 = cs_item_sk#15)
               :  :  :  :  :  :  :  :- Join Inner, (w_warehouse_sk#742 = inv_warehouse_sk#124)
               :  :  :  :  :  :  :  :  :- Join Inner, (cs_item_sk#15 = inv_item_sk#123)
               :  :  :  :  :  :  :  :  :  :- SubqueryAlias `catalog_sales`
               :  :  :  :  :  :  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :  :  :  :  :  :  +- SubqueryAlias `inventory`
               :  :  :  :  :  :  :  :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  :  :  :  :  :  :  :  +- SubqueryAlias `warehouse`
               :  :  :  :  :  :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
               :  :  :  :  :  :  :  +- SubqueryAlias `item`
               :  :  :  :  :  :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  :  :  :  :  +- SubqueryAlias `customer_demographics`
               :  :  :  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
               :  :  :  :  :  +- SubqueryAlias `household_demographics`
               :  :  :  :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  :  :  :  +- SubqueryAlias `d1`
               :  :  :  :     +- SubqueryAlias `date_dim`
               :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  +- SubqueryAlias `d2`
               :  :  :     +- SubqueryAlias `date_dim`
               :  :  :        +- Relation[d_date_sk#42206,d_date_id#42207,d_date#42208,d_month_seq#42209,d_week_seq#42210,d_quarter_seq#42211,d_year#42212,d_dow#42213,d_moy#42214,d_dom#42215,d_qoy#42216,d_fy_year#42217,d_fy_quarter_seq#42218,d_fy_week_seq#42219,d_day_name#42220,d_quarter_name#42221,d_holiday#42222,d_weekend#42223,d_following_holiday#42224,d_first_dom#42225,d_last_dom#42226,d_same_day_ly#42227,d_same_day_lq#42228,d_current_day#42229,... 4 more fields] parquet
               :  :  +- SubqueryAlias `d3`
               :  :     +- SubqueryAlias `date_dim`
               :  :        +- Relation[d_date_sk#42235,d_date_id#42236,d_date#42237,d_month_seq#42238,d_week_seq#42239,d_quarter_seq#42240,d_year#42241,d_dow#42242,d_moy#42243,d_dom#42244,d_qoy#42245,d_fy_year#42246,d_fy_quarter_seq#42247,d_fy_week_seq#42248,d_day_name#42249,d_quarter_name#42250,d_holiday#42251,d_weekend#42252,d_following_holiday#42253,d_first_dom#42254,d_last_dom#42255,d_same_day_ly#42256,d_same_day_lq#42257,d_current_day#42258,... 4 more fields] parquet
               :  +- SubqueryAlias `promotion`
               :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
               +- SubqueryAlias `catalog_returns`
                  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 862.3219775059999s
Running execution q73-v2.4 iteration: 1, StandardRun=true
19/09/08 20:35:32 INFO Query:
== Query: q73-v2.4 ==
Sort [cnt#42436L DESC NULLS LAST, c_last_name#421 ASC NULLS FIRST], true
+- Project [c_last_name#421, c_first_name#420, c_salutation#419, c_preferred_cust_flag#422, ss_ticket_number#139L, cnt#42436L]
   +- Filter ((ss_customer_sk#133 = c_customer_sk#412) && ((cnt#42436L >= cast(1 as bigint)) && (cnt#42436L <= cast(5 as bigint))))
      +- Join Inner
         :- SubqueryAlias `dj`
         :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133], [ss_ticket_number#139L, ss_customer_sk#133, count(1) AS cnt#42436L]
         :     +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (((d_dom#501 >= 1) && (d_dom#501 <= 2)) && ((hd_buy_potential#550 = >10000) || (hd_buy_potential#550 = unknown)))) && (((hd_vehicle_count#552 > 0) && (CASE WHEN (hd_vehicle_count#552 > 0) THEN (cast(hd_dep_count#551 as double) / cast(hd_vehicle_count#552 as double)) ELSE cast(null as double) END > cast(1 as double))) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_county#687 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
         :        +- Join Inner
         :           :- Join Inner
         :           :  :- Join Inner
         :           :  :  :- SubqueryAlias `store_sales`
         :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :           :  :  +- SubqueryAlias `date_dim`
         :           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :           :  +- SubqueryAlias `store`
         :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :           +- SubqueryAlias `household_demographics`
         :              +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         +- SubqueryAlias `customer`
            +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/09/08 20:35:32 INFO Query:
== Query: q73-v2.4 ==
Sort [cnt#42444L DESC NULLS LAST, c_last_name#421 ASC NULLS FIRST], true
+- Project [c_last_name#421, c_first_name#420, c_salutation#419, c_preferred_cust_flag#422, ss_ticket_number#139L, cnt#42444L]
   +- Filter ((ss_customer_sk#133 = c_customer_sk#412) && ((cnt#42444L >= cast(1 as bigint)) && (cnt#42444L <= cast(5 as bigint))))
      +- Join Inner
         :- SubqueryAlias `dj`
         :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133], [ss_ticket_number#139L, ss_customer_sk#133, count(1) AS cnt#42444L]
         :     +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (((d_dom#501 >= 1) && (d_dom#501 <= 2)) && ((hd_buy_potential#550 = >10000) || (hd_buy_potential#550 = unknown)))) && (((hd_vehicle_count#552 > 0) && (CASE WHEN (hd_vehicle_count#552 > 0) THEN (cast(hd_dep_count#551 as double) / cast(hd_vehicle_count#552 as double)) ELSE cast(null as double) END > cast(1 as double))) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_county#687 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
         :        +- Join Inner
         :           :- Join Inner
         :           :  :- Join Inner
         :           :  :  :- SubqueryAlias `store_sales`
         :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :           :  :  +- SubqueryAlias `date_dim`
         :           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :           :  +- SubqueryAlias `store`
         :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :           +- SubqueryAlias `household_demographics`
         :              +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         +- SubqueryAlias `customer`
            +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 11.641086328s
Running execution q74-v2.4 iteration: 1, StandardRun=true
19/09/08 20:35:45 INFO Query:
== Query: q74-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#42535 ASC NULLS FIRST, customer_id#42535 ASC NULLS FIRST, customer_id#42535 ASC NULLS FIRST], true
      +- Project [customer_id#42535, customer_first_name#42536, customer_last_name#42537]
         +- Filter (((((customer_id#42535 = customer_id#42521) && (customer_id#42521 = customer_id#42547)) && ((customer_id#42521 = customer_id#42541) && (sale_type#42526 = s))) && (((sale_type#42546 = w) && (sale_type#42540 = s)) && (sale_type#42552 = w))) && ((((year#42524 = 2001) && (year#42538 = (2001 + 1))) && ((year#42544 = 2001) && (year#42550 = (2001 + 1)))) && (((cast(year_total#42525 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) && (cast(year_total#42545 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2)))) && (CASE WHEN (cast(year_total#42545 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(year_total#42551 as decimal(17,2))) / promote_precision(cast(year_total#42545 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END > CASE WHEN (cast(year_total#42525 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(year_total#42539 as decimal(17,2))) / promote_precision(cast(year_total#42525 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `t_s_firstyear`
               :  :  :  +- SubqueryAlias `year_total`
               :  :  :     +- Union
               :  :  :        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42521, c_first_name#420 AS customer_first_name#42522, c_last_name#421 AS customer_last_name#42523, d_year#498 AS year#42524, sum(ss_net_paid#150) AS year_total#42525, s AS sale_type#42526]
               :  :  :        :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :  :        :     +- Join Inner
               :  :  :        :        :- Join Inner
               :  :  :        :        :  :- SubqueryAlias `customer`
               :  :  :        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :        :        :  +- SubqueryAlias `store_sales`
               :  :  :        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :        :        +- SubqueryAlias `date_dim`
               :  :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42527, c_first_name#420 AS customer_first_name#42528, c_last_name#421 AS customer_last_name#42529, d_year#498 AS year#42530, sum(ws_net_paid#245) AS year_total#42531, w AS sale_type#42532]
               :  :  :           +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :  :              +- Join Inner
               :  :  :                 :- Join Inner
               :  :  :                 :  :- SubqueryAlias `customer`
               :  :  :                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :                 :  +- SubqueryAlias `web_sales`
               :  :  :                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :                 +- SubqueryAlias `date_dim`
               :  :  :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  +- SubqueryAlias `t_s_secyear`
               :  :     +- SubqueryAlias `year_total`
               :  :        +- Union
               :  :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42535, c_first_name#420 AS customer_first_name#42536, c_last_name#421 AS customer_last_name#42537, d_year#498 AS year#42538, sum(ss_net_paid#150) AS year_total#42539, s AS sale_type#42540]
               :  :           :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :           :     +- Join Inner
               :  :           :        :- Join Inner
               :  :           :        :  :- SubqueryAlias `customer`
               :  :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :        :  +- SubqueryAlias `store_sales`
               :  :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :        +- SubqueryAlias `date_dim`
               :  :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42527, c_first_name#420 AS customer_first_name#42528, c_last_name#421 AS customer_last_name#42529, d_year#498 AS year#42530, sum(ws_net_paid#245) AS year_total#42531, w AS sale_type#42532]
               :  :              +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :                 +- Join Inner
               :  :                    :- Join Inner
               :  :                    :  :- SubqueryAlias `customer`
               :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :                    :  +- SubqueryAlias `web_sales`
               :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :                    +- SubqueryAlias `date_dim`
               :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `t_w_firstyear`
               :     +- SubqueryAlias `year_total`
               :        +- Union
               :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42541, c_first_name#420 AS customer_first_name#42542, c_last_name#421 AS customer_last_name#42543, d_year#498 AS year#42544, sum(ss_net_paid#150) AS year_total#42545, s AS sale_type#42546]
               :           :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :           :     +- Join Inner
               :           :        :- Join Inner
               :           :        :  :- SubqueryAlias `customer`
               :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :        :  +- SubqueryAlias `store_sales`
               :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42527, c_first_name#420 AS customer_first_name#42528, c_last_name#421 AS customer_last_name#42529, d_year#498 AS year#42530, sum(ws_net_paid#245) AS year_total#42531, w AS sale_type#42532]
               :              +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :                 +- Join Inner
               :                    :- Join Inner
               :                    :  :- SubqueryAlias `customer`
               :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :                    :  +- SubqueryAlias `web_sales`
               :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `t_w_secyear`
                  +- SubqueryAlias `year_total`
                     +- Union
                        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42547, c_first_name#420 AS customer_first_name#42548, c_last_name#421 AS customer_last_name#42549, d_year#498 AS year#42550, sum(ss_net_paid#150) AS year_total#42551, s AS sale_type#42552]
                        :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
                        :     +- Join Inner
                        :        :- Join Inner
                        :        :  :- SubqueryAlias `customer`
                        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :        :  +- SubqueryAlias `store_sales`
                        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42527, c_first_name#420 AS customer_first_name#42528, c_last_name#421 AS customer_last_name#42529, d_year#498 AS year#42530, sum(ws_net_paid#245) AS year_total#42531, w AS sale_type#42532]
                           +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `customer`
                                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                                 :  +- SubqueryAlias `web_sales`
                                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 20:35:45 INFO Query:
== Query: q74-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#42570 ASC NULLS FIRST, customer_id#42570 ASC NULLS FIRST, customer_id#42570 ASC NULLS FIRST], true
      +- Project [customer_id#42570, customer_first_name#42571, customer_last_name#42572]
         +- Filter (((((customer_id#42570 = customer_id#42556) && (customer_id#42556 = customer_id#42582)) && ((customer_id#42556 = customer_id#42576) && (sale_type#42561 = s))) && (((sale_type#42581 = w) && (sale_type#42575 = s)) && (sale_type#42587 = w))) && ((((year#42559 = 2001) && (year#42573 = (2001 + 1))) && ((year#42579 = 2001) && (year#42585 = (2001 + 1)))) && (((cast(year_total#42560 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) && (cast(year_total#42580 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2)))) && (CASE WHEN (cast(year_total#42580 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(year_total#42586 as decimal(17,2))) / promote_precision(cast(year_total#42580 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END > CASE WHEN (cast(year_total#42560 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(year_total#42574 as decimal(17,2))) / promote_precision(cast(year_total#42560 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `t_s_firstyear`
               :  :  :  +- SubqueryAlias `year_total`
               :  :  :     +- Union
               :  :  :        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42556, c_first_name#420 AS customer_first_name#42557, c_last_name#421 AS customer_last_name#42558, d_year#498 AS year#42559, sum(ss_net_paid#150) AS year_total#42560, s AS sale_type#42561]
               :  :  :        :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :  :        :     +- Join Inner
               :  :  :        :        :- Join Inner
               :  :  :        :        :  :- SubqueryAlias `customer`
               :  :  :        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :        :        :  +- SubqueryAlias `store_sales`
               :  :  :        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :        :        +- SubqueryAlias `date_dim`
               :  :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42562, c_first_name#420 AS customer_first_name#42563, c_last_name#421 AS customer_last_name#42564, d_year#498 AS year#42565, sum(ws_net_paid#245) AS year_total#42566, w AS sale_type#42567]
               :  :  :           +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :  :              +- Join Inner
               :  :  :                 :- Join Inner
               :  :  :                 :  :- SubqueryAlias `customer`
               :  :  :                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :                 :  +- SubqueryAlias `web_sales`
               :  :  :                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :                 +- SubqueryAlias `date_dim`
               :  :  :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  +- SubqueryAlias `t_s_secyear`
               :  :     +- SubqueryAlias `year_total`
               :  :        +- Union
               :  :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42570, c_first_name#420 AS customer_first_name#42571, c_last_name#421 AS customer_last_name#42572, d_year#498 AS year#42573, sum(ss_net_paid#150) AS year_total#42574, s AS sale_type#42575]
               :  :           :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :           :     +- Join Inner
               :  :           :        :- Join Inner
               :  :           :        :  :- SubqueryAlias `customer`
               :  :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :        :  +- SubqueryAlias `store_sales`
               :  :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :        +- SubqueryAlias `date_dim`
               :  :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42562, c_first_name#420 AS customer_first_name#42563, c_last_name#421 AS customer_last_name#42564, d_year#498 AS year#42565, sum(ws_net_paid#245) AS year_total#42566, w AS sale_type#42567]
               :  :              +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :                 +- Join Inner
               :  :                    :- Join Inner
               :  :                    :  :- SubqueryAlias `customer`
               :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :                    :  +- SubqueryAlias `web_sales`
               :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :                    +- SubqueryAlias `date_dim`
               :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `t_w_firstyear`
               :     +- SubqueryAlias `year_total`
               :        +- Union
               :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42576, c_first_name#420 AS customer_first_name#42577, c_last_name#421 AS customer_last_name#42578, d_year#498 AS year#42579, sum(ss_net_paid#150) AS year_total#42580, s AS sale_type#42581]
               :           :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :           :     +- Join Inner
               :           :        :- Join Inner
               :           :        :  :- SubqueryAlias `customer`
               :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :        :  +- SubqueryAlias `store_sales`
               :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42562, c_first_name#420 AS customer_first_name#42563, c_last_name#421 AS customer_last_name#42564, d_year#498 AS year#42565, sum(ws_net_paid#245) AS year_total#42566, w AS sale_type#42567]
               :              +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :                 +- Join Inner
               :                    :- Join Inner
               :                    :  :- SubqueryAlias `customer`
               :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :                    :  +- SubqueryAlias `web_sales`
               :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `t_w_secyear`
                  +- SubqueryAlias `year_total`
                     +- Union
                        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42582, c_first_name#420 AS customer_first_name#42583, c_last_name#421 AS customer_last_name#42584, d_year#498 AS year#42585, sum(ss_net_paid#150) AS year_total#42586, s AS sale_type#42587]
                        :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
                        :     +- Join Inner
                        :        :- Join Inner
                        :        :  :- SubqueryAlias `customer`
                        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :        :  +- SubqueryAlias `store_sales`
                        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42562, c_first_name#420 AS customer_first_name#42563, c_last_name#421 AS customer_last_name#42564, d_year#498 AS year#42565, sum(ws_net_paid#245) AS year_total#42566, w AS sale_type#42567]
                           +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `customer`
                                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                                 :  +- SubqueryAlias `web_sales`
                                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 76.107969952s
Running execution q75-v2.4 iteration: 1, StandardRun=true
19/09/08 20:37:05 INFO Query:
== Query: q75-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [sales_cnt_diff#43107L ASC NULLS FIRST], true
      +- Project [d_year#43427 AS prev_year#43103, d_year#498 AS year#43104, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, sales_cnt#43119L AS prev_yr_cnt#43105L, sales_cnt#43115L AS curr_yr_cnt#43106L, (sales_cnt#43115L - sales_cnt#43119L) AS sales_cnt_diff#43107L, CheckOverflow((promote_precision(cast(sales_amt#43116 as decimal(19,2))) - promote_precision(cast(sales_amt#43120 as decimal(19,2)))), DecimalType(19,2)) AS sales_amt_diff#43108]
         +- Filter ((((i_brand_id#571 = i_brand_id#43278) && (i_class_id#573 = i_class_id#43280)) && ((i_category_id#575 = i_category_id#43282) && (i_manufact_id#577 = i_manufact_id#43284))) && (((d_year#498 = 2002) && (d_year#43427 = (2002 - 1))) && (cast(CheckOverflow((promote_precision(cast(cast(sales_cnt#43115L as decimal(17,2)) as decimal(17,2))) / promote_precision(cast(cast(sales_cnt#43119L as decimal(17,2)) as decimal(17,2)))), DecimalType(37,20)) as decimal(37,20)) < cast(0.9 as decimal(37,20)))))
            +- Join Inner
               :- SubqueryAlias `curr_yr`
               :  +- SubqueryAlias `all_sales`
               :     +- Aggregate [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577], [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, sum(cast(sales_cnt#43109 as bigint)) AS sales_cnt#43115L, sum(sales_amt#43110) AS sales_amt#43116]
               :        +- SubqueryAlias `sales_detail`
               :           +- Distinct
               :              +- Union
               :                 :- Distinct
               :                 :  +- Union
               :                 :     :- Project [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, (cs_quantity#18 - coalesce(cr_return_quantity#85, 0)) AS sales_cnt#43109, CheckOverflow((promote_precision(cast(cs_ext_sales_price#23 as decimal(8,2))) - promote_precision(cast(coalesce(cr_return_amount#86, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43110]
               :                 :     :  +- Filter (i_category#576 = Books)
               :                 :     :     +- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
               :                 :     :        :- Join Inner, (d_date_sk#492 = cs_sold_date_sk#0)
               :                 :     :        :  :- Join Inner, (i_item_sk#564 = cs_item_sk#15)
               :                 :     :        :  :  :- SubqueryAlias `catalog_sales`
               :                 :     :        :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :     :        :  :  +- SubqueryAlias `item`
               :                 :     :        :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                 :     :        :  +- SubqueryAlias `date_dim`
               :                 :     :        :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :     :        +- SubqueryAlias `catalog_returns`
               :                 :     :           +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               :                 :     +- Project [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, (ss_quantity#140 - coalesce(sr_return_quantity#186, 0)) AS sales_cnt#43111, CheckOverflow((promote_precision(cast(ss_ext_sales_price#145 as decimal(8,2))) - promote_precision(cast(coalesce(sr_return_amt#187, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43112]
               :                 :        +- Filter (i_category#576 = Books)
               :                 :           +- Join LeftOuter, ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))
               :                 :              :- Join Inner, (d_date_sk#492 = ss_sold_date_sk#130)
               :                 :              :  :- Join Inner, (i_item_sk#564 = ss_item_sk#132)
               :                 :              :  :  :- SubqueryAlias `store_sales`
               :                 :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :                 :              :  :  +- SubqueryAlias `item`
               :                 :              :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                 :              :  +- SubqueryAlias `date_dim`
               :                 :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :              +- SubqueryAlias `store_returns`
               :                 :                 +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :                 +- Project [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, (ws_quantity#234 - coalesce(wr_return_quantity#298, 0)) AS sales_cnt#43113, CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(8,2))) - promote_precision(cast(coalesce(wr_return_amt#299, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43114]
               :                    +- Filter (i_category#576 = Books)
               :                       +- Join LeftOuter, ((ws_order_number#233L = wr_order_number#297L) && (ws_item_sk#219 = wr_item_sk#286))
               :                          :- Join Inner, (d_date_sk#492 = ws_sold_date_sk#216)
               :                          :  :- Join Inner, (i_item_sk#564 = ws_item_sk#219)
               :                          :  :  :- SubqueryAlias `web_sales`
               :                          :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                          :  :  +- SubqueryAlias `item`
               :                          :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                          :  +- SubqueryAlias `date_dim`
               :                          :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                          +- SubqueryAlias `web_returns`
               :                             +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               +- SubqueryAlias `prev_yr`
                  +- SubqueryAlias `all_sales`
                     +- Aggregate [d_year#43427, i_brand_id#43278, i_class_id#43280, i_category_id#43282, i_manufact_id#43284], [d_year#43427, i_brand_id#43278, i_class_id#43280, i_category_id#43282, i_manufact_id#43284, sum(cast(sales_cnt#43109 as bigint)) AS sales_cnt#43119L, sum(sales_amt#43110) AS sales_amt#43120]
                        +- SubqueryAlias `sales_detail`
                           +- Distinct
                              +- Union
                                 :- Distinct
                                 :  +- Union
                                 :     :- Project [d_year#43427, i_brand_id#43278, i_class_id#43280, i_category_id#43282, i_manufact_id#43284, (cs_quantity#18 - coalesce(cr_return_quantity#85, 0)) AS sales_cnt#43109, CheckOverflow((promote_precision(cast(cs_ext_sales_price#23 as decimal(8,2))) - promote_precision(cast(coalesce(cr_return_amount#86, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43110]
                                 :     :  +- Filter (i_category#43283 = Books)
                                 :     :     +- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
                                 :     :        :- Join Inner, (d_date_sk#43421 = cs_sold_date_sk#0)
                                 :     :        :  :- Join Inner, (i_item_sk#43271 = cs_item_sk#15)
                                 :     :        :  :  :- SubqueryAlias `catalog_sales`
                                 :     :        :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                                 :     :        :  :  +- SubqueryAlias `item`
                                 :     :        :  :     +- Relation[i_item_sk#43271,i_item_id#43272,i_rec_start_date#43273,i_rec_end_date#43274,i_item_desc#43275,i_current_price#43276,i_wholesale_cost#43277,i_brand_id#43278,i_brand#43279,i_class_id#43280,i_class#43281,i_category_id#43282,i_category#43283,i_manufact_id#43284,i_manufact#43285,i_size#43286,i_formulation#43287,i_color#43288,i_units#43289,i_container#43290,i_manager_id#43291,i_product_name#43292] parquet
                                 :     :        :  +- SubqueryAlias `date_dim`
                                 :     :        :     +- Relation[d_date_sk#43421,d_date_id#43422,d_date#43423,d_month_seq#43424,d_week_seq#43425,d_quarter_seq#43426,d_year#43427,d_dow#43428,d_moy#43429,d_dom#43430,d_qoy#43431,d_fy_year#43432,d_fy_quarter_seq#43433,d_fy_week_seq#43434,d_day_name#43435,d_quarter_name#43436,d_holiday#43437,d_weekend#43438,d_following_holiday#43439,d_first_dom#43440,d_last_dom#43441,d_same_day_ly#43442,d_same_day_lq#43443,d_current_day#43444,... 4 more fields] parquet
                                 :     :        +- SubqueryAlias `catalog_returns`
                                 :     :           +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                                 :     +- Project [d_year#43427, i_brand_id#43278, i_class_id#43280, i_category_id#43282, i_manufact_id#43284, (ss_quantity#140 - coalesce(sr_return_quantity#186, 0)) AS sales_cnt#43111, CheckOverflow((promote_precision(cast(ss_ext_sales_price#145 as decimal(8,2))) - promote_precision(cast(coalesce(sr_return_amt#187, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43112]
                                 :        +- Filter (i_category#43283 = Books)
                                 :           +- Join LeftOuter, ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))
                                 :              :- Join Inner, (d_date_sk#43421 = ss_sold_date_sk#130)
                                 :              :  :- Join Inner, (i_item_sk#43271 = ss_item_sk#132)
                                 :              :  :  :- SubqueryAlias `store_sales`
                                 :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :              :  :  +- SubqueryAlias `item`
                                 :              :  :     +- Relation[i_item_sk#43271,i_item_id#43272,i_rec_start_date#43273,i_rec_end_date#43274,i_item_desc#43275,i_current_price#43276,i_wholesale_cost#43277,i_brand_id#43278,i_brand#43279,i_class_id#43280,i_class#43281,i_category_id#43282,i_category#43283,i_manufact_id#43284,i_manufact#43285,i_size#43286,i_formulation#43287,i_color#43288,i_units#43289,i_container#43290,i_manager_id#43291,i_product_name#43292] parquet
                                 :              :  +- SubqueryAlias `date_dim`
                                 :              :     +- Relation[d_date_sk#43421,d_date_id#43422,d_date#43423,d_month_seq#43424,d_week_seq#43425,d_quarter_seq#43426,d_year#43427,d_dow#43428,d_moy#43429,d_dom#43430,d_qoy#43431,d_fy_year#43432,d_fy_quarter_seq#43433,d_fy_week_seq#43434,d_day_name#43435,d_quarter_name#43436,d_holiday#43437,d_weekend#43438,d_following_holiday#43439,d_first_dom#43440,d_last_dom#43441,d_same_day_ly#43442,d_same_day_lq#43443,d_current_day#43444,... 4 more fields] parquet
                                 :              +- SubqueryAlias `store_returns`
                                 :                 +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                                 +- Project [d_year#43427, i_brand_id#43278, i_class_id#43280, i_category_id#43282, i_manufact_id#43284, (ws_quantity#234 - coalesce(wr_return_quantity#298, 0)) AS sales_cnt#43113, CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(8,2))) - promote_precision(cast(coalesce(wr_return_amt#299, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43114]
                                    +- Filter (i_category#43283 = Books)
                                       +- Join LeftOuter, ((ws_order_number#233L = wr_order_number#297L) && (ws_item_sk#219 = wr_item_sk#286))
                                          :- Join Inner, (d_date_sk#43421 = ws_sold_date_sk#216)
                                          :  :- Join Inner, (i_item_sk#43271 = ws_item_sk#219)
                                          :  :  :- SubqueryAlias `web_sales`
                                          :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                          :  :  +- SubqueryAlias `item`
                                          :  :     +- Relation[i_item_sk#43271,i_item_id#43272,i_rec_start_date#43273,i_rec_end_date#43274,i_item_desc#43275,i_current_price#43276,i_wholesale_cost#43277,i_brand_id#43278,i_brand#43279,i_class_id#43280,i_class#43281,i_category_id#43282,i_category#43283,i_manufact_id#43284,i_manufact#43285,i_size#43286,i_formulation#43287,i_color#43288,i_units#43289,i_container#43290,i_manager_id#43291,i_product_name#43292] parquet
                                          :  +- SubqueryAlias `date_dim`
                                          :     +- Relation[d_date_sk#43421,d_date_id#43422,d_date#43423,d_month_seq#43424,d_week_seq#43425,d_quarter_seq#43426,d_year#43427,d_dow#43428,d_moy#43429,d_dom#43430,d_qoy#43431,d_fy_year#43432,d_fy_quarter_seq#43433,d_fy_week_seq#43434,d_day_name#43435,d_quarter_name#43436,d_holiday#43437,d_weekend#43438,d_following_holiday#43439,d_first_dom#43440,d_last_dom#43441,d_same_day_ly#43442,d_same_day_lq#43443,d_current_day#43444,... 4 more fields] parquet
                                          +- SubqueryAlias `web_returns`
                                             +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet

     : benchmark
19/09/08 20:37:05 INFO Query:
== Query: q75-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [sales_cnt_diff#43519L ASC NULLS FIRST], true
      +- Project [d_year#43839 AS prev_year#43515, d_year#498 AS year#43516, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, sales_cnt#43531L AS prev_yr_cnt#43517L, sales_cnt#43527L AS curr_yr_cnt#43518L, (sales_cnt#43527L - sales_cnt#43531L) AS sales_cnt_diff#43519L, CheckOverflow((promote_precision(cast(sales_amt#43528 as decimal(19,2))) - promote_precision(cast(sales_amt#43532 as decimal(19,2)))), DecimalType(19,2)) AS sales_amt_diff#43520]
         +- Filter ((((i_brand_id#571 = i_brand_id#43690) && (i_class_id#573 = i_class_id#43692)) && ((i_category_id#575 = i_category_id#43694) && (i_manufact_id#577 = i_manufact_id#43696))) && (((d_year#498 = 2002) && (d_year#43839 = (2002 - 1))) && (cast(CheckOverflow((promote_precision(cast(cast(sales_cnt#43527L as decimal(17,2)) as decimal(17,2))) / promote_precision(cast(cast(sales_cnt#43531L as decimal(17,2)) as decimal(17,2)))), DecimalType(37,20)) as decimal(37,20)) < cast(0.9 as decimal(37,20)))))
            +- Join Inner
               :- SubqueryAlias `curr_yr`
               :  +- SubqueryAlias `all_sales`
               :     +- Aggregate [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577], [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, sum(cast(sales_cnt#43521 as bigint)) AS sales_cnt#43527L, sum(sales_amt#43522) AS sales_amt#43528]
               :        +- SubqueryAlias `sales_detail`
               :           +- Distinct
               :              +- Union
               :                 :- Distinct
               :                 :  +- Union
               :                 :     :- Project [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, (cs_quantity#18 - coalesce(cr_return_quantity#85, 0)) AS sales_cnt#43521, CheckOverflow((promote_precision(cast(cs_ext_sales_price#23 as decimal(8,2))) - promote_precision(cast(coalesce(cr_return_amount#86, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43522]
               :                 :     :  +- Filter (i_category#576 = Books)
               :                 :     :     +- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
               :                 :     :        :- Join Inner, (d_date_sk#492 = cs_sold_date_sk#0)
               :                 :     :        :  :- Join Inner, (i_item_sk#564 = cs_item_sk#15)
               :                 :     :        :  :  :- SubqueryAlias `catalog_sales`
               :                 :     :        :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :     :        :  :  +- SubqueryAlias `item`
               :                 :     :        :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                 :     :        :  +- SubqueryAlias `date_dim`
               :                 :     :        :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :     :        +- SubqueryAlias `catalog_returns`
               :                 :     :           +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               :                 :     +- Project [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, (ss_quantity#140 - coalesce(sr_return_quantity#186, 0)) AS sales_cnt#43523, CheckOverflow((promote_precision(cast(ss_ext_sales_price#145 as decimal(8,2))) - promote_precision(cast(coalesce(sr_return_amt#187, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43524]
               :                 :        +- Filter (i_category#576 = Books)
               :                 :           +- Join LeftOuter, ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))
               :                 :              :- Join Inner, (d_date_sk#492 = ss_sold_date_sk#130)
               :                 :              :  :- Join Inner, (i_item_sk#564 = ss_item_sk#132)
               :                 :              :  :  :- SubqueryAlias `store_sales`
               :                 :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :                 :              :  :  +- SubqueryAlias `item`
               :                 :              :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                 :              :  +- SubqueryAlias `date_dim`
               :                 :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :              +- SubqueryAlias `store_returns`
               :                 :                 +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :                 +- Project [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, (ws_quantity#234 - coalesce(wr_return_quantity#298, 0)) AS sales_cnt#43525, CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(8,2))) - promote_precision(cast(coalesce(wr_return_amt#299, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43526]
               :                    +- Filter (i_category#576 = Books)
               :                       +- Join LeftOuter, ((ws_order_number#233L = wr_order_number#297L) && (ws_item_sk#219 = wr_item_sk#286))
               :                          :- Join Inner, (d_date_sk#492 = ws_sold_date_sk#216)
               :                          :  :- Join Inner, (i_item_sk#564 = ws_item_sk#219)
               :                          :  :  :- SubqueryAlias `web_sales`
               :                          :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                          :  :  +- SubqueryAlias `item`
               :                          :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                          :  +- SubqueryAlias `date_dim`
               :                          :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                          +- SubqueryAlias `web_returns`
               :                             +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               +- SubqueryAlias `prev_yr`
                  +- SubqueryAlias `all_sales`
                     +- Aggregate [d_year#43839, i_brand_id#43690, i_class_id#43692, i_category_id#43694, i_manufact_id#43696], [d_year#43839, i_brand_id#43690, i_class_id#43692, i_category_id#43694, i_manufact_id#43696, sum(cast(sales_cnt#43521 as bigint)) AS sales_cnt#43531L, sum(sales_amt#43522) AS sales_amt#43532]
                        +- SubqueryAlias `sales_detail`
                           +- Distinct
                              +- Union
                                 :- Distinct
                                 :  +- Union
                                 :     :- Project [d_year#43839, i_brand_id#43690, i_class_id#43692, i_category_id#43694, i_manufact_id#43696, (cs_quantity#18 - coalesce(cr_return_quantity#85, 0)) AS sales_cnt#43521, CheckOverflow((promote_precision(cast(cs_ext_sales_price#23 as decimal(8,2))) - promote_precision(cast(coalesce(cr_return_amount#86, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43522]
                                 :     :  +- Filter (i_category#43695 = Books)
                                 :     :     +- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
                                 :     :        :- Join Inner, (d_date_sk#43833 = cs_sold_date_sk#0)
                                 :     :        :  :- Join Inner, (i_item_sk#43683 = cs_item_sk#15)
                                 :     :        :  :  :- SubqueryAlias `catalog_sales`
                                 :     :        :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                                 :     :        :  :  +- SubqueryAlias `item`
                                 :     :        :  :     +- Relation[i_item_sk#43683,i_item_id#43684,i_rec_start_date#43685,i_rec_end_date#43686,i_item_desc#43687,i_current_price#43688,i_wholesale_cost#43689,i_brand_id#43690,i_brand#43691,i_class_id#43692,i_class#43693,i_category_id#43694,i_category#43695,i_manufact_id#43696,i_manufact#43697,i_size#43698,i_formulation#43699,i_color#43700,i_units#43701,i_container#43702,i_manager_id#43703,i_product_name#43704] parquet
                                 :     :        :  +- SubqueryAlias `date_dim`
                                 :     :        :     +- Relation[d_date_sk#43833,d_date_id#43834,d_date#43835,d_month_seq#43836,d_week_seq#43837,d_quarter_seq#43838,d_year#43839,d_dow#43840,d_moy#43841,d_dom#43842,d_qoy#43843,d_fy_year#43844,d_fy_quarter_seq#43845,d_fy_week_seq#43846,d_day_name#43847,d_quarter_name#43848,d_holiday#43849,d_weekend#43850,d_following_holiday#43851,d_first_dom#43852,d_last_dom#43853,d_same_day_ly#43854,d_same_day_lq#43855,d_current_day#43856,... 4 more fields] parquet
                                 :     :        +- SubqueryAlias `catalog_returns`
                                 :     :           +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                                 :     +- Project [d_year#43839, i_brand_id#43690, i_class_id#43692, i_category_id#43694, i_manufact_id#43696, (ss_quantity#140 - coalesce(sr_return_quantity#186, 0)) AS sales_cnt#43523, CheckOverflow((promote_precision(cast(ss_ext_sales_price#145 as decimal(8,2))) - promote_precision(cast(coalesce(sr_return_amt#187, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43524]
                                 :        +- Filter (i_category#43695 = Books)
                                 :           +- Join LeftOuter, ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))
                                 :              :- Join Inner, (d_date_sk#43833 = ss_sold_date_sk#130)
                                 :              :  :- Join Inner, (i_item_sk#43683 = ss_item_sk#132)
                                 :              :  :  :- SubqueryAlias `store_sales`
                                 :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :              :  :  +- SubqueryAlias `item`
                                 :              :  :     +- Relation[i_item_sk#43683,i_item_id#43684,i_rec_start_date#43685,i_rec_end_date#43686,i_item_desc#43687,i_current_price#43688,i_wholesale_cost#43689,i_brand_id#43690,i_brand#43691,i_class_id#43692,i_class#43693,i_category_id#43694,i_category#43695,i_manufact_id#43696,i_manufact#43697,i_size#43698,i_formulation#43699,i_color#43700,i_units#43701,i_container#43702,i_manager_id#43703,i_product_name#43704] parquet
                                 :              :  +- SubqueryAlias `date_dim`
                                 :              :     +- Relation[d_date_sk#43833,d_date_id#43834,d_date#43835,d_month_seq#43836,d_week_seq#43837,d_quarter_seq#43838,d_year#43839,d_dow#43840,d_moy#43841,d_dom#43842,d_qoy#43843,d_fy_year#43844,d_fy_quarter_seq#43845,d_fy_week_seq#43846,d_day_name#43847,d_quarter_name#43848,d_holiday#43849,d_weekend#43850,d_following_holiday#43851,d_first_dom#43852,d_last_dom#43853,d_same_day_ly#43854,d_same_day_lq#43855,d_current_day#43856,... 4 more fields] parquet
                                 :              +- SubqueryAlias `store_returns`
                                 :                 +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                                 +- Project [d_year#43839, i_brand_id#43690, i_class_id#43692, i_category_id#43694, i_manufact_id#43696, (ws_quantity#234 - coalesce(wr_return_quantity#298, 0)) AS sales_cnt#43525, CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(8,2))) - promote_precision(cast(coalesce(wr_return_amt#299, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43526]
                                    +- Filter (i_category#43695 = Books)
                                       +- Join LeftOuter, ((ws_order_number#233L = wr_order_number#297L) && (ws_item_sk#219 = wr_item_sk#286))
                                          :- Join Inner, (d_date_sk#43833 = ws_sold_date_sk#216)
                                          :  :- Join Inner, (i_item_sk#43683 = ws_item_sk#219)
                                          :  :  :- SubqueryAlias `web_sales`
                                          :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                          :  :  +- SubqueryAlias `item`
                                          :  :     +- Relation[i_item_sk#43683,i_item_id#43684,i_rec_start_date#43685,i_rec_end_date#43686,i_item_desc#43687,i_current_price#43688,i_wholesale_cost#43689,i_brand_id#43690,i_brand#43691,i_class_id#43692,i_class#43693,i_category_id#43694,i_category#43695,i_manufact_id#43696,i_manufact#43697,i_size#43698,i_formulation#43699,i_color#43700,i_units#43701,i_container#43702,i_manager_id#43703,i_product_name#43704] parquet
                                          :  +- SubqueryAlias `date_dim`
                                          :     +- Relation[d_date_sk#43833,d_date_id#43834,d_date#43835,d_month_seq#43836,d_week_seq#43837,d_quarter_seq#43838,d_year#43839,d_dow#43840,d_moy#43841,d_dom#43842,d_qoy#43843,d_fy_year#43844,d_fy_quarter_seq#43845,d_fy_week_seq#43846,d_day_name#43847,d_quarter_name#43848,d_holiday#43849,d_weekend#43850,d_following_holiday#43851,d_first_dom#43852,d_last_dom#43853,d_same_day_ly#43854,d_same_day_lq#43855,d_current_day#43856,... 4 more fields] parquet
                                          +- SubqueryAlias `web_returns`
                                             +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet

      running Thread[benchmark runner,5,main]
Execution time: 79.18383936s
Running execution q76-v2.4 iteration: 1, StandardRun=true
19/09/08 20:38:27 INFO Query:
== Query: q76-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [channel#44795, col_name#44796, d_year#498, d_qoy#502, i_category#576, sales_cnt#44804L, sales_amt#44805]
      +- Sort [channel#44795 ASC NULLS FIRST, col_name#44796 ASC NULLS FIRST, d_year#498 ASC NULLS FIRST, d_qoy#502 ASC NULLS FIRST, i_category#576 ASC NULLS FIRST], true
         +- Aggregate [channel#44795, col_name#44796, d_year#498, d_qoy#502, i_category#576], [channel#44795, col_name#44796, d_year#498, d_qoy#502, i_category#576, count(1) AS sales_cnt#44804L, sum(ext_sales_price#44797) AS sales_amt#44805]
            +- SubqueryAlias `foo`
               +- Union
                  :- Union
                  :  :- Project [store AS channel#44795, ss_store_sk#137 AS col_name#44796, d_year#498, d_qoy#502, i_category#576, ss_ext_sales_price#145 AS ext_sales_price#44797]
                  :  :  +- Filter ((isnull(ss_store_sk#137) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_item_sk#132 = i_item_sk#564))
                  :  :     +- Join Inner
                  :  :        :- Join Inner
                  :  :        :  :- SubqueryAlias `store_sales`
                  :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :        :  +- SubqueryAlias `item`
                  :  :        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  :  :        +- SubqueryAlias `date_dim`
                  :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- Project [web AS channel#44798, ws_ship_customer_sk#224 AS col_name#44799, d_year#498, d_qoy#502, i_category#576, ws_ext_sales_price#239 AS ext_sales_price#44800]
                  :     +- Filter ((isnull(ws_ship_customer_sk#224) && (ws_sold_date_sk#216 = d_date_sk#492)) && (ws_item_sk#219 = i_item_sk#564))
                  :        +- Join Inner
                  :           :- Join Inner
                  :           :  :- SubqueryAlias `web_sales`
                  :           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :           :  +- SubqueryAlias `item`
                  :           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  :           +- SubqueryAlias `date_dim`
                  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- Project [catalog AS channel#44801, cs_ship_addr_sk#10 AS col_name#44802, d_year#498, d_qoy#502, i_category#576, cs_ext_sales_price#23 AS ext_sales_price#44803]
                     +- Filter ((isnull(cs_ship_addr_sk#10) && (cs_sold_date_sk#0 = d_date_sk#492)) && (cs_item_sk#15 = i_item_sk#564))
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `catalog_sales`
                           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :  +- SubqueryAlias `item`
                           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 20:38:27 INFO Query:
== Query: q76-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [channel#44820, col_name#44821, d_year#498, d_qoy#502, i_category#576, sales_cnt#44829L, sales_amt#44830]
      +- Sort [channel#44820 ASC NULLS FIRST, col_name#44821 ASC NULLS FIRST, d_year#498 ASC NULLS FIRST, d_qoy#502 ASC NULLS FIRST, i_category#576 ASC NULLS FIRST], true
         +- Aggregate [channel#44820, col_name#44821, d_year#498, d_qoy#502, i_category#576], [channel#44820, col_name#44821, d_year#498, d_qoy#502, i_category#576, count(1) AS sales_cnt#44829L, sum(ext_sales_price#44822) AS sales_amt#44830]
            +- SubqueryAlias `foo`
               +- Union
                  :- Union
                  :  :- Project [store AS channel#44820, ss_store_sk#137 AS col_name#44821, d_year#498, d_qoy#502, i_category#576, ss_ext_sales_price#145 AS ext_sales_price#44822]
                  :  :  +- Filter ((isnull(ss_store_sk#137) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_item_sk#132 = i_item_sk#564))
                  :  :     +- Join Inner
                  :  :        :- Join Inner
                  :  :        :  :- SubqueryAlias `store_sales`
                  :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :        :  +- SubqueryAlias `item`
                  :  :        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  :  :        +- SubqueryAlias `date_dim`
                  :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- Project [web AS channel#44823, ws_ship_customer_sk#224 AS col_name#44824, d_year#498, d_qoy#502, i_category#576, ws_ext_sales_price#239 AS ext_sales_price#44825]
                  :     +- Filter ((isnull(ws_ship_customer_sk#224) && (ws_sold_date_sk#216 = d_date_sk#492)) && (ws_item_sk#219 = i_item_sk#564))
                  :        +- Join Inner
                  :           :- Join Inner
                  :           :  :- SubqueryAlias `web_sales`
                  :           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :           :  +- SubqueryAlias `item`
                  :           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  :           +- SubqueryAlias `date_dim`
                  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- Project [catalog AS channel#44826, cs_ship_addr_sk#10 AS col_name#44827, d_year#498, d_qoy#502, i_category#576, cs_ext_sales_price#23 AS ext_sales_price#44828]
                     +- Filter ((isnull(cs_ship_addr_sk#10) && (cs_sold_date_sk#0 = d_date_sk#492)) && (cs_item_sk#15 = i_item_sk#564))
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `catalog_sales`
                           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :  +- SubqueryAlias `item`
                           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 19.311681229999998s
Running execution q77-v2.4 iteration: 1, StandardRun=true
19/09/08 20:38:48 INFO Query:
== Query: q77-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#45127 ASC NULLS FIRST, id#45128 ASC NULLS FIRST], true
      +- Aggregate [channel#45127, id#45128, spark_grouping_id#45124], [channel#45127, id#45128, sum(sales#45052) AS sales#45049, sum(returns#45040) AS returns#45050, sum(profit#45119) AS profit#45051]
         +- Expand [List(channel#45038, id#45039, sales#45052, returns#45040, profit#45119, channel#45125, id#45126, 0), List(channel#45038, id#45039, sales#45052, returns#45040, profit#45119, channel#45125, null, 1), List(channel#45038, id#45039, sales#45052, returns#45040, profit#45119, null, null, 3)], [channel#45038, id#45039, sales#45052, returns#45040, profit#45119, channel#45127, id#45128, spark_grouping_id#45124]
            +- Project [channel#45038, id#45039, sales#45052, returns#45040, profit#45119, channel#45038 AS channel#45125, id#45039 AS id#45126]
               +- SubqueryAlias `x`
                  +- Union
                     :- Project [channel#45038, id#45039, sales#45052, returns#45040, profit#45119]
                     :  +- Union
                     :     :- Project [channel#45038, id#45039, sales#45052, returns#45040, cast(profit#45041 as decimal(18,2)) AS profit#45119]
                     :     :  +- Project [store channel AS channel#45038, s_store_sk#664 AS id#45039, sales#45052, coalesce(returns#45054, cast(0 as decimal(17,2))) AS returns#45040, CheckOverflow((promote_precision(cast(profit#45053 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#45055, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS profit#45041]
                     :     :     +- Join LeftOuter, (s_store_sk#664 = s_store_sk#45076)
                     :     :        :- SubqueryAlias `ss`
                     :     :        :  +- Aggregate [s_store_sk#664], [s_store_sk#664, sum(ss_ext_sales_price#145) AS sales#45052, sum(ss_net_profit#152) AS profit#45053]
                     :     :        :     +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (ss_store_sk#137 = s_store_sk#664))
                     :     :        :        +- Join Inner
                     :     :        :           :- Join Inner
                     :     :        :           :  :- SubqueryAlias `store_sales`
                     :     :        :           :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :     :        :           :  +- SubqueryAlias `date_dim`
                     :     :        :           :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :     :        :           +- SubqueryAlias `store`
                     :     :        :              +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :     :        +- SubqueryAlias `sr`
                     :     :           +- Aggregate [s_store_sk#45076], [s_store_sk#45076, sum(sr_return_amt#187) AS returns#45054, sum(sr_net_loss#195) AS profit_loss#45055]
                     :     :              +- Filter (((sr_returned_date_sk#176 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (sr_store_sk#183 = s_store_sk#45076))
                     :     :                 +- Join Inner
                     :     :                    :- Join Inner
                     :     :                    :  :- SubqueryAlias `store_returns`
                     :     :                    :  :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :     :                    :  +- SubqueryAlias `date_dim`
                     :     :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :     :                    +- SubqueryAlias `store`
                     :     :                       +- Relation[s_store_sk#45076,s_store_id#45077,s_rec_start_date#45078,s_rec_end_date#45079,s_closed_date_sk#45080,s_store_name#45081,s_number_employees#45082,s_floor_space#45083,s_hours#45084,s_manager#45085,s_market_id#45086,s_geography_class#45087,s_market_desc#45088,s_market_manager#45089,s_division_id#45090,s_division_name#45091,s_company_id#45092,s_company_name#45093,s_street_number#45094,s_street_name#45095,s_street_type#45096,s_suite_number#45097,s_city#45098,s_county#45099,... 5 more fields] parquet
                     :     +- Project [channel#45042, id#45043, sales#45056, returns#45058, profit#45044]
                     :        +- Project [catalog channel AS channel#45042, cs_call_center_sk#11 AS id#45043, sales#45056, returns#45058, CheckOverflow((promote_precision(cast(profit#45057 as decimal(18,2))) - promote_precision(cast(profit_loss#45059 as decimal(18,2)))), DecimalType(18,2)) AS profit#45044]
                     :           +- Join Cross
                     :              :- SubqueryAlias `cs`
                     :              :  +- Aggregate [cs_call_center_sk#11], [cs_call_center_sk#11, sum(cs_ext_sales_price#23) AS sales#45056, sum(cs_net_profit#33) AS profit#45057]
                     :              :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date))))
                     :              :        +- Join Inner
                     :              :           :- SubqueryAlias `catalog_sales`
                     :              :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :              :           +- SubqueryAlias `date_dim`
                     :              :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              +- SubqueryAlias `cr`
                     :                 +- Aggregate [cr_call_center_sk#79], [cr_call_center_sk#79, sum(cr_return_amount#86) AS returns#45058, sum(cr_net_loss#94) AS profit_loss#45059]
                     :                    +- Filter ((cr_returned_date_sk#68 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date))))
                     :                       +- Join Inner
                     :                          :- SubqueryAlias `catalog_returns`
                     :                          :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                     :                          +- SubqueryAlias `date_dim`
                     :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- Project [channel#45045, id#45046, sales#45060, returns#45047, cast(profit#45048 as decimal(18,2)) AS profit#45120]
                        +- Project [web channel AS channel#45045, wp_web_page_sk#770 AS id#45046, sales#45060, coalesce(returns#45062, cast(0 as decimal(17,2))) AS returns#45047, CheckOverflow((promote_precision(cast(profit#45061 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#45063, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS profit#45048]
                           +- Join LeftOuter, (wp_web_page_sk#770 = wp_web_page_sk#45105)
                              :- SubqueryAlias `ws`
                              :  +- Aggregate [wp_web_page_sk#770], [wp_web_page_sk#770, sum(ws_ext_sales_price#239) AS sales#45060, sum(ws_net_profit#249) AS profit#45061]
                              :     +- Filter (((ws_sold_date_sk#216 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (ws_web_page_sk#228 = wp_web_page_sk#770))
                              :        +- Join Inner
                              :           :- Join Inner
                              :           :  :- SubqueryAlias `web_sales`
                              :           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :           :  +- SubqueryAlias `date_dim`
                              :           :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :           +- SubqueryAlias `web_page`
                              :              +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet
                              +- SubqueryAlias `wr`
                                 +- Aggregate [wp_web_page_sk#45105], [wp_web_page_sk#45105, sum(wr_return_amt#299) AS returns#45062, sum(wr_net_loss#307) AS profit_loss#45063]
                                    +- Filter (((wr_returned_date_sk#284 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (wr_web_page_sk#295 = wp_web_page_sk#45105))
                                       +- Join Inner
                                          :- Join Inner
                                          :  :- SubqueryAlias `web_returns`
                                          :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                                          :  +- SubqueryAlias `date_dim`
                                          :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                          +- SubqueryAlias `web_page`
                                             +- Relation[wp_web_page_sk#45105,wp_web_page_id#45106,wp_rec_start_date#45107,wp_rec_end_date#45108,wp_creation_date_sk#45109,wp_access_date_sk#45110,wp_autogen_flag#45111,wp_customer_sk#45112,wp_url#45113,wp_type#45114,wp_char_count#45115,wp_link_count#45116,wp_image_count#45117,wp_max_ad_count#45118] parquet

     : benchmark
19/09/08 20:38:48 INFO Query:
== Query: q77-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#45225 ASC NULLS FIRST, id#45226 ASC NULLS FIRST], true
      +- Aggregate [channel#45225, id#45226, spark_grouping_id#45222], [channel#45225, id#45226, sum(sales#45150) AS sales#45147, sum(returns#45138) AS returns#45148, sum(profit#45217) AS profit#45149]
         +- Expand [List(channel#45136, id#45137, sales#45150, returns#45138, profit#45217, channel#45223, id#45224, 0), List(channel#45136, id#45137, sales#45150, returns#45138, profit#45217, channel#45223, null, 1), List(channel#45136, id#45137, sales#45150, returns#45138, profit#45217, null, null, 3)], [channel#45136, id#45137, sales#45150, returns#45138, profit#45217, channel#45225, id#45226, spark_grouping_id#45222]
            +- Project [channel#45136, id#45137, sales#45150, returns#45138, profit#45217, channel#45136 AS channel#45223, id#45137 AS id#45224]
               +- SubqueryAlias `x`
                  +- Union
                     :- Project [channel#45136, id#45137, sales#45150, returns#45138, profit#45217]
                     :  +- Union
                     :     :- Project [channel#45136, id#45137, sales#45150, returns#45138, cast(profit#45139 as decimal(18,2)) AS profit#45217]
                     :     :  +- Project [store channel AS channel#45136, s_store_sk#664 AS id#45137, sales#45150, coalesce(returns#45152, cast(0 as decimal(17,2))) AS returns#45138, CheckOverflow((promote_precision(cast(profit#45151 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#45153, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS profit#45139]
                     :     :     +- Join LeftOuter, (s_store_sk#664 = s_store_sk#45174)
                     :     :        :- SubqueryAlias `ss`
                     :     :        :  +- Aggregate [s_store_sk#664], [s_store_sk#664, sum(ss_ext_sales_price#145) AS sales#45150, sum(ss_net_profit#152) AS profit#45151]
                     :     :        :     +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (ss_store_sk#137 = s_store_sk#664))
                     :     :        :        +- Join Inner
                     :     :        :           :- Join Inner
                     :     :        :           :  :- SubqueryAlias `store_sales`
                     :     :        :           :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :     :        :           :  +- SubqueryAlias `date_dim`
                     :     :        :           :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :     :        :           +- SubqueryAlias `store`
                     :     :        :              +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :     :        +- SubqueryAlias `sr`
                     :     :           +- Aggregate [s_store_sk#45174], [s_store_sk#45174, sum(sr_return_amt#187) AS returns#45152, sum(sr_net_loss#195) AS profit_loss#45153]
                     :     :              +- Filter (((sr_returned_date_sk#176 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (sr_store_sk#183 = s_store_sk#45174))
                     :     :                 +- Join Inner
                     :     :                    :- Join Inner
                     :     :                    :  :- SubqueryAlias `store_returns`
                     :     :                    :  :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :     :                    :  +- SubqueryAlias `date_dim`
                     :     :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :     :                    +- SubqueryAlias `store`
                     :     :                       +- Relation[s_store_sk#45174,s_store_id#45175,s_rec_start_date#45176,s_rec_end_date#45177,s_closed_date_sk#45178,s_store_name#45179,s_number_employees#45180,s_floor_space#45181,s_hours#45182,s_manager#45183,s_market_id#45184,s_geography_class#45185,s_market_desc#45186,s_market_manager#45187,s_division_id#45188,s_division_name#45189,s_company_id#45190,s_company_name#45191,s_street_number#45192,s_street_name#45193,s_street_type#45194,s_suite_number#45195,s_city#45196,s_county#45197,... 5 more fields] parquet
                     :     +- Project [channel#45140, id#45141, sales#45154, returns#45156, profit#45142]
                     :        +- Project [catalog channel AS channel#45140, cs_call_center_sk#11 AS id#45141, sales#45154, returns#45156, CheckOverflow((promote_precision(cast(profit#45155 as decimal(18,2))) - promote_precision(cast(profit_loss#45157 as decimal(18,2)))), DecimalType(18,2)) AS profit#45142]
                     :           +- Join Cross
                     :              :- SubqueryAlias `cs`
                     :              :  +- Aggregate [cs_call_center_sk#11], [cs_call_center_sk#11, sum(cs_ext_sales_price#23) AS sales#45154, sum(cs_net_profit#33) AS profit#45155]
                     :              :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date))))
                     :              :        +- Join Inner
                     :              :           :- SubqueryAlias `catalog_sales`
                     :              :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :              :           +- SubqueryAlias `date_dim`
                     :              :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              +- SubqueryAlias `cr`
                     :                 +- Aggregate [cr_call_center_sk#79], [cr_call_center_sk#79, sum(cr_return_amount#86) AS returns#45156, sum(cr_net_loss#94) AS profit_loss#45157]
                     :                    +- Filter ((cr_returned_date_sk#68 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date))))
                     :                       +- Join Inner
                     :                          :- SubqueryAlias `catalog_returns`
                     :                          :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                     :                          +- SubqueryAlias `date_dim`
                     :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- Project [channel#45143, id#45144, sales#45158, returns#45145, cast(profit#45146 as decimal(18,2)) AS profit#45218]
                        +- Project [web channel AS channel#45143, wp_web_page_sk#770 AS id#45144, sales#45158, coalesce(returns#45160, cast(0 as decimal(17,2))) AS returns#45145, CheckOverflow((promote_precision(cast(profit#45159 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#45161, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS profit#45146]
                           +- Join LeftOuter, (wp_web_page_sk#770 = wp_web_page_sk#45203)
                              :- SubqueryAlias `ws`
                              :  +- Aggregate [wp_web_page_sk#770], [wp_web_page_sk#770, sum(ws_ext_sales_price#239) AS sales#45158, sum(ws_net_profit#249) AS profit#45159]
                              :     +- Filter (((ws_sold_date_sk#216 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (ws_web_page_sk#228 = wp_web_page_sk#770))
                              :        +- Join Inner
                              :           :- Join Inner
                              :           :  :- SubqueryAlias `web_sales`
                              :           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :           :  +- SubqueryAlias `date_dim`
                              :           :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :           +- SubqueryAlias `web_page`
                              :              +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet
                              +- SubqueryAlias `wr`
                                 +- Aggregate [wp_web_page_sk#45203], [wp_web_page_sk#45203, sum(wr_return_amt#299) AS returns#45160, sum(wr_net_loss#307) AS profit_loss#45161]
                                    +- Filter (((wr_returned_date_sk#284 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (wr_web_page_sk#295 = wp_web_page_sk#45203))
                                       +- Join Inner
                                          :- Join Inner
                                          :  :- SubqueryAlias `web_returns`
                                          :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                                          :  +- SubqueryAlias `date_dim`
                                          :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                          +- SubqueryAlias `web_page`
                                             +- Relation[wp_web_page_sk#45203,wp_web_page_id#45204,wp_rec_start_date#45205,wp_rec_end_date#45206,wp_creation_date_sk#45207,wp_access_date_sk#45208,wp_autogen_flag#45209,wp_customer_sk#45210,wp_url#45211,wp_type#45212,wp_char_count#45213,wp_link_count#45214,wp_image_count#45215,wp_max_ad_count#45216] parquet

      running Thread[benchmark runner,5,main]
19/09/08 20:39:19 ERROR AsyncEventQueue: Dropping event from queue appStatus. This likely means one of the listeners is too slow and cannot keep up with the rate at which tasks are being started by the scheduler.
19/09/08 20:39:19 WARN AsyncEventQueue: Dropped 1 events from appStatus since Thu Jan 01 00:00:00 GMT 1970.
Execution time: 43.143638419000006s
Running execution q78-v2.4 iteration: 1, StandardRun=true
19/09/08 20:39:34 INFO Query:
== Query: q78-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ss_sold_year#45546, ss_item_sk#132, ss_customer_sk#133, ratio#45529, store_qty#45530L, store_wholesale_cost#45531, store_sales_price#45532, other_chan_qty#45533L, other_chan_wholesale_cost#45534, other_chan_sales_price#45535]
      +- Sort [ss_sold_year#45546 ASC NULLS FIRST, ss_item_sk#132 ASC NULLS FIRST, ss_customer_sk#133 ASC NULLS FIRST, ss_qty#45547L DESC NULLS LAST, ss_wc#45548 DESC NULLS LAST, ss_sp#45549 DESC NULLS LAST, other_chan_qty#45533L ASC NULLS FIRST, other_chan_wholesale_cost#45534 ASC NULLS FIRST, other_chan_sales_price#45535 ASC NULLS FIRST, round((cast(ss_qty#45547L as double) / cast(coalesce((ws_qty#45538L + cs_qty#45543L), cast(1 as bigint)) as double)), 2) ASC NULLS FIRST], true
         +- Project [ss_sold_year#45546, ss_item_sk#132, ss_customer_sk#133, round((cast(ss_qty#45547L as double) / cast((coalesce(ws_qty#45538L, cast(0 as bigint)) + coalesce(cs_qty#45543L, cast(0 as bigint))) as double)), 2) AS ratio#45529, ss_qty#45547L AS store_qty#45530L, ss_wc#45548 AS store_wholesale_cost#45531, ss_sp#45549 AS store_sales_price#45532, (coalesce(ws_qty#45538L, cast(0 as bigint)) + coalesce(cs_qty#45543L, cast(0 as bigint))) AS other_chan_qty#45533L, CheckOverflow((promote_precision(cast(coalesce(ws_wc#45539, cast(0 as decimal(17,2))) as decimal(18,2))) + promote_precision(cast(coalesce(cs_wc#45544, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS other_chan_wholesale_cost#45534, CheckOverflow((promote_precision(cast(coalesce(ws_sp#45540, cast(0 as decimal(17,2))) as decimal(18,2))) + promote_precision(cast(coalesce(cs_sp#45545, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS other_chan_sales_price#45535, ss_wc#45548, ws_qty#45538L, cs_qty#45543L, ss_qty#45547L, ss_sp#45549]
            +- Filter (((coalesce(ws_qty#45538L, cast(0 as bigint)) > cast(0 as bigint)) || (coalesce(cs_qty#45543L, cast(0 as bigint)) > cast(0 as bigint))) && (ss_sold_year#45546 = 2000))
               +- Join LeftOuter, (((cs_sold_year#45541 = ss_sold_year#45546) && (cs_item_sk#15 = ss_item_sk#132)) && (cs_customer_sk#45542 = ss_customer_sk#133))
                  :- Join LeftOuter, (((ws_sold_year#45536 = ss_sold_year#45546) && (ws_item_sk#219 = ss_item_sk#132)) && (ws_customer_sk#45537 = ss_customer_sk#133))
                  :  :- SubqueryAlias `ss`
                  :  :  +- Aggregate [d_year#498, ss_item_sk#132, ss_customer_sk#133], [d_year#498 AS ss_sold_year#45546, ss_item_sk#132, ss_customer_sk#133, sum(cast(ss_quantity#140 as bigint)) AS ss_qty#45547L, sum(ss_wholesale_cost#141) AS ss_wc#45548, sum(ss_sales_price#143) AS ss_sp#45549]
                  :  :     +- Filter isnull(sr_ticket_number#185L)
                  :  :        +- Join Inner, (ss_sold_date_sk#130 = d_date_sk#492)
                  :  :           :- Join LeftOuter, ((sr_ticket_number#185L = ss_ticket_number#139L) && (ss_item_sk#132 = sr_item_sk#178))
                  :  :           :  :- SubqueryAlias `store_sales`
                  :  :           :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :           :  +- SubqueryAlias `store_returns`
                  :  :           :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :           +- SubqueryAlias `date_dim`
                  :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `ws`
                  :     +- Aggregate [d_year#498, ws_item_sk#219, ws_bill_customer_sk#220], [d_year#498 AS ws_sold_year#45536, ws_item_sk#219, ws_bill_customer_sk#220 AS ws_customer_sk#45537, sum(cast(ws_quantity#234 as bigint)) AS ws_qty#45538L, sum(ws_wholesale_cost#235) AS ws_wc#45539, sum(ws_sales_price#237) AS ws_sp#45540]
                  :        +- Filter isnull(wr_order_number#297L)
                  :           +- Join Inner, (ws_sold_date_sk#216 = d_date_sk#492)
                  :              :- Join LeftOuter, ((wr_order_number#297L = ws_order_number#233L) && (ws_item_sk#219 = wr_item_sk#286))
                  :              :  :- SubqueryAlias `web_sales`
                  :              :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :              :  +- SubqueryAlias `web_returns`
                  :              :     +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                  :              +- SubqueryAlias `date_dim`
                  :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `cs`
                     +- Aggregate [d_year#498, cs_item_sk#15, cs_bill_customer_sk#3], [d_year#498 AS cs_sold_year#45541, cs_item_sk#15, cs_bill_customer_sk#3 AS cs_customer_sk#45542, sum(cast(cs_quantity#18 as bigint)) AS cs_qty#45543L, sum(cs_wholesale_cost#19) AS cs_wc#45544, sum(cs_sales_price#21) AS cs_sp#45545]
                        +- Filter isnull(cr_order_number#84L)
                           +- Join Inner, (cs_sold_date_sk#0 = d_date_sk#492)
                              :- Join LeftOuter, ((cr_order_number#84L = cs_order_number#17L) && (cs_item_sk#15 = cr_item_sk#70))
                              :  :- SubqueryAlias `catalog_sales`
                              :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                              :  +- SubqueryAlias `catalog_returns`
                              :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                              +- SubqueryAlias `date_dim`
                                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 20:39:34 INFO Query:
== Query: q78-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ss_sold_year#45586, ss_item_sk#132, ss_customer_sk#133, ratio#45569, store_qty#45570L, store_wholesale_cost#45571, store_sales_price#45572, other_chan_qty#45573L, other_chan_wholesale_cost#45574, other_chan_sales_price#45575]
      +- Sort [ss_sold_year#45586 ASC NULLS FIRST, ss_item_sk#132 ASC NULLS FIRST, ss_customer_sk#133 ASC NULLS FIRST, ss_qty#45587L DESC NULLS LAST, ss_wc#45588 DESC NULLS LAST, ss_sp#45589 DESC NULLS LAST, other_chan_qty#45573L ASC NULLS FIRST, other_chan_wholesale_cost#45574 ASC NULLS FIRST, other_chan_sales_price#45575 ASC NULLS FIRST, round((cast(ss_qty#45587L as double) / cast(coalesce((ws_qty#45578L + cs_qty#45583L), cast(1 as bigint)) as double)), 2) ASC NULLS FIRST], true
         +- Project [ss_sold_year#45586, ss_item_sk#132, ss_customer_sk#133, round((cast(ss_qty#45587L as double) / cast((coalesce(ws_qty#45578L, cast(0 as bigint)) + coalesce(cs_qty#45583L, cast(0 as bigint))) as double)), 2) AS ratio#45569, ss_qty#45587L AS store_qty#45570L, ss_wc#45588 AS store_wholesale_cost#45571, ss_sp#45589 AS store_sales_price#45572, (coalesce(ws_qty#45578L, cast(0 as bigint)) + coalesce(cs_qty#45583L, cast(0 as bigint))) AS other_chan_qty#45573L, CheckOverflow((promote_precision(cast(coalesce(ws_wc#45579, cast(0 as decimal(17,2))) as decimal(18,2))) + promote_precision(cast(coalesce(cs_wc#45584, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS other_chan_wholesale_cost#45574, CheckOverflow((promote_precision(cast(coalesce(ws_sp#45580, cast(0 as decimal(17,2))) as decimal(18,2))) + promote_precision(cast(coalesce(cs_sp#45585, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS other_chan_sales_price#45575, ws_qty#45578L, ss_wc#45588, cs_qty#45583L, ss_sp#45589, ss_qty#45587L]
            +- Filter (((coalesce(ws_qty#45578L, cast(0 as bigint)) > cast(0 as bigint)) || (coalesce(cs_qty#45583L, cast(0 as bigint)) > cast(0 as bigint))) && (ss_sold_year#45586 = 2000))
               +- Join LeftOuter, (((cs_sold_year#45581 = ss_sold_year#45586) && (cs_item_sk#15 = ss_item_sk#132)) && (cs_customer_sk#45582 = ss_customer_sk#133))
                  :- Join LeftOuter, (((ws_sold_year#45576 = ss_sold_year#45586) && (ws_item_sk#219 = ss_item_sk#132)) && (ws_customer_sk#45577 = ss_customer_sk#133))
                  :  :- SubqueryAlias `ss`
                  :  :  +- Aggregate [d_year#498, ss_item_sk#132, ss_customer_sk#133], [d_year#498 AS ss_sold_year#45586, ss_item_sk#132, ss_customer_sk#133, sum(cast(ss_quantity#140 as bigint)) AS ss_qty#45587L, sum(ss_wholesale_cost#141) AS ss_wc#45588, sum(ss_sales_price#143) AS ss_sp#45589]
                  :  :     +- Filter isnull(sr_ticket_number#185L)
                  :  :        +- Join Inner, (ss_sold_date_sk#130 = d_date_sk#492)
                  :  :           :- Join LeftOuter, ((sr_ticket_number#185L = ss_ticket_number#139L) && (ss_item_sk#132 = sr_item_sk#178))
                  :  :           :  :- SubqueryAlias `store_sales`
                  :  :           :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :           :  +- SubqueryAlias `store_returns`
                  :  :           :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :           +- SubqueryAlias `date_dim`
                  :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `ws`
                  :     +- Aggregate [d_year#498, ws_item_sk#219, ws_bill_customer_sk#220], [d_year#498 AS ws_sold_year#45576, ws_item_sk#219, ws_bill_customer_sk#220 AS ws_customer_sk#45577, sum(cast(ws_quantity#234 as bigint)) AS ws_qty#45578L, sum(ws_wholesale_cost#235) AS ws_wc#45579, sum(ws_sales_price#237) AS ws_sp#45580]
                  :        +- Filter isnull(wr_order_number#297L)
                  :           +- Join Inner, (ws_sold_date_sk#216 = d_date_sk#492)
                  :              :- Join LeftOuter, ((wr_order_number#297L = ws_order_number#233L) && (ws_item_sk#219 = wr_item_sk#286))
                  :              :  :- SubqueryAlias `web_sales`
                  :              :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :              :  +- SubqueryAlias `web_returns`
                  :              :     +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                  :              +- SubqueryAlias `date_dim`
                  :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `cs`
                     +- Aggregate [d_year#498, cs_item_sk#15, cs_bill_customer_sk#3], [d_year#498 AS cs_sold_year#45581, cs_item_sk#15, cs_bill_customer_sk#3 AS cs_customer_sk#45582, sum(cast(cs_quantity#18 as bigint)) AS cs_qty#45583L, sum(cs_wholesale_cost#19) AS cs_wc#45584, sum(cs_sales_price#21) AS cs_sp#45585]
                        +- Filter isnull(cr_order_number#84L)
                           +- Join Inner, (cs_sold_date_sk#0 = d_date_sk#492)
                              :- Join LeftOuter, ((cr_order_number#84L = cs_order_number#17L) && (cs_item_sk#15 = cr_item_sk#70))
                              :  :- SubqueryAlias `catalog_sales`
                              :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                              :  +- SubqueryAlias `catalog_returns`
                              :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                              +- SubqueryAlias `date_dim`
                                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 199.241106548s
Running execution q79-v2.4 iteration: 1, StandardRun=true
19/09/08 20:42:56 INFO Query:
== Query: q79-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [c_last_name#421, c_first_name#420, substring(s_city, 1, 30)#45727, ss_ticket_number#139L, amt#45723, profit#45724]
      +- Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, substring(s_city#686, 1, 30) ASC NULLS FIRST, profit#45724 ASC NULLS FIRST], true
         +- Project [c_last_name#421, c_first_name#420, substring(s_city#686, 1, 30) AS substring(s_city, 1, 30)#45727, ss_ticket_number#139L, amt#45723, profit#45724, s_city#686]
            +- Filter (ss_customer_sk#133 = c_customer_sk#412)
               +- Join Inner
                  :- SubqueryAlias `ms`
                  :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133, ss_addr_sk#136, s_city#686], [ss_ticket_number#139L, ss_customer_sk#133, s_city#686, sum(ss_coupon_amt#149) AS amt#45723, sum(ss_net_profit#152) AS profit#45724]
                  :     +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_hdemo_sk#135 = hd_demo_sk#548) && ((hd_dep_count#551 = 6) || (hd_vehicle_count#552 > 2)))) && (((d_dow#499 = 1) && d_year#498 IN (1999,(1999 + 1),(1999 + 2))) && ((s_number_employees#670 >= 200) && (s_number_employees#670 <= 295))))
                  :        +- Join Inner
                  :           :- Join Inner
                  :           :  :- Join Inner
                  :           :  :  :- SubqueryAlias `store_sales`
                  :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :           :  :  +- SubqueryAlias `date_dim`
                  :           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :           :  +- SubqueryAlias `store`
                  :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  :           +- SubqueryAlias `household_demographics`
                  :              +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                  +- SubqueryAlias `customer`
                     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/09/08 20:42:56 INFO Query:
== Query: q79-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [c_last_name#421, c_first_name#420, substring(s_city, 1, 30)#45738, ss_ticket_number#139L, amt#45734, profit#45735]
      +- Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, substring(s_city#686, 1, 30) ASC NULLS FIRST, profit#45735 ASC NULLS FIRST], true
         +- Project [c_last_name#421, c_first_name#420, substring(s_city#686, 1, 30) AS substring(s_city, 1, 30)#45738, ss_ticket_number#139L, amt#45734, profit#45735, s_city#686]
            +- Filter (ss_customer_sk#133 = c_customer_sk#412)
               +- Join Inner
                  :- SubqueryAlias `ms`
                  :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133, ss_addr_sk#136, s_city#686], [ss_ticket_number#139L, ss_customer_sk#133, s_city#686, sum(ss_coupon_amt#149) AS amt#45734, sum(ss_net_profit#152) AS profit#45735]
                  :     +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_hdemo_sk#135 = hd_demo_sk#548) && ((hd_dep_count#551 = 6) || (hd_vehicle_count#552 > 2)))) && (((d_dow#499 = 1) && d_year#498 IN (1999,(1999 + 1),(1999 + 2))) && ((s_number_employees#670 >= 200) && (s_number_employees#670 <= 295))))
                  :        +- Join Inner
                  :           :- Join Inner
                  :           :  :- Join Inner
                  :           :  :  :- SubqueryAlias `store_sales`
                  :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :           :  :  +- SubqueryAlias `date_dim`
                  :           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :           :  +- SubqueryAlias `store`
                  :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  :           +- SubqueryAlias `household_demographics`
                  :              +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                  +- SubqueryAlias `customer`
                     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 17.668151162999997s
Running execution q80-v2.4 iteration: 1, StandardRun=true
19/09/08 20:43:16 INFO Query:
== Query: q80-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#45879 ASC NULLS FIRST, id#45880 ASC NULLS FIRST], true
      +- Aggregate [channel#45879, id#45880, spark_grouping_id#45876], [channel#45879, id#45880, sum(sales#45854) AS sales#45850, sum(returns#45855) AS returns#45851, sum(profit#45856) AS profit#45852]
         +- Expand [List(channel#45844, id#45845, sales#45854, returns#45855, profit#45856, channel#45877, id#45878, 0), List(channel#45844, id#45845, sales#45854, returns#45855, profit#45856, channel#45877, null, 1), List(channel#45844, id#45845, sales#45854, returns#45855, profit#45856, null, null, 3)], [channel#45844, id#45845, sales#45854, returns#45855, profit#45856, channel#45879, id#45880, spark_grouping_id#45876]
            +- Project [channel#45844, id#45845, sales#45854, returns#45855, profit#45856, channel#45844 AS channel#45877, id#45845 AS id#45878]
               +- SubqueryAlias `x`
                  +- Union
                     :- Union
                     :  :- Project [store channel AS channel#45844, concat(store, store_id#45853) AS id#45845, sales#45854, returns#45855, profit#45856]
                     :  :  +- SubqueryAlias `ssr`
                     :  :     +- Aggregate [s_store_id#665], [s_store_id#665 AS store_id#45853, sum(ss_ext_sales_price#145) AS sales#45854, sum(coalesce(cast(sr_return_amt#187 as decimal(12,2)), cast(0 as decimal(12,2)))) AS returns#45855, sum(CheckOverflow((promote_precision(cast(ss_net_profit#152 as decimal(13,2))) - promote_precision(cast(coalesce(cast(sr_net_loss#195 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2))) AS profit#45856]
                     :  :        +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && ((ss_store_sk#137 = s_store_sk#664) && (ss_item_sk#132 = i_item_sk#564))) && (((cast(i_current_price#569 as decimal(7,2)) > cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (ss_promo_sk#138 = p_promo_sk#608)) && (p_channel_tv#619 = N)))
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- Join Inner
                     :  :              :  :  :- Join Inner
                     :  :              :  :  :  :- Join LeftOuter, ((ss_item_sk#132 = sr_item_sk#178) && (ss_ticket_number#139L = sr_ticket_number#185L))
                     :  :              :  :  :  :  :- SubqueryAlias `store_sales`
                     :  :              :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :              :  :  :  :  +- SubqueryAlias `store_returns`
                     :  :              :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :              :  :  :  +- SubqueryAlias `date_dim`
                     :  :              :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :              :  :  +- SubqueryAlias `store`
                     :  :              :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  :              :  +- SubqueryAlias `item`
                     :  :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :              +- SubqueryAlias `promotion`
                     :  :                 +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                     :  +- Project [catalog channel AS channel#45846, concat(catalog_page, catalog_page_id#45857) AS id#45847, sales#45858, returns#45859, profit#45860]
                     :     +- SubqueryAlias `csr`
                     :        +- Aggregate [cp_catalog_page_id#395], [cp_catalog_page_id#395 AS catalog_page_id#45857, sum(cs_ext_sales_price#23) AS sales#45858, sum(coalesce(cast(cr_return_amount#86 as decimal(12,2)), cast(0 as decimal(12,2)))) AS returns#45859, sum(CheckOverflow((promote_precision(cast(cs_net_profit#33 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_net_loss#94 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2))) AS profit#45860]
                     :           +- Filter ((((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && ((cs_catalog_page_sk#12 = cp_catalog_page_sk#394) && (cs_item_sk#15 = i_item_sk#564))) && (((cast(i_current_price#569 as decimal(7,2)) > cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cs_promo_sk#16 = p_promo_sk#608)) && (p_channel_tv#619 = N)))
                     :              +- Join Inner
                     :                 :- Join Inner
                     :                 :  :- Join Inner
                     :                 :  :  :- Join Inner
                     :                 :  :  :  :- Join LeftOuter, ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                     :                 :  :  :  :  :- SubqueryAlias `catalog_sales`
                     :                 :  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :                 :  :  :  :  +- SubqueryAlias `catalog_returns`
                     :                 :  :  :  :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                     :                 :  :  :  +- SubqueryAlias `date_dim`
                     :                 :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :                 :  :  +- SubqueryAlias `catalog_page`
                     :                 :  :     +- Relation[cp_catalog_page_sk#394,cp_catalog_page_id#395,cp_start_date_sk#396,cp_end_date_sk#397,cp_department#398,cp_catalog_number#399,cp_catalog_page_number#400,cp_description#401,cp_type#402] parquet
                     :                 :  +- SubqueryAlias `item`
                     :                 :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :                 +- SubqueryAlias `promotion`
                     :                    +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                     +- Project [web channel AS channel#45848, concat(web_site, web_site_id#799) AS id#45849, sales#45861, returns#45862, profit#45863]
                        +- SubqueryAlias `wsr`
                           +- Aggregate [web_site_id#799], [web_site_id#799, sum(ws_ext_sales_price#239) AS sales#45861, sum(coalesce(cast(wr_return_amt#299 as decimal(12,2)), cast(0 as decimal(12,2)))) AS returns#45862, sum(CheckOverflow((promote_precision(cast(ws_net_profit#249 as decimal(13,2))) - promote_precision(cast(coalesce(cast(wr_net_loss#307 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2))) AS profit#45863]
                              +- Filter ((((ws_sold_date_sk#216 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && ((ws_web_site_sk#229 = web_site_sk#798) && (ws_item_sk#219 = i_item_sk#564))) && (((cast(i_current_price#569 as decimal(7,2)) > cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (ws_promo_sk#232 = p_promo_sk#608)) && (p_channel_tv#619 = N)))
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- Join Inner
                                    :  :  :- Join Inner
                                    :  :  :  :- Join LeftOuter, ((ws_item_sk#219 = wr_item_sk#286) && (ws_order_number#233L = wr_order_number#297L))
                                    :  :  :  :  :- SubqueryAlias `web_sales`
                                    :  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  :  :  :  +- SubqueryAlias `web_returns`
                                    :  :  :  :     +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                                    :  :  :  +- SubqueryAlias `date_dim`
                                    :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                    :  :  +- SubqueryAlias `web_site`
                                    :  :     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet
                                    :  +- SubqueryAlias `item`
                                    :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                    +- SubqueryAlias `promotion`
                                       +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet

     : benchmark
19/09/08 20:43:16 INFO Query:
== Query: q80-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#45923 ASC NULLS FIRST, id#45924 ASC NULLS FIRST], true
      +- Aggregate [channel#45923, id#45924, spark_grouping_id#45920], [channel#45923, id#45924, sum(sales#45898) AS sales#45894, sum(returns#45899) AS returns#45895, sum(profit#45900) AS profit#45896]
         +- Expand [List(channel#45888, id#45889, sales#45898, returns#45899, profit#45900, channel#45921, id#45922, 0), List(channel#45888, id#45889, sales#45898, returns#45899, profit#45900, channel#45921, null, 1), List(channel#45888, id#45889, sales#45898, returns#45899, profit#45900, null, null, 3)], [channel#45888, id#45889, sales#45898, returns#45899, profit#45900, channel#45923, id#45924, spark_grouping_id#45920]
            +- Project [channel#45888, id#45889, sales#45898, returns#45899, profit#45900, channel#45888 AS channel#45921, id#45889 AS id#45922]
               +- SubqueryAlias `x`
                  +- Union
                     :- Union
                     :  :- Project [store channel AS channel#45888, concat(store, store_id#45897) AS id#45889, sales#45898, returns#45899, profit#45900]
                     :  :  +- SubqueryAlias `ssr`
                     :  :     +- Aggregate [s_store_id#665], [s_store_id#665 AS store_id#45897, sum(ss_ext_sales_price#145) AS sales#45898, sum(coalesce(cast(sr_return_amt#187 as decimal(12,2)), cast(0 as decimal(12,2)))) AS returns#45899, sum(CheckOverflow((promote_precision(cast(ss_net_profit#152 as decimal(13,2))) - promote_precision(cast(coalesce(cast(sr_net_loss#195 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2))) AS profit#45900]
                     :  :        +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && ((ss_store_sk#137 = s_store_sk#664) && (ss_item_sk#132 = i_item_sk#564))) && (((cast(i_current_price#569 as decimal(7,2)) > cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (ss_promo_sk#138 = p_promo_sk#608)) && (p_channel_tv#619 = N)))
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- Join Inner
                     :  :              :  :  :- Join Inner
                     :  :              :  :  :  :- Join LeftOuter, ((ss_item_sk#132 = sr_item_sk#178) && (ss_ticket_number#139L = sr_ticket_number#185L))
                     :  :              :  :  :  :  :- SubqueryAlias `store_sales`
                     :  :              :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :              :  :  :  :  +- SubqueryAlias `store_returns`
                     :  :              :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :              :  :  :  +- SubqueryAlias `date_dim`
                     :  :              :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :              :  :  +- SubqueryAlias `store`
                     :  :              :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  :              :  +- SubqueryAlias `item`
                     :  :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :              +- SubqueryAlias `promotion`
                     :  :                 +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                     :  +- Project [catalog channel AS channel#45890, concat(catalog_page, catalog_page_id#45901) AS id#45891, sales#45902, returns#45903, profit#45904]
                     :     +- SubqueryAlias `csr`
                     :        +- Aggregate [cp_catalog_page_id#395], [cp_catalog_page_id#395 AS catalog_page_id#45901, sum(cs_ext_sales_price#23) AS sales#45902, sum(coalesce(cast(cr_return_amount#86 as decimal(12,2)), cast(0 as decimal(12,2)))) AS returns#45903, sum(CheckOverflow((promote_precision(cast(cs_net_profit#33 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_net_loss#94 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2))) AS profit#45904]
                     :           +- Filter ((((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && ((cs_catalog_page_sk#12 = cp_catalog_page_sk#394) && (cs_item_sk#15 = i_item_sk#564))) && (((cast(i_current_price#569 as decimal(7,2)) > cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cs_promo_sk#16 = p_promo_sk#608)) && (p_channel_tv#619 = N)))
                     :              +- Join Inner
                     :                 :- Join Inner
                     :                 :  :- Join Inner
                     :                 :  :  :- Join Inner
                     :                 :  :  :  :- Join LeftOuter, ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                     :                 :  :  :  :  :- SubqueryAlias `catalog_sales`
                     :                 :  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :                 :  :  :  :  +- SubqueryAlias `catalog_returns`
                     :                 :  :  :  :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                     :                 :  :  :  +- SubqueryAlias `date_dim`
                     :                 :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :                 :  :  +- SubqueryAlias `catalog_page`
                     :                 :  :     +- Relation[cp_catalog_page_sk#394,cp_catalog_page_id#395,cp_start_date_sk#396,cp_end_date_sk#397,cp_department#398,cp_catalog_number#399,cp_catalog_page_number#400,cp_description#401,cp_type#402] parquet
                     :                 :  +- SubqueryAlias `item`
                     :                 :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :                 +- SubqueryAlias `promotion`
                     :                    +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                     +- Project [web channel AS channel#45892, concat(web_site, web_site_id#799) AS id#45893, sales#45905, returns#45906, profit#45907]
                        +- SubqueryAlias `wsr`
                           +- Aggregate [web_site_id#799], [web_site_id#799, sum(ws_ext_sales_price#239) AS sales#45905, sum(coalesce(cast(wr_return_amt#299 as decimal(12,2)), cast(0 as decimal(12,2)))) AS returns#45906, sum(CheckOverflow((promote_precision(cast(ws_net_profit#249 as decimal(13,2))) - promote_precision(cast(coalesce(cast(wr_net_loss#307 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2))) AS profit#45907]
                              +- Filter ((((ws_sold_date_sk#216 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && ((ws_web_site_sk#229 = web_site_sk#798) && (ws_item_sk#219 = i_item_sk#564))) && (((cast(i_current_price#569 as decimal(7,2)) > cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (ws_promo_sk#232 = p_promo_sk#608)) && (p_channel_tv#619 = N)))
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- Join Inner
                                    :  :  :- Join Inner
                                    :  :  :  :- Join LeftOuter, ((ws_item_sk#219 = wr_item_sk#286) && (ws_order_number#233L = wr_order_number#297L))
                                    :  :  :  :  :- SubqueryAlias `web_sales`
                                    :  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  :  :  :  +- SubqueryAlias `web_returns`
                                    :  :  :  :     +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                                    :  :  :  +- SubqueryAlias `date_dim`
                                    :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                    :  :  +- SubqueryAlias `web_site`
                                    :  :     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet
                                    :  +- SubqueryAlias `item`
                                    :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                    +- SubqueryAlias `promotion`
                                       +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet

      running Thread[benchmark runner,5,main]
Execution time: 238.896095973s
Running execution q81-v2.4 iteration: 1, StandardRun=true
19/09/08 20:47:18 INFO Query:
== Query: q81-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_customer_id#413 ASC NULLS FIRST, c_salutation#419 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, c_last_name#421 ASC NULLS FIRST, ca_street_number#450 ASC NULLS FIRST, ca_street_name#451 ASC NULLS FIRST, ca_street_type#452 ASC NULLS FIRST, ca_suite_number#453 ASC NULLS FIRST, ca_city#454 ASC NULLS FIRST, ca_county#455 ASC NULLS FIRST, ca_state#456 ASC NULLS FIRST, ca_zip#457 ASC NULLS FIRST, ca_country#458 ASC NULLS FIRST, ca_gmt_offset#459 ASC NULLS FIRST, ca_location_type#460 ASC NULLS FIRST, ctr_total_return#46086 ASC NULLS FIRST], true
      +- Project [c_customer_id#413, c_salutation#419, c_first_name#420, c_last_name#421, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, ctr_total_return#46086]
         +- Filter (((cast(ctr_total_return#46086 as decimal(24,7)) > cast(scalar-subquery#46083 [ctr_state#46085] as decimal(24,7))) && (ca_address_sk#448 = c_current_addr_sk#416)) && ((ca_state#456 = GA) && (ctr_customer_sk#46084 = c_customer_sk#412)))
            :  +- Aggregate [CheckOverflow((promote_precision(cast(avg(ctr_total_return#46086) as decimal(21,6))) * promote_precision(cast(1.2 as decimal(21,6)))), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#46089]
            :     +- Filter (outer(ctr_state#46085) = ctr_state#46085)
            :        +- SubqueryAlias `ctr2`
            :           +- SubqueryAlias `customer_total_return`
            :              +- Aggregate [cr_returning_customer_sk#75, ca_state#456], [cr_returning_customer_sk#75 AS ctr_customer_sk#46084, ca_state#456 AS ctr_state#46085, sum(cr_return_amt_inc_tax#88) AS ctr_total_return#46086]
            :                 +- Filter (((cr_returned_date_sk#68 = d_date_sk#492) && (d_year#498 = 2000)) && (cr_returning_addr_sk#78 = ca_address_sk#448))
            :                    +- Join Inner
            :                       :- Join Inner
            :                       :  :- SubqueryAlias `catalog_returns`
            :                       :  :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
            :                       :  +- SubqueryAlias `date_dim`
            :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :                       +- SubqueryAlias `customer_address`
            :                          +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ctr1`
               :  :  +- SubqueryAlias `customer_total_return`
               :  :     +- Aggregate [cr_returning_customer_sk#75, ca_state#456], [cr_returning_customer_sk#75 AS ctr_customer_sk#46084, ca_state#456 AS ctr_state#46085, sum(cr_return_amt_inc_tax#88) AS ctr_total_return#46086]
               :  :        +- Filter (((cr_returned_date_sk#68 = d_date_sk#492) && (d_year#498 = 2000)) && (cr_returning_addr_sk#78 = ca_address_sk#448))
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- SubqueryAlias `catalog_returns`
               :  :              :  :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               :  :              :  +- SubqueryAlias `date_dim`
               :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              +- SubqueryAlias `customer_address`
               :  :                 +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer_address`
               :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer`
                  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/09/08 20:47:18 INFO Query:
== Query: q81-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_customer_id#413 ASC NULLS FIRST, c_salutation#419 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, c_last_name#421 ASC NULLS FIRST, ca_street_number#450 ASC NULLS FIRST, ca_street_name#451 ASC NULLS FIRST, ca_street_type#452 ASC NULLS FIRST, ca_suite_number#453 ASC NULLS FIRST, ca_city#454 ASC NULLS FIRST, ca_county#455 ASC NULLS FIRST, ca_state#456 ASC NULLS FIRST, ca_zip#457 ASC NULLS FIRST, ca_country#458 ASC NULLS FIRST, ca_gmt_offset#459 ASC NULLS FIRST, ca_location_type#460 ASC NULLS FIRST, ctr_total_return#46109 ASC NULLS FIRST], true
      +- Project [c_customer_id#413, c_salutation#419, c_first_name#420, c_last_name#421, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, ctr_total_return#46109]
         +- Filter (((cast(ctr_total_return#46109 as decimal(24,7)) > cast(scalar-subquery#46106 [ctr_state#46108] as decimal(24,7))) && (ca_address_sk#448 = c_current_addr_sk#416)) && ((ca_state#456 = GA) && (ctr_customer_sk#46107 = c_customer_sk#412)))
            :  +- Aggregate [CheckOverflow((promote_precision(cast(avg(ctr_total_return#46109) as decimal(21,6))) * promote_precision(cast(1.2 as decimal(21,6)))), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#46112]
            :     +- Filter (outer(ctr_state#46108) = ctr_state#46108)
            :        +- SubqueryAlias `ctr2`
            :           +- SubqueryAlias `customer_total_return`
            :              +- Aggregate [cr_returning_customer_sk#75, ca_state#456], [cr_returning_customer_sk#75 AS ctr_customer_sk#46107, ca_state#456 AS ctr_state#46108, sum(cr_return_amt_inc_tax#88) AS ctr_total_return#46109]
            :                 +- Filter (((cr_returned_date_sk#68 = d_date_sk#492) && (d_year#498 = 2000)) && (cr_returning_addr_sk#78 = ca_address_sk#448))
            :                    +- Join Inner
            :                       :- Join Inner
            :                       :  :- SubqueryAlias `catalog_returns`
            :                       :  :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
            :                       :  +- SubqueryAlias `date_dim`
            :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :                       +- SubqueryAlias `customer_address`
            :                          +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ctr1`
               :  :  +- SubqueryAlias `customer_total_return`
               :  :     +- Aggregate [cr_returning_customer_sk#75, ca_state#456], [cr_returning_customer_sk#75 AS ctr_customer_sk#46107, ca_state#456 AS ctr_state#46108, sum(cr_return_amt_inc_tax#88) AS ctr_total_return#46109]
               :  :        +- Filter (((cr_returned_date_sk#68 = d_date_sk#492) && (d_year#498 = 2000)) && (cr_returning_addr_sk#78 = ca_address_sk#448))
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- SubqueryAlias `catalog_returns`
               :  :              :  :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               :  :              :  +- SubqueryAlias `date_dim`
               :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              +- SubqueryAlias `customer_address`
               :  :                 +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer_address`
               :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer`
                  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 15.710097449000001s
Running execution q82-v2.4 iteration: 1, StandardRun=true
19/09/08 20:47:35 INFO Query:
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
19/09/08 20:47:35 INFO Query:
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 22.478024752s
Running execution q83-v2.4 iteration: 1, StandardRun=true
19/09/08 20:47:59 INFO Query:
== Query: q83-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_id#46249 ASC NULLS FIRST, sr_item_qty#46250L ASC NULLS FIRST], true
      +- Project [item_id#46249, sr_item_qty#46250L, (((cast(sr_item_qty#46250L as double) / cast(((sr_item_qty#46250L + cr_item_qty#46254L) + wr_item_qty#46258L) as double)) / cast(3.0 as double)) * cast(100 as double)) AS sr_dev#46245, cr_item_qty#46254L, (((cast(cr_item_qty#46254L as double) / cast(((sr_item_qty#46250L + cr_item_qty#46254L) + wr_item_qty#46258L) as double)) / cast(3.0 as double)) * cast(100 as double)) AS cr_dev#46246, wr_item_qty#46258L, (((cast(wr_item_qty#46258L as double) / cast(((sr_item_qty#46250L + cr_item_qty#46254L) + wr_item_qty#46258L) as double)) / cast(3.0 as double)) * cast(100 as double)) AS wr_dev#46247, CheckOverflow((promote_precision(cast(cast(((sr_item_qty#46250L + cr_item_qty#46254L) + wr_item_qty#46258L) as decimal(20,0)) as decimal(21,1))) / promote_precision(cast(3.0 as decimal(21,1)))), DecimalType(27,6)) AS average#46248]
         +- Filter ((item_id#46249 = item_id#46253) && (item_id#46249 = item_id#46257))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `sr_items`
               :  :  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#46249, sum(cast(sr_return_quantity#186 as bigint)) AS sr_item_qty#46250L]
               :  :     +- Filter (((sr_item_sk#178 = i_item_sk#564) && d_date#494 IN (list#46252 [])) && (sr_returned_date_sk#176 = d_date_sk#492))
               :  :        :  +- Project [d_date#494]
               :  :        :     +- Filter d_week_seq#496 IN (list#46251 [])
               :  :        :        :  +- Project [d_week_seq#496]
               :  :        :        :     +- Filter d_date#494 IN (cast(2000-06-30 as date),cast(2000-09-27 as date),cast(2000-11-17 as date))
               :  :        :        :        +- SubqueryAlias `date_dim`
               :  :        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        :        +- SubqueryAlias `date_dim`
               :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- SubqueryAlias `store_returns`
               :  :           :  :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :  :           :  +- SubqueryAlias `item`
               :  :           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- SubqueryAlias `date_dim`
               :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `cr_items`
               :     +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#46253, sum(cast(cr_return_quantity#85 as bigint)) AS cr_item_qty#46254L]
               :        +- Filter (((cr_item_sk#70 = i_item_sk#564) && d_date#494 IN (list#46256 [])) && (cr_returned_date_sk#68 = d_date_sk#492))
               :           :  +- Project [d_date#494]
               :           :     +- Filter d_week_seq#496 IN (list#46255 [])
               :           :        :  +- Project [d_week_seq#496]
               :           :        :     +- Filter d_date#494 IN (cast(2000-06-30 as date),cast(2000-09-27 as date),cast(2000-11-17 as date))
               :           :        :        +- SubqueryAlias `date_dim`
               :           :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Join Inner
               :              :- Join Inner
               :              :  :- SubqueryAlias `catalog_returns`
               :              :  :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               :              :  +- SubqueryAlias `item`
               :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- SubqueryAlias `date_dim`
               :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `wr_items`
                  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#46257, sum(cast(wr_return_quantity#298 as bigint)) AS wr_item_qty#46258L]
                     +- Filter (((wr_item_sk#286 = i_item_sk#564) && d_date#494 IN (list#46260 [])) && (wr_returned_date_sk#284 = d_date_sk#492))
                        :  +- Project [d_date#494]
                        :     +- Filter d_week_seq#496 IN (list#46259 [])
                        :        :  +- Project [d_week_seq#496]
                        :        :     +- Filter d_date#494 IN (cast(2000-06-30 as date),cast(2000-09-27 as date),cast(2000-11-17 as date))
                        :        :        +- SubqueryAlias `date_dim`
                        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `web_returns`
                           :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                           :  +- SubqueryAlias `item`
                           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 20:47:59 INFO Query:
== Query: q83-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_id#46276 ASC NULLS FIRST, sr_item_qty#46277L ASC NULLS FIRST], true
      +- Project [item_id#46276, sr_item_qty#46277L, (((cast(sr_item_qty#46277L as double) / cast(((sr_item_qty#46277L + cr_item_qty#46281L) + wr_item_qty#46285L) as double)) / cast(3.0 as double)) * cast(100 as double)) AS sr_dev#46272, cr_item_qty#46281L, (((cast(cr_item_qty#46281L as double) / cast(((sr_item_qty#46277L + cr_item_qty#46281L) + wr_item_qty#46285L) as double)) / cast(3.0 as double)) * cast(100 as double)) AS cr_dev#46273, wr_item_qty#46285L, (((cast(wr_item_qty#46285L as double) / cast(((sr_item_qty#46277L + cr_item_qty#46281L) + wr_item_qty#46285L) as double)) / cast(3.0 as double)) * cast(100 as double)) AS wr_dev#46274, CheckOverflow((promote_precision(cast(cast(((sr_item_qty#46277L + cr_item_qty#46281L) + wr_item_qty#46285L) as decimal(20,0)) as decimal(21,1))) / promote_precision(cast(3.0 as decimal(21,1)))), DecimalType(27,6)) AS average#46275]
         +- Filter ((item_id#46276 = item_id#46280) && (item_id#46276 = item_id#46284))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `sr_items`
               :  :  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#46276, sum(cast(sr_return_quantity#186 as bigint)) AS sr_item_qty#46277L]
               :  :     +- Filter (((sr_item_sk#178 = i_item_sk#564) && d_date#494 IN (list#46279 [])) && (sr_returned_date_sk#176 = d_date_sk#492))
               :  :        :  +- Project [d_date#494]
               :  :        :     +- Filter d_week_seq#496 IN (list#46278 [])
               :  :        :        :  +- Project [d_week_seq#496]
               :  :        :        :     +- Filter d_date#494 IN (cast(2000-06-30 as date),cast(2000-09-27 as date),cast(2000-11-17 as date))
               :  :        :        :        +- SubqueryAlias `date_dim`
               :  :        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        :        +- SubqueryAlias `date_dim`
               :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- SubqueryAlias `store_returns`
               :  :           :  :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :  :           :  +- SubqueryAlias `item`
               :  :           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- SubqueryAlias `date_dim`
               :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `cr_items`
               :     +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#46280, sum(cast(cr_return_quantity#85 as bigint)) AS cr_item_qty#46281L]
               :        +- Filter (((cr_item_sk#70 = i_item_sk#564) && d_date#494 IN (list#46283 [])) && (cr_returned_date_sk#68 = d_date_sk#492))
               :           :  +- Project [d_date#494]
               :           :     +- Filter d_week_seq#496 IN (list#46282 [])
               :           :        :  +- Project [d_week_seq#496]
               :           :        :     +- Filter d_date#494 IN (cast(2000-06-30 as date),cast(2000-09-27 as date),cast(2000-11-17 as date))
               :           :        :        +- SubqueryAlias `date_dim`
               :           :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Join Inner
               :              :- Join Inner
               :              :  :- SubqueryAlias `catalog_returns`
               :              :  :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               :              :  +- SubqueryAlias `item`
               :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- SubqueryAlias `date_dim`
               :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `wr_items`
                  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#46284, sum(cast(wr_return_quantity#298 as bigint)) AS wr_item_qty#46285L]
                     +- Filter (((wr_item_sk#286 = i_item_sk#564) && d_date#494 IN (list#46287 [])) && (wr_returned_date_sk#284 = d_date_sk#492))
                        :  +- Project [d_date#494]
                        :     +- Filter d_week_seq#496 IN (list#46286 [])
                        :        :  +- Project [d_week_seq#496]
                        :        :     +- Filter d_date#494 IN (cast(2000-06-30 as date),cast(2000-09-27 as date),cast(2000-11-17 as date))
                        :        :        +- SubqueryAlias `date_dim`
                        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `web_returns`
                           :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                           :  +- SubqueryAlias `item`
                           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 7.117994879s
Running execution q84-v2.4 iteration: 1, StandardRun=true
19/09/08 20:48:08 INFO Query:
== Query: q84-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [customer_id#46373, customername#46374]
      +- Sort [c_customer_id#413 ASC NULLS FIRST], true
         +- Project [c_customer_id#413 AS customer_id#46373, ((cast(coalesce(c_last_name#421, ) as double) + cast(,  as double)) + cast(coalesce(c_first_name#420, ) as double)) AS customername#46374, c_customer_id#413]
            +- Filter ((((ca_city#454 = Edgewood) && (c_current_addr_sk#416 = ca_address_sk#448)) && ((ib_lower_bound#559 >= 38128) && (ib_upper_bound#560 <= (38128 + 50000)))) && (((ib_income_band_sk#558 = hd_income_band_sk#549) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && ((hd_demo_sk#548 = c_current_hdemo_sk#415) && (sr_cdemo_sk#180 = cd_demo_sk#474))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- SubqueryAlias `customer`
                  :  :  :  :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  :  :  :  +- SubqueryAlias `customer_address`
                  :  :  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  :  :  :  +- SubqueryAlias `customer_demographics`
                  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  +- SubqueryAlias `household_demographics`
                  :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                  :  +- SubqueryAlias `income_band`
                  :     +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                  +- SubqueryAlias `store_returns`
                     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet

     : benchmark
19/09/08 20:48:08 INFO Query:
== Query: q84-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [customer_id#46377, customername#46378]
      +- Sort [c_customer_id#413 ASC NULLS FIRST], true
         +- Project [c_customer_id#413 AS customer_id#46377, ((cast(coalesce(c_last_name#421, ) as double) + cast(,  as double)) + cast(coalesce(c_first_name#420, ) as double)) AS customername#46378, c_customer_id#413]
            +- Filter ((((ca_city#454 = Edgewood) && (c_current_addr_sk#416 = ca_address_sk#448)) && ((ib_lower_bound#559 >= 38128) && (ib_upper_bound#560 <= (38128 + 50000)))) && (((ib_income_band_sk#558 = hd_income_band_sk#549) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && ((hd_demo_sk#548 = c_current_hdemo_sk#415) && (sr_cdemo_sk#180 = cd_demo_sk#474))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- SubqueryAlias `customer`
                  :  :  :  :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  :  :  :  +- SubqueryAlias `customer_address`
                  :  :  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  :  :  :  +- SubqueryAlias `customer_demographics`
                  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  +- SubqueryAlias `household_demographics`
                  :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                  :  +- SubqueryAlias `income_band`
                  :     +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                  +- SubqueryAlias `store_returns`
                     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet

      running Thread[benchmark runner,5,main]
Execution time: 9.047903872000001s
Running execution q85-v2.4 iteration: 1, StandardRun=true
19/09/08 20:48:19 INFO Query:
== Query: q85-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [substring(r_reason_desc, 1, 20)#46441, avg(ws_quantity)#46442, avg(wr_refunded_cash)#46443, avg(wr_fee)#46444]
      +- Sort [substring(r_reason_desc, 1, 20)#46441 ASC NULLS FIRST, aggOrder#46446 ASC NULLS FIRST, avg(wr_refunded_cash)#46443 ASC NULLS FIRST, avg(wr_fee)#46444 ASC NULLS FIRST], true
         +- Aggregate [r_reason_desc#648], [substring(r_reason_desc#648, 1, 20) AS substring(r_reason_desc, 1, 20)#46441, avg(cast(ws_quantity#234 as bigint)) AS avg(ws_quantity)#46442, avg(wr_refunded_cash#304) AS avg(wr_refunded_cash)#46443, avg(wr_fee#302) AS avg(wr_fee)#46444, avg(cast(ws_quantity#234 as bigint)) AS aggOrder#46446]
            +- Filter (((((ws_web_page_sk#228 = wp_web_page_sk#770) && (ws_item_sk#219 = wr_item_sk#286)) && (ws_order_number#233L = wr_order_number#297L)) && (((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 2000)) && (cd_demo_sk#474 = wr_refunded_cdemo_sk#288))) && ((((cd_demo_sk#46429 = wr_returning_cdemo_sk#292) && (ca_address_sk#448 = wr_refunded_addr_sk#290)) && (r_reason_sk#646 = wr_reason_sk#296)) && (((((((cd_marital_status#476 = M) && (cd_marital_status#476 = cd_marital_status#46431)) && (cd_education_status#477 = Advanced Degree)) && ((cd_education_status#477 = cd_education_status#46432) && ((cast(ws_sales_price#237 as decimal(7,2)) >= cast(100.00 as decimal(7,2))) && (cast(ws_sales_price#237 as decimal(7,2)) <= cast(150.00 as decimal(7,2)))))) || ((((cd_marital_status#476 = S) && (cd_marital_status#476 = cd_marital_status#46431)) && (cd_education_status#477 = College)) && ((cd_education_status#477 = cd_education_status#46432) && ((cast(ws_sales_price#237 as decimal(7,2)) >= cast(50.00 as decimal(7,2))) && (cast(ws_sales_price#237 as decimal(7,2)) <= cast(100.00 as decimal(7,2))))))) || ((((cd_marital_status#476 = W) && (cd_marital_status#476 = cd_marital_status#46431)) && (cd_education_status#477 = 2 yr Degree)) && ((cd_education_status#477 = cd_education_status#46432) && ((cast(ws_sales_price#237 as decimal(7,2)) >= cast(150.00 as decimal(7,2))) && (cast(ws_sales_price#237 as decimal(7,2)) <= cast(200.00 as decimal(7,2))))))) && (((((ca_country#458 = United States) && ca_state#456 IN (IN,OH,NJ)) && ((cast(ws_net_profit#249 as decimal(7,2)) >= cast(cast(100 as decimal(3,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) <= cast(cast(200 as decimal(3,0)) as decimal(7,2))))) || (((ca_country#458 = United States) && ca_state#456 IN (WI,CT,KY)) && ((cast(ws_net_profit#249 as decimal(7,2)) >= cast(cast(150 as decimal(3,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) <= cast(cast(300 as decimal(3,0)) as decimal(7,2)))))) || (((ca_country#458 = United States) && ca_state#456 IN (LA,IA,AR)) && ((cast(ws_net_profit#249 as decimal(7,2)) >= cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) <= cast(cast(250 as decimal(3,0)) as decimal(7,2)))))))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias `web_sales`
                  :  :  :  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  :  :  :  :  +- SubqueryAlias `web_returns`
                  :  :  :  :  :  :     +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                  :  :  :  :  :  +- SubqueryAlias `web_page`
                  :  :  :  :  :     +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet
                  :  :  :  :  +- SubqueryAlias `cd1`
                  :  :  :  :     +- SubqueryAlias `customer_demographics`
                  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  :  +- SubqueryAlias `cd2`
                  :  :  :     +- SubqueryAlias `customer_demographics`
                  :  :  :        +- Relation[cd_demo_sk#46429,cd_gender#46430,cd_marital_status#46431,cd_education_status#46432,cd_purchase_estimate#46433,cd_credit_rating#46434,cd_dep_count#46435,cd_dep_employed_count#46436,cd_dep_college_count#46437] parquet
                  :  :  +- SubqueryAlias `customer_address`
                  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  :  +- SubqueryAlias `date_dim`
                  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `reason`
                     +- Relation[r_reason_sk#646,r_reason_id#647,r_reason_desc#648] parquet

     : benchmark
19/09/08 20:48:19 INFO Query:
== Query: q85-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [substring(r_reason_desc, 1, 20)#46468, avg(ws_quantity)#46469, avg(wr_refunded_cash)#46470, avg(wr_fee)#46471]
      +- Sort [substring(r_reason_desc, 1, 20)#46468 ASC NULLS FIRST, aggOrder#46473 ASC NULLS FIRST, avg(wr_refunded_cash)#46470 ASC NULLS FIRST, avg(wr_fee)#46471 ASC NULLS FIRST], true
         +- Aggregate [r_reason_desc#648], [substring(r_reason_desc#648, 1, 20) AS substring(r_reason_desc, 1, 20)#46468, avg(cast(ws_quantity#234 as bigint)) AS avg(ws_quantity)#46469, avg(wr_refunded_cash#304) AS avg(wr_refunded_cash)#46470, avg(wr_fee#302) AS avg(wr_fee)#46471, avg(cast(ws_quantity#234 as bigint)) AS aggOrder#46473]
            +- Filter (((((ws_web_page_sk#228 = wp_web_page_sk#770) && (ws_item_sk#219 = wr_item_sk#286)) && (ws_order_number#233L = wr_order_number#297L)) && (((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 2000)) && (cd_demo_sk#474 = wr_refunded_cdemo_sk#288))) && ((((cd_demo_sk#46456 = wr_returning_cdemo_sk#292) && (ca_address_sk#448 = wr_refunded_addr_sk#290)) && (r_reason_sk#646 = wr_reason_sk#296)) && (((((((cd_marital_status#476 = M) && (cd_marital_status#476 = cd_marital_status#46458)) && (cd_education_status#477 = Advanced Degree)) && ((cd_education_status#477 = cd_education_status#46459) && ((cast(ws_sales_price#237 as decimal(7,2)) >= cast(100.00 as decimal(7,2))) && (cast(ws_sales_price#237 as decimal(7,2)) <= cast(150.00 as decimal(7,2)))))) || ((((cd_marital_status#476 = S) && (cd_marital_status#476 = cd_marital_status#46458)) && (cd_education_status#477 = College)) && ((cd_education_status#477 = cd_education_status#46459) && ((cast(ws_sales_price#237 as decimal(7,2)) >= cast(50.00 as decimal(7,2))) && (cast(ws_sales_price#237 as decimal(7,2)) <= cast(100.00 as decimal(7,2))))))) || ((((cd_marital_status#476 = W) && (cd_marital_status#476 = cd_marital_status#46458)) && (cd_education_status#477 = 2 yr Degree)) && ((cd_education_status#477 = cd_education_status#46459) && ((cast(ws_sales_price#237 as decimal(7,2)) >= cast(150.00 as decimal(7,2))) && (cast(ws_sales_price#237 as decimal(7,2)) <= cast(200.00 as decimal(7,2))))))) && (((((ca_country#458 = United States) && ca_state#456 IN (IN,OH,NJ)) && ((cast(ws_net_profit#249 as decimal(7,2)) >= cast(cast(100 as decimal(3,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) <= cast(cast(200 as decimal(3,0)) as decimal(7,2))))) || (((ca_country#458 = United States) && ca_state#456 IN (WI,CT,KY)) && ((cast(ws_net_profit#249 as decimal(7,2)) >= cast(cast(150 as decimal(3,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) <= cast(cast(300 as decimal(3,0)) as decimal(7,2)))))) || (((ca_country#458 = United States) && ca_state#456 IN (LA,IA,AR)) && ((cast(ws_net_profit#249 as decimal(7,2)) >= cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) <= cast(cast(250 as decimal(3,0)) as decimal(7,2)))))))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias `web_sales`
                  :  :  :  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  :  :  :  :  +- SubqueryAlias `web_returns`
                  :  :  :  :  :  :     +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                  :  :  :  :  :  +- SubqueryAlias `web_page`
                  :  :  :  :  :     +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet
                  :  :  :  :  +- SubqueryAlias `cd1`
                  :  :  :  :     +- SubqueryAlias `customer_demographics`
                  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  :  +- SubqueryAlias `cd2`
                  :  :  :     +- SubqueryAlias `customer_demographics`
                  :  :  :        +- Relation[cd_demo_sk#46456,cd_gender#46457,cd_marital_status#46458,cd_education_status#46459,cd_purchase_estimate#46460,cd_credit_rating#46461,cd_dep_count#46462,cd_dep_employed_count#46463,cd_dep_college_count#46464] parquet
                  :  :  +- SubqueryAlias `customer_address`
                  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  :  +- SubqueryAlias `date_dim`
                  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `reason`
                     +- Relation[r_reason_sk#646,r_reason_id#647,r_reason_desc#648] parquet

      running Thread[benchmark runner,5,main]
Execution time: 38.842938280000006s
Running execution q86-v2.4 iteration: 1, StandardRun=true
19/09/08 20:49:00 INFO Query:
== Query: q86-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#46594 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#46594 as int) = 0) THEN i_category#46603 END ASC NULLS FIRST, rank_within_parent#46595 ASC NULLS FIRST], true
      +- Project [total_sum#46593, i_category#46603, i_class#46604, lochierarchy#46594, rank_within_parent#46595]
         +- Project [total_sum#46593, i_category#46603, i_class#46604, lochierarchy#46594, _w0#46613, _w1#46617, _w2#46618, _w3#46619, rank_within_parent#46595, rank_within_parent#46595]
            +- Window [rank(_w3#46619) windowspecdefinition(_w1#46617, _w2#46618, _w3#46619 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#46595], [_w1#46617, _w2#46618], [_w3#46619 DESC NULLS LAST]
               +- Aggregate [i_category#46603, i_class#46604, spark_grouping_id#46600], [sum(ws_net_paid#245) AS total_sum#46593, i_category#46603, i_class#46604, (cast((shiftright(spark_grouping_id#46600, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#46600, 0) & 1) as tinyint)) AS lochierarchy#46594, sum(ws_net_paid#245) AS _w0#46613, (cast((shiftright(spark_grouping_id#46600, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#46600, 0) & 1) as tinyint)) AS _w1#46617, CASE WHEN (cast(cast((shiftright(spark_grouping_id#46600, 0) & 1) as tinyint) as int) = 0) THEN i_category#46603 END AS _w2#46618, sum(ws_net_paid#245) AS _w3#46619]
                  +- Expand [List(ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ws_ext_wholesale_cost#240, ws_ext_list_price#241, ws_ext_tax#242, ws_coupon_amt#243, ws_ext_ship_cost#244, ws_net_paid#245, ws_net_paid_inc_tax#246, ws_net_paid_inc_ship#247, ws_net_paid_inc_ship_tax#248, ws_net_profit#249, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#46601, i_class#46602, 0), List(ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ws_ext_wholesale_cost#240, ws_ext_list_price#241, ws_ext_tax#242, ws_coupon_amt#243, ws_ext_ship_cost#244, ws_net_paid#245, ws_net_paid_inc_tax#246, ws_net_paid_inc_ship#247, ws_net_paid_inc_ship_tax#248, ws_net_profit#249, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#46601, null, 1), List(ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ws_ext_wholesale_cost#240, ws_ext_list_price#241, ws_ext_tax#242, ws_coupon_amt#243, ws_ext_ship_cost#244, ws_net_paid#245, ws_net_paid_inc_tax#246, ws_net_paid_inc_ship#247, ws_net_paid_inc_ship_tax#248, ws_net_profit#249, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, 3)], [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 63 more fields]
                     +- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 62 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ws_sold_date_sk#216)) && (i_item_sk#564 = ws_item_sk#219))
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `web_sales`
                              :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/09/08 20:49:00 INFO Query:
== Query: q86-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#46635 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#46635 as int) = 0) THEN i_category#46644 END ASC NULLS FIRST, rank_within_parent#46636 ASC NULLS FIRST], true
      +- Project [total_sum#46634, i_category#46644, i_class#46645, lochierarchy#46635, rank_within_parent#46636]
         +- Project [total_sum#46634, i_category#46644, i_class#46645, lochierarchy#46635, _w0#46654, _w1#46658, _w2#46659, _w3#46660, rank_within_parent#46636, rank_within_parent#46636]
            +- Window [rank(_w3#46660) windowspecdefinition(_w1#46658, _w2#46659, _w3#46660 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#46636], [_w1#46658, _w2#46659], [_w3#46660 DESC NULLS LAST]
               +- Aggregate [i_category#46644, i_class#46645, spark_grouping_id#46641], [sum(ws_net_paid#245) AS total_sum#46634, i_category#46644, i_class#46645, (cast((shiftright(spark_grouping_id#46641, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#46641, 0) & 1) as tinyint)) AS lochierarchy#46635, sum(ws_net_paid#245) AS _w0#46654, (cast((shiftright(spark_grouping_id#46641, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#46641, 0) & 1) as tinyint)) AS _w1#46658, CASE WHEN (cast(cast((shiftright(spark_grouping_id#46641, 0) & 1) as tinyint) as int) = 0) THEN i_category#46644 END AS _w2#46659, sum(ws_net_paid#245) AS _w3#46660]
                  +- Expand [List(ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ws_ext_wholesale_cost#240, ws_ext_list_price#241, ws_ext_tax#242, ws_coupon_amt#243, ws_ext_ship_cost#244, ws_net_paid#245, ws_net_paid_inc_tax#246, ws_net_paid_inc_ship#247, ws_net_paid_inc_ship_tax#248, ws_net_profit#249, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#46642, i_class#46643, 0), List(ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ws_ext_wholesale_cost#240, ws_ext_list_price#241, ws_ext_tax#242, ws_coupon_amt#243, ws_ext_ship_cost#244, ws_net_paid#245, ws_net_paid_inc_tax#246, ws_net_paid_inc_ship#247, ws_net_paid_inc_ship_tax#248, ws_net_profit#249, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#46642, null, 1), List(ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ws_ext_wholesale_cost#240, ws_ext_list_price#241, ws_ext_tax#242, ws_coupon_amt#243, ws_ext_ship_cost#244, ws_net_paid#245, ws_net_paid_inc_tax#246, ws_net_paid_inc_ship#247, ws_net_paid_inc_ship_tax#248, ws_net_profit#249, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, 3)], [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 63 more fields]
                     +- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 62 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ws_sold_date_sk#216)) && (i_item_sk#564 = ws_item_sk#219))
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `web_sales`
                              :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 6.456901987999999s
Running execution q87-v2.4 iteration: 1, StandardRun=true
19/09/08 20:49:08 INFO Query:
== Query: q87-v2.4 ==
Aggregate [count(1) AS count(1)#47022L]
+- SubqueryAlias `cool_cust`
   +- Except false
      :- Project [c_last_name#421, c_first_name#420, d_date#494]
      :  +- Except false
      :     :- Project [c_last_name#421, c_first_name#420, d_date#494]
      :     :  +- Distinct
      :     :     +- Project [c_last_name#421, c_first_name#420, d_date#494]
      :     :        +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_customer_sk#133 = c_customer_sk#412)) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
      :     :           +- Join Inner
      :     :              :- Join Inner
      :     :              :  :- SubqueryAlias `store_sales`
      :     :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
      :     :              :  +- SubqueryAlias `date_dim`
      :     :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
      :     :              +- SubqueryAlias `customer`
      :     :                 +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
      :     +- Project [c_last_name#46949, c_first_name#46948, d_date#46895]
      :        +- Distinct
      :           +- Project [c_last_name#46949, c_first_name#46948, d_date#46895]
      :              +- Filter (((cs_sold_date_sk#0 = d_date_sk#46893) && (cs_bill_customer_sk#3 = c_customer_sk#46940)) && ((d_month_seq#46896 >= 1200) && (d_month_seq#46896 <= (1200 + 11))))
      :                 +- Join Inner
      :                    :- Join Inner
      :                    :  :- SubqueryAlias `catalog_sales`
      :                    :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
      :                    :  +- SubqueryAlias `date_dim`
      :                    :     +- Relation[d_date_sk#46893,d_date_id#46894,d_date#46895,d_month_seq#46896,d_week_seq#46897,d_quarter_seq#46898,d_year#46899,d_dow#46900,d_moy#46901,d_dom#46902,d_qoy#46903,d_fy_year#46904,d_fy_quarter_seq#46905,d_fy_week_seq#46906,d_day_name#46907,d_quarter_name#46908,d_holiday#46909,d_weekend#46910,d_following_holiday#46911,d_first_dom#46912,d_last_dom#46913,d_same_day_ly#46914,d_same_day_lq#46915,d_current_day#46916,... 4 more fields] parquet
      :                    +- SubqueryAlias `customer`
      :                       +- Relation[c_customer_sk#46940,c_customer_id#46941,c_current_cdemo_sk#46942,c_current_hdemo_sk#46943,c_current_addr_sk#46944,c_first_shipto_date_sk#46945,c_first_sales_date_sk#46946,c_salutation#46947,c_first_name#46948,c_last_name#46949,c_preferred_cust_flag#46950,c_birth_day#46951,c_birth_month#46952,c_birth_year#46953,c_birth_country#46954,c_login#46955,c_email_address#46956,c_last_review_date#46957] parquet
      +- Project [c_last_name#47013, c_first_name#47012, d_date#46960]
         +- Distinct
            +- Project [c_last_name#47013, c_first_name#47012, d_date#46960]
               +- Filter (((ws_sold_date_sk#216 = d_date_sk#46958) && (ws_bill_customer_sk#220 = c_customer_sk#47004)) && ((d_month_seq#46961 >= 1200) && (d_month_seq#46961 <= (1200 + 11))))
                  +- Join Inner
                     :- Join Inner
                     :  :- SubqueryAlias `web_sales`
                     :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :  +- SubqueryAlias `date_dim`
                     :     +- Relation[d_date_sk#46958,d_date_id#46959,d_date#46960,d_month_seq#46961,d_week_seq#46962,d_quarter_seq#46963,d_year#46964,d_dow#46965,d_moy#46966,d_dom#46967,d_qoy#46968,d_fy_year#46969,d_fy_quarter_seq#46970,d_fy_week_seq#46971,d_day_name#46972,d_quarter_name#46973,d_holiday#46974,d_weekend#46975,d_following_holiday#46976,d_first_dom#46977,d_last_dom#46978,d_same_day_ly#46979,d_same_day_lq#46980,d_current_day#46981,... 4 more fields] parquet
                     +- SubqueryAlias `customer`
                        +- Relation[c_customer_sk#47004,c_customer_id#47005,c_current_cdemo_sk#47006,c_current_hdemo_sk#47007,c_current_addr_sk#47008,c_first_shipto_date_sk#47009,c_first_sales_date_sk#47010,c_salutation#47011,c_first_name#47012,c_last_name#47013,c_preferred_cust_flag#47014,c_birth_day#47015,c_birth_month#47016,c_birth_year#47017,c_birth_country#47018,c_login#47019,c_email_address#47020,c_last_review_date#47021] parquet

     : benchmark
19/09/08 20:49:08 INFO Query:
== Query: q87-v2.4 ==
Aggregate [count(1) AS count(1)#47153L]
+- SubqueryAlias `cool_cust`
   +- Except false
      :- Project [c_last_name#421, c_first_name#420, d_date#494]
      :  +- Except false
      :     :- Project [c_last_name#421, c_first_name#420, d_date#494]
      :     :  +- Distinct
      :     :     +- Project [c_last_name#421, c_first_name#420, d_date#494]
      :     :        +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_customer_sk#133 = c_customer_sk#412)) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
      :     :           +- Join Inner
      :     :              :- Join Inner
      :     :              :  :- SubqueryAlias `store_sales`
      :     :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
      :     :              :  +- SubqueryAlias `date_dim`
      :     :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
      :     :              +- SubqueryAlias `customer`
      :     :                 +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
      :     +- Project [c_last_name#47080, c_first_name#47079, d_date#47026]
      :        +- Distinct
      :           +- Project [c_last_name#47080, c_first_name#47079, d_date#47026]
      :              +- Filter (((cs_sold_date_sk#0 = d_date_sk#47024) && (cs_bill_customer_sk#3 = c_customer_sk#47071)) && ((d_month_seq#47027 >= 1200) && (d_month_seq#47027 <= (1200 + 11))))
      :                 +- Join Inner
      :                    :- Join Inner
      :                    :  :- SubqueryAlias `catalog_sales`
      :                    :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
      :                    :  +- SubqueryAlias `date_dim`
      :                    :     +- Relation[d_date_sk#47024,d_date_id#47025,d_date#47026,d_month_seq#47027,d_week_seq#47028,d_quarter_seq#47029,d_year#47030,d_dow#47031,d_moy#47032,d_dom#47033,d_qoy#47034,d_fy_year#47035,d_fy_quarter_seq#47036,d_fy_week_seq#47037,d_day_name#47038,d_quarter_name#47039,d_holiday#47040,d_weekend#47041,d_following_holiday#47042,d_first_dom#47043,d_last_dom#47044,d_same_day_ly#47045,d_same_day_lq#47046,d_current_day#47047,... 4 more fields] parquet
      :                    +- SubqueryAlias `customer`
      :                       +- Relation[c_customer_sk#47071,c_customer_id#47072,c_current_cdemo_sk#47073,c_current_hdemo_sk#47074,c_current_addr_sk#47075,c_first_shipto_date_sk#47076,c_first_sales_date_sk#47077,c_salutation#47078,c_first_name#47079,c_last_name#47080,c_preferred_cust_flag#47081,c_birth_day#47082,c_birth_month#47083,c_birth_year#47084,c_birth_country#47085,c_login#47086,c_email_address#47087,c_last_review_date#47088] parquet
      +- Project [c_last_name#47144, c_first_name#47143, d_date#47091]
         +- Distinct
            +- Project [c_last_name#47144, c_first_name#47143, d_date#47091]
               +- Filter (((ws_sold_date_sk#216 = d_date_sk#47089) && (ws_bill_customer_sk#220 = c_customer_sk#47135)) && ((d_month_seq#47092 >= 1200) && (d_month_seq#47092 <= (1200 + 11))))
                  +- Join Inner
                     :- Join Inner
                     :  :- SubqueryAlias `web_sales`
                     :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :  +- SubqueryAlias `date_dim`
                     :     +- Relation[d_date_sk#47089,d_date_id#47090,d_date#47091,d_month_seq#47092,d_week_seq#47093,d_quarter_seq#47094,d_year#47095,d_dow#47096,d_moy#47097,d_dom#47098,d_qoy#47099,d_fy_year#47100,d_fy_quarter_seq#47101,d_fy_week_seq#47102,d_day_name#47103,d_quarter_name#47104,d_holiday#47105,d_weekend#47106,d_following_holiday#47107,d_first_dom#47108,d_last_dom#47109,d_same_day_ly#47110,d_same_day_lq#47111,d_current_day#47112,... 4 more fields] parquet
                     +- SubqueryAlias `customer`
                        +- Relation[c_customer_sk#47135,c_customer_id#47136,c_current_cdemo_sk#47137,c_current_hdemo_sk#47138,c_current_addr_sk#47139,c_first_shipto_date_sk#47140,c_first_sales_date_sk#47141,c_salutation#47142,c_first_name#47143,c_last_name#47144,c_preferred_cust_flag#47145,c_birth_day#47146,c_birth_month#47147,c_birth_year#47148,c_birth_country#47149,c_login#47150,c_email_address#47151,c_last_review_date#47152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 34.824497576s
Running execution q88-v2.4 iteration: 1, StandardRun=true
19/09/08 20:49:45 INFO Query:
== Query: q88-v2.4 ==
Project [h8_30_to_9#47460L, h9_to_9_30#47461L, h9_30_to_10#47462L, h10_to_10_30#47463L, h10_30_to_11#47464L, h11_to_11_30#47465L, h11_30_to_12#47466L, h12_to_12_30#47467L]
+- Join Cross
   :- Join Cross
   :  :- Join Cross
   :  :  :- Join Cross
   :  :  :  :- Join Cross
   :  :  :  :  :- Join Cross
   :  :  :  :  :  :- Join Cross
   :  :  :  :  :  :  :- SubqueryAlias `s1`
   :  :  :  :  :  :  :  +- Aggregate [count(1) AS h8_30_to_9#47460L]
   :  :  :  :  :  :  :     +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 8))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :  :  :  :        +- Join Inner
   :  :  :  :  :  :  :           :- Join Inner
   :  :  :  :  :  :  :           :  :- Join Inner
   :  :  :  :  :  :  :           :  :  :- SubqueryAlias `store_sales`
   :  :  :  :  :  :  :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :  :  :  :           :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :  :  :  :           :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :  :  :  :           :  +- SubqueryAlias `time_dim`
   :  :  :  :  :  :  :           :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :  :  :  :           +- SubqueryAlias `store`
   :  :  :  :  :  :  :              +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  :  :  :  +- SubqueryAlias `s2`
   :  :  :  :  :  :     +- Aggregate [count(1) AS h9_to_9_30#47461L]
   :  :  :  :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 9))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :  :  :           +- Join Inner
   :  :  :  :  :  :              :- Join Inner
   :  :  :  :  :  :              :  :- Join Inner
   :  :  :  :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :  :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :  :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :  :  :              +- SubqueryAlias `store`
   :  :  :  :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  :  :  +- SubqueryAlias `s3`
   :  :  :  :  :     +- Aggregate [count(1) AS h9_30_to_10#47462L]
   :  :  :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 9))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :  :           +- Join Inner
   :  :  :  :  :              :- Join Inner
   :  :  :  :  :              :  :- Join Inner
   :  :  :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :  :              +- SubqueryAlias `store`
   :  :  :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  :  +- SubqueryAlias `s4`
   :  :  :  :     +- Aggregate [count(1) AS h10_to_10_30#47463L]
   :  :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 10))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :           +- Join Inner
   :  :  :  :              :- Join Inner
   :  :  :  :              :  :- Join Inner
   :  :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :              +- SubqueryAlias `store`
   :  :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  +- SubqueryAlias `s5`
   :  :  :     +- Aggregate [count(1) AS h10_30_to_11#47464L]
   :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 10))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :           +- Join Inner
   :  :  :              :- Join Inner
   :  :  :              :  :- Join Inner
   :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :              +- SubqueryAlias `store`
   :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  +- SubqueryAlias `s6`
   :  :     +- Aggregate [count(1) AS h11_to_11_30#47465L]
   :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 11))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :           +- Join Inner
   :  :              :- Join Inner
   :  :              :  :- Join Inner
   :  :              :  :  :- SubqueryAlias `store_sales`
   :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :              :  +- SubqueryAlias `time_dim`
   :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :              +- SubqueryAlias `store`
   :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  +- SubqueryAlias `s7`
   :     +- Aggregate [count(1) AS h11_30_to_12#47466L]
   :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 11))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :           +- Join Inner
   :              :- Join Inner
   :              :  :- Join Inner
   :              :  :  :- SubqueryAlias `store_sales`
   :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :              :  :  +- SubqueryAlias `household_demographics`
   :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :              :  +- SubqueryAlias `time_dim`
   :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :              +- SubqueryAlias `store`
   :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   +- SubqueryAlias `s8`
      +- Aggregate [count(1) AS h12_to_12_30#47467L]
         +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 12))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `store_sales`
               :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  +- SubqueryAlias `household_demographics`
               :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  +- SubqueryAlias `time_dim`
               :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
               +- SubqueryAlias `store`
                  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/09/08 20:49:45 INFO Query:
== Query: q88-v2.4 ==
Project [h8_30_to_9#47484L, h9_to_9_30#47485L, h9_30_to_10#47486L, h10_to_10_30#47487L, h10_30_to_11#47488L, h11_to_11_30#47489L, h11_30_to_12#47490L, h12_to_12_30#47491L]
+- Join Cross
   :- Join Cross
   :  :- Join Cross
   :  :  :- Join Cross
   :  :  :  :- Join Cross
   :  :  :  :  :- Join Cross
   :  :  :  :  :  :- Join Cross
   :  :  :  :  :  :  :- SubqueryAlias `s1`
   :  :  :  :  :  :  :  +- Aggregate [count(1) AS h8_30_to_9#47484L]
   :  :  :  :  :  :  :     +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 8))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :  :  :  :        +- Join Inner
   :  :  :  :  :  :  :           :- Join Inner
   :  :  :  :  :  :  :           :  :- Join Inner
   :  :  :  :  :  :  :           :  :  :- SubqueryAlias `store_sales`
   :  :  :  :  :  :  :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :  :  :  :           :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :  :  :  :           :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :  :  :  :           :  +- SubqueryAlias `time_dim`
   :  :  :  :  :  :  :           :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :  :  :  :           +- SubqueryAlias `store`
   :  :  :  :  :  :  :              +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  :  :  :  +- SubqueryAlias `s2`
   :  :  :  :  :  :     +- Aggregate [count(1) AS h9_to_9_30#47485L]
   :  :  :  :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 9))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :  :  :           +- Join Inner
   :  :  :  :  :  :              :- Join Inner
   :  :  :  :  :  :              :  :- Join Inner
   :  :  :  :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :  :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :  :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :  :  :              +- SubqueryAlias `store`
   :  :  :  :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  :  :  +- SubqueryAlias `s3`
   :  :  :  :  :     +- Aggregate [count(1) AS h9_30_to_10#47486L]
   :  :  :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 9))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :  :           +- Join Inner
   :  :  :  :  :              :- Join Inner
   :  :  :  :  :              :  :- Join Inner
   :  :  :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :  :              +- SubqueryAlias `store`
   :  :  :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  :  +- SubqueryAlias `s4`
   :  :  :  :     +- Aggregate [count(1) AS h10_to_10_30#47487L]
   :  :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 10))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :           +- Join Inner
   :  :  :  :              :- Join Inner
   :  :  :  :              :  :- Join Inner
   :  :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :              +- SubqueryAlias `store`
   :  :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  +- SubqueryAlias `s5`
   :  :  :     +- Aggregate [count(1) AS h10_30_to_11#47488L]
   :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 10))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :           +- Join Inner
   :  :  :              :- Join Inner
   :  :  :              :  :- Join Inner
   :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :              +- SubqueryAlias `store`
   :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  +- SubqueryAlias `s6`
   :  :     +- Aggregate [count(1) AS h11_to_11_30#47489L]
   :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 11))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :           +- Join Inner
   :  :              :- Join Inner
   :  :              :  :- Join Inner
   :  :              :  :  :- SubqueryAlias `store_sales`
   :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :              :  +- SubqueryAlias `time_dim`
   :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :              +- SubqueryAlias `store`
   :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  +- SubqueryAlias `s7`
   :     +- Aggregate [count(1) AS h11_30_to_12#47490L]
   :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 11))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :           +- Join Inner
   :              :- Join Inner
   :              :  :- Join Inner
   :              :  :  :- SubqueryAlias `store_sales`
   :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :              :  :  +- SubqueryAlias `household_demographics`
   :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :              :  +- SubqueryAlias `time_dim`
   :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :              +- SubqueryAlias `store`
   :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   +- SubqueryAlias `s8`
      +- Aggregate [count(1) AS h12_to_12_30#47491L]
         +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 12))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `store_sales`
               :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  +- SubqueryAlias `household_demographics`
               :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  +- SubqueryAlias `time_dim`
               :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
               +- SubqueryAlias `store`
                  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 43.210822316s
Running execution q89-v2.4 iteration: 1, StandardRun=true
19/09/08 20:50:31 INFO Query:
== Query: q89-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#47589 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#47590 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
      +- Project [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum_sales#47589, avg_monthly_sales#47590]
         +- Filter (cast(CASE WHEN NOT (cast(avg_monthly_sales#47590 as decimal(21,6)) = cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#47589 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#47590 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#47590 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16)))
            +- SubqueryAlias `tmp1`
               +- Project [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum_sales#47589, avg_monthly_sales#47590]
                  +- Project [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum_sales#47589, _w0#47594, avg_monthly_sales#47590, avg_monthly_sales#47590]
                     +- Window [avg(_w0#47594) windowspecdefinition(i_category#576, i_brand#572, s_store_name#669, s_company_name#681, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#47590], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681]
                        +- Aggregate [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500], [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum(ss_sales_price#143) AS sum_sales#47589, sum(ss_sales_price#143) AS _w0#47594]
                           +- Filter ((((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_store_sk#137 = s_store_sk#664)) && (d_year#498 IN (1999) && ((i_category#576 IN (Books,Electronics,Sports) && i_class#574 IN (computers,stereo,football)) || (i_category#576 IN (Men,Jewelry,Women) && i_class#574 IN (shirts,birdal,dresses)))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `item`
                                 :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :  :  +- SubqueryAlias `store_sales`
                                 :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `date_dim`
                                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- SubqueryAlias `store`
                                    +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/09/08 20:50:31 INFO Query:
== Query: q89-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#47603 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#47604 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
      +- Project [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum_sales#47603, avg_monthly_sales#47604]
         +- Filter (cast(CASE WHEN NOT (cast(avg_monthly_sales#47604 as decimal(21,6)) = cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#47603 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#47604 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#47604 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16)))
            +- SubqueryAlias `tmp1`
               +- Project [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum_sales#47603, avg_monthly_sales#47604]
                  +- Project [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum_sales#47603, _w0#47608, avg_monthly_sales#47604, avg_monthly_sales#47604]
                     +- Window [avg(_w0#47608) windowspecdefinition(i_category#576, i_brand#572, s_store_name#669, s_company_name#681, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#47604], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681]
                        +- Aggregate [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500], [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum(ss_sales_price#143) AS sum_sales#47603, sum(ss_sales_price#143) AS _w0#47608]
                           +- Filter ((((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_store_sk#137 = s_store_sk#664)) && (d_year#498 IN (1999) && ((i_category#576 IN (Books,Electronics,Sports) && i_class#574 IN (computers,stereo,football)) || (i_category#576 IN (Men,Jewelry,Women) && i_class#574 IN (shirts,birdal,dresses)))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `item`
                                 :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :  :  +- SubqueryAlias `store_sales`
                                 :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `date_dim`
                                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- SubqueryAlias `store`
                                    +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 12.734765627s
Running execution q90-v2.4 iteration: 1, StandardRun=true
19/09/08 20:50:45 INFO Query:
== Query: q90-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [am_pm_ratio#47660 ASC NULLS FIRST], true
      +- Project [CheckOverflow((promote_precision(cast(cast(amc#47658L as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(pmc#47659L as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS am_pm_ratio#47660]
         +- Join Cross
            :- SubqueryAlias `at`
            :  +- Aggregate [count(1) AS amc#47658L]
            :     +- Filter ((((ws_sold_time_sk#217 = t_time_sk#722) && (ws_ship_hdemo_sk#226 = hd_demo_sk#548)) && (ws_web_page_sk#228 = wp_web_page_sk#770)) && ((((t_hour#725 >= 8) && (t_hour#725 <= (8 + 1))) && (hd_dep_count#551 = 6)) && ((wp_char_count#780 >= 5000) && (wp_char_count#780 <= 5200))))
            :        +- Join Inner
            :           :- Join Inner
            :           :  :- Join Inner
            :           :  :  :- SubqueryAlias `web_sales`
            :           :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :           :  :  +- SubqueryAlias `household_demographics`
            :           :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
            :           :  +- SubqueryAlias `time_dim`
            :           :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
            :           +- SubqueryAlias `web_page`
            :              +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet
            +- SubqueryAlias `pt`
               +- Aggregate [count(1) AS pmc#47659L]
                  +- Filter ((((ws_sold_time_sk#217 = t_time_sk#722) && (ws_ship_hdemo_sk#226 = hd_demo_sk#548)) && (ws_web_page_sk#228 = wp_web_page_sk#770)) && ((((t_hour#725 >= 19) && (t_hour#725 <= (19 + 1))) && (hd_dep_count#551 = 6)) && ((wp_char_count#780 >= 5000) && (wp_char_count#780 <= 5200))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- SubqueryAlias `web_sales`
                        :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  :  +- SubqueryAlias `household_demographics`
                        :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  +- SubqueryAlias `time_dim`
                        :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                        +- SubqueryAlias `web_page`
                           +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet

     : benchmark
19/09/08 20:50:45 INFO Query:
== Query: q90-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [am_pm_ratio#47666 ASC NULLS FIRST], true
      +- Project [CheckOverflow((promote_precision(cast(cast(amc#47664L as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(pmc#47665L as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS am_pm_ratio#47666]
         +- Join Cross
            :- SubqueryAlias `at`
            :  +- Aggregate [count(1) AS amc#47664L]
            :     +- Filter ((((ws_sold_time_sk#217 = t_time_sk#722) && (ws_ship_hdemo_sk#226 = hd_demo_sk#548)) && (ws_web_page_sk#228 = wp_web_page_sk#770)) && ((((t_hour#725 >= 8) && (t_hour#725 <= (8 + 1))) && (hd_dep_count#551 = 6)) && ((wp_char_count#780 >= 5000) && (wp_char_count#780 <= 5200))))
            :        +- Join Inner
            :           :- Join Inner
            :           :  :- Join Inner
            :           :  :  :- SubqueryAlias `web_sales`
            :           :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :           :  :  +- SubqueryAlias `household_demographics`
            :           :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
            :           :  +- SubqueryAlias `time_dim`
            :           :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
            :           +- SubqueryAlias `web_page`
            :              +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet
            +- SubqueryAlias `pt`
               +- Aggregate [count(1) AS pmc#47665L]
                  +- Filter ((((ws_sold_time_sk#217 = t_time_sk#722) && (ws_ship_hdemo_sk#226 = hd_demo_sk#548)) && (ws_web_page_sk#228 = wp_web_page_sk#770)) && ((((t_hour#725 >= 19) && (t_hour#725 <= (19 + 1))) && (hd_dep_count#551 = 6)) && ((wp_char_count#780 >= 5000) && (wp_char_count#780 <= 5200))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- SubqueryAlias `web_sales`
                        :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  :  +- SubqueryAlias `household_demographics`
                        :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  +- SubqueryAlias `time_dim`
                        :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                        +- SubqueryAlias `web_page`
                           +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet

      running Thread[benchmark runner,5,main]
Execution time: 4.897564604s
Running execution q91-v2.4 iteration: 1, StandardRun=true
19/09/08 20:50:51 INFO Query:
== Query: q91-v2.4 ==
Project [Call_Center#47700, Call_Center_Name#47701, Manager#47702, Returns_Loss#47703]
+- Sort [Returns_Loss#47703 DESC NULLS LAST], true
   +- Aggregate [cc_call_center_id#333, cc_name#338, cc_manager#343, cd_marital_status#476, cd_education_status#477], [cc_call_center_id#333 AS Call_Center#47700, cc_name#338 AS Call_Center_Name#47701, cc_manager#343 AS Manager#47702, sum(cr_net_loss#94) AS Returns_Loss#47703]
      +- Filter (((((cr_call_center_sk#79 = cc_call_center_sk#332) && (cr_returned_date_sk#68 = d_date_sk#492)) && (cr_returning_customer_sk#75 = c_customer_sk#412)) && (((cd_demo_sk#474 = c_current_cdemo_sk#414) && (hd_demo_sk#548 = c_current_hdemo_sk#415)) && (ca_address_sk#448 = c_current_addr_sk#416))) && ((((d_year#498 = 1998) && (d_moy#500 = 11)) && (((cd_marital_status#476 = M) && (cd_education_status#477 = Unknown)) || ((cd_marital_status#476 = W) && (cd_education_status#477 = Advanced Degree)))) && (hd_buy_potential#550 LIKE Unknown% && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-7 as decimal(1,0)) as decimal(5,2))))))
         +- Join Inner
            :- Join Inner
            :  :- Join Inner
            :  :  :- Join Inner
            :  :  :  :- Join Inner
            :  :  :  :  :- Join Inner
            :  :  :  :  :  :- SubqueryAlias `call_center`
            :  :  :  :  :  :  +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet
            :  :  :  :  :  +- SubqueryAlias `catalog_returns`
            :  :  :  :  :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
            :  :  :  :  +- SubqueryAlias `date_dim`
            :  :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  :  :  +- SubqueryAlias `customer`
            :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :  :  +- SubqueryAlias `customer_address`
            :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            :  +- SubqueryAlias `customer_demographics`
            :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
            +- SubqueryAlias `household_demographics`
               +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet

     : benchmark
19/09/08 20:50:51 INFO Query:
== Query: q91-v2.4 ==
Project [Call_Center#47711, Call_Center_Name#47712, Manager#47713, Returns_Loss#47714]
+- Sort [Returns_Loss#47714 DESC NULLS LAST], true
   +- Aggregate [cc_call_center_id#333, cc_name#338, cc_manager#343, cd_marital_status#476, cd_education_status#477], [cc_call_center_id#333 AS Call_Center#47711, cc_name#338 AS Call_Center_Name#47712, cc_manager#343 AS Manager#47713, sum(cr_net_loss#94) AS Returns_Loss#47714]
      +- Filter (((((cr_call_center_sk#79 = cc_call_center_sk#332) && (cr_returned_date_sk#68 = d_date_sk#492)) && (cr_returning_customer_sk#75 = c_customer_sk#412)) && (((cd_demo_sk#474 = c_current_cdemo_sk#414) && (hd_demo_sk#548 = c_current_hdemo_sk#415)) && (ca_address_sk#448 = c_current_addr_sk#416))) && ((((d_year#498 = 1998) && (d_moy#500 = 11)) && (((cd_marital_status#476 = M) && (cd_education_status#477 = Unknown)) || ((cd_marital_status#476 = W) && (cd_education_status#477 = Advanced Degree)))) && (hd_buy_potential#550 LIKE Unknown% && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-7 as decimal(1,0)) as decimal(5,2))))))
         +- Join Inner
            :- Join Inner
            :  :- Join Inner
            :  :  :- Join Inner
            :  :  :  :- Join Inner
            :  :  :  :  :- Join Inner
            :  :  :  :  :  :- SubqueryAlias `call_center`
            :  :  :  :  :  :  +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet
            :  :  :  :  :  +- SubqueryAlias `catalog_returns`
            :  :  :  :  :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
            :  :  :  :  +- SubqueryAlias `date_dim`
            :  :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  :  :  +- SubqueryAlias `customer`
            :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :  :  +- SubqueryAlias `customer_address`
            :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            :  +- SubqueryAlias `customer_demographics`
            :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
            +- SubqueryAlias `household_demographics`
               +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet

      running Thread[benchmark runner,5,main]
Execution time: 6.420881388s
Running execution q92-v2.4 iteration: 1, StandardRun=true
19/09/08 20:50:59 INFO Query:
== Query: q92-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [Excess Discount Amount#47762]
      +- Sort [Excess Discount Amount#47762 ASC NULLS FIRST], true
         +- Aggregate [sum(ws_ext_discount_amt#238) AS Excess Discount Amount#47762]
            +- Filter ((((i_manufact_id#577 = 350) && (i_item_sk#564 = ws_item_sk#219)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && ((d_date_sk#492 = ws_sold_date_sk#216) && (cast(ws_ext_discount_amt#238 as decimal(14,7)) > cast(scalar-subquery#47763 [i_item_sk#564] as decimal(14,7)))))
               :  +- Aggregate [CheckOverflow((promote_precision(cast(1.3 as decimal(11,6))) * promote_precision(cast(avg(ws_ext_discount_amt#238) as decimal(11,6)))), DecimalType(14,7)) AS (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(ws_ext_discount_amt) AS DECIMAL(11,6)))#47765]
               :     +- Filter (((ws_item_sk#219 = outer(i_item_sk#564)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && (d_date_sk#492 = ws_sold_date_sk#216))
               :        +- Join Inner
               :           :- SubqueryAlias `web_sales`
               :           :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :           +- SubqueryAlias `date_dim`
               :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- SubqueryAlias `web_sales`
                  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 20:50:59 INFO Query:
== Query: q92-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [Excess Discount Amount#47770]
      +- Sort [Excess Discount Amount#47770 ASC NULLS FIRST], true
         +- Aggregate [sum(ws_ext_discount_amt#238) AS Excess Discount Amount#47770]
            +- Filter ((((i_manufact_id#577 = 350) && (i_item_sk#564 = ws_item_sk#219)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && ((d_date_sk#492 = ws_sold_date_sk#216) && (cast(ws_ext_discount_amt#238 as decimal(14,7)) > cast(scalar-subquery#47771 [i_item_sk#564] as decimal(14,7)))))
               :  +- Aggregate [CheckOverflow((promote_precision(cast(1.3 as decimal(11,6))) * promote_precision(cast(avg(ws_ext_discount_amt#238) as decimal(11,6)))), DecimalType(14,7)) AS (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(ws_ext_discount_amt) AS DECIMAL(11,6)))#47773]
               :     +- Filter (((ws_item_sk#219 = outer(i_item_sk#564)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && (d_date_sk#492 = ws_sold_date_sk#216))
               :        +- Join Inner
               :           :- SubqueryAlias `web_sales`
               :           :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :           +- SubqueryAlias `date_dim`
               :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- SubqueryAlias `web_sales`
                  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 7.124258986s
Running execution q93-v2.4 iteration: 1, StandardRun=true
19/09/08 20:51:07 INFO Query:
== Query: q93-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [sumsales#47812 ASC NULLS FIRST, ss_customer_sk#133 ASC NULLS FIRST], true
      +- Aggregate [ss_customer_sk#133], [ss_customer_sk#133, sum(act_sales#47811) AS sumsales#47812]
         +- SubqueryAlias `t`
            +- Project [ss_item_sk#132, ss_ticket_number#139L, ss_customer_sk#133, CASE WHEN isnotnull(sr_return_quantity#186) THEN CheckOverflow((promote_precision(cast(cast((ss_quantity#140 - sr_return_quantity#186) as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)) ELSE CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)) END AS act_sales#47811]
               +- Filter ((sr_reason_sk#184 = r_reason_sk#646) && (r_reason_desc#648 = reason 28))
                  +- Join Inner
                     :- Join LeftOuter, ((sr_item_sk#178 = ss_item_sk#132) && (sr_ticket_number#185L = ss_ticket_number#139L))
                     :  :- SubqueryAlias `store_sales`
                     :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  +- SubqueryAlias `store_returns`
                     :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     +- SubqueryAlias `reason`
                        +- Relation[r_reason_sk#646,r_reason_id#647,r_reason_desc#648] parquet

     : benchmark
19/09/08 20:51:07 INFO Query:
== Query: q93-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [sumsales#47819 ASC NULLS FIRST, ss_customer_sk#133 ASC NULLS FIRST], true
      +- Aggregate [ss_customer_sk#133], [ss_customer_sk#133, sum(act_sales#47818) AS sumsales#47819]
         +- SubqueryAlias `t`
            +- Project [ss_item_sk#132, ss_ticket_number#139L, ss_customer_sk#133, CASE WHEN isnotnull(sr_return_quantity#186) THEN CheckOverflow((promote_precision(cast(cast((ss_quantity#140 - sr_return_quantity#186) as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)) ELSE CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)) END AS act_sales#47818]
               +- Filter ((sr_reason_sk#184 = r_reason_sk#646) && (r_reason_desc#648 = reason 28))
                  +- Join Inner
                     :- Join LeftOuter, ((sr_item_sk#178 = ss_item_sk#132) && (sr_ticket_number#185L = ss_ticket_number#139L))
                     :  :- SubqueryAlias `store_sales`
                     :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  +- SubqueryAlias `store_returns`
                     :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     +- SubqueryAlias `reason`
                        +- Relation[r_reason_sk#646,r_reason_id#647,r_reason_desc#648] parquet

      running Thread[benchmark runner,5,main]
Execution time: 117.77743446800001s
Running execution q94-v2.4 iteration: 1, StandardRun=true
19/09/08 20:53:06 INFO Query:
== Query: q94-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [order count#47897L, total shipping cost#47898, total net profit#47899]
      +- Sort [order count#47897L ASC NULLS FIRST], true
         +- Aggregate [count(distinct ws_order_number#233L) AS order count#47897L, sum(ws_ext_ship_cost#244) AS total shipping cost#47898, sum(ws_net_profit#249) AS total net profit#47899]
            +- Filter (((((d_date#494 >= cast(1999-02-01 as date)) && (d_date#494 <= cast(cast(cast(1999-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))) && (ws_ship_date_sk#218 = d_date_sk#492)) && ((ws_ship_addr_sk#227 = ca_address_sk#448) && (ca_state#456 = IL))) && (((ws_web_site_sk#229 = web_site_sk#798) && (web_company_name#812 = pri)) && (exists#47900 [ws_order_number#233L && ws_warehouse_sk#231] && NOT exists#47901 [ws_order_number#233L])))
               :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 10 more fields]
               :  :  +- Filter ((outer(ws_order_number#233L) = ws_order_number#233L) && NOT (outer(ws_warehouse_sk#231) = ws_warehouse_sk#231))
               :  :     +- SubqueryAlias `ws2`
               :  :        +- SubqueryAlias `web_sales`
               :  :           +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  +- Project [wr_returned_date_sk#284, wr_returned_time_sk#285, wr_item_sk#286, wr_refunded_customer_sk#287, wr_refunded_cdemo_sk#288, wr_refunded_hdemo_sk#289, wr_refunded_addr_sk#290, wr_returning_customer_sk#291, wr_returning_cdemo_sk#292, wr_returning_hdemo_sk#293, wr_returning_addr_sk#294, wr_web_page_sk#295, wr_reason_sk#296, wr_order_number#297L, wr_return_quantity#298, wr_return_amt#299, wr_return_tax#300, wr_return_amt_inc_tax#301, wr_fee#302, wr_return_ship_cost#303, wr_refunded_cash#304, wr_reversed_charge#305, wr_account_credit#306, wr_net_loss#307]
               :     +- Filter (outer(ws_order_number#233L) = wr_order_number#297L)
               :        +- SubqueryAlias `wr1`
               :           +- SubqueryAlias `web_returns`
               :              +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `ws1`
                  :  :  :  +- SubqueryAlias `web_sales`
                  :  :  :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `web_site`
                     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet

     : benchmark
19/09/08 20:53:06 INFO Query:
== Query: q94-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [order count#47910L, total shipping cost#47911, total net profit#47912]
      +- Sort [order count#47910L ASC NULLS FIRST], true
         +- Aggregate [count(distinct ws_order_number#233L) AS order count#47910L, sum(ws_ext_ship_cost#244) AS total shipping cost#47911, sum(ws_net_profit#249) AS total net profit#47912]
            +- Filter (((((d_date#494 >= cast(1999-02-01 as date)) && (d_date#494 <= cast(cast(cast(1999-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))) && (ws_ship_date_sk#218 = d_date_sk#492)) && ((ws_ship_addr_sk#227 = ca_address_sk#448) && (ca_state#456 = IL))) && (((ws_web_site_sk#229 = web_site_sk#798) && (web_company_name#812 = pri)) && (exists#47913 [ws_order_number#233L && ws_warehouse_sk#231] && NOT exists#47914 [ws_order_number#233L])))
               :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 10 more fields]
               :  :  +- Filter ((outer(ws_order_number#233L) = ws_order_number#233L) && NOT (outer(ws_warehouse_sk#231) = ws_warehouse_sk#231))
               :  :     +- SubqueryAlias `ws2`
               :  :        +- SubqueryAlias `web_sales`
               :  :           +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  +- Project [wr_returned_date_sk#284, wr_returned_time_sk#285, wr_item_sk#286, wr_refunded_customer_sk#287, wr_refunded_cdemo_sk#288, wr_refunded_hdemo_sk#289, wr_refunded_addr_sk#290, wr_returning_customer_sk#291, wr_returning_cdemo_sk#292, wr_returning_hdemo_sk#293, wr_returning_addr_sk#294, wr_web_page_sk#295, wr_reason_sk#296, wr_order_number#297L, wr_return_quantity#298, wr_return_amt#299, wr_return_tax#300, wr_return_amt_inc_tax#301, wr_fee#302, wr_return_ship_cost#303, wr_refunded_cash#304, wr_reversed_charge#305, wr_account_credit#306, wr_net_loss#307]
               :     +- Filter (outer(ws_order_number#233L) = wr_order_number#297L)
               :        +- SubqueryAlias `wr1`
               :           +- SubqueryAlias `web_returns`
               :              +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `ws1`
                  :  :  :  +- SubqueryAlias `web_sales`
                  :  :  :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `web_site`
                     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 31.436898175s
Running execution q95-v2.4 iteration: 1, StandardRun=true
19/09/08 20:53:38 INFO Query:
== Query: q95-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [order count#48050L, total shipping cost#48051, total net profit#48052]
      +- Sort [order count#48050L ASC NULLS FIRST], true
         +- Aggregate [count(distinct ws_order_number#233L) AS order count#48050L, sum(ws_ext_ship_cost#244) AS total shipping cost#48051, sum(ws_net_profit#249) AS total net profit#48052]
            +- Filter (((((d_date#494 >= cast(1999-02-01 as date)) && (d_date#494 <= cast(cast(cast(1999-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))) && (ws_ship_date_sk#218 = d_date_sk#492)) && ((ws_ship_addr_sk#227 = ca_address_sk#448) && (ca_state#456 = IL))) && (((ws_web_site_sk#229 = web_site_sk#798) && (web_company_name#812 = pri)) && (ws_order_number#233L IN (list#48053 []) && ws_order_number#233L IN (list#48054 []))))
               :  :- Project [ws_order_number#233L]
               :  :  +- SubqueryAlias `ws_wh`
               :  :     +- Project [ws_order_number#233L, ws_warehouse_sk#231 AS wh1#48055, ws_warehouse_sk#48072 AS wh2#48056]
               :  :        +- Filter ((ws_order_number#233L = ws_order_number#48074L) && NOT (ws_warehouse_sk#231 = ws_warehouse_sk#48072))
               :  :           +- Join Inner
               :  :              :- SubqueryAlias `ws1`
               :  :              :  +- SubqueryAlias `web_sales`
               :  :              :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :              +- SubqueryAlias `ws2`
               :  :                 +- SubqueryAlias `web_sales`
               :  :                    +- Relation[ws_sold_date_sk#48057,ws_sold_time_sk#48058,ws_ship_date_sk#48059,ws_item_sk#48060,ws_bill_customer_sk#48061,ws_bill_cdemo_sk#48062,ws_bill_hdemo_sk#48063,ws_bill_addr_sk#48064,ws_ship_customer_sk#48065,ws_ship_cdemo_sk#48066,ws_ship_hdemo_sk#48067,ws_ship_addr_sk#48068,ws_web_page_sk#48069,ws_web_site_sk#48070,ws_ship_mode_sk#48071,ws_warehouse_sk#48072,ws_promo_sk#48073,ws_order_number#48074L,ws_quantity#48075,ws_wholesale_cost#48076,ws_list_price#48077,ws_sales_price#48078,ws_ext_discount_amt#48079,ws_ext_sales_price#48080,... 10 more fields] parquet
               :  +- Project [wr_order_number#297L]
               :     +- Filter (wr_order_number#297L = ws_order_number#233L)
               :        +- Join Inner
               :           :- SubqueryAlias `web_returns`
               :           :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               :           +- SubqueryAlias `ws_wh`
               :              +- Project [ws_order_number#233L, ws_warehouse_sk#231 AS wh1#48055, ws_warehouse_sk#48072 AS wh2#48056]
               :                 +- Filter ((ws_order_number#233L = ws_order_number#48074L) && NOT (ws_warehouse_sk#231 = ws_warehouse_sk#48072))
               :                    +- Join Inner
               :                       :- SubqueryAlias `ws1`
               :                       :  +- SubqueryAlias `web_sales`
               :                       :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                       +- SubqueryAlias `ws2`
               :                          +- SubqueryAlias `web_sales`
               :                             +- Relation[ws_sold_date_sk#48057,ws_sold_time_sk#48058,ws_ship_date_sk#48059,ws_item_sk#48060,ws_bill_customer_sk#48061,ws_bill_cdemo_sk#48062,ws_bill_hdemo_sk#48063,ws_bill_addr_sk#48064,ws_ship_customer_sk#48065,ws_ship_cdemo_sk#48066,ws_ship_hdemo_sk#48067,ws_ship_addr_sk#48068,ws_web_page_sk#48069,ws_web_site_sk#48070,ws_ship_mode_sk#48071,ws_warehouse_sk#48072,ws_promo_sk#48073,ws_order_number#48074L,ws_quantity#48075,ws_wholesale_cost#48076,ws_list_price#48077,ws_sales_price#48078,ws_ext_discount_amt#48079,ws_ext_sales_price#48080,... 10 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `ws1`
                  :  :  :  +- SubqueryAlias `web_sales`
                  :  :  :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `web_site`
                     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet

     : benchmark
19/09/08 20:53:39 INFO Query:
== Query: q95-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [order count#48099L, total shipping cost#48100, total net profit#48101]
      +- Sort [order count#48099L ASC NULLS FIRST], true
         +- Aggregate [count(distinct ws_order_number#233L) AS order count#48099L, sum(ws_ext_ship_cost#244) AS total shipping cost#48100, sum(ws_net_profit#249) AS total net profit#48101]
            +- Filter (((((d_date#494 >= cast(1999-02-01 as date)) && (d_date#494 <= cast(cast(cast(1999-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))) && (ws_ship_date_sk#218 = d_date_sk#492)) && ((ws_ship_addr_sk#227 = ca_address_sk#448) && (ca_state#456 = IL))) && (((ws_web_site_sk#229 = web_site_sk#798) && (web_company_name#812 = pri)) && (ws_order_number#233L IN (list#48102 []) && ws_order_number#233L IN (list#48103 []))))
               :  :- Project [ws_order_number#233L]
               :  :  +- SubqueryAlias `ws_wh`
               :  :     +- Project [ws_order_number#233L, ws_warehouse_sk#231 AS wh1#48104, ws_warehouse_sk#48121 AS wh2#48105]
               :  :        +- Filter ((ws_order_number#233L = ws_order_number#48123L) && NOT (ws_warehouse_sk#231 = ws_warehouse_sk#48121))
               :  :           +- Join Inner
               :  :              :- SubqueryAlias `ws1`
               :  :              :  +- SubqueryAlias `web_sales`
               :  :              :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :              +- SubqueryAlias `ws2`
               :  :                 +- SubqueryAlias `web_sales`
               :  :                    +- Relation[ws_sold_date_sk#48106,ws_sold_time_sk#48107,ws_ship_date_sk#48108,ws_item_sk#48109,ws_bill_customer_sk#48110,ws_bill_cdemo_sk#48111,ws_bill_hdemo_sk#48112,ws_bill_addr_sk#48113,ws_ship_customer_sk#48114,ws_ship_cdemo_sk#48115,ws_ship_hdemo_sk#48116,ws_ship_addr_sk#48117,ws_web_page_sk#48118,ws_web_site_sk#48119,ws_ship_mode_sk#48120,ws_warehouse_sk#48121,ws_promo_sk#48122,ws_order_number#48123L,ws_quantity#48124,ws_wholesale_cost#48125,ws_list_price#48126,ws_sales_price#48127,ws_ext_discount_amt#48128,ws_ext_sales_price#48129,... 10 more fields] parquet
               :  +- Project [wr_order_number#297L]
               :     +- Filter (wr_order_number#297L = ws_order_number#233L)
               :        +- Join Inner
               :           :- SubqueryAlias `web_returns`
               :           :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               :           +- SubqueryAlias `ws_wh`
               :              +- Project [ws_order_number#233L, ws_warehouse_sk#231 AS wh1#48104, ws_warehouse_sk#48121 AS wh2#48105]
               :                 +- Filter ((ws_order_number#233L = ws_order_number#48123L) && NOT (ws_warehouse_sk#231 = ws_warehouse_sk#48121))
               :                    +- Join Inner
               :                       :- SubqueryAlias `ws1`
               :                       :  +- SubqueryAlias `web_sales`
               :                       :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                       +- SubqueryAlias `ws2`
               :                          +- SubqueryAlias `web_sales`
               :                             +- Relation[ws_sold_date_sk#48106,ws_sold_time_sk#48107,ws_ship_date_sk#48108,ws_item_sk#48109,ws_bill_customer_sk#48110,ws_bill_cdemo_sk#48111,ws_bill_hdemo_sk#48112,ws_bill_addr_sk#48113,ws_ship_customer_sk#48114,ws_ship_cdemo_sk#48115,ws_ship_hdemo_sk#48116,ws_ship_addr_sk#48117,ws_web_page_sk#48118,ws_web_site_sk#48119,ws_ship_mode_sk#48120,ws_warehouse_sk#48121,ws_promo_sk#48122,ws_order_number#48123L,ws_quantity#48124,ws_wholesale_cost#48125,ws_list_price#48126,ws_sales_price#48127,ws_ext_discount_amt#48128,ws_ext_sales_price#48129,... 10 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `ws1`
                  :  :  :  +- SubqueryAlias `web_sales`
                  :  :  :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `web_site`
                     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 150.939738029s
Running execution q96-v2.4 iteration: 1, StandardRun=true
19/09/08 20:56:11 INFO Query:
== Query: q96-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [count(1)#48265L]
      +- Sort [count(1)#48265L ASC NULLS FIRST], true
         +- Aggregate [count(1) AS count(1)#48265L]
            +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 20))) && (((t_minute#726 >= 30) && (hd_dep_count#551 = 7)) && (s_store_name#669 = ese)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  +- SubqueryAlias `household_demographics`
                  :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                  :  +- SubqueryAlias `time_dim`
                  :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                  +- SubqueryAlias `store`
                     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/09/08 20:56:11 INFO Query:
== Query: q96-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [count(1)#48270L]
      +- Sort [count(1)#48270L ASC NULLS FIRST], true
         +- Aggregate [count(1) AS count(1)#48270L]
            +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 20))) && (((t_minute#726 >= 30) && (hd_dep_count#551 = 7)) && (s_store_name#669 = ese)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  +- SubqueryAlias `household_demographics`
                  :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                  :  +- SubqueryAlias `time_dim`
                  :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                  +- SubqueryAlias `store`
                     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 5.382990978s
Running execution q97-v2.4 iteration: 1, StandardRun=true
19/09/08 20:56:17 INFO Query:
== Query: q97-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [sum(cast(CASE WHEN (isnotnull(customer_sk#48308) && isnull(customer_sk#48310)) THEN 1 ELSE 0 END as bigint)) AS store_only#48305L, sum(cast(CASE WHEN (isnull(customer_sk#48308) && isnotnull(customer_sk#48310)) THEN 1 ELSE 0 END as bigint)) AS catalog_only#48306L, sum(cast(CASE WHEN (isnotnull(customer_sk#48308) && isnotnull(customer_sk#48310)) THEN 1 ELSE 0 END as bigint)) AS store_and_catalog#48307L]
      +- Join FullOuter, ((customer_sk#48308 = customer_sk#48310) && (item_sk#48309 = item_sk#48311))
         :- SubqueryAlias `ssci`
         :  +- Aggregate [ss_customer_sk#133, ss_item_sk#132], [ss_customer_sk#133 AS customer_sk#48308, ss_item_sk#132 AS item_sk#48309]
         :     +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
         :        +- Join Inner
         :           :- SubqueryAlias `store_sales`
         :           :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :           +- SubqueryAlias `date_dim`
         :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- SubqueryAlias `csci`
            +- Aggregate [cs_bill_customer_sk#3, cs_item_sk#15], [cs_bill_customer_sk#3 AS customer_sk#48310, cs_item_sk#15 AS item_sk#48311]
               +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
                  +- Join Inner
                     :- SubqueryAlias `catalog_sales`
                     :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 20:56:17 INFO Query:
== Query: q97-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [sum(cast(CASE WHEN (isnotnull(customer_sk#48321) && isnull(customer_sk#48323)) THEN 1 ELSE 0 END as bigint)) AS store_only#48318L, sum(cast(CASE WHEN (isnull(customer_sk#48321) && isnotnull(customer_sk#48323)) THEN 1 ELSE 0 END as bigint)) AS catalog_only#48319L, sum(cast(CASE WHEN (isnotnull(customer_sk#48321) && isnotnull(customer_sk#48323)) THEN 1 ELSE 0 END as bigint)) AS store_and_catalog#48320L]
      +- Join FullOuter, ((customer_sk#48321 = customer_sk#48323) && (item_sk#48322 = item_sk#48324))
         :- SubqueryAlias `ssci`
         :  +- Aggregate [ss_customer_sk#133, ss_item_sk#132], [ss_customer_sk#133 AS customer_sk#48321, ss_item_sk#132 AS item_sk#48322]
         :     +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
         :        +- Join Inner
         :           :- SubqueryAlias `store_sales`
         :           :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :           +- SubqueryAlias `date_dim`
         :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- SubqueryAlias `csci`
            +- Aggregate [cs_bill_customer_sk#3, cs_item_sk#15], [cs_bill_customer_sk#3 AS customer_sk#48323, cs_item_sk#15 AS item_sk#48324]
               +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
                  +- Join Inner
                     :- SubqueryAlias `catalog_sales`
                     :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 47.189862098s
Running execution q98-v2.4 iteration: 1, StandardRun=true
19/09/08 20:57:05 INFO Query:
== Query: q98-v2.4 ==
Project [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#48381, revenueratio#48382]
+- Sort [i_category#576 ASC NULLS FIRST, i_class#574 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, revenueratio#48382 ASC NULLS FIRST], true
   +- Project [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#48381, revenueratio#48382, i_item_id#565]
      +- Project [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#48381, _w0#48387, _w1#48388, _we0#48389, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(_w0#48387 as decimal(17,2))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(17,2)))), DecimalType(21,2)) as decimal(27,2))) / promote_precision(cast(_we0#48389 as decimal(27,2)))), DecimalType(38,17)) AS revenueratio#48382, i_item_id#565]
         +- Window [sum(_w1#48388) windowspecdefinition(i_class#574, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#48389], [i_class#574]
            +- Aggregate [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569], [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, sum(ss_ext_sales_price#145) AS itemrevenue#48381, sum(ss_ext_sales_price#145) AS _w0#48387, sum(ss_ext_sales_price#145) AS _w1#48388, i_item_id#565]
               +- Filter (((ss_item_sk#132 = i_item_sk#564) && i_category#576 IN (Sports,Books,Home)) && ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_date#494 >= cast(1999-02-22 as date)) && (d_date#494 <= cast(cast(cast(1999-02-22 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                  +- Join Inner
                     :- Join Inner
                     :  :- SubqueryAlias `store_sales`
                     :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  +- SubqueryAlias `item`
                     :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 20:57:05 INFO Query:
== Query: q98-v2.4 ==
Project [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#48396, revenueratio#48397]
+- Sort [i_category#576 ASC NULLS FIRST, i_class#574 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, revenueratio#48397 ASC NULLS FIRST], true
   +- Project [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#48396, revenueratio#48397, i_item_id#565]
      +- Project [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#48396, _w0#48402, _w1#48403, _we0#48404, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(_w0#48402 as decimal(17,2))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(17,2)))), DecimalType(21,2)) as decimal(27,2))) / promote_precision(cast(_we0#48404 as decimal(27,2)))), DecimalType(38,17)) AS revenueratio#48397, i_item_id#565]
         +- Window [sum(_w1#48403) windowspecdefinition(i_class#574, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#48404], [i_class#574]
            +- Aggregate [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569], [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, sum(ss_ext_sales_price#145) AS itemrevenue#48396, sum(ss_ext_sales_price#145) AS _w0#48402, sum(ss_ext_sales_price#145) AS _w1#48403, i_item_id#565]
               +- Filter (((ss_item_sk#132 = i_item_sk#564) && i_category#576 IN (Sports,Books,Home)) && ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_date#494 >= cast(1999-02-22 as date)) && (d_date#494 <= cast(cast(cast(1999-02-22 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                  +- Join Inner
                     :- Join Inner
                     :  :- SubqueryAlias `store_sales`
                     :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  +- SubqueryAlias `item`
                     :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 12.94930334s
Running execution q99-v2.4 iteration: 1, StandardRun=true
19/09/08 20:57:19 INFO Query:
== Query: q99-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [substring(w_warehouse_name, 1, 20)#48487, sm_type#654, cc_name#338, 30 days#48477L, 31-60 days#48478L, 61-90 days#48479L, 91-120 days#48480L, >120 days#48481L]
      +- Sort [substring(w_warehouse_name, 1, 20)#48487 ASC NULLS FIRST, sm_type#654 ASC NULLS FIRST, cc_name#338 ASC NULLS FIRST], true
         +- Aggregate [substring(w_warehouse_name#744, 1, 20), sm_type#654, cc_name#338], [substring(w_warehouse_name#744, 1, 20) AS substring(w_warehouse_name, 1, 20)#48487, sm_type#654, cc_name#338, sum(cast(CASE WHEN ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days#48477L, sum(cast(CASE WHEN (((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 30) && ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31-60 days#48478L, sum(cast(CASE WHEN (((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 60) && ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61-90 days#48479L, sum(cast(CASE WHEN (((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 90) && ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91-120 days#48480L, sum(cast(CASE WHEN ((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days#48481L]
            +- Filter (((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (cs_ship_date_sk#2 = d_date_sk#492)) && (cs_warehouse_sk#14 = w_warehouse_sk#742)) && ((cs_ship_mode_sk#13 = sm_ship_mode_sk#652) && (cs_call_center_sk#11 = cc_call_center_sk#332)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `warehouse`
                  :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :  :  +- SubqueryAlias `ship_mode`
                  :  :     +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet
                  :  +- SubqueryAlias `call_center`
                  :     +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/09/08 20:57:19 INFO Query:
== Query: q99-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [substring(w_warehouse_name, 1, 20)#48509, sm_type#654, cc_name#338, 30 days#48499L, 31-60 days#48500L, 61-90 days#48501L, 91-120 days#48502L, >120 days#48503L]
      +- Sort [substring(w_warehouse_name, 1, 20)#48509 ASC NULLS FIRST, sm_type#654 ASC NULLS FIRST, cc_name#338 ASC NULLS FIRST], true
         +- Aggregate [substring(w_warehouse_name#744, 1, 20), sm_type#654, cc_name#338], [substring(w_warehouse_name#744, 1, 20) AS substring(w_warehouse_name, 1, 20)#48509, sm_type#654, cc_name#338, sum(cast(CASE WHEN ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days#48499L, sum(cast(CASE WHEN (((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 30) && ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31-60 days#48500L, sum(cast(CASE WHEN (((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 60) && ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61-90 days#48501L, sum(cast(CASE WHEN (((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 90) && ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91-120 days#48502L, sum(cast(CASE WHEN ((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days#48503L]
            +- Filter (((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (cs_ship_date_sk#2 = d_date_sk#492)) && (cs_warehouse_sk#14 = w_warehouse_sk#742)) && ((cs_ship_mode_sk#13 = sm_ship_mode_sk#652) && (cs_call_center_sk#11 = cc_call_center_sk#332)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `warehouse`
                  :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :  :  +- SubqueryAlias `ship_mode`
                  :  :     +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet
                  :  +- SubqueryAlias `call_center`
                  :     +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 9.276328302s
Running execution ss_max-v2.4 iteration: 1, StandardRun=true
19/09/08 20:57:29 INFO Query:
== Query: ss_max-v2.4 ==
Aggregate [count(1) AS total#48639L, count(ss_sold_date_sk#130) AS not_null_total#48640L, count(distinct ss_sold_date_sk#130) AS unique_days#48641L, max(ss_sold_date_sk#130) AS max_ss_sold_date_sk#48642, max(ss_sold_time_sk#131) AS max_ss_sold_time_sk#48643, max(ss_item_sk#132) AS max_ss_item_sk#48644, max(ss_customer_sk#133) AS max_ss_customer_sk#48645, max(ss_cdemo_sk#134) AS max_ss_cdemo_sk#48646, max(ss_hdemo_sk#135) AS max_ss_hdemo_sk#48647, max(ss_addr_sk#136) AS max_ss_addr_sk#48648, max(ss_store_sk#137) AS max_ss_store_sk#48649, max(ss_promo_sk#138) AS max_ss_promo_sk#48650]
+- SubqueryAlias `store_sales`
   +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
19/09/08 20:57:29 INFO Query:
== Query: ss_max-v2.4 ==
Aggregate [count(1) AS total#48675L, count(ss_sold_date_sk#130) AS not_null_total#48676L, count(distinct ss_sold_date_sk#130) AS unique_days#48677L, max(ss_sold_date_sk#130) AS max_ss_sold_date_sk#48678, max(ss_sold_time_sk#131) AS max_ss_sold_time_sk#48679, max(ss_item_sk#132) AS max_ss_item_sk#48680, max(ss_customer_sk#133) AS max_ss_customer_sk#48681, max(ss_cdemo_sk#134) AS max_ss_cdemo_sk#48682, max(ss_hdemo_sk#135) AS max_ss_hdemo_sk#48683, max(ss_addr_sk#136) AS max_ss_addr_sk#48684, max(ss_store_sk#137) AS max_ss_store_sk#48685, max(ss_promo_sk#138) AS max_ss_promo_sk#48686]
+- SubqueryAlias `store_sales`
   +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 19.797845063s
Results written to table: 'sqlPerformance' at s3a://spark-k8s-data/TPCDS-TEST-1T-RESULT/timestamp=1567968593698
19/09/08 20:57:51 WARN TaskSetManager: Stage 1218 contains a task of very large size (3366 KB). The maximum recommended task size is 100 KB.
19/09/08 20:57:52 WARN AbstractS3ACommitter: Task committer attempt_20190908205751_0000_m_000000_0: No pending uploads to commit
Reading result at s3a://spark-k8s-data/TPCDS-TEST-1T-RESULT/timestamp=1567968593698
+--------------------+---------+--------------------+------+-------------+
|       configuration|iteration|             results|  tags|    timestamp|
+--------------------+---------+--------------------+------+-------------+
|[90, [spark-43b7c...|        1|[[0.012962, [], 3...|[true]|1567968593698|
+--------------------+---------+--------------------+------+-------------+

+---------+---------+------------------+
|iteration|queryName|  executionSeconds|
+---------+---------+------------------+
|        1|  q1-v2.4|      34.231924574|
|        1|  q2-v2.4|22.007735606999997|
|        1|  q3-v2.4|      12.847368397|
|        1|  q4-v2.4|268.65036112999996|
|        1|  q5-v2.4|      63.173913617|
|        1|  q6-v2.4|      55.365758087|
|        1|  q7-v2.4|      19.272139716|
|        1|  q8-v2.4|      14.825732599|
|        1|  q9-v2.4|      64.590482742|
|        1| q10-v2.4|      21.724999276|
|        1| q11-v2.4|      86.635199495|
|        1| q12-v2.4|       6.817133044|
|        1| q13-v2.4|      69.940721246|
|        1|q14a-v2.4|     258.786406474|
|        1|q14b-v2.4|     220.800127259|
|        1| q15-v2.4|      42.183746129|
|        1| q16-v2.4|58.827638955000005|
|        1| q17-v2.4|     123.863407076|
|        1| q18-v2.4|24.178040590000002|
|        1| q19-v2.4|       15.92696997|
+---------+---------+------------------+
only showing top 20 rows

Final results at s3a://spark-k8s-data/TPCDS-TEST-1T-RESULT/timestamp=1567968593698
19/09/08 20:57:57 WARN AbstractS3ACommitter: Task committer attempt_20190908205754_0000_m_000000_0: No pending uploads to commit
+-----------+--------------------+-----------------+-----------------+
|  queryName|medianRuntimeSeconds|minRuntimeSeconds|maxRuntimeSeconds|
+-----------+--------------------+-----------------+-----------------+
|    q1-v2.4|                34.0|               34|               34|
|   q10-v2.4|                21.0|               21|               21|
|   q11-v2.4|                86.0|               86|               86|
|   q12-v2.4|                 6.0|                6|                6|
|   q13-v2.4|                69.0|               69|               69|
|  q14a-v2.4|               258.0|              258|              258|
|  q14b-v2.4|               220.0|              220|              220|
|   q15-v2.4|                42.0|               42|               42|
|   q16-v2.4|                58.0|               58|               58|
|   q17-v2.4|               123.0|              123|              123|
|   q18-v2.4|                24.0|               24|               24|
|   q19-v2.4|                15.0|               15|               15|
|    q2-v2.4|                22.0|               22|               22|
|   q20-v2.4|                 7.0|                7|                7|
|   q21-v2.4|                 5.0|                5|                5|
|   q22-v2.4|                18.0|               18|               18|
|  q23a-v2.4|               356.0|              356|              356|
|  q23b-v2.4|               271.0|              271|              271|
|  q24a-v2.4|               146.0|              146|              146|
|  q24b-v2.4|               134.0|              134|              134|
|   q25-v2.4|               423.0|              423|              423|
|   q26-v2.4|                13.0|               13|               13|
|   q27-v2.4|                18.0|               18|               18|
|   q28-v2.4|                52.0|               52|               52|
|   q29-v2.4|               114.0|              114|              114|
|    q3-v2.4|                12.0|               12|               12|
|   q30-v2.4|                18.0|               18|               18|
|   q31-v2.4|                44.0|               44|               44|
|   q32-v2.4|                12.0|               12|               12|
|   q33-v2.4|                23.0|               23|               23|
|   q34-v2.4|                10.0|               10|               10|
|   q35-v2.4|                24.0|               24|               24|
|   q36-v2.4|                13.0|               13|               13|
|   q37-v2.4|                15.0|               15|               15|
|   q38-v2.4|                31.0|               31|               31|
|  q39a-v2.4|                 9.0|                9|                9|
|  q39b-v2.4|                 8.0|                8|                8|
|    q4-v2.4|               268.0|              268|              268|
|   q40-v2.4|                35.0|               35|               35|
|   q41-v2.4|                 2.0|                2|                2|
|   q42-v2.4|                 9.0|                9|                9|
|   q43-v2.4|                 9.0|                9|                9|
|   q44-v2.4|                21.0|               21|               21|
|   q45-v2.4|                23.0|               23|               23|
|   q46-v2.4|                17.0|               17|               17|
|   q47-v2.4|                27.0|               27|               27|
|   q48-v2.4|                21.0|               21|               21|
|   q49-v2.4|                51.0|               51|               51|
|    q5-v2.4|                63.0|               63|               63|
|   q50-v2.4|                46.0|               46|               46|
|   q51-v2.4|                32.0|               32|               32|
|   q52-v2.4|                10.0|               10|               10|
|   q53-v2.4|                12.0|               12|               12|
|   q54-v2.4|                51.0|               51|               51|
|   q55-v2.4|                10.0|               10|               10|
|   q56-v2.4|                23.0|               23|               23|
|   q57-v2.4|                14.0|               14|               14|
|   q58-v2.4|                20.0|               20|               20|
|   q59-v2.4|                22.0|               22|               22|
|    q6-v2.4|                55.0|               55|               55|
|   q60-v2.4|                22.0|               22|               22|
|   q61-v2.4|                31.0|               31|               31|
|   q62-v2.4|                 6.0|                6|                6|
|   q63-v2.4|                10.0|               10|               10|
|   q64-v2.4|               245.0|              245|              245|
|   q65-v2.4|                42.0|               42|               42|
|   q66-v2.4|                18.0|               18|               18|
|   q67-v2.4|              1120.0|             1120|             1120|
|   q68-v2.4|                24.0|               24|               24|
|   q69-v2.4|                21.0|               21|               21|
|    q7-v2.4|                19.0|               19|               19|
|   q70-v2.4|                18.0|               18|               18|
|   q71-v2.4|                21.0|               21|               21|
|   q72-v2.4|               862.0|              862|              862|
|   q73-v2.4|                11.0|               11|               11|
|   q74-v2.4|                76.0|               76|               76|
|   q75-v2.4|                79.0|               79|               79|
|   q76-v2.4|                19.0|               19|               19|
|   q77-v2.4|                43.0|               43|               43|
|   q78-v2.4|               199.0|              199|              199|
|   q79-v2.4|                17.0|               17|               17|
|    q8-v2.4|                14.0|               14|               14|
|   q80-v2.4|               238.0|              238|              238|
|   q81-v2.4|                15.0|               15|               15|
|   q82-v2.4|                22.0|               22|               22|
|   q83-v2.4|                 7.0|                7|                7|
|   q84-v2.4|                 9.0|                9|                9|
|   q85-v2.4|                38.0|               38|               38|
|   q86-v2.4|                 6.0|                6|                6|
|   q87-v2.4|                34.0|               34|               34|
|   q88-v2.4|                43.0|               43|               43|
|   q89-v2.4|                12.0|               12|               12|
|    q9-v2.4|                64.0|               64|               64|
|   q90-v2.4|                 4.0|                4|                4|
|   q91-v2.4|                 6.0|                6|                6|
|   q92-v2.4|                 7.0|                7|                7|
|   q93-v2.4|               117.0|              117|              117|
|   q94-v2.4|                31.0|               31|               31|
|   q95-v2.4|               150.0|              150|              150|
|   q96-v2.4|                 5.0|                5|                5|
|   q97-v2.4|                47.0|               47|               47|
|   q98-v2.4|                12.0|               12|               12|
|   q99-v2.4|                 9.0|                9|                9|
|ss_max-v2.4|                19.0|               19|               19|
+-----------+--------------------+-----------------+-----------------+

19/09/08 20:57:58 WARN StageMetrics: Stage metrics data refreshed into temp view PerfStageMetrics

Scheduling mode = FIFO
Spark Context default degree of parallelism = 90
Aggregated Spark stage metrics:
numStages => 1131
sum(numTasks) => 332719
elapsedTime => 7672755 (2.1 h)
sum(stageDuration) => 14916825 (4.1 h)
sum(executorRunTime) => 481304601 (133.7 h)
sum(executorCpuTime) => 402291319 (111.7 h)
sum(executorDeserializeTime) => 1937722 (32 min)
sum(executorDeserializeCpuTime) => 1227345 (20 min)
sum(resultSerializationTime) => 15957 (16 s)
sum(jvmGCTime) => 3561938 (59 min)
sum(shuffleFetchWaitTime) => 7482475 (2.1 h)
sum(shuffleWriteTime) => 10564054 (2.9 h)
max(resultSize) => 620755936 (591.0 MB)
sum(numUpdatedBlockStatuses) => 0
sum(diskBytesSpilled) => 30994759381 (28.0 GB)
sum(memoryBytesSpilled) => 115494354944 (107.0 GB)
max(peakExecutionMemory) => 872094367744
sum(recordsRead) => 468586852361
sum(bytesRead) => 2945941120513 (2.0 TB)
sum(recordsWritten) => 105
sum(bytesWritten) => 3431879 (3.0 MB)
sum(shuffleTotalBytesRead) => 3196279332812 (2.0 TB)
sum(shuffleTotalBlocksFetched) => 37354958
sum(shuffleLocalBlocksFetched) => 438060
sum(shuffleRemoteBlocksFetched) => 36916898
sum(shuffleBytesWritten) => 2894550211433 (2.0 TB)
sum(shuffleRecordsWritten) => 150719749237
19/09/08 20:57:59 WARN AbstractS3ACommitter: Task committer attempt_20190908205758_0000_m_000000_0: No pending uploads to commit
19/09/08 20:57:59 WARN ExecutorPodsWatchSnapshotSource: Kubernetes client has been closed (this is expected if the application is shutting down.)
