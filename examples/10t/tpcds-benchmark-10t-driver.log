++ id -u
+ myuid=0
++ id -g
+ mygid=0
+ set +e
++ getent passwd 0
+ uidentry=root:x:0:0:root:/root:/bin/ash
+ set -e
+ '[' -z root:x:0:0:root:/root:/bin/ash ']'
+ SPARK_K8S_CMD=driver
+ case "$SPARK_K8S_CMD" in
+ shift 1
+ SPARK_CLASSPATH=':/opt/spark/jars/*'
+ env
+ grep SPARK_JAVA_OPT_
+ sort -t_ -k4 -n
+ sed 's/[^=]*=\(.*\)/\1/g'
+ readarray -t SPARK_EXECUTOR_JAVA_OPTS
+ '[' -n '' ']'
+ '[' -n '' ']'
+ PYSPARK_ARGS=
+ '[' -n '' ']'
+ R_ARGS=
+ '[' -n '' ']'
+ '[' '' == 2 ']'
+ '[' '' == 3 ']'
+ case "$SPARK_K8S_CMD" in
+ CMD=("$SPARK_HOME/bin/spark-submit" --conf "spark.driver.bindAddress=$SPARK_DRIVER_BIND_ADDRESS" --deploy-mode client "$@")
+ exec /sbin/tini -s -- /opt/spark/bin/spark-submit --conf spark.driver.bindAddress=192.168.50.200 --deploy-mode client --properties-file /opt/spark/conf/spark.properties --class com.amazonaws.eks.tpcds.BenchmarkSparkSQL spark-internal s3a://spark-k8s-data/TPCDS-TEST-10T s3a://spark-k8s-data/TPCDS-TEST-10T-RESULT /opt/tpcds-kit/tools 10000 1 false '' true
19/10/03 15:02:42 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
DATA DIR is s3a://spark-k8s-data/TPCDS-TEST-10T
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
19/10/03 15:02:43 INFO SparkContext: Running Spark version 2.4.5-SNAPSHOT
19/10/03 15:02:43 INFO SparkContext: Submitted application: TPCDS SQL Benchmark 10000 GB
19/10/03 15:02:43 INFO SecurityManager: Changing view acls to: root
19/10/03 15:02:43 INFO SecurityManager: Changing modify acls to: root
19/10/03 15:02:43 INFO SecurityManager: Changing view acls groups to: 
19/10/03 15:02:43 INFO SecurityManager: Changing modify acls groups to: 
19/10/03 15:02:43 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(root); groups with view permissions: Set(); users  with modify permissions: Set(root); groups with modify permissions: Set()
19/10/03 15:02:43 INFO Utils: Successfully started service 'sparkDriver' on port 7078.
19/10/03 15:02:43 INFO SparkEnv: Registering MapOutputTracker
19/10/03 15:02:43 INFO SparkEnv: Registering BlockManagerMaster
19/10/03 15:02:43 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
19/10/03 15:02:43 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
19/10/03 15:02:43 INFO DiskBlockManager: Created local directory at /tmp/spark-local-dir/blockmgr-fb1fd6f5-0807-4d03-8e6b-e6bb97fe18cd
19/10/03 15:02:43 INFO MemoryStore: MemoryStore started with capacity 4.0 GB
19/10/03 15:02:43 INFO SparkEnv: Registering OutputCommitCoordinator
19/10/03 15:02:43 INFO Utils: Successfully started service 'SparkUI' on port 4040.
19/10/03 15:02:44 INFO SparkUI: Bound SparkUI to 0.0.0.0, and started at http://tpcds-benchmark-10t-1570114958570-driver-svc.default.svc:4040
19/10/03 15:02:44 INFO SparkContext: Added JAR file:///opt/spark/examples/jars/eks-spark-examples-assembly-1.0.jar at spark://tpcds-benchmark-10t-1570114958570-driver-svc.default.svc:7078/jars/eks-spark-examples-assembly-1.0.jar with timestamp 1570114964015
19/10/03 15:02:44 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/10/03 15:02:45 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 7079.
19/10/03 15:02:45 INFO NettyBlockTransferService: Server created on tpcds-benchmark-10t-1570114958570-driver-svc.default.svc:7079
19/10/03 15:02:45 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
19/10/03 15:02:45 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, tpcds-benchmark-10t-1570114958570-driver-svc.default.svc, 7079, None)
19/10/03 15:02:45 INFO BlockManagerMasterEndpoint: Registering block manager tpcds-benchmark-10t-1570114958570-driver-svc.default.svc:7079 with 4.0 GB RAM, BlockManagerId(driver, tpcds-benchmark-10t-1570114958570-driver-svc.default.svc, 7079, None)
19/10/03 15:02:45 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, tpcds-benchmark-10t-1570114958570-driver-svc.default.svc, 7079, None)
19/10/03 15:02:45 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, tpcds-benchmark-10t-1570114958570-driver-svc.default.svc, 7079, None)
19/10/03 15:02:45 INFO FluentPropertyBeanIntrospector: Error when creating PropertyDescriptor for public final void org.apache.commons.configuration2.AbstractConfiguration.setProperty(java.lang.String,java.lang.Object)! Ignoring this property.
19/10/03 15:02:45 WARN MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-s3a-file-system.properties,hadoop-metrics2.properties
19/10/03 15:02:45 INFO MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
19/10/03 15:02:45 INFO MetricsSystemImpl: s3a-file-system metrics system started
19/10/03 15:02:46 INFO deprecation: fs.s3a.server-side-encryption-key is deprecated. Instead, use fs.s3a.server-side-encryption.key
19/10/03 15:02:46 INFO EventLoggingListener: Logging events to s3a://spark-k8s-data/spark-history-server/spark-6aa15cd524314bb8b621a5308b664471
19/10/03 15:02:47 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/10/03 15:02:48 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.35.253:57364) with ID 2
19/10/03 15:02:48 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.18.168:34414) with ID 1
19/10/03 15:02:48 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.4.136:44888) with ID 3
19/10/03 15:02:48 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.35.253:40697 with 4.3 GB RAM, BlockManagerId(2, 192.168.35.253, 40697, None)
19/10/03 15:02:48 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.18.168:37477 with 4.3 GB RAM, BlockManagerId(1, 192.168.18.168, 37477, None)
19/10/03 15:02:48 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.25.178:42916) with ID 4
19/10/03 15:02:48 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.25.142:53890) with ID 5
19/10/03 15:02:48 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.4.136:38927 with 4.3 GB RAM, BlockManagerId(3, 192.168.4.136, 38927, None)
19/10/03 15:02:48 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.25.178:44759 with 4.3 GB RAM, BlockManagerId(4, 192.168.25.178, 44759, None)
19/10/03 15:02:48 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.25.142:37995 with 4.3 GB RAM, BlockManagerId(5, 192.168.25.142, 37995, None)
19/10/03 15:02:50 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/10/03 15:02:50 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.13.226:39574) with ID 7
19/10/03 15:02:50 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.63.143:35198) with ID 6
19/10/03 15:02:50 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.37.35:58070) with ID 10
19/10/03 15:02:50 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.13.226:32819 with 4.3 GB RAM, BlockManagerId(7, 192.168.13.226, 32819, None)
19/10/03 15:02:50 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.26.29:42616) with ID 9
19/10/03 15:02:50 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.63.143:34123 with 4.3 GB RAM, BlockManagerId(6, 192.168.63.143, 34123, None)
19/10/03 15:02:50 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.31.107:56928) with ID 8
19/10/03 15:02:50 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.37.35:38011 with 4.3 GB RAM, BlockManagerId(10, 192.168.37.35, 38011, None)
19/10/03 15:02:50 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.26.29:38739 with 4.3 GB RAM, BlockManagerId(9, 192.168.26.29, 38739, None)
19/10/03 15:02:50 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.31.107:39917 with 4.3 GB RAM, BlockManagerId(8, 192.168.31.107, 39917, None)
19/10/03 15:02:53 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.0.109:54030) with ID 11
19/10/03 15:02:53 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.20.246:47026) with ID 13
19/10/03 15:02:53 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.46.70:42888) with ID 12
19/10/03 15:02:53 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.0.109:45471 with 4.3 GB RAM, BlockManagerId(11, 192.168.0.109, 45471, None)
19/10/03 15:02:53 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.20.246:43131 with 4.3 GB RAM, BlockManagerId(13, 192.168.20.246, 43131, None)
19/10/03 15:02:54 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.46.70:35839 with 4.3 GB RAM, BlockManagerId(12, 192.168.46.70, 35839, None)
19/10/03 15:03:02 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.45.126:40546) with ID 14
19/10/03 15:03:02 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.45.126:37631 with 4.3 GB RAM, BlockManagerId(14, 192.168.45.126, 37631, None)
19/10/03 15:03:02 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/10/03 15:03:04 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.56.247:48472) with ID 15
19/10/03 15:03:04 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.56.247:45251 with 4.3 GB RAM, BlockManagerId(15, 192.168.56.247, 45251, None)
19/10/03 15:03:05 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.8.136:40028) with ID 16
19/10/03 15:03:06 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.8.136:38461 with 4.3 GB RAM, BlockManagerId(16, 192.168.8.136, 38461, None)
19/10/03 15:03:06 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.27.51:55748) with ID 17
19/10/03 15:03:06 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.21.103:33308) with ID 20
19/10/03 15:03:06 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.27.51:35243 with 4.3 GB RAM, BlockManagerId(17, 192.168.27.51, 35243, None)
19/10/03 15:03:06 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.21.103:33551 with 4.3 GB RAM, BlockManagerId(20, 192.168.21.103, 33551, None)
19/10/03 15:03:13 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.5.173:39330) with ID 18
19/10/03 15:03:13 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.5.173:46303 with 4.3 GB RAM, BlockManagerId(18, 192.168.5.173, 46303, None)
19/10/03 15:03:14 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
19/10/03 15:03:14 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.35.135:33756) with ID 19
19/10/03 15:03:14 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.35.135:36767 with 4.3 GB RAM, BlockManagerId(19, 192.168.35.135, 36767, None)
19/10/03 15:03:14 INFO KubernetesClusterSchedulerBackend: SchedulerBackend is ready for scheduling beginning after waiting maxRegisteredResourcesWaitingTime: 30000(ms)
Only WARN
Creating temporary table catalog_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_sales.
19/10/03 15:03:15 INFO TPCDSTables: Creating temporary table catalog_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_sales.
19/10/03 15:03:21 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
Creating temporary table catalog_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_returns.
19/10/03 15:03:21 INFO TPCDSTables: Creating temporary table catalog_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_returns.
Creating temporary table inventory using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/inventory.
19/10/03 15:03:24 INFO TPCDSTables: Creating temporary table inventory using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/inventory.
Creating temporary table store_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/store_sales.
19/10/03 15:03:27 INFO TPCDSTables: Creating temporary table store_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/store_sales.
Creating temporary table store_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/store_returns.
19/10/03 15:03:30 INFO TPCDSTables: Creating temporary table store_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/store_returns.
Creating temporary table web_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/web_sales.
19/10/03 15:03:34 INFO TPCDSTables: Creating temporary table web_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/web_sales.
Creating temporary table web_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/web_returns.
19/10/03 15:03:37 INFO TPCDSTables: Creating temporary table web_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/web_returns.
Creating temporary table call_center using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/call_center.
19/10/03 15:03:38 INFO TPCDSTables: Creating temporary table call_center using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/call_center.
Creating temporary table catalog_page using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_page.
19/10/03 15:03:41 INFO TPCDSTables: Creating temporary table catalog_page using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_page.
Creating temporary table customer using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/customer.
19/10/03 15:03:44 INFO TPCDSTables: Creating temporary table customer using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/customer.
Creating temporary table customer_address using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/customer_address.
19/10/03 15:03:47 INFO TPCDSTables: Creating temporary table customer_address using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/customer_address.
Creating temporary table customer_demographics using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/customer_demographics.
19/10/03 15:03:50 INFO TPCDSTables: Creating temporary table customer_demographics using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/customer_demographics.
Creating temporary table date_dim using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/date_dim.
19/10/03 15:03:54 INFO TPCDSTables: Creating temporary table date_dim using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/date_dim.
Creating temporary table household_demographics using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/household_demographics.
19/10/03 15:03:54 INFO TPCDSTables: Creating temporary table household_demographics using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/household_demographics.
Creating temporary table income_band using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/income_band.
19/10/03 15:03:57 INFO TPCDSTables: Creating temporary table income_band using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/income_band.
Creating temporary table item using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/item.
19/10/03 15:04:00 INFO TPCDSTables: Creating temporary table item using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/item.
Creating temporary table promotion using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/promotion.
19/10/03 15:04:03 INFO TPCDSTables: Creating temporary table promotion using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/promotion.
Creating temporary table reason using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/reason.
19/10/03 15:04:06 INFO TPCDSTables: Creating temporary table reason using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/reason.
Creating temporary table ship_mode using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/ship_mode.
19/10/03 15:04:09 INFO TPCDSTables: Creating temporary table ship_mode using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/ship_mode.
Creating temporary table store using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/store.
19/10/03 15:04:11 INFO TPCDSTables: Creating temporary table store using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/store.
Creating temporary table time_dim using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/time_dim.
19/10/03 15:04:14 INFO TPCDSTables: Creating temporary table time_dim using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/time_dim.
Creating temporary table warehouse using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/warehouse.
19/10/03 15:04:17 INFO TPCDSTables: Creating temporary table warehouse using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/warehouse.
Creating temporary table web_page using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/web_page.
19/10/03 15:04:20 INFO TPCDSTables: Creating temporary table web_page using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/web_page.
Creating temporary table web_site using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/web_site.
19/10/03 15:04:23 INFO TPCDSTables: Creating temporary table web_site using data stored in s3a://spark-k8s-data/TPCDS-TEST-10T/web_site.
Couldn't read table customer_total_return and its not defined as a Benchmark.Table.
Table store exists.
Table customer exists.
Couldn't read table wswscs and its not defined as a Benchmark.Table.
Table date_dim exists.
Table store_sales exists.
Table item exists.
Couldn't read table year_total and its not defined as a Benchmark.Table.
Couldn't read table ssr and its not defined as a Benchmark.Table.
Couldn't read table csr and its not defined as a Benchmark.Table.
Couldn't read table wsr and its not defined as a Benchmark.Table.
Table customer_address exists.
Table customer_demographics exists.
Table promotion exists.
Table reason exists.
Table web_sales exists.
Table household_demographics exists.
Table catalog_sales exists.
Table call_center exists.
Table store_returns exists.
Table inventory exists.
Table warehouse exists.
Couldn't read table ssales and its not defined as a Benchmark.Table.
Couldn't read table ss and its not defined as a Benchmark.Table.
Couldn't read table ws and its not defined as a Benchmark.Table.
Couldn't read table cs and its not defined as a Benchmark.Table.
Couldn't read table inv and its not defined as a Benchmark.Table.
Table catalog_returns exists.
Couldn't read table v2 and its not defined as a Benchmark.Table.
Table web_returns exists.
Couldn't read table web_v1 and its not defined as a Benchmark.Table.
Couldn't read table store_v1 and its not defined as a Benchmark.Table.
Couldn't read table segments and its not defined as a Benchmark.Table.
Couldn't read table ss_items and its not defined as a Benchmark.Table.
Couldn't read table cs_items and its not defined as a Benchmark.Table.
Couldn't read table ws_items and its not defined as a Benchmark.Table.
Couldn't read table wss and its not defined as a Benchmark.Table.
Table ship_mode exists.
Table web_site exists.
Couldn't read table cross_sales and its not defined as a Benchmark.Table.
Table time_dim exists.
Couldn't read table all_sales and its not defined as a Benchmark.Table.
Couldn't read table sr and its not defined as a Benchmark.Table.
Couldn't read table cr and its not defined as a Benchmark.Table.
Couldn't read table wr and its not defined as a Benchmark.Table.
Couldn't read table sr_items and its not defined as a Benchmark.Table.
Couldn't read table cr_items and its not defined as a Benchmark.Table.
Couldn't read table wr_items and its not defined as a Benchmark.Table.
Table income_band exists.
Table web_page exists.
Couldn't read table ssci and its not defined as a Benchmark.Table.
Couldn't read table csci and its not defined as a Benchmark.Table.
Running execution q1-v2.4 iteration: 1, StandardRun=true
19/10/03 15:04:34 INFO Query: 
== Query: q1-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_customer_id#413 ASC NULLS FIRST], true
      +- Project [c_customer_id#413]
         +- Filter (((cast(ctr_total_return#8593 as decimal(24,7)) > cast(scalar-subquery#8590 [ctr_store_sk#8592] as decimal(24,7))) && (s_store_sk#664 = ctr_store_sk#8592)) && ((s_state#688 = TN) && (ctr_customer_sk#8591 = c_customer_sk#412)))
            :  +- Aggregate [CheckOverflow((promote_precision(cast(avg(ctr_total_return#8593) as decimal(21,6))) * promote_precision(cast(1.2 as decimal(21,6)))), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#8596]
            :     +- Filter (outer(ctr_store_sk#8592) = ctr_store_sk#8592)
            :        +- SubqueryAlias `ctr2`
            :           +- SubqueryAlias `customer_total_return`
            :              +- Aggregate [sr_customer_sk#179, sr_store_sk#183], [sr_customer_sk#179 AS ctr_customer_sk#8591, sr_store_sk#183 AS ctr_store_sk#8592, sum(sr_return_amt#187) AS ctr_total_return#8593]
            :                 +- Filter ((sr_returned_date_sk#176 = d_date_sk#492) && (d_year#498 = 2000))
            :                    +- Join Inner
            :                       :- SubqueryAlias `store_returns`
            :                       :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
            :                       +- SubqueryAlias `date_dim`
            :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ctr1`
               :  :  +- SubqueryAlias `customer_total_return`
               :  :     +- Aggregate [sr_customer_sk#179, sr_store_sk#183], [sr_customer_sk#179 AS ctr_customer_sk#8591, sr_store_sk#183 AS ctr_store_sk#8592, sum(sr_return_amt#187) AS ctr_total_return#8593]
               :  :        +- Filter ((sr_returned_date_sk#176 = d_date_sk#492) && (d_year#498 = 2000))
               :  :           +- Join Inner
               :  :              :- SubqueryAlias `store_returns`
               :  :              :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :  :              +- SubqueryAlias `date_dim`
               :  :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store`
               :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               +- SubqueryAlias `customer`
                  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/10/03 15:04:34 INFO Query: 
== Query: q1-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_customer_id#413 ASC NULLS FIRST], true
      +- Project [c_customer_id#413]
         +- Filter (((cast(ctr_total_return#8601 as decimal(24,7)) > cast(scalar-subquery#8598 [ctr_store_sk#8600] as decimal(24,7))) && (s_store_sk#664 = ctr_store_sk#8600)) && ((s_state#688 = TN) && (ctr_customer_sk#8599 = c_customer_sk#412)))
            :  +- Aggregate [CheckOverflow((promote_precision(cast(avg(ctr_total_return#8601) as decimal(21,6))) * promote_precision(cast(1.2 as decimal(21,6)))), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#8604]
            :     +- Filter (outer(ctr_store_sk#8600) = ctr_store_sk#8600)
            :        +- SubqueryAlias `ctr2`
            :           +- SubqueryAlias `customer_total_return`
            :              +- Aggregate [sr_customer_sk#179, sr_store_sk#183], [sr_customer_sk#179 AS ctr_customer_sk#8599, sr_store_sk#183 AS ctr_store_sk#8600, sum(sr_return_amt#187) AS ctr_total_return#8601]
            :                 +- Filter ((sr_returned_date_sk#176 = d_date_sk#492) && (d_year#498 = 2000))
            :                    +- Join Inner
            :                       :- SubqueryAlias `store_returns`
            :                       :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
            :                       +- SubqueryAlias `date_dim`
            :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ctr1`
               :  :  +- SubqueryAlias `customer_total_return`
               :  :     +- Aggregate [sr_customer_sk#179, sr_store_sk#183], [sr_customer_sk#179 AS ctr_customer_sk#8599, sr_store_sk#183 AS ctr_store_sk#8600, sum(sr_return_amt#187) AS ctr_total_return#8601]
               :  :        +- Filter ((sr_returned_date_sk#176 = d_date_sk#492) && (d_year#498 = 2000))
               :  :           +- Join Inner
               :  :              :- SubqueryAlias `store_returns`
               :  :              :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :  :              +- SubqueryAlias `date_dim`
               :  :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store`
               :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               +- SubqueryAlias `customer`
                  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 98.89859649s
Running execution q2-v2.4 iteration: 1, StandardRun=true
19/10/03 15:06:14 INFO Query: 
== Query: q2-v2.4 ==
Sort [d_week_seq1#8781 ASC NULLS FIRST], true
+- Project [d_week_seq1#8781, round(CheckOverflow((promote_precision(cast(sun_sales1#8782 as decimal(17,2))) / promote_precision(cast(sun_sales2#8790 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((sun_sales1 / sun_sales2), 2)#8871, round(CheckOverflow((promote_precision(cast(mon_sales1#8783 as decimal(17,2))) / promote_precision(cast(mon_sales2#8791 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((mon_sales1 / mon_sales2), 2)#8872, round(CheckOverflow((promote_precision(cast(tue_sales1#8784 as decimal(17,2))) / promote_precision(cast(tue_sales2#8792 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((tue_sales1 / tue_sales2), 2)#8873, round(CheckOverflow((promote_precision(cast(wed_sales1#8785 as decimal(17,2))) / promote_precision(cast(wed_sales2#8793 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((wed_sales1 / wed_sales2), 2)#8874, round(CheckOverflow((promote_precision(cast(thu_sales1#8786 as decimal(17,2))) / promote_precision(cast(thu_sales2#8794 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((thu_sales1 / thu_sales2), 2)#8875, round(CheckOverflow((promote_precision(cast(fri_sales1#8787 as decimal(17,2))) / promote_precision(cast(fri_sales2#8795 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((fri_sales1 / fri_sales2), 2)#8876, round(CheckOverflow((promote_precision(cast(sat_sales1#8788 as decimal(17,2))) / promote_precision(cast(sat_sales2#8796 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((sat_sales1 / sat_sales2), 2)#8877]
   +- Filter (d_week_seq1#8781 = (d_week_seq2#8789 - 53))
      +- Join Inner
         :- SubqueryAlias `y`
         :  +- Project [d_week_seq#496 AS d_week_seq1#8781, sun_sales#8801 AS sun_sales1#8782, mon_sales#8802 AS mon_sales1#8783, tue_sales#8803 AS tue_sales1#8784, wed_sales#8804 AS wed_sales1#8785, thu_sales#8805 AS thu_sales1#8786, fri_sales#8806 AS fri_sales1#8787, sat_sales#8807 AS sat_sales1#8788]
         :     +- Filter ((d_week_seq#8819 = d_week_seq#496) && (d_year#8821 = 2001))
         :        +- Join Inner
         :           :- SubqueryAlias `wswscs`
         :           :  +- Aggregate [d_week_seq#496], [d_week_seq#496, sum(CASE WHEN (d_day_name#506 = Sunday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS sun_sales#8801, sum(CASE WHEN (d_day_name#506 = Monday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS mon_sales#8802, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS tue_sales#8803, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS wed_sales#8804, sum(CASE WHEN (d_day_name#506 = Thursday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS thu_sales#8805, sum(CASE WHEN (d_day_name#506 = Friday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS fri_sales#8806, sum(CASE WHEN (d_day_name#506 = Saturday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS sat_sales#8807]
         :           :     +- Filter (d_date_sk#492 = sold_date_sk#8797)
         :           :        +- Join Inner
         :           :           :- SubqueryAlias `wscs`
         :           :           :  +- Project [sold_date_sk#8797, sales_price#8798]
         :           :           :     +- SubqueryAlias `x`
         :           :           :        +- Union
         :           :           :           :- Project [ws_sold_date_sk#216 AS sold_date_sk#8797, ws_ext_sales_price#239 AS sales_price#8798]
         :           :           :           :  +- SubqueryAlias `web_sales`
         :           :           :           :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
         :           :           :           +- Project [cs_sold_date_sk#0 AS sold_date_sk#8799, cs_ext_sales_price#23 AS sales_price#8800]
         :           :           :              +- SubqueryAlias `catalog_sales`
         :           :           :                 +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :           :           +- SubqueryAlias `date_dim`
         :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :           +- SubqueryAlias `date_dim`
         :              +- Relation[d_date_sk#8815,d_date_id#8816,d_date#8817,d_month_seq#8818,d_week_seq#8819,d_quarter_seq#8820,d_year#8821,d_dow#8822,d_moy#8823,d_dom#8824,d_qoy#8825,d_fy_year#8826,d_fy_quarter_seq#8827,d_fy_week_seq#8828,d_day_name#8829,d_quarter_name#8830,d_holiday#8831,d_weekend#8832,d_following_holiday#8833,d_first_dom#8834,d_last_dom#8835,d_same_day_ly#8836,d_same_day_lq#8837,d_current_day#8838,... 4 more fields] parquet
         +- SubqueryAlias `z`
            +- Project [d_week_seq#496 AS d_week_seq2#8789, sun_sales#8801 AS sun_sales2#8790, mon_sales#8802 AS mon_sales2#8791, tue_sales#8803 AS tue_sales2#8792, wed_sales#8804 AS wed_sales2#8793, thu_sales#8805 AS thu_sales2#8794, fri_sales#8806 AS fri_sales2#8795, sat_sales#8807 AS sat_sales2#8796]
               +- Filter ((d_week_seq#8847 = d_week_seq#496) && (d_year#8849 = (2001 + 1)))
                  +- Join Inner
                     :- SubqueryAlias `wswscs`
                     :  +- Aggregate [d_week_seq#496], [d_week_seq#496, sum(CASE WHEN (d_day_name#506 = Sunday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS sun_sales#8801, sum(CASE WHEN (d_day_name#506 = Monday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS mon_sales#8802, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS tue_sales#8803, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS wed_sales#8804, sum(CASE WHEN (d_day_name#506 = Thursday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS thu_sales#8805, sum(CASE WHEN (d_day_name#506 = Friday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS fri_sales#8806, sum(CASE WHEN (d_day_name#506 = Saturday) THEN sales_price#8798 ELSE cast(null as decimal(7,2)) END) AS sat_sales#8807]
                     :     +- Filter (d_date_sk#492 = sold_date_sk#8797)
                     :        +- Join Inner
                     :           :- SubqueryAlias `wscs`
                     :           :  +- Project [sold_date_sk#8797, sales_price#8798]
                     :           :     +- SubqueryAlias `x`
                     :           :        +- Union
                     :           :           :- Project [ws_sold_date_sk#216 AS sold_date_sk#8797, ws_ext_sales_price#239 AS sales_price#8798]
                     :           :           :  +- SubqueryAlias `web_sales`
                     :           :           :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :           :           +- Project [cs_sold_date_sk#0 AS sold_date_sk#8799, cs_ext_sales_price#23 AS sales_price#8800]
                     :           :              +- SubqueryAlias `catalog_sales`
                     :           :                 +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :           +- SubqueryAlias `date_dim`
                     :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#8843,d_date_id#8844,d_date#8845,d_month_seq#8846,d_week_seq#8847,d_quarter_seq#8848,d_year#8849,d_dow#8850,d_moy#8851,d_dom#8852,d_qoy#8853,d_fy_year#8854,d_fy_quarter_seq#8855,d_fy_week_seq#8856,d_day_name#8857,d_quarter_name#8858,d_holiday#8859,d_weekend#8860,d_following_holiday#8861,d_first_dom#8862,d_last_dom#8863,d_same_day_ly#8864,d_same_day_lq#8865,d_current_day#8866,... 4 more fields] parquet

     : benchmark
19/10/03 15:06:14 INFO Query: 
== Query: q2-v2.4 ==
Sort [d_week_seq1#8886 ASC NULLS FIRST], true
+- Project [d_week_seq1#8886, round(CheckOverflow((promote_precision(cast(sun_sales1#8887 as decimal(17,2))) / promote_precision(cast(sun_sales2#8895 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((sun_sales1 / sun_sales2), 2)#8976, round(CheckOverflow((promote_precision(cast(mon_sales1#8888 as decimal(17,2))) / promote_precision(cast(mon_sales2#8896 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((mon_sales1 / mon_sales2), 2)#8977, round(CheckOverflow((promote_precision(cast(tue_sales1#8889 as decimal(17,2))) / promote_precision(cast(tue_sales2#8897 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((tue_sales1 / tue_sales2), 2)#8978, round(CheckOverflow((promote_precision(cast(wed_sales1#8890 as decimal(17,2))) / promote_precision(cast(wed_sales2#8898 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((wed_sales1 / wed_sales2), 2)#8979, round(CheckOverflow((promote_precision(cast(thu_sales1#8891 as decimal(17,2))) / promote_precision(cast(thu_sales2#8899 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((thu_sales1 / thu_sales2), 2)#8980, round(CheckOverflow((promote_precision(cast(fri_sales1#8892 as decimal(17,2))) / promote_precision(cast(fri_sales2#8900 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((fri_sales1 / fri_sales2), 2)#8981, round(CheckOverflow((promote_precision(cast(sat_sales1#8893 as decimal(17,2))) / promote_precision(cast(sat_sales2#8901 as decimal(17,2)))), DecimalType(37,20)), 2) AS round((sat_sales1 / sat_sales2), 2)#8982]
   +- Filter (d_week_seq1#8886 = (d_week_seq2#8894 - 53))
      +- Join Inner
         :- SubqueryAlias `y`
         :  +- Project [d_week_seq#496 AS d_week_seq1#8886, sun_sales#8906 AS sun_sales1#8887, mon_sales#8907 AS mon_sales1#8888, tue_sales#8908 AS tue_sales1#8889, wed_sales#8909 AS wed_sales1#8890, thu_sales#8910 AS thu_sales1#8891, fri_sales#8911 AS fri_sales1#8892, sat_sales#8912 AS sat_sales1#8893]
         :     +- Filter ((d_week_seq#8924 = d_week_seq#496) && (d_year#8926 = 2001))
         :        +- Join Inner
         :           :- SubqueryAlias `wswscs`
         :           :  +- Aggregate [d_week_seq#496], [d_week_seq#496, sum(CASE WHEN (d_day_name#506 = Sunday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS sun_sales#8906, sum(CASE WHEN (d_day_name#506 = Monday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS mon_sales#8907, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS tue_sales#8908, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS wed_sales#8909, sum(CASE WHEN (d_day_name#506 = Thursday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS thu_sales#8910, sum(CASE WHEN (d_day_name#506 = Friday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS fri_sales#8911, sum(CASE WHEN (d_day_name#506 = Saturday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS sat_sales#8912]
         :           :     +- Filter (d_date_sk#492 = sold_date_sk#8902)
         :           :        +- Join Inner
         :           :           :- SubqueryAlias `wscs`
         :           :           :  +- Project [sold_date_sk#8902, sales_price#8903]
         :           :           :     +- SubqueryAlias `x`
         :           :           :        +- Union
         :           :           :           :- Project [ws_sold_date_sk#216 AS sold_date_sk#8902, ws_ext_sales_price#239 AS sales_price#8903]
         :           :           :           :  +- SubqueryAlias `web_sales`
         :           :           :           :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
         :           :           :           +- Project [cs_sold_date_sk#0 AS sold_date_sk#8904, cs_ext_sales_price#23 AS sales_price#8905]
         :           :           :              +- SubqueryAlias `catalog_sales`
         :           :           :                 +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :           :           +- SubqueryAlias `date_dim`
         :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :           +- SubqueryAlias `date_dim`
         :              +- Relation[d_date_sk#8920,d_date_id#8921,d_date#8922,d_month_seq#8923,d_week_seq#8924,d_quarter_seq#8925,d_year#8926,d_dow#8927,d_moy#8928,d_dom#8929,d_qoy#8930,d_fy_year#8931,d_fy_quarter_seq#8932,d_fy_week_seq#8933,d_day_name#8934,d_quarter_name#8935,d_holiday#8936,d_weekend#8937,d_following_holiday#8938,d_first_dom#8939,d_last_dom#8940,d_same_day_ly#8941,d_same_day_lq#8942,d_current_day#8943,... 4 more fields] parquet
         +- SubqueryAlias `z`
            +- Project [d_week_seq#496 AS d_week_seq2#8894, sun_sales#8906 AS sun_sales2#8895, mon_sales#8907 AS mon_sales2#8896, tue_sales#8908 AS tue_sales2#8897, wed_sales#8909 AS wed_sales2#8898, thu_sales#8910 AS thu_sales2#8899, fri_sales#8911 AS fri_sales2#8900, sat_sales#8912 AS sat_sales2#8901]
               +- Filter ((d_week_seq#8952 = d_week_seq#496) && (d_year#8954 = (2001 + 1)))
                  +- Join Inner
                     :- SubqueryAlias `wswscs`
                     :  +- Aggregate [d_week_seq#496], [d_week_seq#496, sum(CASE WHEN (d_day_name#506 = Sunday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS sun_sales#8906, sum(CASE WHEN (d_day_name#506 = Monday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS mon_sales#8907, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS tue_sales#8908, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS wed_sales#8909, sum(CASE WHEN (d_day_name#506 = Thursday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS thu_sales#8910, sum(CASE WHEN (d_day_name#506 = Friday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS fri_sales#8911, sum(CASE WHEN (d_day_name#506 = Saturday) THEN sales_price#8903 ELSE cast(null as decimal(7,2)) END) AS sat_sales#8912]
                     :     +- Filter (d_date_sk#492 = sold_date_sk#8902)
                     :        +- Join Inner
                     :           :- SubqueryAlias `wscs`
                     :           :  +- Project [sold_date_sk#8902, sales_price#8903]
                     :           :     +- SubqueryAlias `x`
                     :           :        +- Union
                     :           :           :- Project [ws_sold_date_sk#216 AS sold_date_sk#8902, ws_ext_sales_price#239 AS sales_price#8903]
                     :           :           :  +- SubqueryAlias `web_sales`
                     :           :           :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :           :           +- Project [cs_sold_date_sk#0 AS sold_date_sk#8904, cs_ext_sales_price#23 AS sales_price#8905]
                     :           :              +- SubqueryAlias `catalog_sales`
                     :           :                 +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :           +- SubqueryAlias `date_dim`
                     :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#8948,d_date_id#8949,d_date#8950,d_month_seq#8951,d_week_seq#8952,d_quarter_seq#8953,d_year#8954,d_dow#8955,d_moy#8956,d_dom#8957,d_qoy#8958,d_fy_year#8959,d_fy_quarter_seq#8960,d_fy_week_seq#8961,d_day_name#8962,d_quarter_name#8963,d_holiday#8964,d_weekend#8965,d_following_holiday#8966,d_first_dom#8967,d_last_dom#8968,d_same_day_ly#8969,d_same_day_lq#8970,d_current_day#8971,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
19/10/03 15:07:38 WARN TaskSetManager: Lost task 6294.0 in stage 37.0 (TID 11419, 192.168.42.36, executor 50): java.io.IOException: can not read FileMetaData: org.apache.hadoop.fs.s3a.AWSClientIOException: read on s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_sales/part-00764-10e4b037-4521-4ea1-80ea-c6a987fb8fc8-c000.snappy.parquet: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at org.apache.parquet.format.Util.readFileMetaData(Util.java:195)
	at org.apache.parquet.format.Util.readFileMetaData(Util.java:85)
	at org.apache.parquet.format.converter.ParquetMetadataConverter$2.visit(ParquetMetadataConverter.java:871)
	at org.apache.parquet.format.converter.ParquetMetadataConverter$2.visit(ParquetMetadataConverter.java:863)
	at org.apache.parquet.format.converter.ParquetMetadataConverter$SkipMetadataFilter.accept(ParquetMetadataConverter.java:757)
	at org.apache.parquet.format.converter.ParquetMetadataConverter.readParquetMetadata(ParquetMetadataConverter.java:863)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:532)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:505)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:499)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:448)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.footerFileMetaData$lzycompute$1(ParquetFileFormat.scala:371)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.footerFileMetaData$1(ParquetFileFormat.scala:370)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.apply(ParquetFileFormat.scala:374)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.apply(ParquetFileFormat.scala:352)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:124)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:177)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:101)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.scan_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage4.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage4.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
	Suppressed: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
		at com.amazonaws.util.LengthCheckInputStream.checkLength(LengthCheckInputStream.java:151)
		at com.amazonaws.util.LengthCheckInputStream.read(LengthCheckInputStream.java:93)
		at com.amazonaws.internal.SdkFilterInputStream.read(SdkFilterInputStream.java:76)
		at org.apache.hadoop.fs.s3a.S3AInputStream.closeStream(S3AInputStream.java:529)
		at org.apache.hadoop.fs.s3a.S3AInputStream.close(S3AInputStream.java:490)
		at java.io.FilterInputStream.close(FilterInputStream.java:181)
		at org.apache.parquet.io.DelegatingSeekableInputStream.close(DelegatingSeekableInputStream.java:50)
		at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:500)
		... 27 more
Caused by: shaded.parquet.org.apache.thrift.transport.TTransportException: org.apache.hadoop.fs.s3a.AWSClientIOException: read on s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_sales/part-00764-10e4b037-4521-4ea1-80ea-c6a987fb8fc8-c000.snappy.parquet: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at shaded.parquet.org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:129)
	at shaded.parquet.org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)
	at shaded.parquet.org.apache.thrift.protocol.TCompactProtocol.readByte(TCompactProtocol.java:634)
	at shaded.parquet.org.apache.thrift.protocol.TCompactProtocol.readFieldBegin(TCompactProtocol.java:539)
	at org.apache.parquet.format.InterningProtocol.readFieldBegin(InterningProtocol.java:158)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:108)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:138)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:112)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:112)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:138)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:112)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:138)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:60)
	at org.apache.parquet.format.event.SkippingFieldConsumer.consumeField(Consumers.java:155)
	at org.apache.parquet.format.event.Consumers$DelegatingFieldConsumer.consumeField(Consumers.java:99)
	at org.apache.parquet.format.event.EventBasedThriftReader.readStructContent(EventBasedThriftReader.java:73)
	at org.apache.parquet.format.event.EventBasedThriftReader.readStruct(EventBasedThriftReader.java:57)
	at org.apache.parquet.format.Util.readFileMetaData(Util.java:192)
	... 35 more
Caused by: org.apache.hadoop.fs.s3a.AWSClientIOException: read on s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_sales/part-00764-10e4b037-4521-4ea1-80ea-c6a987fb8fc8-c000.snappy.parquet: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at org.apache.hadoop.fs.s3a.S3AUtils.translateException(S3AUtils.java:177)
	at org.apache.hadoop.fs.s3a.Invoker.once(Invoker.java:111)
	at org.apache.hadoop.fs.s3a.Invoker.lambda$retry$3(Invoker.java:260)
	at org.apache.hadoop.fs.s3a.Invoker.retryUntranslated(Invoker.java:317)
	at org.apache.hadoop.fs.s3a.Invoker.retry(Invoker.java:256)
	at org.apache.hadoop.fs.s3a.Invoker.retry(Invoker.java:231)
	at org.apache.hadoop.fs.s3a.S3AInputStream.read(S3AInputStream.java:441)
	at java.io.DataInputStream.read(DataInputStream.java:149)
	at org.apache.parquet.io.DelegatingSeekableInputStream.read(DelegatingSeekableInputStream.java:66)
	at shaded.parquet.org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:127)
	... 52 more
Caused by: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at com.amazonaws.util.LengthCheckInputStream.checkLength(LengthCheckInputStream.java:151)
	at com.amazonaws.util.LengthCheckInputStream.read(LengthCheckInputStream.java:109)
	at com.amazonaws.internal.SdkFilterInputStream.read(SdkFilterInputStream.java:82)
	at org.apache.hadoop.fs.s3a.S3AInputStream.lambda$read$3(S3AInputStream.java:445)
	at org.apache.hadoop.fs.s3a.Invoker.once(Invoker.java:109)
	... 60 more

Execution time: 140.93035673999998s
Running execution q3-v2.4 iteration: 1, StandardRun=true
19/10/03 15:08:37 INFO Query: 
== Query: q3-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [d_year#498 ASC NULLS FIRST, sum_agg#9259 DESC NULLS LAST, brand_id#9257 ASC NULLS FIRST], true
      +- Aggregate [d_year#498, i_brand#572, i_brand_id#571], [d_year#498, i_brand_id#571 AS brand_id#9257, i_brand#572 AS brand#9258, sum(ss_ext_sales_price#145) AS sum_agg#9259]
         +- Filter (((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && ((i_manufact_id#577 = 128) && (d_moy#500 = 11)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dt`
               :  :  +- SubqueryAlias `date_dim`
               :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/03 15:08:37 INFO Query: 
== Query: q3-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [d_year#498 ASC NULLS FIRST, sum_agg#9270 DESC NULLS LAST, brand_id#9268 ASC NULLS FIRST], true
      +- Aggregate [d_year#498, i_brand#572, i_brand_id#571], [d_year#498, i_brand_id#571 AS brand_id#9268, i_brand#572 AS brand#9269, sum(ss_ext_sales_price#145) AS sum_agg#9270]
         +- Filter (((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && ((i_manufact_id#577 = 128) && (d_moy#500 = 11)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dt`
               :  :  +- SubqueryAlias `date_dim`
               :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 105.633772108s
Running execution q4-v2.4 iteration: 1, StandardRun=true
19/10/03 15:10:25 INFO Query: 
== Query: q4-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#9447 ASC NULLS FIRST, customer_first_name#9448 ASC NULLS FIRST, customer_last_name#9449 ASC NULLS FIRST, customer_preferred_cust_flag#9450 ASC NULLS FIRST], true
      +- Project [customer_id#9447, customer_first_name#9448, customer_last_name#9449, customer_preferred_cust_flag#9450]
         +- Filter ((((((customer_id#9447 = customer_id#9414) && (customer_id#9414 = customer_id#9467)) && (customer_id#9414 = customer_id#9457)) && (((customer_id#9414 = customer_id#9477) && (customer_id#9414 = customer_id#9487)) && (sale_type#9423 = s))) && ((((sale_type#9466 = c) && (sale_type#9486 = w)) && (sale_type#9456 = s)) && ((sale_type#9476 = c) && (sale_type#9496 = w)))) && (((((dyear#9421 = 2001) && (dyear#9454 = (2001 + 1))) && (dyear#9464 = 2001)) && (((dyear#9474 = (2001 + 1)) && (dyear#9484 = 2001)) && (dyear#9494 = (2001 + 1)))) && ((((cast(year_total#9422 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) && (cast(year_total#9465 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6)))) && (cast(year_total#9485 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6)))) && ((CASE WHEN (cast(year_total#9465 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9475 as decimal(24,6))) / promote_precision(cast(year_total#9465 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END > CASE WHEN (cast(year_total#9422 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9455 as decimal(24,6))) / promote_precision(cast(year_total#9422 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END) && (CASE WHEN (cast(year_total#9465 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9475 as decimal(24,6))) / promote_precision(cast(year_total#9465 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END > CASE WHEN (cast(year_total#9485 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9495 as decimal(24,6))) / promote_precision(cast(year_total#9485 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END)))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- Join Inner
               :  :  :  :- Join Inner
               :  :  :  :  :- SubqueryAlias `t_s_firstyear`
               :  :  :  :  :  +- SubqueryAlias `year_total`
               :  :  :  :  :     +- Union
               :  :  :  :  :        :- Union
               :  :  :  :  :        :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9414, c_first_name#420 AS customer_first_name#9415, c_last_name#421 AS customer_last_name#9416, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9417, c_birth_country#426 AS customer_birth_country#9418, c_login#427 AS customer_login#9419, c_email_address#428 AS customer_email_address#9420, d_year#498 AS dyear#9421, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9422, s AS sale_type#9423]
               :  :  :  :  :        :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :  :  :        :  :     +- Join Inner
               :  :  :  :  :        :  :        :- Join Inner
               :  :  :  :  :        :  :        :  :- SubqueryAlias `customer`
               :  :  :  :  :        :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :  :        :  :        :  +- SubqueryAlias `store_sales`
               :  :  :  :  :        :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  :  :        :  :        +- SubqueryAlias `date_dim`
               :  :  :  :  :        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  :        :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9424, c_first_name#420 AS customer_first_name#9425, c_last_name#421 AS customer_last_name#9426, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9427, c_birth_country#426 AS customer_birth_country#9428, c_login#427 AS customer_login#9429, c_email_address#428 AS customer_email_address#9430, d_year#498 AS dyear#9431, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9432, c AS sale_type#9433]
               :  :  :  :  :        :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :  :  :  :        :        +- Join Inner
               :  :  :  :  :        :           :- Join Inner
               :  :  :  :  :        :           :  :- SubqueryAlias `customer`
               :  :  :  :  :        :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :  :        :           :  +- SubqueryAlias `catalog_sales`
               :  :  :  :  :        :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :  :        :           +- SubqueryAlias `date_dim`
               :  :  :  :  :        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  :        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9434, c_first_name#420 AS customer_first_name#9435, c_last_name#421 AS customer_last_name#9436, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9437, c_birth_country#426 AS customer_birth_country#9438, c_login#427 AS customer_login#9439, c_email_address#428 AS customer_email_address#9440, d_year#498 AS dyear#9441, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9442, w AS sale_type#9443]
               :  :  :  :  :           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :  :  :              +- Join Inner
               :  :  :  :  :                 :- Join Inner
               :  :  :  :  :                 :  :- SubqueryAlias `customer`
               :  :  :  :  :                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :  :                 :  +- SubqueryAlias `web_sales`
               :  :  :  :  :                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :  :  :                 +- SubqueryAlias `date_dim`
               :  :  :  :  :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  +- SubqueryAlias `t_s_secyear`
               :  :  :  :     +- SubqueryAlias `year_total`
               :  :  :  :        +- Union
               :  :  :  :           :- Union
               :  :  :  :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9447, c_first_name#420 AS customer_first_name#9448, c_last_name#421 AS customer_last_name#9449, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9450, c_birth_country#426 AS customer_birth_country#9451, c_login#427 AS customer_login#9452, c_email_address#428 AS customer_email_address#9453, d_year#498 AS dyear#9454, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9455, s AS sale_type#9456]
               :  :  :  :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :  :           :  :     +- Join Inner
               :  :  :  :           :  :        :- Join Inner
               :  :  :  :           :  :        :  :- SubqueryAlias `customer`
               :  :  :  :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :           :  :        :  +- SubqueryAlias `store_sales`
               :  :  :  :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  :           :  :        +- SubqueryAlias `date_dim`
               :  :  :  :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9424, c_first_name#420 AS customer_first_name#9425, c_last_name#421 AS customer_last_name#9426, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9427, c_birth_country#426 AS customer_birth_country#9428, c_login#427 AS customer_login#9429, c_email_address#428 AS customer_email_address#9430, d_year#498 AS dyear#9431, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9432, c AS sale_type#9433]
               :  :  :  :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :  :  :           :        +- Join Inner
               :  :  :  :           :           :- Join Inner
               :  :  :  :           :           :  :- SubqueryAlias `customer`
               :  :  :  :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :           :           :  +- SubqueryAlias `catalog_sales`
               :  :  :  :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :           :           +- SubqueryAlias `date_dim`
               :  :  :  :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9434, c_first_name#420 AS customer_first_name#9435, c_last_name#421 AS customer_last_name#9436, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9437, c_birth_country#426 AS customer_birth_country#9438, c_login#427 AS customer_login#9439, c_email_address#428 AS customer_email_address#9440, d_year#498 AS dyear#9441, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9442, w AS sale_type#9443]
               :  :  :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :  :                 +- Join Inner
               :  :  :  :                    :- Join Inner
               :  :  :  :                    :  :- SubqueryAlias `customer`
               :  :  :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :                    :  +- SubqueryAlias `web_sales`
               :  :  :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :  :                    +- SubqueryAlias `date_dim`
               :  :  :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  +- SubqueryAlias `t_c_firstyear`
               :  :  :     +- SubqueryAlias `year_total`
               :  :  :        +- Union
               :  :  :           :- Union
               :  :  :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9457, c_first_name#420 AS customer_first_name#9458, c_last_name#421 AS customer_last_name#9459, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9460, c_birth_country#426 AS customer_birth_country#9461, c_login#427 AS customer_login#9462, c_email_address#428 AS customer_email_address#9463, d_year#498 AS dyear#9464, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9465, s AS sale_type#9466]
               :  :  :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :           :  :     +- Join Inner
               :  :  :           :  :        :- Join Inner
               :  :  :           :  :        :  :- SubqueryAlias `customer`
               :  :  :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :           :  :        :  +- SubqueryAlias `store_sales`
               :  :  :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :           :  :        +- SubqueryAlias `date_dim`
               :  :  :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9424, c_first_name#420 AS customer_first_name#9425, c_last_name#421 AS customer_last_name#9426, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9427, c_birth_country#426 AS customer_birth_country#9428, c_login#427 AS customer_login#9429, c_email_address#428 AS customer_email_address#9430, d_year#498 AS dyear#9431, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9432, c AS sale_type#9433]
               :  :  :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :  :           :        +- Join Inner
               :  :  :           :           :- Join Inner
               :  :  :           :           :  :- SubqueryAlias `customer`
               :  :  :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :           :           :  +- SubqueryAlias `catalog_sales`
               :  :  :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :           :           +- SubqueryAlias `date_dim`
               :  :  :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9434, c_first_name#420 AS customer_first_name#9435, c_last_name#421 AS customer_last_name#9436, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9437, c_birth_country#426 AS customer_birth_country#9438, c_login#427 AS customer_login#9439, c_email_address#428 AS customer_email_address#9440, d_year#498 AS dyear#9441, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9442, w AS sale_type#9443]
               :  :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :                 +- Join Inner
               :  :  :                    :- Join Inner
               :  :  :                    :  :- SubqueryAlias `customer`
               :  :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :                    :  +- SubqueryAlias `web_sales`
               :  :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :                    +- SubqueryAlias `date_dim`
               :  :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  +- SubqueryAlias `t_c_secyear`
               :  :     +- SubqueryAlias `year_total`
               :  :        +- Union
               :  :           :- Union
               :  :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9467, c_first_name#420 AS customer_first_name#9468, c_last_name#421 AS customer_last_name#9469, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9470, c_birth_country#426 AS customer_birth_country#9471, c_login#427 AS customer_login#9472, c_email_address#428 AS customer_email_address#9473, d_year#498 AS dyear#9474, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9475, s AS sale_type#9476]
               :  :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :           :  :     +- Join Inner
               :  :           :  :        :- Join Inner
               :  :           :  :        :  :- SubqueryAlias `customer`
               :  :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :  :        :  +- SubqueryAlias `store_sales`
               :  :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  :        +- SubqueryAlias `date_dim`
               :  :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9424, c_first_name#420 AS customer_first_name#9425, c_last_name#421 AS customer_last_name#9426, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9427, c_birth_country#426 AS customer_birth_country#9428, c_login#427 AS customer_login#9429, c_email_address#428 AS customer_email_address#9430, d_year#498 AS dyear#9431, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9432, c AS sale_type#9433]
               :  :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :           :        +- Join Inner
               :  :           :           :- Join Inner
               :  :           :           :  :- SubqueryAlias `customer`
               :  :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :           :  +- SubqueryAlias `catalog_sales`
               :  :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :           :           +- SubqueryAlias `date_dim`
               :  :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9434, c_first_name#420 AS customer_first_name#9435, c_last_name#421 AS customer_last_name#9436, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9437, c_birth_country#426 AS customer_birth_country#9438, c_login#427 AS customer_login#9439, c_email_address#428 AS customer_email_address#9440, d_year#498 AS dyear#9441, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9442, w AS sale_type#9443]
               :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :                 +- Join Inner
               :  :                    :- Join Inner
               :  :                    :  :- SubqueryAlias `customer`
               :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :                    :  +- SubqueryAlias `web_sales`
               :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :                    +- SubqueryAlias `date_dim`
               :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `t_w_firstyear`
               :     +- SubqueryAlias `year_total`
               :        +- Union
               :           :- Union
               :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9477, c_first_name#420 AS customer_first_name#9478, c_last_name#421 AS customer_last_name#9479, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9480, c_birth_country#426 AS customer_birth_country#9481, c_login#427 AS customer_login#9482, c_email_address#428 AS customer_email_address#9483, d_year#498 AS dyear#9484, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9485, s AS sale_type#9486]
               :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :           :  :     +- Join Inner
               :           :  :        :- Join Inner
               :           :  :        :  :- SubqueryAlias `customer`
               :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :  :        :  +- SubqueryAlias `store_sales`
               :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :  :        +- SubqueryAlias `date_dim`
               :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9424, c_first_name#420 AS customer_first_name#9425, c_last_name#421 AS customer_last_name#9426, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9427, c_birth_country#426 AS customer_birth_country#9428, c_login#427 AS customer_login#9429, c_email_address#428 AS customer_email_address#9430, d_year#498 AS dyear#9431, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9432, c AS sale_type#9433]
               :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :           :        +- Join Inner
               :           :           :- Join Inner
               :           :           :  :- SubqueryAlias `customer`
               :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :           :  +- SubqueryAlias `catalog_sales`
               :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :           :           +- SubqueryAlias `date_dim`
               :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9434, c_first_name#420 AS customer_first_name#9435, c_last_name#421 AS customer_last_name#9436, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9437, c_birth_country#426 AS customer_birth_country#9438, c_login#427 AS customer_login#9439, c_email_address#428 AS customer_email_address#9440, d_year#498 AS dyear#9441, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9442, w AS sale_type#9443]
               :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :                 +- Join Inner
               :                    :- Join Inner
               :                    :  :- SubqueryAlias `customer`
               :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :                    :  +- SubqueryAlias `web_sales`
               :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `t_w_secyear`
                  +- SubqueryAlias `year_total`
                     +- Union
                        :- Union
                        :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9487, c_first_name#420 AS customer_first_name#9488, c_last_name#421 AS customer_last_name#9489, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9490, c_birth_country#426 AS customer_birth_country#9491, c_login#427 AS customer_login#9492, c_email_address#428 AS customer_email_address#9493, d_year#498 AS dyear#9494, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9495, s AS sale_type#9496]
                        :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
                        :  :     +- Join Inner
                        :  :        :- Join Inner
                        :  :        :  :- SubqueryAlias `customer`
                        :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :        :  +- SubqueryAlias `store_sales`
                        :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :        +- SubqueryAlias `date_dim`
                        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9424, c_first_name#420 AS customer_first_name#9425, c_last_name#421 AS customer_last_name#9426, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9427, c_birth_country#426 AS customer_birth_country#9428, c_login#427 AS customer_login#9429, c_email_address#428 AS customer_email_address#9430, d_year#498 AS dyear#9431, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9432, c AS sale_type#9433]
                        :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
                        :        +- Join Inner
                        :           :- Join Inner
                        :           :  :- SubqueryAlias `customer`
                        :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :           :  +- SubqueryAlias `catalog_sales`
                        :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :           +- SubqueryAlias `date_dim`
                        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9434, c_first_name#420 AS customer_first_name#9435, c_last_name#421 AS customer_last_name#9436, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9437, c_birth_country#426 AS customer_birth_country#9438, c_login#427 AS customer_login#9439, c_email_address#428 AS customer_email_address#9440, d_year#498 AS dyear#9441, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9442, w AS sale_type#9443]
                           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `customer`
                                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                                 :  +- SubqueryAlias `web_sales`
                                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/03 15:10:25 INFO Query: 
== Query: q4-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#9534 ASC NULLS FIRST, customer_first_name#9535 ASC NULLS FIRST, customer_last_name#9536 ASC NULLS FIRST, customer_preferred_cust_flag#9537 ASC NULLS FIRST], true
      +- Project [customer_id#9534, customer_first_name#9535, customer_last_name#9536, customer_preferred_cust_flag#9537]
         +- Filter ((((((customer_id#9534 = customer_id#9501) && (customer_id#9501 = customer_id#9554)) && (customer_id#9501 = customer_id#9544)) && (((customer_id#9501 = customer_id#9564) && (customer_id#9501 = customer_id#9574)) && (sale_type#9510 = s))) && ((((sale_type#9553 = c) && (sale_type#9573 = w)) && (sale_type#9543 = s)) && ((sale_type#9563 = c) && (sale_type#9583 = w)))) && (((((dyear#9508 = 2001) && (dyear#9541 = (2001 + 1))) && (dyear#9551 = 2001)) && (((dyear#9561 = (2001 + 1)) && (dyear#9571 = 2001)) && (dyear#9581 = (2001 + 1)))) && ((((cast(year_total#9509 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) && (cast(year_total#9552 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6)))) && (cast(year_total#9572 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6)))) && ((CASE WHEN (cast(year_total#9552 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9562 as decimal(24,6))) / promote_precision(cast(year_total#9552 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END > CASE WHEN (cast(year_total#9509 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9542 as decimal(24,6))) / promote_precision(cast(year_total#9509 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END) && (CASE WHEN (cast(year_total#9552 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9562 as decimal(24,6))) / promote_precision(cast(year_total#9552 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END > CASE WHEN (cast(year_total#9572 as decimal(24,6)) > cast(cast(0 as decimal(1,0)) as decimal(24,6))) THEN CheckOverflow((promote_precision(cast(year_total#9582 as decimal(24,6))) / promote_precision(cast(year_total#9572 as decimal(24,6)))), DecimalType(38,14)) ELSE cast(null as decimal(38,14)) END)))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- Join Inner
               :  :  :  :- Join Inner
               :  :  :  :  :- SubqueryAlias `t_s_firstyear`
               :  :  :  :  :  +- SubqueryAlias `year_total`
               :  :  :  :  :     +- Union
               :  :  :  :  :        :- Union
               :  :  :  :  :        :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9501, c_first_name#420 AS customer_first_name#9502, c_last_name#421 AS customer_last_name#9503, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9504, c_birth_country#426 AS customer_birth_country#9505, c_login#427 AS customer_login#9506, c_email_address#428 AS customer_email_address#9507, d_year#498 AS dyear#9508, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9509, s AS sale_type#9510]
               :  :  :  :  :        :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :  :  :        :  :     +- Join Inner
               :  :  :  :  :        :  :        :- Join Inner
               :  :  :  :  :        :  :        :  :- SubqueryAlias `customer`
               :  :  :  :  :        :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :  :        :  :        :  +- SubqueryAlias `store_sales`
               :  :  :  :  :        :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  :  :        :  :        +- SubqueryAlias `date_dim`
               :  :  :  :  :        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  :        :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9511, c_first_name#420 AS customer_first_name#9512, c_last_name#421 AS customer_last_name#9513, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9514, c_birth_country#426 AS customer_birth_country#9515, c_login#427 AS customer_login#9516, c_email_address#428 AS customer_email_address#9517, d_year#498 AS dyear#9518, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9519, c AS sale_type#9520]
               :  :  :  :  :        :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :  :  :  :        :        +- Join Inner
               :  :  :  :  :        :           :- Join Inner
               :  :  :  :  :        :           :  :- SubqueryAlias `customer`
               :  :  :  :  :        :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :  :        :           :  +- SubqueryAlias `catalog_sales`
               :  :  :  :  :        :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :  :        :           +- SubqueryAlias `date_dim`
               :  :  :  :  :        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  :        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9521, c_first_name#420 AS customer_first_name#9522, c_last_name#421 AS customer_last_name#9523, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9524, c_birth_country#426 AS customer_birth_country#9525, c_login#427 AS customer_login#9526, c_email_address#428 AS customer_email_address#9527, d_year#498 AS dyear#9528, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9529, w AS sale_type#9530]
               :  :  :  :  :           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :  :  :              +- Join Inner
               :  :  :  :  :                 :- Join Inner
               :  :  :  :  :                 :  :- SubqueryAlias `customer`
               :  :  :  :  :                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :  :                 :  +- SubqueryAlias `web_sales`
               :  :  :  :  :                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :  :  :                 +- SubqueryAlias `date_dim`
               :  :  :  :  :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  +- SubqueryAlias `t_s_secyear`
               :  :  :  :     +- SubqueryAlias `year_total`
               :  :  :  :        +- Union
               :  :  :  :           :- Union
               :  :  :  :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9534, c_first_name#420 AS customer_first_name#9535, c_last_name#421 AS customer_last_name#9536, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9537, c_birth_country#426 AS customer_birth_country#9538, c_login#427 AS customer_login#9539, c_email_address#428 AS customer_email_address#9540, d_year#498 AS dyear#9541, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9542, s AS sale_type#9543]
               :  :  :  :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :  :           :  :     +- Join Inner
               :  :  :  :           :  :        :- Join Inner
               :  :  :  :           :  :        :  :- SubqueryAlias `customer`
               :  :  :  :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :           :  :        :  +- SubqueryAlias `store_sales`
               :  :  :  :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  :           :  :        +- SubqueryAlias `date_dim`
               :  :  :  :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9511, c_first_name#420 AS customer_first_name#9512, c_last_name#421 AS customer_last_name#9513, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9514, c_birth_country#426 AS customer_birth_country#9515, c_login#427 AS customer_login#9516, c_email_address#428 AS customer_email_address#9517, d_year#498 AS dyear#9518, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9519, c AS sale_type#9520]
               :  :  :  :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :  :  :           :        +- Join Inner
               :  :  :  :           :           :- Join Inner
               :  :  :  :           :           :  :- SubqueryAlias `customer`
               :  :  :  :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :           :           :  +- SubqueryAlias `catalog_sales`
               :  :  :  :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :           :           +- SubqueryAlias `date_dim`
               :  :  :  :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9521, c_first_name#420 AS customer_first_name#9522, c_last_name#421 AS customer_last_name#9523, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9524, c_birth_country#426 AS customer_birth_country#9525, c_login#427 AS customer_login#9526, c_email_address#428 AS customer_email_address#9527, d_year#498 AS dyear#9528, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9529, w AS sale_type#9530]
               :  :  :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :  :                 +- Join Inner
               :  :  :  :                    :- Join Inner
               :  :  :  :                    :  :- SubqueryAlias `customer`
               :  :  :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :  :                    :  +- SubqueryAlias `web_sales`
               :  :  :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :  :                    +- SubqueryAlias `date_dim`
               :  :  :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  +- SubqueryAlias `t_c_firstyear`
               :  :  :     +- SubqueryAlias `year_total`
               :  :  :        +- Union
               :  :  :           :- Union
               :  :  :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9544, c_first_name#420 AS customer_first_name#9545, c_last_name#421 AS customer_last_name#9546, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9547, c_birth_country#426 AS customer_birth_country#9548, c_login#427 AS customer_login#9549, c_email_address#428 AS customer_email_address#9550, d_year#498 AS dyear#9551, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9552, s AS sale_type#9553]
               :  :  :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :           :  :     +- Join Inner
               :  :  :           :  :        :- Join Inner
               :  :  :           :  :        :  :- SubqueryAlias `customer`
               :  :  :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :           :  :        :  +- SubqueryAlias `store_sales`
               :  :  :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :           :  :        +- SubqueryAlias `date_dim`
               :  :  :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9511, c_first_name#420 AS customer_first_name#9512, c_last_name#421 AS customer_last_name#9513, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9514, c_birth_country#426 AS customer_birth_country#9515, c_login#427 AS customer_login#9516, c_email_address#428 AS customer_email_address#9517, d_year#498 AS dyear#9518, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9519, c AS sale_type#9520]
               :  :  :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :  :           :        +- Join Inner
               :  :  :           :           :- Join Inner
               :  :  :           :           :  :- SubqueryAlias `customer`
               :  :  :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :           :           :  +- SubqueryAlias `catalog_sales`
               :  :  :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :           :           +- SubqueryAlias `date_dim`
               :  :  :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9521, c_first_name#420 AS customer_first_name#9522, c_last_name#421 AS customer_last_name#9523, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9524, c_birth_country#426 AS customer_birth_country#9525, c_login#427 AS customer_login#9526, c_email_address#428 AS customer_email_address#9527, d_year#498 AS dyear#9528, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9529, w AS sale_type#9530]
               :  :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :                 +- Join Inner
               :  :  :                    :- Join Inner
               :  :  :                    :  :- SubqueryAlias `customer`
               :  :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :                    :  +- SubqueryAlias `web_sales`
               :  :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :                    +- SubqueryAlias `date_dim`
               :  :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  +- SubqueryAlias `t_c_secyear`
               :  :     +- SubqueryAlias `year_total`
               :  :        +- Union
               :  :           :- Union
               :  :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9554, c_first_name#420 AS customer_first_name#9555, c_last_name#421 AS customer_last_name#9556, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9557, c_birth_country#426 AS customer_birth_country#9558, c_login#427 AS customer_login#9559, c_email_address#428 AS customer_email_address#9560, d_year#498 AS dyear#9561, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9562, s AS sale_type#9563]
               :  :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :           :  :     +- Join Inner
               :  :           :  :        :- Join Inner
               :  :           :  :        :  :- SubqueryAlias `customer`
               :  :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :  :        :  +- SubqueryAlias `store_sales`
               :  :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  :        +- SubqueryAlias `date_dim`
               :  :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9511, c_first_name#420 AS customer_first_name#9512, c_last_name#421 AS customer_last_name#9513, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9514, c_birth_country#426 AS customer_birth_country#9515, c_login#427 AS customer_login#9516, c_email_address#428 AS customer_email_address#9517, d_year#498 AS dyear#9518, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9519, c AS sale_type#9520]
               :  :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :  :           :        +- Join Inner
               :  :           :           :- Join Inner
               :  :           :           :  :- SubqueryAlias `customer`
               :  :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :           :  +- SubqueryAlias `catalog_sales`
               :  :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :           :           +- SubqueryAlias `date_dim`
               :  :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9521, c_first_name#420 AS customer_first_name#9522, c_last_name#421 AS customer_last_name#9523, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9524, c_birth_country#426 AS customer_birth_country#9525, c_login#427 AS customer_login#9526, c_email_address#428 AS customer_email_address#9527, d_year#498 AS dyear#9528, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9529, w AS sale_type#9530]
               :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :                 +- Join Inner
               :  :                    :- Join Inner
               :  :                    :  :- SubqueryAlias `customer`
               :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :                    :  +- SubqueryAlias `web_sales`
               :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :                    +- SubqueryAlias `date_dim`
               :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `t_w_firstyear`
               :     +- SubqueryAlias `year_total`
               :        +- Union
               :           :- Union
               :           :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9564, c_first_name#420 AS customer_first_name#9565, c_last_name#421 AS customer_last_name#9566, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9567, c_birth_country#426 AS customer_birth_country#9568, c_login#427 AS customer_login#9569, c_email_address#428 AS customer_email_address#9570, d_year#498 AS dyear#9571, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9572, s AS sale_type#9573]
               :           :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :           :  :     +- Join Inner
               :           :  :        :- Join Inner
               :           :  :        :  :- SubqueryAlias `customer`
               :           :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :  :        :  +- SubqueryAlias `store_sales`
               :           :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :  :        +- SubqueryAlias `date_dim`
               :           :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9511, c_first_name#420 AS customer_first_name#9512, c_last_name#421 AS customer_last_name#9513, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9514, c_birth_country#426 AS customer_birth_country#9515, c_login#427 AS customer_login#9516, c_email_address#428 AS customer_email_address#9517, d_year#498 AS dyear#9518, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9519, c AS sale_type#9520]
               :           :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
               :           :        +- Join Inner
               :           :           :- Join Inner
               :           :           :  :- SubqueryAlias `customer`
               :           :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :           :  +- SubqueryAlias `catalog_sales`
               :           :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :           :           +- SubqueryAlias `date_dim`
               :           :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9521, c_first_name#420 AS customer_first_name#9522, c_last_name#421 AS customer_last_name#9523, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9524, c_birth_country#426 AS customer_birth_country#9525, c_login#427 AS customer_login#9526, c_email_address#428 AS customer_email_address#9527, d_year#498 AS dyear#9528, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9529, w AS sale_type#9530]
               :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :                 +- Join Inner
               :                    :- Join Inner
               :                    :  :- SubqueryAlias `customer`
               :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :                    :  +- SubqueryAlias `web_sales`
               :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `t_w_secyear`
                  +- SubqueryAlias `year_total`
                     +- Union
                        :- Union
                        :  :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9574, c_first_name#420 AS customer_first_name#9575, c_last_name#421 AS customer_last_name#9576, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9577, c_birth_country#426 AS customer_birth_country#9578, c_login#427 AS customer_login#9579, c_email_address#428 AS customer_email_address#9580, d_year#498 AS dyear#9581, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_wholesale_cost#146 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ss_ext_sales_price#145 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9582, s AS sale_type#9583]
                        :  :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
                        :  :     +- Join Inner
                        :  :        :- Join Inner
                        :  :        :  :- SubqueryAlias `customer`
                        :  :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :        :  +- SubqueryAlias `store_sales`
                        :  :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :        +- SubqueryAlias `date_dim`
                        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9511, c_first_name#420 AS customer_first_name#9512, c_last_name#421 AS customer_last_name#9513, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9514, c_birth_country#426 AS customer_birth_country#9515, c_login#427 AS customer_login#9516, c_email_address#428 AS customer_email_address#9517, d_year#498 AS dyear#9518, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_ext_list_price#25 as decimal(8,2))) - promote_precision(cast(cs_ext_wholesale_cost#24 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(cs_ext_discount_amt#22 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(cs_ext_sales_price#23 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9519, c AS sale_type#9520]
                        :     +- Filter ((c_customer_sk#412 = cs_bill_customer_sk#3) && (cs_sold_date_sk#0 = d_date_sk#492))
                        :        +- Join Inner
                        :           :- Join Inner
                        :           :  :- SubqueryAlias `customer`
                        :           :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :           :  +- SubqueryAlias `catalog_sales`
                        :           :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :           +- SubqueryAlias `date_dim`
                        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#9521, c_first_name#420 AS customer_first_name#9522, c_last_name#421 AS customer_last_name#9523, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#9524, c_birth_country#426 AS customer_birth_country#9525, c_login#427 AS customer_login#9526, c_email_address#428 AS customer_email_address#9527, d_year#498 AS dyear#9528, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_wholesale_cost#240 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(9,2)))), DecimalType(9,2)) as decimal(10,2))) + promote_precision(cast(ws_ext_sales_price#239 as decimal(10,2)))), DecimalType(10,2)) as decimal(10,2))) / promote_precision(cast(cast(2 as decimal(1,0)) as decimal(10,2)))), DecimalType(14,6))) AS year_total#9529, w AS sale_type#9530]
                           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `customer`
                                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                                 :  +- SubqueryAlias `web_sales`
                                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 3450.169137807s
Running execution q5-v2.4 iteration: 1, StandardRun=true
19/10/03 16:07:58 INFO Query: 
== Query: q5-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#9985 ASC NULLS FIRST, id#9986 ASC NULLS FIRST], true
      +- Aggregate [channel#9985, id#9986, spark_grouping_id#9982], [channel#9985, id#9986, sum(sales#9931) AS sales#9916, sum(returns#9933) AS returns#9917, sum(profit#9909) AS profit#9918]
         +- Expand [List(channel#9907, id#9908, sales#9931, returns#9933, profit#9909, channel#9983, id#9984, 0), List(channel#9907, id#9908, sales#9931, returns#9933, profit#9909, channel#9983, null, 1), List(channel#9907, id#9908, sales#9931, returns#9933, profit#9909, null, null, 3)], [channel#9907, id#9908, sales#9931, returns#9933, profit#9909, channel#9985, id#9986, spark_grouping_id#9982]
            +- Project [channel#9907, id#9908, sales#9931, returns#9933, profit#9909, channel#9907 AS channel#9983, id#9908 AS id#9984]
               +- SubqueryAlias `x`
                  +- Union
                     :- Union
                     :  :- Project [store channel AS channel#9907, concat(store, s_store_id#665) AS id#9908, sales#9931, returns#9933, CheckOverflow((promote_precision(cast(profit#9932 as decimal(18,2))) - promote_precision(cast(profit_loss#9934 as decimal(18,2)))), DecimalType(18,2)) AS profit#9909]
                     :  :  +- SubqueryAlias `ssr`
                     :  :     +- Aggregate [s_store_id#665], [s_store_id#665, sum(sales_price#9921) AS sales#9931, sum(profit#9922) AS profit#9932, sum(return_amt#9923) AS returns#9933, sum(net_loss#9924) AS profit_loss#9934]
                     :  :        +- Filter (((date_sk#9920 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 2 weeks as date)))) && (store_sk#9919 = s_store_sk#664))
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- SubqueryAlias `salesreturns`
                     :  :              :  :  +- Union
                     :  :              :  :     :- Project [ss_store_sk#137 AS store_sk#9919, ss_sold_date_sk#130 AS date_sk#9920, ss_ext_sales_price#145 AS sales_price#9921, ss_net_profit#152 AS profit#9922, cast(0 as decimal(7,2)) AS return_amt#9923, cast(0 as decimal(7,2)) AS net_loss#9924]
                     :  :              :  :     :  +- SubqueryAlias `store_sales`
                     :  :              :  :     :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :              :  :     +- Project [sr_store_sk#183 AS store_sk#9925, sr_returned_date_sk#176 AS date_sk#9926, cast(0 as decimal(7,2)) AS sales_price#9927, cast(0 as decimal(7,2)) AS profit#9928, sr_return_amt#187 AS return_amt#9929, sr_net_loss#195 AS net_loss#9930]
                     :  :              :  :        +- SubqueryAlias `store_returns`
                     :  :              :  :           +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :              :  +- SubqueryAlias `date_dim`
                     :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :              +- SubqueryAlias `store`
                     :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  +- Project [catalog channel AS channel#9910, concat(catalog_page, cp_catalog_page_id#395) AS id#9911, sales#9947, returns#9949, CheckOverflow((promote_precision(cast(profit#9948 as decimal(18,2))) - promote_precision(cast(profit_loss#9950 as decimal(18,2)))), DecimalType(18,2)) AS profit#9912]
                     :     +- SubqueryAlias `csr`
                     :        +- Aggregate [cp_catalog_page_id#395], [cp_catalog_page_id#395, sum(sales_price#9937) AS sales#9947, sum(profit#9938) AS profit#9948, sum(return_amt#9939) AS returns#9949, sum(net_loss#9940) AS profit_loss#9950]
                     :           +- Filter (((date_sk#9936 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 2 weeks as date)))) && (page_sk#9935 = cp_catalog_page_sk#394))
                     :              +- Join Inner
                     :                 :- Join Inner
                     :                 :  :- SubqueryAlias `salesreturns`
                     :                 :  :  +- Union
                     :                 :  :     :- Project [cs_catalog_page_sk#12 AS page_sk#9935, cs_sold_date_sk#0 AS date_sk#9936, cs_ext_sales_price#23 AS sales_price#9937, cs_net_profit#33 AS profit#9938, cast(0 as decimal(7,2)) AS return_amt#9939, cast(0 as decimal(7,2)) AS net_loss#9940]
                     :                 :  :     :  +- SubqueryAlias `catalog_sales`
                     :                 :  :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :                 :  :     +- Project [cr_catalog_page_sk#80 AS page_sk#9941, cr_returned_date_sk#68 AS date_sk#9942, cast(0 as decimal(7,2)) AS sales_price#9943, cast(0 as decimal(7,2)) AS profit#9944, cr_return_amount#86 AS return_amt#9945, cr_net_loss#94 AS net_loss#9946]
                     :                 :  :        +- SubqueryAlias `catalog_returns`
                     :                 :  :           +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                     :                 :  +- SubqueryAlias `date_dim`
                     :                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :                 +- SubqueryAlias `catalog_page`
                     :                    +- Relation[cp_catalog_page_sk#394,cp_catalog_page_id#395,cp_start_date_sk#396,cp_end_date_sk#397,cp_department#398,cp_catalog_number#399,cp_catalog_page_number#400,cp_description#401,cp_type#402] parquet
                     +- Project [web channel AS channel#9913, concat(web_site, web_site_id#799) AS id#9914, sales#9963, returns#9965, CheckOverflow((promote_precision(cast(profit#9964 as decimal(18,2))) - promote_precision(cast(profit_loss#9966 as decimal(18,2)))), DecimalType(18,2)) AS profit#9915]
                        +- SubqueryAlias `wsr`
                           +- Aggregate [web_site_id#799], [web_site_id#799, sum(sales_price#9953) AS sales#9963, sum(profit#9954) AS profit#9964, sum(return_amt#9955) AS returns#9965, sum(net_loss#9956) AS profit_loss#9966]
                              +- Filter (((date_sk#9952 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 2 weeks as date)))) && (wsr_web_site_sk#9951 = web_site_sk#798))
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- SubqueryAlias `salesreturns`
                                    :  :  +- Union
                                    :  :     :- Project [ws_web_site_sk#229 AS wsr_web_site_sk#9951, ws_sold_date_sk#216 AS date_sk#9952, ws_ext_sales_price#239 AS sales_price#9953, ws_net_profit#249 AS profit#9954, cast(0 as decimal(7,2)) AS return_amt#9955, cast(0 as decimal(7,2)) AS net_loss#9956]
                                    :  :     :  +- SubqueryAlias `web_sales`
                                    :  :     :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  :     +- Project [ws_web_site_sk#229 AS wsr_web_site_sk#9957, wr_returned_date_sk#284 AS date_sk#9958, cast(0 as decimal(7,2)) AS sales_price#9959, cast(0 as decimal(7,2)) AS profit#9960, wr_return_amt#299 AS return_amt#9961, wr_net_loss#307 AS net_loss#9962]
                                    :  :        +- Join LeftOuter, ((wr_item_sk#286 = ws_item_sk#219) && (wr_order_number#297L = ws_order_number#233L))
                                    :  :           :- SubqueryAlias `web_returns`
                                    :  :           :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                                    :  :           +- SubqueryAlias `web_sales`
                                    :  :              +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  +- SubqueryAlias `date_dim`
                                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                    +- SubqueryAlias `web_site`
                                       +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet

     : benchmark
19/10/03 16:07:58 INFO Query: 
== Query: q5-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#10072 ASC NULLS FIRST, id#10073 ASC NULLS FIRST], true
      +- Aggregate [channel#10072, id#10073, spark_grouping_id#10069], [channel#10072, id#10073, sum(sales#10018) AS sales#10003, sum(returns#10020) AS returns#10004, sum(profit#9996) AS profit#10005]
         +- Expand [List(channel#9994, id#9995, sales#10018, returns#10020, profit#9996, channel#10070, id#10071, 0), List(channel#9994, id#9995, sales#10018, returns#10020, profit#9996, channel#10070, null, 1), List(channel#9994, id#9995, sales#10018, returns#10020, profit#9996, null, null, 3)], [channel#9994, id#9995, sales#10018, returns#10020, profit#9996, channel#10072, id#10073, spark_grouping_id#10069]
            +- Project [channel#9994, id#9995, sales#10018, returns#10020, profit#9996, channel#9994 AS channel#10070, id#9995 AS id#10071]
               +- SubqueryAlias `x`
                  +- Union
                     :- Union
                     :  :- Project [store channel AS channel#9994, concat(store, s_store_id#665) AS id#9995, sales#10018, returns#10020, CheckOverflow((promote_precision(cast(profit#10019 as decimal(18,2))) - promote_precision(cast(profit_loss#10021 as decimal(18,2)))), DecimalType(18,2)) AS profit#9996]
                     :  :  +- SubqueryAlias `ssr`
                     :  :     +- Aggregate [s_store_id#665], [s_store_id#665, sum(sales_price#10008) AS sales#10018, sum(profit#10009) AS profit#10019, sum(return_amt#10010) AS returns#10020, sum(net_loss#10011) AS profit_loss#10021]
                     :  :        +- Filter (((date_sk#10007 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 2 weeks as date)))) && (store_sk#10006 = s_store_sk#664))
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- SubqueryAlias `salesreturns`
                     :  :              :  :  +- Union
                     :  :              :  :     :- Project [ss_store_sk#137 AS store_sk#10006, ss_sold_date_sk#130 AS date_sk#10007, ss_ext_sales_price#145 AS sales_price#10008, ss_net_profit#152 AS profit#10009, cast(0 as decimal(7,2)) AS return_amt#10010, cast(0 as decimal(7,2)) AS net_loss#10011]
                     :  :              :  :     :  +- SubqueryAlias `store_sales`
                     :  :              :  :     :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :              :  :     +- Project [sr_store_sk#183 AS store_sk#10012, sr_returned_date_sk#176 AS date_sk#10013, cast(0 as decimal(7,2)) AS sales_price#10014, cast(0 as decimal(7,2)) AS profit#10015, sr_return_amt#187 AS return_amt#10016, sr_net_loss#195 AS net_loss#10017]
                     :  :              :  :        +- SubqueryAlias `store_returns`
                     :  :              :  :           +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :              :  +- SubqueryAlias `date_dim`
                     :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :              +- SubqueryAlias `store`
                     :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  +- Project [catalog channel AS channel#9997, concat(catalog_page, cp_catalog_page_id#395) AS id#9998, sales#10034, returns#10036, CheckOverflow((promote_precision(cast(profit#10035 as decimal(18,2))) - promote_precision(cast(profit_loss#10037 as decimal(18,2)))), DecimalType(18,2)) AS profit#9999]
                     :     +- SubqueryAlias `csr`
                     :        +- Aggregate [cp_catalog_page_id#395], [cp_catalog_page_id#395, sum(sales_price#10024) AS sales#10034, sum(profit#10025) AS profit#10035, sum(return_amt#10026) AS returns#10036, sum(net_loss#10027) AS profit_loss#10037]
                     :           +- Filter (((date_sk#10023 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 2 weeks as date)))) && (page_sk#10022 = cp_catalog_page_sk#394))
                     :              +- Join Inner
                     :                 :- Join Inner
                     :                 :  :- SubqueryAlias `salesreturns`
                     :                 :  :  +- Union
                     :                 :  :     :- Project [cs_catalog_page_sk#12 AS page_sk#10022, cs_sold_date_sk#0 AS date_sk#10023, cs_ext_sales_price#23 AS sales_price#10024, cs_net_profit#33 AS profit#10025, cast(0 as decimal(7,2)) AS return_amt#10026, cast(0 as decimal(7,2)) AS net_loss#10027]
                     :                 :  :     :  +- SubqueryAlias `catalog_sales`
                     :                 :  :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :                 :  :     +- Project [cr_catalog_page_sk#80 AS page_sk#10028, cr_returned_date_sk#68 AS date_sk#10029, cast(0 as decimal(7,2)) AS sales_price#10030, cast(0 as decimal(7,2)) AS profit#10031, cr_return_amount#86 AS return_amt#10032, cr_net_loss#94 AS net_loss#10033]
                     :                 :  :        +- SubqueryAlias `catalog_returns`
                     :                 :  :           +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                     :                 :  +- SubqueryAlias `date_dim`
                     :                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :                 +- SubqueryAlias `catalog_page`
                     :                    +- Relation[cp_catalog_page_sk#394,cp_catalog_page_id#395,cp_start_date_sk#396,cp_end_date_sk#397,cp_department#398,cp_catalog_number#399,cp_catalog_page_number#400,cp_description#401,cp_type#402] parquet
                     +- Project [web channel AS channel#10000, concat(web_site, web_site_id#799) AS id#10001, sales#10050, returns#10052, CheckOverflow((promote_precision(cast(profit#10051 as decimal(18,2))) - promote_precision(cast(profit_loss#10053 as decimal(18,2)))), DecimalType(18,2)) AS profit#10002]
                        +- SubqueryAlias `wsr`
                           +- Aggregate [web_site_id#799], [web_site_id#799, sum(sales_price#10040) AS sales#10050, sum(profit#10041) AS profit#10051, sum(return_amt#10042) AS returns#10052, sum(net_loss#10043) AS profit_loss#10053]
                              +- Filter (((date_sk#10039 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 2 weeks as date)))) && (wsr_web_site_sk#10038 = web_site_sk#798))
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- SubqueryAlias `salesreturns`
                                    :  :  +- Union
                                    :  :     :- Project [ws_web_site_sk#229 AS wsr_web_site_sk#10038, ws_sold_date_sk#216 AS date_sk#10039, ws_ext_sales_price#239 AS sales_price#10040, ws_net_profit#249 AS profit#10041, cast(0 as decimal(7,2)) AS return_amt#10042, cast(0 as decimal(7,2)) AS net_loss#10043]
                                    :  :     :  +- SubqueryAlias `web_sales`
                                    :  :     :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  :     +- Project [ws_web_site_sk#229 AS wsr_web_site_sk#10044, wr_returned_date_sk#284 AS date_sk#10045, cast(0 as decimal(7,2)) AS sales_price#10046, cast(0 as decimal(7,2)) AS profit#10047, wr_return_amt#299 AS return_amt#10048, wr_net_loss#307 AS net_loss#10049]
                                    :  :        +- Join LeftOuter, ((wr_item_sk#286 = ws_item_sk#219) && (wr_order_number#297L = ws_order_number#233L))
                                    :  :           :- SubqueryAlias `web_returns`
                                    :  :           :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                                    :  :           +- SubqueryAlias `web_sales`
                                    :  :              +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  +- SubqueryAlias `date_dim`
                                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                    +- SubqueryAlias `web_site`
                                       +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 568.9026054689999s
Running execution q6-v2.4 iteration: 1, StandardRun=true
19/10/03 16:17:29 INFO Query: 
== Query: q6-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cnt#10307L ASC NULLS FIRST], true
      +- Project [state#10306, cnt#10307L]
         +- Filter (cnt#10307L >= cast(10 as bigint))
            +- SubqueryAlias `x`
               +- Aggregate [ca_state#456], [ca_state#456 AS state#10306, count(1) AS cnt#10307L]
                  +- Filter ((((ca_address_sk#448 = c_current_addr_sk#416) && (c_customer_sk#412 = ss_customer_sk#133)) && (ss_sold_date_sk#130 = d_date_sk#492)) && (((ss_item_sk#132 = i_item_sk#564) && (d_month_seq#495 = scalar-subquery#10308 [])) && (cast(i_current_price#569 as decimal(14,7)) > cast(CheckOverflow((promote_precision(cast(1.2 as decimal(11,6))) * promote_precision(cast(scalar-subquery#10309 [i_category#576] as decimal(11,6)))), DecimalType(14,7)) as decimal(14,7)))))
                     :  :- Distinct
                     :  :  +- Project [d_month_seq#495]
                     :  :     +- Filter ((d_year#498 = 2001) && (d_moy#500 = 1))
                     :  :        +- SubqueryAlias `date_dim`
                     :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- Aggregate [avg(i_current_price#569) AS avg(i_current_price)#10312]
                     :     +- Filter (i_category#576 = outer(i_category#576))
                     :        +- SubqueryAlias `j`
                     :           +- SubqueryAlias `item`
                     :              +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- SubqueryAlias `a`
                        :  :  :  :  +- SubqueryAlias `customer_address`
                        :  :  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `c`
                        :  :  :     +- SubqueryAlias `customer`
                        :  :  :        +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  +- SubqueryAlias `s`
                        :  :     +- SubqueryAlias `store_sales`
                        :  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  +- SubqueryAlias `d`
                        :     +- SubqueryAlias `date_dim`
                        :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- SubqueryAlias `i`
                           +- SubqueryAlias `item`
                              +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/03 16:17:29 INFO Query: 
== Query: q6-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cnt#10316L ASC NULLS FIRST], true
      +- Project [state#10315, cnt#10316L]
         +- Filter (cnt#10316L >= cast(10 as bigint))
            +- SubqueryAlias `x`
               +- Aggregate [ca_state#456], [ca_state#456 AS state#10315, count(1) AS cnt#10316L]
                  +- Filter ((((ca_address_sk#448 = c_current_addr_sk#416) && (c_customer_sk#412 = ss_customer_sk#133)) && (ss_sold_date_sk#130 = d_date_sk#492)) && (((ss_item_sk#132 = i_item_sk#564) && (d_month_seq#495 = scalar-subquery#10317 [])) && (cast(i_current_price#569 as decimal(14,7)) > cast(CheckOverflow((promote_precision(cast(1.2 as decimal(11,6))) * promote_precision(cast(scalar-subquery#10318 [i_category#576] as decimal(11,6)))), DecimalType(14,7)) as decimal(14,7)))))
                     :  :- Distinct
                     :  :  +- Project [d_month_seq#495]
                     :  :     +- Filter ((d_year#498 = 2001) && (d_moy#500 = 1))
                     :  :        +- SubqueryAlias `date_dim`
                     :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- Aggregate [avg(i_current_price#569) AS avg(i_current_price)#10321]
                     :     +- Filter (i_category#576 = outer(i_category#576))
                     :        +- SubqueryAlias `j`
                     :           +- SubqueryAlias `item`
                     :              +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- SubqueryAlias `a`
                        :  :  :  :  +- SubqueryAlias `customer_address`
                        :  :  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `c`
                        :  :  :     +- SubqueryAlias `customer`
                        :  :  :        +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  +- SubqueryAlias `s`
                        :  :     +- SubqueryAlias `store_sales`
                        :  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  +- SubqueryAlias `d`
                        :     +- SubqueryAlias `date_dim`
                        :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- SubqueryAlias `i`
                           +- SubqueryAlias `item`
                              +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 596.171334013s
Running execution q7-v2.4 iteration: 1, StandardRun=true
19/10/03 16:27:27 INFO Query: 
== Query: q7-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, agg1#10380, agg2#10381, agg3#10382, agg4#10383]
      +- Sort [i_item_id#565 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565], [i_item_id#565, avg(cast(ss_quantity#140 as bigint)) AS agg1#10380, avg(ss_list_price#142) AS agg2#10381, avg(ss_coupon_amt#149) AS agg3#10382, avg(ss_sales_price#143) AS agg4#10383]
            +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && (ss_cdemo_sk#134 = cd_demo_sk#474)) && ((ss_promo_sk#138 = p_promo_sk#608) && (cd_gender#475 = M))) && (((cd_marital_status#476 = S) && (cd_education_status#477 = College)) && (((p_channel_email#617 = N) || (p_channel_event#622 = N)) && (d_year#498 = 2000))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  +- SubqueryAlias `customer_demographics`
                  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `promotion`
                     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet

     : benchmark
19/10/03 16:27:27 INFO Query: 
== Query: q7-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, agg1#10394, agg2#10395, agg3#10396, agg4#10397]
      +- Sort [i_item_id#565 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565], [i_item_id#565, avg(cast(ss_quantity#140 as bigint)) AS agg1#10394, avg(ss_list_price#142) AS agg2#10395, avg(ss_coupon_amt#149) AS agg3#10396, avg(ss_sales_price#143) AS agg4#10397]
            +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && (ss_cdemo_sk#134 = cd_demo_sk#474)) && ((ss_promo_sk#138 = p_promo_sk#608) && (cd_gender#475 = M))) && (((cd_marital_status#476 = S) && (cd_education_status#477 = College)) && (((p_channel_email#617 = N) || (p_channel_event#622 = N)) && (d_year#498 = 2000))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  +- SubqueryAlias `customer_demographics`
                  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `promotion`
                     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet

      running Thread[benchmark runner,5,main]
Execution time: 177.796985989s
Running execution q8-v2.4 iteration: 1, StandardRun=true
19/10/03 16:30:26 INFO Query: 
== Query: q8-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [s_store_name#669, sum(ss_net_profit)#10486]
      +- Sort [s_store_name#669 ASC NULLS FIRST], true
         +- Aggregate [s_store_name#669], [s_store_name#669, sum(ss_net_profit#152) AS sum(ss_net_profit)#10486]
            +- Filter ((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (d_qoy#502 = 2)) && ((d_year#498 = 1998) && (substring(s_zip#689, 1, 2) = substring(ca_zip#10476, 1, 2))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `store`
                  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  +- SubqueryAlias `V1`
                     +- Project [ca_zip#10476]
                        +- SubqueryAlias `A2`
                           +- Intersect false
                              :- Project [substring(ca_zip#457, 1, 5) AS ca_zip#10476]
                              :  +- Filter substring(ca_zip#457, 1, 5) IN (24128,76232,65084,87816,83926,77556,20548,26231,43848,15126,91137,61265,98294,25782,17920,18426,98235,40081,84093,28577,55565,17183,54601,67897,22752,86284,18376,38607,45200,21756,29741,96765,23932,89360,29839,25989,28898,91068,72550,10390,18845,47770,82636,41367,76638,86198,81312,37126,39192,88424,72175,81426,53672,10445,42666,66864,66708,41248,48583,82276,18842,78890,49448,14089,38122,34425,79077,19849,43285,39861,66162,77610,13695,99543,83444,83041,12305,57665,68341,25003,57834,62878,49130,81096,18840,27700,23470,50412,21195,16021,76107,71954,68309,18119,98359,64544,10336,86379,27068,39736,98569,28915,24206,56529,57647,54917,42961,91110,63981,14922,36420,23006,67467,32754,30903,20260,31671,51798,72325,85816,68621,13955,36446,41766,68806,16725,15146,22744,35850,88086,51649,18270,52867,39972,96976,63792,11376,94898,13595,10516,90225,58943,39371,94945,28587,96576,57855,28488,26105,83933,25858,34322,44438,73171,30122,34102,22685,71256,78451,54364,13354,45375,40558,56458,28286,45266,47305,69399,83921,26233,11101,15371,69913,35942,15882,25631,24610,44165,99076,33786,70738,26653,14328,72305,62496,22152,10144,64147,48425,14663,21076,18799,30450,63089,81019,68893,24996,51200,51211,45692,92712,70466,79994,22437,25280,38935,71791,73134,56571,14060,19505,72425,56575,74351,68786,51650,20004,18383,76614,11634,18906,15765,41368,73241,76698,78567,97189,28545,76231,75691,22246,51061,90578,56691,68014,51103,94167,57047,14867,73520,15734,63435,25733,35474,24676,94627,53535,17879,15559,53268,59166,11928,59402,33282,45721,43933,68101,33515,36634,71286,19736,58058,55253,67473,41918,19515,36495,19430,22351,77191,91393,49156,50298,87501,18652,53179,18767,63193,23968,65164,68880,21286,72823,58470,67301,13394,31016,70372,67030,40604,24317,45748,39127,26065,77721,31029,31880,60576,24671,45549,13376,50016,33123,19769,22927,97789,46081,72151,15723,46136,51949,68100,96888,64528,14171,79777,28709,11489,25103,32213,78668,22245,15798,27156,37930,62971,21337,51622,67853,10567,38415,15455,58263,42029,60279,37125,56240,88190,50308,26859,64457,89091,82136,62377,36233,63837,58078,17043,30010,60099,28810,98025,29178,87343,73273,30469,64034,39516,86057,21309,90257,67875,40162,11356,73650,61810,72013,30431,22461,19512,13375,55307,30625,83849,68908,26689,96451,38193,46820,88885,84935,69035,83144,47537,56616,94983,48033,69952,25486,61547,27385,61860,58048,56910,16807,17871,35258,31387,35458,35576)
                              :     +- SubqueryAlias `customer_address`
                              :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- Project [ca_zip#10477]
                                 +- SubqueryAlias `A1`
                                    +- Project [ca_zip#10477, cnt#10478L]
                                       +- Filter (count(1)#10482L > cast(10 as bigint))
                                          +- Aggregate [ca_zip#457], [substring(ca_zip#457, 1, 5) AS ca_zip#10477, count(1) AS cnt#10478L, count(1) AS count(1)#10482L]
                                             +- Filter ((ca_address_sk#448 = c_current_addr_sk#416) && (c_preferred_cust_flag#422 = Y))
                                                +- Join Inner
                                                   :- SubqueryAlias `customer_address`
                                                   :  +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                                                   +- SubqueryAlias `customer`
                                                      +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/10/03 16:30:26 INFO Query: 
== Query: q8-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [s_store_name#669, sum(ss_net_profit)#10505]
      +- Sort [s_store_name#669 ASC NULLS FIRST], true
         +- Aggregate [s_store_name#669], [s_store_name#669, sum(ss_net_profit#152) AS sum(ss_net_profit)#10505]
            +- Filter ((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (d_qoy#502 = 2)) && ((d_year#498 = 1998) && (substring(s_zip#689, 1, 2) = substring(ca_zip#10495, 1, 2))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `store`
                  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  +- SubqueryAlias `V1`
                     +- Project [ca_zip#10495]
                        +- SubqueryAlias `A2`
                           +- Intersect false
                              :- Project [substring(ca_zip#457, 1, 5) AS ca_zip#10495]
                              :  +- Filter substring(ca_zip#457, 1, 5) IN (24128,76232,65084,87816,83926,77556,20548,26231,43848,15126,91137,61265,98294,25782,17920,18426,98235,40081,84093,28577,55565,17183,54601,67897,22752,86284,18376,38607,45200,21756,29741,96765,23932,89360,29839,25989,28898,91068,72550,10390,18845,47770,82636,41367,76638,86198,81312,37126,39192,88424,72175,81426,53672,10445,42666,66864,66708,41248,48583,82276,18842,78890,49448,14089,38122,34425,79077,19849,43285,39861,66162,77610,13695,99543,83444,83041,12305,57665,68341,25003,57834,62878,49130,81096,18840,27700,23470,50412,21195,16021,76107,71954,68309,18119,98359,64544,10336,86379,27068,39736,98569,28915,24206,56529,57647,54917,42961,91110,63981,14922,36420,23006,67467,32754,30903,20260,31671,51798,72325,85816,68621,13955,36446,41766,68806,16725,15146,22744,35850,88086,51649,18270,52867,39972,96976,63792,11376,94898,13595,10516,90225,58943,39371,94945,28587,96576,57855,28488,26105,83933,25858,34322,44438,73171,30122,34102,22685,71256,78451,54364,13354,45375,40558,56458,28286,45266,47305,69399,83921,26233,11101,15371,69913,35942,15882,25631,24610,44165,99076,33786,70738,26653,14328,72305,62496,22152,10144,64147,48425,14663,21076,18799,30450,63089,81019,68893,24996,51200,51211,45692,92712,70466,79994,22437,25280,38935,71791,73134,56571,14060,19505,72425,56575,74351,68786,51650,20004,18383,76614,11634,18906,15765,41368,73241,76698,78567,97189,28545,76231,75691,22246,51061,90578,56691,68014,51103,94167,57047,14867,73520,15734,63435,25733,35474,24676,94627,53535,17879,15559,53268,59166,11928,59402,33282,45721,43933,68101,33515,36634,71286,19736,58058,55253,67473,41918,19515,36495,19430,22351,77191,91393,49156,50298,87501,18652,53179,18767,63193,23968,65164,68880,21286,72823,58470,67301,13394,31016,70372,67030,40604,24317,45748,39127,26065,77721,31029,31880,60576,24671,45549,13376,50016,33123,19769,22927,97789,46081,72151,15723,46136,51949,68100,96888,64528,14171,79777,28709,11489,25103,32213,78668,22245,15798,27156,37930,62971,21337,51622,67853,10567,38415,15455,58263,42029,60279,37125,56240,88190,50308,26859,64457,89091,82136,62377,36233,63837,58078,17043,30010,60099,28810,98025,29178,87343,73273,30469,64034,39516,86057,21309,90257,67875,40162,11356,73650,61810,72013,30431,22461,19512,13375,55307,30625,83849,68908,26689,96451,38193,46820,88885,84935,69035,83144,47537,56616,94983,48033,69952,25486,61547,27385,61860,58048,56910,16807,17871,35258,31387,35458,35576)
                              :     +- SubqueryAlias `customer_address`
                              :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- Project [ca_zip#10496]
                                 +- SubqueryAlias `A1`
                                    +- Project [ca_zip#10496, cnt#10497L]
                                       +- Filter (count(1)#10501L > cast(10 as bigint))
                                          +- Aggregate [ca_zip#457], [substring(ca_zip#457, 1, 5) AS ca_zip#10496, count(1) AS cnt#10497L, count(1) AS count(1)#10501L]
                                             +- Filter ((ca_address_sk#448 = c_current_addr_sk#416) && (c_preferred_cust_flag#422 = Y))
                                                +- Join Inner
                                                   :- SubqueryAlias `customer_address`
                                                   :  +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                                                   +- SubqueryAlias `customer`
                                                      +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 120.20683601s
Running execution q9-v2.4 iteration: 1, StandardRun=true
19/10/03 16:32:28 INFO Query: 
== Query: q9-v2.4 ==
Project [CASE WHEN (scalar-subquery#10702 [] > cast(74129 as bigint)) THEN scalar-subquery#10703 [] ELSE scalar-subquery#10704 [] END AS bucket1#10705, CASE WHEN (scalar-subquery#10706 [] > cast(122840 as bigint)) THEN scalar-subquery#10707 [] ELSE scalar-subquery#10708 [] END AS bucket2#10709, CASE WHEN (scalar-subquery#10710 [] > cast(56580 as bigint)) THEN scalar-subquery#10711 [] ELSE scalar-subquery#10712 [] END AS bucket3#10713, CASE WHEN (scalar-subquery#10714 [] > cast(10097 as bigint)) THEN scalar-subquery#10715 [] ELSE scalar-subquery#10716 [] END AS bucket4#10717, CASE WHEN (scalar-subquery#10718 [] > cast(165306 as bigint)) THEN scalar-subquery#10719 [] ELSE scalar-subquery#10720 [] END AS bucket5#10721]
:  :- Aggregate [count(1) AS count(1)#10723L]
:  :  +- Filter ((ss_quantity#140 >= 1) && (ss_quantity#140 <= 20))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10725]
:  :  +- Filter ((ss_quantity#140 >= 1) && (ss_quantity#140 <= 20))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10727]
:  :  +- Filter ((ss_quantity#140 >= 1) && (ss_quantity#140 <= 20))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10729L]
:  :  +- Filter ((ss_quantity#140 >= 21) && (ss_quantity#140 <= 40))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10731]
:  :  +- Filter ((ss_quantity#140 >= 21) && (ss_quantity#140 <= 40))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10733]
:  :  +- Filter ((ss_quantity#140 >= 21) && (ss_quantity#140 <= 40))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10735L]
:  :  +- Filter ((ss_quantity#140 >= 41) && (ss_quantity#140 <= 60))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10737]
:  :  +- Filter ((ss_quantity#140 >= 41) && (ss_quantity#140 <= 60))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10739]
:  :  +- Filter ((ss_quantity#140 >= 41) && (ss_quantity#140 <= 60))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10741L]
:  :  +- Filter ((ss_quantity#140 >= 61) && (ss_quantity#140 <= 80))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10743]
:  :  +- Filter ((ss_quantity#140 >= 61) && (ss_quantity#140 <= 80))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10745]
:  :  +- Filter ((ss_quantity#140 >= 61) && (ss_quantity#140 <= 80))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10747L]
:  :  +- Filter ((ss_quantity#140 >= 81) && (ss_quantity#140 <= 100))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10749]
:  :  +- Filter ((ss_quantity#140 >= 81) && (ss_quantity#140 <= 100))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  +- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10751]
:     +- Filter ((ss_quantity#140 >= 81) && (ss_quantity#140 <= 100))
:        +- SubqueryAlias `store_sales`
:           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
+- Filter (r_reason_sk#646 = 1)
   +- SubqueryAlias `reason`
      +- Relation[r_reason_sk#646,r_reason_id#647,r_reason_desc#648] parquet

     : benchmark
19/10/03 16:32:28 INFO Query: 
== Query: q9-v2.4 ==
Project [CASE WHEN (scalar-subquery#10757 [] > cast(74129 as bigint)) THEN scalar-subquery#10758 [] ELSE scalar-subquery#10759 [] END AS bucket1#10760, CASE WHEN (scalar-subquery#10761 [] > cast(122840 as bigint)) THEN scalar-subquery#10762 [] ELSE scalar-subquery#10763 [] END AS bucket2#10764, CASE WHEN (scalar-subquery#10765 [] > cast(56580 as bigint)) THEN scalar-subquery#10766 [] ELSE scalar-subquery#10767 [] END AS bucket3#10768, CASE WHEN (scalar-subquery#10769 [] > cast(10097 as bigint)) THEN scalar-subquery#10770 [] ELSE scalar-subquery#10771 [] END AS bucket4#10772, CASE WHEN (scalar-subquery#10773 [] > cast(165306 as bigint)) THEN scalar-subquery#10774 [] ELSE scalar-subquery#10775 [] END AS bucket5#10776]
:  :- Aggregate [count(1) AS count(1)#10778L]
:  :  +- Filter ((ss_quantity#140 >= 1) && (ss_quantity#140 <= 20))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10780]
:  :  +- Filter ((ss_quantity#140 >= 1) && (ss_quantity#140 <= 20))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10782]
:  :  +- Filter ((ss_quantity#140 >= 1) && (ss_quantity#140 <= 20))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10784L]
:  :  +- Filter ((ss_quantity#140 >= 21) && (ss_quantity#140 <= 40))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10786]
:  :  +- Filter ((ss_quantity#140 >= 21) && (ss_quantity#140 <= 40))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10788]
:  :  +- Filter ((ss_quantity#140 >= 21) && (ss_quantity#140 <= 40))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10790L]
:  :  +- Filter ((ss_quantity#140 >= 41) && (ss_quantity#140 <= 60))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10792]
:  :  +- Filter ((ss_quantity#140 >= 41) && (ss_quantity#140 <= 60))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10794]
:  :  +- Filter ((ss_quantity#140 >= 41) && (ss_quantity#140 <= 60))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10796L]
:  :  +- Filter ((ss_quantity#140 >= 61) && (ss_quantity#140 <= 80))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10798]
:  :  +- Filter ((ss_quantity#140 >= 61) && (ss_quantity#140 <= 80))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10800]
:  :  +- Filter ((ss_quantity#140 >= 61) && (ss_quantity#140 <= 80))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [count(1) AS count(1)#10802L]
:  :  +- Filter ((ss_quantity#140 >= 81) && (ss_quantity#140 <= 100))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  :- Aggregate [avg(ss_ext_discount_amt#144) AS avg(ss_ext_discount_amt)#10804]
:  :  +- Filter ((ss_quantity#140 >= 81) && (ss_quantity#140 <= 100))
:  :     +- SubqueryAlias `store_sales`
:  :        +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
:  +- Aggregate [avg(ss_net_paid#150) AS avg(ss_net_paid)#10806]
:     +- Filter ((ss_quantity#140 >= 81) && (ss_quantity#140 <= 100))
:        +- SubqueryAlias `store_sales`
:           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
+- Filter (r_reason_sk#646 = 1)
   +- SubqueryAlias `reason`
      +- Relation[r_reason_sk#646,r_reason_id#647,r_reason_desc#648] parquet

      running Thread[benchmark runner,5,main]
Execution time: 696.9336391859999s
Running execution q10-v2.4 iteration: 1, StandardRun=true
19/10/03 16:44:07 INFO Query: 
== Query: q10-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cd_gender#475 ASC NULLS FIRST, cd_marital_status#476 ASC NULLS FIRST, cd_education_status#477 ASC NULLS FIRST, cd_purchase_estimate#478 ASC NULLS FIRST, cd_credit_rating#479 ASC NULLS FIRST, cd_dep_count#480 ASC NULLS FIRST, cd_dep_employed_count#481 ASC NULLS FIRST, cd_dep_college_count#482 ASC NULLS FIRST], true
      +- Aggregate [cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482], [cd_gender#475, cd_marital_status#476, cd_education_status#477, count(1) AS cnt1#11046L, cd_purchase_estimate#478, count(1) AS cnt2#11047L, cd_credit_rating#479, count(1) AS cnt3#11048L, cd_dep_count#480, count(1) AS cnt4#11049L, cd_dep_employed_count#481, count(1) AS cnt5#11050L, cd_dep_college_count#482, count(1) AS cnt6#11051L]
         +- Filter ((((c_current_addr_sk#416 = ca_address_sk#448) && ca_county#455 IN (Rush County,Toole County,Jefferson County,Dona Ana County,La Porte County)) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && (exists#11052 [c_customer_sk#412] && (exists#11053 [c_customer_sk#412] || exists#11054 [c_customer_sk#412])))
            :  :- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 27 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = 2002) && ((d_moy#500 >= 1) && (d_moy#500 <= (1 + 3)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `store_sales`
            :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 38 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = 2002) && ((d_moy#500 >= 1) && (d_moy#500 <= (1 + 3)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `web_sales`
            :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 38 more fields]
            :     +- Filter (((outer(c_customer_sk#412) = cs_ship_customer_sk#7) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = 2002) && ((d_moy#500 >= 1) && (d_moy#500 <= (1 + 3)))))
            :        +- Join Inner
            :           :- SubqueryAlias `catalog_sales`
            :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :           +- SubqueryAlias `date_dim`
            :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `c`
               :  :  +- SubqueryAlias `customer`
               :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  +- SubqueryAlias `ca`
               :     +- SubqueryAlias `customer_address`
               :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer_demographics`
                  +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet

     : benchmark
19/10/03 16:44:07 INFO Query: 
== Query: q10-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cd_gender#475 ASC NULLS FIRST, cd_marital_status#476 ASC NULLS FIRST, cd_education_status#477 ASC NULLS FIRST, cd_purchase_estimate#478 ASC NULLS FIRST, cd_credit_rating#479 ASC NULLS FIRST, cd_dep_count#480 ASC NULLS FIRST, cd_dep_employed_count#481 ASC NULLS FIRST, cd_dep_college_count#482 ASC NULLS FIRST], true
      +- Aggregate [cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482], [cd_gender#475, cd_marital_status#476, cd_education_status#477, count(1) AS cnt1#11075L, cd_purchase_estimate#478, count(1) AS cnt2#11076L, cd_credit_rating#479, count(1) AS cnt3#11077L, cd_dep_count#480, count(1) AS cnt4#11078L, cd_dep_employed_count#481, count(1) AS cnt5#11079L, cd_dep_college_count#482, count(1) AS cnt6#11080L]
         +- Filter ((((c_current_addr_sk#416 = ca_address_sk#448) && ca_county#455 IN (Rush County,Toole County,Jefferson County,Dona Ana County,La Porte County)) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && (exists#11081 [c_customer_sk#412] && (exists#11082 [c_customer_sk#412] || exists#11083 [c_customer_sk#412])))
            :  :- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 27 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = 2002) && ((d_moy#500 >= 1) && (d_moy#500 <= (1 + 3)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `store_sales`
            :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 38 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = 2002) && ((d_moy#500 >= 1) && (d_moy#500 <= (1 + 3)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `web_sales`
            :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 38 more fields]
            :     +- Filter (((outer(c_customer_sk#412) = cs_ship_customer_sk#7) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = 2002) && ((d_moy#500 >= 1) && (d_moy#500 <= (1 + 3)))))
            :        +- Join Inner
            :           :- SubqueryAlias `catalog_sales`
            :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :           +- SubqueryAlias `date_dim`
            :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `c`
               :  :  +- SubqueryAlias `customer`
               :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  +- SubqueryAlias `ca`
               :     +- SubqueryAlias `customer_address`
               :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer_demographics`
                  +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet

      running Thread[benchmark runner,5,main]
Execution time: 143.826036353s
Running execution q11-v2.4 iteration: 1, StandardRun=true
19/10/03 16:46:32 INFO Query: 
== Query: q11-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#11260 ASC NULLS FIRST, customer_first_name#11261 ASC NULLS FIRST, customer_last_name#11262 ASC NULLS FIRST, customer_preferred_cust_flag#11263 ASC NULLS FIRST], true
      +- Project [customer_id#11260, customer_first_name#11261, customer_last_name#11262, customer_preferred_cust_flag#11263]
         +- Filter (((((customer_id#11260 = customer_id#11238) && (customer_id#11238 = customer_id#11280)) && ((customer_id#11238 = customer_id#11270) && (sale_type#11247 = s))) && (((sale_type#11279 = w) && (sale_type#11269 = s)) && (sale_type#11289 = w))) && ((((dyear#11245 = 2001) && (dyear#11267 = (2001 + 1))) && ((dyear#11277 = 2001) && (dyear#11287 = (2001 + 1)))) && (((cast(year_total#11246 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2))) && (cast(year_total#11278 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2)))) && (CASE WHEN (cast(year_total#11278 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2))) THEN CheckOverflow((promote_precision(cast(year_total#11288 as decimal(18,2))) / promote_precision(cast(year_total#11278 as decimal(18,2)))), DecimalType(38,20)) ELSE cast(0.0 as decimal(38,20)) END > CASE WHEN (cast(year_total#11246 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2))) THEN CheckOverflow((promote_precision(cast(year_total#11268 as decimal(18,2))) / promote_precision(cast(year_total#11246 as decimal(18,2)))), DecimalType(38,20)) ELSE cast(0.0 as decimal(38,20)) END))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `t_s_firstyear`
               :  :  :  +- SubqueryAlias `year_total`
               :  :  :     +- Union
               :  :  :        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11238, c_first_name#420 AS customer_first_name#11239, c_last_name#421 AS customer_last_name#11240, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11241, c_birth_country#426 AS customer_birth_country#11242, c_login#427 AS customer_login#11243, c_email_address#428 AS customer_email_address#11244, d_year#498 AS dyear#11245, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11246, s AS sale_type#11247]
               :  :  :        :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :        :     +- Join Inner
               :  :  :        :        :- Join Inner
               :  :  :        :        :  :- SubqueryAlias `customer`
               :  :  :        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :        :        :  +- SubqueryAlias `store_sales`
               :  :  :        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :        :        +- SubqueryAlias `date_dim`
               :  :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11248, c_first_name#420 AS customer_first_name#11249, c_last_name#421 AS customer_last_name#11250, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11251, c_birth_country#426 AS customer_birth_country#11252, c_login#427 AS customer_login#11253, c_email_address#428 AS customer_email_address#11254, d_year#498 AS dyear#11255, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11256, w AS sale_type#11257]
               :  :  :           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :              +- Join Inner
               :  :  :                 :- Join Inner
               :  :  :                 :  :- SubqueryAlias `customer`
               :  :  :                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :                 :  +- SubqueryAlias `web_sales`
               :  :  :                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :                 +- SubqueryAlias `date_dim`
               :  :  :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  +- SubqueryAlias `t_s_secyear`
               :  :     +- SubqueryAlias `year_total`
               :  :        +- Union
               :  :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11260, c_first_name#420 AS customer_first_name#11261, c_last_name#421 AS customer_last_name#11262, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11263, c_birth_country#426 AS customer_birth_country#11264, c_login#427 AS customer_login#11265, c_email_address#428 AS customer_email_address#11266, d_year#498 AS dyear#11267, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11268, s AS sale_type#11269]
               :  :           :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :           :     +- Join Inner
               :  :           :        :- Join Inner
               :  :           :        :  :- SubqueryAlias `customer`
               :  :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :        :  +- SubqueryAlias `store_sales`
               :  :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :        +- SubqueryAlias `date_dim`
               :  :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11248, c_first_name#420 AS customer_first_name#11249, c_last_name#421 AS customer_last_name#11250, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11251, c_birth_country#426 AS customer_birth_country#11252, c_login#427 AS customer_login#11253, c_email_address#428 AS customer_email_address#11254, d_year#498 AS dyear#11255, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11256, w AS sale_type#11257]
               :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :                 +- Join Inner
               :  :                    :- Join Inner
               :  :                    :  :- SubqueryAlias `customer`
               :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :                    :  +- SubqueryAlias `web_sales`
               :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :                    +- SubqueryAlias `date_dim`
               :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `t_w_firstyear`
               :     +- SubqueryAlias `year_total`
               :        +- Union
               :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11270, c_first_name#420 AS customer_first_name#11271, c_last_name#421 AS customer_last_name#11272, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11273, c_birth_country#426 AS customer_birth_country#11274, c_login#427 AS customer_login#11275, c_email_address#428 AS customer_email_address#11276, d_year#498 AS dyear#11277, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11278, s AS sale_type#11279]
               :           :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :           :     +- Join Inner
               :           :        :- Join Inner
               :           :        :  :- SubqueryAlias `customer`
               :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :        :  +- SubqueryAlias `store_sales`
               :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11248, c_first_name#420 AS customer_first_name#11249, c_last_name#421 AS customer_last_name#11250, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11251, c_birth_country#426 AS customer_birth_country#11252, c_login#427 AS customer_login#11253, c_email_address#428 AS customer_email_address#11254, d_year#498 AS dyear#11255, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11256, w AS sale_type#11257]
               :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :                 +- Join Inner
               :                    :- Join Inner
               :                    :  :- SubqueryAlias `customer`
               :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :                    :  +- SubqueryAlias `web_sales`
               :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `t_w_secyear`
                  +- SubqueryAlias `year_total`
                     +- Union
                        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11280, c_first_name#420 AS customer_first_name#11281, c_last_name#421 AS customer_last_name#11282, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11283, c_birth_country#426 AS customer_birth_country#11284, c_login#427 AS customer_login#11285, c_email_address#428 AS customer_email_address#11286, d_year#498 AS dyear#11287, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11288, s AS sale_type#11289]
                        :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
                        :     +- Join Inner
                        :        :- Join Inner
                        :        :  :- SubqueryAlias `customer`
                        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :        :  +- SubqueryAlias `store_sales`
                        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11248, c_first_name#420 AS customer_first_name#11249, c_last_name#421 AS customer_last_name#11250, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11251, c_birth_country#426 AS customer_birth_country#11252, c_login#427 AS customer_login#11253, c_email_address#428 AS customer_email_address#11254, d_year#498 AS dyear#11255, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11256, w AS sale_type#11257]
                           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `customer`
                                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                                 :  +- SubqueryAlias `web_sales`
                                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/03 16:46:33 INFO Query: 
== Query: q11-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#11316 ASC NULLS FIRST, customer_first_name#11317 ASC NULLS FIRST, customer_last_name#11318 ASC NULLS FIRST, customer_preferred_cust_flag#11319 ASC NULLS FIRST], true
      +- Project [customer_id#11316, customer_first_name#11317, customer_last_name#11318, customer_preferred_cust_flag#11319]
         +- Filter (((((customer_id#11316 = customer_id#11294) && (customer_id#11294 = customer_id#11336)) && ((customer_id#11294 = customer_id#11326) && (sale_type#11303 = s))) && (((sale_type#11335 = w) && (sale_type#11325 = s)) && (sale_type#11345 = w))) && ((((dyear#11301 = 2001) && (dyear#11323 = (2001 + 1))) && ((dyear#11333 = 2001) && (dyear#11343 = (2001 + 1)))) && (((cast(year_total#11302 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2))) && (cast(year_total#11334 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2)))) && (CASE WHEN (cast(year_total#11334 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2))) THEN CheckOverflow((promote_precision(cast(year_total#11344 as decimal(18,2))) / promote_precision(cast(year_total#11334 as decimal(18,2)))), DecimalType(38,20)) ELSE cast(0.0 as decimal(38,20)) END > CASE WHEN (cast(year_total#11302 as decimal(18,2)) > cast(cast(0 as decimal(1,0)) as decimal(18,2))) THEN CheckOverflow((promote_precision(cast(year_total#11324 as decimal(18,2))) / promote_precision(cast(year_total#11302 as decimal(18,2)))), DecimalType(38,20)) ELSE cast(0.0 as decimal(38,20)) END))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `t_s_firstyear`
               :  :  :  +- SubqueryAlias `year_total`
               :  :  :     +- Union
               :  :  :        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11294, c_first_name#420 AS customer_first_name#11295, c_last_name#421 AS customer_last_name#11296, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11297, c_birth_country#426 AS customer_birth_country#11298, c_login#427 AS customer_login#11299, c_email_address#428 AS customer_email_address#11300, d_year#498 AS dyear#11301, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11302, s AS sale_type#11303]
               :  :  :        :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :  :        :     +- Join Inner
               :  :  :        :        :- Join Inner
               :  :  :        :        :  :- SubqueryAlias `customer`
               :  :  :        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :        :        :  +- SubqueryAlias `store_sales`
               :  :  :        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :        :        +- SubqueryAlias `date_dim`
               :  :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11304, c_first_name#420 AS customer_first_name#11305, c_last_name#421 AS customer_last_name#11306, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11307, c_birth_country#426 AS customer_birth_country#11308, c_login#427 AS customer_login#11309, c_email_address#428 AS customer_email_address#11310, d_year#498 AS dyear#11311, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11312, w AS sale_type#11313]
               :  :  :           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :  :              +- Join Inner
               :  :  :                 :- Join Inner
               :  :  :                 :  :- SubqueryAlias `customer`
               :  :  :                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :                 :  +- SubqueryAlias `web_sales`
               :  :  :                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :                 +- SubqueryAlias `date_dim`
               :  :  :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  +- SubqueryAlias `t_s_secyear`
               :  :     +- SubqueryAlias `year_total`
               :  :        +- Union
               :  :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11316, c_first_name#420 AS customer_first_name#11317, c_last_name#421 AS customer_last_name#11318, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11319, c_birth_country#426 AS customer_birth_country#11320, c_login#427 AS customer_login#11321, c_email_address#428 AS customer_email_address#11322, d_year#498 AS dyear#11323, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11324, s AS sale_type#11325]
               :  :           :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :           :     +- Join Inner
               :  :           :        :- Join Inner
               :  :           :        :  :- SubqueryAlias `customer`
               :  :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :        :  +- SubqueryAlias `store_sales`
               :  :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :        +- SubqueryAlias `date_dim`
               :  :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11304, c_first_name#420 AS customer_first_name#11305, c_last_name#421 AS customer_last_name#11306, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11307, c_birth_country#426 AS customer_birth_country#11308, c_login#427 AS customer_login#11309, c_email_address#428 AS customer_email_address#11310, d_year#498 AS dyear#11311, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11312, w AS sale_type#11313]
               :  :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :  :                 +- Join Inner
               :  :                    :- Join Inner
               :  :                    :  :- SubqueryAlias `customer`
               :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :                    :  +- SubqueryAlias `web_sales`
               :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :                    +- SubqueryAlias `date_dim`
               :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `t_w_firstyear`
               :     +- SubqueryAlias `year_total`
               :        +- Union
               :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11326, c_first_name#420 AS customer_first_name#11327, c_last_name#421 AS customer_last_name#11328, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11329, c_birth_country#426 AS customer_birth_country#11330, c_login#427 AS customer_login#11331, c_email_address#428 AS customer_email_address#11332, d_year#498 AS dyear#11333, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11334, s AS sale_type#11335]
               :           :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
               :           :     +- Join Inner
               :           :        :- Join Inner
               :           :        :  :- SubqueryAlias `customer`
               :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :        :  +- SubqueryAlias `store_sales`
               :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11304, c_first_name#420 AS customer_first_name#11305, c_last_name#421 AS customer_last_name#11306, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11307, c_birth_country#426 AS customer_birth_country#11308, c_login#427 AS customer_login#11309, c_email_address#428 AS customer_email_address#11310, d_year#498 AS dyear#11311, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11312, w AS sale_type#11313]
               :              +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
               :                 +- Join Inner
               :                    :- Join Inner
               :                    :  :- SubqueryAlias `customer`
               :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :                    :  +- SubqueryAlias `web_sales`
               :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `t_w_secyear`
                  +- SubqueryAlias `year_total`
                     +- Union
                        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11336, c_first_name#420 AS customer_first_name#11337, c_last_name#421 AS customer_last_name#11338, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11339, c_birth_country#426 AS customer_birth_country#11340, c_login#427 AS customer_login#11341, c_email_address#428 AS customer_email_address#11342, d_year#498 AS dyear#11343, sum(CheckOverflow((promote_precision(cast(ss_ext_list_price#147 as decimal(8,2))) - promote_precision(cast(ss_ext_discount_amt#144 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11344, s AS sale_type#11345]
                        :  +- Filter ((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492))
                        :     +- Join Inner
                        :        :- Join Inner
                        :        :  :- SubqueryAlias `customer`
                        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :        :  +- SubqueryAlias `store_sales`
                        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_country#426, c_login#427, c_email_address#428, d_year#498], [c_customer_id#413 AS customer_id#11304, c_first_name#420 AS customer_first_name#11305, c_last_name#421 AS customer_last_name#11306, c_preferred_cust_flag#422 AS customer_preferred_cust_flag#11307, c_birth_country#426 AS customer_birth_country#11308, c_login#427 AS customer_login#11309, c_email_address#428 AS customer_email_address#11310, d_year#498 AS dyear#11311, sum(CheckOverflow((promote_precision(cast(ws_ext_list_price#241 as decimal(8,2))) - promote_precision(cast(ws_ext_discount_amt#238 as decimal(8,2)))), DecimalType(8,2))) AS year_total#11312, w AS sale_type#11313]
                           +- Filter ((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `customer`
                                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                                 :  +- SubqueryAlias `web_sales`
                                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 1228.461315144s
Running execution q12-v2.4 iteration: 1, StandardRun=true
19/10/03 17:07:03 INFO Query: 
== Query: q12-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#576 ASC NULLS FIRST, i_class#574 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, revenueratio#11497 ASC NULLS FIRST], true
      +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#11496, revenueratio#11497]
         +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#11496, _w0#11502, _w1#11503, _we0#11504, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(_w0#11502 as decimal(17,2))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(17,2)))), DecimalType(21,2)) as decimal(27,2))) / promote_precision(cast(_we0#11504 as decimal(27,2)))), DecimalType(38,17)) AS revenueratio#11497]
            +- Window [sum(_w1#11503) windowspecdefinition(i_class#574, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#11504], [i_class#574]
               +- Aggregate [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569], [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, sum(ws_ext_sales_price#239) AS itemrevenue#11496, sum(ws_ext_sales_price#239) AS _w0#11502, sum(ws_ext_sales_price#239) AS _w1#11503]
                  +- Filter (((ws_item_sk#219 = i_item_sk#564) && i_category#576 IN (Sports,Books,Home)) && ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_date#494 >= cast(1999-02-22 as date)) && (d_date#494 <= cast(cast(cast(1999-02-22 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `web_sales`
                        :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  +- SubqueryAlias `item`
                        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/03 17:07:03 INFO Query: 
== Query: q12-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#576 ASC NULLS FIRST, i_class#574 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, revenueratio#11513 ASC NULLS FIRST], true
      +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#11512, revenueratio#11513]
         +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#11512, _w0#11518, _w1#11519, _we0#11520, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(_w0#11518 as decimal(17,2))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(17,2)))), DecimalType(21,2)) as decimal(27,2))) / promote_precision(cast(_we0#11520 as decimal(27,2)))), DecimalType(38,17)) AS revenueratio#11513]
            +- Window [sum(_w1#11519) windowspecdefinition(i_class#574, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#11520], [i_class#574]
               +- Aggregate [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569], [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, sum(ws_ext_sales_price#239) AS itemrevenue#11512, sum(ws_ext_sales_price#239) AS _w0#11518, sum(ws_ext_sales_price#239) AS _w1#11519]
                  +- Filter (((ws_item_sk#219 = i_item_sk#564) && i_category#576 IN (Sports,Books,Home)) && ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_date#494 >= cast(1999-02-22 as date)) && (d_date#494 <= cast(cast(cast(1999-02-22 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `web_sales`
                        :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  +- SubqueryAlias `item`
                        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 129.03560363100001s
Running execution q13-v2.4 iteration: 1, StandardRun=true
19/10/03 17:09:13 INFO Query: 
== Query: q13-v2.4 ==
Aggregate [avg(cast(ss_quantity#140 as bigint)) AS avg(ss_quantity)#11593, avg(ss_ext_sales_price#145) AS avg(ss_ext_sales_price)#11594, avg(ss_ext_wholesale_cost#146) AS avg(ss_ext_wholesale_cost)#11595, sum(ss_ext_wholesale_cost#146) AS sum(ss_ext_wholesale_cost)#11596]
+- Filter ((((s_store_sk#664 = ss_store_sk#137) && (ss_sold_date_sk#130 = d_date_sk#492)) && (d_year#498 = 2001)) && (((((((ss_hdemo_sk#135 = hd_demo_sk#548) && (cd_demo_sk#474 = ss_cdemo_sk#134)) && (cd_marital_status#476 = M)) && (((cd_education_status#477 = Advanced Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(100.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(150.00 as decimal(7,2))))) && (hd_dep_count#551 = 3))) || ((((ss_hdemo_sk#135 = hd_demo_sk#548) && (cd_demo_sk#474 = ss_cdemo_sk#134)) && (cd_marital_status#476 = S)) && (((cd_education_status#477 = College) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(50.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(100.00 as decimal(7,2))))) && (hd_dep_count#551 = 1)))) || ((((ss_hdemo_sk#135 = hd_demo_sk#548) && (cd_demo_sk#474 = ss_cdemo_sk#134)) && (cd_marital_status#476 = W)) && (((cd_education_status#477 = 2 yr Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(150.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(200.00 as decimal(7,2))))) && (hd_dep_count#551 = 1)))) && (((((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (TX,OH,TX) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(100 as decimal(3,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(200 as decimal(3,0)) as decimal(7,2)))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (OR,NM,KY) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(150 as decimal(3,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(300 as decimal(3,0)) as decimal(7,2))))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (VA,TX,MS) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(250 as decimal(3,0)) as decimal(7,2)))))))))
   +- Join Inner
      :- Join Inner
      :  :- Join Inner
      :  :  :- Join Inner
      :  :  :  :- Join Inner
      :  :  :  :  :- SubqueryAlias `store_sales`
      :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
      :  :  :  :  +- SubqueryAlias `store`
      :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
      :  :  :  +- SubqueryAlias `customer_demographics`
      :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
      :  :  +- SubqueryAlias `household_demographics`
      :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
      :  +- SubqueryAlias `customer_address`
      :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
      +- SubqueryAlias `date_dim`
         +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/03 17:09:13 INFO Query: 
== Query: q13-v2.4 ==
Aggregate [avg(cast(ss_quantity#140 as bigint)) AS avg(ss_quantity)#11605, avg(ss_ext_sales_price#145) AS avg(ss_ext_sales_price)#11606, avg(ss_ext_wholesale_cost#146) AS avg(ss_ext_wholesale_cost)#11607, sum(ss_ext_wholesale_cost#146) AS sum(ss_ext_wholesale_cost)#11608]
+- Filter ((((s_store_sk#664 = ss_store_sk#137) && (ss_sold_date_sk#130 = d_date_sk#492)) && (d_year#498 = 2001)) && (((((((ss_hdemo_sk#135 = hd_demo_sk#548) && (cd_demo_sk#474 = ss_cdemo_sk#134)) && (cd_marital_status#476 = M)) && (((cd_education_status#477 = Advanced Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(100.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(150.00 as decimal(7,2))))) && (hd_dep_count#551 = 3))) || ((((ss_hdemo_sk#135 = hd_demo_sk#548) && (cd_demo_sk#474 = ss_cdemo_sk#134)) && (cd_marital_status#476 = S)) && (((cd_education_status#477 = College) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(50.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(100.00 as decimal(7,2))))) && (hd_dep_count#551 = 1)))) || ((((ss_hdemo_sk#135 = hd_demo_sk#548) && (cd_demo_sk#474 = ss_cdemo_sk#134)) && (cd_marital_status#476 = W)) && (((cd_education_status#477 = 2 yr Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(150.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(200.00 as decimal(7,2))))) && (hd_dep_count#551 = 1)))) && (((((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (TX,OH,TX) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(100 as decimal(3,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(200 as decimal(3,0)) as decimal(7,2)))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (OR,NM,KY) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(150 as decimal(3,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(300 as decimal(3,0)) as decimal(7,2))))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (VA,TX,MS) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(250 as decimal(3,0)) as decimal(7,2)))))))))
   +- Join Inner
      :- Join Inner
      :  :- Join Inner
      :  :  :- Join Inner
      :  :  :  :- Join Inner
      :  :  :  :  :- SubqueryAlias `store_sales`
      :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
      :  :  :  :  +- SubqueryAlias `store`
      :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
      :  :  :  +- SubqueryAlias `customer_demographics`
      :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
      :  :  +- SubqueryAlias `household_demographics`
      :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
      :  +- SubqueryAlias `customer_address`
      :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
      +- SubqueryAlias `date_dim`
         +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 1088.311795565s
Running execution q14a-v2.4 iteration: 1, StandardRun=true
19/10/03 17:27:25 INFO Query: 
== Query: q14a-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#11832 ASC NULLS FIRST, i_brand_id#11833 ASC NULLS FIRST, i_class_id#11834 ASC NULLS FIRST, i_category_id#11835 ASC NULLS FIRST], true
      +- Aggregate [channel#11832, i_brand_id#11833, i_class_id#11834, i_category_id#11835, spark_grouping_id#11827], [channel#11832, i_brand_id#11833, i_class_id#11834, i_category_id#11835, sum(sales#11779) AS sum(sales)#11822, sum(number_sales#11780L) AS sum(number_sales)#11823L]
         +- Expand [List(channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, channel#11828, i_brand_id#11829, i_class_id#11830, i_category_id#11831, 0), List(channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, channel#11828, i_brand_id#11829, i_class_id#11830, null, 1), List(channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, channel#11828, i_brand_id#11829, null, null, 3), List(channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, channel#11828, null, null, null, 7), List(channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, null, null, null, null, 15)], [channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, channel#11832, i_brand_id#11833, i_class_id#11834, i_category_id#11835, spark_grouping_id#11827]
            +- Project [channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L, channel#11778 AS channel#11828, i_brand_id#571 AS i_brand_id#11829, i_class_id#573 AS i_class_id#11830, i_category_id#575 AS i_category_id#11831]
               +- SubqueryAlias `y`
                  +- Union
                     :- Union
                     :  :- Project [channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11779, number_sales#11780L]
                     :  :  +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#11813 as decimal(32,6)) > cast(scalar-subquery#11782 [] as decimal(32,6)))
                     :  :     :  +- Project [average_sales#11803]
                     :  :     :     +- SubqueryAlias `avg_sales`
                     :  :     :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#11797 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#11798 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#11803]
                     :  :     :           +- SubqueryAlias `x`
                     :  :     :              +- Union
                     :  :     :                 :- Union
                     :  :     :                 :  :- Project [ss_quantity#140 AS quantity#11797, ss_list_price#142 AS list_price#11798]
                     :  :     :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= 2001)))
                     :  :     :                 :  :     +- Join Inner
                     :  :     :                 :  :        :- SubqueryAlias `store_sales`
                     :  :     :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :     :                 :  :        +- SubqueryAlias `date_dim`
                     :  :     :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :     :                 :  +- Project [cs_quantity#18 AS quantity#11799, cs_list_price#20 AS list_price#11800]
                     :  :     :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :     :                 :        +- Join Inner
                     :  :     :                 :           :- SubqueryAlias `catalog_sales`
                     :  :     :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :  :     :                 :           +- SubqueryAlias `date_dim`
                     :  :     :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :     :                 +- Project [ws_quantity#234 AS quantity#11801, ws_list_price#236 AS list_price#11802]
                     :  :     :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :     :                       +- Join Inner
                     :  :     :                          :- SubqueryAlias `web_sales`
                     :  :     :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :  :     :                          +- SubqueryAlias `date_dim`
                     :  :     :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :     +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [store AS channel#11778, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sales#11779, count(1) AS number_sales#11780L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#11813]
                     :  :        +- Filter (((ss_item_sk#132 IN (list#11781 []) && (ss_item_sk#132 = i_item_sk#564)) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = (1999 + 2)) && (d_moy#500 = 11)))
                     :  :           :  +- Project [ss_item_sk#11796]
                     :  :           :     +- SubqueryAlias `cross_items`
                     :  :           :        +- Project [i_item_sk#564 AS ss_item_sk#11796]
                     :  :           :           +- Filter (((i_brand_id#571 = brand_id#11793) && (i_class_id#573 = class_id#11794)) && (i_category_id#575 = category_id#11795))
                     :  :           :              +- Join Inner
                     :  :           :                 :- SubqueryAlias `item`
                     :  :           :                 :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                 +- SubqueryAlias `x`
                     :  :           :                    +- Intersect false
                     :  :           :                       :- Intersect false
                     :  :           :                       :  :- Project [i_brand_id#571 AS brand_id#11793, i_class_id#573 AS class_id#11794, i_category_id#575 AS category_id#11795]
                     :  :           :                       :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :           :                       :  :     +- Join Inner
                     :  :           :                       :  :        :- Join Inner
                     :  :           :                       :  :        :  :- SubqueryAlias `store_sales`
                     :  :           :                       :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :           :                       :  :        :  +- SubqueryAlias `iss`
                     :  :           :                       :  :        :     +- SubqueryAlias `item`
                     :  :           :                       :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                       :  :        +- SubqueryAlias `d1`
                     :  :           :                       :  :           +- SubqueryAlias `date_dim`
                     :  :           :                       :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :           :                       :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :  :           :                       :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :           :                       :        +- Join Inner
                     :  :           :                       :           :- Join Inner
                     :  :           :                       :           :  :- SubqueryAlias `catalog_sales`
                     :  :           :                       :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :  :           :                       :           :  +- SubqueryAlias `ics`
                     :  :           :                       :           :     +- SubqueryAlias `item`
                     :  :           :                       :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                       :           +- SubqueryAlias `d2`
                     :  :           :                       :              +- SubqueryAlias `date_dim`
                     :  :           :                       :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :           :                       +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :  :           :                          +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :           :                             +- Join Inner
                     :  :           :                                :- Join Inner
                     :  :           :                                :  :- SubqueryAlias `web_sales`
                     :  :           :                                :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :  :           :                                :  +- SubqueryAlias `iws`
                     :  :           :                                :     +- SubqueryAlias `item`
                     :  :           :                                :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                                +- SubqueryAlias `d3`
                     :  :           :                                   +- SubqueryAlias `date_dim`
                     :  :           :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- SubqueryAlias `store_sales`
                     :  :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :              :  +- SubqueryAlias `item`
                     :  :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :              +- SubqueryAlias `date_dim`
                     :  :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- Project [channel#11783, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11784, number_sales#11785L]
                     :     +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2)))#11816 as decimal(32,6)) > cast(scalar-subquery#11787 [] as decimal(32,6)))
                     :        :  +- Project [average_sales#11803]
                     :        :     +- SubqueryAlias `avg_sales`
                     :        :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#11797 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#11798 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#11803]
                     :        :           +- SubqueryAlias `x`
                     :        :              +- Union
                     :        :                 :- Union
                     :        :                 :  :- Project [ss_quantity#140 AS quantity#11797, ss_list_price#142 AS list_price#11798]
                     :        :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= 2001)))
                     :        :                 :  :     +- Join Inner
                     :        :                 :  :        :- SubqueryAlias `store_sales`
                     :        :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :        :                 :  :        +- SubqueryAlias `date_dim`
                     :        :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :        :                 :  +- Project [cs_quantity#18 AS quantity#11799, cs_list_price#20 AS list_price#11800]
                     :        :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :        :                 :        +- Join Inner
                     :        :                 :           :- SubqueryAlias `catalog_sales`
                     :        :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :        :                 :           +- SubqueryAlias `date_dim`
                     :        :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :        :                 +- Project [ws_quantity#234 AS quantity#11801, ws_list_price#236 AS list_price#11802]
                     :        :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :        :                       +- Join Inner
                     :        :                          :- SubqueryAlias `web_sales`
                     :        :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :        :                          +- SubqueryAlias `date_dim`
                     :        :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :        +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [catalog AS channel#11783, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2))) AS sales#11784, count(1) AS number_sales#11785L, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2)))#11816]
                     :           +- Filter (((cs_item_sk#15 IN (list#11786 []) && (cs_item_sk#15 = i_item_sk#564)) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = (1999 + 2)) && (d_moy#500 = 11)))
                     :              :  +- Project [ss_item_sk#11796]
                     :              :     +- SubqueryAlias `cross_items`
                     :              :        +- Project [i_item_sk#564 AS ss_item_sk#11796]
                     :              :           +- Filter (((i_brand_id#571 = brand_id#11793) && (i_class_id#573 = class_id#11794)) && (i_category_id#575 = category_id#11795))
                     :              :              +- Join Inner
                     :              :                 :- SubqueryAlias `item`
                     :              :                 :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                 +- SubqueryAlias `x`
                     :              :                    +- Intersect false
                     :              :                       :- Intersect false
                     :              :                       :  :- Project [i_brand_id#571 AS brand_id#11793, i_class_id#573 AS class_id#11794, i_category_id#575 AS category_id#11795]
                     :              :                       :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :              :                       :  :     +- Join Inner
                     :              :                       :  :        :- Join Inner
                     :              :                       :  :        :  :- SubqueryAlias `store_sales`
                     :              :                       :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :              :                       :  :        :  +- SubqueryAlias `iss`
                     :              :                       :  :        :     +- SubqueryAlias `item`
                     :              :                       :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                       :  :        +- SubqueryAlias `d1`
                     :              :                       :  :           +- SubqueryAlias `date_dim`
                     :              :                       :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              :                       :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :              :                       :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :              :                       :        +- Join Inner
                     :              :                       :           :- Join Inner
                     :              :                       :           :  :- SubqueryAlias `catalog_sales`
                     :              :                       :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :              :                       :           :  +- SubqueryAlias `ics`
                     :              :                       :           :     +- SubqueryAlias `item`
                     :              :                       :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                       :           +- SubqueryAlias `d2`
                     :              :                       :              +- SubqueryAlias `date_dim`
                     :              :                       :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              :                       +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :              :                          +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :              :                             +- Join Inner
                     :              :                                :- Join Inner
                     :              :                                :  :- SubqueryAlias `web_sales`
                     :              :                                :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :              :                                :  +- SubqueryAlias `iws`
                     :              :                                :     +- SubqueryAlias `item`
                     :              :                                :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                                +- SubqueryAlias `d3`
                     :              :                                   +- SubqueryAlias `date_dim`
                     :              :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              +- Join Inner
                     :                 :- Join Inner
                     :                 :  :- SubqueryAlias `catalog_sales`
                     :                 :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :                 :  +- SubqueryAlias `item`
                     :                 :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :                 +- SubqueryAlias `date_dim`
                     :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- Project [channel#11788, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11789, number_sales#11790L]
                        +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2)))#11819 as decimal(32,6)) > cast(scalar-subquery#11792 [] as decimal(32,6)))
                           :  +- Project [average_sales#11803]
                           :     +- SubqueryAlias `avg_sales`
                           :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#11797 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#11798 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#11803]
                           :           +- SubqueryAlias `x`
                           :              +- Union
                           :                 :- Union
                           :                 :  :- Project [ss_quantity#140 AS quantity#11797, ss_list_price#142 AS list_price#11798]
                           :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= 2001)))
                           :                 :  :     +- Join Inner
                           :                 :  :        :- SubqueryAlias `store_sales`
                           :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                 :  :        +- SubqueryAlias `date_dim`
                           :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :                 :  +- Project [cs_quantity#18 AS quantity#11799, cs_list_price#20 AS list_price#11800]
                           :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                           :                 :        +- Join Inner
                           :                 :           :- SubqueryAlias `catalog_sales`
                           :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :                 :           +- SubqueryAlias `date_dim`
                           :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :                 +- Project [ws_quantity#234 AS quantity#11801, ws_list_price#236 AS list_price#11802]
                           :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                           :                       +- Join Inner
                           :                          :- SubqueryAlias `web_sales`
                           :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :                          +- SubqueryAlias `date_dim`
                           :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [web AS channel#11788, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2))) AS sales#11789, count(1) AS number_sales#11790L, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2)))#11819]
                              +- Filter (((ws_item_sk#219 IN (list#11791 []) && (ws_item_sk#219 = i_item_sk#564)) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = (1999 + 2)) && (d_moy#500 = 11)))
                                 :  +- Project [ss_item_sk#11796]
                                 :     +- SubqueryAlias `cross_items`
                                 :        +- Project [i_item_sk#564 AS ss_item_sk#11796]
                                 :           +- Filter (((i_brand_id#571 = brand_id#11793) && (i_class_id#573 = class_id#11794)) && (i_category_id#575 = category_id#11795))
                                 :              +- Join Inner
                                 :                 :- SubqueryAlias `item`
                                 :                 :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                 +- SubqueryAlias `x`
                                 :                    +- Intersect false
                                 :                       :- Intersect false
                                 :                       :  :- Project [i_brand_id#571 AS brand_id#11793, i_class_id#573 AS class_id#11794, i_category_id#575 AS category_id#11795]
                                 :                       :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                                 :                       :  :     +- Join Inner
                                 :                       :  :        :- Join Inner
                                 :                       :  :        :  :- SubqueryAlias `store_sales`
                                 :                       :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :                       :  :        :  +- SubqueryAlias `iss`
                                 :                       :  :        :     +- SubqueryAlias `item`
                                 :                       :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                       :  :        +- SubqueryAlias `d1`
                                 :                       :  :           +- SubqueryAlias `date_dim`
                                 :                       :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 :                       :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                                 :                       :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                                 :                       :        +- Join Inner
                                 :                       :           :- Join Inner
                                 :                       :           :  :- SubqueryAlias `catalog_sales`
                                 :                       :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                                 :                       :           :  +- SubqueryAlias `ics`
                                 :                       :           :     +- SubqueryAlias `item`
                                 :                       :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                       :           +- SubqueryAlias `d2`
                                 :                       :              +- SubqueryAlias `date_dim`
                                 :                       :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 :                       +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                                 :                          +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                                 :                             +- Join Inner
                                 :                                :- Join Inner
                                 :                                :  :- SubqueryAlias `web_sales`
                                 :                                :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 :                                :  +- SubqueryAlias `iws`
                                 :                                :     +- SubqueryAlias `item`
                                 :                                :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                                +- SubqueryAlias `d3`
                                 :                                   +- SubqueryAlias `date_dim`
                                 :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- SubqueryAlias `web_sales`
                                    :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  +- SubqueryAlias `item`
                                    :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                    +- SubqueryAlias `date_dim`
                                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/03 17:27:25 INFO Query: 
== Query: q14a-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#11915 ASC NULLS FIRST, i_brand_id#11916 ASC NULLS FIRST, i_class_id#11917 ASC NULLS FIRST, i_category_id#11918 ASC NULLS FIRST], true
      +- Aggregate [channel#11915, i_brand_id#11916, i_class_id#11917, i_category_id#11918, spark_grouping_id#11910], [channel#11915, i_brand_id#11916, i_class_id#11917, i_category_id#11918, sum(sales#11862) AS sum(sales)#11905, sum(number_sales#11863L) AS sum(number_sales)#11906L]
         +- Expand [List(channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, channel#11911, i_brand_id#11912, i_class_id#11913, i_category_id#11914, 0), List(channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, channel#11911, i_brand_id#11912, i_class_id#11913, null, 1), List(channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, channel#11911, i_brand_id#11912, null, null, 3), List(channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, channel#11911, null, null, null, 7), List(channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, null, null, null, null, 15)], [channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, channel#11915, i_brand_id#11916, i_class_id#11917, i_category_id#11918, spark_grouping_id#11910]
            +- Project [channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L, channel#11861 AS channel#11911, i_brand_id#571 AS i_brand_id#11912, i_class_id#573 AS i_class_id#11913, i_category_id#575 AS i_category_id#11914]
               +- SubqueryAlias `y`
                  +- Union
                     :- Union
                     :  :- Project [channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11862, number_sales#11863L]
                     :  :  +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#11896 as decimal(32,6)) > cast(scalar-subquery#11865 [] as decimal(32,6)))
                     :  :     :  +- Project [average_sales#11886]
                     :  :     :     +- SubqueryAlias `avg_sales`
                     :  :     :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#11880 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#11881 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#11886]
                     :  :     :           +- SubqueryAlias `x`
                     :  :     :              +- Union
                     :  :     :                 :- Union
                     :  :     :                 :  :- Project [ss_quantity#140 AS quantity#11880, ss_list_price#142 AS list_price#11881]
                     :  :     :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= 2001)))
                     :  :     :                 :  :     +- Join Inner
                     :  :     :                 :  :        :- SubqueryAlias `store_sales`
                     :  :     :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :     :                 :  :        +- SubqueryAlias `date_dim`
                     :  :     :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :     :                 :  +- Project [cs_quantity#18 AS quantity#11882, cs_list_price#20 AS list_price#11883]
                     :  :     :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :     :                 :        +- Join Inner
                     :  :     :                 :           :- SubqueryAlias `catalog_sales`
                     :  :     :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :  :     :                 :           +- SubqueryAlias `date_dim`
                     :  :     :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :     :                 +- Project [ws_quantity#234 AS quantity#11884, ws_list_price#236 AS list_price#11885]
                     :  :     :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :     :                       +- Join Inner
                     :  :     :                          :- SubqueryAlias `web_sales`
                     :  :     :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :  :     :                          +- SubqueryAlias `date_dim`
                     :  :     :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :     +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [store AS channel#11861, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sales#11862, count(1) AS number_sales#11863L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#11896]
                     :  :        +- Filter (((ss_item_sk#132 IN (list#11864 []) && (ss_item_sk#132 = i_item_sk#564)) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = (1999 + 2)) && (d_moy#500 = 11)))
                     :  :           :  +- Project [ss_item_sk#11879]
                     :  :           :     +- SubqueryAlias `cross_items`
                     :  :           :        +- Project [i_item_sk#564 AS ss_item_sk#11879]
                     :  :           :           +- Filter (((i_brand_id#571 = brand_id#11876) && (i_class_id#573 = class_id#11877)) && (i_category_id#575 = category_id#11878))
                     :  :           :              +- Join Inner
                     :  :           :                 :- SubqueryAlias `item`
                     :  :           :                 :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                 +- SubqueryAlias `x`
                     :  :           :                    +- Intersect false
                     :  :           :                       :- Intersect false
                     :  :           :                       :  :- Project [i_brand_id#571 AS brand_id#11876, i_class_id#573 AS class_id#11877, i_category_id#575 AS category_id#11878]
                     :  :           :                       :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :           :                       :  :     +- Join Inner
                     :  :           :                       :  :        :- Join Inner
                     :  :           :                       :  :        :  :- SubqueryAlias `store_sales`
                     :  :           :                       :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :           :                       :  :        :  +- SubqueryAlias `iss`
                     :  :           :                       :  :        :     +- SubqueryAlias `item`
                     :  :           :                       :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                       :  :        +- SubqueryAlias `d1`
                     :  :           :                       :  :           +- SubqueryAlias `date_dim`
                     :  :           :                       :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :           :                       :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :  :           :                       :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :           :                       :        +- Join Inner
                     :  :           :                       :           :- Join Inner
                     :  :           :                       :           :  :- SubqueryAlias `catalog_sales`
                     :  :           :                       :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :  :           :                       :           :  +- SubqueryAlias `ics`
                     :  :           :                       :           :     +- SubqueryAlias `item`
                     :  :           :                       :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                       :           +- SubqueryAlias `d2`
                     :  :           :                       :              +- SubqueryAlias `date_dim`
                     :  :           :                       :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :           :                       +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :  :           :                          +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :  :           :                             +- Join Inner
                     :  :           :                                :- Join Inner
                     :  :           :                                :  :- SubqueryAlias `web_sales`
                     :  :           :                                :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :  :           :                                :  +- SubqueryAlias `iws`
                     :  :           :                                :     +- SubqueryAlias `item`
                     :  :           :                                :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :           :                                +- SubqueryAlias `d3`
                     :  :           :                                   +- SubqueryAlias `date_dim`
                     :  :           :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- SubqueryAlias `store_sales`
                     :  :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :              :  +- SubqueryAlias `item`
                     :  :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :              +- SubqueryAlias `date_dim`
                     :  :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- Project [channel#11866, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11867, number_sales#11868L]
                     :     +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2)))#11899 as decimal(32,6)) > cast(scalar-subquery#11870 [] as decimal(32,6)))
                     :        :  +- Project [average_sales#11886]
                     :        :     +- SubqueryAlias `avg_sales`
                     :        :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#11880 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#11881 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#11886]
                     :        :           +- SubqueryAlias `x`
                     :        :              +- Union
                     :        :                 :- Union
                     :        :                 :  :- Project [ss_quantity#140 AS quantity#11880, ss_list_price#142 AS list_price#11881]
                     :        :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= 2001)))
                     :        :                 :  :     +- Join Inner
                     :        :                 :  :        :- SubqueryAlias `store_sales`
                     :        :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :        :                 :  :        +- SubqueryAlias `date_dim`
                     :        :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :        :                 :  +- Project [cs_quantity#18 AS quantity#11882, cs_list_price#20 AS list_price#11883]
                     :        :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :        :                 :        +- Join Inner
                     :        :                 :           :- SubqueryAlias `catalog_sales`
                     :        :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :        :                 :           +- SubqueryAlias `date_dim`
                     :        :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :        :                 +- Project [ws_quantity#234 AS quantity#11884, ws_list_price#236 AS list_price#11885]
                     :        :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :        :                       +- Join Inner
                     :        :                          :- SubqueryAlias `web_sales`
                     :        :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :        :                          +- SubqueryAlias `date_dim`
                     :        :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :        +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [catalog AS channel#11866, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2))) AS sales#11867, count(1) AS number_sales#11868L, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2)))#11899]
                     :           +- Filter (((cs_item_sk#15 IN (list#11869 []) && (cs_item_sk#15 = i_item_sk#564)) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = (1999 + 2)) && (d_moy#500 = 11)))
                     :              :  +- Project [ss_item_sk#11879]
                     :              :     +- SubqueryAlias `cross_items`
                     :              :        +- Project [i_item_sk#564 AS ss_item_sk#11879]
                     :              :           +- Filter (((i_brand_id#571 = brand_id#11876) && (i_class_id#573 = class_id#11877)) && (i_category_id#575 = category_id#11878))
                     :              :              +- Join Inner
                     :              :                 :- SubqueryAlias `item`
                     :              :                 :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                 +- SubqueryAlias `x`
                     :              :                    +- Intersect false
                     :              :                       :- Intersect false
                     :              :                       :  :- Project [i_brand_id#571 AS brand_id#11876, i_class_id#573 AS class_id#11877, i_category_id#575 AS category_id#11878]
                     :              :                       :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :              :                       :  :     +- Join Inner
                     :              :                       :  :        :- Join Inner
                     :              :                       :  :        :  :- SubqueryAlias `store_sales`
                     :              :                       :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :              :                       :  :        :  +- SubqueryAlias `iss`
                     :              :                       :  :        :     +- SubqueryAlias `item`
                     :              :                       :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                       :  :        +- SubqueryAlias `d1`
                     :              :                       :  :           +- SubqueryAlias `date_dim`
                     :              :                       :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              :                       :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :              :                       :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :              :                       :        +- Join Inner
                     :              :                       :           :- Join Inner
                     :              :                       :           :  :- SubqueryAlias `catalog_sales`
                     :              :                       :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :              :                       :           :  +- SubqueryAlias `ics`
                     :              :                       :           :     +- SubqueryAlias `item`
                     :              :                       :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                       :           +- SubqueryAlias `d2`
                     :              :                       :              +- SubqueryAlias `date_dim`
                     :              :                       :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              :                       +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                     :              :                          +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                     :              :                             +- Join Inner
                     :              :                                :- Join Inner
                     :              :                                :  :- SubqueryAlias `web_sales`
                     :              :                                :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :              :                                :  +- SubqueryAlias `iws`
                     :              :                                :     +- SubqueryAlias `item`
                     :              :                                :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :              :                                +- SubqueryAlias `d3`
                     :              :                                   +- SubqueryAlias `date_dim`
                     :              :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              +- Join Inner
                     :                 :- Join Inner
                     :                 :  :- SubqueryAlias `catalog_sales`
                     :                 :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :                 :  +- SubqueryAlias `item`
                     :                 :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :                 +- SubqueryAlias `date_dim`
                     :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- Project [channel#11871, i_brand_id#571, i_class_id#573, i_category_id#575, sales#11872, number_sales#11873L]
                        +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2)))#11902 as decimal(32,6)) > cast(scalar-subquery#11875 [] as decimal(32,6)))
                           :  +- Project [average_sales#11886]
                           :     +- SubqueryAlias `avg_sales`
                           :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#11880 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#11881 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#11886]
                           :           +- SubqueryAlias `x`
                           :              +- Union
                           :                 :- Union
                           :                 :  :- Project [ss_quantity#140 AS quantity#11880, ss_list_price#142 AS list_price#11881]
                           :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= 2001)))
                           :                 :  :     +- Join Inner
                           :                 :  :        :- SubqueryAlias `store_sales`
                           :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                 :  :        +- SubqueryAlias `date_dim`
                           :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :                 :  +- Project [cs_quantity#18 AS quantity#11882, cs_list_price#20 AS list_price#11883]
                           :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                           :                 :        +- Join Inner
                           :                 :           :- SubqueryAlias `catalog_sales`
                           :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :                 :           +- SubqueryAlias `date_dim`
                           :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :                 +- Project [ws_quantity#234 AS quantity#11884, ws_list_price#236 AS list_price#11885]
                           :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                           :                       +- Join Inner
                           :                          :- SubqueryAlias `web_sales`
                           :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :                          +- SubqueryAlias `date_dim`
                           :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [web AS channel#11871, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2))) AS sales#11872, count(1) AS number_sales#11873L, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2)))#11902]
                              +- Filter (((ws_item_sk#219 IN (list#11874 []) && (ws_item_sk#219 = i_item_sk#564)) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = (1999 + 2)) && (d_moy#500 = 11)))
                                 :  +- Project [ss_item_sk#11879]
                                 :     +- SubqueryAlias `cross_items`
                                 :        +- Project [i_item_sk#564 AS ss_item_sk#11879]
                                 :           +- Filter (((i_brand_id#571 = brand_id#11876) && (i_class_id#573 = class_id#11877)) && (i_category_id#575 = category_id#11878))
                                 :              +- Join Inner
                                 :                 :- SubqueryAlias `item`
                                 :                 :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                 +- SubqueryAlias `x`
                                 :                    +- Intersect false
                                 :                       :- Intersect false
                                 :                       :  :- Project [i_brand_id#571 AS brand_id#11876, i_class_id#573 AS class_id#11877, i_category_id#575 AS category_id#11878]
                                 :                       :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                                 :                       :  :     +- Join Inner
                                 :                       :  :        :- Join Inner
                                 :                       :  :        :  :- SubqueryAlias `store_sales`
                                 :                       :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :                       :  :        :  +- SubqueryAlias `iss`
                                 :                       :  :        :     +- SubqueryAlias `item`
                                 :                       :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                       :  :        +- SubqueryAlias `d1`
                                 :                       :  :           +- SubqueryAlias `date_dim`
                                 :                       :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 :                       :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                                 :                       :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                                 :                       :        +- Join Inner
                                 :                       :           :- Join Inner
                                 :                       :           :  :- SubqueryAlias `catalog_sales`
                                 :                       :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                                 :                       :           :  +- SubqueryAlias `ics`
                                 :                       :           :     +- SubqueryAlias `item`
                                 :                       :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                       :           +- SubqueryAlias `d2`
                                 :                       :              +- SubqueryAlias `date_dim`
                                 :                       :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 :                       +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                                 :                          +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                                 :                             +- Join Inner
                                 :                                :- Join Inner
                                 :                                :  :- SubqueryAlias `web_sales`
                                 :                                :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 :                                :  +- SubqueryAlias `iws`
                                 :                                :     +- SubqueryAlias `item`
                                 :                                :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :                                +- SubqueryAlias `d3`
                                 :                                   +- SubqueryAlias `date_dim`
                                 :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- SubqueryAlias `web_sales`
                                    :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  +- SubqueryAlias `item`
                                    :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                    +- SubqueryAlias `date_dim`
                                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
19/10/03 17:31:03 WARN TaskSetManager: Lost task 16650.0 in stage 191.0 (TID 337501, 192.168.20.136, executor 79): java.io.IOException: can not read FileMetaData: org.apache.hadoop.fs.s3a.AWSClientIOException: read on s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_sales/part-01798-10e4b037-4521-4ea1-80ea-c6a987fb8fc8-c000.snappy.parquet: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at org.apache.parquet.format.Util.readFileMetaData(Util.java:195)
	at org.apache.parquet.format.Util.readFileMetaData(Util.java:85)
	at org.apache.parquet.format.converter.ParquetMetadataConverter$2.visit(ParquetMetadataConverter.java:871)
	at org.apache.parquet.format.converter.ParquetMetadataConverter$2.visit(ParquetMetadataConverter.java:863)
	at org.apache.parquet.format.converter.ParquetMetadataConverter$SkipMetadataFilter.accept(ParquetMetadataConverter.java:757)
	at org.apache.parquet.format.converter.ParquetMetadataConverter.readParquetMetadata(ParquetMetadataConverter.java:863)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:532)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:505)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:499)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:448)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.footerFileMetaData$lzycompute$1(ParquetFileFormat.scala:371)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.footerFileMetaData$1(ParquetFileFormat.scala:370)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.apply(ParquetFileFormat.scala:374)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.apply(ParquetFileFormat.scala:352)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:124)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:177)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:101)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage4.scan_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage4.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.agg_doAggregateWithoutKey_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
	Suppressed: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
		at com.amazonaws.util.LengthCheckInputStream.checkLength(LengthCheckInputStream.java:151)
		at com.amazonaws.util.LengthCheckInputStream.read(LengthCheckInputStream.java:93)
		at com.amazonaws.internal.SdkFilterInputStream.read(SdkFilterInputStream.java:76)
		at org.apache.hadoop.fs.s3a.S3AInputStream.closeStream(S3AInputStream.java:529)
		at org.apache.hadoop.fs.s3a.S3AInputStream.close(S3AInputStream.java:490)
		at java.io.FilterInputStream.close(FilterInputStream.java:181)
		at org.apache.parquet.io.DelegatingSeekableInputStream.close(DelegatingSeekableInputStream.java:50)
		at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:500)
		... 27 more
Caused by: shaded.parquet.org.apache.thrift.transport.TTransportException: org.apache.hadoop.fs.s3a.AWSClientIOException: read on s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_sales/part-01798-10e4b037-4521-4ea1-80ea-c6a987fb8fc8-c000.snappy.parquet: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at shaded.parquet.org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:129)
	at shaded.parquet.org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)
	at shaded.parquet.org.apache.thrift.protocol.TCompactProtocol.readByte(TCompactProtocol.java:634)
	at shaded.parquet.org.apache.thrift.protocol.TCompactProtocol.readFieldBegin(TCompactProtocol.java:539)
	at org.apache.parquet.format.InterningProtocol.readFieldBegin(InterningProtocol.java:158)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:108)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:138)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:112)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:112)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:138)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:112)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:138)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:60)
	at org.apache.parquet.format.event.SkippingFieldConsumer.consumeField(Consumers.java:155)
	at org.apache.parquet.format.event.Consumers$DelegatingFieldConsumer.consumeField(Consumers.java:99)
	at org.apache.parquet.format.event.EventBasedThriftReader.readStructContent(EventBasedThriftReader.java:73)
	at org.apache.parquet.format.event.EventBasedThriftReader.readStruct(EventBasedThriftReader.java:57)
	at org.apache.parquet.format.Util.readFileMetaData(Util.java:192)
	... 35 more
Caused by: org.apache.hadoop.fs.s3a.AWSClientIOException: read on s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_sales/part-01798-10e4b037-4521-4ea1-80ea-c6a987fb8fc8-c000.snappy.parquet: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at org.apache.hadoop.fs.s3a.S3AUtils.translateException(S3AUtils.java:177)
	at org.apache.hadoop.fs.s3a.Invoker.once(Invoker.java:111)
	at org.apache.hadoop.fs.s3a.Invoker.lambda$retry$3(Invoker.java:260)
	at org.apache.hadoop.fs.s3a.Invoker.retryUntranslated(Invoker.java:317)
	at org.apache.hadoop.fs.s3a.Invoker.retry(Invoker.java:256)
	at org.apache.hadoop.fs.s3a.Invoker.retry(Invoker.java:231)
	at org.apache.hadoop.fs.s3a.S3AInputStream.read(S3AInputStream.java:441)
	at java.io.DataInputStream.read(DataInputStream.java:149)
	at org.apache.parquet.io.DelegatingSeekableInputStream.read(DelegatingSeekableInputStream.java:66)
	at shaded.parquet.org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:127)
	... 52 more
Caused by: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at com.amazonaws.util.LengthCheckInputStream.checkLength(LengthCheckInputStream.java:151)
	at com.amazonaws.util.LengthCheckInputStream.read(LengthCheckInputStream.java:109)
	at com.amazonaws.internal.SdkFilterInputStream.read(SdkFilterInputStream.java:82)
	at org.apache.hadoop.fs.s3a.S3AInputStream.lambda$read$3(S3AInputStream.java:445)
	at org.apache.hadoop.fs.s3a.Invoker.once(Invoker.java:109)
	... 60 more

19/10/03 17:31:06 WARN TaskSetManager: Lost task 16930.0 in stage 191.0 (TID 337781, 192.168.47.64, executor 40): java.io.IOException: can not read FileMetaData: org.apache.hadoop.fs.s3a.AWSClientIOException: read on s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_sales/part-00579-10e4b037-4521-4ea1-80ea-c6a987fb8fc8-c000.snappy.parquet: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at org.apache.parquet.format.Util.readFileMetaData(Util.java:195)
	at org.apache.parquet.format.Util.readFileMetaData(Util.java:85)
	at org.apache.parquet.format.converter.ParquetMetadataConverter$2.visit(ParquetMetadataConverter.java:871)
	at org.apache.parquet.format.converter.ParquetMetadataConverter$2.visit(ParquetMetadataConverter.java:863)
	at org.apache.parquet.format.converter.ParquetMetadataConverter$SkipMetadataFilter.accept(ParquetMetadataConverter.java:757)
	at org.apache.parquet.format.converter.ParquetMetadataConverter.readParquetMetadata(ParquetMetadataConverter.java:863)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:532)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:505)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:499)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:448)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.footerFileMetaData$lzycompute$1(ParquetFileFormat.scala:371)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.footerFileMetaData$1(ParquetFileFormat.scala:370)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.apply(ParquetFileFormat.scala:374)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.apply(ParquetFileFormat.scala:352)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:124)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:177)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:101)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage4.scan_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage4.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.agg_doAggregateWithoutKey_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
	Suppressed: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
		at com.amazonaws.util.LengthCheckInputStream.checkLength(LengthCheckInputStream.java:151)
		at com.amazonaws.util.LengthCheckInputStream.read(LengthCheckInputStream.java:93)
		at com.amazonaws.internal.SdkFilterInputStream.read(SdkFilterInputStream.java:76)
		at org.apache.hadoop.fs.s3a.S3AInputStream.closeStream(S3AInputStream.java:529)
		at org.apache.hadoop.fs.s3a.S3AInputStream.close(S3AInputStream.java:490)
		at java.io.FilterInputStream.close(FilterInputStream.java:181)
		at org.apache.parquet.io.DelegatingSeekableInputStream.close(DelegatingSeekableInputStream.java:50)
		at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:500)
		... 27 more
Caused by: shaded.parquet.org.apache.thrift.transport.TTransportException: org.apache.hadoop.fs.s3a.AWSClientIOException: read on s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_sales/part-00579-10e4b037-4521-4ea1-80ea-c6a987fb8fc8-c000.snappy.parquet: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at shaded.parquet.org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:129)
	at shaded.parquet.org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)
	at shaded.parquet.org.apache.thrift.protocol.TCompactProtocol.readByte(TCompactProtocol.java:634)
	at shaded.parquet.org.apache.thrift.protocol.TCompactProtocol.readFieldBegin(TCompactProtocol.java:539)
	at org.apache.parquet.format.InterningProtocol.readFieldBegin(InterningProtocol.java:158)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:108)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:138)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:112)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:112)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:138)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:112)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:138)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:60)
	at org.apache.parquet.format.event.SkippingFieldConsumer.consumeField(Consumers.java:155)
	at org.apache.parquet.format.event.Consumers$DelegatingFieldConsumer.consumeField(Consumers.java:99)
	at org.apache.parquet.format.event.EventBasedThriftReader.readStructContent(EventBasedThriftReader.java:73)
	at org.apache.parquet.format.event.EventBasedThriftReader.readStruct(EventBasedThriftReader.java:57)
	at org.apache.parquet.format.Util.readFileMetaData(Util.java:192)
	... 35 more
Caused by: org.apache.hadoop.fs.s3a.AWSClientIOException: read on s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_sales/part-00579-10e4b037-4521-4ea1-80ea-c6a987fb8fc8-c000.snappy.parquet: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at org.apache.hadoop.fs.s3a.S3AUtils.translateException(S3AUtils.java:177)
	at org.apache.hadoop.fs.s3a.Invoker.once(Invoker.java:111)
	at org.apache.hadoop.fs.s3a.Invoker.lambda$retry$3(Invoker.java:260)
	at org.apache.hadoop.fs.s3a.Invoker.retryUntranslated(Invoker.java:317)
	at org.apache.hadoop.fs.s3a.Invoker.retry(Invoker.java:256)
	at org.apache.hadoop.fs.s3a.Invoker.retry(Invoker.java:231)
	at org.apache.hadoop.fs.s3a.S3AInputStream.read(S3AInputStream.java:441)
	at java.io.DataInputStream.read(DataInputStream.java:149)
	at org.apache.parquet.io.DelegatingSeekableInputStream.read(DelegatingSeekableInputStream.java:66)
	at shaded.parquet.org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:127)
	... 52 more
Caused by: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at com.amazonaws.util.LengthCheckInputStream.checkLength(LengthCheckInputStream.java:151)
	at com.amazonaws.util.LengthCheckInputStream.read(LengthCheckInputStream.java:109)
	at com.amazonaws.internal.SdkFilterInputStream.read(SdkFilterInputStream.java:82)
	at org.apache.hadoop.fs.s3a.S3AInputStream.lambda$read$3(S3AInputStream.java:445)
	at org.apache.hadoop.fs.s3a.Invoker.once(Invoker.java:109)
	... 60 more

19/10/03 17:53:44 WARN HeartbeatReceiver: Removing executor 39 with no recent heartbeats: 146384 ms exceeds timeout 120000 ms
19/10/03 17:53:44 ERROR TaskSchedulerImpl: Lost executor 39 on 192.168.22.108: Executor heartbeat timed out after 146384 ms
19/10/03 17:53:44 WARN TaskSetManager: Lost task 69.0 in stage 200.0 (TID 408935, 192.168.22.108, executor 39): ExecutorLostFailure (executor 39 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 146384 ms
19/10/03 17:53:44 WARN HeartbeatReceiver: Removing executor 71 with no recent heartbeats: 132366 ms exceeds timeout 120000 ms
19/10/03 17:53:44 ERROR TaskSchedulerImpl: Lost executor 71 on 192.168.9.206: Executor heartbeat timed out after 132366 ms
19/10/03 17:53:44 WARN TaskSetManager: Lost task 12.0 in stage 200.0 (TID 408878, 192.168.9.206, executor 71): ExecutorLostFailure (executor 71 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 132366 ms
19/10/03 17:53:44 ERROR TaskSchedulerImpl: Lost executor 39 on 192.168.22.108: The executor with id 39 was deleted by a user or the framework.
19/10/03 17:53:44 ERROR TaskSchedulerImpl: Lost executor 71 on 192.168.9.206: The executor with id 71 was deleted by a user or the framework.
19/10/03 17:53:46 WARN TransportChannelHandler: Exception in connection from /192.168.22.108:42120
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:53:59 WARN TransportChannelHandler: Exception in connection from /192.168.9.206:42268
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:54:05 WARN TaskSetManager: Lost task 157.0 in stage 200.0 (TID 409023, 192.168.35.135, executor 19): FetchFailed(BlockManagerId(39, 192.168.22.108, 36937, None), shuffleId=100, mapId=80, reduceId=157, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.22.108:36937
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.22.108:36937
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.22.108:36937
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 17:54:05 WARN TaskSetManager: Lost task 186.0 in stage 200.0 (TID 409052, 192.168.32.93, executor 92): FetchFailed(BlockManagerId(39, 192.168.22.108, 36937, None), shuffleId=100, mapId=80, reduceId=186, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.22.108:36937
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.22.108:36937
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.22.108:36937
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 17:54:14 WARN TaskSetManager: Lost task 175.0 in stage 200.0 (TID 409041, 192.168.44.162, executor 23): FetchFailed(BlockManagerId(39, 192.168.22.108, 36937, None), shuffleId=100, mapId=3374, reduceId=175, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.22.108:36937
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.22.108:36937
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.22.108:36937
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 17:54:18 WARN TaskSetManager: Lost task 63.0 in stage 200.0 (TID 408929, 192.168.46.107, executor 43): FetchFailed(BlockManagerId(71, 192.168.9.206, 33423, None), shuffleId=100, mapId=8621, reduceId=63, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.9.206:33423
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.9.206:33423
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.9.206:33423
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 17:54:18 WARN TaskSetManager: Lost task 12.1 in stage 200.0 (TID 409067, 192.168.62.186, executor 60): FetchFailed(BlockManagerId(71, 192.168.9.206, 33423, None), shuffleId=101, mapId=1270, reduceId=12, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.9.206:33423
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.9.206:33423
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.9.206:33423
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 17:54:25 WARN TaskSetManager: Lost task 69.1 in stage 200.0 (TID 409066, 192.168.28.108, executor 32): FetchFailed(BlockManagerId(71, 192.168.9.206, 33423, None), shuffleId=101, mapId=1270, reduceId=69, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.9.206:33423
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.9.206:33423
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.9.206:33423
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 17:54:29 WARN TaskSetManager: Lost task 123.0 in stage 200.0 (TID 408989, 192.168.42.69, executor 83): FetchFailed(BlockManagerId(39, 192.168.22.108, 36937, None), shuffleId=100, mapId=80, reduceId=123, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.22.108:36937
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.22.108:36937
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.22.108:36937
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 17:54:44 WARN HeartbeatReceiver: Removing executor 94 with no recent heartbeats: 150234 ms exceeds timeout 120000 ms
19/10/03 17:54:44 ERROR TaskSchedulerImpl: Lost executor 94 on 192.168.34.94: Executor heartbeat timed out after 150234 ms
19/10/03 17:54:44 WARN TaskSetManager: Lost task 19.0 in stage 200.0 (TID 408885, 192.168.34.94, executor 94): ExecutorLostFailure (executor 94 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 150234 ms
19/10/03 17:54:44 ERROR TaskSchedulerImpl: Lost executor 94 on 192.168.34.94: The executor with id 94 was deleted by a user or the framework.
19/10/03 17:55:25 WARN TaskSetManager: Lost task 193.0 in stage 200.0 (TID 409059, 192.168.28.43, executor 52): FetchFailed(BlockManagerId(39, 192.168.22.108, 36937, None), shuffleId=100, mapId=80, reduceId=193, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.22.108:36937
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.22.108:36937
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.22.108:36937
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 17:55:44 WARN HeartbeatReceiver: Removing executor 54 with no recent heartbeats: 164400 ms exceeds timeout 120000 ms
19/10/03 17:55:44 ERROR TaskSchedulerImpl: Lost executor 54 on 192.168.2.52: Executor heartbeat timed out after 164400 ms
19/10/03 17:55:44 WARN TaskSetManager: Lost task 168.0 in stage 200.0 (TID 409034, 192.168.2.52, executor 54): ExecutorLostFailure (executor 54 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 164400 ms
19/10/03 17:55:44 WARN HeartbeatReceiver: Removing executor 82 with no recent heartbeats: 139894 ms exceeds timeout 120000 ms
19/10/03 17:55:44 ERROR TaskSchedulerImpl: Lost executor 82 on 192.168.58.110: Executor heartbeat timed out after 139894 ms
19/10/03 17:55:44 WARN TaskSetManager: Lost task 74.0 in stage 200.0 (TID 408940, 192.168.58.110, executor 82): ExecutorLostFailure (executor 82 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 139894 ms
19/10/03 17:55:44 ERROR TaskSchedulerImpl: Lost executor 54 on 192.168.2.52: The executor with id 54 was deleted by a user or the framework.
19/10/03 17:55:44 ERROR TaskSchedulerImpl: Lost executor 82 on 192.168.58.110: The executor with id 82 was deleted by a user or the framework.
19/10/03 17:55:46 WARN TransportChannelHandler: Exception in connection from /192.168.2.52:41492
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:55:50 WARN TransportChannelHandler: Exception in connection from /192.168.58.110:34586
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:56:44 WARN HeartbeatReceiver: Removing executor 78 with no recent heartbeats: 151224 ms exceeds timeout 120000 ms
19/10/03 17:56:44 ERROR TaskSchedulerImpl: Lost executor 78 on 192.168.45.91: Executor heartbeat timed out after 151224 ms
19/10/03 17:56:44 WARN TaskSetManager: Lost task 82.0 in stage 200.0 (TID 408948, 192.168.45.91, executor 78): ExecutorLostFailure (executor 78 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 151224 ms
19/10/03 17:56:44 WARN HeartbeatReceiver: Removing executor 33 with no recent heartbeats: 147518 ms exceeds timeout 120000 ms
19/10/03 17:56:44 ERROR TaskSchedulerImpl: Lost executor 33 on 192.168.45.64: Executor heartbeat timed out after 147518 ms
19/10/03 17:56:44 WARN TaskSetManager: Lost task 47.0 in stage 200.0 (TID 408913, 192.168.45.64, executor 33): ExecutorLostFailure (executor 33 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 147518 ms
19/10/03 17:56:44 WARN HeartbeatReceiver: Removing executor 36 with no recent heartbeats: 155785 ms exceeds timeout 120000 ms
19/10/03 17:56:44 ERROR TaskSchedulerImpl: Lost executor 36 on 192.168.20.54: Executor heartbeat timed out after 155785 ms
19/10/03 17:56:44 WARN TaskSetManager: Lost task 115.0 in stage 200.0 (TID 408981, 192.168.20.54, executor 36): ExecutorLostFailure (executor 36 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 155785 ms
19/10/03 17:56:44 WARN HeartbeatReceiver: Removing executor 74 with no recent heartbeats: 143186 ms exceeds timeout 120000 ms
19/10/03 17:56:44 ERROR TaskSchedulerImpl: Lost executor 74 on 192.168.7.159: Executor heartbeat timed out after 143186 ms
19/10/03 17:56:44 WARN TaskSetManager: Lost task 92.0 in stage 200.0 (TID 408958, 192.168.7.159, executor 74): ExecutorLostFailure (executor 74 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 143186 ms
19/10/03 17:56:44 WARN HeartbeatReceiver: Removing executor 17 with no recent heartbeats: 140302 ms exceeds timeout 120000 ms
19/10/03 17:56:44 ERROR TaskSchedulerImpl: Lost executor 17 on 192.168.27.51: Executor heartbeat timed out after 140302 ms
19/10/03 17:56:44 WARN TaskSetManager: Lost task 120.0 in stage 200.0 (TID 408986, 192.168.27.51, executor 17): ExecutorLostFailure (executor 17 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 140302 ms
19/10/03 17:56:44 WARN HeartbeatReceiver: Removing executor 26 with no recent heartbeats: 127050 ms exceeds timeout 120000 ms
19/10/03 17:56:44 ERROR TaskSchedulerImpl: Lost executor 26 on 192.168.47.99: Executor heartbeat timed out after 127050 ms
19/10/03 17:56:44 WARN TaskSetManager: Lost task 38.0 in stage 200.0 (TID 408904, 192.168.47.99, executor 26): ExecutorLostFailure (executor 26 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 127050 ms
19/10/03 17:56:44 WARN HeartbeatReceiver: Removing executor 34 with no recent heartbeats: 120240 ms exceeds timeout 120000 ms
19/10/03 17:56:44 ERROR TaskSchedulerImpl: Lost executor 34 on 192.168.27.244: Executor heartbeat timed out after 120240 ms
19/10/03 17:56:44 WARN TaskSetManager: Lost task 131.0 in stage 200.0 (TID 408997, 192.168.27.244, executor 34): ExecutorLostFailure (executor 34 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 120240 ms
19/10/03 17:56:44 WARN HeartbeatReceiver: Removing executor 16 with no recent heartbeats: 167477 ms exceeds timeout 120000 ms
19/10/03 17:56:44 ERROR TaskSchedulerImpl: Lost executor 16 on 192.168.8.136: Executor heartbeat timed out after 167477 ms
19/10/03 17:56:44 WARN TaskSetManager: Lost task 90.0 in stage 200.0 (TID 408956, 192.168.8.136, executor 16): ExecutorLostFailure (executor 16 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 167477 ms
19/10/03 17:56:44 WARN HeartbeatReceiver: Removing executor 10 with no recent heartbeats: 176170 ms exceeds timeout 120000 ms
19/10/03 17:56:44 ERROR TaskSchedulerImpl: Lost executor 10 on 192.168.37.35: Executor heartbeat timed out after 176170 ms
19/10/03 17:56:44 WARN TaskSetManager: Lost task 24.0 in stage 200.0 (TID 408890, 192.168.37.35, executor 10): ExecutorLostFailure (executor 10 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 176170 ms
19/10/03 17:56:44 ERROR TaskSchedulerImpl: Lost executor 78 on 192.168.45.91: The executor with id 78 was deleted by a user or the framework.
19/10/03 17:56:44 ERROR TaskSchedulerImpl: Lost executor 33 on 192.168.45.64: The executor with id 33 was deleted by a user or the framework.
19/10/03 17:56:44 ERROR TaskSchedulerImpl: Lost executor 36 on 192.168.20.54: The executor with id 36 was deleted by a user or the framework.
19/10/03 17:56:44 ERROR TaskSchedulerImpl: Lost executor 74 on 192.168.7.159: The executor with id 74 was deleted by a user or the framework.
19/10/03 17:56:44 ERROR TaskSchedulerImpl: Lost executor 17 on 192.168.27.51: The executor with id 17 was deleted by a user or the framework.
19/10/03 17:56:44 ERROR TaskSchedulerImpl: Lost executor 26 on 192.168.47.99: The executor with id 26 was deleted by a user or the framework.
19/10/03 17:56:44 ERROR TaskSchedulerImpl: Lost executor 34 on 192.168.27.244: The executor with id 34 was deleted by a user or the framework.
19/10/03 17:56:44 ERROR TaskSchedulerImpl: Lost executor 16 on 192.168.8.136: The executor with id 16 was deleted by a user or the framework.
19/10/03 17:56:44 ERROR TaskSchedulerImpl: Lost executor 10 on 192.168.37.35: The executor with id 10 was deleted by a user or the framework.
19/10/03 17:56:46 WARN TransportChannelHandler: Exception in connection from /192.168.20.54:53840
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:56:46 WARN TransportChannelHandler: Exception in connection from /192.168.8.136:40028
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:56:46 WARN TransportChannelHandler: Exception in connection from /192.168.7.159:45336
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:56:46 WARN TransportChannelHandler: Exception in connection from /192.168.27.51:55748
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:56:50 WARN TransportChannelHandler: Exception in connection from /192.168.27.244:54512
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:56:50 WARN TransportChannelHandler: Exception in connection from /192.168.37.35:58070
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:56:51 WARN TransportChannelHandler: Exception in connection from /192.168.45.91:45060
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:56:54 WARN TransportChannelHandler: Exception in connection from /192.168.45.64:51812
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:56:57 WARN TaskSetManager: Lost task 150.0 in stage 200.0 (TID 409016, 192.168.21.103, executor 20): FetchFailed(BlockManagerId(10, 192.168.37.35, 38011, None), shuffleId=100, mapId=3694, reduceId=150, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.37.35:38011
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.37.35:38011
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.37.35:38011
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 17:56:57 WARN TaskSetManager: Lost task 190.0 in stage 200.0 (TID 409056, 192.168.14.170, executor 45): FetchFailed(BlockManagerId(10, 192.168.37.35, 38011, None), shuffleId=100, mapId=6038, reduceId=190, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.37.35:38011
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.37.35:38011
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.37.35:38011
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 17:56:58 WARN TransportChannelHandler: Exception in connection from /192.168.47.99:36044
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:57:00 WARN TaskSetManager: Lost task 192.0 in stage 200.0 (TID 409058, 192.168.0.28, executor 86): FetchFailed(BlockManagerId(74, 192.168.7.159, 38651, None), shuffleId=100, mapId=8685, reduceId=192, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.7.159:38651
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.7.159:38651
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.7.159:38651
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 17:57:44 WARN HeartbeatReceiver: Removing executor 11 with no recent heartbeats: 133169 ms exceeds timeout 120000 ms
19/10/03 17:57:44 ERROR TaskSchedulerImpl: Lost executor 11 on 192.168.0.109: Executor heartbeat timed out after 133169 ms
19/10/03 17:57:44 WARN TaskSetManager: Lost task 151.0 in stage 200.0 (TID 409017, 192.168.0.109, executor 11): ExecutorLostFailure (executor 11 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 133169 ms
19/10/03 17:57:44 WARN HeartbeatReceiver: Removing executor 46 with no recent heartbeats: 155872 ms exceeds timeout 120000 ms
19/10/03 17:57:44 ERROR TaskSchedulerImpl: Lost executor 46 on 192.168.37.151: Executor heartbeat timed out after 155872 ms
19/10/03 17:57:44 WARN TaskSetManager: Lost task 44.0 in stage 200.0 (TID 408910, 192.168.37.151, executor 46): ExecutorLostFailure (executor 46 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 155872 ms
19/10/03 17:57:44 ERROR TaskSchedulerImpl: Lost executor 11 on 192.168.0.109: The executor with id 11 was deleted by a user or the framework.
19/10/03 17:57:44 ERROR TaskSchedulerImpl: Lost executor 46 on 192.168.37.151: The executor with id 46 was deleted by a user or the framework.
19/10/03 17:57:46 WARN TransportChannelHandler: Exception in connection from /192.168.0.109:54030
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:58:05 WARN TransportChannelHandler: Exception in connection from /192.168.37.151:52790
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:58:44 WARN HeartbeatReceiver: Removing executor 5 with no recent heartbeats: 157028 ms exceeds timeout 120000 ms
19/10/03 17:58:44 ERROR TaskSchedulerImpl: Lost executor 5 on 192.168.25.142: Executor heartbeat timed out after 157028 ms
19/10/03 17:58:44 WARN TaskSetManager: Lost task 134.0 in stage 200.0 (TID 409000, 192.168.25.142, executor 5): ExecutorLostFailure (executor 5 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 157028 ms
19/10/03 17:58:44 WARN HeartbeatReceiver: Removing executor 40 with no recent heartbeats: 151310 ms exceeds timeout 120000 ms
19/10/03 17:58:44 ERROR TaskSchedulerImpl: Lost executor 40 on 192.168.47.64: Executor heartbeat timed out after 151310 ms
19/10/03 17:58:44 WARN TaskSetManager: Lost task 121.0 in stage 200.0 (TID 408987, 192.168.47.64, executor 40): ExecutorLostFailure (executor 40 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 151310 ms
19/10/03 17:58:44 WARN HeartbeatReceiver: Removing executor 3 with no recent heartbeats: 134076 ms exceeds timeout 120000 ms
19/10/03 17:58:44 ERROR TaskSchedulerImpl: Lost executor 3 on 192.168.4.136: Executor heartbeat timed out after 134076 ms
19/10/03 17:58:44 WARN TaskSetManager: Lost task 76.0 in stage 200.0 (TID 408942, 192.168.4.136, executor 3): ExecutorLostFailure (executor 3 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 134076 ms
19/10/03 17:58:44 ERROR TaskSchedulerImpl: Lost executor 5 on 192.168.25.142: The executor with id 5 was deleted by a user or the framework.
19/10/03 17:58:44 ERROR TaskSchedulerImpl: Lost executor 40 on 192.168.47.64: The executor with id 40 was deleted by a user or the framework.
19/10/03 17:58:44 ERROR TaskSchedulerImpl: Lost executor 3 on 192.168.4.136: The executor with id 3 was deleted by a user or the framework.
19/10/03 17:58:46 WARN TransportChannelHandler: Exception in connection from /192.168.25.142:53890
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:58:46 WARN TransportChannelHandler: Exception in connection from /192.168.4.136:44888
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:58:50 WARN TransportChannelHandler: Exception in connection from /192.168.47.64:53124
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:59:44 WARN HeartbeatReceiver: Removing executor 51 with no recent heartbeats: 175093 ms exceeds timeout 120000 ms
19/10/03 17:59:44 ERROR TaskSchedulerImpl: Lost executor 51 on 192.168.58.8: Executor heartbeat timed out after 175093 ms
19/10/03 17:59:44 WARN TaskSetManager: Lost task 178.0 in stage 200.0 (TID 409044, 192.168.58.8, executor 51): ExecutorLostFailure (executor 51 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 175093 ms
19/10/03 17:59:44 WARN HeartbeatReceiver: Removing executor 73 with no recent heartbeats: 160868 ms exceeds timeout 120000 ms
19/10/03 17:59:44 ERROR TaskSchedulerImpl: Lost executor 73 on 192.168.32.84: Executor heartbeat timed out after 160868 ms
19/10/03 17:59:44 WARN TaskSetManager: Lost task 89.0 in stage 200.0 (TID 408955, 192.168.32.84, executor 73): ExecutorLostFailure (executor 73 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 160868 ms
19/10/03 17:59:44 ERROR TaskSchedulerImpl: Lost executor 51 on 192.168.58.8: The executor with id 51 was deleted by a user or the framework.
19/10/03 17:59:44 ERROR TaskSchedulerImpl: Lost executor 73 on 192.168.32.84: The executor with id 73 was deleted by a user or the framework.
19/10/03 17:59:46 WARN TransportChannelHandler: Exception in connection from /192.168.58.8:56790
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 17:59:46 WARN TransportChannelHandler: Exception in connection from /192.168.32.84:42432
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:00:44 WARN HeartbeatReceiver: Removing executor 90 with no recent heartbeats: 158068 ms exceeds timeout 120000 ms
19/10/03 18:00:44 ERROR TaskSchedulerImpl: Lost executor 90 on 192.168.27.80: Executor heartbeat timed out after 158068 ms
19/10/03 18:00:44 WARN TaskSetManager: Lost task 83.0 in stage 200.0 (TID 408949, 192.168.27.80, executor 90): ExecutorLostFailure (executor 90 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 158068 ms
19/10/03 18:00:44 WARN HeartbeatReceiver: Removing executor 30 with no recent heartbeats: 151834 ms exceeds timeout 120000 ms
19/10/03 18:00:44 ERROR TaskSchedulerImpl: Lost executor 30 on 192.168.12.96: Executor heartbeat timed out after 151834 ms
19/10/03 18:00:44 WARN TaskSetManager: Lost task 198.0 in stage 200.0 (TID 409064, 192.168.12.96, executor 30): ExecutorLostFailure (executor 30 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 151834 ms
19/10/03 18:00:44 WARN HeartbeatReceiver: Removing executor 44 with no recent heartbeats: 159868 ms exceeds timeout 120000 ms
19/10/03 18:00:44 ERROR TaskSchedulerImpl: Lost executor 44 on 192.168.32.79: Executor heartbeat timed out after 159868 ms
19/10/03 18:00:44 WARN TaskSetManager: Lost task 116.0 in stage 200.0 (TID 408982, 192.168.32.79, executor 44): ExecutorLostFailure (executor 44 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 159868 ms
19/10/03 18:00:44 ERROR TaskSchedulerImpl: Lost executor 90 on 192.168.27.80: The executor with id 90 was deleted by a user or the framework.
19/10/03 18:00:44 ERROR TaskSchedulerImpl: Lost executor 30 on 192.168.12.96: The executor with id 30 was deleted by a user or the framework.
19/10/03 18:00:44 ERROR TaskSchedulerImpl: Lost executor 44 on 192.168.32.79: The executor with id 44 was deleted by a user or the framework.
19/10/03 18:00:46 WARN TransportChannelHandler: Exception in connection from /192.168.32.79:55102
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:00:46 WARN TransportChannelHandler: Exception in connection from /192.168.27.80:35892
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:00:46 WARN TransportChannelHandler: Exception in connection from /192.168.12.96:35834
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:01:44 WARN HeartbeatReceiver: Removing executor 50 with no recent heartbeats: 165384 ms exceeds timeout 120000 ms
19/10/03 18:01:44 ERROR TaskSchedulerImpl: Lost executor 50 on 192.168.42.36: Executor heartbeat timed out after 165384 ms
19/10/03 18:01:44 WARN TaskSetManager: Lost task 77.0 in stage 200.0 (TID 408943, 192.168.42.36, executor 50): ExecutorLostFailure (executor 50 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 165384 ms
19/10/03 18:01:44 ERROR TaskSchedulerImpl: Lost executor 50 on 192.168.42.36: The executor with id 50 was deleted by a user or the framework.
19/10/03 18:01:47 WARN TransportChannelHandler: Exception in connection from /192.168.42.36:49118
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:01:47 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.42.36:49118 is closed
19/10/03 18:01:47 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 352 from block manager BlockManagerId(50, 192.168.42.36, 39017, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:02:44 WARN HeartbeatReceiver: Removing executor 93 with no recent heartbeats: 127262 ms exceeds timeout 120000 ms
19/10/03 18:02:44 ERROR TaskSchedulerImpl: Lost executor 93 on 192.168.33.199: Executor heartbeat timed out after 127262 ms
19/10/03 18:02:44 WARN TaskSetManager: Lost task 21.0 in stage 200.0 (TID 408887, 192.168.33.199, executor 93): ExecutorLostFailure (executor 93 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 127262 ms
19/10/03 18:02:44 ERROR TaskSchedulerImpl: Lost executor 93 on 192.168.33.199: The executor with id 93 was deleted by a user or the framework.
19/10/03 18:02:48 WARN TransportChannelHandler: Exception in connection from /192.168.33.199:41708
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:02:48 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.33.199:41708 is closed
19/10/03 18:02:48 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 352 from block manager BlockManagerId(93, 192.168.33.199, 43797, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:03:11 WARN BlockManagerMaster: Failed to remove broadcast 352 with removeFromMaster = true - Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
org.apache.spark.rpc.RpcTimeoutException: Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at scala.util.Failure$$anonfun$recover$1.apply(Try.scala:216)
	at scala.util.Try$.apply(Try.scala:192)
	at scala.util.Failure.recover(Try.scala:216)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at org.spark_project.guava.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:293)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$1.execute(ExecutionContextImpl.scala:136)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.complete(Promise.scala:55)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:157)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.processBatch$1(BatchingExecutor.scala:63)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply$mcV$sp(BatchingExecutor.scala:78)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:72)
	at scala.concurrent.BatchingExecutor$Batch.run(BatchingExecutor.scala:54)
	at scala.concurrent.Future$InternalCallbackExecutor$.unbatchedExecute(Future.scala:601)
	at scala.concurrent.BatchingExecutor$class.execute(BatchingExecutor.scala:106)
	at scala.concurrent.Future$InternalCallbackExecutor$.execute(Future.scala:599)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.tryFailure(Promise.scala:112)
	at scala.concurrent.impl.Promise$DefaultPromise.tryFailure(Promise.scala:157)
	at org.apache.spark.rpc.netty.NettyRpcEnv.org$apache$spark$rpc$netty$NettyRpcEnv$$onFailure$1(NettyRpcEnv.scala:206)
	at org.apache.spark.rpc.netty.NettyRpcEnv$$anon$1.run(NettyRpcEnv.scala:243)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException: Cannot receive any reply from null in 120 seconds
	... 8 more
19/10/03 18:03:11 ERROR ContextCleaner: Error cleaning broadcast 352
org.apache.spark.rpc.RpcTimeoutException: Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at scala.util.Failure$$anonfun$recover$1.apply(Try.scala:216)
	at scala.util.Try$.apply(Try.scala:192)
	at scala.util.Failure.recover(Try.scala:216)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at org.spark_project.guava.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:293)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$1.execute(ExecutionContextImpl.scala:136)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.complete(Promise.scala:55)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:157)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.processBatch$1(BatchingExecutor.scala:63)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply$mcV$sp(BatchingExecutor.scala:78)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:72)
	at scala.concurrent.BatchingExecutor$Batch.run(BatchingExecutor.scala:54)
	at scala.concurrent.Future$InternalCallbackExecutor$.unbatchedExecute(Future.scala:601)
	at scala.concurrent.BatchingExecutor$class.execute(BatchingExecutor.scala:106)
	at scala.concurrent.Future$InternalCallbackExecutor$.execute(Future.scala:599)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.tryFailure(Promise.scala:112)
	at scala.concurrent.impl.Promise$DefaultPromise.tryFailure(Promise.scala:157)
	at org.apache.spark.rpc.netty.NettyRpcEnv.org$apache$spark$rpc$netty$NettyRpcEnv$$onFailure$1(NettyRpcEnv.scala:206)
	at org.apache.spark.rpc.netty.NettyRpcEnv$$anon$1.run(NettyRpcEnv.scala:243)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException: Cannot receive any reply from null in 120 seconds
	... 8 more
19/10/03 18:04:44 WARN HeartbeatReceiver: Removing executor 14 with no recent heartbeats: 122525 ms exceeds timeout 120000 ms
19/10/03 18:04:44 ERROR TaskSchedulerImpl: Lost executor 14 on 192.168.45.126: Executor heartbeat timed out after 122525 ms
19/10/03 18:04:44 WARN TaskSetManager: Lost task 127.0 in stage 200.0 (TID 408993, 192.168.45.126, executor 14): ExecutorLostFailure (executor 14 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 122525 ms
19/10/03 18:04:44 WARN BlockManagerMasterEndpoint: No more replicas available for broadcast_343_piece0 !
19/10/03 18:04:44 ERROR TaskSchedulerImpl: Lost executor 14 on 192.168.45.126: The executor with id 14 was deleted by a user or the framework.
19/10/03 18:04:46 WARN TransportChannelHandler: Exception in connection from /192.168.45.126:40546
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:04:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.45.126:40546 is closed
19/10/03 18:04:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 343 from block manager BlockManagerId(14, 192.168.45.126, 37631, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:14:44 WARN HeartbeatReceiver: Removing executor 77 with no recent heartbeats: 157632 ms exceeds timeout 120000 ms
19/10/03 18:14:44 ERROR TaskSchedulerImpl: Lost executor 77 on 192.168.11.200: Executor heartbeat timed out after 157632 ms
19/10/03 18:14:44 WARN TaskSetManager: Lost task 19.0 in stage 200.1 (TID 414178, 192.168.11.200, executor 77): ExecutorLostFailure (executor 77 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 157632 ms
19/10/03 18:14:44 ERROR TaskSchedulerImpl: Lost executor 77 on 192.168.11.200: The executor with id 77 was deleted by a user or the framework.
19/10/03 18:14:52 WARN TransportChannelHandler: Exception in connection from /192.168.11.200:43170
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:15:07 WARN TaskSetManager: Lost task 35.0 in stage 200.1 (TID 414194, 192.168.14.170, executor 45): FetchFailed(BlockManagerId(77, 192.168.11.200, 45761, None), shuffleId=100, mapId=5483, reduceId=123, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.11.200:45761
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.11.200:45761
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.11.200:45761
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:15:15 WARN TaskSetManager: Lost task 19.1 in stage 200.1 (TID 414211, 192.168.63.116, executor 116): FetchFailed(null, shuffleId=100, mapId=-1, reduceId=69, message=
org.apache.spark.shuffle.MetadataFetchFailedException: Missing an output location for shuffle 100
	at org.apache.spark.MapOutputTracker$$anonfun$convertMapStatuses$2.apply(MapOutputTracker.scala:882)
	at org.apache.spark.MapOutputTracker$$anonfun$convertMapStatuses$2.apply(MapOutputTracker.scala:878)
	at scala.collection.Iterator$class.foreach(Iterator.scala:891)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1334)
	at org.apache.spark.MapOutputTracker$.convertMapStatuses(MapOutputTracker.scala:878)
	at org.apache.spark.MapOutputTrackerWorker.getMapSizesByExecutorId(MapOutputTracker.scala:691)
	at org.apache.spark.shuffle.BlockStoreShuffleReader.read(BlockStoreShuffleReader.scala:49)
	at org.apache.spark.sql.execution.ShuffledRowRDD.compute(ShuffledRowRDD.scala:165)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

)
19/10/03 18:15:23 WARN TaskSetManager: Lost task 41.0 in stage 200.1 (TID 414200, 192.168.24.230, executor 48): FetchFailed(BlockManagerId(77, 192.168.11.200, 45761, None), shuffleId=100, mapId=7849, reduceId=150, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.11.200:45761
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.11.200:45761
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.11.200:45761
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:15:24 WARN TaskSetManager: Lost task 17.0 in stage 200.1 (TID 414176, 192.168.44.54, executor 41): FetchFailed(BlockManagerId(77, 192.168.11.200, 45761, None), shuffleId=100, mapId=42, reduceId=63, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.11.200:45761
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.11.200:45761
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.11.200:45761
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:15:43 WARN TaskSetManager: Lost task 24.0 in stage 200.1 (TID 414183, 192.168.39.158, executor 63): FetchFailed(BlockManagerId(77, 192.168.11.200, 45761, None), shuffleId=100, mapId=42, reduceId=83, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.11.200:45761
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.11.200:45761
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.11.200:45761
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:16:17 WARN TaskSetManager: Lost task 50.0 in stage 200.1 (TID 414209, 192.168.13.110, executor 75): FetchFailed(BlockManagerId(77, 192.168.11.200, 45761, None), shuffleId=100, mapId=6077, reduceId=193, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.11.200:45761
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.11.200:45761
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.11.200:45761
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:16:44 WARN HeartbeatReceiver: Removing executor 99 with no recent heartbeats: 140979 ms exceeds timeout 120000 ms
19/10/03 18:16:44 ERROR TaskSchedulerImpl: Lost executor 99 on 192.168.26.173: Executor heartbeat timed out after 140979 ms
19/10/03 18:16:44 WARN TaskSetManager: Lost task 31.0 in stage 200.1 (TID 414190, 192.168.26.173, executor 99): ExecutorLostFailure (executor 99 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 140979 ms
19/10/03 18:16:44 WARN HeartbeatReceiver: Removing executor 58 with no recent heartbeats: 171030 ms exceeds timeout 120000 ms
19/10/03 18:16:44 ERROR TaskSchedulerImpl: Lost executor 58 on 192.168.59.194: Executor heartbeat timed out after 171030 ms
19/10/03 18:16:44 WARN TaskSetManager: Lost task 44.0 in stage 200.1 (TID 414203, 192.168.59.194, executor 58): ExecutorLostFailure (executor 58 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 171030 ms
19/10/03 18:16:44 WARN HeartbeatReceiver: Removing executor 25 with no recent heartbeats: 145079 ms exceeds timeout 120000 ms
19/10/03 18:16:44 ERROR TaskSchedulerImpl: Lost executor 25 on 192.168.22.134: Executor heartbeat timed out after 145079 ms
19/10/03 18:16:44 WARN TaskSetManager: Lost task 25.0 in stage 200.1 (TID 414184, 192.168.22.134, executor 25): ExecutorLostFailure (executor 25 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 145079 ms
19/10/03 18:16:44 WARN HeartbeatReceiver: Removing executor 114 with no recent heartbeats: 152880 ms exceeds timeout 120000 ms
19/10/03 18:16:44 ERROR TaskSchedulerImpl: Lost executor 114 on 192.168.13.99: Executor heartbeat timed out after 152880 ms
19/10/03 18:16:44 WARN TaskSetManager: Lost task 22.0 in stage 200.1 (TID 414181, 192.168.13.99, executor 114): ExecutorLostFailure (executor 114 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 152880 ms
19/10/03 18:16:44 ERROR TaskSchedulerImpl: Lost executor 99 on 192.168.26.173: The executor with id 99 was deleted by a user or the framework.
19/10/03 18:16:44 ERROR TaskSchedulerImpl: Lost executor 58 on 192.168.59.194: The executor with id 58 was deleted by a user or the framework.
19/10/03 18:16:44 ERROR TaskSchedulerImpl: Lost executor 25 on 192.168.22.134: The executor with id 25 was deleted by a user or the framework.
19/10/03 18:16:44 ERROR TaskSchedulerImpl: Lost executor 114 on 192.168.13.99: The executor with id 114 was deleted by a user or the framework.
19/10/03 18:16:46 WARN TransportChannelHandler: Exception in connection from /192.168.26.173:49506
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:16:50 WARN TransportChannelHandler: Exception in connection from /192.168.59.194:37220
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:16:52 WARN TransportChannelHandler: Exception in connection from /192.168.13.99:43084
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:17:44 WARN HeartbeatReceiver: Removing executor 87 with no recent heartbeats: 125524 ms exceeds timeout 120000 ms
19/10/03 18:17:44 ERROR TaskSchedulerImpl: Lost executor 87 on 192.168.11.18: Executor heartbeat timed out after 125524 ms
19/10/03 18:17:44 WARN TaskSetManager: Lost task 37.0 in stage 200.1 (TID 414196, 192.168.11.18, executor 87): ExecutorLostFailure (executor 87 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 125524 ms
19/10/03 18:17:44 WARN HeartbeatReceiver: Removing executor 110 with no recent heartbeats: 122895 ms exceeds timeout 120000 ms
19/10/03 18:17:44 ERROR TaskSchedulerImpl: Lost executor 110 on 192.168.37.35: Executor heartbeat timed out after 122895 ms
19/10/03 18:17:44 WARN TaskSetManager: Lost task 34.0 in stage 200.1 (TID 414193, 192.168.37.35, executor 110): ExecutorLostFailure (executor 110 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 122895 ms
19/10/03 18:17:44 WARN HeartbeatReceiver: Removing executor 119 with no recent heartbeats: 163252 ms exceeds timeout 120000 ms
19/10/03 18:17:44 ERROR TaskSchedulerImpl: Lost executor 119 on 192.168.48.110: Executor heartbeat timed out after 163252 ms
19/10/03 18:17:44 WARN TaskSetManager: Lost task 46.0 in stage 200.1 (TID 414205, 192.168.48.110, executor 119): ExecutorLostFailure (executor 119 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 163252 ms
19/10/03 18:17:44 WARN HeartbeatReceiver: Removing executor 107 with no recent heartbeats: 176097 ms exceeds timeout 120000 ms
19/10/03 18:17:44 ERROR TaskSchedulerImpl: Lost executor 107 on 192.168.49.76: Executor heartbeat timed out after 176097 ms
19/10/03 18:17:44 WARN TaskSetManager: Lost task 6.0 in stage 200.1 (TID 414165, 192.168.49.76, executor 107): ExecutorLostFailure (executor 107 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 176097 ms
19/10/03 18:17:44 WARN HeartbeatReceiver: Removing executor 101 with no recent heartbeats: 130839 ms exceeds timeout 120000 ms
19/10/03 18:17:44 ERROR TaskSchedulerImpl: Lost executor 101 on 192.168.23.26: Executor heartbeat timed out after 130839 ms
19/10/03 18:17:44 WARN TaskSetManager: Lost task 5.0 in stage 200.1 (TID 414164, 192.168.23.26, executor 101): ExecutorLostFailure (executor 101 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 130839 ms
19/10/03 18:17:44 WARN HeartbeatReceiver: Removing executor 22 with no recent heartbeats: 175598 ms exceeds timeout 120000 ms
19/10/03 18:17:44 ERROR TaskSchedulerImpl: Lost executor 22 on 192.168.34.136: Executor heartbeat timed out after 175598 ms
19/10/03 18:17:44 WARN TaskSetManager: Lost task 47.0 in stage 200.1 (TID 414206, 192.168.34.136, executor 22): ExecutorLostFailure (executor 22 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 175598 ms
19/10/03 18:17:44 WARN HeartbeatReceiver: Removing executor 31 with no recent heartbeats: 178375 ms exceeds timeout 120000 ms
19/10/03 18:17:44 ERROR TaskSchedulerImpl: Lost executor 31 on 192.168.18.121: Executor heartbeat timed out after 178375 ms
19/10/03 18:17:44 WARN TaskSetManager: Lost task 51.0 in stage 200.1 (TID 414210, 192.168.18.121, executor 31): ExecutorLostFailure (executor 31 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 178375 ms
19/10/03 18:17:44 WARN HeartbeatReceiver: Removing executor 117 with no recent heartbeats: 159236 ms exceeds timeout 120000 ms
19/10/03 18:17:44 ERROR TaskSchedulerImpl: Lost executor 117 on 192.168.11.32: Executor heartbeat timed out after 159236 ms
19/10/03 18:17:44 WARN TaskSetManager: Lost task 27.0 in stage 200.1 (TID 414186, 192.168.11.32, executor 117): ExecutorLostFailure (executor 117 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 159236 ms
19/10/03 18:17:44 ERROR TaskSchedulerImpl: Lost executor 87 on 192.168.11.18: The executor with id 87 was deleted by a user or the framework.
19/10/03 18:17:44 ERROR TaskSchedulerImpl: Lost executor 110 on 192.168.37.35: The executor with id 110 was deleted by a user or the framework.
19/10/03 18:17:44 ERROR TaskSchedulerImpl: Lost executor 119 on 192.168.48.110: The executor with id 119 was deleted by a user or the framework.
19/10/03 18:17:44 ERROR TaskSchedulerImpl: Lost executor 107 on 192.168.49.76: The executor with id 107 was deleted by a user or the framework.
19/10/03 18:17:44 ERROR TaskSchedulerImpl: Lost executor 101 on 192.168.23.26: The executor with id 101 was deleted by a user or the framework.
19/10/03 18:17:44 ERROR TaskSchedulerImpl: Lost executor 22 on 192.168.34.136: The executor with id 22 was deleted by a user or the framework.
19/10/03 18:17:44 ERROR TaskSchedulerImpl: Lost executor 31 on 192.168.18.121: The executor with id 31 was deleted by a user or the framework.
19/10/03 18:17:45 ERROR TaskSchedulerImpl: Lost executor 117 on 192.168.11.32: The executor with id 117 was deleted by a user or the framework.
19/10/03 18:17:46 WARN TransportChannelHandler: Exception in connection from /192.168.49.76:58044
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:17:46 WARN TransportChannelHandler: Exception in connection from /192.168.18.121:41992
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:17:46 WARN TransportChannelHandler: Exception in connection from /192.168.34.136:34108
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:17:46 WARN TransportChannelHandler: Exception in connection from /192.168.48.110:37690
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:17:46 WARN TransportChannelHandler: Exception in connection from /192.168.37.35:41358
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:17:52 WARN TransportChannelHandler: Exception in connection from /192.168.23.26:60004
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:17:53 WARN TransportChannelHandler: Exception in connection from /192.168.11.18:41470
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:18:00 WARN TransportChannelHandler: Exception in connection from /192.168.22.134:39962
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:18:19 WARN TransportChannelHandler: Exception in connection from /192.168.11.32:51446
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:18:44 WARN HeartbeatReceiver: Removing executor 57 with no recent heartbeats: 127293 ms exceeds timeout 120000 ms
19/10/03 18:18:44 ERROR TaskSchedulerImpl: Lost executor 57 on 192.168.4.122: Executor heartbeat timed out after 127293 ms
19/10/03 18:18:44 WARN TaskSetManager: Lost task 32.0 in stage 200.1 (TID 414191, 192.168.4.122, executor 57): ExecutorLostFailure (executor 57 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 127293 ms
19/10/03 18:18:44 WARN HeartbeatReceiver: Removing executor 21 with no recent heartbeats: 132506 ms exceeds timeout 120000 ms
19/10/03 18:18:44 ERROR TaskSchedulerImpl: Lost executor 21 on 192.168.16.168: Executor heartbeat timed out after 132506 ms
19/10/03 18:18:44 WARN TaskSetManager: Lost task 43.0 in stage 200.1 (TID 414202, 192.168.16.168, executor 21): ExecutorLostFailure (executor 21 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 132506 ms
19/10/03 18:18:44 WARN HeartbeatReceiver: Removing executor 83 with no recent heartbeats: 157219 ms exceeds timeout 120000 ms
19/10/03 18:18:44 ERROR TaskSchedulerImpl: Lost executor 83 on 192.168.42.69: Executor heartbeat timed out after 157219 ms
19/10/03 18:18:44 WARN TaskSetManager: Lost task 7.0 in stage 200.1 (TID 414166, 192.168.42.69, executor 83): ExecutorLostFailure (executor 83 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 157219 ms
19/10/03 18:18:44 WARN HeartbeatReceiver: Removing executor 38 with no recent heartbeats: 168222 ms exceeds timeout 120000 ms
19/10/03 18:18:44 ERROR TaskSchedulerImpl: Lost executor 38 on 192.168.28.177: Executor heartbeat timed out after 168222 ms
19/10/03 18:18:44 WARN TaskSetManager: Lost task 20.0 in stage 200.1 (TID 414179, 192.168.28.177, executor 38): ExecutorLostFailure (executor 38 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 168222 ms
19/10/03 18:18:44 WARN HeartbeatReceiver: Removing executor 32 with no recent heartbeats: 154175 ms exceeds timeout 120000 ms
19/10/03 18:18:44 ERROR TaskSchedulerImpl: Lost executor 32 on 192.168.28.108: Executor heartbeat timed out after 154175 ms
19/10/03 18:18:44 WARN TaskSetManager: Lost task 49.0 in stage 200.1 (TID 414208, 192.168.28.108, executor 32): ExecutorLostFailure (executor 32 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 154175 ms
19/10/03 18:18:44 WARN HeartbeatReceiver: Removing executor 79 with no recent heartbeats: 132784 ms exceeds timeout 120000 ms
19/10/03 18:18:44 ERROR TaskSchedulerImpl: Lost executor 79 on 192.168.20.136: Executor heartbeat timed out after 132784 ms
19/10/03 18:18:44 WARN TaskSetManager: Lost task 26.0 in stage 200.1 (TID 414185, 192.168.20.136, executor 79): ExecutorLostFailure (executor 79 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 132784 ms
19/10/03 18:18:44 WARN HeartbeatReceiver: Removing executor 49 with no recent heartbeats: 157125 ms exceeds timeout 120000 ms
19/10/03 18:18:44 ERROR TaskSchedulerImpl: Lost executor 49 on 192.168.35.55: Executor heartbeat timed out after 157125 ms
19/10/03 18:18:44 WARN TaskSetManager: Lost task 14.0 in stage 200.1 (TID 414173, 192.168.35.55, executor 49): ExecutorLostFailure (executor 49 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 157125 ms
19/10/03 18:18:44 ERROR TaskSchedulerImpl: Lost executor 57 on 192.168.4.122: The executor with id 57 was deleted by a user or the framework.
19/10/03 18:18:44 ERROR TaskSchedulerImpl: Lost executor 21 on 192.168.16.168: The executor with id 21 was deleted by a user or the framework.
19/10/03 18:18:44 ERROR TaskSchedulerImpl: Lost executor 83 on 192.168.42.69: The executor with id 83 was deleted by a user or the framework.
19/10/03 18:18:44 ERROR TaskSchedulerImpl: Lost executor 38 on 192.168.28.177: The executor with id 38 was deleted by a user or the framework.
19/10/03 18:18:44 ERROR TaskSchedulerImpl: Lost executor 32 on 192.168.28.108: The executor with id 32 was deleted by a user or the framework.
19/10/03 18:18:44 ERROR TaskSchedulerImpl: Lost executor 79 on 192.168.20.136: The executor with id 79 was deleted by a user or the framework.
19/10/03 18:18:44 ERROR TaskSchedulerImpl: Lost executor 49 on 192.168.35.55: The executor with id 49 was deleted by a user or the framework.
19/10/03 18:18:46 WARN TransportChannelHandler: Exception in connection from /192.168.28.108:45576
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:18:46 WARN TransportChannelHandler: Exception in connection from /192.168.16.168:36230
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:18:46 WARN TransportChannelHandler: Exception in connection from /192.168.35.55:51894
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:18:46 WARN TransportChannelHandler: Exception in connection from /192.168.20.136:43974
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:18:47 WARN TransportChannelHandler: Exception in connection from /192.168.28.177:39168
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:18:52 WARN TransportChannelHandler: Exception in connection from /192.168.42.69:59866
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:18:56 WARN TransportChannelHandler: Exception in connection from /192.168.4.122:50870
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:19:44 WARN HeartbeatReceiver: Removing executor 27 with no recent heartbeats: 168652 ms exceeds timeout 120000 ms
19/10/03 18:19:44 ERROR TaskSchedulerImpl: Lost executor 27 on 192.168.38.97: Executor heartbeat timed out after 168652 ms
19/10/03 18:19:44 WARN TaskSetManager: Lost task 21.0 in stage 200.1 (TID 414180, 192.168.38.97, executor 27): ExecutorLostFailure (executor 27 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 168652 ms
19/10/03 18:19:44 WARN HeartbeatReceiver: Removing executor 42 with no recent heartbeats: 172904 ms exceeds timeout 120000 ms
19/10/03 18:19:44 ERROR TaskSchedulerImpl: Lost executor 42 on 192.168.9.251: Executor heartbeat timed out after 172904 ms
19/10/03 18:19:44 WARN TaskSetManager: Lost task 45.0 in stage 200.1 (TID 414204, 192.168.9.251, executor 42): ExecutorLostFailure (executor 42 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 172904 ms
19/10/03 18:19:44 WARN HeartbeatReceiver: Removing executor 18 with no recent heartbeats: 131588 ms exceeds timeout 120000 ms
19/10/03 18:19:44 ERROR TaskSchedulerImpl: Lost executor 18 on 192.168.5.173: Executor heartbeat timed out after 131588 ms
19/10/03 18:19:44 WARN TaskSetManager: Lost task 15.0 in stage 200.1 (TID 414174, 192.168.5.173, executor 18): ExecutorLostFailure (executor 18 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 131588 ms
19/10/03 18:19:44 WARN HeartbeatReceiver: Removing executor 118 with no recent heartbeats: 173816 ms exceeds timeout 120000 ms
19/10/03 18:19:44 ERROR TaskSchedulerImpl: Lost executor 118 on 192.168.25.22: Executor heartbeat timed out after 173816 ms
19/10/03 18:19:44 WARN TaskSetManager: Lost task 3.0 in stage 200.1 (TID 414162, 192.168.25.22, executor 118): ExecutorLostFailure (executor 118 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 173816 ms
19/10/03 18:19:44 WARN HeartbeatReceiver: Removing executor 6 with no recent heartbeats: 135433 ms exceeds timeout 120000 ms
19/10/03 18:19:44 ERROR TaskSchedulerImpl: Lost executor 6 on 192.168.63.143: Executor heartbeat timed out after 135433 ms
19/10/03 18:19:44 WARN TaskSetManager: Lost task 33.0 in stage 200.1 (TID 414192, 192.168.63.143, executor 6): ExecutorLostFailure (executor 6 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 135433 ms
19/10/03 18:19:44 ERROR TaskSchedulerImpl: Lost executor 27 on 192.168.38.97: The executor with id 27 was deleted by a user or the framework.
19/10/03 18:19:44 ERROR TaskSchedulerImpl: Lost executor 42 on 192.168.9.251: The executor with id 42 was deleted by a user or the framework.
19/10/03 18:19:44 ERROR TaskSchedulerImpl: Lost executor 18 on 192.168.5.173: The executor with id 18 was deleted by a user or the framework.
19/10/03 18:19:44 ERROR TaskSchedulerImpl: Lost executor 118 on 192.168.25.22: The executor with id 118 was deleted by a user or the framework.
19/10/03 18:19:44 ERROR TaskSchedulerImpl: Lost executor 6 on 192.168.63.143: The executor with id 6 was deleted by a user or the framework.
19/10/03 18:19:46 WARN TransportChannelHandler: Exception in connection from /192.168.38.97:43476
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:19:46 WARN TransportChannelHandler: Exception in connection from /192.168.5.173:39330
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:19:46 WARN TransportChannelHandler: Exception in connection from /192.168.25.22:37106
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:19:52 WARN TransportChannelHandler: Exception in connection from /192.168.63.143:35198
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:20:22 WARN TransportChannelHandler: Exception in connection from /192.168.9.251:54178
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:20:44 WARN HeartbeatReceiver: Removing executor 64 with no recent heartbeats: 164100 ms exceeds timeout 120000 ms
19/10/03 18:20:44 ERROR TaskSchedulerImpl: Lost executor 64 on 192.168.18.5: Executor heartbeat timed out after 164100 ms
19/10/03 18:20:44 WARN TaskSetManager: Lost task 42.0 in stage 200.1 (TID 414201, 192.168.18.5, executor 64): ExecutorLostFailure (executor 64 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 164100 ms
19/10/03 18:20:44 WARN HeartbeatReceiver: Removing executor 108 with no recent heartbeats: 155627 ms exceeds timeout 120000 ms
19/10/03 18:20:44 ERROR TaskSchedulerImpl: Lost executor 108 on 192.168.31.198: Executor heartbeat timed out after 155627 ms
19/10/03 18:20:44 WARN TaskSetManager: Lost task 23.0 in stage 200.1 (TID 414182, 192.168.31.198, executor 108): ExecutorLostFailure (executor 108 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 155627 ms
19/10/03 18:20:44 ERROR TaskSchedulerImpl: Lost executor 64 on 192.168.18.5: The executor with id 64 was deleted by a user or the framework.
19/10/03 18:20:44 ERROR TaskSchedulerImpl: Lost executor 108 on 192.168.31.198: The executor with id 108 was deleted by a user or the framework.
19/10/03 18:20:46 WARN TransportChannelHandler: Exception in connection from /192.168.18.5:59090
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:20:46 WARN TransportChannelHandler: Exception in connection from /192.168.31.198:35350
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:21:44 WARN HeartbeatReceiver: Removing executor 89 with no recent heartbeats: 138786 ms exceeds timeout 120000 ms
19/10/03 18:21:44 ERROR TaskSchedulerImpl: Lost executor 89 on 192.168.20.166: Executor heartbeat timed out after 138786 ms
19/10/03 18:21:44 WARN TaskSetManager: Lost task 39.0 in stage 200.1 (TID 414198, 192.168.20.166, executor 89): ExecutorLostFailure (executor 89 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 138786 ms
19/10/03 18:21:44 WARN HeartbeatReceiver: Removing executor 35 with no recent heartbeats: 124927 ms exceeds timeout 120000 ms
19/10/03 18:21:44 ERROR TaskSchedulerImpl: Lost executor 35 on 192.168.53.48: Executor heartbeat timed out after 124927 ms
19/10/03 18:21:44 WARN TaskSetManager: Lost task 11.0 in stage 200.1 (TID 414170, 192.168.53.48, executor 35): ExecutorLostFailure (executor 35 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 124927 ms
19/10/03 18:21:44 ERROR TaskSchedulerImpl: Lost executor 89 on 192.168.20.166: The executor with id 89 was deleted by a user or the framework.
19/10/03 18:21:44 ERROR TaskSchedulerImpl: Lost executor 35 on 192.168.53.48: The executor with id 35 was deleted by a user or the framework.
19/10/03 18:21:46 WARN TransportChannelHandler: Exception in connection from /192.168.20.166:35810
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:21:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.20.166:35810 is closed
19/10/03 18:21:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 357 from block manager BlockManagerId(89, 192.168.20.166, 35347, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:21:46 WARN TransportChannelHandler: Exception in connection from /192.168.53.48:34714
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:21:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.53.48:34714 is closed
19/10/03 18:21:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 357 from block manager BlockManagerId(35, 192.168.53.48, 43871, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:23:13 ERROR ContextCleaner: Error cleaning broadcast 357
org.apache.spark.rpc.RpcTimeoutException: Futures timed out after [120 seconds]. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:76)
	at org.apache.spark.storage.BlockManagerMaster.removeBroadcast(BlockManagerMaster.scala:155)
	at org.apache.spark.broadcast.TorrentBroadcast$.unpersist(TorrentBroadcast.scala:321)
	at org.apache.spark.broadcast.TorrentBroadcastFactory.unbroadcast(TorrentBroadcastFactory.scala:45)
	at org.apache.spark.broadcast.BroadcastManager.unbroadcast(BroadcastManager.scala:66)
	at org.apache.spark.ContextCleaner.doCleanupBroadcast(ContextCleaner.scala:238)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:194)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:185)
	at scala.Option.foreach(Option.scala:257)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1.apply$mcV$sp(ContextCleaner.scala:185)
	at org.apache.spark.util.Utils$.tryOrStopSparkContext(Utils.scala:1302)
	at org.apache.spark.ContextCleaner.org$apache$spark$ContextCleaner$$keepCleaning(ContextCleaner.scala:178)
	at org.apache.spark.ContextCleaner$$anon$1.run(ContextCleaner.scala:73)
Caused by: java.util.concurrent.TimeoutException: Futures timed out after [120 seconds]
	at scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:223)
	at scala.concurrent.impl.Promise$DefaultPromise.result(Promise.scala:227)
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:220)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:75)
	... 12 more
19/10/03 18:23:13 WARN BlockManagerMaster: Failed to remove broadcast 357 with removeFromMaster = true - Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
org.apache.spark.rpc.RpcTimeoutException: Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at scala.util.Failure$$anonfun$recover$1.apply(Try.scala:216)
	at scala.util.Try$.apply(Try.scala:192)
	at scala.util.Failure.recover(Try.scala:216)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at org.spark_project.guava.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:293)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$1.execute(ExecutionContextImpl.scala:136)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.complete(Promise.scala:55)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:157)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.processBatch$1(BatchingExecutor.scala:63)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply$mcV$sp(BatchingExecutor.scala:78)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:72)
	at scala.concurrent.BatchingExecutor$Batch.run(BatchingExecutor.scala:54)
	at scala.concurrent.Future$InternalCallbackExecutor$.unbatchedExecute(Future.scala:601)
	at scala.concurrent.BatchingExecutor$class.execute(BatchingExecutor.scala:106)
	at scala.concurrent.Future$InternalCallbackExecutor$.execute(Future.scala:599)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.tryFailure(Promise.scala:112)
	at scala.concurrent.impl.Promise$DefaultPromise.tryFailure(Promise.scala:157)
	at org.apache.spark.rpc.netty.NettyRpcEnv.org$apache$spark$rpc$netty$NettyRpcEnv$$onFailure$1(NettyRpcEnv.scala:206)
	at org.apache.spark.rpc.netty.NettyRpcEnv$$anon$1.run(NettyRpcEnv.scala:243)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException: Cannot receive any reply from null in 120 seconds
	... 8 more
19/10/03 18:23:44 WARN HeartbeatReceiver: Removing executor 9 with no recent heartbeats: 157040 ms exceeds timeout 120000 ms
19/10/03 18:23:44 ERROR TaskSchedulerImpl: Lost executor 9 on 192.168.26.29: Executor heartbeat timed out after 157040 ms
19/10/03 18:23:44 WARN TaskSetManager: Lost task 36.0 in stage 200.1 (TID 414195, 192.168.26.29, executor 9): ExecutorLostFailure (executor 9 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 157040 ms
19/10/03 18:23:44 ERROR TaskSchedulerImpl: Lost executor 9 on 192.168.26.29: The executor with id 9 was deleted by a user or the framework.
19/10/03 18:23:46 WARN TransportChannelHandler: Exception in connection from /192.168.26.29:42616
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:23:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.26.29:42616 is closed
19/10/03 18:23:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 358 from block manager BlockManagerId(9, 192.168.26.29, 38739, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:31:44 WARN HeartbeatReceiver: Removing executor 55 with no recent heartbeats: 136056 ms exceeds timeout 120000 ms
19/10/03 18:31:44 ERROR TaskSchedulerImpl: Lost executor 55 on 192.168.49.9: Executor heartbeat timed out after 136056 ms
19/10/03 18:31:44 WARN TaskSetManager: Lost task 80.0 in stage 200.2 (TID 419857, 192.168.49.9, executor 55): ExecutorLostFailure (executor 55 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 136056 ms
19/10/03 18:31:44 ERROR TaskSchedulerImpl: Lost executor 55 on 192.168.49.9: The executor with id 55 was deleted by a user or the framework.
19/10/03 18:31:48 WARN TransportChannelHandler: Exception in connection from /192.168.49.9:58304
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:32:44 WARN HeartbeatReceiver: Removing executor 24 with no recent heartbeats: 165488 ms exceeds timeout 120000 ms
19/10/03 18:32:44 ERROR TaskSchedulerImpl: Lost executor 24 on 192.168.46.247: Executor heartbeat timed out after 165488 ms
19/10/03 18:32:44 WARN TaskSetManager: Lost task 6.0 in stage 200.2 (TID 419783, 192.168.46.247, executor 24): ExecutorLostFailure (executor 24 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 165488 ms
19/10/03 18:32:44 WARN HeartbeatReceiver: Removing executor 133 with no recent heartbeats: 126501 ms exceeds timeout 120000 ms
19/10/03 18:32:44 ERROR TaskSchedulerImpl: Lost executor 133 on 192.168.38.189: Executor heartbeat timed out after 126501 ms
19/10/03 18:32:44 WARN TaskSetManager: Lost task 47.0 in stage 200.2 (TID 419824, 192.168.38.189, executor 133): ExecutorLostFailure (executor 133 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 126501 ms
19/10/03 18:32:44 WARN HeartbeatReceiver: Removing executor 23 with no recent heartbeats: 140521 ms exceeds timeout 120000 ms
19/10/03 18:32:44 ERROR TaskSchedulerImpl: Lost executor 23 on 192.168.44.162: Executor heartbeat timed out after 140521 ms
19/10/03 18:32:44 WARN TaskSetManager: Lost task 67.0 in stage 200.2 (TID 419844, 192.168.44.162, executor 23): ExecutorLostFailure (executor 23 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 140521 ms
19/10/03 18:32:44 ERROR TaskSchedulerImpl: Lost executor 24 on 192.168.46.247: The executor with id 24 was deleted by a user or the framework.
19/10/03 18:32:44 ERROR TaskSchedulerImpl: Lost executor 133 on 192.168.38.189: The executor with id 133 was deleted by a user or the framework.
19/10/03 18:32:44 ERROR TaskSchedulerImpl: Lost executor 23 on 192.168.44.162: The executor with id 23 was deleted by a user or the framework.
19/10/03 18:32:46 WARN TransportChannelHandler: Exception in connection from /192.168.44.162:38282
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:32:48 WARN TransportChannelHandler: Exception in connection from /192.168.46.247:60090
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.buffer.WrappedByteBuf.writeBytes(WrappedByteBuf.java:813)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:32:59 WARN TaskSetManager: Lost task 77.0 in stage 200.2 (TID 419854, 192.168.20.246, executor 13): FetchFailed(BlockManagerId(23, 192.168.44.162, 33853, None), shuffleId=100, mapId=9507, reduceId=193, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.44.162:33853
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.44.162:33853
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.44.162:33853
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:33:02 WARN TaskSetManager: Lost task 59.0 in stage 200.2 (TID 419836, 192.168.52.26, executor 70): FetchFailed(BlockManagerId(23, 192.168.44.162, 33853, None), shuffleId=100, mapId=6288, reduceId=150, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.44.162:33853
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.44.162:33853
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.44.162:33853
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:33:05 WARN TaskSetManager: Lost task 32.0 in stage 200.2 (TID 419809, 192.168.21.103, executor 20): FetchFailed(BlockManagerId(23, 192.168.44.162, 33853, None), shuffleId=100, mapId=29, reduceId=83, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.44.162:33853
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.44.162:33853
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.44.162:33853
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:33:06 WARN TaskSetManager: Lost task 6.1 in stage 200.2 (TID 419859, 192.168.14.254, executor 151): FetchFailed(BlockManagerId(24, 192.168.46.247, 40761, None), shuffleId=101, mapId=1249, reduceId=12, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.247:40761
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.247:40761
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.247:40761
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:33:11 WARN TaskSetManager: Lost task 80.1 in stage 200.2 (TID 419858, 192.168.40.164, executor 96): FetchFailed(BlockManagerId(133, 192.168.38.189, 46539, None), shuffleId=101, mapId=1314, reduceId=198, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.38.189:46539
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.38.189:46539
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.38.189:46539
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:33:16 WARN TaskSetManager: Lost task 47.1 in stage 200.2 (TID 419860, 192.168.26.40, executor 147): FetchFailed(BlockManagerId(24, 192.168.46.247, 40761, None), shuffleId=101, mapId=1249, reduceId=115, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.247:40761
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.247:40761
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.247:40761
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:33:21 WARN TaskSetManager: Lost task 67.1 in stage 200.2 (TID 419861, 192.168.29.244, executor 124): FetchFailed(BlockManagerId(133, 192.168.38.189, 46539, None), shuffleId=101, mapId=1314, reduceId=168, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.38.189:46539
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.38.189:46539
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.38.189:46539
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:33:22 WARN TaskSetManager: Lost task 53.0 in stage 200.2 (TID 419830, 192.168.18.11, executor 66): FetchFailed(BlockManagerId(23, 192.168.44.162, 33853, None), shuffleId=100, mapId=1186, reduceId=123, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.44.162:33853
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.44.162:33853
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.44.162:33853
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:33:44 WARN HeartbeatReceiver: Removing executor 122 with no recent heartbeats: 151302 ms exceeds timeout 120000 ms
19/10/03 18:33:44 ERROR TaskSchedulerImpl: Lost executor 122 on 192.168.41.153: Executor heartbeat timed out after 151302 ms
19/10/03 18:33:44 WARN TaskSetManager: Lost task 11.0 in stage 200.2 (TID 419788, 192.168.41.153, executor 122): ExecutorLostFailure (executor 122 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 151302 ms
19/10/03 18:33:44 WARN HeartbeatReceiver: Removing executor 52 with no recent heartbeats: 159545 ms exceeds timeout 120000 ms
19/10/03 18:33:44 ERROR TaskSchedulerImpl: Lost executor 52 on 192.168.28.43: Executor heartbeat timed out after 159545 ms
19/10/03 18:33:44 WARN TaskSetManager: Lost task 76.0 in stage 200.2 (TID 419853, 192.168.28.43, executor 52): ExecutorLostFailure (executor 52 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 159545 ms
19/10/03 18:33:44 WARN HeartbeatReceiver: Removing executor 76 with no recent heartbeats: 130420 ms exceeds timeout 120000 ms
19/10/03 18:33:44 ERROR TaskSchedulerImpl: Lost executor 76 on 192.168.29.74: Executor heartbeat timed out after 130420 ms
19/10/03 18:33:44 WARN TaskSetManager: Lost task 48.0 in stage 200.2 (TID 419825, 192.168.29.74, executor 76): ExecutorLostFailure (executor 76 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 130420 ms
19/10/03 18:33:44 WARN HeartbeatReceiver: Removing executor 43 with no recent heartbeats: 135042 ms exceeds timeout 120000 ms
19/10/03 18:33:44 ERROR TaskSchedulerImpl: Lost executor 43 on 192.168.46.107: Executor heartbeat timed out after 135042 ms
19/10/03 18:33:44 WARN TaskSetManager: Lost task 8.0 in stage 200.2 (TID 419785, 192.168.46.107, executor 43): ExecutorLostFailure (executor 43 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 135042 ms
19/10/03 18:33:44 WARN HeartbeatReceiver: Removing executor 135 with no recent heartbeats: 159496 ms exceeds timeout 120000 ms
19/10/03 18:33:44 ERROR TaskSchedulerImpl: Lost executor 135 on 192.168.18.190: Executor heartbeat timed out after 159496 ms
19/10/03 18:33:44 WARN TaskSetManager: Lost task 28.0 in stage 200.2 (TID 419805, 192.168.18.190, executor 135): ExecutorLostFailure (executor 135 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 159496 ms
19/10/03 18:33:44 ERROR TaskSchedulerImpl: Lost executor 122 on 192.168.41.153: The executor with id 122 was deleted by a user or the framework.
19/10/03 18:33:44 ERROR TaskSchedulerImpl: Lost executor 52 on 192.168.28.43: The executor with id 52 was deleted by a user or the framework.
19/10/03 18:33:44 ERROR TaskSchedulerImpl: Lost executor 76 on 192.168.29.74: The executor with id 76 was deleted by a user or the framework.
19/10/03 18:33:44 ERROR TaskSchedulerImpl: Lost executor 43 on 192.168.46.107: The executor with id 43 was deleted by a user or the framework.
19/10/03 18:33:45 ERROR TaskSchedulerImpl: Lost executor 135 on 192.168.18.190: The executor with id 135 was deleted by a user or the framework.
19/10/03 18:33:46 WARN TransportChannelHandler: Exception in connection from /192.168.41.153:35218
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:33:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.41.153:35218 is closed
19/10/03 18:33:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 347 from block manager BlockManagerId(122, 192.168.41.153, 38707, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:33:46 WARN TransportChannelHandler: Exception in connection from /192.168.18.190:33366
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:33:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.18.190:33366 is closed
19/10/03 18:33:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 347 from block manager BlockManagerId(135, 192.168.18.190, 37345, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:33:46 WARN TransportChannelHandler: Exception in connection from /192.168.46.107:41618
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:33:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.46.107:41618 is closed
19/10/03 18:33:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 347 from block manager BlockManagerId(43, 192.168.46.107, 35603, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:33:47 WARN TransportChannelHandler: Exception in connection from /192.168.28.43:45974
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:33:47 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.28.43:45974 is closed
19/10/03 18:33:47 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 347 from block manager BlockManagerId(52, 192.168.28.43, 45355, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:08 WARN TaskSetManager: Lost task 21.0 in stage 200.2 (TID 419798, 192.168.24.13, executor 125): FetchFailed(BlockManagerId(135, 192.168.18.190, 37345, None), shuffleId=100, mapId=2832, reduceId=63, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.18.190:37345
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.18.190:37345
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.18.190:37345
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:34:13 WARN TransportChannelHandler: Exception in connection from /192.168.29.74:58262
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:13 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.29.74:58262 is closed
19/10/03 18:34:13 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 347 from block manager BlockManagerId(76, 192.168.29.74, 39129, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:44 WARN HeartbeatReceiver: Removing executor 2 with no recent heartbeats: 155912 ms exceeds timeout 120000 ms
19/10/03 18:34:44 ERROR TaskSchedulerImpl: Lost executor 2 on 192.168.35.253: Executor heartbeat timed out after 155912 ms
19/10/03 18:34:44 WARN TaskSetManager: Lost task 57.0 in stage 200.2 (TID 419834, 192.168.35.253, executor 2): ExecutorLostFailure (executor 2 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 155912 ms
19/10/03 18:34:44 WARN HeartbeatReceiver: Removing executor 137 with no recent heartbeats: 174757 ms exceeds timeout 120000 ms
19/10/03 18:34:44 ERROR TaskSchedulerImpl: Lost executor 137 on 192.168.21.49: Executor heartbeat timed out after 174757 ms
19/10/03 18:34:44 WARN TaskSetManager: Lost task 23.0 in stage 200.2 (TID 419800, 192.168.21.49, executor 137): ExecutorLostFailure (executor 137 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 174757 ms
19/10/03 18:34:44 WARN HeartbeatReceiver: Removing executor 152 with no recent heartbeats: 169058 ms exceeds timeout 120000 ms
19/10/03 18:34:44 ERROR TaskSchedulerImpl: Lost executor 152 on 192.168.20.83: Executor heartbeat timed out after 169058 ms
19/10/03 18:34:44 WARN TaskSetManager: Lost task 71.0 in stage 200.2 (TID 419848, 192.168.20.83, executor 152): ExecutorLostFailure (executor 152 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 169058 ms
19/10/03 18:34:44 WARN HeartbeatReceiver: Removing executor 86 with no recent heartbeats: 170493 ms exceeds timeout 120000 ms
19/10/03 18:34:44 ERROR TaskSchedulerImpl: Lost executor 86 on 192.168.0.28: Executor heartbeat timed out after 170493 ms
19/10/03 18:34:44 WARN TaskSetManager: Lost task 36.0 in stage 200.2 (TID 419813, 192.168.0.28, executor 86): ExecutorLostFailure (executor 86 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 170493 ms
19/10/03 18:34:44 WARN HeartbeatReceiver: Removing executor 59 with no recent heartbeats: 144763 ms exceeds timeout 120000 ms
19/10/03 18:34:44 ERROR TaskSchedulerImpl: Lost executor 59 on 192.168.43.219: Executor heartbeat timed out after 144763 ms
19/10/03 18:34:44 WARN TaskSetManager: Lost task 16.0 in stage 200.2 (TID 419793, 192.168.43.219, executor 59): ExecutorLostFailure (executor 59 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 144763 ms
19/10/03 18:34:44 WARN HeartbeatReceiver: Removing executor 1 with no recent heartbeats: 178060 ms exceeds timeout 120000 ms
19/10/03 18:34:44 ERROR TaskSchedulerImpl: Lost executor 1 on 192.168.18.168: Executor heartbeat timed out after 178060 ms
19/10/03 18:34:44 WARN TaskSetManager: Lost task 55.0 in stage 200.2 (TID 419832, 192.168.18.168, executor 1): ExecutorLostFailure (executor 1 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 178060 ms
19/10/03 18:34:44 WARN HeartbeatReceiver: Removing executor 130 with no recent heartbeats: 130688 ms exceeds timeout 120000 ms
19/10/03 18:34:44 ERROR TaskSchedulerImpl: Lost executor 130 on 192.168.8.136: Executor heartbeat timed out after 130688 ms
19/10/03 18:34:44 WARN TaskSetManager: Lost task 27.0 in stage 200.2 (TID 419804, 192.168.8.136, executor 130): ExecutorLostFailure (executor 130 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 130688 ms
19/10/03 18:34:44 WARN HeartbeatReceiver: Removing executor 85 with no recent heartbeats: 166750 ms exceeds timeout 120000 ms
19/10/03 18:34:44 ERROR TaskSchedulerImpl: Lost executor 85 on 192.168.40.158: Executor heartbeat timed out after 166750 ms
19/10/03 18:34:44 WARN TaskSetManager: Lost task 9.0 in stage 200.2 (TID 419786, 192.168.40.158, executor 85): ExecutorLostFailure (executor 85 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 166750 ms
19/10/03 18:34:44 WARN HeartbeatReceiver: Removing executor 28 with no recent heartbeats: 128324 ms exceeds timeout 120000 ms
19/10/03 18:34:44 ERROR TaskSchedulerImpl: Lost executor 28 on 192.168.59.28: Executor heartbeat timed out after 128324 ms
19/10/03 18:34:44 WARN TaskSetManager: Lost task 52.0 in stage 200.2 (TID 419829, 192.168.59.28, executor 28): ExecutorLostFailure (executor 28 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 128324 ms
19/10/03 18:34:44 WARN HeartbeatReceiver: Removing executor 37 with no recent heartbeats: 131140 ms exceeds timeout 120000 ms
19/10/03 18:34:44 ERROR TaskSchedulerImpl: Lost executor 37 on 192.168.3.31: Executor heartbeat timed out after 131140 ms
19/10/03 18:34:44 WARN TaskSetManager: Lost task 31.0 in stage 200.2 (TID 419808, 192.168.3.31, executor 37): ExecutorLostFailure (executor 37 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 131140 ms
19/10/03 18:34:44 WARN HeartbeatReceiver: Removing executor 138 with no recent heartbeats: 139639 ms exceeds timeout 120000 ms
19/10/03 18:34:44 ERROR TaskSchedulerImpl: Lost executor 138 on 192.168.28.12: Executor heartbeat timed out after 139639 ms
19/10/03 18:34:44 WARN TaskSetManager: Lost task 70.0 in stage 200.2 (TID 419847, 192.168.28.12, executor 138): ExecutorLostFailure (executor 138 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 139639 ms
19/10/03 18:34:44 ERROR TaskSchedulerImpl: Lost executor 2 on 192.168.35.253: The executor with id 2 was deleted by a user or the framework.
19/10/03 18:34:44 ERROR TaskSchedulerImpl: Lost executor 137 on 192.168.21.49: The executor with id 137 was deleted by a user or the framework.
19/10/03 18:34:44 ERROR TaskSchedulerImpl: Lost executor 152 on 192.168.20.83: The executor with id 152 was deleted by a user or the framework.
19/10/03 18:34:44 ERROR TaskSchedulerImpl: Lost executor 86 on 192.168.0.28: The executor with id 86 was deleted by a user or the framework.
19/10/03 18:34:44 ERROR TaskSchedulerImpl: Lost executor 59 on 192.168.43.219: The executor with id 59 was deleted by a user or the framework.
19/10/03 18:34:44 ERROR TaskSchedulerImpl: Lost executor 1 on 192.168.18.168: The executor with id 1 was deleted by a user or the framework.
19/10/03 18:34:45 ERROR TaskSchedulerImpl: Lost executor 130 on 192.168.8.136: The executor with id 130 was deleted by a user or the framework.
19/10/03 18:34:45 ERROR TaskSchedulerImpl: Lost executor 85 on 192.168.40.158: The executor with id 85 was deleted by a user or the framework.
19/10/03 18:34:45 ERROR TaskSchedulerImpl: Lost executor 28 on 192.168.59.28: The executor with id 28 was deleted by a user or the framework.
19/10/03 18:34:45 ERROR TaskSchedulerImpl: Lost executor 37 on 192.168.3.31: The executor with id 37 was deleted by a user or the framework.
19/10/03 18:34:45 ERROR TaskSchedulerImpl: Lost executor 138 on 192.168.28.12: The executor with id 138 was deleted by a user or the framework.
19/10/03 18:34:46 WARN TransportChannelHandler: Exception in connection from /192.168.18.168:34414
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.18.168:34414 is closed
19/10/03 18:34:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 347 from block manager BlockManagerId(1, 192.168.18.168, 37477, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:46 WARN TransportChannelHandler: Exception in connection from /192.168.35.253:57364
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.35.253:57364 is closed
19/10/03 18:34:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 347 from block manager BlockManagerId(2, 192.168.35.253, 40697, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:46 WARN TransportChannelHandler: Exception in connection from /192.168.0.28:46746
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.0.28:46746 is closed
19/10/03 18:34:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 347 from block manager BlockManagerId(86, 192.168.0.28, 36493, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:46 WARN TransportChannelHandler: Exception in connection from /192.168.59.28:49464
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.59.28:49464 is closed
19/10/03 18:34:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 347 from block manager BlockManagerId(28, 192.168.59.28, 41045, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:46 WARN TransportChannelHandler: Exception in connection from /192.168.21.49:59930
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.21.49:59930 is closed
19/10/03 18:34:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 347 from block manager BlockManagerId(137, 192.168.21.49, 45143, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:46 WARN TransportChannelHandler: Exception in connection from /192.168.28.12:39842
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.28.12:39842 is closed
19/10/03 18:34:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 347 from block manager BlockManagerId(138, 192.168.28.12, 46707, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:46 WARN TransportChannelHandler: Exception in connection from /192.168.43.219:39950
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.43.219:39950 is closed
19/10/03 18:34:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 347 from block manager BlockManagerId(59, 192.168.43.219, 41619, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:48 ERROR ContextCleaner: Error cleaning broadcast 347
org.apache.spark.rpc.RpcTimeoutException: Futures timed out after [120 seconds]. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:76)
	at org.apache.spark.storage.BlockManagerMaster.removeBroadcast(BlockManagerMaster.scala:155)
	at org.apache.spark.broadcast.TorrentBroadcast$.unpersist(TorrentBroadcast.scala:321)
	at org.apache.spark.broadcast.TorrentBroadcastFactory.unbroadcast(TorrentBroadcastFactory.scala:45)
	at org.apache.spark.broadcast.BroadcastManager.unbroadcast(BroadcastManager.scala:66)
	at org.apache.spark.ContextCleaner.doCleanupBroadcast(ContextCleaner.scala:238)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:194)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:185)
	at scala.Option.foreach(Option.scala:257)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1.apply$mcV$sp(ContextCleaner.scala:185)
	at org.apache.spark.util.Utils$.tryOrStopSparkContext(Utils.scala:1302)
	at org.apache.spark.ContextCleaner.org$apache$spark$ContextCleaner$$keepCleaning(ContextCleaner.scala:178)
	at org.apache.spark.ContextCleaner$$anon$1.run(ContextCleaner.scala:73)
Caused by: java.util.concurrent.TimeoutException: Futures timed out after [120 seconds]
	at scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:223)
	at scala.concurrent.impl.Promise$DefaultPromise.result(Promise.scala:227)
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:220)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:75)
	... 12 more
19/10/03 18:34:48 WARN BlockManagerMaster: Failed to remove broadcast 347 with removeFromMaster = true - Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
org.apache.spark.rpc.RpcTimeoutException: Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at scala.util.Failure$$anonfun$recover$1.apply(Try.scala:216)
	at scala.util.Try$.apply(Try.scala:192)
	at scala.util.Failure.recover(Try.scala:216)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at org.spark_project.guava.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:293)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$1.execute(ExecutionContextImpl.scala:136)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.complete(Promise.scala:55)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:157)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.processBatch$1(BatchingExecutor.scala:63)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply$mcV$sp(BatchingExecutor.scala:78)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:72)
	at scala.concurrent.BatchingExecutor$Batch.run(BatchingExecutor.scala:54)
	at scala.concurrent.Future$InternalCallbackExecutor$.unbatchedExecute(Future.scala:601)
	at scala.concurrent.BatchingExecutor$class.execute(BatchingExecutor.scala:106)
	at scala.concurrent.Future$InternalCallbackExecutor$.execute(Future.scala:599)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.tryFailure(Promise.scala:112)
	at scala.concurrent.impl.Promise$DefaultPromise.tryFailure(Promise.scala:157)
	at org.apache.spark.rpc.netty.NettyRpcEnv.org$apache$spark$rpc$netty$NettyRpcEnv$$onFailure$1(NettyRpcEnv.scala:206)
	at org.apache.spark.rpc.netty.NettyRpcEnv$$anon$1.run(NettyRpcEnv.scala:243)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException: Cannot receive any reply from null in 120 seconds
	... 8 more
19/10/03 18:34:50 WARN TransportChannelHandler: Exception in connection from /192.168.20.83:44052
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:52 WARN TransportChannelHandler: Exception in connection from /192.168.8.136:52778
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:34:53 WARN TransportChannelHandler: Exception in connection from /192.168.3.31:36706
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:35:01 WARN TransportChannelHandler: Exception in connection from /192.168.40.158:39082
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:35:26 WARN TransportResponseHandler: Ignoring response for RPC 5654146029337218879 from /192.168.19.125:37428 (81 bytes) since it is not outstanding
19/10/03 18:35:44 WARN HeartbeatReceiver: Removing executor 63 with no recent heartbeats: 165443 ms exceeds timeout 120000 ms
19/10/03 18:35:44 ERROR TaskSchedulerImpl: Lost executor 63 on 192.168.39.158: Executor heartbeat timed out after 165443 ms
19/10/03 18:35:44 WARN TaskSetManager: Lost task 51.0 in stage 200.2 (TID 419828, 192.168.39.158, executor 63): ExecutorLostFailure (executor 63 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 165443 ms
19/10/03 18:35:44 WARN HeartbeatReceiver: Removing executor 72 with no recent heartbeats: 170958 ms exceeds timeout 120000 ms
19/10/03 18:35:44 ERROR TaskSchedulerImpl: Lost executor 72 on 192.168.0.41: Executor heartbeat timed out after 170958 ms
19/10/03 18:35:44 WARN TaskSetManager: Lost task 18.0 in stage 200.2 (TID 419795, 192.168.0.41, executor 72): ExecutorLostFailure (executor 72 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 170958 ms
19/10/03 18:35:44 WARN HeartbeatReceiver: Removing executor 131 with no recent heartbeats: 169063 ms exceeds timeout 120000 ms
19/10/03 18:35:44 ERROR TaskSchedulerImpl: Lost executor 131 on 192.168.32.79: Executor heartbeat timed out after 169063 ms
19/10/03 18:35:44 WARN TaskSetManager: Lost task 60.0 in stage 200.2 (TID 419837, 192.168.32.79, executor 131): ExecutorLostFailure (executor 131 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 169063 ms
19/10/03 18:35:44 WARN HeartbeatReceiver: Removing executor 134 with no recent heartbeats: 156440 ms exceeds timeout 120000 ms
19/10/03 18:35:44 ERROR TaskSchedulerImpl: Lost executor 134 on 192.168.27.80: Executor heartbeat timed out after 156440 ms
19/10/03 18:35:44 WARN TaskSetManager: Lost task 34.0 in stage 200.2 (TID 419811, 192.168.27.80, executor 134): ExecutorLostFailure (executor 134 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 156440 ms
19/10/03 18:35:44 WARN HeartbeatReceiver: Removing executor 68 with no recent heartbeats: 175515 ms exceeds timeout 120000 ms
19/10/03 18:35:44 ERROR TaskSchedulerImpl: Lost executor 68 on 192.168.60.19: Executor heartbeat timed out after 175515 ms
19/10/03 18:35:44 WARN TaskSetManager: Lost task 54.0 in stage 200.2 (TID 419831, 192.168.60.19, executor 68): ExecutorLostFailure (executor 68 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 175515 ms
19/10/03 18:35:44 WARN BlockManagerMasterEndpoint: No more replicas available for broadcast_347_piece0 !
19/10/03 18:35:44 ERROR TaskSchedulerImpl: Lost executor 63 on 192.168.39.158: The executor with id 63 was deleted by a user or the framework.
19/10/03 18:35:44 ERROR TaskSchedulerImpl: Lost executor 72 on 192.168.0.41: The executor with id 72 was deleted by a user or the framework.
19/10/03 18:35:44 ERROR TaskSchedulerImpl: Lost executor 131 on 192.168.32.79: The executor with id 131 was deleted by a user or the framework.
19/10/03 18:35:44 ERROR TaskSchedulerImpl: Lost executor 134 on 192.168.27.80: The executor with id 134 was deleted by a user or the framework.
19/10/03 18:35:44 ERROR TaskSchedulerImpl: Lost executor 68 on 192.168.60.19: The executor with id 68 was deleted by a user or the framework.
19/10/03 18:35:46 WARN TransportChannelHandler: Exception in connection from /192.168.0.41:32840
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:35:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.0.41:32840 is closed
19/10/03 18:35:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 353 from block manager BlockManagerId(72, 192.168.0.41, 37445, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:35:46 WARN TransportChannelHandler: Exception in connection from /192.168.32.79:41650
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:35:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.32.79:41650 is closed
19/10/03 18:35:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 353 from block manager BlockManagerId(131, 192.168.32.79, 37465, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:35:46 WARN TransportChannelHandler: Exception in connection from /192.168.60.19:50800
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:35:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.60.19:50800 is closed
19/10/03 18:35:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 353 from block manager BlockManagerId(68, 192.168.60.19, 42593, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:35:47 WARN TransportChannelHandler: Exception in connection from /192.168.27.80:49520
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:35:47 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.27.80:49520 is closed
19/10/03 18:35:47 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 353 from block manager BlockManagerId(134, 192.168.27.80, 38121, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:35:52 WARN TransportChannelHandler: Exception in connection from /192.168.39.158:40762
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:35:52 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.39.158:40762 is closed
19/10/03 18:35:52 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 353 from block manager BlockManagerId(63, 192.168.39.158, 45863, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:36:44 WARN HeartbeatReceiver: Removing executor 8 with no recent heartbeats: 140481 ms exceeds timeout 120000 ms
19/10/03 18:36:44 ERROR TaskSchedulerImpl: Lost executor 8 on 192.168.31.107: Executor heartbeat timed out after 140481 ms
19/10/03 18:36:44 WARN TaskSetManager: Lost task 63.0 in stage 200.2 (TID 419840, 192.168.31.107, executor 8): ExecutorLostFailure (executor 8 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 140481 ms
19/10/03 18:36:44 ERROR TaskSchedulerImpl: Lost executor 8 on 192.168.31.107: The executor with id 8 was deleted by a user or the framework.
19/10/03 18:36:46 WARN TransportChannelHandler: Exception in connection from /192.168.31.107:56928
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:36:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.31.107:56928 is closed
19/10/03 18:36:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 353 from block manager BlockManagerId(8, 192.168.31.107, 39917, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:36:48 ERROR ContextCleaner: Error cleaning broadcast 353
org.apache.spark.rpc.RpcTimeoutException: Futures timed out after [120 seconds]. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:76)
	at org.apache.spark.storage.BlockManagerMaster.removeBroadcast(BlockManagerMaster.scala:155)
	at org.apache.spark.broadcast.TorrentBroadcast$.unpersist(TorrentBroadcast.scala:321)
	at org.apache.spark.broadcast.TorrentBroadcastFactory.unbroadcast(TorrentBroadcastFactory.scala:45)
	at org.apache.spark.broadcast.BroadcastManager.unbroadcast(BroadcastManager.scala:66)
	at org.apache.spark.ContextCleaner.doCleanupBroadcast(ContextCleaner.scala:238)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:194)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:185)
	at scala.Option.foreach(Option.scala:257)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1.apply$mcV$sp(ContextCleaner.scala:185)
	at org.apache.spark.util.Utils$.tryOrStopSparkContext(Utils.scala:1302)
	at org.apache.spark.ContextCleaner.org$apache$spark$ContextCleaner$$keepCleaning(ContextCleaner.scala:178)
	at org.apache.spark.ContextCleaner$$anon$1.run(ContextCleaner.scala:73)
Caused by: java.util.concurrent.TimeoutException: Futures timed out after [120 seconds]
	at scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:223)
	at scala.concurrent.impl.Promise$DefaultPromise.result(Promise.scala:227)
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:220)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:75)
	... 12 more
19/10/03 18:36:48 WARN BlockManagerMaster: Failed to remove broadcast 353 with removeFromMaster = true - Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
org.apache.spark.rpc.RpcTimeoutException: Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at scala.util.Failure$$anonfun$recover$1.apply(Try.scala:216)
	at scala.util.Try$.apply(Try.scala:192)
	at scala.util.Failure.recover(Try.scala:216)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at org.spark_project.guava.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:293)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$1.execute(ExecutionContextImpl.scala:136)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.complete(Promise.scala:55)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:157)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.processBatch$1(BatchingExecutor.scala:63)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply$mcV$sp(BatchingExecutor.scala:78)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:72)
	at scala.concurrent.BatchingExecutor$Batch.run(BatchingExecutor.scala:54)
	at scala.concurrent.Future$InternalCallbackExecutor$.unbatchedExecute(Future.scala:601)
	at scala.concurrent.BatchingExecutor$class.execute(BatchingExecutor.scala:106)
	at scala.concurrent.Future$InternalCallbackExecutor$.execute(Future.scala:599)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.tryFailure(Promise.scala:112)
	at scala.concurrent.impl.Promise$DefaultPromise.tryFailure(Promise.scala:157)
	at org.apache.spark.rpc.netty.NettyRpcEnv.org$apache$spark$rpc$netty$NettyRpcEnv$$onFailure$1(NettyRpcEnv.scala:206)
	at org.apache.spark.rpc.netty.NettyRpcEnv$$anon$1.run(NettyRpcEnv.scala:243)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException: Cannot receive any reply from null in 120 seconds
	... 8 more
19/10/03 18:37:43 WARN TransportResponseHandler: Ignoring response for RPC 6892001685627861623 from /192.168.24.230:52144 (81 bytes) since it is not outstanding
19/10/03 18:37:44 WARN HeartbeatReceiver: Removing executor 48 with no recent heartbeats: 125116 ms exceeds timeout 120000 ms
19/10/03 18:37:44 ERROR TaskSchedulerImpl: Lost executor 48 on 192.168.24.230: Executor heartbeat timed out after 125116 ms
19/10/03 18:37:44 WARN TaskSetManager: Lost task 74.0 in stage 200.2 (TID 419851, 192.168.24.230, executor 48): ExecutorLostFailure (executor 48 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 125116 ms
19/10/03 18:37:44 WARN HeartbeatReceiver: Removing executor 69 with no recent heartbeats: 152341 ms exceeds timeout 120000 ms
19/10/03 18:37:44 ERROR TaskSchedulerImpl: Lost executor 69 on 192.168.38.127: Executor heartbeat timed out after 152341 ms
19/10/03 18:37:44 WARN TaskSetManager: Lost task 35.0 in stage 200.2 (TID 419812, 192.168.38.127, executor 69): ExecutorLostFailure (executor 69 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 152341 ms
19/10/03 18:37:44 ERROR TaskSchedulerImpl: Lost executor 48 on 192.168.24.230: The executor with id 48 was deleted by a user or the framework.
19/10/03 18:37:44 ERROR TaskSchedulerImpl: Lost executor 69 on 192.168.38.127: The executor with id 69 was deleted by a user or the framework.
19/10/03 18:37:46 WARN TransportChannelHandler: Exception in connection from /192.168.38.127:52474
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:37:46 WARN TransportChannelHandler: Exception in connection from /192.168.24.230:52144
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:38:54 WARN TransportResponseHandler: Ignoring response for RPC 7769643094248303200 from /192.168.19.125:37428 (81 bytes) since it is not outstanding
19/10/03 18:39:44 WARN HeartbeatReceiver: Removing executor 127 with no recent heartbeats: 150766 ms exceeds timeout 120000 ms
19/10/03 18:39:44 ERROR TaskSchedulerImpl: Lost executor 127 on 192.168.39.101: Executor heartbeat timed out after 150766 ms
19/10/03 18:39:44 WARN TaskSetManager: Lost task 15.0 in stage 200.2 (TID 419792, 192.168.39.101, executor 127): ExecutorLostFailure (executor 127 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 150766 ms
19/10/03 18:39:44 ERROR TaskSchedulerImpl: Lost executor 127 on 192.168.39.101: The executor with id 127 was deleted by a user or the framework.
19/10/03 18:39:46 WARN TransportChannelHandler: Exception in connection from /192.168.39.101:55584
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:41:44 WARN HeartbeatReceiver: Removing executor 126 with no recent heartbeats: 126452 ms exceeds timeout 120000 ms
19/10/03 18:41:44 ERROR TaskSchedulerImpl: Lost executor 126 on 192.168.19.125: Executor heartbeat timed out after 126452 ms
19/10/03 18:41:44 WARN TaskSetManager: Lost task 26.0 in stage 200.2 (TID 419803, 192.168.19.125, executor 126): ExecutorLostFailure (executor 126 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 126452 ms
19/10/03 18:41:44 ERROR TaskSchedulerImpl: Lost executor 126 on 192.168.19.125: The executor with id 126 was deleted by a user or the framework.
19/10/03 18:41:46 WARN TransportChannelHandler: Exception in connection from /192.168.19.125:37428
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:51:44 WARN HeartbeatReceiver: Removing executor 125 with no recent heartbeats: 148698 ms exceeds timeout 120000 ms
19/10/03 18:51:44 ERROR TaskSchedulerImpl: Lost executor 125 on 192.168.24.13: Executor heartbeat timed out after 148698 ms
19/10/03 18:51:44 WARN TaskSetManager: Lost task 68.0 in stage 200.3 (TID 426563, 192.168.24.13, executor 125): ExecutorLostFailure (executor 125 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 148698 ms
19/10/03 18:51:44 WARN HeartbeatReceiver: Removing executor 172 with no recent heartbeats: 121530 ms exceeds timeout 120000 ms
19/10/03 18:51:44 ERROR TaskSchedulerImpl: Lost executor 172 on 192.168.53.102: Executor heartbeat timed out after 121530 ms
19/10/03 18:51:44 WARN TaskSetManager: Lost task 81.0 in stage 200.3 (TID 426576, 192.168.53.102, executor 172): ExecutorLostFailure (executor 172 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 121530 ms
19/10/03 18:51:44 WARN HeartbeatReceiver: Removing executor 139 with no recent heartbeats: 121778 ms exceeds timeout 120000 ms
19/10/03 18:51:44 ERROR TaskSchedulerImpl: Lost executor 139 on 192.168.25.31: Executor heartbeat timed out after 121778 ms
19/10/03 18:51:44 WARN TaskSetManager: Lost task 1.0 in stage 200.3 (TID 426496, 192.168.25.31, executor 139): ExecutorLostFailure (executor 139 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 121778 ms
19/10/03 18:51:44 WARN HeartbeatReceiver: Removing executor 67 with no recent heartbeats: 140689 ms exceeds timeout 120000 ms
19/10/03 18:51:44 ERROR TaskSchedulerImpl: Lost executor 67 on 192.168.23.34: Executor heartbeat timed out after 140689 ms
19/10/03 18:51:44 WARN TaskSetManager: Lost task 18.0 in stage 200.3 (TID 426513, 192.168.23.34, executor 67): ExecutorLostFailure (executor 67 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 140689 ms
19/10/03 18:51:44 WARN HeartbeatReceiver: Removing executor 162 with no recent heartbeats: 158397 ms exceeds timeout 120000 ms
19/10/03 18:51:44 ERROR TaskSchedulerImpl: Lost executor 162 on 192.168.6.223: Executor heartbeat timed out after 158397 ms
19/10/03 18:51:44 WARN TaskSetManager: Lost task 27.0 in stage 200.3 (TID 426522, 192.168.6.223, executor 162): ExecutorLostFailure (executor 162 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 158397 ms
19/10/03 18:51:44 WARN HeartbeatReceiver: Removing executor 153 with no recent heartbeats: 145442 ms exceeds timeout 120000 ms
19/10/03 18:51:44 ERROR TaskSchedulerImpl: Lost executor 153 on 192.168.47.166: Executor heartbeat timed out after 145442 ms
19/10/03 18:51:44 WARN TaskSetManager: Lost task 32.0 in stage 200.3 (TID 426527, 192.168.47.166, executor 153): ExecutorLostFailure (executor 153 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 145442 ms
19/10/03 18:51:44 ERROR TaskSchedulerImpl: Lost executor 125 on 192.168.24.13: The executor with id 125 was deleted by a user or the framework.
19/10/03 18:51:44 ERROR TaskSchedulerImpl: Lost executor 172 on 192.168.53.102: The executor with id 172 was deleted by a user or the framework.
19/10/03 18:51:44 ERROR TaskSchedulerImpl: Lost executor 139 on 192.168.25.31: The executor with id 139 was deleted by a user or the framework.
19/10/03 18:51:44 ERROR TaskSchedulerImpl: Lost executor 67 on 192.168.23.34: The executor with id 67 was deleted by a user or the framework.
19/10/03 18:51:44 ERROR TaskSchedulerImpl: Lost executor 162 on 192.168.6.223: The executor with id 162 was deleted by a user or the framework.
19/10/03 18:51:44 ERROR TaskSchedulerImpl: Lost executor 153 on 192.168.47.166: The executor with id 153 was deleted by a user or the framework.
19/10/03 18:51:46 WARN TransportChannelHandler: Exception in connection from /192.168.24.13:34582
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:51:46 WARN TransportChannelHandler: Exception in connection from /192.168.6.223:35276
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:51:51 WARN TransportChannelHandler: Exception in connection from /192.168.25.31:54764
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:51:52 WARN TransportChannelHandler: Exception in connection from /192.168.23.34:46714
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:51:57 WARN TransportChannelHandler: Exception in connection from /192.168.53.102:36750
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:11 WARN TransportChannelHandler: Exception in connection from /192.168.47.166:33566
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:13 WARN TaskSetManager: Lost task 46.0 in stage 200.3 (TID 426541, 192.168.11.32, executor 180): FetchFailed(BlockManagerId(67, 192.168.23.34, 39131, None), shuffleId=100, mapId=6875, reduceId=123, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.23.34:39131
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.23.34:39131
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.23.34:39131
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
Execution 'q14a-v2.4' failed: Exception thrown in awaitResult: 
Running execution q14b-v2.4 iteration: 1, StandardRun=true
19/10/03 18:52:15 WARN TaskSetManager: Lost task 1.1 in stage 200.3 (TID 426580, 192.168.17.222, executor 106): FetchFailed(BlockManagerId(162, 192.168.6.223, 39605, None), shuffleId=101, mapId=1306, reduceId=12, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.6.223:39605
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.6.223:39605
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.6.223:39605
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:52:16 INFO Query: 
== Query: q14b-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#12165 ASC NULLS FIRST, i_brand_id#571 ASC NULLS FIRST, i_class_id#573 ASC NULLS FIRST, i_category_id#575 ASC NULLS FIRST], true
      +- Project [channel#12165, i_brand_id#571, i_class_id#573, i_category_id#575, sales#12166, number_sales#12167L, channel#12171, i_brand_id#12206, i_class_id#12208, i_category_id#12210, sales#12172, number_sales#12173L]
         +- Filter (((i_brand_id#571 = i_brand_id#12206) && (i_class_id#573 = i_class_id#12208)) && (i_category_id#575 = i_category_id#12210))
            +- Join Inner
               :- SubqueryAlias `this_year`
               :  +- Project [channel#12165, i_brand_id#571, i_class_id#573, i_category_id#575, sales#12166, number_sales#12167L]
               :     +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12195 as decimal(32,6)) > cast(scalar-subquery#12170 [] as decimal(32,6)))
               :        :  +- Project [average_sales#12187]
               :        :     +- SubqueryAlias `avg_sales`
               :        :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#12181 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#12182 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#12187]
               :        :           +- SubqueryAlias `x`
               :        :              +- Union
               :        :                 :- Union
               :        :                 :  :- Project [ss_quantity#140 AS quantity#12181, ss_list_price#142 AS list_price#12182]
               :        :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :        :                 :  :     +- Join Inner
               :        :                 :  :        :- SubqueryAlias `store_sales`
               :        :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :        :                 :  :        +- SubqueryAlias `date_dim`
               :        :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :        :                 :  +- Project [cs_quantity#18 AS quantity#12183, cs_list_price#20 AS list_price#12184]
               :        :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :        :                 :        +- Join Inner
               :        :                 :           :- SubqueryAlias `catalog_sales`
               :        :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :        :                 :           +- SubqueryAlias `date_dim`
               :        :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :        :                 +- Project [ws_quantity#234 AS quantity#12185, ws_list_price#236 AS list_price#12186]
               :        :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :        :                       +- Join Inner
               :        :                          :- SubqueryAlias `web_sales`
               :        :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :        :                          +- SubqueryAlias `date_dim`
               :        :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :        +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [store AS channel#12165, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sales#12166, count(1) AS number_sales#12167L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12195]
               :           +- Filter ((ss_item_sk#132 IN (list#12168 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_week_seq#496 = scalar-subquery#12169 [])))
               :              :  :- Project [ss_item_sk#12180]
               :              :  :  +- SubqueryAlias `cross_items`
               :              :  :     +- Project [i_item_sk#564 AS ss_item_sk#12180]
               :              :  :        +- Filter (((i_brand_id#571 = brand_id#12177) && (i_class_id#573 = class_id#12178)) && (i_category_id#575 = category_id#12179))
               :              :  :           +- Join Inner
               :              :  :              :- SubqueryAlias `item`
               :              :  :              :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :              +- SubqueryAlias `x`
               :              :  :                 +- Intersect false
               :              :  :                    :- Intersect false
               :              :  :                    :  :- Project [i_brand_id#571 AS brand_id#12177, i_class_id#573 AS class_id#12178, i_category_id#575 AS category_id#12179]
               :              :  :                    :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :              :  :                    :  :     +- Join Inner
               :              :  :                    :  :        :- Join Inner
               :              :  :                    :  :        :  :- SubqueryAlias `store_sales`
               :              :  :                    :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :              :  :                    :  :        :  +- SubqueryAlias `iss`
               :              :  :                    :  :        :     +- SubqueryAlias `item`
               :              :  :                    :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :                    :  :        +- SubqueryAlias `d1`
               :              :  :                    :  :           +- SubqueryAlias `date_dim`
               :              :  :                    :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              :  :                    :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
               :              :  :                    :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :              :  :                    :        +- Join Inner
               :              :  :                    :           :- Join Inner
               :              :  :                    :           :  :- SubqueryAlias `catalog_sales`
               :              :  :                    :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :              :  :                    :           :  +- SubqueryAlias `ics`
               :              :  :                    :           :     +- SubqueryAlias `item`
               :              :  :                    :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :                    :           +- SubqueryAlias `d2`
               :              :  :                    :              +- SubqueryAlias `date_dim`
               :              :  :                    :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              :  :                    +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
               :              :  :                       +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :              :  :                          +- Join Inner
               :              :  :                             :- Join Inner
               :              :  :                             :  :- SubqueryAlias `web_sales`
               :              :  :                             :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :              :  :                             :  +- SubqueryAlias `iws`
               :              :  :                             :     +- SubqueryAlias `item`
               :              :  :                             :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :                             +- SubqueryAlias `d3`
               :              :  :                                +- SubqueryAlias `date_dim`
               :              :  :                                   +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              :  +- Project [d_week_seq#496]
               :              :     +- Filter (((d_year#498 = (1999 + 1)) && (d_moy#500 = 12)) && (d_dom#501 = 11))
               :              :        +- SubqueryAlias `date_dim`
               :              :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- SubqueryAlias `store_sales`
               :                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :                 :  +- SubqueryAlias `item`
               :                 :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                 +- SubqueryAlias `date_dim`
               :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `last_year`
                  +- Project [channel#12171, i_brand_id#12206, i_class_id#12208, i_category_id#12210, sales#12172, number_sales#12173L]
                     +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12198 as decimal(32,6)) > cast(scalar-subquery#12176 [] as decimal(32,6)))
                        :  +- Project [average_sales#12187]
                        :     +- SubqueryAlias `avg_sales`
                        :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#12181 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#12182 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#12187]
                        :           +- SubqueryAlias `x`
                        :              +- Union
                        :                 :- Union
                        :                 :  :- Project [ss_quantity#140 AS quantity#12181, ss_list_price#142 AS list_price#12182]
                        :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                        :                 :  :     +- Join Inner
                        :                 :  :        :- SubqueryAlias `store_sales`
                        :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :                 :  :        +- SubqueryAlias `date_dim`
                        :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :                 :  +- Project [cs_quantity#18 AS quantity#12183, cs_list_price#20 AS list_price#12184]
                        :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                        :                 :        +- Join Inner
                        :                 :           :- SubqueryAlias `catalog_sales`
                        :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :                 :           +- SubqueryAlias `date_dim`
                        :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :                 +- Project [ws_quantity#234 AS quantity#12185, ws_list_price#236 AS list_price#12186]
                        :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                        :                       +- Join Inner
                        :                          :- SubqueryAlias `web_sales`
                        :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :                          +- SubqueryAlias `date_dim`
                        :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [i_brand_id#12206, i_class_id#12208, i_category_id#12210], [store AS channel#12171, i_brand_id#12206, i_class_id#12208, i_category_id#12210, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sales#12172, count(1) AS number_sales#12173L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12198]
                           +- Filter ((ss_item_sk#132 IN (list#12174 []) && (ss_item_sk#132 = i_item_sk#12199)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_week_seq#496 = scalar-subquery#12175 [])))
                              :  :- Project [ss_item_sk#12180]
                              :  :  +- SubqueryAlias `cross_items`
                              :  :     +- Project [i_item_sk#564 AS ss_item_sk#12180]
                              :  :        +- Filter (((i_brand_id#571 = brand_id#12177) && (i_class_id#573 = class_id#12178)) && (i_category_id#575 = category_id#12179))
                              :  :           +- Join Inner
                              :  :              :- SubqueryAlias `item`
                              :  :              :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :              +- SubqueryAlias `x`
                              :  :                 +- Intersect false
                              :  :                    :- Intersect false
                              :  :                    :  :- Project [i_brand_id#571 AS brand_id#12177, i_class_id#573 AS class_id#12178, i_category_id#575 AS category_id#12179]
                              :  :                    :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                              :  :                    :  :     +- Join Inner
                              :  :                    :  :        :- Join Inner
                              :  :                    :  :        :  :- SubqueryAlias `store_sales`
                              :  :                    :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  :                    :  :        :  +- SubqueryAlias `iss`
                              :  :                    :  :        :     +- SubqueryAlias `item`
                              :  :                    :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :                    :  :        +- SubqueryAlias `d1`
                              :  :                    :  :           +- SubqueryAlias `date_dim`
                              :  :                    :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  :                    :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                              :  :                    :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                              :  :                    :        +- Join Inner
                              :  :                    :           :- Join Inner
                              :  :                    :           :  :- SubqueryAlias `catalog_sales`
                              :  :                    :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                              :  :                    :           :  +- SubqueryAlias `ics`
                              :  :                    :           :     +- SubqueryAlias `item`
                              :  :                    :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :                    :           +- SubqueryAlias `d2`
                              :  :                    :              +- SubqueryAlias `date_dim`
                              :  :                    :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  :                    +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                              :  :                       +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                              :  :                          +- Join Inner
                              :  :                             :- Join Inner
                              :  :                             :  :- SubqueryAlias `web_sales`
                              :  :                             :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :                             :  +- SubqueryAlias `iws`
                              :  :                             :     +- SubqueryAlias `item`
                              :  :                             :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :                             +- SubqueryAlias `d3`
                              :  :                                +- SubqueryAlias `date_dim`
                              :  :                                   +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- Project [d_week_seq#496]
                              :     +- Filter (((d_year#498 = 1999) && (d_moy#500 = 12)) && (d_dom#501 = 11))
                              :        +- SubqueryAlias `date_dim`
                              :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `store_sales`
                                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `item`
                                 :     +- Relation[i_item_sk#12199,i_item_id#12200,i_rec_start_date#12201,i_rec_end_date#12202,i_item_desc#12203,i_current_price#12204,i_wholesale_cost#12205,i_brand_id#12206,i_brand#12207,i_class_id#12208,i_class#12209,i_category_id#12210,i_category#12211,i_manufact_id#12212,i_manufact#12213,i_size#12214,i_formulation#12215,i_color#12216,i_units#12217,i_container#12218,i_manager_id#12219,i_product_name#12220] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/03 18:52:16 INFO Query: 
== Query: q14b-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#12237 ASC NULLS FIRST, i_brand_id#571 ASC NULLS FIRST, i_class_id#573 ASC NULLS FIRST, i_category_id#575 ASC NULLS FIRST], true
      +- Project [channel#12237, i_brand_id#571, i_class_id#573, i_category_id#575, sales#12238, number_sales#12239L, channel#12243, i_brand_id#12278, i_class_id#12280, i_category_id#12282, sales#12244, number_sales#12245L]
         +- Filter (((i_brand_id#571 = i_brand_id#12278) && (i_class_id#573 = i_class_id#12280)) && (i_category_id#575 = i_category_id#12282))
            +- Join Inner
               :- SubqueryAlias `this_year`
               :  +- Project [channel#12237, i_brand_id#571, i_class_id#573, i_category_id#575, sales#12238, number_sales#12239L]
               :     +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12267 as decimal(32,6)) > cast(scalar-subquery#12242 [] as decimal(32,6)))
               :        :  +- Project [average_sales#12259]
               :        :     +- SubqueryAlias `avg_sales`
               :        :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#12253 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#12254 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#12259]
               :        :           +- SubqueryAlias `x`
               :        :              +- Union
               :        :                 :- Union
               :        :                 :  :- Project [ss_quantity#140 AS quantity#12253, ss_list_price#142 AS list_price#12254]
               :        :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :        :                 :  :     +- Join Inner
               :        :                 :  :        :- SubqueryAlias `store_sales`
               :        :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :        :                 :  :        +- SubqueryAlias `date_dim`
               :        :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :        :                 :  +- Project [cs_quantity#18 AS quantity#12255, cs_list_price#20 AS list_price#12256]
               :        :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :        :                 :        +- Join Inner
               :        :                 :           :- SubqueryAlias `catalog_sales`
               :        :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :        :                 :           +- SubqueryAlias `date_dim`
               :        :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :        :                 +- Project [ws_quantity#234 AS quantity#12257, ws_list_price#236 AS list_price#12258]
               :        :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :        :                       +- Join Inner
               :        :                          :- SubqueryAlias `web_sales`
               :        :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :        :                          +- SubqueryAlias `date_dim`
               :        :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :        +- Aggregate [i_brand_id#571, i_class_id#573, i_category_id#575], [store AS channel#12237, i_brand_id#571, i_class_id#573, i_category_id#575, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sales#12238, count(1) AS number_sales#12239L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12267]
               :           +- Filter ((ss_item_sk#132 IN (list#12240 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_week_seq#496 = scalar-subquery#12241 [])))
               :              :  :- Project [ss_item_sk#12252]
               :              :  :  +- SubqueryAlias `cross_items`
               :              :  :     +- Project [i_item_sk#564 AS ss_item_sk#12252]
               :              :  :        +- Filter (((i_brand_id#571 = brand_id#12249) && (i_class_id#573 = class_id#12250)) && (i_category_id#575 = category_id#12251))
               :              :  :           +- Join Inner
               :              :  :              :- SubqueryAlias `item`
               :              :  :              :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :              +- SubqueryAlias `x`
               :              :  :                 +- Intersect false
               :              :  :                    :- Intersect false
               :              :  :                    :  :- Project [i_brand_id#571 AS brand_id#12249, i_class_id#573 AS class_id#12250, i_category_id#575 AS category_id#12251]
               :              :  :                    :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :              :  :                    :  :     +- Join Inner
               :              :  :                    :  :        :- Join Inner
               :              :  :                    :  :        :  :- SubqueryAlias `store_sales`
               :              :  :                    :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :              :  :                    :  :        :  +- SubqueryAlias `iss`
               :              :  :                    :  :        :     +- SubqueryAlias `item`
               :              :  :                    :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :                    :  :        +- SubqueryAlias `d1`
               :              :  :                    :  :           +- SubqueryAlias `date_dim`
               :              :  :                    :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              :  :                    :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
               :              :  :                    :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :              :  :                    :        +- Join Inner
               :              :  :                    :           :- Join Inner
               :              :  :                    :           :  :- SubqueryAlias `catalog_sales`
               :              :  :                    :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :              :  :                    :           :  +- SubqueryAlias `ics`
               :              :  :                    :           :     +- SubqueryAlias `item`
               :              :  :                    :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :                    :           +- SubqueryAlias `d2`
               :              :  :                    :              +- SubqueryAlias `date_dim`
               :              :  :                    :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              :  :                    +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
               :              :  :                       +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
               :              :  :                          +- Join Inner
               :              :  :                             :- Join Inner
               :              :  :                             :  :- SubqueryAlias `web_sales`
               :              :  :                             :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :              :  :                             :  +- SubqueryAlias `iws`
               :              :  :                             :     +- SubqueryAlias `item`
               :              :  :                             :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              :  :                             +- SubqueryAlias `d3`
               :              :  :                                +- SubqueryAlias `date_dim`
               :              :  :                                   +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              :  +- Project [d_week_seq#496]
               :              :     +- Filter (((d_year#498 = (1999 + 1)) && (d_moy#500 = 12)) && (d_dom#501 = 11))
               :              :        +- SubqueryAlias `date_dim`
               :              :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- SubqueryAlias `store_sales`
               :                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :                 :  +- SubqueryAlias `item`
               :                 :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                 +- SubqueryAlias `date_dim`
               :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `last_year`
                  +- Project [channel#12243, i_brand_id#12278, i_class_id#12280, i_category_id#12282, sales#12244, number_sales#12245L]
                     +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12270 as decimal(32,6)) > cast(scalar-subquery#12248 [] as decimal(32,6)))
                        :  +- Project [average_sales#12259]
                        :     +- SubqueryAlias `avg_sales`
                        :        +- Aggregate [avg(CheckOverflow((promote_precision(cast(cast(quantity#12253 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#12254 as decimal(12,2)))), DecimalType(18,2))) AS average_sales#12259]
                        :           +- SubqueryAlias `x`
                        :              +- Union
                        :                 :- Union
                        :                 :  :- Project [ss_quantity#140 AS quantity#12253, ss_list_price#142 AS list_price#12254]
                        :                 :  :  +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                        :                 :  :     +- Join Inner
                        :                 :  :        :- SubqueryAlias `store_sales`
                        :                 :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :                 :  :        +- SubqueryAlias `date_dim`
                        :                 :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :                 :  +- Project [cs_quantity#18 AS quantity#12255, cs_list_price#20 AS list_price#12256]
                        :                 :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                        :                 :        +- Join Inner
                        :                 :           :- SubqueryAlias `catalog_sales`
                        :                 :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :                 :           +- SubqueryAlias `date_dim`
                        :                 :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :                 +- Project [ws_quantity#234 AS quantity#12257, ws_list_price#236 AS list_price#12258]
                        :                    +- Filter ((ws_sold_date_sk#216 = d_date_sk#492) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                        :                       +- Join Inner
                        :                          :- SubqueryAlias `web_sales`
                        :                          :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :                          +- SubqueryAlias `date_dim`
                        :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [i_brand_id#12278, i_class_id#12280, i_category_id#12282], [store AS channel#12243, i_brand_id#12278, i_class_id#12280, i_category_id#12282, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sales#12244, count(1) AS number_sales#12245L, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#142 as decimal(12,2)))), DecimalType(18,2)))#12270]
                           +- Filter ((ss_item_sk#132 IN (list#12246 []) && (ss_item_sk#132 = i_item_sk#12271)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_week_seq#496 = scalar-subquery#12247 [])))
                              :  :- Project [ss_item_sk#12252]
                              :  :  +- SubqueryAlias `cross_items`
                              :  :     +- Project [i_item_sk#564 AS ss_item_sk#12252]
                              :  :        +- Filter (((i_brand_id#571 = brand_id#12249) && (i_class_id#573 = class_id#12250)) && (i_category_id#575 = category_id#12251))
                              :  :           +- Join Inner
                              :  :              :- SubqueryAlias `item`
                              :  :              :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :              +- SubqueryAlias `x`
                              :  :                 +- Intersect false
                              :  :                    :- Intersect false
                              :  :                    :  :- Project [i_brand_id#571 AS brand_id#12249, i_class_id#573 AS class_id#12250, i_category_id#575 AS category_id#12251]
                              :  :                    :  :  +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                              :  :                    :  :     +- Join Inner
                              :  :                    :  :        :- Join Inner
                              :  :                    :  :        :  :- SubqueryAlias `store_sales`
                              :  :                    :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  :                    :  :        :  +- SubqueryAlias `iss`
                              :  :                    :  :        :     +- SubqueryAlias `item`
                              :  :                    :  :        :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :                    :  :        +- SubqueryAlias `d1`
                              :  :                    :  :           +- SubqueryAlias `date_dim`
                              :  :                    :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  :                    :  +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                              :  :                    :     +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                              :  :                    :        +- Join Inner
                              :  :                    :           :- Join Inner
                              :  :                    :           :  :- SubqueryAlias `catalog_sales`
                              :  :                    :           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                              :  :                    :           :  +- SubqueryAlias `ics`
                              :  :                    :           :     +- SubqueryAlias `item`
                              :  :                    :           :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :                    :           +- SubqueryAlias `d2`
                              :  :                    :              +- SubqueryAlias `date_dim`
                              :  :                    :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  :                    +- Project [i_brand_id#571, i_class_id#573, i_category_id#575]
                              :  :                       +- Filter (((ws_item_sk#219 = i_item_sk#564) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 >= 1999) && (d_year#498 <= (1999 + 2))))
                              :  :                          +- Join Inner
                              :  :                             :- Join Inner
                              :  :                             :  :- SubqueryAlias `web_sales`
                              :  :                             :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :                             :  +- SubqueryAlias `iws`
                              :  :                             :     +- SubqueryAlias `item`
                              :  :                             :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              :  :                             +- SubqueryAlias `d3`
                              :  :                                +- SubqueryAlias `date_dim`
                              :  :                                   +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- Project [d_week_seq#496]
                              :     +- Filter (((d_year#498 = 1999) && (d_moy#500 = 12)) && (d_dom#501 = 11))
                              :        +- SubqueryAlias `date_dim`
                              :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `store_sales`
                                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `item`
                                 :     +- Relation[i_item_sk#12271,i_item_id#12272,i_rec_start_date#12273,i_rec_end_date#12274,i_item_desc#12275,i_current_price#12276,i_wholesale_cost#12277,i_brand_id#12278,i_brand#12279,i_class_id#12280,i_class#12281,i_category_id#12282,i_category#12283,i_manufact_id#12284,i_manufact#12285,i_size#12286,i_formulation#12287,i_color#12288,i_units#12289,i_container#12290,i_manager_id#12291,i_product_name#12292] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
19/10/03 18:52:44 WARN HeartbeatReceiver: Removing executor 167 with no recent heartbeats: 140135 ms exceeds timeout 120000 ms
19/10/03 18:52:44 ERROR TaskSchedulerImpl: Lost executor 167 on 192.168.34.94: Executor heartbeat timed out after 140135 ms
19/10/03 18:52:44 WARN TaskSetManager: Lost task 39.0 in stage 200.3 (TID 426534, 192.168.34.94, executor 167): ExecutorLostFailure (executor 167 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 140135 ms
19/10/03 18:52:44 WARN HeartbeatReceiver: Removing executor 160 with no recent heartbeats: 137293 ms exceeds timeout 120000 ms
19/10/03 18:52:44 ERROR TaskSchedulerImpl: Lost executor 160 on 192.168.43.109: Executor heartbeat timed out after 137293 ms
19/10/03 18:52:44 WARN TaskSetManager: Lost task 4.0 in stage 200.3 (TID 426499, 192.168.43.109, executor 160): ExecutorLostFailure (executor 160 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 137293 ms
19/10/03 18:52:44 WARN HeartbeatReceiver: Removing executor 157 with no recent heartbeats: 154702 ms exceeds timeout 120000 ms
19/10/03 18:52:44 ERROR TaskSchedulerImpl: Lost executor 157 on 192.168.27.0: Executor heartbeat timed out after 154702 ms
19/10/03 18:52:44 WARN TaskSetManager: Lost task 76.0 in stage 200.3 (TID 426571, 192.168.27.0, executor 157): ExecutorLostFailure (executor 157 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 154702 ms
19/10/03 18:52:44 WARN HeartbeatReceiver: Removing executor 124 with no recent heartbeats: 140538 ms exceeds timeout 120000 ms
19/10/03 18:52:44 ERROR TaskSchedulerImpl: Lost executor 124 on 192.168.29.244: Executor heartbeat timed out after 140538 ms
19/10/03 18:52:44 WARN TaskSetManager: Lost task 7.0 in stage 200.3 (TID 426502, 192.168.29.244, executor 124): ExecutorLostFailure (executor 124 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 140538 ms
19/10/03 18:52:44 WARN HeartbeatReceiver: Removing executor 103 with no recent heartbeats: 176615 ms exceeds timeout 120000 ms
19/10/03 18:52:44 ERROR TaskSchedulerImpl: Lost executor 103 on 192.168.23.105: Executor heartbeat timed out after 176615 ms
19/10/03 18:52:44 WARN TaskSetManager: Lost task 73.0 in stage 200.3 (TID 426568, 192.168.23.105, executor 103): ExecutorLostFailure (executor 103 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 176615 ms
19/10/03 18:52:44 WARN HeartbeatReceiver: Removing executor 91 with no recent heartbeats: 156411 ms exceeds timeout 120000 ms
19/10/03 18:52:44 ERROR TaskSchedulerImpl: Lost executor 91 on 192.168.26.91: Executor heartbeat timed out after 156411 ms
19/10/03 18:52:44 WARN TaskSetManager: Lost task 31.0 in stage 200.3 (TID 426526, 192.168.26.91, executor 91): ExecutorLostFailure (executor 91 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 156411 ms
19/10/03 18:52:44 WARN HeartbeatReceiver: Removing executor 88 with no recent heartbeats: 153266 ms exceeds timeout 120000 ms
19/10/03 18:52:44 ERROR TaskSchedulerImpl: Lost executor 88 on 192.168.45.40: Executor heartbeat timed out after 153266 ms
19/10/03 18:52:44 WARN TaskSetManager: Lost task 42.0 in stage 200.3 (TID 426537, 192.168.45.40, executor 88): ExecutorLostFailure (executor 88 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 153266 ms
19/10/03 18:52:44 WARN HeartbeatReceiver: Removing executor 144 with no recent heartbeats: 145775 ms exceeds timeout 120000 ms
19/10/03 18:52:44 ERROR TaskSchedulerImpl: Lost executor 144 on 192.168.53.51: Executor heartbeat timed out after 145775 ms
19/10/03 18:52:44 WARN TaskSetManager: Lost task 41.0 in stage 200.3 (TID 426536, 192.168.53.51, executor 144): ExecutorLostFailure (executor 144 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 145775 ms
19/10/03 18:52:44 WARN HeartbeatReceiver: Removing executor 171 with no recent heartbeats: 173682 ms exceeds timeout 120000 ms
19/10/03 18:52:44 ERROR TaskSchedulerImpl: Lost executor 171 on 192.168.26.169: Executor heartbeat timed out after 173682 ms
19/10/03 18:52:44 WARN TaskSetManager: Lost task 70.0 in stage 200.3 (TID 426565, 192.168.26.169, executor 171): ExecutorLostFailure (executor 171 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 173682 ms
19/10/03 18:52:44 ERROR TaskSchedulerImpl: Lost executor 167 on 192.168.34.94: The executor with id 167 was deleted by a user or the framework.
19/10/03 18:52:44 ERROR TaskSchedulerImpl: Lost executor 160 on 192.168.43.109: The executor with id 160 was deleted by a user or the framework.
19/10/03 18:52:44 ERROR TaskSchedulerImpl: Lost executor 157 on 192.168.27.0: The executor with id 157 was deleted by a user or the framework.
19/10/03 18:52:44 ERROR TaskSchedulerImpl: Lost executor 124 on 192.168.29.244: The executor with id 124 was deleted by a user or the framework.
19/10/03 18:52:44 ERROR TaskSchedulerImpl: Lost executor 103 on 192.168.23.105: The executor with id 103 was deleted by a user or the framework.
19/10/03 18:52:44 ERROR TaskSchedulerImpl: Lost executor 91 on 192.168.26.91: The executor with id 91 was deleted by a user or the framework.
19/10/03 18:52:44 ERROR TaskSchedulerImpl: Lost executor 88 on 192.168.45.40: The executor with id 88 was deleted by a user or the framework.
19/10/03 18:52:44 ERROR TaskSchedulerImpl: Lost executor 144 on 192.168.53.51: The executor with id 144 was deleted by a user or the framework.
19/10/03 18:52:44 ERROR TaskSchedulerImpl: Lost executor 171 on 192.168.26.169: The executor with id 171 was deleted by a user or the framework.
19/10/03 18:52:46 WARN TransportChannelHandler: Exception in connection from /192.168.27.0:58644
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.27.0:58644 is closed
19/10/03 18:52:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 336 from block manager BlockManagerId(157, 192.168.27.0, 38571, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:46 WARN TransportChannelHandler: Exception in connection from /192.168.29.244:60800
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.29.244:60800 is closed
19/10/03 18:52:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 336 from block manager BlockManagerId(124, 192.168.29.244, 44045, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:46 WARN TransportChannelHandler: Exception in connection from /192.168.26.91:43890
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.26.91:43890 is closed
19/10/03 18:52:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 336 from block manager BlockManagerId(91, 192.168.26.91, 34109, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:46 WARN TransportChannelHandler: Exception in connection from /192.168.26.169:55524
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.26.169:55524 is closed
19/10/03 18:52:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 336 from block manager BlockManagerId(171, 192.168.26.169, 33381, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:46 WARN TransportChannelHandler: Exception in connection from /192.168.45.40:56286
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.45.40:56286 is closed
19/10/03 18:52:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 336 from block manager BlockManagerId(88, 192.168.45.40, 38895, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:46 WARN TransportChannelHandler: Exception in connection from /192.168.34.94:50324
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.34.94:50324 is closed
19/10/03 18:52:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 336 from block manager BlockManagerId(167, 192.168.34.94, 38751, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:49 WARN TransportChannelHandler: Exception in connection from /192.168.53.51:38596
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:49 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.53.51:38596 is closed
19/10/03 18:52:49 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 336 from block manager BlockManagerId(144, 192.168.53.51, 36249, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:49 WARN TransportChannelHandler: Exception in connection from /192.168.23.105:60944
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:49 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.23.105:60944 is closed
19/10/03 18:52:49 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 336 from block manager BlockManagerId(103, 192.168.23.105, 46351, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:57 WARN TransportChannelHandler: Exception in connection from /192.168.43.109:38150
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:52:57 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.43.109:38150 is closed
19/10/03 18:52:57 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 336 from block manager BlockManagerId(160, 192.168.43.109, 42435, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:53:01 WARN TaskSetManager: Lost task 79.0 in stage 200.3 (TID 426574, 192.168.27.131, executor 56): FetchFailed(BlockManagerId(91, 192.168.26.91, 34109, None), shuffleId=100, mapId=3553, reduceId=193, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.26.91:34109
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.26.91:34109
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.26.91:34109
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:53:02 WARN TaskSetManager: Lost task 35.0 in stage 200.3 (TID 426530, 192.168.5.155, executor 149): FetchFailed(BlockManagerId(124, 192.168.29.244, 44045, None), shuffleId=100, mapId=4, reduceId=83, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.29.244:44045
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.29.244:44045
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.29.244:44045
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:53:08 WARN TaskSetManager: Lost task 25.0 in stage 200.3 (TID 426520, 192.168.20.146, executor 129): FetchFailed(BlockManagerId(124, 192.168.29.244, 44045, None), shuffleId=100, mapId=1397, reduceId=63, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.29.244:44045
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.29.244:44045
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.29.244:44045
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:53:08 WARN TaskSetManager: Lost task 18.1 in stage 200.3 (TID 426581, 192.168.6.25, executor 112): FetchFailed(null, shuffleId=100, mapId=-1, reduceId=44, message=
org.apache.spark.shuffle.MetadataFetchFailedException: Missing an output location for shuffle 100
	at org.apache.spark.MapOutputTracker$$anonfun$convertMapStatuses$2.apply(MapOutputTracker.scala:882)
	at org.apache.spark.MapOutputTracker$$anonfun$convertMapStatuses$2.apply(MapOutputTracker.scala:878)
	at scala.collection.Iterator$class.foreach(Iterator.scala:891)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1334)
	at org.apache.spark.MapOutputTracker$.convertMapStatuses(MapOutputTracker.scala:878)
	at org.apache.spark.MapOutputTrackerWorker.getMapSizesByExecutorId(MapOutputTracker.scala:691)
	at org.apache.spark.shuffle.BlockStoreShuffleReader.read(BlockStoreShuffleReader.scala:49)
	at org.apache.spark.sql.execution.ShuffledRowRDD.compute(ShuffledRowRDD.scala:165)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

)
19/10/03 18:53:44 WARN HeartbeatReceiver: Removing executor 61 with no recent heartbeats: 148827 ms exceeds timeout 120000 ms
19/10/03 18:53:44 ERROR TaskSchedulerImpl: Lost executor 61 on 192.168.12.126: Executor heartbeat timed out after 148827 ms
19/10/03 18:53:44 WARN TaskSetManager: Lost task 29.0 in stage 200.3 (TID 426524, 192.168.12.126, executor 61): ExecutorLostFailure (executor 61 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 148827 ms
19/10/03 18:53:44 WARN HeartbeatReceiver: Removing executor 141 with no recent heartbeats: 179417 ms exceeds timeout 120000 ms
19/10/03 18:53:44 ERROR TaskSchedulerImpl: Lost executor 141 on 192.168.9.204: Executor heartbeat timed out after 179417 ms
19/10/03 18:53:44 WARN TaskSetManager: Lost task 34.0 in stage 200.3 (TID 426529, 192.168.9.204, executor 141): ExecutorLostFailure (executor 141 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 179417 ms
19/10/03 18:53:44 ERROR TaskSchedulerImpl: Lost executor 61 on 192.168.12.126: The executor with id 61 was deleted by a user or the framework.
19/10/03 18:53:44 ERROR TaskSchedulerImpl: Lost executor 141 on 192.168.9.204: The executor with id 141 was deleted by a user or the framework.
19/10/03 18:53:46 WARN TransportChannelHandler: Exception in connection from /192.168.12.126:59744
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:53:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.12.126:59744 is closed
19/10/03 18:53:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 336 from block manager BlockManagerId(61, 192.168.12.126, 35923, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:53:46 WARN TransportChannelHandler: Exception in connection from /192.168.9.204:55280
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:53:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.9.204:55280 is closed
19/10/03 18:53:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 336 from block manager BlockManagerId(141, 192.168.9.204, 40443, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:54:00 WARN TaskSetManager: Lost task 59.0 in stage 200.3 (TID 426554, 192.168.12.96, executor 143): FetchFailed(BlockManagerId(61, 192.168.12.126, 35923, None), shuffleId=100, mapId=0, reduceId=150, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.12.126:35923
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.12.126:35923
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.12.126:35923
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:54:14 ERROR TransportChannelHandler: Connection to /192.168.4.120:59626 has been quiet for 120000 ms while there are outstanding requests. Assuming connection is dead; please adjust spark.network.timeout if this is wrong.
19/10/03 18:54:14 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.4.120:59626 is closed
19/10/03 18:54:14 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 336 from block manager BlockManagerId(62, 192.168.4.120, 40409, None)
java.io.IOException: Connection from /192.168.4.120:59626 closed
	at org.apache.spark.network.client.TransportResponseHandler.channelInactive(TransportResponseHandler.java:146)
	at org.apache.spark.network.server.TransportChannelHandler.channelInactive(TransportChannelHandler.java:108)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:245)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:231)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:224)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:75)
	at io.netty.handler.timeout.IdleStateHandler.channelInactive(IdleStateHandler.java:277)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:245)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:231)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:224)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:75)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:245)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:231)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:224)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:75)
	at org.apache.spark.network.util.TransportFrameDecoder.channelInactive(TransportFrameDecoder.java:182)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:245)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:231)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:224)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1354)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:245)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:231)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:917)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$8.run(AbstractChannel.java:822)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:403)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:463)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:54:14 ERROR TransportChannelHandler: Connection to /192.168.51.65:41190 has been quiet for 120000 ms while there are outstanding requests. Assuming connection is dead; please adjust spark.network.timeout if this is wrong.
19/10/03 18:54:14 ERROR ContextCleaner: Error cleaning broadcast 336
org.apache.spark.rpc.RpcTimeoutException: Futures timed out after [120 seconds]. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:76)
	at org.apache.spark.storage.BlockManagerMaster.removeBroadcast(BlockManagerMaster.scala:155)
	at org.apache.spark.broadcast.TorrentBroadcast$.unpersist(TorrentBroadcast.scala:321)
	at org.apache.spark.broadcast.TorrentBroadcastFactory.unbroadcast(TorrentBroadcastFactory.scala:45)
	at org.apache.spark.broadcast.BroadcastManager.unbroadcast(BroadcastManager.scala:66)
	at org.apache.spark.ContextCleaner.doCleanupBroadcast(ContextCleaner.scala:238)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:194)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:185)
	at scala.Option.foreach(Option.scala:257)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1.apply$mcV$sp(ContextCleaner.scala:185)
	at org.apache.spark.util.Utils$.tryOrStopSparkContext(Utils.scala:1302)
	at org.apache.spark.ContextCleaner.org$apache$spark$ContextCleaner$$keepCleaning(ContextCleaner.scala:178)
	at org.apache.spark.ContextCleaner$$anon$1.run(ContextCleaner.scala:73)
Caused by: java.util.concurrent.TimeoutException: Futures timed out after [120 seconds]
	at scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:223)
	at scala.concurrent.impl.Promise$DefaultPromise.result(Promise.scala:227)
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:220)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:75)
	... 12 more
19/10/03 18:54:14 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.51.65:41190 is closed
19/10/03 18:54:14 ERROR TransportClient: Failed to send RPC RPC 8890075819642093580 to /192.168.4.120:59626: java.nio.channels.ClosedChannelException
java.nio.channels.ClosedChannelException
	at io.netty.channel.AbstractChannel$AbstractUnsafe.write(...)(Unknown Source)
19/10/03 18:54:14 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 336 from block manager BlockManagerId(156, 192.168.51.65, 39201, None)
java.io.IOException: Connection from /192.168.51.65:41190 closed
	at org.apache.spark.network.client.TransportResponseHandler.channelInactive(TransportResponseHandler.java:146)
	at org.apache.spark.network.server.TransportChannelHandler.channelInactive(TransportChannelHandler.java:108)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:245)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:231)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:224)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:75)
	at io.netty.handler.timeout.IdleStateHandler.channelInactive(IdleStateHandler.java:277)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:245)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:231)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:224)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:75)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:245)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:231)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:224)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:75)
	at org.apache.spark.network.util.TransportFrameDecoder.channelInactive(TransportFrameDecoder.java:182)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:245)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:231)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:224)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1354)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:245)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:231)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:917)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$8.run(AbstractChannel.java:822)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:403)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:463)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:54:14 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 381 from block manager BlockManagerId(62, 192.168.4.120, 40409, None)
java.io.IOException: Failed to send RPC RPC 8890075819642093580 to /192.168.4.120:59626: java.nio.channels.ClosedChannelException
	at org.apache.spark.network.client.TransportClient$RpcChannelListener.handleFailure(TransportClient.java:362)
	at org.apache.spark.network.client.TransportClient$StdChannelListener.operationComplete(TransportClient.java:339)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:507)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:481)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:420)
	at io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:122)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetFailure(AbstractChannel.java:987)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.write(AbstractChannel.java:869)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.write(DefaultChannelPipeline.java:1316)
	at io.netty.channel.AbstractChannelHandlerContext.invokeWrite0(AbstractChannelHandlerContext.java:738)
	at io.netty.channel.AbstractChannelHandlerContext.invokeWrite(AbstractChannelHandlerContext.java:730)
	at io.netty.channel.AbstractChannelHandlerContext.access$1900(AbstractChannelHandlerContext.java:38)
	at io.netty.channel.AbstractChannelHandlerContext$AbstractWriteTask.write(AbstractChannelHandlerContext.java:1081)
	at io.netty.channel.AbstractChannelHandlerContext$WriteAndFlushTask.write(AbstractChannelHandlerContext.java:1128)
	at io.netty.channel.AbstractChannelHandlerContext$AbstractWriteTask.run(AbstractChannelHandlerContext.java:1070)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:403)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:463)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.nio.channels.ClosedChannelException
	at io.netty.channel.AbstractChannel$AbstractUnsafe.write(...)(Unknown Source)
19/10/03 18:54:14 ERROR TransportClient: Failed to send RPC RPC 7276970765548697355 to /192.168.51.65:41190: java.nio.channels.ClosedChannelException
java.nio.channels.ClosedChannelException
	at io.netty.channel.AbstractChannel$AbstractUnsafe.write(...)(Unknown Source)
19/10/03 18:54:14 WARN NettyRpcEnv: Ignored failure: java.util.concurrent.TimeoutException: Cannot receive any reply from null in 120 seconds
19/10/03 18:54:14 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 381 from block manager BlockManagerId(156, 192.168.51.65, 39201, None)
java.io.IOException: Failed to send RPC RPC 7276970765548697355 to /192.168.51.65:41190: java.nio.channels.ClosedChannelException
	at org.apache.spark.network.client.TransportClient$RpcChannelListener.handleFailure(TransportClient.java:362)
	at org.apache.spark.network.client.TransportClient$StdChannelListener.operationComplete(TransportClient.java:339)
	at io.netty.util.concurrent.DefaultPromise.notifyListener0(DefaultPromise.java:507)
	at io.netty.util.concurrent.DefaultPromise.notifyListenersNow(DefaultPromise.java:481)
	at io.netty.util.concurrent.DefaultPromise.notifyListeners(DefaultPromise.java:420)
	at io.netty.util.concurrent.DefaultPromise.tryFailure(DefaultPromise.java:122)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.safeSetFailure(AbstractChannel.java:987)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.write(AbstractChannel.java:869)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.write(DefaultChannelPipeline.java:1316)
	at io.netty.channel.AbstractChannelHandlerContext.invokeWrite0(AbstractChannelHandlerContext.java:738)
	at io.netty.channel.AbstractChannelHandlerContext.invokeWrite(AbstractChannelHandlerContext.java:730)
	at io.netty.channel.AbstractChannelHandlerContext.write(AbstractChannelHandlerContext.java:816)
	at io.netty.channel.AbstractChannelHandlerContext.write(AbstractChannelHandlerContext.java:723)
	at io.netty.channel.AbstractChannelHandlerContext.invokeWrite(AbstractChannelHandlerContext.java:732)
	at io.netty.channel.AbstractChannelHandlerContext.write(AbstractChannelHandlerContext.java:816)
	at io.netty.channel.AbstractChannelHandlerContext.write(AbstractChannelHandlerContext.java:723)
	at io.netty.channel.AbstractChannelHandlerContext.invokeWrite(AbstractChannelHandlerContext.java:732)
	at io.netty.channel.AbstractChannelHandlerContext.access$1900(AbstractChannelHandlerContext.java:38)
	at io.netty.channel.AbstractChannelHandlerContext$AbstractWriteTask.write(AbstractChannelHandlerContext.java:1081)
	at io.netty.channel.AbstractChannelHandlerContext$WriteAndFlushTask.write(AbstractChannelHandlerContext.java:1128)
	at io.netty.channel.AbstractChannelHandlerContext$AbstractWriteTask.run(AbstractChannelHandlerContext.java:1070)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:163)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:403)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:463)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.nio.channels.ClosedChannelException
	at io.netty.channel.AbstractChannel$AbstractUnsafe.write(...)(Unknown Source)
19/10/03 18:54:14 WARN BlockManagerMaster: Failed to remove broadcast 336 with removeFromMaster = true - Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
org.apache.spark.rpc.RpcTimeoutException: Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at scala.util.Failure$$anonfun$recover$1.apply(Try.scala:216)
	at scala.util.Try$.apply(Try.scala:192)
	at scala.util.Failure.recover(Try.scala:216)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at org.spark_project.guava.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:293)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$1.execute(ExecutionContextImpl.scala:136)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.complete(Promise.scala:55)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:157)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.processBatch$1(BatchingExecutor.scala:63)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply$mcV$sp(BatchingExecutor.scala:78)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:72)
	at scala.concurrent.BatchingExecutor$Batch.run(BatchingExecutor.scala:54)
	at scala.concurrent.Future$InternalCallbackExecutor$.unbatchedExecute(Future.scala:601)
	at scala.concurrent.BatchingExecutor$class.execute(BatchingExecutor.scala:106)
	at scala.concurrent.Future$InternalCallbackExecutor$.execute(Future.scala:599)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.tryFailure(Promise.scala:112)
	at scala.concurrent.impl.Promise$DefaultPromise.tryFailure(Promise.scala:157)
	at org.apache.spark.rpc.netty.NettyRpcEnv.org$apache$spark$rpc$netty$NettyRpcEnv$$onFailure$1(NettyRpcEnv.scala:206)
	at org.apache.spark.rpc.netty.NettyRpcEnv$$anon$1.run(NettyRpcEnv.scala:243)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException: Cannot receive any reply from null in 120 seconds
	... 8 more
19/10/03 18:54:24 WARN TaskSetManager: Lost task 68.1 in stage 200.3 (TID 426578, 192.168.5.173, executor 174): FetchFailed(BlockManagerId(162, 192.168.6.223, 39605, None), shuffleId=101, mapId=1306, reduceId=168, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.6.223:39605
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.6.223:39605
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.6.223:39605
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:54:32 WARN TransportResponseHandler: Ignoring response for RPC 5286258953890199610 from /192.168.62.186:56938 (81 bytes) since it is not outstanding
19/10/03 18:54:44 WARN HeartbeatReceiver: Removing executor 128 with no recent heartbeats: 144129 ms exceeds timeout 120000 ms
19/10/03 18:54:44 ERROR TaskSchedulerImpl: Lost executor 128 on 192.168.58.125: Executor heartbeat timed out after 144129 ms
19/10/03 18:54:44 WARN TaskSetManager: Lost task 52.0 in stage 200.3 (TID 426547, 192.168.58.125, executor 128): ExecutorLostFailure (executor 128 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 144129 ms
19/10/03 18:54:44 WARN HeartbeatReceiver: Removing executor 62 with no recent heartbeats: 161380 ms exceeds timeout 120000 ms
19/10/03 18:54:44 ERROR TaskSchedulerImpl: Lost executor 62 on 192.168.4.120: Executor heartbeat timed out after 161380 ms
19/10/03 18:54:44 WARN TaskSetManager: Lost task 19.0 in stage 200.3 (TID 426514, 192.168.4.120, executor 62): ExecutorLostFailure (executor 62 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 161380 ms
19/10/03 18:54:44 WARN HeartbeatReceiver: Removing executor 142 with no recent heartbeats: 125229 ms exceeds timeout 120000 ms
19/10/03 18:54:44 ERROR TaskSchedulerImpl: Lost executor 142 on 192.168.40.224: Executor heartbeat timed out after 125229 ms
19/10/03 18:54:44 WARN TaskSetManager: Lost task 64.0 in stage 200.3 (TID 426559, 192.168.40.224, executor 142): ExecutorLostFailure (executor 142 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 125229 ms
19/10/03 18:54:44 WARN HeartbeatReceiver: Removing executor 97 with no recent heartbeats: 165857 ms exceeds timeout 120000 ms
19/10/03 18:54:44 ERROR TaskSchedulerImpl: Lost executor 97 on 192.168.63.98: Executor heartbeat timed out after 165857 ms
19/10/03 18:54:44 WARN TaskSetManager: Lost task 13.0 in stage 200.3 (TID 426508, 192.168.63.98, executor 97): ExecutorLostFailure (executor 97 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 165857 ms
19/10/03 18:54:44 WARN HeartbeatReceiver: Removing executor 132 with no recent heartbeats: 124622 ms exceeds timeout 120000 ms
19/10/03 18:54:44 ERROR TaskSchedulerImpl: Lost executor 132 on 192.168.47.64: Executor heartbeat timed out after 124622 ms
19/10/03 18:54:44 WARN TaskSetManager: Lost task 6.0 in stage 200.3 (TID 426501, 192.168.47.64, executor 132): ExecutorLostFailure (executor 132 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 124622 ms
19/10/03 18:54:44 WARN HeartbeatReceiver: Removing executor 156 with no recent heartbeats: 177474 ms exceeds timeout 120000 ms
19/10/03 18:54:44 ERROR TaskSchedulerImpl: Lost executor 156 on 192.168.51.65: Executor heartbeat timed out after 177474 ms
19/10/03 18:54:44 WARN TaskSetManager: Lost task 44.0 in stage 200.3 (TID 426539, 192.168.51.65, executor 156): ExecutorLostFailure (executor 156 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 177474 ms
19/10/03 18:54:44 ERROR TaskSchedulerImpl: Lost executor 128 on 192.168.58.125: The executor with id 128 was deleted by a user or the framework.
19/10/03 18:54:44 ERROR TaskSchedulerImpl: Lost an executor 62 (already removed): The executor with id 62 was deleted by a user or the framework.
19/10/03 18:54:44 ERROR TaskSchedulerImpl: Lost executor 142 on 192.168.40.224: The executor with id 142 was deleted by a user or the framework.
19/10/03 18:54:44 ERROR TaskSchedulerImpl: Lost executor 97 on 192.168.63.98: The executor with id 97 was deleted by a user or the framework.
19/10/03 18:54:44 ERROR TaskSchedulerImpl: Lost executor 132 on 192.168.47.64: The executor with id 132 was deleted by a user or the framework.
19/10/03 18:54:44 ERROR TaskSchedulerImpl: Lost an executor 156 (already removed): The executor with id 156 was deleted by a user or the framework.
19/10/03 18:54:44 WARN TaskSetManager: Lost task 81.1 in stage 200.3 (TID 426579, 192.168.13.143, executor 65): FetchFailed(BlockManagerId(162, 192.168.6.223, 39605, None), shuffleId=101, mapId=1306, reduceId=198, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.6.223:39605
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.6.223:39605
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.6.223:39605
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:54:46 WARN TransportChannelHandler: Exception in connection from /192.168.58.125:57634
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:54:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.58.125:57634 is closed
19/10/03 18:54:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 381 from block manager BlockManagerId(128, 192.168.58.125, 38447, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:54:46 WARN TransportChannelHandler: Exception in connection from /192.168.47.64:39020
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:54:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.47.64:39020 is closed
19/10/03 18:54:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 381 from block manager BlockManagerId(132, 192.168.47.64, 36329, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:54:46 WARN TransportChannelHandler: Exception in connection from /192.168.63.98:60306
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:54:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.63.98:60306 is closed
19/10/03 18:54:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 381 from block manager BlockManagerId(97, 192.168.63.98, 46287, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:55:26 WARN TransportChannelHandler: Exception in connection from /192.168.40.224:59778
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:55:26 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.40.224:59778 is closed
19/10/03 18:55:26 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 381 from block manager BlockManagerId(142, 192.168.40.224, 43847, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:55:43 WARN TransportResponseHandler: Ignoring response for RPC 7020890859561459552 from /192.168.10.60:40478 (81 bytes) since it is not outstanding
19/10/03 18:55:44 WARN HeartbeatReceiver: Removing executor 146 with no recent heartbeats: 163878 ms exceeds timeout 120000 ms
19/10/03 18:55:44 ERROR TaskSchedulerImpl: Lost executor 146 on 192.168.4.122: Executor heartbeat timed out after 163878 ms
19/10/03 18:55:44 WARN TaskSetManager: Lost task 38.0 in stage 200.3 (TID 426533, 192.168.4.122, executor 146): ExecutorLostFailure (executor 146 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 163878 ms
19/10/03 18:55:44 WARN HeartbeatReceiver: Removing executor 136 with no recent heartbeats: 123352 ms exceeds timeout 120000 ms
19/10/03 18:55:44 ERROR TaskSchedulerImpl: Lost executor 136 on 192.168.10.60: Executor heartbeat timed out after 123352 ms
19/10/03 18:55:44 WARN TaskSetManager: Lost task 78.0 in stage 200.3 (TID 426573, 192.168.10.60, executor 136): ExecutorLostFailure (executor 136 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 123352 ms
19/10/03 18:55:44 WARN HeartbeatReceiver: Removing executor 150 with no recent heartbeats: 159936 ms exceeds timeout 120000 ms
19/10/03 18:55:44 ERROR TaskSchedulerImpl: Lost executor 150 on 192.168.59.150: Executor heartbeat timed out after 159936 ms
19/10/03 18:55:44 WARN TaskSetManager: Lost task 43.0 in stage 200.3 (TID 426538, 192.168.59.150, executor 150): ExecutorLostFailure (executor 150 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 159936 ms
19/10/03 18:55:44 ERROR TaskSchedulerImpl: Lost executor 146 on 192.168.4.122: The executor with id 146 was deleted by a user or the framework.
19/10/03 18:55:44 ERROR TaskSchedulerImpl: Lost executor 136 on 192.168.10.60: The executor with id 136 was deleted by a user or the framework.
19/10/03 18:55:44 ERROR TaskSchedulerImpl: Lost executor 150 on 192.168.59.150: The executor with id 150 was deleted by a user or the framework.
19/10/03 18:55:46 WARN TransportChannelHandler: Exception in connection from /192.168.10.60:40478
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:55:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.10.60:40478 is closed
19/10/03 18:55:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 381 from block manager BlockManagerId(136, 192.168.10.60, 36947, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:55:46 WARN TransportChannelHandler: Exception in connection from /192.168.4.122:36580
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:55:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.4.122:36580 is closed
19/10/03 18:55:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 381 from block manager BlockManagerId(146, 192.168.4.122, 39193, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:55:59 WARN TransportChannelHandler: Exception in connection from /192.168.59.150:52930
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:55:59 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.59.150:52930 is closed
19/10/03 18:55:59 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 381 from block manager BlockManagerId(150, 192.168.59.150, 43335, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:56:02 WARN TaskSetManager: Lost task 32.1 in stage 200.3 (TID 426583, 192.168.21.49, executor 178): FetchFailed(BlockManagerId(162, 192.168.6.223, 39605, None), shuffleId=101, mapId=1306, reduceId=77, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.6.223:39605
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.6.223:39605
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.6.223:39605
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:56:14 ERROR ContextCleaner: Error cleaning broadcast 381
org.apache.spark.rpc.RpcTimeoutException: Futures timed out after [120 seconds]. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:76)
	at org.apache.spark.storage.BlockManagerMaster.removeBroadcast(BlockManagerMaster.scala:155)
	at org.apache.spark.broadcast.TorrentBroadcast$.unpersist(TorrentBroadcast.scala:321)
	at org.apache.spark.broadcast.TorrentBroadcastFactory.unbroadcast(TorrentBroadcastFactory.scala:45)
	at org.apache.spark.broadcast.BroadcastManager.unbroadcast(BroadcastManager.scala:66)
	at org.apache.spark.ContextCleaner.doCleanupBroadcast(ContextCleaner.scala:238)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:194)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:185)
	at scala.Option.foreach(Option.scala:257)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1.apply$mcV$sp(ContextCleaner.scala:185)
	at org.apache.spark.util.Utils$.tryOrStopSparkContext(Utils.scala:1302)
	at org.apache.spark.ContextCleaner.org$apache$spark$ContextCleaner$$keepCleaning(ContextCleaner.scala:178)
	at org.apache.spark.ContextCleaner$$anon$1.run(ContextCleaner.scala:73)
Caused by: java.util.concurrent.TimeoutException: Futures timed out after [120 seconds]
	at scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:223)
	at scala.concurrent.impl.Promise$DefaultPromise.result(Promise.scala:227)
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:220)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:75)
	... 12 more
19/10/03 18:56:14 WARN BlockManagerMaster: Failed to remove broadcast 381 with removeFromMaster = true - Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
org.apache.spark.rpc.RpcTimeoutException: Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at scala.util.Failure$$anonfun$recover$1.apply(Try.scala:216)
	at scala.util.Try$.apply(Try.scala:192)
	at scala.util.Failure.recover(Try.scala:216)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at org.spark_project.guava.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:293)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$1.execute(ExecutionContextImpl.scala:136)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.complete(Promise.scala:55)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:157)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.processBatch$1(BatchingExecutor.scala:63)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply$mcV$sp(BatchingExecutor.scala:78)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:72)
	at scala.concurrent.BatchingExecutor$Batch.run(BatchingExecutor.scala:54)
	at scala.concurrent.Future$InternalCallbackExecutor$.unbatchedExecute(Future.scala:601)
	at scala.concurrent.BatchingExecutor$class.execute(BatchingExecutor.scala:106)
	at scala.concurrent.Future$InternalCallbackExecutor$.execute(Future.scala:599)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.tryFailure(Promise.scala:112)
	at scala.concurrent.impl.Promise$DefaultPromise.tryFailure(Promise.scala:157)
	at org.apache.spark.rpc.netty.NettyRpcEnv.org$apache$spark$rpc$netty$NettyRpcEnv$$onFailure$1(NettyRpcEnv.scala:206)
	at org.apache.spark.rpc.netty.NettyRpcEnv$$anon$1.run(NettyRpcEnv.scala:243)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException: Cannot receive any reply from null in 120 seconds
	... 8 more
19/10/03 18:56:32 WARN TaskSetManager: Lost task 27.1 in stage 200.3 (TID 426582, 192.168.27.39, executor 123): FetchFailed(BlockManagerId(67, 192.168.23.34, 39131, None), shuffleId=101, mapId=1270, reduceId=69, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.23.34:39131
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.23.34:39131
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.23.34:39131
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 18:56:44 WARN HeartbeatReceiver: Removing executor 41 with no recent heartbeats: 145009 ms exceeds timeout 120000 ms
19/10/03 18:56:44 ERROR TaskSchedulerImpl: Lost executor 41 on 192.168.44.54: Executor heartbeat timed out after 145009 ms
19/10/03 18:56:44 WARN TaskSetManager: Lost task 50.0 in stage 200.3 (TID 426545, 192.168.44.54, executor 41): ExecutorLostFailure (executor 41 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 145009 ms
19/10/03 18:56:44 WARN HeartbeatReceiver: Removing executor 154 with no recent heartbeats: 160028 ms exceeds timeout 120000 ms
19/10/03 18:56:44 ERROR TaskSchedulerImpl: Lost executor 154 on 192.168.34.136: Executor heartbeat timed out after 160028 ms
19/10/03 18:56:44 WARN TaskSetManager: Lost task 37.0 in stage 200.3 (TID 426532, 192.168.34.136, executor 154): ExecutorLostFailure (executor 154 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 160028 ms
19/10/03 18:56:44 ERROR TaskSchedulerImpl: Lost executor 41 on 192.168.44.54: The executor with id 41 was deleted by a user or the framework.
19/10/03 18:56:44 ERROR TaskSchedulerImpl: Lost executor 154 on 192.168.34.136: The executor with id 154 was deleted by a user or the framework.
19/10/03 18:56:46 WARN TransportChannelHandler: Exception in connection from /192.168.44.54:43492
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:56:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.44.54:43492 is closed
19/10/03 18:56:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 386 from block manager BlockManagerId(41, 192.168.44.54, 33901, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:56:46 WARN TransportChannelHandler: Exception in connection from /192.168.34.136:39210
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:56:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.34.136:39210 is closed
19/10/03 18:56:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 386 from block manager BlockManagerId(154, 192.168.34.136, 40869, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 18:57:00 WARN TransportResponseHandler: Ignoring response for RPC 5423083157639424253 from /192.168.62.186:56938 (81 bytes) since it is not outstanding
19/10/03 18:58:14 ERROR ContextCleaner: Error cleaning broadcast 386
org.apache.spark.rpc.RpcTimeoutException: Futures timed out after [120 seconds]. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:76)
	at org.apache.spark.storage.BlockManagerMaster.removeBroadcast(BlockManagerMaster.scala:155)
	at org.apache.spark.broadcast.TorrentBroadcast$.unpersist(TorrentBroadcast.scala:321)
	at org.apache.spark.broadcast.TorrentBroadcastFactory.unbroadcast(TorrentBroadcastFactory.scala:45)
	at org.apache.spark.broadcast.BroadcastManager.unbroadcast(BroadcastManager.scala:66)
	at org.apache.spark.ContextCleaner.doCleanupBroadcast(ContextCleaner.scala:238)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:194)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:185)
	at scala.Option.foreach(Option.scala:257)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1.apply$mcV$sp(ContextCleaner.scala:185)
	at org.apache.spark.util.Utils$.tryOrStopSparkContext(Utils.scala:1302)
	at org.apache.spark.ContextCleaner.org$apache$spark$ContextCleaner$$keepCleaning(ContextCleaner.scala:178)
	at org.apache.spark.ContextCleaner$$anon$1.run(ContextCleaner.scala:73)
Caused by: java.util.concurrent.TimeoutException: Futures timed out after [120 seconds]
	at scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:223)
	at scala.concurrent.impl.Promise$DefaultPromise.result(Promise.scala:227)
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:220)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:75)
	... 12 more
19/10/03 18:58:14 WARN BlockManagerMaster: Failed to remove broadcast 386 with removeFromMaster = true - Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
org.apache.spark.rpc.RpcTimeoutException: Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at scala.util.Failure$$anonfun$recover$1.apply(Try.scala:216)
	at scala.util.Try$.apply(Try.scala:192)
	at scala.util.Failure.recover(Try.scala:216)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at org.spark_project.guava.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:293)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$1.execute(ExecutionContextImpl.scala:136)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.complete(Promise.scala:55)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:157)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.processBatch$1(BatchingExecutor.scala:63)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply$mcV$sp(BatchingExecutor.scala:78)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:72)
	at scala.concurrent.BatchingExecutor$Batch.run(BatchingExecutor.scala:54)
	at scala.concurrent.Future$InternalCallbackExecutor$.unbatchedExecute(Future.scala:601)
	at scala.concurrent.BatchingExecutor$class.execute(BatchingExecutor.scala:106)
	at scala.concurrent.Future$InternalCallbackExecutor$.execute(Future.scala:599)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.tryFailure(Promise.scala:112)
	at scala.concurrent.impl.Promise$DefaultPromise.tryFailure(Promise.scala:157)
	at org.apache.spark.rpc.netty.NettyRpcEnv.org$apache$spark$rpc$netty$NettyRpcEnv$$onFailure$1(NettyRpcEnv.scala:206)
	at org.apache.spark.rpc.netty.NettyRpcEnv$$anon$1.run(NettyRpcEnv.scala:243)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException: Cannot receive any reply from null in 120 seconds
	... 8 more
19/10/03 18:58:19 WARN TransportResponseHandler: Ignoring response for RPC 6386077115559413389 from /192.168.62.186:56938 (81 bytes) since it is not outstanding
19/10/03 18:58:31 WARN TransportResponseHandler: Ignoring response for RPC 7856498854739770846 from /192.168.61.229:49748 (81 bytes) since it is not outstanding
19/10/03 19:00:14 ERROR ContextCleaner: Error cleaning broadcast 415
org.apache.spark.rpc.RpcTimeoutException: Futures timed out after [120 seconds]. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:76)
	at org.apache.spark.storage.BlockManagerMaster.removeBroadcast(BlockManagerMaster.scala:155)
	at org.apache.spark.broadcast.TorrentBroadcast$.unpersist(TorrentBroadcast.scala:321)
	at org.apache.spark.broadcast.TorrentBroadcastFactory.unbroadcast(TorrentBroadcastFactory.scala:45)
	at org.apache.spark.broadcast.BroadcastManager.unbroadcast(BroadcastManager.scala:66)
	at org.apache.spark.ContextCleaner.doCleanupBroadcast(ContextCleaner.scala:238)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:194)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:185)
	at scala.Option.foreach(Option.scala:257)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1.apply$mcV$sp(ContextCleaner.scala:185)
	at org.apache.spark.util.Utils$.tryOrStopSparkContext(Utils.scala:1302)
	at org.apache.spark.ContextCleaner.org$apache$spark$ContextCleaner$$keepCleaning(ContextCleaner.scala:178)
	at org.apache.spark.ContextCleaner$$anon$1.run(ContextCleaner.scala:73)
Caused by: java.util.concurrent.TimeoutException: Futures timed out after [120 seconds]
	at scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:223)
	at scala.concurrent.impl.Promise$DefaultPromise.result(Promise.scala:227)
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:220)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:75)
	... 12 more
19/10/03 19:00:14 WARN BlockManagerMaster: Failed to remove broadcast 415 with removeFromMaster = true - Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
org.apache.spark.rpc.RpcTimeoutException: Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at scala.util.Failure$$anonfun$recover$1.apply(Try.scala:216)
	at scala.util.Try$.apply(Try.scala:192)
	at scala.util.Failure.recover(Try.scala:216)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at org.spark_project.guava.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:293)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$1.execute(ExecutionContextImpl.scala:136)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.complete(Promise.scala:55)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:157)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.processBatch$1(BatchingExecutor.scala:63)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply$mcV$sp(BatchingExecutor.scala:78)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:72)
	at scala.concurrent.BatchingExecutor$Batch.run(BatchingExecutor.scala:54)
	at scala.concurrent.Future$InternalCallbackExecutor$.unbatchedExecute(Future.scala:601)
	at scala.concurrent.BatchingExecutor$class.execute(BatchingExecutor.scala:106)
	at scala.concurrent.Future$InternalCallbackExecutor$.execute(Future.scala:599)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.tryFailure(Promise.scala:112)
	at scala.concurrent.impl.Promise$DefaultPromise.tryFailure(Promise.scala:157)
	at org.apache.spark.rpc.netty.NettyRpcEnv.org$apache$spark$rpc$netty$NettyRpcEnv$$onFailure$1(NettyRpcEnv.scala:206)
	at org.apache.spark.rpc.netty.NettyRpcEnv$$anon$1.run(NettyRpcEnv.scala:243)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException: Cannot receive any reply from null in 120 seconds
	... 8 more
19/10/03 19:00:44 WARN HeartbeatReceiver: Removing executor 145 with no recent heartbeats: 132364 ms exceeds timeout 120000 ms
19/10/03 19:00:44 ERROR TaskSchedulerImpl: Lost executor 145 on 192.168.61.229: Executor heartbeat timed out after 132364 ms
19/10/03 19:00:44 WARN TaskSetManager: Lost task 48.0 in stage 200.3 (TID 426543, 192.168.61.229, executor 145): ExecutorLostFailure (executor 145 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 132364 ms
19/10/03 19:00:44 ERROR TaskSchedulerImpl: Lost executor 145 on 192.168.61.229: The executor with id 145 was deleted by a user or the framework.
19/10/03 19:00:50 WARN TransportChannelHandler: Exception in connection from /192.168.61.229:49748
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:00:50 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.61.229:49748 is closed
19/10/03 19:00:50 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 384 from block manager BlockManagerId(145, 192.168.61.229, 44775, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:01:44 WARN HeartbeatReceiver: Removing executor 60 with no recent heartbeats: 128427 ms exceeds timeout 120000 ms
19/10/03 19:01:44 ERROR TaskSchedulerImpl: Lost executor 60 on 192.168.62.186: Executor heartbeat timed out after 128427 ms
19/10/03 19:01:44 WARN TaskSetManager: Lost task 60.0 in stage 200.3 (TID 426555, 192.168.62.186, executor 60): ExecutorLostFailure (executor 60 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 128427 ms
19/10/03 19:01:44 ERROR TaskSchedulerImpl: Lost executor 60 on 192.168.62.186: The executor with id 60 was deleted by a user or the framework.
19/10/03 19:01:46 WARN TransportChannelHandler: Exception in connection from /192.168.62.186:56938
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:01:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.62.186:56938 is closed
19/10/03 19:01:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 384 from block manager BlockManagerId(60, 192.168.62.186, 44215, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:13:44 WARN HeartbeatReceiver: Removing executor 113 with no recent heartbeats: 158131 ms exceeds timeout 120000 ms
19/10/03 19:13:44 ERROR TaskSchedulerImpl: Lost executor 113 on 192.168.51.45: Executor heartbeat timed out after 158131 ms
19/10/03 19:13:44 WARN TaskSetManager: Lost task 121.0 in stage 225.0 (TID 488872, 192.168.51.45, executor 113): ExecutorLostFailure (executor 113 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 158131 ms
19/10/03 19:13:44 ERROR TaskSchedulerImpl: Lost executor 113 on 192.168.51.45: The executor with id 113 was deleted by a user or the framework.
19/10/03 19:13:46 WARN TransportChannelHandler: Exception in connection from /192.168.51.45:40442
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:14:08 WARN TaskSetManager: Lost task 123.0 in stage 225.0 (TID 488874, 192.168.39.158, executor 181): FetchFailed(BlockManagerId(113, 192.168.51.45, 38175, None), shuffleId=110, mapId=89, reduceId=123, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.51.45:38175
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.51.45:38175
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.51.45:38175
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:14:11 WARN TaskSetManager: Lost task 36.1 in stage 225.0 (TID 492836, 192.168.50.0, executor 100): FetchFailed(BlockManagerId(113, 192.168.51.45, 38175, None), shuffleId=111, mapId=1283, reduceId=36, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.51.45:38175
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.51.45:38175
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.51.45:38175
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:14:20 WARN TaskSetManager: Lost task 121.1 in stage 225.0 (TID 492835, 192.168.20.42, executor 111): FetchFailed(BlockManagerId(113, 192.168.51.45, 38175, None), shuffleId=111, mapId=1283, reduceId=121, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.51.45:38175
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.51.45:38175
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.51.45:38175
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:14:44 WARN HeartbeatReceiver: Removing executor 149 with no recent heartbeats: 138339 ms exceeds timeout 120000 ms
19/10/03 19:14:44 ERROR TaskSchedulerImpl: Lost executor 149 on 192.168.5.155: Executor heartbeat timed out after 138339 ms
19/10/03 19:14:44 WARN TaskSetManager: Lost task 21.0 in stage 225.0 (TID 488772, 192.168.5.155, executor 149): ExecutorLostFailure (executor 149 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 138339 ms
19/10/03 19:14:44 WARN HeartbeatReceiver: Removing executor 161 with no recent heartbeats: 151816 ms exceeds timeout 120000 ms
19/10/03 19:14:44 ERROR TaskSchedulerImpl: Lost executor 161 on 192.168.31.174: Executor heartbeat timed out after 151816 ms
19/10/03 19:14:44 WARN TaskSetManager: Lost task 168.0 in stage 225.0 (TID 488919, 192.168.31.174, executor 161): ExecutorLostFailure (executor 161 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 151816 ms
19/10/03 19:14:44 WARN HeartbeatReceiver: Removing executor 140 with no recent heartbeats: 138898 ms exceeds timeout 120000 ms
19/10/03 19:14:44 ERROR TaskSchedulerImpl: Lost executor 140 on 192.168.45.64: Executor heartbeat timed out after 138898 ms
19/10/03 19:14:44 WARN TaskSetManager: Lost task 44.0 in stage 225.0 (TID 488795, 192.168.45.64, executor 140): ExecutorLostFailure (executor 140 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 138898 ms
19/10/03 19:14:44 WARN HeartbeatReceiver: Removing executor 115 with no recent heartbeats: 166711 ms exceeds timeout 120000 ms
19/10/03 19:14:44 ERROR TaskSchedulerImpl: Lost executor 115 on 192.168.46.195: Executor heartbeat timed out after 166711 ms
19/10/03 19:14:44 WARN TaskSetManager: Lost task 12.0 in stage 225.0 (TID 488763, 192.168.46.195, executor 115): ExecutorLostFailure (executor 115 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 166711 ms
19/10/03 19:14:44 WARN HeartbeatReceiver: Removing executor 109 with no recent heartbeats: 129982 ms exceeds timeout 120000 ms
19/10/03 19:14:44 ERROR TaskSchedulerImpl: Lost executor 109 on 192.168.22.0: Executor heartbeat timed out after 129982 ms
19/10/03 19:14:44 WARN TaskSetManager: Lost task 76.0 in stage 225.0 (TID 488827, 192.168.22.0, executor 109): ExecutorLostFailure (executor 109 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 129982 ms
19/10/03 19:14:44 WARN HeartbeatReceiver: Removing executor 168 with no recent heartbeats: 165352 ms exceeds timeout 120000 ms
19/10/03 19:14:44 ERROR TaskSchedulerImpl: Lost executor 168 on 192.168.59.172: Executor heartbeat timed out after 165352 ms
19/10/03 19:14:44 WARN TaskSetManager: Lost task 19.0 in stage 225.0 (TID 488770, 192.168.59.172, executor 168): ExecutorLostFailure (executor 168 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 165352 ms
19/10/03 19:14:44 WARN HeartbeatReceiver: Removing executor 207 with no recent heartbeats: 177539 ms exceeds timeout 120000 ms
19/10/03 19:14:44 ERROR TaskSchedulerImpl: Lost executor 207 on 192.168.57.158: Executor heartbeat timed out after 177539 ms
19/10/03 19:14:44 WARN TaskSetManager: Lost task 115.0 in stage 225.0 (TID 488866, 192.168.57.158, executor 207): ExecutorLostFailure (executor 207 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 177539 ms
19/10/03 19:14:44 WARN HeartbeatReceiver: Removing executor 75 with no recent heartbeats: 135396 ms exceeds timeout 120000 ms
19/10/03 19:14:44 ERROR TaskSchedulerImpl: Lost executor 75 on 192.168.13.110: Executor heartbeat timed out after 135396 ms
19/10/03 19:14:44 WARN TaskSetManager: Lost task 151.0 in stage 225.0 (TID 488902, 192.168.13.110, executor 75): ExecutorLostFailure (executor 75 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 135396 ms
19/10/03 19:14:44 ERROR TaskSchedulerImpl: Lost executor 149 on 192.168.5.155: The executor with id 149 was deleted by a user or the framework.
19/10/03 19:14:44 ERROR TaskSchedulerImpl: Lost executor 161 on 192.168.31.174: The executor with id 161 was deleted by a user or the framework.
19/10/03 19:14:44 ERROR TaskSchedulerImpl: Lost executor 140 on 192.168.45.64: The executor with id 140 was deleted by a user or the framework.
19/10/03 19:14:44 ERROR TaskSchedulerImpl: Lost executor 115 on 192.168.46.195: The executor with id 115 was deleted by a user or the framework.
19/10/03 19:14:44 ERROR TaskSchedulerImpl: Lost executor 109 on 192.168.22.0: The executor with id 109 was deleted by a user or the framework.
19/10/03 19:14:44 ERROR TaskSchedulerImpl: Lost executor 168 on 192.168.59.172: The executor with id 168 was deleted by a user or the framework.
19/10/03 19:14:44 ERROR TaskSchedulerImpl: Lost executor 207 on 192.168.57.158: The executor with id 207 was deleted by a user or the framework.
19/10/03 19:14:44 ERROR TaskSchedulerImpl: Lost executor 75 on 192.168.13.110: The executor with id 75 was deleted by a user or the framework.
19/10/03 19:14:46 WARN TransportChannelHandler: Exception in connection from /192.168.31.174:54934
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:14:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.31.174:54934 is closed
19/10/03 19:14:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 421 from block manager BlockManagerId(161, 192.168.31.174, 43917, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:14:46 WARN TransportChannelHandler: Exception in connection from /192.168.57.158:34222
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:14:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.57.158:34222 is closed
19/10/03 19:14:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 421 from block manager BlockManagerId(207, 192.168.57.158, 38309, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:14:47 WARN TransportChannelHandler: Exception in connection from /192.168.59.172:33458
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:14:47 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.59.172:33458 is closed
19/10/03 19:14:47 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 421 from block manager BlockManagerId(168, 192.168.59.172, 36863, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:14:47 WARN TransportChannelHandler: Exception in connection from /192.168.46.195:51076
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:14:47 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.46.195:51076 is closed
19/10/03 19:14:47 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 421 from block manager BlockManagerId(115, 192.168.46.195, 32893, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:14:52 WARN TransportChannelHandler: Exception in connection from /192.168.45.64:37006
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:14:52 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.45.64:37006 is closed
19/10/03 19:14:52 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 421 from block manager BlockManagerId(140, 192.168.45.64, 39799, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:14:52 WARN TransportChannelHandler: Exception in connection from /192.168.5.155:40408
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:14:52 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.5.155:40408 is closed
19/10/03 19:14:52 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 421 from block manager BlockManagerId(149, 192.168.5.155, 34369, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:14:54 WARN TransportChannelHandler: Exception in connection from /192.168.22.0:57732
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:14:54 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.22.0:57732 is closed
19/10/03 19:14:54 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 421 from block manager BlockManagerId(109, 192.168.22.0, 41557, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:15:03 WARN TaskSetManager: Lost task 30.0 in stage 225.1 (TID 493058, 192.168.2.28, executor 199): FetchFailed(BlockManagerId(161, 192.168.31.174, 43917, None), shuffleId=111, mapId=1199, reduceId=175, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.31.174:43917
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.31.174:43917
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.31.174:43917
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:05 WARN TaskSetManager: Lost task 2.0 in stage 225.1 (TID 493030, 192.168.52.135, executor 203): FetchFailed(BlockManagerId(161, 192.168.31.174, 43917, None), shuffleId=111, mapId=1199, reduceId=21, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.31.174:43917
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.31.174:43917
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.31.174:43917
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:05 WARN TaskSetManager: Lost task 9.0 in stage 225.1 (TID 493037, 192.168.31.39, executor 104): FetchFailed(BlockManagerId(161, 192.168.31.174, 43917, None), shuffleId=111, mapId=1199, reduceId=69, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.31.174:43917
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.31.174:43917
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.31.174:43917
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:07 WARN TaskSetManager: Lost task 12.0 in stage 225.1 (TID 493040, 192.168.20.246, executor 13): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=77, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:07 WARN TaskSetManager: Lost task 27.0 in stage 225.1 (TID 493055, 192.168.47.99, executor 202): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=151, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:07 WARN TaskSetManager: Lost task 8.0 in stage 225.1 (TID 493036, 192.168.17.66, executor 201): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=63, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:07 WARN TaskSetManager: Lost task 11.0 in stage 225.1 (TID 493039, 192.168.26.53, executor 198): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=76, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:07 WARN TaskSetManager: Lost task 32.0 in stage 225.1 (TID 493060, 192.168.30.63, executor 196): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=186, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:07 WARN TaskSetManager: Lost task 0.0 in stage 225.1 (TID 493028, 192.168.34.41, executor 179): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=12, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:07 WARN TaskSetManager: Lost task 4.0 in stage 225.1 (TID 493032, 192.168.60.221, executor 121): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=36, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:07 WARN TaskSetManager: Lost task 26.0 in stage 225.1 (TID 493054, 192.168.5.173, executor 174): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=150, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:07 WARN TaskSetManager: Lost task 23.0 in stage 225.1 (TID 493051, 192.168.6.128, executor 98): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=127, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:07 WARN TaskSetManager: Lost task 10.0 in stage 225.1 (TID 493038, 192.168.56.65, executor 188): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=74, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:07 WARN TaskSetManager: Lost task 20.0 in stage 225.1 (TID 493048, 192.168.6.209, executor 208): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=120, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:07 WARN TaskSetManager: Lost task 18.0 in stage 225.1 (TID 493046, 192.168.23.34, executor 192): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=115, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:07 WARN TaskSetManager: Lost task 15.0 in stage 225.1 (TID 493043, 192.168.49.103, executor 81): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=89, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:07 WARN TaskSetManager: Lost task 5.0 in stage 225.1 (TID 493033, 192.168.62.147, executor 212): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=38, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:07 WARN TaskSetManager: Lost task 14.0 in stage 225.1 (TID 493042, 192.168.46.113, executor 95): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=83, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:10 WARN TaskSetManager: Lost task 6.0 in stage 225.1 (TID 493034, 192.168.21.49, executor 178): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=44, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:10 WARN TaskSetManager: Lost task 33.0 in stage 225.1 (TID 493061, 192.168.20.146, executor 129): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=192, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:10 WARN TaskSetManager: Lost task 35.0 in stage 225.1 (TID 493063, 192.168.8.148, executor 163): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=198, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:11 WARN TaskSetManager: Lost task 17.0 in stage 225.1 (TID 493045, 192.168.48.110, executor 175): FetchFailed(BlockManagerId(149, 192.168.5.155, 34369, None), shuffleId=111, mapId=1210, reduceId=92, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.5.155:34369
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.5.155:34369
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.5.155:34369
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:11 WARN TaskSetManager: Lost task 31.0 in stage 225.1 (TID 493059, 192.168.60.160, executor 105): FetchFailed(BlockManagerId(109, 192.168.22.0, 41557, None), shuffleId=111, mapId=1201, reduceId=178, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.22.0:41557
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.22.0:41557
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.22.0:41557
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:11 WARN TaskSetManager: Lost task 28.0 in stage 225.1 (TID 493056, 192.168.35.253, executor 195): FetchFailed(BlockManagerId(109, 192.168.22.0, 41557, None), shuffleId=111, mapId=1201, reduceId=157, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.22.0:41557
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.22.0:41557
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.22.0:41557
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:11 WARN TaskSetManager: Lost task 3.0 in stage 225.1 (TID 493031, 192.168.63.143, executor 204): FetchFailed(BlockManagerId(109, 192.168.22.0, 41557, None), shuffleId=111, mapId=1201, reduceId=24, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.22.0:41557
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.22.0:41557
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.22.0:41557
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:11 WARN TaskSetManager: Lost task 7.0 in stage 225.1 (TID 493035, 192.168.17.222, executor 106): FetchFailed(BlockManagerId(161, 192.168.31.174, 43917, None), shuffleId=111, mapId=1199, reduceId=47, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.31.174:43917
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.31.174:43917
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.31.174:43917
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:11 WARN TaskSetManager: Lost task 34.0 in stage 225.1 (TID 493062, 192.168.51.74, executor 158): FetchFailed(BlockManagerId(161, 192.168.31.174, 43917, None), shuffleId=111, mapId=1199, reduceId=193, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.31.174:43917
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.31.174:43917
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.31.174:43917
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:12 WARN TaskSetManager: Lost task 21.0 in stage 225.1 (TID 493049, 192.168.21.143, executor 47): FetchFailed(BlockManagerId(140, 192.168.45.64, 39799, None), shuffleId=111, mapId=1215, reduceId=121, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.45.64:39799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.45.64:39799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.45.64:39799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:14 WARN TaskSetManager: Lost task 16.0 in stage 225.1 (TID 493044, 192.168.24.230, executor 186): FetchFailed(BlockManagerId(149, 192.168.5.155, 34369, None), shuffleId=111, mapId=1210, reduceId=90, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.5.155:34369
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.5.155:34369
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.5.155:34369
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:17 WARN TaskSetManager: Lost task 22.0 in stage 225.1 (TID 493050, 192.168.31.107, executor 189): FetchFailed(BlockManagerId(149, 192.168.5.155, 34369, None), shuffleId=111, mapId=1210, reduceId=123, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.5.155:34369
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.5.155:34369
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.5.155:34369
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:15:21 WARN TransportChannelHandler: Exception in connection from /192.168.13.110:52196
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:15:21 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.13.110:52196 is closed
19/10/03 19:15:21 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 421 from block manager BlockManagerId(75, 192.168.13.110, 36017, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:15:44 WARN HeartbeatReceiver: Removing executor 187 with no recent heartbeats: 167444 ms exceeds timeout 120000 ms
19/10/03 19:15:44 ERROR TaskSchedulerImpl: Lost executor 187 on 192.168.18.168: Executor heartbeat timed out after 167444 ms
19/10/03 19:15:44 WARN TaskSetManager: Lost task 74.0 in stage 225.0 (TID 488825, 192.168.18.168, executor 187): ExecutorLostFailure (executor 187 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 167444 ms
19/10/03 19:15:44 WARN HeartbeatReceiver: Removing executor 211 with no recent heartbeats: 170482 ms exceeds timeout 120000 ms
19/10/03 19:15:44 ERROR TaskSchedulerImpl: Lost executor 211 on 192.168.39.159: Executor heartbeat timed out after 170482 ms
19/10/03 19:15:44 WARN TaskSetManager: Lost task 92.0 in stage 225.0 (TID 488843, 192.168.39.159, executor 211): ExecutorLostFailure (executor 211 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 170482 ms
19/10/03 19:15:44 WARN HeartbeatReceiver: Removing executor 205 with no recent heartbeats: 161792 ms exceeds timeout 120000 ms
19/10/03 19:15:44 ERROR TaskSchedulerImpl: Lost executor 205 on 192.168.39.5: Executor heartbeat timed out after 161792 ms
19/10/03 19:15:44 WARN TaskSetManager: Lost task 89.0 in stage 225.0 (TID 488840, 192.168.39.5, executor 205): ExecutorLostFailure (executor 205 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 161792 ms
19/10/03 19:15:44 WARN HeartbeatReceiver: Removing executor 165 with no recent heartbeats: 151246 ms exceeds timeout 120000 ms
19/10/03 19:15:44 ERROR TaskSchedulerImpl: Lost executor 165 on 192.168.28.108: Executor heartbeat timed out after 151246 ms
19/10/03 19:15:44 WARN TaskSetManager: Lost task 38.0 in stage 225.0 (TID 488789, 192.168.28.108, executor 165): ExecutorLostFailure (executor 165 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 151246 ms
19/10/03 19:15:44 ERROR TaskSchedulerImpl: Lost executor 187 on 192.168.18.168: The executor with id 187 was deleted by a user or the framework.
19/10/03 19:15:44 ERROR TaskSchedulerImpl: Lost executor 211 on 192.168.39.159: The executor with id 211 was deleted by a user or the framework.
19/10/03 19:15:44 ERROR TaskSchedulerImpl: Lost executor 205 on 192.168.39.5: The executor with id 205 was deleted by a user or the framework.
19/10/03 19:15:44 ERROR TaskSchedulerImpl: Lost executor 165 on 192.168.28.108: The executor with id 165 was deleted by a user or the framework.
19/10/03 19:15:46 WARN TransportChannelHandler: Exception in connection from /192.168.18.168:54816
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:15:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.18.168:54816 is closed
19/10/03 19:15:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 421 from block manager BlockManagerId(187, 192.168.18.168, 46391, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:15:46 WARN TransportChannelHandler: Exception in connection from /192.168.39.159:37830
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:15:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.39.159:37830 is closed
19/10/03 19:15:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 421 from block manager BlockManagerId(211, 192.168.39.159, 37959, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:15:46 WARN TransportChannelHandler: Exception in connection from /192.168.28.108:32916
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:15:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.28.108:32916 is closed
19/10/03 19:15:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 421 from block manager BlockManagerId(165, 192.168.28.108, 46811, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:15:47 WARN TransportChannelHandler: Exception in connection from /192.168.39.5:34036
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:15:47 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.39.5:34036 is closed
19/10/03 19:15:47 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 421 from block manager BlockManagerId(205, 192.168.39.5, 40753, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:16:08 WARN TaskSetManager: Lost task 193.0 in stage 225.0 (TID 488944, 192.168.62.157, executor 190): FetchFailed(BlockManagerId(165, 192.168.28.108, 46811, None), shuffleId=110, mapId=7887, reduceId=193, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.28.108:46811
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.28.108:46811
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.28.108:46811
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:16:31 ERROR ContextCleaner: Error cleaning broadcast 421
org.apache.spark.rpc.RpcTimeoutException: Futures timed out after [120 seconds]. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:76)
	at org.apache.spark.storage.BlockManagerMaster.removeBroadcast(BlockManagerMaster.scala:155)
	at org.apache.spark.broadcast.TorrentBroadcast$.unpersist(TorrentBroadcast.scala:321)
	at org.apache.spark.broadcast.TorrentBroadcastFactory.unbroadcast(TorrentBroadcastFactory.scala:45)
	at org.apache.spark.broadcast.BroadcastManager.unbroadcast(BroadcastManager.scala:66)
	at org.apache.spark.ContextCleaner.doCleanupBroadcast(ContextCleaner.scala:238)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:194)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:185)
	at scala.Option.foreach(Option.scala:257)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1.apply$mcV$sp(ContextCleaner.scala:185)
	at org.apache.spark.util.Utils$.tryOrStopSparkContext(Utils.scala:1302)
	at org.apache.spark.ContextCleaner.org$apache$spark$ContextCleaner$$keepCleaning(ContextCleaner.scala:178)
	at org.apache.spark.ContextCleaner$$anon$1.run(ContextCleaner.scala:73)
Caused by: java.util.concurrent.TimeoutException: Futures timed out after [120 seconds]
	at scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:223)
	at scala.concurrent.impl.Promise$DefaultPromise.result(Promise.scala:227)
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:220)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:75)
	... 12 more
19/10/03 19:16:31 WARN BlockManagerMaster: Failed to remove broadcast 421 with removeFromMaster = true - Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
org.apache.spark.rpc.RpcTimeoutException: Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at scala.util.Failure$$anonfun$recover$1.apply(Try.scala:216)
	at scala.util.Try$.apply(Try.scala:192)
	at scala.util.Failure.recover(Try.scala:216)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at org.spark_project.guava.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:293)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$1.execute(ExecutionContextImpl.scala:136)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.complete(Promise.scala:55)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:157)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.processBatch$1(BatchingExecutor.scala:63)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply$mcV$sp(BatchingExecutor.scala:78)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:72)
	at scala.concurrent.BatchingExecutor$Batch.run(BatchingExecutor.scala:54)
	at scala.concurrent.Future$InternalCallbackExecutor$.unbatchedExecute(Future.scala:601)
	at scala.concurrent.BatchingExecutor$class.execute(BatchingExecutor.scala:106)
	at scala.concurrent.Future$InternalCallbackExecutor$.execute(Future.scala:599)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.tryFailure(Promise.scala:112)
	at scala.concurrent.impl.Promise$DefaultPromise.tryFailure(Promise.scala:157)
	at org.apache.spark.rpc.netty.NettyRpcEnv.org$apache$spark$rpc$netty$NettyRpcEnv$$onFailure$1(NettyRpcEnv.scala:206)
	at org.apache.spark.rpc.netty.NettyRpcEnv$$anon$1.run(NettyRpcEnv.scala:243)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException: Cannot receive any reply from null in 120 seconds
	... 8 more
19/10/03 19:16:44 WARN HeartbeatReceiver: Removing executor 45 with no recent heartbeats: 136746 ms exceeds timeout 120000 ms
19/10/03 19:16:44 ERROR TaskSchedulerImpl: Lost executor 45 on 192.168.14.170: Executor heartbeat timed out after 136746 ms
19/10/03 19:16:44 WARN TaskSetManager: Lost task 47.0 in stage 225.0 (TID 488798, 192.168.14.170, executor 45): ExecutorLostFailure (executor 45 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 136746 ms
19/10/03 19:16:44 WARN HeartbeatReceiver: Removing executor 182 with no recent heartbeats: 149201 ms exceeds timeout 120000 ms
19/10/03 19:16:44 ERROR TaskSchedulerImpl: Lost executor 182 on 192.168.7.211: Executor heartbeat timed out after 149201 ms
19/10/03 19:16:44 WARN TaskSetManager: Lost task 69.0 in stage 225.0 (TID 488820, 192.168.7.211, executor 182): ExecutorLostFailure (executor 182 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 149201 ms
19/10/03 19:16:44 WARN HeartbeatReceiver: Removing executor 116 with no recent heartbeats: 177657 ms exceeds timeout 120000 ms
19/10/03 19:16:44 ERROR TaskSchedulerImpl: Lost executor 116 on 192.168.63.116: Executor heartbeat timed out after 177657 ms
19/10/03 19:16:44 WARN TaskSetManager: Lost task 157.0 in stage 225.0 (TID 488908, 192.168.63.116, executor 116): ExecutorLostFailure (executor 116 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 177657 ms
19/10/03 19:16:44 ERROR TaskSchedulerImpl: Lost executor 45 on 192.168.14.170: The executor with id 45 was deleted by a user or the framework.
19/10/03 19:16:44 ERROR TaskSchedulerImpl: Lost executor 182 on 192.168.7.211: The executor with id 182 was deleted by a user or the framework.
19/10/03 19:16:44 ERROR TaskSchedulerImpl: Lost executor 116 on 192.168.63.116: The executor with id 116 was deleted by a user or the framework.
19/10/03 19:16:46 WARN TransportChannelHandler: Exception in connection from /192.168.14.170:53968
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:16:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.14.170:53968 is closed
19/10/03 19:16:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 420 from block manager BlockManagerId(45, 192.168.14.170, 34929, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:16:46 WARN TransportChannelHandler: Exception in connection from /192.168.7.211:47236
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:16:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.7.211:47236 is closed
19/10/03 19:16:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 420 from block manager BlockManagerId(182, 192.168.7.211, 38301, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:16:46 WARN TransportChannelHandler: Exception in connection from /192.168.63.116:44480
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:16:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.63.116:44480 is closed
19/10/03 19:16:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 420 from block manager BlockManagerId(116, 192.168.63.116, 34227, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:16:49 WARN TaskSetManager: Lost task 25.0 in stage 225.1 (TID 493053, 192.168.6.25, executor 112): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=134, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:16:51 WARN TaskSetManager: Lost task 24.0 in stage 225.1 (TID 493052, 192.168.11.32, executor 180): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=131, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:16:52 WARN TaskSetManager: Lost task 198.0 in stage 225.0 (TID 488949, 192.168.46.70, executor 12): FetchFailed(BlockManagerId(168, 192.168.59.172, 36863, None), shuffleId=110, mapId=46, reduceId=198, message=
org.apache.spark.shuffle.FetchFailedException: Connecting to /192.168.59.172:36863 timed out (120000 ms)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Connecting to /192.168.59.172:36863 timed out (120000 ms)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:243)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more

)
19/10/03 19:16:52 WARN TaskSetManager: Lost task 127.0 in stage 225.0 (TID 488878, 192.168.57.207, executor 84): FetchFailed(BlockManagerId(168, 192.168.59.172, 36863, None), shuffleId=110, mapId=46, reduceId=127, message=
org.apache.spark.shuffle.FetchFailedException: Connecting to /192.168.59.172:36863 timed out (120000 ms)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Connecting to /192.168.59.172:36863 timed out (120000 ms)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:243)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more

)
19/10/03 19:16:55 WARN TaskSetManager: Lost task 13.0 in stage 225.1 (TID 493041, 192.168.28.8, executor 176): FetchFailed(BlockManagerId(109, 192.168.22.0, 41557, None), shuffleId=111, mapId=1201, reduceId=82, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.22.0:41557
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.22.0:41557
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.22.0:41557
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:16:57 WARN TaskSetManager: Lost task 1.0 in stage 225.1 (TID 493029, 192.168.54.141, executor 53): FetchFailed(BlockManagerId(115, 192.168.46.195, 32893, None), shuffleId=111, mapId=1232, reduceId=19, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.46.195:32893
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.46.195:32893
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:17:02 WARN TaskSetManager: Lost task 29.0 in stage 225.1 (TID 493057, 192.168.52.26, executor 70): FetchFailed(BlockManagerId(109, 192.168.22.0, 41557, None), shuffleId=111, mapId=1201, reduceId=168, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.22.0:41557
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.22.0:41557
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.22.0:41557
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:17:02 WARN TaskSetManager: Lost task 19.0 in stage 225.1 (TID 493047, 192.168.38.97, executor 210): FetchFailed(BlockManagerId(109, 192.168.22.0, 41557, None), shuffleId=111, mapId=1201, reduceId=116, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.22.0:41557
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.22.0:41557
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.22.0:41557
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:17:44 WARN HeartbeatReceiver: Removing executor 194 with no recent heartbeats: 169968 ms exceeds timeout 120000 ms
19/10/03 19:17:44 ERROR TaskSchedulerImpl: Lost executor 194 on 192.168.47.90: Executor heartbeat timed out after 169968 ms
19/10/03 19:17:44 WARN TaskSetManager: Lost task 131.0 in stage 225.0 (TID 488882, 192.168.47.90, executor 194): ExecutorLostFailure (executor 194 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 169968 ms
19/10/03 19:17:44 WARN HeartbeatReceiver: Removing executor 143 with no recent heartbeats: 147409 ms exceeds timeout 120000 ms
19/10/03 19:17:44 ERROR TaskSchedulerImpl: Lost executor 143 on 192.168.12.96: Executor heartbeat timed out after 147409 ms
19/10/03 19:17:44 WARN TaskSetManager: Lost task 90.0 in stage 225.0 (TID 488841, 192.168.12.96, executor 143): ExecutorLostFailure (executor 143 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 147409 ms
19/10/03 19:17:44 WARN HeartbeatReceiver: Removing executor 166 with no recent heartbeats: 126359 ms exceeds timeout 120000 ms
19/10/03 19:17:44 ERROR TaskSchedulerImpl: Lost executor 166 on 192.168.4.110: Executor heartbeat timed out after 126359 ms
19/10/03 19:17:44 WARN TaskSetManager: Lost task 120.0 in stage 225.0 (TID 488871, 192.168.4.110, executor 166): ExecutorLostFailure (executor 166 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 126359 ms
19/10/03 19:17:44 ERROR TaskSchedulerImpl: Lost executor 194 on 192.168.47.90: The executor with id 194 was deleted by a user or the framework.
19/10/03 19:17:44 ERROR TaskSchedulerImpl: Lost executor 143 on 192.168.12.96: The executor with id 143 was deleted by a user or the framework.
19/10/03 19:17:44 ERROR TaskSchedulerImpl: Lost executor 166 on 192.168.4.110: The executor with id 166 was deleted by a user or the framework.
19/10/03 19:17:46 WARN TransportChannelHandler: Exception in connection from /192.168.47.90:33710
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:17:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.47.90:33710 is closed
19/10/03 19:17:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 420 from block manager BlockManagerId(194, 192.168.47.90, 38543, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:17:46 WARN TransportChannelHandler: Exception in connection from /192.168.4.110:35092
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:17:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.4.110:35092 is closed
19/10/03 19:17:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 420 from block manager BlockManagerId(166, 192.168.4.110, 37593, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:17:46 WARN TransportChannelHandler: Exception in connection from /192.168.12.96:49826
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:17:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.12.96:49826 is closed
19/10/03 19:17:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 420 from block manager BlockManagerId(143, 192.168.12.96, 38427, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:17:51 WARN TaskSetManager: Lost task 178.0 in stage 225.0 (TID 488929, 192.168.14.254, executor 151): FetchFailed(BlockManagerId(211, 192.168.39.159, 37959, None), shuffleId=110, mapId=5303, reduceId=178, message=
org.apache.spark.shuffle.FetchFailedException: Connecting to /192.168.39.159:37959 timed out (120000 ms)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Connecting to /192.168.39.159:37959 timed out (120000 ms)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:243)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more

)
19/10/03 19:18:31 ERROR TransportChannelHandler: Connection to /192.168.18.11:44320 has been quiet for 120000 ms while there are outstanding requests. Assuming connection is dead; please adjust spark.network.timeout if this is wrong.
19/10/03 19:18:31 ERROR TransportResponseHandler: Still have 0 requests outstanding when connection from /192.168.18.11:44320 is closed
19/10/03 19:18:31 ERROR ContextCleaner: Error cleaning broadcast 420
org.apache.spark.rpc.RpcTimeoutException: Futures timed out after [120 seconds]. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:76)
	at org.apache.spark.storage.BlockManagerMaster.removeBroadcast(BlockManagerMaster.scala:155)
	at org.apache.spark.broadcast.TorrentBroadcast$.unpersist(TorrentBroadcast.scala:321)
	at org.apache.spark.broadcast.TorrentBroadcastFactory.unbroadcast(TorrentBroadcastFactory.scala:45)
	at org.apache.spark.broadcast.BroadcastManager.unbroadcast(BroadcastManager.scala:66)
	at org.apache.spark.ContextCleaner.doCleanupBroadcast(ContextCleaner.scala:238)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:194)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:185)
	at scala.Option.foreach(Option.scala:257)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1.apply$mcV$sp(ContextCleaner.scala:185)
	at org.apache.spark.util.Utils$.tryOrStopSparkContext(Utils.scala:1302)
	at org.apache.spark.ContextCleaner.org$apache$spark$ContextCleaner$$keepCleaning(ContextCleaner.scala:178)
	at org.apache.spark.ContextCleaner$$anon$1.run(ContextCleaner.scala:73)
Caused by: java.util.concurrent.TimeoutException: Futures timed out after [120 seconds]
	at scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:223)
	at scala.concurrent.impl.Promise$DefaultPromise.result(Promise.scala:227)
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:220)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:75)
	... 12 more
19/10/03 19:18:31 WARN BlockManagerMaster: Failed to remove broadcast 420 with removeFromMaster = true - Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
org.apache.spark.rpc.RpcTimeoutException: Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at scala.util.Failure$$anonfun$recover$1.apply(Try.scala:216)
	at scala.util.Try$.apply(Try.scala:192)
	at scala.util.Failure.recover(Try.scala:216)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at org.spark_project.guava.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:293)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$1.execute(ExecutionContextImpl.scala:136)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.complete(Promise.scala:55)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:157)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.processBatch$1(BatchingExecutor.scala:63)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply$mcV$sp(BatchingExecutor.scala:78)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:72)
	at scala.concurrent.BatchingExecutor$Batch.run(BatchingExecutor.scala:54)
	at scala.concurrent.Future$InternalCallbackExecutor$.unbatchedExecute(Future.scala:601)
	at scala.concurrent.BatchingExecutor$class.execute(BatchingExecutor.scala:106)
	at scala.concurrent.Future$InternalCallbackExecutor$.execute(Future.scala:599)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.tryFailure(Promise.scala:112)
	at scala.concurrent.impl.Promise$DefaultPromise.tryFailure(Promise.scala:157)
	at org.apache.spark.rpc.netty.NettyRpcEnv.org$apache$spark$rpc$netty$NettyRpcEnv$$onFailure$1(NettyRpcEnv.scala:206)
	at org.apache.spark.rpc.netty.NettyRpcEnv$$anon$1.run(NettyRpcEnv.scala:243)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException: Cannot receive any reply from null in 120 seconds
	... 8 more
19/10/03 19:18:44 WARN HeartbeatReceiver: Removing executor 66 with no recent heartbeats: 148360 ms exceeds timeout 120000 ms
19/10/03 19:18:44 ERROR TaskSchedulerImpl: Lost executor 66 on 192.168.18.11: Executor heartbeat timed out after 148360 ms
19/10/03 19:18:44 WARN TaskSetManager: Lost task 83.0 in stage 225.0 (TID 488834, 192.168.18.11, executor 66): ExecutorLostFailure (executor 66 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 148360 ms
19/10/03 19:18:44 WARN HeartbeatReceiver: Removing executor 56 with no recent heartbeats: 141295 ms exceeds timeout 120000 ms
19/10/03 19:18:44 ERROR TaskSchedulerImpl: Lost executor 56 on 192.168.27.131: Executor heartbeat timed out after 141295 ms
19/10/03 19:18:44 WARN TaskSetManager: Lost task 24.0 in stage 225.0 (TID 488775, 192.168.27.131, executor 56): ExecutorLostFailure (executor 56 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 141295 ms
19/10/03 19:18:44 WARN HeartbeatReceiver: Removing executor 177 with no recent heartbeats: 143605 ms exceeds timeout 120000 ms
19/10/03 19:18:44 ERROR TaskSchedulerImpl: Lost executor 177 on 192.168.40.158: Executor heartbeat timed out after 143605 ms
19/10/03 19:18:44 WARN TaskSetManager: Lost task 175.0 in stage 225.0 (TID 488926, 192.168.40.158, executor 177): ExecutorLostFailure (executor 177 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 143605 ms
19/10/03 19:18:44 ERROR TaskSchedulerImpl: Lost an executor 66 (already removed): The executor with id 66 was deleted by a user or the framework.
19/10/03 19:18:44 ERROR TaskSchedulerImpl: Lost executor 56 on 192.168.27.131: The executor with id 56 was deleted by a user or the framework.
19/10/03 19:18:44 ERROR TaskSchedulerImpl: Lost executor 177 on 192.168.40.158: The executor with id 177 was deleted by a user or the framework.
19/10/03 19:18:45 WARN TransportResponseHandler: Ignoring response for RPC 9119453150545355629 from /192.168.57.124:35570 (81 bytes) since it is not outstanding
19/10/03 19:18:46 WARN TransportChannelHandler: Exception in connection from /192.168.40.158:46660
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:18:57 WARN TaskSetManager: Lost task 192.0 in stage 225.0 (TID 488943, 192.168.39.151, executor 191): FetchFailed(BlockManagerId(168, 192.168.59.172, 36863, None), shuffleId=110, mapId=1762, reduceId=192, message=
org.apache.spark.shuffle.FetchFailedException: Connecting to /192.168.59.172:36863 timed out (120000 ms)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Connecting to /192.168.59.172:36863 timed out (120000 ms)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:243)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more

)
19/10/03 19:18:57 WARN TaskSetManager: Lost task 150.0 in stage 225.0 (TID 488901, 192.168.37.35, executor 173): FetchFailed(BlockManagerId(168, 192.168.59.172, 36863, None), shuffleId=110, mapId=46, reduceId=150, message=
org.apache.spark.shuffle.FetchFailedException: Connecting to /192.168.59.172:36863 timed out (120000 ms)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Connecting to /192.168.59.172:36863 timed out (120000 ms)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:243)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more

)
19/10/03 19:18:57 WARN TaskSetManager: Lost task 63.0 in stage 225.0 (TID 488814, 192.168.56.247, executor 15): FetchFailed(BlockManagerId(168, 192.168.59.172, 36863, None), shuffleId=110, mapId=46, reduceId=63, message=
org.apache.spark.shuffle.FetchFailedException: Connecting to /192.168.59.172:36863 timed out (120000 ms)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Connecting to /192.168.59.172:36863 timed out (120000 ms)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:243)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more

)
19/10/03 19:19:08 WARN TransportChannelHandler: Exception in connection from /192.168.27.131:48920
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:19:25 WARN TransportResponseHandler: Ignoring response for RPC 7785480096891070818 from /192.168.48.84:43494 (81 bytes) since it is not outstanding
19/10/03 19:19:44 WARN HeartbeatReceiver: Removing executor 170 with no recent heartbeats: 155351 ms exceeds timeout 120000 ms
19/10/03 19:19:44 ERROR TaskSchedulerImpl: Lost executor 170 on 192.168.48.84: Executor heartbeat timed out after 155351 ms
19/10/03 19:19:44 WARN TaskSetManager: Lost task 186.0 in stage 225.0 (TID 488937, 192.168.48.84, executor 170): ExecutorLostFailure (executor 170 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 155351 ms
19/10/03 19:19:44 WARN HeartbeatReceiver: Removing executor 193 with no recent heartbeats: 147327 ms exceeds timeout 120000 ms
19/10/03 19:19:44 ERROR TaskSchedulerImpl: Lost executor 193 on 192.168.4.238: Executor heartbeat timed out after 147327 ms
19/10/03 19:19:44 WARN TaskSetManager: Lost task 82.0 in stage 225.0 (TID 488833, 192.168.4.238, executor 193): ExecutorLostFailure (executor 193 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 147327 ms
19/10/03 19:19:44 WARN HeartbeatReceiver: Removing executor 19 with no recent heartbeats: 151885 ms exceeds timeout 120000 ms
19/10/03 19:19:44 ERROR TaskSchedulerImpl: Lost executor 19 on 192.168.35.135: Executor heartbeat timed out after 151885 ms
19/10/03 19:19:44 WARN TaskSetManager: Lost task 77.0 in stage 225.0 (TID 488828, 192.168.35.135, executor 19): ExecutorLostFailure (executor 19 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 151885 ms
19/10/03 19:19:44 WARN HeartbeatReceiver: Removing executor 120 with no recent heartbeats: 175902 ms exceeds timeout 120000 ms
19/10/03 19:19:44 ERROR TaskSchedulerImpl: Lost executor 120 on 192.168.57.124: Executor heartbeat timed out after 175902 ms
19/10/03 19:19:44 WARN TaskSetManager: Lost task 134.0 in stage 225.0 (TID 488885, 192.168.57.124, executor 120): ExecutorLostFailure (executor 120 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 175902 ms
19/10/03 19:19:44 ERROR TaskSchedulerImpl: Lost executor 170 on 192.168.48.84: The executor with id 170 was deleted by a user or the framework.
19/10/03 19:19:44 ERROR TaskSchedulerImpl: Lost executor 193 on 192.168.4.238: The executor with id 193 was deleted by a user or the framework.
19/10/03 19:19:44 ERROR TaskSchedulerImpl: Lost executor 19 on 192.168.35.135: The executor with id 19 was deleted by a user or the framework.
19/10/03 19:19:44 ERROR TaskSchedulerImpl: Lost executor 120 on 192.168.57.124: The executor with id 120 was deleted by a user or the framework.
19/10/03 19:19:46 WARN TransportChannelHandler: Exception in connection from /192.168.48.84:43494
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:19:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.48.84:43494 is closed
19/10/03 19:19:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 422 from block manager BlockManagerId(170, 192.168.48.84, 39977, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:19:46 WARN TransportChannelHandler: Exception in connection from /192.168.35.135:33756
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:19:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.35.135:33756 is closed
19/10/03 19:19:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 422 from block manager BlockManagerId(19, 192.168.35.135, 36767, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:19:46 WARN TransportChannelHandler: Exception in connection from /192.168.57.124:35570
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:19:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.57.124:35570 is closed
19/10/03 19:19:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 422 from block manager BlockManagerId(120, 192.168.57.124, 33237, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:19:49 WARN TransportChannelHandler: Exception in connection from /192.168.4.238:36692
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:19:49 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.4.238:36692 is closed
19/10/03 19:19:49 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 422 from block manager BlockManagerId(193, 192.168.4.238, 41811, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:21:35 ERROR ContextCleaner: Error cleaning broadcast 422
org.apache.spark.rpc.RpcTimeoutException: Futures timed out after [120 seconds]. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:76)
	at org.apache.spark.storage.BlockManagerMaster.removeBroadcast(BlockManagerMaster.scala:155)
	at org.apache.spark.broadcast.TorrentBroadcast$.unpersist(TorrentBroadcast.scala:321)
	at org.apache.spark.broadcast.TorrentBroadcastFactory.unbroadcast(TorrentBroadcastFactory.scala:45)
	at org.apache.spark.broadcast.BroadcastManager.unbroadcast(BroadcastManager.scala:66)
	at org.apache.spark.ContextCleaner.doCleanupBroadcast(ContextCleaner.scala:238)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:194)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:185)
	at scala.Option.foreach(Option.scala:257)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1.apply$mcV$sp(ContextCleaner.scala:185)
	at org.apache.spark.util.Utils$.tryOrStopSparkContext(Utils.scala:1302)
	at org.apache.spark.ContextCleaner.org$apache$spark$ContextCleaner$$keepCleaning(ContextCleaner.scala:178)
	at org.apache.spark.ContextCleaner$$anon$1.run(ContextCleaner.scala:73)
Caused by: java.util.concurrent.TimeoutException: Futures timed out after [120 seconds]
	at scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:223)
	at scala.concurrent.impl.Promise$DefaultPromise.result(Promise.scala:227)
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:220)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:75)
	... 12 more
19/10/03 19:21:35 WARN BlockManagerMaster: Failed to remove broadcast 422 with removeFromMaster = true - Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
org.apache.spark.rpc.RpcTimeoutException: Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at scala.util.Failure$$anonfun$recover$1.apply(Try.scala:216)
	at scala.util.Try$.apply(Try.scala:192)
	at scala.util.Failure.recover(Try.scala:216)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at org.spark_project.guava.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:293)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$1.execute(ExecutionContextImpl.scala:136)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.complete(Promise.scala:55)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:157)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.processBatch$1(BatchingExecutor.scala:63)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply$mcV$sp(BatchingExecutor.scala:78)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:72)
	at scala.concurrent.BatchingExecutor$Batch.run(BatchingExecutor.scala:54)
	at scala.concurrent.Future$InternalCallbackExecutor$.unbatchedExecute(Future.scala:601)
	at scala.concurrent.BatchingExecutor$class.execute(BatchingExecutor.scala:106)
	at scala.concurrent.Future$InternalCallbackExecutor$.execute(Future.scala:599)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.tryFailure(Promise.scala:112)
	at scala.concurrent.impl.Promise$DefaultPromise.tryFailure(Promise.scala:157)
	at org.apache.spark.rpc.netty.NettyRpcEnv.org$apache$spark$rpc$netty$NettyRpcEnv$$onFailure$1(NettyRpcEnv.scala:206)
	at org.apache.spark.rpc.netty.NettyRpcEnv$$anon$1.run(NettyRpcEnv.scala:243)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException: Cannot receive any reply from null in 120 seconds
	... 8 more
19/10/03 19:21:44 WARN HeartbeatReceiver: Removing executor 29 with no recent heartbeats: 154803 ms exceeds timeout 120000 ms
19/10/03 19:21:44 ERROR TaskSchedulerImpl: Lost executor 29 on 192.168.16.25: Executor heartbeat timed out after 154803 ms
19/10/03 19:21:44 WARN TaskSetManager: Lost task 116.0 in stage 225.0 (TID 488867, 192.168.16.25, executor 29): ExecutorLostFailure (executor 29 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 154803 ms
19/10/03 19:21:44 ERROR TaskSchedulerImpl: Lost executor 29 on 192.168.16.25: The executor with id 29 was deleted by a user or the framework.
19/10/03 19:21:47 WARN TransportChannelHandler: Exception in connection from /192.168.16.25:38502
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:30:44 WARN HeartbeatReceiver: Removing executor 238 with no recent heartbeats: 165596 ms exceeds timeout 120000 ms
19/10/03 19:30:44 ERROR TaskSchedulerImpl: Lost executor 238 on 192.168.22.100: Executor heartbeat timed out after 165596 ms
19/10/03 19:30:44 WARN TaskSetManager: Lost task 27.0 in stage 225.2 (TID 498066, 192.168.22.100, executor 238): ExecutorLostFailure (executor 238 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 165596 ms
19/10/03 19:30:44 WARN HeartbeatReceiver: Removing executor 70 with no recent heartbeats: 124419 ms exceeds timeout 120000 ms
19/10/03 19:30:44 ERROR TaskSchedulerImpl: Lost executor 70 on 192.168.52.26: Executor heartbeat timed out after 124419 ms
19/10/03 19:30:44 WARN TaskSetManager: Lost task 41.0 in stage 225.2 (TID 498080, 192.168.52.26, executor 70): ExecutorLostFailure (executor 70 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 124419 ms
19/10/03 19:30:44 WARN TaskSetManager: Lost task 27.1 in stage 225.2 (TID 498087, 192.168.40.164, executor 96): FetchFailed(null, shuffleId=110, mapId=-1, reduceId=92, message=
org.apache.spark.shuffle.MetadataFetchFailedException: Missing an output location for shuffle 110
	at org.apache.spark.MapOutputTracker$$anonfun$convertMapStatuses$2.apply(MapOutputTracker.scala:882)
	at org.apache.spark.MapOutputTracker$$anonfun$convertMapStatuses$2.apply(MapOutputTracker.scala:878)
	at scala.collection.Iterator$class.foreach(Iterator.scala:891)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1334)
	at org.apache.spark.MapOutputTracker$.convertMapStatuses(MapOutputTracker.scala:878)
	at org.apache.spark.MapOutputTrackerWorker.getMapSizesByExecutorId(MapOutputTracker.scala:691)
	at org.apache.spark.shuffle.BlockStoreShuffleReader.read(BlockStoreShuffleReader.scala:49)
	at org.apache.spark.sql.execution.ShuffledRowRDD.compute(ShuffledRowRDD.scala:165)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

)
19/10/03 19:30:44 ERROR TaskSchedulerImpl: Lost executor 238 on 192.168.22.100: The executor with id 238 was deleted by a user or the framework.
19/10/03 19:30:44 ERROR TaskSchedulerImpl: Lost executor 70 on 192.168.52.26: The executor with id 70 was deleted by a user or the framework.
19/10/03 19:30:47 WARN TransportChannelHandler: Exception in connection from /192.168.52.26:39378
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:30:56 WARN TransportChannelHandler: Exception in connection from /192.168.22.100:39118
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:31:08 WARN TaskSetManager: Lost task 24.0 in stage 225.2 (TID 498063, 192.168.20.146, executor 129): FetchFailed(BlockManagerId(70, 192.168.52.26, 33285, None), shuffleId=110, mapId=7130, reduceId=83, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.52.26:33285
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.52.26:33285
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.52.26:33285
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:31:11 WARN TaskSetManager: Lost task 46.0 in stage 225.2 (TID 498085, 192.168.46.70, executor 12): FetchFailed(BlockManagerId(70, 192.168.52.26, 33285, None), shuffleId=110, mapId=8753, reduceId=193, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.52.26:33285
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.52.26:33285
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.52.26:33285
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:31:24 WARN TaskSetManager: Lost task 16.0 in stage 225.2 (TID 498055, 192.168.34.136, executor 218): FetchFailed(BlockManagerId(70, 192.168.52.26, 33285, None), shuffleId=110, mapId=5640, reduceId=63, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.52.26:33285
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.52.26:33285
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.52.26:33285
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:31:44 WARN HeartbeatReceiver: Removing executor 206 with no recent heartbeats: 137834 ms exceeds timeout 120000 ms
19/10/03 19:31:44 ERROR TaskSchedulerImpl: Lost executor 206 on 192.168.11.250: Executor heartbeat timed out after 137834 ms
19/10/03 19:31:44 WARN TaskSetManager: Lost task 47.0 in stage 225.2 (TID 498086, 192.168.11.250, executor 206): ExecutorLostFailure (executor 206 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 137834 ms
19/10/03 19:31:44 WARN HeartbeatReceiver: Removing executor 80 with no recent heartbeats: 124262 ms exceeds timeout 120000 ms
19/10/03 19:31:44 ERROR TaskSchedulerImpl: Lost executor 80 on 192.168.36.72: Executor heartbeat timed out after 124262 ms
19/10/03 19:31:44 WARN TaskSetManager: Lost task 12.0 in stage 225.2 (TID 498051, 192.168.36.72, executor 80): ExecutorLostFailure (executor 80 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 124262 ms
19/10/03 19:31:44 WARN HeartbeatReceiver: Removing executor 180 with no recent heartbeats: 163363 ms exceeds timeout 120000 ms
19/10/03 19:31:44 ERROR TaskSchedulerImpl: Lost executor 180 on 192.168.11.32: Executor heartbeat timed out after 163363 ms
19/10/03 19:31:44 WARN TaskSetManager: Lost task 1.0 in stage 225.2 (TID 498040, 192.168.11.32, executor 180): ExecutorLostFailure (executor 180 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 163363 ms
19/10/03 19:31:44 WARN HeartbeatReceiver: Removing executor 192 with no recent heartbeats: 149971 ms exceeds timeout 120000 ms
19/10/03 19:31:44 ERROR TaskSchedulerImpl: Lost executor 192 on 192.168.23.34: Executor heartbeat timed out after 149971 ms
19/10/03 19:31:44 WARN TaskSetManager: Lost task 5.0 in stage 225.2 (TID 498044, 192.168.23.34, executor 192): ExecutorLostFailure (executor 192 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 149971 ms
19/10/03 19:31:44 WARN HeartbeatReceiver: Removing executor 225 with no recent heartbeats: 171159 ms exceeds timeout 120000 ms
19/10/03 19:31:44 ERROR TaskSchedulerImpl: Lost executor 225 on 192.168.58.31: Executor heartbeat timed out after 171159 ms
19/10/03 19:31:44 WARN TaskSetManager: Lost task 28.0 in stage 225.2 (TID 498067, 192.168.58.31, executor 225): ExecutorLostFailure (executor 225 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 171159 ms
19/10/03 19:31:44 ERROR TaskSchedulerImpl: Lost executor 206 on 192.168.11.250: The executor with id 206 was deleted by a user or the framework.
19/10/03 19:31:44 ERROR TaskSchedulerImpl: Lost executor 80 on 192.168.36.72: The executor with id 80 was deleted by a user or the framework.
19/10/03 19:31:44 ERROR TaskSchedulerImpl: Lost executor 180 on 192.168.11.32: The executor with id 180 was deleted by a user or the framework.
19/10/03 19:31:44 ERROR TaskSchedulerImpl: Lost executor 192 on 192.168.23.34: The executor with id 192 was deleted by a user or the framework.
19/10/03 19:31:44 ERROR TaskSchedulerImpl: Lost executor 225 on 192.168.58.31: The executor with id 225 was deleted by a user or the framework.
19/10/03 19:31:48 WARN TransportChannelHandler: Exception in connection from /192.168.58.31:57132
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:31:48 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.58.31:57132 is closed
19/10/03 19:31:48 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 426 from block manager BlockManagerId(225, 192.168.58.31, 38259, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:31:49 WARN TransportChannelHandler: Exception in connection from /192.168.36.72:46300
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:31:49 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.36.72:46300 is closed
19/10/03 19:31:49 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 426 from block manager BlockManagerId(80, 192.168.36.72, 34799, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:31:52 WARN TransportChannelHandler: Exception in connection from /192.168.11.250:49740
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:31:52 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.11.250:49740 is closed
19/10/03 19:31:52 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 426 from block manager BlockManagerId(206, 192.168.11.250, 46179, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:32:03 WARN TransportChannelHandler: Exception in connection from /192.168.11.32:58334
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:32:03 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.11.32:58334 is closed
19/10/03 19:32:03 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 426 from block manager BlockManagerId(180, 192.168.11.32, 43223, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:32:07 WARN TaskSetManager: Lost task 19.0 in stage 225.3 (TID 498373, 192.168.5.173, executor 174): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=116, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
Execution 'q14b-v2.4' failed: Exception thrown in awaitResult: 
Running execution q15-v2.4 iteration: 1, StandardRun=true
19/10/03 19:32:08 WARN TaskSetManager: Lost task 26.0 in stage 225.3 (TID 498380, 192.168.17.222, executor 106): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=138, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:08 WARN TaskSetManager: Lost task 30.0 in stage 225.3 (TID 498384, 192.168.60.160, executor 105): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=168, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:08 WARN TaskSetManager: Lost task 28.0 in stage 225.3 (TID 498382, 192.168.26.40, executor 147): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=151, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:08 WARN TaskSetManager: Lost task 6.0 in stage 225.3 (TID 498360, 192.168.28.43, executor 232): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=47, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:08 WARN TaskSetManager: Lost task 17.0 in stage 225.3 (TID 498371, 192.168.6.209, executor 208): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=92, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:08 WARN TaskSetManager: Lost task 0.0 in stage 225.3 (TID 498354, 192.168.30.63, executor 196): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=12, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:08 WARN TaskSetManager: Lost task 2.0 in stage 225.3 (TID 498356, 192.168.14.26, executor 233): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=21, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:08 WARN TaskSetManager: Lost task 23.0 in stage 225.3 (TID 498377, 192.168.23.15, executor 215): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=127, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:09 INFO Query: 
== Query: q15-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ca_zip#457, sum(cs_sales_price)#12412]
      +- Sort [ca_zip#457 ASC NULLS FIRST], true
         +- Aggregate [ca_zip#457], [ca_zip#457, sum(cs_sales_price#21) AS sum(cs_sales_price)#12412]
            +- Filter ((((cs_bill_customer_sk#3 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && ((substring(ca_zip#457, 1, 5) IN (85669,86197,88274,83405,86475,85392,85460,80348,81792) || ca_state#456 IN (CA,WA,GA)) || (cast(cs_sales_price#21 as decimal(7,2)) > cast(cast(500 as decimal(3,0)) as decimal(7,2))))) && (((cs_sold_date_sk#0 = d_date_sk#492) && (d_qoy#502 = 2)) && (d_year#498 = 2001)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `customer`
                  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/03 19:32:09 INFO Query: 
== Query: q15-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ca_zip#457, sum(cs_sales_price)#12417]
      +- Sort [ca_zip#457 ASC NULLS FIRST], true
         +- Aggregate [ca_zip#457], [ca_zip#457, sum(cs_sales_price#21) AS sum(cs_sales_price)#12417]
            +- Filter ((((cs_bill_customer_sk#3 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && ((substring(ca_zip#457, 1, 5) IN (85669,86197,88274,83405,86475,85392,85460,80348,81792) || ca_state#456 IN (CA,WA,GA)) || (cast(cs_sales_price#21 as decimal(7,2)) > cast(cast(500 as decimal(3,0)) as decimal(7,2))))) && (((cs_sold_date_sk#0 = d_date_sk#492) && (d_qoy#502 = 2)) && (d_year#498 = 2001)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `customer`
                  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
19/10/03 19:32:10 WARN TaskSetManager: Lost task 22.0 in stage 225.3 (TID 498376, 192.168.40.164, executor 96): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=123, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 8.0 in stage 225.3 (TID 498362, 192.168.31.39, executor 104): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=65, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 32.0 in stage 225.3 (TID 498386, 192.168.27.39, executor 123): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=178, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 34.0 in stage 225.3 (TID 498388, 192.168.52.135, executor 203): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=188, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 36.0 in stage 225.3 (TID 498390, 192.168.56.247, executor 15): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=193, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 20.0 in stage 225.3 (TID 498374, 192.168.50.0, executor 100): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=120, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 33.0 in stage 225.3 (TID 498387, 192.168.39.151, executor 191): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=186, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 15.0 in stage 225.3 (TID 498369, 192.168.54.141, executor 53): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=89, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 12.0 in stage 225.3 (TID 498366, 192.168.38.213, executor 102): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=77, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 4.0 in stage 225.3 (TID 498358, 192.168.60.221, executor 121): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=38, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 29.0 in stage 225.3 (TID 498383, 192.168.38.50, executor 226): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=157, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 24.0 in stage 225.3 (TID 498378, 192.168.32.93, executor 92): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=131, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 31.0 in stage 225.3 (TID 498385, 192.168.39.158, executor 181): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=175, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 18.0 in stage 225.3 (TID 498372, 192.168.51.74, executor 158): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=115, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 13.0 in stage 225.3 (TID 498367, 192.168.1.119, executor 159): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=82, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 35.0 in stage 225.3 (TID 498389, 192.168.63.53, executor 184): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=192, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 10.0 in stage 225.3 (TID 498364, 192.168.57.207, executor 84): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=74, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 9.0 in stage 225.3 (TID 498363, 192.168.49.9, executor 213): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=69, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 1.0 in stage 225.3 (TID 498355, 192.168.61.195, executor 200): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=19, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:10 WARN TaskSetManager: Lost task 37.0 in stage 225.3 (TID 498391, 192.168.61.229, executor 216): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=198, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:13 WARN TaskSetManager: Lost task 3.0 in stage 225.3 (TID 498357, 192.168.46.113, executor 95): FetchFailed(BlockManagerId(80, 192.168.36.72, 34799, None), shuffleId=111, mapId=1206, reduceId=24, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.36.72:34799
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.36.72:34799
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:17 WARN TaskSetManager: Lost task 38.0 in stage 225.2 (TID 498077, 192.168.25.178, executor 4): FetchFailed(BlockManagerId(180, 192.168.11.32, 43223, None), shuffleId=110, mapId=37, reduceId=150, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.11.32:43223
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.11.32:43223
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.11.32:43223
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:23 WARN TaskSetManager: Lost task 16.0 in stage 225.3 (TID 498370, 192.168.34.41, executor 179): FetchFailed(BlockManagerId(180, 192.168.11.32, 43223, None), shuffleId=111, mapId=1212, reduceId=90, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.11.32:43223
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.11.32:43223
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.11.32:43223
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:23 WARN TaskSetManager: Lost task 25.0 in stage 225.3 (TID 498379, 192.168.0.41, executor 220): FetchFailed(BlockManagerId(180, 192.168.11.32, 43223, None), shuffleId=111, mapId=1212, reduceId=134, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.11.32:43223
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.11.32:43223
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.11.32:43223
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:23 WARN TaskSetManager: Lost task 21.0 in stage 225.3 (TID 498375, 192.168.17.66, executor 201): FetchFailed(BlockManagerId(180, 192.168.11.32, 43223, None), shuffleId=111, mapId=1212, reduceId=121, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.11.32:43223
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.11.32:43223
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.11.32:43223
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:23 WARN TaskSetManager: Lost task 27.0 in stage 225.3 (TID 498381, 192.168.20.246, executor 13): FetchFailed(BlockManagerId(180, 192.168.11.32, 43223, None), shuffleId=111, mapId=1212, reduceId=150, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.11.32:43223
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.11.32:43223
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.11.32:43223
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:26 WARN TaskSetManager: Lost task 5.0 in stage 225.3 (TID 498359, 192.168.56.65, executor 188): FetchFailed(BlockManagerId(180, 192.168.11.32, 43223, None), shuffleId=111, mapId=1212, reduceId=44, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.11.32:43223
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.11.32:43223
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.11.32:43223
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:32:44 WARN HeartbeatReceiver: Removing executor 111 with no recent heartbeats: 179280 ms exceeds timeout 120000 ms
19/10/03 19:32:44 ERROR TaskSchedulerImpl: Lost executor 111 on 192.168.20.42: Executor heartbeat timed out after 179280 ms
19/10/03 19:32:44 WARN TaskSetManager: Lost task 17.0 in stage 225.2 (TID 498056, 192.168.20.42, executor 111): ExecutorLostFailure (executor 111 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 179280 ms
19/10/03 19:32:44 WARN HeartbeatReceiver: Removing executor 212 with no recent heartbeats: 121997 ms exceeds timeout 120000 ms
19/10/03 19:32:44 ERROR TaskSchedulerImpl: Lost executor 212 on 192.168.62.147: Executor heartbeat timed out after 121997 ms
19/10/03 19:32:44 WARN TaskSetManager: Lost task 3.0 in stage 225.2 (TID 498042, 192.168.62.147, executor 212): ExecutorLostFailure (executor 212 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 121997 ms
19/10/03 19:32:44 WARN HeartbeatReceiver: Removing executor 178 with no recent heartbeats: 149382 ms exceeds timeout 120000 ms
19/10/03 19:32:44 ERROR TaskSchedulerImpl: Lost executor 178 on 192.168.21.49: Executor heartbeat timed out after 149382 ms
19/10/03 19:32:44 WARN TaskSetManager: Lost task 42.0 in stage 225.2 (TID 498081, 192.168.21.49, executor 178): ExecutorLostFailure (executor 178 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 149382 ms
19/10/03 19:32:44 WARN HeartbeatReceiver: Removing executor 221 with no recent heartbeats: 157436 ms exceeds timeout 120000 ms
19/10/03 19:32:44 ERROR TaskSchedulerImpl: Lost executor 221 on 192.168.32.84: Executor heartbeat timed out after 157436 ms
19/10/03 19:32:44 WARN TaskSetManager: Lost task 19.0 in stage 225.2 (TID 498058, 192.168.32.84, executor 221): ExecutorLostFailure (executor 221 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 157436 ms
19/10/03 19:32:44 WARN HeartbeatReceiver: Removing executor 7 with no recent heartbeats: 159927 ms exceeds timeout 120000 ms
19/10/03 19:32:44 ERROR TaskSchedulerImpl: Lost executor 7 on 192.168.13.226: Executor heartbeat timed out after 159927 ms
19/10/03 19:32:44 WARN TaskSetManager: Lost task 4.0 in stage 225.2 (TID 498043, 192.168.13.226, executor 7): ExecutorLostFailure (executor 7 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 159927 ms
19/10/03 19:32:44 WARN HeartbeatReceiver: Removing executor 202 with no recent heartbeats: 133444 ms exceeds timeout 120000 ms
19/10/03 19:32:44 ERROR TaskSchedulerImpl: Lost executor 202 on 192.168.47.99: Executor heartbeat timed out after 133444 ms
19/10/03 19:32:44 WARN TaskSetManager: Lost task 20.0 in stage 225.2 (TID 498059, 192.168.47.99, executor 202): ExecutorLostFailure (executor 202 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 133444 ms
19/10/03 19:32:44 WARN HeartbeatReceiver: Removing executor 81 with no recent heartbeats: 136807 ms exceeds timeout 120000 ms
19/10/03 19:32:44 ERROR TaskSchedulerImpl: Lost executor 81 on 192.168.49.103: Executor heartbeat timed out after 136807 ms
19/10/03 19:32:44 WARN TaskSetManager: Lost task 44.0 in stage 225.2 (TID 498083, 192.168.49.103, executor 81): ExecutorLostFailure (executor 81 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 136807 ms
19/10/03 19:32:44 ERROR TaskSchedulerImpl: Lost executor 111 on 192.168.20.42: The executor with id 111 was deleted by a user or the framework.
19/10/03 19:32:44 ERROR TaskSchedulerImpl: Lost executor 212 on 192.168.62.147: The executor with id 212 was deleted by a user or the framework.
19/10/03 19:32:44 ERROR TaskSchedulerImpl: Lost executor 178 on 192.168.21.49: The executor with id 178 was deleted by a user or the framework.
19/10/03 19:32:44 ERROR TaskSchedulerImpl: Lost executor 221 on 192.168.32.84: The executor with id 221 was deleted by a user or the framework.
19/10/03 19:32:44 ERROR TaskSchedulerImpl: Lost executor 7 on 192.168.13.226: The executor with id 7 was deleted by a user or the framework.
19/10/03 19:32:44 ERROR TaskSchedulerImpl: Lost executor 202 on 192.168.47.99: The executor with id 202 was deleted by a user or the framework.
19/10/03 19:32:44 ERROR TaskSchedulerImpl: Lost executor 81 on 192.168.49.103: The executor with id 81 was deleted by a user or the framework.
19/10/03 19:32:45 WARN TransportChannelHandler: Exception in connection from /192.168.23.34:37708
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:32:45 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.23.34:37708 is closed
19/10/03 19:32:45 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 426 from block manager BlockManagerId(192, 192.168.23.34, 35331, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:32:46 WARN TransportChannelHandler: Exception in connection from /192.168.21.49:35150
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:32:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.21.49:35150 is closed
19/10/03 19:32:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 426 from block manager BlockManagerId(178, 192.168.21.49, 37741, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:32:47 WARN TransportChannelHandler: Exception in connection from /192.168.49.103:55404
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:32:47 WARN TransportChannelHandler: Exception in connection from /192.168.62.147:54408
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:32:47 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.62.147:54408 is closed
19/10/03 19:32:47 WARN TransportChannelHandler: Exception in connection from /192.168.47.99:59602
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:32:47 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.47.99:59602 is closed
19/10/03 19:32:47 WARN TransportChannelHandler: Exception in connection from /192.168.32.84:58678
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:32:47 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.32.84:58678 is closed
19/10/03 19:32:47 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 426 from block manager BlockManagerId(202, 192.168.47.99, 34427, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:32:47 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 426 from block manager BlockManagerId(221, 192.168.32.84, 41249, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:32:47 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.49.103:55404 is closed
19/10/03 19:32:47 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 426 from block manager BlockManagerId(81, 192.168.49.103, 33353, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:32:47 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 426 from block manager BlockManagerId(212, 192.168.62.147, 43719, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:32:48 ERROR ContextCleaner: Error cleaning broadcast 426
org.apache.spark.rpc.RpcTimeoutException: Futures timed out after [120 seconds]. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:76)
	at org.apache.spark.storage.BlockManagerMaster.removeBroadcast(BlockManagerMaster.scala:155)
	at org.apache.spark.broadcast.TorrentBroadcast$.unpersist(TorrentBroadcast.scala:321)
	at org.apache.spark.broadcast.TorrentBroadcastFactory.unbroadcast(TorrentBroadcastFactory.scala:45)
	at org.apache.spark.broadcast.BroadcastManager.unbroadcast(BroadcastManager.scala:66)
	at org.apache.spark.ContextCleaner.doCleanupBroadcast(ContextCleaner.scala:238)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:194)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:185)
	at scala.Option.foreach(Option.scala:257)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1.apply$mcV$sp(ContextCleaner.scala:185)
	at org.apache.spark.util.Utils$.tryOrStopSparkContext(Utils.scala:1302)
	at org.apache.spark.ContextCleaner.org$apache$spark$ContextCleaner$$keepCleaning(ContextCleaner.scala:178)
	at org.apache.spark.ContextCleaner$$anon$1.run(ContextCleaner.scala:73)
Caused by: java.util.concurrent.TimeoutException: Futures timed out after [120 seconds]
	at scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:223)
	at scala.concurrent.impl.Promise$DefaultPromise.result(Promise.scala:227)
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:220)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:75)
	... 12 more
19/10/03 19:32:48 WARN BlockManagerMaster: Failed to remove broadcast 426 with removeFromMaster = true - Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
org.apache.spark.rpc.RpcTimeoutException: Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at scala.util.Failure$$anonfun$recover$1.apply(Try.scala:216)
	at scala.util.Try$.apply(Try.scala:192)
	at scala.util.Failure.recover(Try.scala:216)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at org.spark_project.guava.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:293)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$1.execute(ExecutionContextImpl.scala:136)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.complete(Promise.scala:55)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:157)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.processBatch$1(BatchingExecutor.scala:63)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply$mcV$sp(BatchingExecutor.scala:78)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:72)
	at scala.concurrent.BatchingExecutor$Batch.run(BatchingExecutor.scala:54)
	at scala.concurrent.Future$InternalCallbackExecutor$.unbatchedExecute(Future.scala:601)
	at scala.concurrent.BatchingExecutor$class.execute(BatchingExecutor.scala:106)
	at scala.concurrent.Future$InternalCallbackExecutor$.execute(Future.scala:599)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.tryFailure(Promise.scala:112)
	at scala.concurrent.impl.Promise$DefaultPromise.tryFailure(Promise.scala:157)
	at org.apache.spark.rpc.netty.NettyRpcEnv.org$apache$spark$rpc$netty$NettyRpcEnv$$onFailure$1(NettyRpcEnv.scala:206)
	at org.apache.spark.rpc.netty.NettyRpcEnv$$anon$1.run(NettyRpcEnv.scala:243)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException: Cannot receive any reply from null in 120 seconds
	... 8 more
19/10/03 19:32:52 WARN TransportChannelHandler: Exception in connection from /192.168.13.226:39574
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:33:00 WARN TaskSetManager: Lost task 32.0 in stage 225.2 (TID 498071, 192.168.31.107, executor 189): FetchFailed(BlockManagerId(202, 192.168.47.99, 34427, None), shuffleId=110, mapId=42, reduceId=123, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.47.99:34427
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage7.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedStreamed(SortMergeJoinExec.scala:794)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.findNextInnerJoinRows(SortMergeJoinExec.scala:701)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.advanceNext(SortMergeJoinExec.scala:273)
	at org.apache.spark.sql.execution.RowIteratorToScala.hasNext(RowIterator.scala:68)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage12.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.47.99:34427
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.47.99:34427
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:33:05 WARN TaskSetManager: Lost task 7.0 in stage 225.3 (TID 498361, 192.168.23.216, executor 164): FetchFailed(BlockManagerId(221, 192.168.32.84, 41249, None), shuffleId=111, mapId=1404, reduceId=63, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.32.84:41249
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.32.84:41249
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.32.84:41249
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:33:07 WARN TransportChannelHandler: Exception in connection from /192.168.20.42:46358
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:33:28 WARN TransportResponseHandler: Ignoring response for RPC 8757363217993096762 from /192.168.13.143:35760 (81 bytes) since it is not outstanding
19/10/03 19:33:44 WARN HeartbeatReceiver: Removing executor 239 with no recent heartbeats: 148698 ms exceeds timeout 120000 ms
19/10/03 19:33:44 ERROR TaskSchedulerImpl: Lost executor 239 on 192.168.28.212: Executor heartbeat timed out after 148698 ms
19/10/03 19:33:44 WARN TaskSetManager: Lost task 31.0 in stage 225.2 (TID 498070, 192.168.28.212, executor 239): ExecutorLostFailure (executor 239 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 148698 ms
19/10/03 19:33:44 WARN HeartbeatReceiver: Removing executor 230 with no recent heartbeats: 126853 ms exceeds timeout 120000 ms
19/10/03 19:33:44 ERROR TaskSchedulerImpl: Lost executor 230 on 192.168.6.238: Executor heartbeat timed out after 126853 ms
19/10/03 19:33:44 WARN TaskSetManager: Lost task 21.0 in stage 225.2 (TID 498060, 192.168.6.238, executor 230): ExecutorLostFailure (executor 230 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 126853 ms
19/10/03 19:33:44 WARN HeartbeatReceiver: Removing executor 148 with no recent heartbeats: 127739 ms exceeds timeout 120000 ms
19/10/03 19:33:44 ERROR TaskSchedulerImpl: Lost executor 148 on 192.168.8.120: Executor heartbeat timed out after 127739 ms
19/10/03 19:33:44 WARN TaskSetManager: Lost task 23.0 in stage 225.2 (TID 498062, 192.168.8.120, executor 148): ExecutorLostFailure (executor 148 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 127739 ms
19/10/03 19:33:44 WARN HeartbeatReceiver: Removing executor 65 with no recent heartbeats: 128373 ms exceeds timeout 120000 ms
19/10/03 19:33:44 ERROR TaskSchedulerImpl: Lost executor 65 on 192.168.13.143: Executor heartbeat timed out after 128373 ms
19/10/03 19:33:44 WARN TaskSetManager: Lost task 33.0 in stage 225.2 (TID 498072, 192.168.13.143, executor 65): ExecutorLostFailure (executor 65 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 128373 ms
19/10/03 19:33:44 ERROR TaskSchedulerImpl: Lost executor 239 on 192.168.28.212: The executor with id 239 was deleted by a user or the framework.
19/10/03 19:33:44 ERROR TaskSchedulerImpl: Lost executor 230 on 192.168.6.238: The executor with id 230 was deleted by a user or the framework.
19/10/03 19:33:44 ERROR TaskSchedulerImpl: Lost executor 148 on 192.168.8.120: The executor with id 148 was deleted by a user or the framework.
19/10/03 19:33:44 ERROR TaskSchedulerImpl: Lost executor 65 on 192.168.13.143: The executor with id 65 was deleted by a user or the framework.
19/10/03 19:33:46 WARN TransportChannelHandler: Exception in connection from /192.168.28.212:59890
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:33:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.28.212:59890 is closed
19/10/03 19:33:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 432 from block manager BlockManagerId(239, 192.168.28.212, 42895, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:33:47 WARN TransportResponseHandler: Ignoring response for RPC 8319185236526829680 from /192.168.26.53:49076 (81 bytes) since it is not outstanding
19/10/03 19:33:47 WARN TransportChannelHandler: Exception in connection from /192.168.6.238:40298
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:33:47 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.6.238:40298 is closed
19/10/03 19:33:47 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 432 from block manager BlockManagerId(230, 192.168.6.238, 37109, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:33:48 WARN TransportChannelHandler: Exception in connection from /192.168.8.120:60406
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:33:48 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.8.120:60406 is closed
19/10/03 19:33:48 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 432 from block manager BlockManagerId(148, 192.168.8.120, 45955, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:33:49 WARN TransportChannelHandler: Exception in connection from /192.168.13.143:35760
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:33:49 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.13.143:35760 is closed
19/10/03 19:33:49 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 432 from block manager BlockManagerId(65, 192.168.13.143, 46217, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:34:26 WARN TaskSetManager: Lost task 11.0 in stage 225.3 (TID 498365, 192.168.37.35, executor 173): FetchFailed(BlockManagerId(180, 192.168.11.32, 43223, None), shuffleId=111, mapId=1212, reduceId=76, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.11.32:43223
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.11.32:43223
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.11.32:43223
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:34:44 WARN HeartbeatReceiver: Removing executor 98 with no recent heartbeats: 136394 ms exceeds timeout 120000 ms
19/10/03 19:34:44 ERROR TaskSchedulerImpl: Lost executor 98 on 192.168.6.128: Executor heartbeat timed out after 136394 ms
19/10/03 19:34:44 WARN TaskSetManager: Lost task 25.0 in stage 225.2 (TID 498064, 192.168.6.128, executor 98): ExecutorLostFailure (executor 98 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 136394 ms
19/10/03 19:34:44 WARN HeartbeatReceiver: Removing executor 227 with no recent heartbeats: 161228 ms exceeds timeout 120000 ms
19/10/03 19:34:44 ERROR TaskSchedulerImpl: Lost executor 227 on 192.168.0.109: Executor heartbeat timed out after 161228 ms
19/10/03 19:34:44 WARN TaskSetManager: Lost task 13.0 in stage 225.2 (TID 498052, 192.168.0.109, executor 227): ExecutorLostFailure (executor 227 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 161228 ms
19/10/03 19:34:44 WARN HeartbeatReceiver: Removing executor 190 with no recent heartbeats: 167091 ms exceeds timeout 120000 ms
19/10/03 19:34:44 ERROR TaskSchedulerImpl: Lost executor 190 on 192.168.62.157: Executor heartbeat timed out after 167091 ms
19/10/03 19:34:44 WARN TaskSetManager: Lost task 39.0 in stage 225.2 (TID 498078, 192.168.62.157, executor 190): ExecutorLostFailure (executor 190 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 167091 ms
19/10/03 19:34:44 WARN HeartbeatReceiver: Removing executor 217 with no recent heartbeats: 154608 ms exceeds timeout 120000 ms
19/10/03 19:34:44 ERROR TaskSchedulerImpl: Lost executor 217 on 192.168.31.198: Executor heartbeat timed out after 154608 ms
19/10/03 19:34:44 WARN TaskSetManager: Lost task 34.0 in stage 225.2 (TID 498073, 192.168.31.198, executor 217): ExecutorLostFailure (executor 217 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 154608 ms
19/10/03 19:34:44 WARN HeartbeatReceiver: Removing executor 228 with no recent heartbeats: 163514 ms exceeds timeout 120000 ms
19/10/03 19:34:44 ERROR TaskSchedulerImpl: Lost executor 228 on 192.168.27.0: Executor heartbeat timed out after 163514 ms
19/10/03 19:34:44 WARN TaskSetManager: Lost task 45.0 in stage 225.2 (TID 498084, 192.168.27.0, executor 228): ExecutorLostFailure (executor 228 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 163514 ms
19/10/03 19:34:44 ERROR TaskSchedulerImpl: Lost executor 98 on 192.168.6.128: The executor with id 98 was deleted by a user or the framework.
19/10/03 19:34:44 ERROR TaskSchedulerImpl: Lost executor 227 on 192.168.0.109: The executor with id 227 was deleted by a user or the framework.
19/10/03 19:34:44 ERROR TaskSchedulerImpl: Lost executor 190 on 192.168.62.157: The executor with id 190 was deleted by a user or the framework.
19/10/03 19:34:44 ERROR TaskSchedulerImpl: Lost executor 217 on 192.168.31.198: The executor with id 217 was deleted by a user or the framework.
19/10/03 19:34:44 ERROR TaskSchedulerImpl: Lost executor 228 on 192.168.27.0: The executor with id 228 was deleted by a user or the framework.
19/10/03 19:34:46 WARN TransportChannelHandler: Exception in connection from /192.168.6.128:36570
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:34:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.6.128:36570 is closed
19/10/03 19:34:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 432 from block manager BlockManagerId(98, 192.168.6.128, 44895, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:34:46 WARN TransportChannelHandler: Exception in connection from /192.168.62.157:47586
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:34:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.62.157:47586 is closed
19/10/03 19:34:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 432 from block manager BlockManagerId(190, 192.168.62.157, 40867, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:34:46 WARN TransportChannelHandler: Exception in connection from /192.168.31.198:41874
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:34:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.31.198:41874 is closed
19/10/03 19:34:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 432 from block manager BlockManagerId(217, 192.168.31.198, 46769, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:34:47 WARN TransportChannelHandler: Exception in connection from /192.168.0.109:41976
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:34:47 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.0.109:41976 is closed
19/10/03 19:34:47 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 432 from block manager BlockManagerId(227, 192.168.0.109, 44083, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:34:48 ERROR ContextCleaner: Error cleaning broadcast 432
org.apache.spark.rpc.RpcTimeoutException: Futures timed out after [120 seconds]. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:76)
	at org.apache.spark.storage.BlockManagerMaster.removeBroadcast(BlockManagerMaster.scala:155)
	at org.apache.spark.broadcast.TorrentBroadcast$.unpersist(TorrentBroadcast.scala:321)
	at org.apache.spark.broadcast.TorrentBroadcastFactory.unbroadcast(TorrentBroadcastFactory.scala:45)
	at org.apache.spark.broadcast.BroadcastManager.unbroadcast(BroadcastManager.scala:66)
	at org.apache.spark.ContextCleaner.doCleanupBroadcast(ContextCleaner.scala:238)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:194)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:185)
	at scala.Option.foreach(Option.scala:257)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1.apply$mcV$sp(ContextCleaner.scala:185)
	at org.apache.spark.util.Utils$.tryOrStopSparkContext(Utils.scala:1302)
	at org.apache.spark.ContextCleaner.org$apache$spark$ContextCleaner$$keepCleaning(ContextCleaner.scala:178)
	at org.apache.spark.ContextCleaner$$anon$1.run(ContextCleaner.scala:73)
Caused by: java.util.concurrent.TimeoutException: Futures timed out after [120 seconds]
	at scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:223)
	at scala.concurrent.impl.Promise$DefaultPromise.result(Promise.scala:227)
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:220)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:75)
	... 12 more
19/10/03 19:34:48 WARN BlockManagerMaster: Failed to remove broadcast 432 with removeFromMaster = true - Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
org.apache.spark.rpc.RpcTimeoutException: Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at scala.util.Failure$$anonfun$recover$1.apply(Try.scala:216)
	at scala.util.Try$.apply(Try.scala:192)
	at scala.util.Failure.recover(Try.scala:216)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at org.spark_project.guava.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:293)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$1.execute(ExecutionContextImpl.scala:136)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.complete(Promise.scala:55)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:157)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.processBatch$1(BatchingExecutor.scala:63)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply$mcV$sp(BatchingExecutor.scala:78)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:72)
	at scala.concurrent.BatchingExecutor$Batch.run(BatchingExecutor.scala:54)
	at scala.concurrent.Future$InternalCallbackExecutor$.unbatchedExecute(Future.scala:601)
	at scala.concurrent.BatchingExecutor$class.execute(BatchingExecutor.scala:106)
	at scala.concurrent.Future$InternalCallbackExecutor$.execute(Future.scala:599)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.tryFailure(Promise.scala:112)
	at scala.concurrent.impl.Promise$DefaultPromise.tryFailure(Promise.scala:157)
	at org.apache.spark.rpc.netty.NettyRpcEnv.org$apache$spark$rpc$netty$NettyRpcEnv$$onFailure$1(NettyRpcEnv.scala:206)
	at org.apache.spark.rpc.netty.NettyRpcEnv$$anon$1.run(NettyRpcEnv.scala:243)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException: Cannot receive any reply from null in 120 seconds
	... 8 more
19/10/03 19:34:59 WARN TaskSetManager: Lost task 14.0 in stage 225.3 (TID 498368, 192.168.3.155, executor 169): FetchFailed(BlockManagerId(190, 192.168.62.157, 40867, None), shuffleId=111, mapId=1259, reduceId=83, message=
org.apache.spark.shuffle.FetchFailedException: Failed to connect to /192.168.62.157:40867
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.throwFetchFailedException(ShuffleBlockFetcherIterator.scala:554)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:485)
	at org.apache.spark.storage.ShuffleBlockFetcherIterator.next(ShuffleBlockFetcherIterator.scala:64)
	at scala.collection.Iterator$$anon$12.nextCur(Iterator.scala:435)
	at scala.collection.Iterator$$anon$12.hasNext(Iterator.scala:441)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.util.CompletionIterator.hasNext(CompletionIterator.scala:31)
	at org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.sort_addToSorter_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage11.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at org.apache.spark.sql.execution.RowIteratorFromScala.advanceNext(RowIterator.scala:83)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.advancedBufferedToRowWithNullFreeJoinKey(SortMergeJoinExec.scala:811)
	at org.apache.spark.sql.execution.joins.SortMergeJoinScanner.<init>(SortMergeJoinExec.scala:686)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1$$anon$2.<init>(SortMergeJoinExec.scala:261)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:259)
	at org.apache.spark.sql.execution.joins.SortMergeJoinExec$$anonfun$doExecute$1.apply(SortMergeJoinExec.scala:150)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.io.IOException: Failed to connect to /192.168.62.157:40867
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:245)
	at org.apache.spark.network.client.TransportClientFactory.createClient(TransportClientFactory.java:187)
	at org.apache.spark.network.netty.NettyBlockTransferService$$anon$2.createAndStart(NettyBlockTransferService.scala:114)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.fetchAllOutstanding(RetryingBlockFetcher.java:141)
	at org.apache.spark.network.shuffle.RetryingBlockFetcher.lambda$initiateRetry$0(RetryingBlockFetcher.java:169)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	... 1 more
Caused by: io.netty.channel.AbstractChannel$AnnotatedNoRouteToHostException: Host is unreachable: /192.168.62.157:40867
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)
	at io.netty.channel.socket.nio.NioSocketChannel.doFinishConnect(NioSocketChannel.java:323)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.finishConnect(AbstractNioChannel.java:340)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:633)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	... 2 more
Caused by: java.net.NoRouteToHostException: Host is unreachable
	... 11 more

)
19/10/03 19:35:22 WARN TransportResponseHandler: Ignoring response for RPC 7115217994403662000 from /192.168.62.155:47924 (81 bytes) since it is not outstanding
19/10/03 19:35:23 WARN TransportChannelHandler: Exception in connection from /192.168.27.0:58488
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:35:25 WARN TransportResponseHandler: Ignoring response for RPC 7020311215832448665 from /192.168.14.254:35030 (81 bytes) since it is not outstanding
19/10/03 19:35:41 WARN TransportResponseHandler: Ignoring response for RPC 7104973429852804570 from /192.168.26.53:49076 (81 bytes) since it is not outstanding
19/10/03 19:35:44 WARN HeartbeatReceiver: Removing executor 224 with no recent heartbeats: 136592 ms exceeds timeout 120000 ms
19/10/03 19:35:44 ERROR TaskSchedulerImpl: Lost executor 224 on 192.168.26.109: Executor heartbeat timed out after 136592 ms
19/10/03 19:35:44 WARN TaskSetManager: Lost task 30.0 in stage 225.2 (TID 498069, 192.168.26.109, executor 224): ExecutorLostFailure (executor 224 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 136592 ms
19/10/03 19:35:44 WARN BlockManagerMasterEndpoint: No more replicas available for broadcast_426_piece0 !
19/10/03 19:35:44 ERROR TaskSchedulerImpl: Lost executor 224 on 192.168.26.109: The executor with id 224 was deleted by a user or the framework.
19/10/03 19:35:47 WARN TransportChannelHandler: Exception in connection from /192.168.26.109:37390
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:35:47 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.26.109:37390 is closed
19/10/03 19:35:47 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 437 from block manager BlockManagerId(224, 192.168.26.109, 42603, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:36:07 WARN TransportResponseHandler: Ignoring response for RPC 9019008084057164109 from /192.168.47.240:59456 (81 bytes) since it is not outstanding
19/10/03 19:36:44 WARN HeartbeatReceiver: Removing executor 209 with no recent heartbeats: 171741 ms exceeds timeout 120000 ms
19/10/03 19:36:44 ERROR TaskSchedulerImpl: Lost executor 209 on 192.168.47.240: Executor heartbeat timed out after 171741 ms
19/10/03 19:36:44 WARN TaskSetManager: Lost task 29.0 in stage 225.2 (TID 498068, 192.168.47.240, executor 209): ExecutorLostFailure (executor 209 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 171741 ms
19/10/03 19:36:44 WARN HeartbeatReceiver: Removing executor 183 with no recent heartbeats: 122655 ms exceeds timeout 120000 ms
19/10/03 19:36:44 ERROR TaskSchedulerImpl: Lost executor 183 on 192.168.20.174: Executor heartbeat timed out after 122655 ms
19/10/03 19:36:44 WARN TaskSetManager: Lost task 26.0 in stage 225.2 (TID 498065, 192.168.20.174, executor 183): ExecutorLostFailure (executor 183 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 122655 ms
19/10/03 19:36:44 ERROR TaskSchedulerImpl: Lost executor 209 on 192.168.47.240: The executor with id 209 was deleted by a user or the framework.
19/10/03 19:36:44 ERROR TaskSchedulerImpl: Lost executor 183 on 192.168.20.174: The executor with id 183 was deleted by a user or the framework.
19/10/03 19:36:46 WARN TransportChannelHandler: Exception in connection from /192.168.20.174:51874
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:36:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.20.174:51874 is closed
19/10/03 19:36:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 437 from block manager BlockManagerId(183, 192.168.20.174, 45397, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:36:46 WARN TransportChannelHandler: Exception in connection from /192.168.47.240:59456
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:36:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.47.240:59456 is closed
19/10/03 19:36:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 437 from block manager BlockManagerId(209, 192.168.47.240, 37029, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:36:48 ERROR ContextCleaner: Error cleaning broadcast 437
org.apache.spark.rpc.RpcTimeoutException: Futures timed out after [120 seconds]. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:76)
	at org.apache.spark.storage.BlockManagerMaster.removeBroadcast(BlockManagerMaster.scala:155)
	at org.apache.spark.broadcast.TorrentBroadcast$.unpersist(TorrentBroadcast.scala:321)
	at org.apache.spark.broadcast.TorrentBroadcastFactory.unbroadcast(TorrentBroadcastFactory.scala:45)
	at org.apache.spark.broadcast.BroadcastManager.unbroadcast(BroadcastManager.scala:66)
	at org.apache.spark.ContextCleaner.doCleanupBroadcast(ContextCleaner.scala:238)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:194)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:185)
	at scala.Option.foreach(Option.scala:257)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1.apply$mcV$sp(ContextCleaner.scala:185)
	at org.apache.spark.util.Utils$.tryOrStopSparkContext(Utils.scala:1302)
	at org.apache.spark.ContextCleaner.org$apache$spark$ContextCleaner$$keepCleaning(ContextCleaner.scala:178)
	at org.apache.spark.ContextCleaner$$anon$1.run(ContextCleaner.scala:73)
Caused by: java.util.concurrent.TimeoutException: Futures timed out after [120 seconds]
	at scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:223)
	at scala.concurrent.impl.Promise$DefaultPromise.result(Promise.scala:227)
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:220)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:75)
	... 12 more
19/10/03 19:36:48 WARN BlockManagerMaster: Failed to remove broadcast 437 with removeFromMaster = true - Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
org.apache.spark.rpc.RpcTimeoutException: Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at scala.util.Failure$$anonfun$recover$1.apply(Try.scala:216)
	at scala.util.Try$.apply(Try.scala:192)
	at scala.util.Failure.recover(Try.scala:216)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at org.spark_project.guava.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:293)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$1.execute(ExecutionContextImpl.scala:136)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.complete(Promise.scala:55)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:157)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.processBatch$1(BatchingExecutor.scala:63)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply$mcV$sp(BatchingExecutor.scala:78)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:72)
	at scala.concurrent.BatchingExecutor$Batch.run(BatchingExecutor.scala:54)
	at scala.concurrent.Future$InternalCallbackExecutor$.unbatchedExecute(Future.scala:601)
	at scala.concurrent.BatchingExecutor$class.execute(BatchingExecutor.scala:106)
	at scala.concurrent.Future$InternalCallbackExecutor$.execute(Future.scala:599)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.tryFailure(Promise.scala:112)
	at scala.concurrent.impl.Promise$DefaultPromise.tryFailure(Promise.scala:157)
	at org.apache.spark.rpc.netty.NettyRpcEnv.org$apache$spark$rpc$netty$NettyRpcEnv$$onFailure$1(NettyRpcEnv.scala:206)
	at org.apache.spark.rpc.netty.NettyRpcEnv$$anon$1.run(NettyRpcEnv.scala:243)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException: Cannot receive any reply from null in 120 seconds
	... 8 more
19/10/03 19:36:59 WARN TaskSetManager: Lost task 41.1 in stage 225.2 (TID 498088, 192.168.55.240, executor 222): FetchFailed(null, shuffleId=110, mapId=-1, reduceId=168, message=
org.apache.spark.shuffle.MetadataFetchFailedException: Missing an output location for shuffle 110
	at org.apache.spark.MapOutputTracker$$anonfun$convertMapStatuses$2.apply(MapOutputTracker.scala:882)
	at org.apache.spark.MapOutputTracker$$anonfun$convertMapStatuses$2.apply(MapOutputTracker.scala:878)
	at scala.collection.Iterator$class.foreach(Iterator.scala:891)
	at scala.collection.AbstractIterator.foreach(Iterator.scala:1334)
	at org.apache.spark.MapOutputTracker$.convertMapStatuses(MapOutputTracker.scala:878)
	at org.apache.spark.MapOutputTrackerWorker.getMapSizesByExecutorId(MapOutputTracker.scala:691)
	at org.apache.spark.shuffle.BlockStoreShuffleReader.read(BlockStoreShuffleReader.scala:49)
	at org.apache.spark.sql.execution.ShuffledRowRDD.compute(ShuffledRowRDD.scala:165)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.ZippedPartitionsRDD2.compute(ZippedPartitionsRDD.scala:89)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:288)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)

)
19/10/03 19:37:44 WARN HeartbeatReceiver: Removing executor 151 with no recent heartbeats: 138772 ms exceeds timeout 120000 ms
19/10/03 19:37:44 ERROR TaskSchedulerImpl: Lost executor 151 on 192.168.14.254: Executor heartbeat timed out after 138772 ms
19/10/03 19:37:44 WARN TaskSetManager: Lost task 10.0 in stage 225.2 (TID 498049, 192.168.14.254, executor 151): ExecutorLostFailure (executor 151 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 138772 ms
19/10/03 19:37:44 WARN HeartbeatReceiver: Removing executor 198 with no recent heartbeats: 122859 ms exceeds timeout 120000 ms
19/10/03 19:37:44 ERROR TaskSchedulerImpl: Lost executor 198 on 192.168.26.53: Executor heartbeat timed out after 122859 ms
19/10/03 19:37:44 WARN TaskSetManager: Lost task 43.0 in stage 225.2 (TID 498082, 192.168.26.53, executor 198): ExecutorLostFailure (executor 198 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 122859 ms
19/10/03 19:37:44 WARN HeartbeatReceiver: Removing executor 186 with no recent heartbeats: 150858 ms exceeds timeout 120000 ms
19/10/03 19:37:44 ERROR TaskSchedulerImpl: Lost executor 186 on 192.168.24.230: Executor heartbeat timed out after 150858 ms
19/10/03 19:37:44 WARN TaskSetManager: Lost task 37.0 in stage 225.2 (TID 498076, 192.168.24.230, executor 186): ExecutorLostFailure (executor 186 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 150858 ms
19/10/03 19:37:45 ERROR TaskSchedulerImpl: Lost executor 151 on 192.168.14.254: The executor with id 151 was deleted by a user or the framework.
19/10/03 19:37:45 ERROR TaskSchedulerImpl: Lost executor 198 on 192.168.26.53: The executor with id 198 was deleted by a user or the framework.
19/10/03 19:37:45 ERROR TaskSchedulerImpl: Lost executor 186 on 192.168.24.230: The executor with id 186 was deleted by a user or the framework.
19/10/03 19:37:46 WARN TransportChannelHandler: Exception in connection from /192.168.14.254:35030
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:37:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.14.254:35030 is closed
19/10/03 19:37:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 429 from block manager BlockManagerId(151, 192.168.14.254, 38399, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:37:46 WARN TransportChannelHandler: Exception in connection from /192.168.26.53:49076
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:37:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.26.53:49076 is closed
19/10/03 19:37:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 429 from block manager BlockManagerId(198, 192.168.26.53, 36865, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:37:46 WARN TransportChannelHandler: Exception in connection from /192.168.24.230:44708
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:37:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.24.230:44708 is closed
19/10/03 19:37:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 429 from block manager BlockManagerId(186, 192.168.24.230, 35075, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:38:48 ERROR ContextCleaner: Error cleaning broadcast 429
org.apache.spark.rpc.RpcTimeoutException: Futures timed out after [120 seconds]. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:76)
	at org.apache.spark.storage.BlockManagerMaster.removeBroadcast(BlockManagerMaster.scala:155)
	at org.apache.spark.broadcast.TorrentBroadcast$.unpersist(TorrentBroadcast.scala:321)
	at org.apache.spark.broadcast.TorrentBroadcastFactory.unbroadcast(TorrentBroadcastFactory.scala:45)
	at org.apache.spark.broadcast.BroadcastManager.unbroadcast(BroadcastManager.scala:66)
	at org.apache.spark.ContextCleaner.doCleanupBroadcast(ContextCleaner.scala:238)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:194)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1$$anonfun$apply$mcV$sp$1.apply(ContextCleaner.scala:185)
	at scala.Option.foreach(Option.scala:257)
	at org.apache.spark.ContextCleaner$$anonfun$org$apache$spark$ContextCleaner$$keepCleaning$1.apply$mcV$sp(ContextCleaner.scala:185)
	at org.apache.spark.util.Utils$.tryOrStopSparkContext(Utils.scala:1302)
	at org.apache.spark.ContextCleaner.org$apache$spark$ContextCleaner$$keepCleaning(ContextCleaner.scala:178)
	at org.apache.spark.ContextCleaner$$anon$1.run(ContextCleaner.scala:73)
Caused by: java.util.concurrent.TimeoutException: Futures timed out after [120 seconds]
	at scala.concurrent.impl.Promise$DefaultPromise.ready(Promise.scala:223)
	at scala.concurrent.impl.Promise$DefaultPromise.result(Promise.scala:227)
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:220)
	at org.apache.spark.rpc.RpcTimeout.awaitResult(RpcTimeout.scala:75)
	... 12 more
19/10/03 19:38:48 WARN BlockManagerMaster: Failed to remove broadcast 429 with removeFromMaster = true - Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
org.apache.spark.rpc.RpcTimeoutException: Cannot receive any reply from null in 120 seconds. This timeout is controlled by spark.rpc.askTimeout
	at org.apache.spark.rpc.RpcTimeout.org$apache$spark$rpc$RpcTimeout$$createRpcTimeoutException(RpcTimeout.scala:47)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:62)
	at org.apache.spark.rpc.RpcTimeout$$anonfun$addMessageIfTimeout$1.applyOrElse(RpcTimeout.scala:58)
	at scala.runtime.AbstractPartialFunction.apply(AbstractPartialFunction.scala:36)
	at scala.util.Failure$$anonfun$recover$1.apply(Try.scala:216)
	at scala.util.Try$.apply(Try.scala:192)
	at scala.util.Failure.recover(Try.scala:216)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.Future$$anonfun$recover$1.apply(Future.scala:326)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at org.spark_project.guava.util.concurrent.MoreExecutors$SameThreadExecutorService.execute(MoreExecutors.java:293)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$1.execute(ExecutionContextImpl.scala:136)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.complete(Promise.scala:55)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:157)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.Future$$anonfun$map$1.apply(Future.scala:237)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:36)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.processBatch$1(BatchingExecutor.scala:63)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply$mcV$sp(BatchingExecutor.scala:78)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BatchingExecutor$Batch$$anonfun$run$1.apply(BatchingExecutor.scala:55)
	at scala.concurrent.BlockContext$.withBlockContext(BlockContext.scala:72)
	at scala.concurrent.BatchingExecutor$Batch.run(BatchingExecutor.scala:54)
	at scala.concurrent.Future$InternalCallbackExecutor$.unbatchedExecute(Future.scala:601)
	at scala.concurrent.BatchingExecutor$class.execute(BatchingExecutor.scala:106)
	at scala.concurrent.Future$InternalCallbackExecutor$.execute(Future.scala:599)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:44)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:252)
	at scala.concurrent.Promise$class.tryFailure(Promise.scala:112)
	at scala.concurrent.impl.Promise$DefaultPromise.tryFailure(Promise.scala:157)
	at org.apache.spark.rpc.netty.NettyRpcEnv.org$apache$spark$rpc$netty$NettyRpcEnv$$onFailure$1(NettyRpcEnv.scala:206)
	at org.apache.spark.rpc.netty.NettyRpcEnv$$anon$1.run(NettyRpcEnv.scala:243)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.util.concurrent.TimeoutException: Cannot receive any reply from null in 120 seconds
	... 8 more
19/10/03 19:39:44 WARN HeartbeatReceiver: Removing executor 234 with no recent heartbeats: 127349 ms exceeds timeout 120000 ms
19/10/03 19:39:44 ERROR TaskSchedulerImpl: Lost executor 234 on 192.168.62.155: Executor heartbeat timed out after 127349 ms
19/10/03 19:39:44 WARN TaskSetManager: Lost task 40.0 in stage 225.2 (TID 498079, 192.168.62.155, executor 234): ExecutorLostFailure (executor 234 exited caused by one of the running tasks) Reason: Executor heartbeat timed out after 127349 ms
19/10/03 19:39:45 ERROR TaskSchedulerImpl: Lost executor 234 on 192.168.62.155: The executor with id 234 was deleted by a user or the framework.
19/10/03 19:39:46 WARN TransportChannelHandler: Exception in connection from /192.168.62.155:47924
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
19/10/03 19:39:46 ERROR TransportResponseHandler: Still have 1 requests outstanding when connection from /192.168.62.155:47924 is closed
19/10/03 19:39:46 WARN BlockManagerMasterEndpoint: Error trying to remove broadcast 428 from block manager BlockManagerId(234, 192.168.62.155, 40271, None)
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:380)
	at io.netty.buffer.PooledUnsafeDirectByteBuf.setBytes(PooledUnsafeDirectByteBuf.java:288)
	at io.netty.buffer.AbstractByteBuf.writeBytes(AbstractByteBuf.java:1106)
	at io.netty.channel.socket.nio.NioSocketChannel.doReadBytes(NioSocketChannel.java:343)
	at io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:123)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:645)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:580)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:497)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:459)
	at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:858)
	at io.netty.util.concurrent.DefaultThreadFactory$DefaultRunnableDecorator.run(DefaultThreadFactory.java:138)
	at java.lang.Thread.run(Thread.java:748)
Execution time: 591.053319881s
Running execution q16-v2.4 iteration: 1, StandardRun=true
19/10/03 19:42:01 INFO Query: 
== Query: q16-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [order count#12489L, total shipping cost#12490, total net profit#12491]
      +- Sort [order count#12489L ASC NULLS FIRST], true
         +- Aggregate [count(distinct cs_order_number#17L) AS order count#12489L, sum(cs_ext_ship_cost#28) AS total shipping cost#12490, sum(cs_net_profit#33) AS total net profit#12491]
            +- Filter (((((d_date#494 >= cast(2002-02-01 as date)) && (d_date#494 <= cast(cast(cast(2002-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))) && (cs_ship_date_sk#2 = d_date_sk#492)) && ((cs_ship_addr_sk#10 = ca_address_sk#448) && (ca_state#456 = GA))) && (((cs_call_center_sk#11 = cc_call_center_sk#332) && cc_county#357 IN (Williamson County,Williamson County,Williamson County,Williamson County,Williamson County)) && (exists#12492 [cs_order_number#17L && cs_warehouse_sk#14] && NOT exists#12493 [cs_order_number#17L])))
               :  :- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 10 more fields]
               :  :  +- Filter ((outer(cs_order_number#17L) = cs_order_number#17L) && NOT (outer(cs_warehouse_sk#14) = cs_warehouse_sk#14))
               :  :     +- SubqueryAlias `cs2`
               :  :        +- SubqueryAlias `catalog_sales`
               :  :           +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  +- Project [cr_returned_date_sk#68, cr_returned_time_sk#69, cr_item_sk#70, cr_refunded_customer_sk#71, cr_refunded_cdemo_sk#72, cr_refunded_hdemo_sk#73, cr_refunded_addr_sk#74, cr_returning_customer_sk#75, cr_returning_cdemo_sk#76, cr_returning_hdemo_sk#77, cr_returning_addr_sk#78, cr_call_center_sk#79, cr_catalog_page_sk#80, cr_ship_mode_sk#81, cr_warehouse_sk#82, cr_reason_sk#83, cr_order_number#84L, cr_return_quantity#85, cr_return_amount#86, cr_return_tax#87, cr_return_amt_inc_tax#88, cr_fee#89, cr_return_ship_cost#90, cr_refunded_cash#91, ... 3 more fields]
               :     +- Filter (outer(cs_order_number#17L) = cr_order_number#84L)
               :        +- SubqueryAlias `cr1`
               :           +- SubqueryAlias `catalog_returns`
               :              +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `cs1`
                  :  :  :  +- SubqueryAlias `catalog_sales`
                  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `call_center`
                     +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet

     : benchmark
19/10/03 19:42:01 INFO Query: 
== Query: q16-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [order count#12502L, total shipping cost#12503, total net profit#12504]
      +- Sort [order count#12502L ASC NULLS FIRST], true
         +- Aggregate [count(distinct cs_order_number#17L) AS order count#12502L, sum(cs_ext_ship_cost#28) AS total shipping cost#12503, sum(cs_net_profit#33) AS total net profit#12504]
            +- Filter (((((d_date#494 >= cast(2002-02-01 as date)) && (d_date#494 <= cast(cast(cast(2002-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))) && (cs_ship_date_sk#2 = d_date_sk#492)) && ((cs_ship_addr_sk#10 = ca_address_sk#448) && (ca_state#456 = GA))) && (((cs_call_center_sk#11 = cc_call_center_sk#332) && cc_county#357 IN (Williamson County,Williamson County,Williamson County,Williamson County,Williamson County)) && (exists#12505 [cs_order_number#17L && cs_warehouse_sk#14] && NOT exists#12506 [cs_order_number#17L])))
               :  :- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 10 more fields]
               :  :  +- Filter ((outer(cs_order_number#17L) = cs_order_number#17L) && NOT (outer(cs_warehouse_sk#14) = cs_warehouse_sk#14))
               :  :     +- SubqueryAlias `cs2`
               :  :        +- SubqueryAlias `catalog_sales`
               :  :           +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  +- Project [cr_returned_date_sk#68, cr_returned_time_sk#69, cr_item_sk#70, cr_refunded_customer_sk#71, cr_refunded_cdemo_sk#72, cr_refunded_hdemo_sk#73, cr_refunded_addr_sk#74, cr_returning_customer_sk#75, cr_returning_cdemo_sk#76, cr_returning_hdemo_sk#77, cr_returning_addr_sk#78, cr_call_center_sk#79, cr_catalog_page_sk#80, cr_ship_mode_sk#81, cr_warehouse_sk#82, cr_reason_sk#83, cr_order_number#84L, cr_return_quantity#85, cr_return_amount#86, cr_return_tax#87, cr_return_amt_inc_tax#88, cr_fee#89, cr_return_ship_cost#90, cr_refunded_cash#91, ... 3 more fields]
               :     +- Filter (outer(cs_order_number#17L) = cr_order_number#84L)
               :        +- SubqueryAlias `cr1`
               :           +- SubqueryAlias `catalog_returns`
               :              +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `cs1`
                  :  :  :  +- SubqueryAlias `catalog_sales`
                  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `call_center`
                     +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 833.761417844s
Running execution q17-v2.4 iteration: 1, StandardRun=true
19/10/03 19:55:57 INFO Query: 
== Query: q17-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, s_state#688 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, s_state#688], [i_item_id#565, i_item_desc#568, s_state#688, count(ss_quantity#140) AS store_sales_quantitycount#12893L, avg(cast(ss_quantity#140 as bigint)) AS store_sales_quantityave#12894, stddev_samp(cast(ss_quantity#140 as double)) AS store_sales_quantitystdev#12895, (stddev_samp(cast(ss_quantity#140 as double)) / avg(cast(ss_quantity#140 as bigint))) AS store_sales_quantitycov#12896, count(sr_return_quantity#186) AS as_store_returns_quantitycount#12897L, avg(cast(sr_return_quantity#186 as bigint)) AS as_store_returns_quantityave#12898, stddev_samp(cast(sr_return_quantity#186 as double)) AS as_store_returns_quantitystdev#12899, (stddev_samp(cast(sr_return_quantity#186 as double)) / avg(cast(sr_return_quantity#186 as bigint))) AS store_returns_quantitycov#12900, count(cs_quantity#18) AS catalog_sales_quantitycount#12901L, avg(cast(cs_quantity#18 as bigint)) AS catalog_sales_quantityave#12902, (stddev_samp(cast(cs_quantity#18 as double)) / avg(cast(cs_quantity#18 as bigint))) AS catalog_sales_quantitystdev#12903, (stddev_samp(cast(cs_quantity#18 as double)) / avg(cast(cs_quantity#18 as bigint))) AS catalog_sales_quantitycov#12904]
         +- Filter (((((d_quarter_name#507 = 2001Q1) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((i_item_sk#564 = ss_item_sk#132) && (s_store_sk#664 = ss_store_sk#137))) && (((ss_customer_sk#133 = sr_customer_sk#179) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L))) && ((((sr_returned_date_sk#176 = d_date_sk#12905) && d_quarter_name#12920 IN (2001Q1,2001Q2,2001Q3)) && (sr_customer_sk#179 = cs_bill_customer_sk#3)) && (((sr_item_sk#178 = cs_item_sk#15) && (cs_sold_date_sk#0 = d_date_sk#12933)) && d_quarter_name#12948 IN (2001Q1,2001Q2,2001Q3))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- Join Inner
               :  :  :  :- Join Inner
               :  :  :  :  :- Join Inner
               :  :  :  :  :  :- Join Inner
               :  :  :  :  :  :  :- SubqueryAlias `store_sales`
               :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  :  :  :  +- SubqueryAlias `store_returns`
               :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :  :  :  :  :  +- SubqueryAlias `catalog_sales`
               :  :  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :  +- SubqueryAlias `d1`
               :  :  :  :     +- SubqueryAlias `date_dim`
               :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  +- SubqueryAlias `d2`
               :  :  :     +- SubqueryAlias `date_dim`
               :  :  :        +- Relation[d_date_sk#12905,d_date_id#12906,d_date#12907,d_month_seq#12908,d_week_seq#12909,d_quarter_seq#12910,d_year#12911,d_dow#12912,d_moy#12913,d_dom#12914,d_qoy#12915,d_fy_year#12916,d_fy_quarter_seq#12917,d_fy_week_seq#12918,d_day_name#12919,d_quarter_name#12920,d_holiday#12921,d_weekend#12922,d_following_holiday#12923,d_first_dom#12924,d_last_dom#12925,d_same_day_ly#12926,d_same_day_lq#12927,d_current_day#12928,... 4 more fields] parquet
               :  :  +- SubqueryAlias `d3`
               :  :     +- SubqueryAlias `date_dim`
               :  :        +- Relation[d_date_sk#12933,d_date_id#12934,d_date#12935,d_month_seq#12936,d_week_seq#12937,d_quarter_seq#12938,d_year#12939,d_dow#12940,d_moy#12941,d_dom#12942,d_qoy#12943,d_fy_year#12944,d_fy_quarter_seq#12945,d_fy_week_seq#12946,d_day_name#12947,d_quarter_name#12948,d_holiday#12949,d_weekend#12950,d_following_holiday#12951,d_first_dom#12952,d_last_dom#12953,d_same_day_ly#12954,d_same_day_lq#12955,d_current_day#12956,... 4 more fields] parquet
               :  +- SubqueryAlias `store`
               :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/03 19:55:57 INFO Query: 
== Query: q17-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, s_state#688 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, s_state#688], [i_item_id#565, i_item_desc#568, s_state#688, count(ss_quantity#140) AS store_sales_quantitycount#13136L, avg(cast(ss_quantity#140 as bigint)) AS store_sales_quantityave#13137, stddev_samp(cast(ss_quantity#140 as double)) AS store_sales_quantitystdev#13138, (stddev_samp(cast(ss_quantity#140 as double)) / avg(cast(ss_quantity#140 as bigint))) AS store_sales_quantitycov#13139, count(sr_return_quantity#186) AS as_store_returns_quantitycount#13140L, avg(cast(sr_return_quantity#186 as bigint)) AS as_store_returns_quantityave#13141, stddev_samp(cast(sr_return_quantity#186 as double)) AS as_store_returns_quantitystdev#13142, (stddev_samp(cast(sr_return_quantity#186 as double)) / avg(cast(sr_return_quantity#186 as bigint))) AS store_returns_quantitycov#13143, count(cs_quantity#18) AS catalog_sales_quantitycount#13144L, avg(cast(cs_quantity#18 as bigint)) AS catalog_sales_quantityave#13145, (stddev_samp(cast(cs_quantity#18 as double)) / avg(cast(cs_quantity#18 as bigint))) AS catalog_sales_quantitystdev#13146, (stddev_samp(cast(cs_quantity#18 as double)) / avg(cast(cs_quantity#18 as bigint))) AS catalog_sales_quantitycov#13147]
         +- Filter (((((d_quarter_name#507 = 2001Q1) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((i_item_sk#564 = ss_item_sk#132) && (s_store_sk#664 = ss_store_sk#137))) && (((ss_customer_sk#133 = sr_customer_sk#179) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L))) && ((((sr_returned_date_sk#176 = d_date_sk#13148) && d_quarter_name#13163 IN (2001Q1,2001Q2,2001Q3)) && (sr_customer_sk#179 = cs_bill_customer_sk#3)) && (((sr_item_sk#178 = cs_item_sk#15) && (cs_sold_date_sk#0 = d_date_sk#13176)) && d_quarter_name#13191 IN (2001Q1,2001Q2,2001Q3))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- Join Inner
               :  :  :  :- Join Inner
               :  :  :  :  :- Join Inner
               :  :  :  :  :  :- Join Inner
               :  :  :  :  :  :  :- SubqueryAlias `store_sales`
               :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  :  :  :  +- SubqueryAlias `store_returns`
               :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :  :  :  :  :  +- SubqueryAlias `catalog_sales`
               :  :  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :  +- SubqueryAlias `d1`
               :  :  :  :     +- SubqueryAlias `date_dim`
               :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  +- SubqueryAlias `d2`
               :  :  :     +- SubqueryAlias `date_dim`
               :  :  :        +- Relation[d_date_sk#13148,d_date_id#13149,d_date#13150,d_month_seq#13151,d_week_seq#13152,d_quarter_seq#13153,d_year#13154,d_dow#13155,d_moy#13156,d_dom#13157,d_qoy#13158,d_fy_year#13159,d_fy_quarter_seq#13160,d_fy_week_seq#13161,d_day_name#13162,d_quarter_name#13163,d_holiday#13164,d_weekend#13165,d_following_holiday#13166,d_first_dom#13167,d_last_dom#13168,d_same_day_ly#13169,d_same_day_lq#13170,d_current_day#13171,... 4 more fields] parquet
               :  :  +- SubqueryAlias `d3`
               :  :     +- SubqueryAlias `date_dim`
               :  :        +- Relation[d_date_sk#13176,d_date_id#13177,d_date#13178,d_month_seq#13179,d_week_seq#13180,d_quarter_seq#13181,d_year#13182,d_dow#13183,d_moy#13184,d_dom#13185,d_qoy#13186,d_fy_year#13187,d_fy_quarter_seq#13188,d_fy_week_seq#13189,d_day_name#13190,d_quarter_name#13191,d_holiday#13192,d_weekend#13193,d_following_holiday#13194,d_first_dom#13195,d_last_dom#13196,d_same_day_ly#13197,d_same_day_lq#13198,d_current_day#13199,... 4 more fields] parquet
               :  +- SubqueryAlias `store`
               :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 1918.513243911s
Running execution q18-v2.4 iteration: 1, StandardRun=true
19/10/03 20:27:57 INFO Query: 
== Query: q18-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ca_country#14036 ASC NULLS FIRST, ca_state#14037 ASC NULLS FIRST, ca_county#14038 ASC NULLS FIRST, i_item_id#14035 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#14035, ca_country#14036, ca_state#14037, ca_county#14038, spark_grouping_id#14030], [i_item_id#14035, ca_country#14036, ca_state#14037, ca_county#14038, avg(cast(cs_quantity#18 as decimal(12,2))) AS agg1#14007, avg(cast(cs_list_price#20 as decimal(12,2))) AS agg2#14008, avg(cast(cs_coupon_amt#27 as decimal(12,2))) AS agg3#14009, avg(cast(cs_sales_price#21 as decimal(12,2))) AS agg4#14010, avg(cast(cs_net_profit#33 as decimal(12,2))) AS agg5#14011, avg(cast(c_birth_year#425 as decimal(12,2))) AS agg6#14012, avg(cast(cd_dep_count#480 as decimal(12,2))) AS agg7#14013]
         +- Expand [List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14014, cd_gender#14015, cd_marital_status#14016, cd_education_status#14017, cd_purchase_estimate#14018, cd_credit_rating#14019, cd_dep_count#14020, cd_dep_employed_count#14021, cd_dep_college_count#14022, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14031, ca_country#14032, ca_state#14033, ca_county#14034, 0), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14014, cd_gender#14015, cd_marital_status#14016, cd_education_status#14017, cd_purchase_estimate#14018, cd_credit_rating#14019, cd_dep_count#14020, cd_dep_employed_count#14021, cd_dep_college_count#14022, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14031, ca_country#14032, ca_state#14033, null, 1), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14014, cd_gender#14015, cd_marital_status#14016, cd_education_status#14017, cd_purchase_estimate#14018, cd_credit_rating#14019, cd_dep_count#14020, cd_dep_employed_count#14021, cd_dep_college_count#14022, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14031, ca_country#14032, null, null, 3), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14014, cd_gender#14015, cd_marital_status#14016, cd_education_status#14017, cd_purchase_estimate#14018, cd_credit_rating#14019, cd_dep_count#14020, cd_dep_employed_count#14021, cd_dep_college_count#14022, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14031, null, null, null, 7), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14014, cd_gender#14015, cd_marital_status#14016, cd_education_status#14017, cd_purchase_estimate#14018, cd_credit_rating#14019, cd_dep_count#14020, cd_dep_employed_count#14021, cd_dep_college_count#14022, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, null, null, 15)], [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 114 more fields]
            +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 113 more fields]
               +- Filter (((((cs_sold_date_sk#0 = d_date_sk#492) && (cs_item_sk#15 = i_item_sk#564)) && (cs_bill_cdemo_sk#4 = cd_demo_sk#474)) && (((cs_bill_customer_sk#3 = c_customer_sk#412) && (cd_gender#475 = F)) && (cd_education_status#477 = Unknown))) && ((((c_current_cdemo_sk#414 = cd_demo_sk#14014) && (c_current_addr_sk#416 = ca_address_sk#448)) && c_birth_month#424 IN (1,6,8,9,12,2)) && ((d_year#498 = 1998) && ca_state#456 IN (MS,IN,ND,OK,NM,VA,MS))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- Join Inner
                     :  :  :  :  :  :- SubqueryAlias `catalog_sales`
                     :  :  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :  :  :  :  :  +- SubqueryAlias `cd1`
                     :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                     :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                     :  :  :  :  +- SubqueryAlias `cd2`
                     :  :  :  :     +- SubqueryAlias `customer_demographics`
                     :  :  :  :        +- Relation[cd_demo_sk#14014,cd_gender#14015,cd_marital_status#14016,cd_education_status#14017,cd_purchase_estimate#14018,cd_credit_rating#14019,cd_dep_count#14020,cd_dep_employed_count#14021,cd_dep_college_count#14022] parquet
                     :  :  :  +- SubqueryAlias `customer`
                     :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     :  :  +- SubqueryAlias `customer_address`
                     :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                     :  +- SubqueryAlias `date_dim`
                     :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- SubqueryAlias `item`
                        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/03 20:27:57 INFO Query: 
== Query: q18-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ca_country#14083 ASC NULLS FIRST, ca_state#14084 ASC NULLS FIRST, ca_county#14085 ASC NULLS FIRST, i_item_id#14082 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#14082, ca_country#14083, ca_state#14084, ca_county#14085, spark_grouping_id#14077], [i_item_id#14082, ca_country#14083, ca_state#14084, ca_county#14085, avg(cast(cs_quantity#18 as decimal(12,2))) AS agg1#14054, avg(cast(cs_list_price#20 as decimal(12,2))) AS agg2#14055, avg(cast(cs_coupon_amt#27 as decimal(12,2))) AS agg3#14056, avg(cast(cs_sales_price#21 as decimal(12,2))) AS agg4#14057, avg(cast(cs_net_profit#33 as decimal(12,2))) AS agg5#14058, avg(cast(c_birth_year#425 as decimal(12,2))) AS agg6#14059, avg(cast(cd_dep_count#480 as decimal(12,2))) AS agg7#14060]
         +- Expand [List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14061, cd_gender#14062, cd_marital_status#14063, cd_education_status#14064, cd_purchase_estimate#14065, cd_credit_rating#14066, cd_dep_count#14067, cd_dep_employed_count#14068, cd_dep_college_count#14069, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14078, ca_country#14079, ca_state#14080, ca_county#14081, 0), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14061, cd_gender#14062, cd_marital_status#14063, cd_education_status#14064, cd_purchase_estimate#14065, cd_credit_rating#14066, cd_dep_count#14067, cd_dep_employed_count#14068, cd_dep_college_count#14069, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14078, ca_country#14079, ca_state#14080, null, 1), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14061, cd_gender#14062, cd_marital_status#14063, cd_education_status#14064, cd_purchase_estimate#14065, cd_credit_rating#14066, cd_dep_count#14067, cd_dep_employed_count#14068, cd_dep_college_count#14069, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14078, ca_country#14079, null, null, 3), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14061, cd_gender#14062, cd_marital_status#14063, cd_education_status#14064, cd_purchase_estimate#14065, cd_credit_rating#14066, cd_dep_count#14067, cd_dep_employed_count#14068, cd_dep_college_count#14069, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#14078, null, null, null, 7), List(cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, cs_ext_wholesale_cost#24, cs_ext_list_price#25, cs_ext_tax#26, cs_coupon_amt#27, cs_ext_ship_cost#28, cs_net_paid#29, cs_net_paid_inc_tax#30, cs_net_paid_inc_ship#31, cs_net_paid_inc_ship_tax#32, cs_net_profit#33, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, cd_demo_sk#14061, cd_gender#14062, cd_marital_status#14063, cd_education_status#14064, cd_purchase_estimate#14065, cd_credit_rating#14066, cd_dep_count#14067, cd_dep_employed_count#14068, cd_dep_college_count#14069, c_customer_sk#412, c_customer_id#413, c_current_cdemo_sk#414, c_current_hdemo_sk#415, c_current_addr_sk#416, c_first_shipto_date_sk#417, c_first_sales_date_sk#418, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ca_address_sk#448, ca_address_id#449, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, null, null, 15)], [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 114 more fields]
            +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 113 more fields]
               +- Filter (((((cs_sold_date_sk#0 = d_date_sk#492) && (cs_item_sk#15 = i_item_sk#564)) && (cs_bill_cdemo_sk#4 = cd_demo_sk#474)) && (((cs_bill_customer_sk#3 = c_customer_sk#412) && (cd_gender#475 = F)) && (cd_education_status#477 = Unknown))) && ((((c_current_cdemo_sk#414 = cd_demo_sk#14061) && (c_current_addr_sk#416 = ca_address_sk#448)) && c_birth_month#424 IN (1,6,8,9,12,2)) && ((d_year#498 = 1998) && ca_state#456 IN (MS,IN,ND,OK,NM,VA,MS))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- Join Inner
                     :  :  :  :  :  :- SubqueryAlias `catalog_sales`
                     :  :  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :  :  :  :  :  +- SubqueryAlias `cd1`
                     :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                     :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                     :  :  :  :  +- SubqueryAlias `cd2`
                     :  :  :  :     +- SubqueryAlias `customer_demographics`
                     :  :  :  :        +- Relation[cd_demo_sk#14061,cd_gender#14062,cd_marital_status#14063,cd_education_status#14064,cd_purchase_estimate#14065,cd_credit_rating#14066,cd_dep_count#14067,cd_dep_employed_count#14068,cd_dep_college_count#14069] parquet
                     :  :  :  +- SubqueryAlias `customer`
                     :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     :  :  +- SubqueryAlias `customer_address`
                     :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                     :  +- SubqueryAlias `date_dim`
                     :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- SubqueryAlias `item`
                        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 203.597169828s
Running execution q19-v2.4 iteration: 1, StandardRun=true
19/10/03 20:31:23 INFO Query: 
== Query: q19-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ext_price#14242 DESC NULLS LAST, brand#14241 ASC NULLS FIRST, brand_id#14240 ASC NULLS FIRST, i_manufact_id#577 ASC NULLS FIRST, i_manufact#578 ASC NULLS FIRST], true
      +- Aggregate [i_brand#572, i_brand_id#571, i_manufact_id#577, i_manufact#578], [i_brand_id#571 AS brand_id#14240, i_brand#572 AS brand#14241, i_manufact_id#577, i_manufact#578, sum(ss_ext_sales_price#145) AS ext_price#14242]
         +- Filter (((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 8)) && ((d_moy#500 = 11) && (d_year#498 = 1998))) && (((ss_customer_sk#133 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && (NOT (substring(ca_zip#457, 1, 5) = substring(s_zip#689, 1, 5)) && (ss_store_sk#137 = s_store_sk#664))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- Join Inner
               :  :  :  :- Join Inner
               :  :  :  :  :- SubqueryAlias `date_dim`
               :  :  :  :  :  +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  +- SubqueryAlias `store_sales`
               :  :  :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  +- SubqueryAlias `item`
               :  :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `customer`
               :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  +- SubqueryAlias `customer_address`
               :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `store`
                  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/10/03 20:31:23 INFO Query: 
== Query: q19-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ext_price#14256 DESC NULLS LAST, brand#14255 ASC NULLS FIRST, brand_id#14254 ASC NULLS FIRST, i_manufact_id#577 ASC NULLS FIRST, i_manufact#578 ASC NULLS FIRST], true
      +- Aggregate [i_brand#572, i_brand_id#571, i_manufact_id#577, i_manufact#578], [i_brand_id#571 AS brand_id#14254, i_brand#572 AS brand#14255, i_manufact_id#577, i_manufact#578, sum(ss_ext_sales_price#145) AS ext_price#14256]
         +- Filter (((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 8)) && ((d_moy#500 = 11) && (d_year#498 = 1998))) && (((ss_customer_sk#133 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && (NOT (substring(ca_zip#457, 1, 5) = substring(s_zip#689, 1, 5)) && (ss_store_sk#137 = s_store_sk#664))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- Join Inner
               :  :  :  :- Join Inner
               :  :  :  :  :- SubqueryAlias `date_dim`
               :  :  :  :  :  +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  :  +- SubqueryAlias `store_sales`
               :  :  :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :  +- SubqueryAlias `item`
               :  :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `customer`
               :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  +- SubqueryAlias `customer_address`
               :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `store`
                  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 137.64453125400001s
Running execution q20-v2.4 iteration: 1, StandardRun=true
19/10/03 20:33:42 INFO Query: 
== Query: q20-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#576 ASC NULLS FIRST, i_class#574 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, revenueratio#14318 ASC NULLS FIRST], true
      +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#14317, revenueratio#14318]
         +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#14317, _w0#14323, _w1#14324, _we0#14325, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(_w0#14323 as decimal(17,2))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(17,2)))), DecimalType(21,2)) as decimal(27,2))) / promote_precision(cast(_we0#14325 as decimal(27,2)))), DecimalType(38,17)) AS revenueratio#14318]
            +- Window [sum(_w1#14324) windowspecdefinition(i_class#574, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#14325], [i_class#574]
               +- Aggregate [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569], [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, sum(cs_ext_sales_price#23) AS itemrevenue#14317, sum(cs_ext_sales_price#23) AS _w0#14323, sum(cs_ext_sales_price#23) AS _w1#14324]
                  +- Filter (((cs_item_sk#15 = i_item_sk#564) && i_category#576 IN (Sports,Books,Home)) && ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(1999-02-22 as date)) && (d_date#494 <= cast(cast(cast(1999-02-22 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `catalog_sales`
                        :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  +- SubqueryAlias `item`
                        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/03 20:33:42 INFO Query: 
== Query: q20-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#576 ASC NULLS FIRST, i_class#574 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, revenueratio#14334 ASC NULLS FIRST], true
      +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#14333, revenueratio#14334]
         +- Project [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#14333, _w0#14339, _w1#14340, _we0#14341, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(_w0#14339 as decimal(17,2))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(17,2)))), DecimalType(21,2)) as decimal(27,2))) / promote_precision(cast(_we0#14341 as decimal(27,2)))), DecimalType(38,17)) AS revenueratio#14334]
            +- Window [sum(_w1#14340) windowspecdefinition(i_class#574, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#14341], [i_class#574]
               +- Aggregate [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569], [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569, sum(cs_ext_sales_price#23) AS itemrevenue#14333, sum(cs_ext_sales_price#23) AS _w0#14339, sum(cs_ext_sales_price#23) AS _w1#14340]
                  +- Filter (((cs_item_sk#15 = i_item_sk#564) && i_category#576 IN (Sports,Books,Home)) && ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(1999-02-22 as date)) && (d_date#494 <= cast(cast(cast(1999-02-22 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `catalog_sales`
                        :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  +- SubqueryAlias `item`
                        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 298.908888143s
Running execution q21-v2.4 iteration: 1, StandardRun=true
19/10/03 20:38:42 INFO Query: 
== Query: q21-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [w_warehouse_name#744 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST], true
      +- Project [w_warehouse_name#744, i_item_id#565, inv_before#14396L, inv_after#14397L]
         +- Filter ((CASE WHEN (inv_before#14396L > cast(0 as bigint)) THEN (cast(inv_after#14397L as double) / cast(inv_before#14396L as double)) ELSE cast(null as double) END >= cast(CheckOverflow((promote_precision(cast(2.0 as decimal(2,1))) / promote_precision(cast(3.0 as decimal(2,1)))), DecimalType(8,6)) as double)) && (CASE WHEN (inv_before#14396L > cast(0 as bigint)) THEN (cast(inv_after#14397L as double) / cast(inv_before#14396L as double)) ELSE cast(null as double) END <= cast(CheckOverflow((promote_precision(cast(3.0 as decimal(2,1))) / promote_precision(cast(2.0 as decimal(2,1)))), DecimalType(8,6)) as double)))
            +- SubqueryAlias `x`
               +- Aggregate [w_warehouse_name#744, i_item_id#565], [w_warehouse_name#744, i_item_id#565, sum(cast(CASE WHEN (cast(d_date#494 as date) < cast(2000-03-11 as date)) THEN inv_quantity_on_hand#125 ELSE 0 END as bigint)) AS inv_before#14396L, sum(cast(CASE WHEN (cast(d_date#494 as date) >= cast(2000-03-11 as date)) THEN inv_quantity_on_hand#125 ELSE 0 END as bigint)) AS inv_after#14397L]
                  +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(0.99 as decimal(7,2))) && (cast(i_current_price#569 as decimal(7,2)) <= cast(1.49 as decimal(7,2)))) && (i_item_sk#564 = inv_item_sk#123)) && (inv_warehouse_sk#124 = w_warehouse_sk#742)) && ((inv_date_sk#122 = d_date_sk#492) && ((d_date#494 >= cast(cast(cast(2000-03-11 as date) as timestamp) - interval 4 weeks 2 days as date)) && (d_date#494 <= cast(cast(cast(2000-03-11 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- SubqueryAlias `inventory`
                        :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                        :  :  +- SubqueryAlias `warehouse`
                        :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                        :  +- SubqueryAlias `item`
                        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/03 20:38:42 INFO Query: 
== Query: q21-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [w_warehouse_name#744 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST], true
      +- Project [w_warehouse_name#744, i_item_id#565, inv_before#14404L, inv_after#14405L]
         +- Filter ((CASE WHEN (inv_before#14404L > cast(0 as bigint)) THEN (cast(inv_after#14405L as double) / cast(inv_before#14404L as double)) ELSE cast(null as double) END >= cast(CheckOverflow((promote_precision(cast(2.0 as decimal(2,1))) / promote_precision(cast(3.0 as decimal(2,1)))), DecimalType(8,6)) as double)) && (CASE WHEN (inv_before#14404L > cast(0 as bigint)) THEN (cast(inv_after#14405L as double) / cast(inv_before#14404L as double)) ELSE cast(null as double) END <= cast(CheckOverflow((promote_precision(cast(3.0 as decimal(2,1))) / promote_precision(cast(2.0 as decimal(2,1)))), DecimalType(8,6)) as double)))
            +- SubqueryAlias `x`
               +- Aggregate [w_warehouse_name#744, i_item_id#565], [w_warehouse_name#744, i_item_id#565, sum(cast(CASE WHEN (cast(d_date#494 as date) < cast(2000-03-11 as date)) THEN inv_quantity_on_hand#125 ELSE 0 END as bigint)) AS inv_before#14404L, sum(cast(CASE WHEN (cast(d_date#494 as date) >= cast(2000-03-11 as date)) THEN inv_quantity_on_hand#125 ELSE 0 END as bigint)) AS inv_after#14405L]
                  +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(0.99 as decimal(7,2))) && (cast(i_current_price#569 as decimal(7,2)) <= cast(1.49 as decimal(7,2)))) && (i_item_sk#564 = inv_item_sk#123)) && (inv_warehouse_sk#124 = w_warehouse_sk#742)) && ((inv_date_sk#122 = d_date_sk#492) && ((d_date#494 >= cast(cast(cast(2000-03-11 as date) as timestamp) - interval 4 weeks 2 days as date)) && (d_date#494 <= cast(cast(cast(2000-03-11 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- SubqueryAlias `inventory`
                        :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                        :  :  +- SubqueryAlias `warehouse`
                        :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                        :  +- SubqueryAlias `item`
                        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 16.154679567s
Running execution q22-v2.4 iteration: 1, StandardRun=true
19/10/03 20:38:59 INFO Query: 
== Query: q22-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [qoh#14458 ASC NULLS FIRST, i_product_name#14465 ASC NULLS FIRST, i_brand#14466 ASC NULLS FIRST, i_class#14467 ASC NULLS FIRST, i_category#14468 ASC NULLS FIRST], true
      +- Aggregate [i_product_name#14465, i_brand#14466, i_class#14467, i_category#14468, spark_grouping_id#14460], [i_product_name#14465, i_brand#14466, i_class#14467, i_category#14468, avg(cast(inv_quantity_on_hand#125 as bigint)) AS qoh#14458]
         +- Expand [List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14461, i_brand#14462, i_class#14463, i_category#14464, 0), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14461, i_brand#14462, i_class#14463, null, 1), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14461, i_brand#14462, null, null, 3), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14461, null, null, null, 7), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, null, null, null, null, 15)], [inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, ... 49 more fields]
            +- Project [inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, ... 48 more fields]
               +- Filter (((inv_date_sk#122 = d_date_sk#492) && (inv_item_sk#123 = i_item_sk#564)) && ((inv_warehouse_sk#124 = w_warehouse_sk#742) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11)))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- SubqueryAlias `inventory`
                     :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                     :  :  +- SubqueryAlias `date_dim`
                     :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- SubqueryAlias `item`
                     :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     +- SubqueryAlias `warehouse`
                        +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet

     : benchmark
19/10/03 20:38:59 INFO Query: 
== Query: q22-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [qoh#14479 ASC NULLS FIRST, i_product_name#14486 ASC NULLS FIRST, i_brand#14487 ASC NULLS FIRST, i_class#14488 ASC NULLS FIRST, i_category#14489 ASC NULLS FIRST], true
      +- Aggregate [i_product_name#14486, i_brand#14487, i_class#14488, i_category#14489, spark_grouping_id#14481], [i_product_name#14486, i_brand#14487, i_class#14488, i_category#14489, avg(cast(inv_quantity_on_hand#125 as bigint)) AS qoh#14479]
         +- Expand [List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14482, i_brand#14483, i_class#14484, i_category#14485, 0), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14482, i_brand#14483, i_class#14484, null, 1), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14482, i_brand#14483, null, null, 3), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, i_product_name#14482, null, null, null, 7), List(inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, w_warehouse_sk#742, w_warehouse_id#743, w_warehouse_name#744, w_warehouse_sq_ft#745, w_street_number#746, w_street_name#747, w_street_type#748, w_suite_number#749, w_city#750, w_county#751, w_state#752, w_zip#753, w_country#754, w_gmt_offset#755, null, null, null, null, 15)], [inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, ... 49 more fields]
            +- Project [inv_date_sk#122, inv_item_sk#123, inv_warehouse_sk#124, inv_quantity_on_hand#125, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, ... 48 more fields]
               +- Filter (((inv_date_sk#122 = d_date_sk#492) && (inv_item_sk#123 = i_item_sk#564)) && ((inv_warehouse_sk#124 = w_warehouse_sk#742) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11)))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- SubqueryAlias `inventory`
                     :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                     :  :  +- SubqueryAlias `date_dim`
                     :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- SubqueryAlias `item`
                     :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     +- SubqueryAlias `warehouse`
                        +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet

      running Thread[benchmark runner,5,main]
Execution time: 351.666482597s
Running execution q23a-v2.4 iteration: 1, StandardRun=true
19/10/03 20:44:53 INFO Query: 
== Query: q23a-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [sum(sales#14604) AS sum(sales)#14639]
      +- SubqueryAlias `x`
         +- Union
            :- Project [CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2)) AS sales#14604]
            :  +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (cs_sold_date_sk#0 = d_date_sk#492)) && (cs_item_sk#15 IN (list#14605 []) && cs_bill_customer_sk#3 IN (list#14606 [])))
            :     :  :- Project [item_sk#14611]
            :     :  :  +- SubqueryAlias `frequent_ss_items`
            :     :  :     +- Project [itemdesc#14610, item_sk#14611, solddate#14612, cnt#14613L]
            :     :  :        +- Filter (count(1)#14621L > cast(4 as bigint))
            :     :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#14610, i_item_sk#564 AS item_sk#14611, d_date#494 AS solddate#14612, count(1) AS cnt#14613L, count(1) AS count(1)#14621L]
            :     :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
            :     :  :                 +- Join Inner
            :     :  :                    :- Join Inner
            :     :  :                    :  :- SubqueryAlias `store_sales`
            :     :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :  :                    :  +- SubqueryAlias `date_dim`
            :     :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     :  :                    +- SubqueryAlias `item`
            :     :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            :     :  +- Project [c_customer_sk#412]
            :     :     +- SubqueryAlias `best_ss_customer`
            :     :        +- Project [c_customer_sk#412, ssales#14616]
            :     :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14628 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#14617 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
            :     :              :  +- Project [tpcds_cmax#14615]
            :     :              :     +- SubqueryAlias `max_store_sales`
            :     :              :        +- Aggregate [max(csales#14614) AS tpcds_cmax#14615]
            :     :              :           +- SubqueryAlias `x`
            :     :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#14614]
            :     :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
            :     :              :                    +- Join Inner
            :     :              :                       :- Join Inner
            :     :              :                       :  :- SubqueryAlias `store_sales`
            :     :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :              :                       :  +- SubqueryAlias `customer`
            :     :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :     :              :                       +- SubqueryAlias `date_dim`
            :     :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#14616, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14628]
            :     :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
            :     :                    +- Join Inner
            :     :                       :- SubqueryAlias `store_sales`
            :     :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :                       +- SubqueryAlias `customer`
            :     :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :     +- Join Inner
            :        :- SubqueryAlias `catalog_sales`
            :        :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :        +- SubqueryAlias `date_dim`
            :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Project [CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2)) AS sales#14607]
               +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (ws_sold_date_sk#216 = d_date_sk#492)) && (ws_item_sk#219 IN (list#14608 []) && ws_bill_customer_sk#220 IN (list#14609 [])))
                  :  :- Project [item_sk#14611]
                  :  :  +- SubqueryAlias `frequent_ss_items`
                  :  :     +- Project [itemdesc#14610, item_sk#14611, solddate#14612, cnt#14613L]
                  :  :        +- Filter (count(1)#14621L > cast(4 as bigint))
                  :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#14610, i_item_sk#564 AS item_sk#14611, d_date#494 AS solddate#14612, count(1) AS cnt#14613L, count(1) AS count(1)#14621L]
                  :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                  :  :                 +- Join Inner
                  :  :                    :- Join Inner
                  :  :                    :  :- SubqueryAlias `store_sales`
                  :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :                    :  +- SubqueryAlias `date_dim`
                  :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  :                    +- SubqueryAlias `item`
                  :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  :  +- Project [c_customer_sk#412]
                  :     +- SubqueryAlias `best_ss_customer`
                  :        +- Project [c_customer_sk#412, ssales#14616]
                  :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14628 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#14617 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
                  :              :  +- Project [tpcds_cmax#14615]
                  :              :     +- SubqueryAlias `max_store_sales`
                  :              :        +- Aggregate [max(csales#14614) AS tpcds_cmax#14615]
                  :              :           +- SubqueryAlias `x`
                  :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#14614]
                  :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                  :              :                    +- Join Inner
                  :              :                       :- Join Inner
                  :              :                       :  :- SubqueryAlias `store_sales`
                  :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :              :                       :  +- SubqueryAlias `customer`
                  :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :              :                       +- SubqueryAlias `date_dim`
                  :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#14616, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14628]
                  :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
                  :                    +- Join Inner
                  :                       :- SubqueryAlias `store_sales`
                  :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :                       +- SubqueryAlias `customer`
                  :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  +- Join Inner
                     :- SubqueryAlias `web_sales`
                     :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/03 20:44:53 INFO Query: 
== Query: q23a-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [sum(sales#14641) AS sum(sales)#14676]
      +- SubqueryAlias `x`
         +- Union
            :- Project [CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2)) AS sales#14641]
            :  +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (cs_sold_date_sk#0 = d_date_sk#492)) && (cs_item_sk#15 IN (list#14642 []) && cs_bill_customer_sk#3 IN (list#14643 [])))
            :     :  :- Project [item_sk#14648]
            :     :  :  +- SubqueryAlias `frequent_ss_items`
            :     :  :     +- Project [itemdesc#14647, item_sk#14648, solddate#14649, cnt#14650L]
            :     :  :        +- Filter (count(1)#14658L > cast(4 as bigint))
            :     :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#14647, i_item_sk#564 AS item_sk#14648, d_date#494 AS solddate#14649, count(1) AS cnt#14650L, count(1) AS count(1)#14658L]
            :     :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
            :     :  :                 +- Join Inner
            :     :  :                    :- Join Inner
            :     :  :                    :  :- SubqueryAlias `store_sales`
            :     :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :  :                    :  +- SubqueryAlias `date_dim`
            :     :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     :  :                    +- SubqueryAlias `item`
            :     :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            :     :  +- Project [c_customer_sk#412]
            :     :     +- SubqueryAlias `best_ss_customer`
            :     :        +- Project [c_customer_sk#412, ssales#14653]
            :     :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14665 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#14654 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
            :     :              :  +- Project [tpcds_cmax#14652]
            :     :              :     +- SubqueryAlias `max_store_sales`
            :     :              :        +- Aggregate [max(csales#14651) AS tpcds_cmax#14652]
            :     :              :           +- SubqueryAlias `x`
            :     :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#14651]
            :     :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
            :     :              :                    +- Join Inner
            :     :              :                       :- Join Inner
            :     :              :                       :  :- SubqueryAlias `store_sales`
            :     :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :              :                       :  +- SubqueryAlias `customer`
            :     :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :     :              :                       +- SubqueryAlias `date_dim`
            :     :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#14653, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14665]
            :     :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
            :     :                    +- Join Inner
            :     :                       :- SubqueryAlias `store_sales`
            :     :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :                       +- SubqueryAlias `customer`
            :     :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :     +- Join Inner
            :        :- SubqueryAlias `catalog_sales`
            :        :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :        +- SubqueryAlias `date_dim`
            :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Project [CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2)) AS sales#14644]
               +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (ws_sold_date_sk#216 = d_date_sk#492)) && (ws_item_sk#219 IN (list#14645 []) && ws_bill_customer_sk#220 IN (list#14646 [])))
                  :  :- Project [item_sk#14648]
                  :  :  +- SubqueryAlias `frequent_ss_items`
                  :  :     +- Project [itemdesc#14647, item_sk#14648, solddate#14649, cnt#14650L]
                  :  :        +- Filter (count(1)#14658L > cast(4 as bigint))
                  :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#14647, i_item_sk#564 AS item_sk#14648, d_date#494 AS solddate#14649, count(1) AS cnt#14650L, count(1) AS count(1)#14658L]
                  :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                  :  :                 +- Join Inner
                  :  :                    :- Join Inner
                  :  :                    :  :- SubqueryAlias `store_sales`
                  :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :                    :  +- SubqueryAlias `date_dim`
                  :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  :                    +- SubqueryAlias `item`
                  :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  :  +- Project [c_customer_sk#412]
                  :     +- SubqueryAlias `best_ss_customer`
                  :        +- Project [c_customer_sk#412, ssales#14653]
                  :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14665 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#14654 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
                  :              :  +- Project [tpcds_cmax#14652]
                  :              :     +- SubqueryAlias `max_store_sales`
                  :              :        +- Aggregate [max(csales#14651) AS tpcds_cmax#14652]
                  :              :           +- SubqueryAlias `x`
                  :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#14651]
                  :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                  :              :                    +- Join Inner
                  :              :                       :- Join Inner
                  :              :                       :  :- SubqueryAlias `store_sales`
                  :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :              :                       :  +- SubqueryAlias `customer`
                  :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :              :                       +- SubqueryAlias `date_dim`
                  :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#14653, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14665]
                  :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
                  :                    +- Join Inner
                  :                       :- SubqueryAlias `store_sales`
                  :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :                       +- SubqueryAlias `customer`
                  :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  +- Join Inner
                     :- SubqueryAlias `web_sales`
                     :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 4534.5579748360005s
Running execution q23b-v2.4 iteration: 1, StandardRun=true
19/10/03 22:00:31 INFO Query: 
== Query: q23b-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, sales#14838 ASC NULLS FIRST], true
      +- Project [c_last_name#421, c_first_name#420, sales#14838]
         +- SubqueryAlias `y`
            +- Union
               :- Aggregate [c_last_name#421, c_first_name#420], [c_last_name#421, c_first_name#420, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2))) AS sales#14838]
               :  +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((cs_item_sk#15 IN (list#14839 []) && cs_bill_customer_sk#3 IN (list#14840 [])) && (cs_bill_customer_sk#3 = c_customer_sk#412)))
               :     :  :- Project [item_sk#14845]
               :     :  :  +- SubqueryAlias `frequent_ss_items`
               :     :  :     +- Project [itemdesc#14844, item_sk#14845, solddate#14846, cnt#14847L]
               :     :  :        +- Filter (count(1)#14855L > cast(4 as bigint))
               :     :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#14844, i_item_sk#564 AS item_sk#14845, d_date#494 AS solddate#14846, count(1) AS cnt#14847L, count(1) AS count(1)#14855L]
               :     :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
               :     :  :                 +- Join Inner
               :     :  :                    :- Join Inner
               :     :  :                    :  :- SubqueryAlias `store_sales`
               :     :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :     :  :                    :  +- SubqueryAlias `date_dim`
               :     :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :     :  :                    +- SubqueryAlias `item`
               :     :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :     :  +- Project [c_customer_sk#412]
               :     :     +- SubqueryAlias `best_ss_customer`
               :     :        +- Project [c_customer_sk#412, ssales#14850]
               :     :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14862 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#14851 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
               :     :              :  +- Project [tpcds_cmax#14849]
               :     :              :     +- SubqueryAlias `max_store_sales`
               :     :              :        +- Aggregate [max(csales#14848) AS tpcds_cmax#14849]
               :     :              :           +- SubqueryAlias `x`
               :     :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#14848]
               :     :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
               :     :              :                    +- Join Inner
               :     :              :                       :- Join Inner
               :     :              :                       :  :- SubqueryAlias `store_sales`
               :     :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :     :              :                       :  +- SubqueryAlias `customer`
               :     :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :     :              :                       +- SubqueryAlias `date_dim`
               :     :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :     :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#14850, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14862]
               :     :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
               :     :                    +- Join Inner
               :     :                       :- SubqueryAlias `store_sales`
               :     :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :     :                       +- SubqueryAlias `customer`
               :     :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :     +- Join Inner
               :        :- Join Inner
               :        :  :- SubqueryAlias `catalog_sales`
               :        :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :        :  +- SubqueryAlias `customer`
               :        :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :        +- SubqueryAlias `date_dim`
               :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- Aggregate [c_last_name#421, c_first_name#420], [c_last_name#421, c_first_name#420, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2))) AS sales#14841]
                  +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((ws_item_sk#219 IN (list#14842 []) && ws_bill_customer_sk#220 IN (list#14843 [])) && (ws_bill_customer_sk#220 = c_customer_sk#412)))
                     :  :- Project [item_sk#14845]
                     :  :  +- SubqueryAlias `frequent_ss_items`
                     :  :     +- Project [itemdesc#14844, item_sk#14845, solddate#14846, cnt#14847L]
                     :  :        +- Filter (count(1)#14855L > cast(4 as bigint))
                     :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#14844, i_item_sk#564 AS item_sk#14845, d_date#494 AS solddate#14846, count(1) AS cnt#14847L, count(1) AS count(1)#14855L]
                     :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                     :  :                 +- Join Inner
                     :  :                    :- Join Inner
                     :  :                    :  :- SubqueryAlias `store_sales`
                     :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :                    :  +- SubqueryAlias `date_dim`
                     :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :                    +- SubqueryAlias `item`
                     :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  +- Project [c_customer_sk#412]
                     :     +- SubqueryAlias `best_ss_customer`
                     :        +- Project [c_customer_sk#412, ssales#14850]
                     :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14862 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#14851 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
                     :              :  +- Project [tpcds_cmax#14849]
                     :              :     +- SubqueryAlias `max_store_sales`
                     :              :        +- Aggregate [max(csales#14848) AS tpcds_cmax#14849]
                     :              :           +- SubqueryAlias `x`
                     :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#14848]
                     :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                     :              :                    +- Join Inner
                     :              :                       :- Join Inner
                     :              :                       :  :- SubqueryAlias `store_sales`
                     :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :              :                       :  +- SubqueryAlias `customer`
                     :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     :              :                       +- SubqueryAlias `date_dim`
                     :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#14850, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14862]
                     :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
                     :                    +- Join Inner
                     :                       :- SubqueryAlias `store_sales`
                     :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :                       +- SubqueryAlias `customer`
                     :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `web_sales`
                        :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  +- SubqueryAlias `customer`
                        :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/03 22:00:31 INFO Query: 
== Query: q23b-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, sales#14877 ASC NULLS FIRST], true
      +- Project [c_last_name#421, c_first_name#420, sales#14877]
         +- SubqueryAlias `y`
            +- Union
               :- Aggregate [c_last_name#421, c_first_name#420], [c_last_name#421, c_first_name#420, sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#20 as decimal(12,2)))), DecimalType(18,2))) AS sales#14877]
               :  +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((cs_item_sk#15 IN (list#14878 []) && cs_bill_customer_sk#3 IN (list#14879 [])) && (cs_bill_customer_sk#3 = c_customer_sk#412)))
               :     :  :- Project [item_sk#14884]
               :     :  :  +- SubqueryAlias `frequent_ss_items`
               :     :  :     +- Project [itemdesc#14883, item_sk#14884, solddate#14885, cnt#14886L]
               :     :  :        +- Filter (count(1)#14894L > cast(4 as bigint))
               :     :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#14883, i_item_sk#564 AS item_sk#14884, d_date#494 AS solddate#14885, count(1) AS cnt#14886L, count(1) AS count(1)#14894L]
               :     :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
               :     :  :                 +- Join Inner
               :     :  :                    :- Join Inner
               :     :  :                    :  :- SubqueryAlias `store_sales`
               :     :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :     :  :                    :  +- SubqueryAlias `date_dim`
               :     :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :     :  :                    +- SubqueryAlias `item`
               :     :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :     :  +- Project [c_customer_sk#412]
               :     :     +- SubqueryAlias `best_ss_customer`
               :     :        +- Project [c_customer_sk#412, ssales#14889]
               :     :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14901 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#14890 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
               :     :              :  +- Project [tpcds_cmax#14888]
               :     :              :     +- SubqueryAlias `max_store_sales`
               :     :              :        +- Aggregate [max(csales#14887) AS tpcds_cmax#14888]
               :     :              :           +- SubqueryAlias `x`
               :     :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#14887]
               :     :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
               :     :              :                    +- Join Inner
               :     :              :                       :- Join Inner
               :     :              :                       :  :- SubqueryAlias `store_sales`
               :     :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :     :              :                       :  +- SubqueryAlias `customer`
               :     :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :     :              :                       +- SubqueryAlias `date_dim`
               :     :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :     :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#14889, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14901]
               :     :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
               :     :                    +- Join Inner
               :     :                       :- SubqueryAlias `store_sales`
               :     :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :     :                       +- SubqueryAlias `customer`
               :     :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :     +- Join Inner
               :        :- Join Inner
               :        :  :- SubqueryAlias `catalog_sales`
               :        :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :        :  +- SubqueryAlias `customer`
               :        :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :        +- SubqueryAlias `date_dim`
               :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- Aggregate [c_last_name#421, c_first_name#420], [c_last_name#421, c_first_name#420, sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#236 as decimal(12,2)))), DecimalType(18,2))) AS sales#14880]
                  +- Filter ((((d_year#498 = 2000) && (d_moy#500 = 2)) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((ws_item_sk#219 IN (list#14881 []) && ws_bill_customer_sk#220 IN (list#14882 [])) && (ws_bill_customer_sk#220 = c_customer_sk#412)))
                     :  :- Project [item_sk#14884]
                     :  :  +- SubqueryAlias `frequent_ss_items`
                     :  :     +- Project [itemdesc#14883, item_sk#14884, solddate#14885, cnt#14886L]
                     :  :        +- Filter (count(1)#14894L > cast(4 as bigint))
                     :  :           +- Aggregate [substring(i_item_desc#568, 1, 30), i_item_sk#564, d_date#494], [substring(i_item_desc#568, 1, 30) AS itemdesc#14883, i_item_sk#564 AS item_sk#14884, d_date#494 AS solddate#14885, count(1) AS cnt#14886L, count(1) AS count(1)#14894L]
                     :  :              +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                     :  :                 +- Join Inner
                     :  :                    :- Join Inner
                     :  :                    :  :- SubqueryAlias `store_sales`
                     :  :                    :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :                    :  +- SubqueryAlias `date_dim`
                     :  :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :                    +- SubqueryAlias `item`
                     :  :                       +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  +- Project [c_customer_sk#412]
                     :     +- SubqueryAlias `best_ss_customer`
                     :        +- Project [c_customer_sk#412, ssales#14889]
                     :           +- Filter (cast(sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14901 as decimal(38,8)) > cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(95 as decimal(2,0)) as decimal(4,1))) / promote_precision(cast(100.0 as decimal(4,1)))), DecimalType(9,6)) as decimal(32,6))) * promote_precision(cast(scalar-subquery#14890 [] as decimal(32,6)))), DecimalType(38,8)) as decimal(38,8)))
                     :              :  +- Project [tpcds_cmax#14888]
                     :              :     +- SubqueryAlias `max_store_sales`
                     :              :        +- Aggregate [max(csales#14887) AS tpcds_cmax#14888]
                     :              :           +- SubqueryAlias `x`
                     :              :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS csales#14887]
                     :              :                 +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2000,(2000 + 1),(2000 + 2),(2000 + 3)))
                     :              :                    +- Join Inner
                     :              :                       :- Join Inner
                     :              :                       :  :- SubqueryAlias `store_sales`
                     :              :                       :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :              :                       :  +- SubqueryAlias `customer`
                     :              :                       :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     :              :                       +- SubqueryAlias `date_dim`
                     :              :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS ssales#14889, sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2))) AS sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)))#14901]
                     :                 +- Filter (ss_customer_sk#133 = c_customer_sk#412)
                     :                    +- Join Inner
                     :                       :- SubqueryAlias `store_sales`
                     :                       :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :                       +- SubqueryAlias `customer`
                     :                          +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `web_sales`
                        :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  +- SubqueryAlias `customer`
                        :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        +- SubqueryAlias `date_dim`
                           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 3415.077792531s
Running execution q24a-v2.4 iteration: 1, StandardRun=true
19/10/03 22:57:29 INFO Query: 
== Query: q24a-v2.4 ==
Project [c_last_name#421, c_first_name#420, s_store_name#669, paid#15046]
+- Filter (cast(sum(netpaid#15048)#15055 as decimal(33,8)) > cast(scalar-subquery#15047 [] as decimal(33,8)))
   :  +- Aggregate [CheckOverflow((promote_precision(cast(0.05 as decimal(21,6))) * promote_precision(cast(avg(netpaid#15048) as decimal(21,6)))), DecimalType(24,8)) AS (CAST(0.05 AS DECIMAL(21,6)) * CAST(avg(netpaid) AS DECIMAL(21,6)))#15052]
   :     +- SubqueryAlias `ssales`
   :        +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15048]
   :           +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
   :              +- Join Inner
   :                 :- Join Inner
   :                 :  :- Join Inner
   :                 :  :  :- Join Inner
   :                 :  :  :  :- Join Inner
   :                 :  :  :  :  :- SubqueryAlias `store_sales`
   :                 :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :                 :  :  :  :  +- SubqueryAlias `store_returns`
   :                 :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
   :                 :  :  :  +- SubqueryAlias `store`
   :                 :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :                 :  :  +- SubqueryAlias `item`
   :                 :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
   :                 :  +- SubqueryAlias `customer`
   :                 :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
   :                 +- SubqueryAlias `customer_address`
   :                    +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
   +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669], [c_last_name#421, c_first_name#420, s_store_name#669, sum(netpaid#15048) AS paid#15046, sum(netpaid#15048) AS sum(netpaid#15048)#15055]
      +- Filter (i_color#581 = pale)
         +- SubqueryAlias `ssales`
            +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15048]
               +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- SubqueryAlias `store_sales`
                     :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :  :  :  +- SubqueryAlias `store_returns`
                     :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :  :  +- SubqueryAlias `store`
                     :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  :  +- SubqueryAlias `item`
                     :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  +- SubqueryAlias `customer`
                     :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     +- SubqueryAlias `customer_address`
                        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

     : benchmark
19/10/03 22:57:29 INFO Query: 
== Query: q24a-v2.4 ==
Project [c_last_name#421, c_first_name#420, s_store_name#669, paid#15061]
+- Filter (cast(sum(netpaid#15063)#15070 as decimal(33,8)) > cast(scalar-subquery#15062 [] as decimal(33,8)))
   :  +- Aggregate [CheckOverflow((promote_precision(cast(0.05 as decimal(21,6))) * promote_precision(cast(avg(netpaid#15063) as decimal(21,6)))), DecimalType(24,8)) AS (CAST(0.05 AS DECIMAL(21,6)) * CAST(avg(netpaid) AS DECIMAL(21,6)))#15067]
   :     +- SubqueryAlias `ssales`
   :        +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15063]
   :           +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
   :              +- Join Inner
   :                 :- Join Inner
   :                 :  :- Join Inner
   :                 :  :  :- Join Inner
   :                 :  :  :  :- Join Inner
   :                 :  :  :  :  :- SubqueryAlias `store_sales`
   :                 :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :                 :  :  :  :  +- SubqueryAlias `store_returns`
   :                 :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
   :                 :  :  :  +- SubqueryAlias `store`
   :                 :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :                 :  :  +- SubqueryAlias `item`
   :                 :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
   :                 :  +- SubqueryAlias `customer`
   :                 :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
   :                 +- SubqueryAlias `customer_address`
   :                    +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
   +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669], [c_last_name#421, c_first_name#420, s_store_name#669, sum(netpaid#15063) AS paid#15061, sum(netpaid#15063) AS sum(netpaid#15063)#15070]
      +- Filter (i_color#581 = pale)
         +- SubqueryAlias `ssales`
            +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15063]
               +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- SubqueryAlias `store_sales`
                     :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :  :  :  +- SubqueryAlias `store_returns`
                     :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :  :  +- SubqueryAlias `store`
                     :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  :  +- SubqueryAlias `item`
                     :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  +- SubqueryAlias `customer`
                     :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     +- SubqueryAlias `customer_address`
                        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

      running Thread[benchmark runner,5,main]
Execution time: 3885.235163433s
Running execution q24b-v2.4 iteration: 1, StandardRun=true
19/10/04 00:02:17 INFO Query: 
== Query: q24b-v2.4 ==
Project [c_last_name#421, c_first_name#420, s_store_name#669, paid#15142]
+- Filter (cast(sum(netpaid#15144)#15151 as decimal(33,8)) > cast(scalar-subquery#15143 [] as decimal(33,8)))
   :  +- Aggregate [CheckOverflow((promote_precision(cast(0.05 as decimal(21,6))) * promote_precision(cast(avg(netpaid#15144) as decimal(21,6)))), DecimalType(24,8)) AS (CAST(0.05 AS DECIMAL(21,6)) * CAST(avg(netpaid) AS DECIMAL(21,6)))#15148]
   :     +- SubqueryAlias `ssales`
   :        +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15144]
   :           +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
   :              +- Join Inner
   :                 :- Join Inner
   :                 :  :- Join Inner
   :                 :  :  :- Join Inner
   :                 :  :  :  :- Join Inner
   :                 :  :  :  :  :- SubqueryAlias `store_sales`
   :                 :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :                 :  :  :  :  +- SubqueryAlias `store_returns`
   :                 :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
   :                 :  :  :  +- SubqueryAlias `store`
   :                 :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :                 :  :  +- SubqueryAlias `item`
   :                 :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
   :                 :  +- SubqueryAlias `customer`
   :                 :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
   :                 +- SubqueryAlias `customer_address`
   :                    +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
   +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669], [c_last_name#421, c_first_name#420, s_store_name#669, sum(netpaid#15144) AS paid#15142, sum(netpaid#15144) AS sum(netpaid#15144)#15151]
      +- Filter (i_color#581 = chiffon)
         +- SubqueryAlias `ssales`
            +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15144]
               +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- SubqueryAlias `store_sales`
                     :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :  :  :  +- SubqueryAlias `store_returns`
                     :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :  :  +- SubqueryAlias `store`
                     :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  :  +- SubqueryAlias `item`
                     :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  +- SubqueryAlias `customer`
                     :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     +- SubqueryAlias `customer_address`
                        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

     : benchmark
19/10/04 00:02:17 INFO Query: 
== Query: q24b-v2.4 ==
Project [c_last_name#421, c_first_name#420, s_store_name#669, paid#15157]
+- Filter (cast(sum(netpaid#15159)#15166 as decimal(33,8)) > cast(scalar-subquery#15158 [] as decimal(33,8)))
   :  +- Aggregate [CheckOverflow((promote_precision(cast(0.05 as decimal(21,6))) * promote_precision(cast(avg(netpaid#15159) as decimal(21,6)))), DecimalType(24,8)) AS (CAST(0.05 AS DECIMAL(21,6)) * CAST(avg(netpaid) AS DECIMAL(21,6)))#15163]
   :     +- SubqueryAlias `ssales`
   :        +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15159]
   :           +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
   :              +- Join Inner
   :                 :- Join Inner
   :                 :  :- Join Inner
   :                 :  :  :- Join Inner
   :                 :  :  :  :- Join Inner
   :                 :  :  :  :  :- SubqueryAlias `store_sales`
   :                 :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :                 :  :  :  :  +- SubqueryAlias `store_returns`
   :                 :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
   :                 :  :  :  +- SubqueryAlias `store`
   :                 :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :                 :  :  +- SubqueryAlias `item`
   :                 :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
   :                 :  +- SubqueryAlias `customer`
   :                 :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
   :                 +- SubqueryAlias `customer_address`
   :                    +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
   +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669], [c_last_name#421, c_first_name#420, s_store_name#669, sum(netpaid#15159) AS paid#15157, sum(netpaid#15159) AS sum(netpaid#15159)#15166]
      +- Filter (i_color#581 = chiffon)
         +- SubqueryAlias `ssales`
            +- Aggregate [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579], [c_last_name#421, c_first_name#420, s_store_name#669, ca_state#456, s_state#688, i_color#581, i_current_price#569, i_manager_id#584, i_units#582, i_size#579, sum(ss_net_paid#150) AS netpaid#15159]
               +- Filter ((((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178)) && ((ss_customer_sk#133 = c_customer_sk#412) && (ss_item_sk#132 = i_item_sk#564))) && (((ss_store_sk#137 = s_store_sk#664) && (c_birth_country#426 = upper(ca_country#458))) && ((s_zip#689 = ca_zip#457) && (s_market_id#674 = 8))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- Join Inner
                     :  :  :  :  :- SubqueryAlias `store_sales`
                     :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :  :  :  +- SubqueryAlias `store_returns`
                     :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :  :  +- SubqueryAlias `store`
                     :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  :  +- SubqueryAlias `item`
                     :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  +- SubqueryAlias `customer`
                     :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                     +- SubqueryAlias `customer_address`
                        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

      running Thread[benchmark runner,5,main]
Execution time: 3928.043408791s
Running execution q25-v2.4 iteration: 1, StandardRun=true
19/10/04 01:07:47 INFO Query: 
== Query: q25-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, store_sales_profit#15292, store_returns_loss#15293, catalog_sales_profit#15294]
      +- Sort [i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, s_store_id#665 ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669], [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, sum(ss_net_profit#152) AS store_sales_profit#15292, sum(sr_net_loss#195) AS store_returns_loss#15293, sum(cs_net_profit#33) AS catalog_sales_profit#15294]
            +- Filter (((((d_moy#500 = 4) && (d_year#498 = 2001)) && ((d_date_sk#492 = ss_sold_date_sk#130) && (i_item_sk#564 = ss_item_sk#132))) && (((s_store_sk#664 = ss_store_sk#137) && (ss_customer_sk#133 = sr_customer_sk#179)) && ((ss_item_sk#132 = sr_item_sk#178) && (ss_ticket_number#139L = sr_ticket_number#185L)))) && ((((sr_returned_date_sk#176 = d_date_sk#15295) && ((d_moy#15303 >= 4) && (d_moy#15303 <= 10))) && ((d_year#15301 = 2001) && (sr_customer_sk#179 = cs_bill_customer_sk#3))) && (((sr_item_sk#178 = cs_item_sk#15) && (cs_sold_date_sk#0 = d_date_sk#15323)) && (((d_moy#15331 >= 4) && (d_moy#15331 <= 10)) && (d_year#15329 = 2001)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :  :  :  :  +- SubqueryAlias `catalog_sales`
                  :  :  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  :  +- SubqueryAlias `d1`
                  :  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  :  :  +- SubqueryAlias `d2`
                  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :        +- Relation[d_date_sk#15295,d_date_id#15296,d_date#15297,d_month_seq#15298,d_week_seq#15299,d_quarter_seq#15300,d_year#15301,d_dow#15302,d_moy#15303,d_dom#15304,d_qoy#15305,d_fy_year#15306,d_fy_quarter_seq#15307,d_fy_week_seq#15308,d_day_name#15309,d_quarter_name#15310,d_holiday#15311,d_weekend#15312,d_following_holiday#15313,d_first_dom#15314,d_last_dom#15315,d_same_day_ly#15316,d_same_day_lq#15317,d_current_day#15318,... 4 more fields] parquet
                  :  :  +- SubqueryAlias `d3`
                  :  :     +- SubqueryAlias `date_dim`
                  :  :        +- Relation[d_date_sk#15323,d_date_id#15324,d_date#15325,d_month_seq#15326,d_week_seq#15327,d_quarter_seq#15328,d_year#15329,d_dow#15330,d_moy#15331,d_dom#15332,d_qoy#15333,d_fy_year#15334,d_fy_quarter_seq#15335,d_fy_week_seq#15336,d_day_name#15337,d_quarter_name#15338,d_holiday#15339,d_weekend#15340,d_following_holiday#15341,d_first_dom#15342,d_last_dom#15343,d_same_day_ly#15344,d_same_day_lq#15345,d_current_day#15346,... 4 more fields] parquet
                  :  +- SubqueryAlias `store`
                  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/04 01:07:47 INFO Query: 
== Query: q25-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, store_sales_profit#15365, store_returns_loss#15366, catalog_sales_profit#15367]
      +- Sort [i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, s_store_id#665 ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669], [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, sum(ss_net_profit#152) AS store_sales_profit#15365, sum(sr_net_loss#195) AS store_returns_loss#15366, sum(cs_net_profit#33) AS catalog_sales_profit#15367]
            +- Filter (((((d_moy#500 = 4) && (d_year#498 = 2001)) && ((d_date_sk#492 = ss_sold_date_sk#130) && (i_item_sk#564 = ss_item_sk#132))) && (((s_store_sk#664 = ss_store_sk#137) && (ss_customer_sk#133 = sr_customer_sk#179)) && ((ss_item_sk#132 = sr_item_sk#178) && (ss_ticket_number#139L = sr_ticket_number#185L)))) && ((((sr_returned_date_sk#176 = d_date_sk#15368) && ((d_moy#15376 >= 4) && (d_moy#15376 <= 10))) && ((d_year#15374 = 2001) && (sr_customer_sk#179 = cs_bill_customer_sk#3))) && (((sr_item_sk#178 = cs_item_sk#15) && (cs_sold_date_sk#0 = d_date_sk#15396)) && (((d_moy#15404 >= 4) && (d_moy#15404 <= 10)) && (d_year#15402 = 2001)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :  :  :  :  +- SubqueryAlias `catalog_sales`
                  :  :  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  :  +- SubqueryAlias `d1`
                  :  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  :  :  +- SubqueryAlias `d2`
                  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :        +- Relation[d_date_sk#15368,d_date_id#15369,d_date#15370,d_month_seq#15371,d_week_seq#15372,d_quarter_seq#15373,d_year#15374,d_dow#15375,d_moy#15376,d_dom#15377,d_qoy#15378,d_fy_year#15379,d_fy_quarter_seq#15380,d_fy_week_seq#15381,d_day_name#15382,d_quarter_name#15383,d_holiday#15384,d_weekend#15385,d_following_holiday#15386,d_first_dom#15387,d_last_dom#15388,d_same_day_ly#15389,d_same_day_lq#15390,d_current_day#15391,... 4 more fields] parquet
                  :  :  +- SubqueryAlias `d3`
                  :  :     +- SubqueryAlias `date_dim`
                  :  :        +- Relation[d_date_sk#15396,d_date_id#15397,d_date#15398,d_month_seq#15399,d_week_seq#15400,d_quarter_seq#15401,d_year#15402,d_dow#15403,d_moy#15404,d_dom#15405,d_qoy#15406,d_fy_year#15407,d_fy_quarter_seq#15408,d_fy_week_seq#15409,d_day_name#15410,d_quarter_name#15411,d_holiday#15412,d_weekend#15413,d_following_holiday#15414,d_first_dom#15415,d_last_dom#15416,d_same_day_ly#15417,d_same_day_lq#15418,d_current_day#15419,... 4 more fields] parquet
                  :  +- SubqueryAlias `store`
                  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
19/10/04 01:11:06 WARN ExecutorPodsWatchSnapshotSource: Kubernetes client has been closed (this is expected if the application is shutting down.)
io.fabric8.kubernetes.client.KubernetesClientException: too old resource version: 8697260 (8760834)
	at io.fabric8.kubernetes.client.dsl.internal.WatchConnectionManager$1.onMessage(WatchConnectionManager.java:259)
	at okhttp3.internal.ws.RealWebSocket.onReadMessage(RealWebSocket.java:307)
	at okhttp3.internal.ws.WebSocketReader.readMessageFrame(WebSocketReader.java:222)
	at okhttp3.internal.ws.WebSocketReader.processNextFrame(WebSocketReader.java:101)
	at okhttp3.internal.ws.RealWebSocket.loopReader(RealWebSocket.java:262)
	at okhttp3.internal.ws.RealWebSocket$2.onResponse(RealWebSocket.java:201)
	at okhttp3.RealCall$AsyncCall.execute(RealCall.java:141)
	at okhttp3.internal.NamedRunnable.run(NamedRunnable.java:32)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Execution time: 2162.148743231s
Running execution q26-v2.4 iteration: 1, StandardRun=true
19/10/04 01:43:51 INFO Query: 
== Query: q26-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, agg1#15621, agg2#15622, agg3#15623, agg4#15624]
      +- Sort [i_item_id#565 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565], [i_item_id#565, avg(cast(cs_quantity#18 as bigint)) AS agg1#15621, avg(cs_list_price#20) AS agg2#15622, avg(cs_coupon_amt#27) AS agg3#15623, avg(cs_sales_price#21) AS agg4#15624]
            +- Filter (((((cs_sold_date_sk#0 = d_date_sk#492) && (cs_item_sk#15 = i_item_sk#564)) && (cs_bill_cdemo_sk#4 = cd_demo_sk#474)) && ((cs_promo_sk#16 = p_promo_sk#608) && (cd_gender#475 = M))) && (((cd_marital_status#476 = S) && (cd_education_status#477 = College)) && (((p_channel_email#617 = N) || (p_channel_event#622 = N)) && (d_year#498 = 2000))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `customer_demographics`
                  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `promotion`
                     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet

     : benchmark
19/10/04 01:43:51 INFO Query: 
== Query: q26-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, agg1#15635, agg2#15636, agg3#15637, agg4#15638]
      +- Sort [i_item_id#565 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565], [i_item_id#565, avg(cast(cs_quantity#18 as bigint)) AS agg1#15635, avg(cs_list_price#20) AS agg2#15636, avg(cs_coupon_amt#27) AS agg3#15637, avg(cs_sales_price#21) AS agg4#15638]
            +- Filter (((((cs_sold_date_sk#0 = d_date_sk#492) && (cs_item_sk#15 = i_item_sk#564)) && (cs_bill_cdemo_sk#4 = cd_demo_sk#474)) && ((cs_promo_sk#16 = p_promo_sk#608) && (cd_gender#475 = M))) && (((cd_marital_status#476 = S) && (cd_education_status#477 = College)) && (((p_channel_email#617 = N) || (p_channel_event#622 = N)) && (d_year#498 = 2000))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `customer_demographics`
                  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `promotion`
                     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet

      running Thread[benchmark runner,5,main]
19/10/04 01:44:23 WARN TaskSetManager: Lost task 1403.0 in stage 400.0 (TID 747885, 192.168.27.32, executor 243): java.io.IOException: can not read FileMetaData: org.apache.hadoop.fs.s3a.AWSClientIOException: read on s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_sales/part-00467-10e4b037-4521-4ea1-80ea-c6a987fb8fc8-c000.snappy.parquet: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at org.apache.parquet.format.Util.readFileMetaData(Util.java:195)
	at org.apache.parquet.format.Util.readFileMetaData(Util.java:85)
	at org.apache.parquet.format.converter.ParquetMetadataConverter$2.visit(ParquetMetadataConverter.java:871)
	at org.apache.parquet.format.converter.ParquetMetadataConverter$2.visit(ParquetMetadataConverter.java:863)
	at org.apache.parquet.format.converter.ParquetMetadataConverter$SkipMetadataFilter.accept(ParquetMetadataConverter.java:757)
	at org.apache.parquet.format.converter.ParquetMetadataConverter.readParquetMetadata(ParquetMetadataConverter.java:863)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:532)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:505)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:499)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:448)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.footerFileMetaData$lzycompute$1(ParquetFileFormat.scala:371)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.footerFileMetaData$1(ParquetFileFormat.scala:370)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.apply(ParquetFileFormat.scala:374)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.apply(ParquetFileFormat.scala:352)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:124)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:177)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:101)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage5.scan_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage5.agg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage5.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
	Suppressed: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
		at com.amazonaws.util.LengthCheckInputStream.checkLength(LengthCheckInputStream.java:151)
		at com.amazonaws.util.LengthCheckInputStream.read(LengthCheckInputStream.java:93)
		at com.amazonaws.internal.SdkFilterInputStream.read(SdkFilterInputStream.java:76)
		at org.apache.hadoop.fs.s3a.S3AInputStream.closeStream(S3AInputStream.java:529)
		at org.apache.hadoop.fs.s3a.S3AInputStream.close(S3AInputStream.java:490)
		at java.io.FilterInputStream.close(FilterInputStream.java:181)
		at org.apache.parquet.io.DelegatingSeekableInputStream.close(DelegatingSeekableInputStream.java:50)
		at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:500)
		... 24 more
Caused by: shaded.parquet.org.apache.thrift.transport.TTransportException: org.apache.hadoop.fs.s3a.AWSClientIOException: read on s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_sales/part-00467-10e4b037-4521-4ea1-80ea-c6a987fb8fc8-c000.snappy.parquet: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at shaded.parquet.org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:129)
	at shaded.parquet.org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)
	at shaded.parquet.org.apache.thrift.protocol.TCompactProtocol.readByte(TCompactProtocol.java:634)
	at shaded.parquet.org.apache.thrift.protocol.TCompactProtocol.readFieldBegin(TCompactProtocol.java:539)
	at org.apache.parquet.format.InterningProtocol.readFieldBegin(InterningProtocol.java:158)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:108)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:138)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:112)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:112)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:138)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:112)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:138)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:60)
	at org.apache.parquet.format.event.SkippingFieldConsumer.consumeField(Consumers.java:155)
	at org.apache.parquet.format.event.Consumers$DelegatingFieldConsumer.consumeField(Consumers.java:99)
	at org.apache.parquet.format.event.EventBasedThriftReader.readStructContent(EventBasedThriftReader.java:73)
	at org.apache.parquet.format.event.EventBasedThriftReader.readStruct(EventBasedThriftReader.java:57)
	at org.apache.parquet.format.Util.readFileMetaData(Util.java:192)
	... 32 more
Caused by: org.apache.hadoop.fs.s3a.AWSClientIOException: read on s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_sales/part-00467-10e4b037-4521-4ea1-80ea-c6a987fb8fc8-c000.snappy.parquet: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at org.apache.hadoop.fs.s3a.S3AUtils.translateException(S3AUtils.java:177)
	at org.apache.hadoop.fs.s3a.Invoker.once(Invoker.java:111)
	at org.apache.hadoop.fs.s3a.Invoker.lambda$retry$3(Invoker.java:260)
	at org.apache.hadoop.fs.s3a.Invoker.retryUntranslated(Invoker.java:317)
	at org.apache.hadoop.fs.s3a.Invoker.retry(Invoker.java:256)
	at org.apache.hadoop.fs.s3a.Invoker.retry(Invoker.java:231)
	at org.apache.hadoop.fs.s3a.S3AInputStream.read(S3AInputStream.java:441)
	at java.io.DataInputStream.read(DataInputStream.java:149)
	at org.apache.parquet.io.DelegatingSeekableInputStream.read(DelegatingSeekableInputStream.java:66)
	at shaded.parquet.org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:127)
	... 49 more
Caused by: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at com.amazonaws.util.LengthCheckInputStream.checkLength(LengthCheckInputStream.java:151)
	at com.amazonaws.util.LengthCheckInputStream.read(LengthCheckInputStream.java:109)
	at com.amazonaws.internal.SdkFilterInputStream.read(SdkFilterInputStream.java:82)
	at org.apache.hadoop.fs.s3a.S3AInputStream.lambda$read$3(S3AInputStream.java:445)
	at org.apache.hadoop.fs.s3a.Invoker.once(Invoker.java:109)
	... 57 more

Execution time: 108.955117862s
Running execution q27-v2.4 iteration: 1, StandardRun=true
19/10/04 01:45:41 INFO Query: 
== Query: q27-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#15746 ASC NULLS FIRST, s_state#15747 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#15746, s_state#15747, spark_grouping_id#15743], [i_item_id#15746, s_state#15747, cast((shiftright(spark_grouping_id#15743, 0) & 1) as tinyint) AS g_state#15734, avg(cast(ss_quantity#140 as bigint)) AS agg1#15735, avg(ss_list_price#142) AS agg2#15736, avg(ss_coupon_amt#149) AS agg3#15737, avg(ss_sales_price#143) AS agg4#15738]
         +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#15744, s_state#15745, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#15744, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, ... 90 more fields]
            +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, ... 89 more fields]
               +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_cdemo_sk#134 = cd_demo_sk#474) && (cd_gender#475 = M))) && (((cd_marital_status#476 = S) && (cd_education_status#477 = College)) && ((d_year#498 = 2002) && s_state#688 IN (TN,TN,TN,TN,TN,TN))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- SubqueryAlias `store_sales`
                     :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :  :  +- SubqueryAlias `customer_demographics`
                     :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                     :  :  +- SubqueryAlias `date_dim`
                     :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- SubqueryAlias `store`
                     :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     +- SubqueryAlias `item`
                        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/04 01:45:41 INFO Query: 
== Query: q27-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#15770 ASC NULLS FIRST, s_state#15771 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#15770, s_state#15771, spark_grouping_id#15767], [i_item_id#15770, s_state#15771, cast((shiftright(spark_grouping_id#15767, 0) & 1) as tinyint) AS g_state#15758, avg(cast(ss_quantity#140 as bigint)) AS agg1#15759, avg(ss_list_price#142) AS agg2#15760, avg(ss_coupon_amt#149) AS agg3#15761, avg(ss_sales_price#143) AS agg4#15762]
         +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#15768, s_state#15769, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_item_id#15768, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, ... 90 more fields]
            +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, cd_demo_sk#474, ... 89 more fields]
               +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_cdemo_sk#134 = cd_demo_sk#474) && (cd_gender#475 = M))) && (((cd_marital_status#476 = S) && (cd_education_status#477 = College)) && ((d_year#498 = 2002) && s_state#688 IN (TN,TN,TN,TN,TN,TN))))
                  +- Join Inner
                     :- Join Inner
                     :  :- Join Inner
                     :  :  :- Join Inner
                     :  :  :  :- SubqueryAlias `store_sales`
                     :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :  :  +- SubqueryAlias `customer_demographics`
                     :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                     :  :  +- SubqueryAlias `date_dim`
                     :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  +- SubqueryAlias `store`
                     :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     +- SubqueryAlias `item`
                        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 177.473383947s
Running execution q28-v2.4 iteration: 1, StandardRun=true
19/10/04 01:48:41 INFO Query: 
== Query: q28-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [B1_LP#16021, B1_CNT#16022L, B1_CNTD#16023L, B2_LP#16024, B2_CNT#16025L, B2_CNTD#16026L, B3_LP#16027, B3_CNT#16028L, B3_CNTD#16029L, B4_LP#16030, B4_CNT#16031L, B4_CNTD#16032L, B5_LP#16033, B5_CNT#16034L, B5_CNTD#16035L, B6_LP#16036, B6_CNT#16037L, B6_CNTD#16038L]
      +- Join Cross
         :- Join Cross
         :  :- Join Cross
         :  :  :- Join Cross
         :  :  :  :- Join Cross
         :  :  :  :  :- SubqueryAlias `B1`
         :  :  :  :  :  +- Aggregate [avg(ss_list_price#142) AS B1_LP#16021, count(ss_list_price#142) AS B1_CNT#16022L, count(distinct ss_list_price#142) AS B1_CNTD#16023L]
         :  :  :  :  :     +- Filter (((ss_quantity#140 >= 0) && (ss_quantity#140 <= 5)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(8 as decimal(1,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((8 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(459 as decimal(3,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((459 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(57 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((57 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :  :  :  :        +- SubqueryAlias `store_sales`
         :  :  :  :  :           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  :  +- SubqueryAlias `B2`
         :  :  :  :     +- Aggregate [avg(ss_list_price#142) AS B2_LP#16024, count(ss_list_price#142) AS B2_CNT#16025L, count(distinct ss_list_price#142) AS B2_CNTD#16026L]
         :  :  :  :        +- Filter (((ss_quantity#140 >= 6) && (ss_quantity#140 <= 10)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(90 as decimal(2,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((90 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(2323 as decimal(4,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((2323 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(31 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((31 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :  :  :           +- SubqueryAlias `store_sales`
         :  :  :  :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  +- SubqueryAlias `B3`
         :  :  :     +- Aggregate [avg(ss_list_price#142) AS B3_LP#16027, count(ss_list_price#142) AS B3_CNT#16028L, count(distinct ss_list_price#142) AS B3_CNTD#16029L]
         :  :  :        +- Filter (((ss_quantity#140 >= 11) && (ss_quantity#140 <= 15)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(142 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((142 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(12214 as decimal(5,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((12214 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(79 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((79 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :  :           +- SubqueryAlias `store_sales`
         :  :  :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  +- SubqueryAlias `B4`
         :  :     +- Aggregate [avg(ss_list_price#142) AS B4_LP#16030, count(ss_list_price#142) AS B4_CNT#16031L, count(distinct ss_list_price#142) AS B4_CNTD#16032L]
         :  :        +- Filter (((ss_quantity#140 >= 16) && (ss_quantity#140 <= 20)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(135 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((135 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(6071 as decimal(4,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((6071 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(38 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((38 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :           +- SubqueryAlias `store_sales`
         :  :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  +- SubqueryAlias `B5`
         :     +- Aggregate [avg(ss_list_price#142) AS B5_LP#16033, count(ss_list_price#142) AS B5_CNT#16034L, count(distinct ss_list_price#142) AS B5_CNTD#16035L]
         :        +- Filter (((ss_quantity#140 >= 21) && (ss_quantity#140 <= 25)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(122 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((122 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(836 as decimal(3,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((836 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(17 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((17 + 20) as decimal(10,0)) as decimal(12,2))))))
         :           +- SubqueryAlias `store_sales`
         :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         +- SubqueryAlias `B6`
            +- Aggregate [avg(ss_list_price#142) AS B6_LP#16036, count(ss_list_price#142) AS B6_CNT#16037L, count(distinct ss_list_price#142) AS B6_CNTD#16038L]
               +- Filter (((ss_quantity#140 >= 26) && (ss_quantity#140 <= 30)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(154 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((154 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(7326 as decimal(4,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((7326 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(7 as decimal(1,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((7 + 20) as decimal(10,0)) as decimal(12,2))))))
                  +- SubqueryAlias `store_sales`
                     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
19/10/04 01:48:41 INFO Query: 
== Query: q28-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [B1_LP#16075, B1_CNT#16076L, B1_CNTD#16077L, B2_LP#16078, B2_CNT#16079L, B2_CNTD#16080L, B3_LP#16081, B3_CNT#16082L, B3_CNTD#16083L, B4_LP#16084, B4_CNT#16085L, B4_CNTD#16086L, B5_LP#16087, B5_CNT#16088L, B5_CNTD#16089L, B6_LP#16090, B6_CNT#16091L, B6_CNTD#16092L]
      +- Join Cross
         :- Join Cross
         :  :- Join Cross
         :  :  :- Join Cross
         :  :  :  :- Join Cross
         :  :  :  :  :- SubqueryAlias `B1`
         :  :  :  :  :  +- Aggregate [avg(ss_list_price#142) AS B1_LP#16075, count(ss_list_price#142) AS B1_CNT#16076L, count(distinct ss_list_price#142) AS B1_CNTD#16077L]
         :  :  :  :  :     +- Filter (((ss_quantity#140 >= 0) && (ss_quantity#140 <= 5)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(8 as decimal(1,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((8 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(459 as decimal(3,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((459 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(57 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((57 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :  :  :  :        +- SubqueryAlias `store_sales`
         :  :  :  :  :           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  :  +- SubqueryAlias `B2`
         :  :  :  :     +- Aggregate [avg(ss_list_price#142) AS B2_LP#16078, count(ss_list_price#142) AS B2_CNT#16079L, count(distinct ss_list_price#142) AS B2_CNTD#16080L]
         :  :  :  :        +- Filter (((ss_quantity#140 >= 6) && (ss_quantity#140 <= 10)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(90 as decimal(2,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((90 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(2323 as decimal(4,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((2323 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(31 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((31 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :  :  :           +- SubqueryAlias `store_sales`
         :  :  :  :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  +- SubqueryAlias `B3`
         :  :  :     +- Aggregate [avg(ss_list_price#142) AS B3_LP#16081, count(ss_list_price#142) AS B3_CNT#16082L, count(distinct ss_list_price#142) AS B3_CNTD#16083L]
         :  :  :        +- Filter (((ss_quantity#140 >= 11) && (ss_quantity#140 <= 15)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(142 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((142 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(12214 as decimal(5,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((12214 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(79 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((79 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :  :           +- SubqueryAlias `store_sales`
         :  :  :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  +- SubqueryAlias `B4`
         :  :     +- Aggregate [avg(ss_list_price#142) AS B4_LP#16084, count(ss_list_price#142) AS B4_CNT#16085L, count(distinct ss_list_price#142) AS B4_CNTD#16086L]
         :  :        +- Filter (((ss_quantity#140 >= 16) && (ss_quantity#140 <= 20)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(135 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((135 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(6071 as decimal(4,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((6071 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(38 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((38 + 20) as decimal(10,0)) as decimal(12,2))))))
         :  :           +- SubqueryAlias `store_sales`
         :  :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  +- SubqueryAlias `B5`
         :     +- Aggregate [avg(ss_list_price#142) AS B5_LP#16087, count(ss_list_price#142) AS B5_CNT#16088L, count(distinct ss_list_price#142) AS B5_CNTD#16089L]
         :        +- Filter (((ss_quantity#140 >= 21) && (ss_quantity#140 <= 25)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(122 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((122 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(836 as decimal(3,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((836 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(17 as decimal(2,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((17 + 20) as decimal(10,0)) as decimal(12,2))))))
         :           +- SubqueryAlias `store_sales`
         :              +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         +- SubqueryAlias `B6`
            +- Aggregate [avg(ss_list_price#142) AS B6_LP#16090, count(ss_list_price#142) AS B6_CNT#16091L, count(distinct ss_list_price#142) AS B6_CNTD#16092L]
               +- Filter (((ss_quantity#140 >= 26) && (ss_quantity#140 <= 30)) && ((((cast(ss_list_price#142 as decimal(7,2)) >= cast(cast(154 as decimal(3,0)) as decimal(7,2))) && (cast(ss_list_price#142 as decimal(12,2)) <= cast(cast((154 + 10) as decimal(10,0)) as decimal(12,2)))) || ((cast(ss_coupon_amt#149 as decimal(7,2)) >= cast(cast(7326 as decimal(4,0)) as decimal(7,2))) && (cast(ss_coupon_amt#149 as decimal(12,2)) <= cast(cast((7326 + 1000) as decimal(10,0)) as decimal(12,2))))) || ((cast(ss_wholesale_cost#141 as decimal(7,2)) >= cast(cast(7 as decimal(1,0)) as decimal(7,2))) && (cast(ss_wholesale_cost#141 as decimal(12,2)) <= cast(cast((7 + 20) as decimal(10,0)) as decimal(12,2))))))
                  +- SubqueryAlias `store_sales`
                     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 506.614275531s
Running execution q29-v2.4 iteration: 1, StandardRun=true
19/10/04 01:57:10 INFO Query: 
== Query: q29-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, store_sales_quantity#16437L, store_returns_quantity#16438L, catalog_sales_quantity#16439L]
      +- Sort [i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, s_store_id#665 ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669], [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, sum(cast(ss_quantity#140 as bigint)) AS store_sales_quantity#16437L, sum(cast(sr_return_quantity#186 as bigint)) AS store_returns_quantity#16438L, sum(cast(cs_quantity#18 as bigint)) AS catalog_sales_quantity#16439L]
            +- Filter (((((d_moy#500 = 9) && (d_year#498 = 1999)) && ((d_date_sk#492 = ss_sold_date_sk#130) && (i_item_sk#564 = ss_item_sk#132))) && (((s_store_sk#664 = ss_store_sk#137) && (ss_customer_sk#133 = sr_customer_sk#179)) && ((ss_item_sk#132 = sr_item_sk#178) && (ss_ticket_number#139L = sr_ticket_number#185L)))) && ((((sr_returned_date_sk#176 = d_date_sk#16440) && ((d_moy#16448 >= 9) && (d_moy#16448 <= (9 + 3)))) && ((d_year#16446 = 1999) && (sr_customer_sk#179 = cs_bill_customer_sk#3))) && (((sr_item_sk#178 = cs_item_sk#15) && (cs_sold_date_sk#0 = d_date_sk#16468)) && d_year#16474 IN (1999,(1999 + 1),(1999 + 2)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :  :  :  :  +- SubqueryAlias `catalog_sales`
                  :  :  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  :  +- SubqueryAlias `d1`
                  :  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  :  :  +- SubqueryAlias `d2`
                  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :        +- Relation[d_date_sk#16440,d_date_id#16441,d_date#16442,d_month_seq#16443,d_week_seq#16444,d_quarter_seq#16445,d_year#16446,d_dow#16447,d_moy#16448,d_dom#16449,d_qoy#16450,d_fy_year#16451,d_fy_quarter_seq#16452,d_fy_week_seq#16453,d_day_name#16454,d_quarter_name#16455,d_holiday#16456,d_weekend#16457,d_following_holiday#16458,d_first_dom#16459,d_last_dom#16460,d_same_day_ly#16461,d_same_day_lq#16462,d_current_day#16463,... 4 more fields] parquet
                  :  :  +- SubqueryAlias `d3`
                  :  :     +- SubqueryAlias `date_dim`
                  :  :        +- Relation[d_date_sk#16468,d_date_id#16469,d_date#16470,d_month_seq#16471,d_week_seq#16472,d_quarter_seq#16473,d_year#16474,d_dow#16475,d_moy#16476,d_dom#16477,d_qoy#16478,d_fy_year#16479,d_fy_quarter_seq#16480,d_fy_week_seq#16481,d_day_name#16482,d_quarter_name#16483,d_holiday#16484,d_weekend#16485,d_following_holiday#16486,d_first_dom#16487,d_last_dom#16488,d_same_day_ly#16489,d_same_day_lq#16490,d_current_day#16491,... 4 more fields] parquet
                  :  +- SubqueryAlias `store`
                  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/04 01:57:10 INFO Query: 
== Query: q29-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, store_sales_quantity#16510L, store_returns_quantity#16511L, catalog_sales_quantity#16512L]
      +- Sort [i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, s_store_id#665 ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
         +- Aggregate [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669], [i_item_id#565, i_item_desc#568, s_store_id#665, s_store_name#669, sum(cast(ss_quantity#140 as bigint)) AS store_sales_quantity#16510L, sum(cast(sr_return_quantity#186 as bigint)) AS store_returns_quantity#16511L, sum(cast(cs_quantity#18 as bigint)) AS catalog_sales_quantity#16512L]
            +- Filter (((((d_moy#500 = 9) && (d_year#498 = 1999)) && ((d_date_sk#492 = ss_sold_date_sk#130) && (i_item_sk#564 = ss_item_sk#132))) && (((s_store_sk#664 = ss_store_sk#137) && (ss_customer_sk#133 = sr_customer_sk#179)) && ((ss_item_sk#132 = sr_item_sk#178) && (ss_ticket_number#139L = sr_ticket_number#185L)))) && ((((sr_returned_date_sk#176 = d_date_sk#16513) && ((d_moy#16521 >= 9) && (d_moy#16521 <= (9 + 3)))) && ((d_year#16519 = 1999) && (sr_customer_sk#179 = cs_bill_customer_sk#3))) && (((sr_item_sk#178 = cs_item_sk#15) && (cs_sold_date_sk#0 = d_date_sk#16541)) && d_year#16547 IN (1999,(1999 + 1),(1999 + 2)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :  :  :  :  +- SubqueryAlias `catalog_sales`
                  :  :  :  :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  :  +- SubqueryAlias `d1`
                  :  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  :  :  +- SubqueryAlias `d2`
                  :  :  :     +- SubqueryAlias `date_dim`
                  :  :  :        +- Relation[d_date_sk#16513,d_date_id#16514,d_date#16515,d_month_seq#16516,d_week_seq#16517,d_quarter_seq#16518,d_year#16519,d_dow#16520,d_moy#16521,d_dom#16522,d_qoy#16523,d_fy_year#16524,d_fy_quarter_seq#16525,d_fy_week_seq#16526,d_day_name#16527,d_quarter_name#16528,d_holiday#16529,d_weekend#16530,d_following_holiday#16531,d_first_dom#16532,d_last_dom#16533,d_same_day_ly#16534,d_same_day_lq#16535,d_current_day#16536,... 4 more fields] parquet
                  :  :  +- SubqueryAlias `d3`
                  :  :     +- SubqueryAlias `date_dim`
                  :  :        +- Relation[d_date_sk#16541,d_date_id#16542,d_date#16543,d_month_seq#16544,d_week_seq#16545,d_quarter_seq#16546,d_year#16547,d_dow#16548,d_moy#16549,d_dom#16550,d_qoy#16551,d_fy_year#16552,d_fy_quarter_seq#16553,d_fy_week_seq#16554,d_day_name#16555,d_quarter_name#16556,d_holiday#16557,d_weekend#16558,d_following_holiday#16559,d_first_dom#16560,d_last_dom#16561,d_same_day_ly#16562,d_same_day_lq#16563,d_current_day#16564,... 4 more fields] parquet
                  :  +- SubqueryAlias `store`
                  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 1920.244973565s
Running execution q30-v2.4 iteration: 1, StandardRun=true
19/10/04 02:29:12 INFO Query: 
== Query: q30-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_customer_id#413 ASC NULLS FIRST, c_salutation#419 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, c_last_name#421 ASC NULLS FIRST, c_preferred_cust_flag#422 ASC NULLS FIRST, c_birth_day#423 ASC NULLS FIRST, c_birth_month#424 ASC NULLS FIRST, c_birth_year#425 ASC NULLS FIRST, c_birth_country#426 ASC NULLS FIRST, c_login#427 ASC NULLS FIRST, c_email_address#428 ASC NULLS FIRST, c_last_review_date#429 ASC NULLS FIRST, ctr_total_return#16770 ASC NULLS FIRST], true
      +- Project [c_customer_id#413, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ctr_total_return#16770]
         +- Filter (((cast(ctr_total_return#16770 as decimal(24,7)) > cast(scalar-subquery#16767 [ctr_state#16769] as decimal(24,7))) && (ca_address_sk#448 = c_current_addr_sk#416)) && ((ca_state#456 = GA) && (ctr_customer_sk#16768 = c_customer_sk#412)))
            :  +- Aggregate [CheckOverflow((promote_precision(cast(avg(ctr_total_return#16770) as decimal(21,6))) * promote_precision(cast(1.2 as decimal(21,6)))), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#16773]
            :     +- Filter (outer(ctr_state#16769) = ctr_state#16769)
            :        +- SubqueryAlias `ctr2`
            :           +- SubqueryAlias `customer_total_return`
            :              +- Aggregate [wr_returning_customer_sk#291, ca_state#456], [wr_returning_customer_sk#291 AS ctr_customer_sk#16768, ca_state#456 AS ctr_state#16769, sum(wr_return_amt#299) AS ctr_total_return#16770]
            :                 +- Filter (((wr_returned_date_sk#284 = d_date_sk#492) && (d_year#498 = 2002)) && (wr_returning_addr_sk#294 = ca_address_sk#448))
            :                    +- Join Inner
            :                       :- Join Inner
            :                       :  :- SubqueryAlias `web_returns`
            :                       :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
            :                       :  +- SubqueryAlias `date_dim`
            :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :                       +- SubqueryAlias `customer_address`
            :                          +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ctr1`
               :  :  +- SubqueryAlias `customer_total_return`
               :  :     +- Aggregate [wr_returning_customer_sk#291, ca_state#456], [wr_returning_customer_sk#291 AS ctr_customer_sk#16768, ca_state#456 AS ctr_state#16769, sum(wr_return_amt#299) AS ctr_total_return#16770]
               :  :        +- Filter (((wr_returned_date_sk#284 = d_date_sk#492) && (d_year#498 = 2002)) && (wr_returning_addr_sk#294 = ca_address_sk#448))
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- SubqueryAlias `web_returns`
               :  :              :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               :  :              :  +- SubqueryAlias `date_dim`
               :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              +- SubqueryAlias `customer_address`
               :  :                 +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer_address`
               :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer`
                  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/10/04 02:29:12 INFO Query: 
== Query: q30-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_customer_id#413 ASC NULLS FIRST, c_salutation#419 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, c_last_name#421 ASC NULLS FIRST, c_preferred_cust_flag#422 ASC NULLS FIRST, c_birth_day#423 ASC NULLS FIRST, c_birth_month#424 ASC NULLS FIRST, c_birth_year#425 ASC NULLS FIRST, c_birth_country#426 ASC NULLS FIRST, c_login#427 ASC NULLS FIRST, c_email_address#428 ASC NULLS FIRST, c_last_review_date#429 ASC NULLS FIRST, ctr_total_return#16790 ASC NULLS FIRST], true
      +- Project [c_customer_id#413, c_salutation#419, c_first_name#420, c_last_name#421, c_preferred_cust_flag#422, c_birth_day#423, c_birth_month#424, c_birth_year#425, c_birth_country#426, c_login#427, c_email_address#428, c_last_review_date#429, ctr_total_return#16790]
         +- Filter (((cast(ctr_total_return#16790 as decimal(24,7)) > cast(scalar-subquery#16787 [ctr_state#16789] as decimal(24,7))) && (ca_address_sk#448 = c_current_addr_sk#416)) && ((ca_state#456 = GA) && (ctr_customer_sk#16788 = c_customer_sk#412)))
            :  +- Aggregate [CheckOverflow((promote_precision(cast(avg(ctr_total_return#16790) as decimal(21,6))) * promote_precision(cast(1.2 as decimal(21,6)))), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#16793]
            :     +- Filter (outer(ctr_state#16789) = ctr_state#16789)
            :        +- SubqueryAlias `ctr2`
            :           +- SubqueryAlias `customer_total_return`
            :              +- Aggregate [wr_returning_customer_sk#291, ca_state#456], [wr_returning_customer_sk#291 AS ctr_customer_sk#16788, ca_state#456 AS ctr_state#16789, sum(wr_return_amt#299) AS ctr_total_return#16790]
            :                 +- Filter (((wr_returned_date_sk#284 = d_date_sk#492) && (d_year#498 = 2002)) && (wr_returning_addr_sk#294 = ca_address_sk#448))
            :                    +- Join Inner
            :                       :- Join Inner
            :                       :  :- SubqueryAlias `web_returns`
            :                       :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
            :                       :  +- SubqueryAlias `date_dim`
            :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :                       +- SubqueryAlias `customer_address`
            :                          +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ctr1`
               :  :  +- SubqueryAlias `customer_total_return`
               :  :     +- Aggregate [wr_returning_customer_sk#291, ca_state#456], [wr_returning_customer_sk#291 AS ctr_customer_sk#16788, ca_state#456 AS ctr_state#16789, sum(wr_return_amt#299) AS ctr_total_return#16790]
               :  :        +- Filter (((wr_returned_date_sk#284 = d_date_sk#492) && (d_year#498 = 2002)) && (wr_returning_addr_sk#294 = ca_address_sk#448))
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- SubqueryAlias `web_returns`
               :  :              :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               :  :              :  +- SubqueryAlias `date_dim`
               :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              +- SubqueryAlias `customer_address`
               :  :                 +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer_address`
               :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer`
                  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 74.04828078s
Running execution q31-v2.4 iteration: 1, StandardRun=true
19/10/04 02:30:28 INFO Query: 
== Query: q31-v2.4 ==
Sort [ca_county#455 ASC NULLS FIRST], true
+- Project [ca_county#455, d_year#498, CheckOverflow((promote_precision(cast(web_sales#17588 as decimal(17,2))) / promote_precision(cast(web_sales#17339 as decimal(17,2)))), DecimalType(37,20)) AS web_q1_q2_increase#17334, CheckOverflow((promote_precision(cast(store_sales#17342 as decimal(17,2))) / promote_precision(cast(store_sales#17338 as decimal(17,2)))), DecimalType(37,20)) AS store_q1_q2_increase#17335, CheckOverflow((promote_precision(cast(web_sales#17684 as decimal(17,2))) / promote_precision(cast(web_sales#17588 as decimal(17,2)))), DecimalType(37,20)) AS web_q2_q3_increase#17336, CheckOverflow((promote_precision(cast(store_sales#17438 as decimal(17,2))) / promote_precision(cast(store_sales#17342 as decimal(17,2)))), DecimalType(37,20)) AS store_q2_q3_increase#17337]
   +- Filter ((((((d_qoy#502 = 1) && (d_year#498 = 2000)) && (ca_county#455 = ca_county#17432)) && ((d_qoy#17394 = 2) && (d_year#17390 = 2000))) && ((((ca_county#17432 = ca_county#17528) && (d_qoy#17490 = 3)) && (d_year#17486 = 2000)) && ((ca_county#455 = ca_county#17582) && (d_qoy#17544 = 1)))) && (((((d_year#17540 = 2000) && (ca_county#17582 = ca_county#17678)) && (d_qoy#17640 = 2)) && ((d_year#17636 = 2000) && (ca_county#17582 = ca_county#17774))) && (((d_qoy#17736 = 3) && (d_year#17732 = 2000)) && ((CASE WHEN (cast(web_sales#17339 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(web_sales#17588 as decimal(17,2))) / promote_precision(cast(web_sales#17339 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END > CASE WHEN (cast(store_sales#17338 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(store_sales#17342 as decimal(17,2))) / promote_precision(cast(store_sales#17338 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END) && (CASE WHEN (cast(web_sales#17588 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(web_sales#17684 as decimal(17,2))) / promote_precision(cast(web_sales#17588 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END > CASE WHEN (cast(store_sales#17342 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(store_sales#17438 as decimal(17,2))) / promote_precision(cast(store_sales#17342 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END)))))
      +- Join Inner
         :- Join Inner
         :  :- Join Inner
         :  :  :- Join Inner
         :  :  :  :- Join Inner
         :  :  :  :  :- SubqueryAlias `ss1`
         :  :  :  :  :  +- SubqueryAlias `ss`
         :  :  :  :  :     +- Aggregate [ca_county#455, d_qoy#502, d_year#498], [ca_county#455, d_qoy#502, d_year#498, sum(ss_ext_sales_price#145) AS store_sales#17338]
         :  :  :  :  :        +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && (ss_addr_sk#136 = ca_address_sk#448))
         :  :  :  :  :           +- Join Inner
         :  :  :  :  :              :- Join Inner
         :  :  :  :  :              :  :- SubqueryAlias `store_sales`
         :  :  :  :  :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  :  :              :  +- SubqueryAlias `date_dim`
         :  :  :  :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :  :  :  :  :              +- SubqueryAlias `customer_address`
         :  :  :  :  :                 +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :  :  :  :  +- SubqueryAlias `ss2`
         :  :  :  :     +- SubqueryAlias `ss`
         :  :  :  :        +- Aggregate [ca_county#17432, d_qoy#17394, d_year#17390], [ca_county#17432, d_qoy#17394, d_year#17390, sum(ss_ext_sales_price#145) AS store_sales#17342]
         :  :  :  :           +- Filter ((ss_sold_date_sk#130 = d_date_sk#17384) && (ss_addr_sk#136 = ca_address_sk#17425))
         :  :  :  :              +- Join Inner
         :  :  :  :                 :- Join Inner
         :  :  :  :                 :  :- SubqueryAlias `store_sales`
         :  :  :  :                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  :                 :  +- SubqueryAlias `date_dim`
         :  :  :  :                 :     +- Relation[d_date_sk#17384,d_date_id#17385,d_date#17386,d_month_seq#17387,d_week_seq#17388,d_quarter_seq#17389,d_year#17390,d_dow#17391,d_moy#17392,d_dom#17393,d_qoy#17394,d_fy_year#17395,d_fy_quarter_seq#17396,d_fy_week_seq#17397,d_day_name#17398,d_quarter_name#17399,d_holiday#17400,d_weekend#17401,d_following_holiday#17402,d_first_dom#17403,d_last_dom#17404,d_same_day_ly#17405,d_same_day_lq#17406,d_current_day#17407,... 4 more fields] parquet
         :  :  :  :                 +- SubqueryAlias `customer_address`
         :  :  :  :                    +- Relation[ca_address_sk#17425,ca_address_id#17426,ca_street_number#17427,ca_street_name#17428,ca_street_type#17429,ca_suite_number#17430,ca_city#17431,ca_county#17432,ca_state#17433,ca_zip#17434,ca_country#17435,ca_gmt_offset#17436,ca_location_type#17437] parquet
         :  :  :  +- SubqueryAlias `ss3`
         :  :  :     +- SubqueryAlias `ss`
         :  :  :        +- Aggregate [ca_county#17528, d_qoy#17490, d_year#17486], [ca_county#17528, d_qoy#17490, d_year#17486, sum(ss_ext_sales_price#145) AS store_sales#17438]
         :  :  :           +- Filter ((ss_sold_date_sk#130 = d_date_sk#17480) && (ss_addr_sk#136 = ca_address_sk#17521))
         :  :  :              +- Join Inner
         :  :  :                 :- Join Inner
         :  :  :                 :  :- SubqueryAlias `store_sales`
         :  :  :                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :                 :  +- SubqueryAlias `date_dim`
         :  :  :                 :     +- Relation[d_date_sk#17480,d_date_id#17481,d_date#17482,d_month_seq#17483,d_week_seq#17484,d_quarter_seq#17485,d_year#17486,d_dow#17487,d_moy#17488,d_dom#17489,d_qoy#17490,d_fy_year#17491,d_fy_quarter_seq#17492,d_fy_week_seq#17493,d_day_name#17494,d_quarter_name#17495,d_holiday#17496,d_weekend#17497,d_following_holiday#17498,d_first_dom#17499,d_last_dom#17500,d_same_day_ly#17501,d_same_day_lq#17502,d_current_day#17503,... 4 more fields] parquet
         :  :  :                 +- SubqueryAlias `customer_address`
         :  :  :                    +- Relation[ca_address_sk#17521,ca_address_id#17522,ca_street_number#17523,ca_street_name#17524,ca_street_type#17525,ca_suite_number#17526,ca_city#17527,ca_county#17528,ca_state#17529,ca_zip#17530,ca_country#17531,ca_gmt_offset#17532,ca_location_type#17533] parquet
         :  :  +- SubqueryAlias `ws1`
         :  :     +- SubqueryAlias `ws`
         :  :        +- Aggregate [ca_county#17582, d_qoy#17544, d_year#17540], [ca_county#17582, d_qoy#17544, d_year#17540, sum(ws_ext_sales_price#239) AS web_sales#17339]
         :  :           +- Filter ((ws_sold_date_sk#216 = d_date_sk#17534) && (ws_bill_addr_sk#223 = ca_address_sk#17575))
         :  :              +- Join Inner
         :  :                 :- Join Inner
         :  :                 :  :- SubqueryAlias `web_sales`
         :  :                 :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
         :  :                 :  +- SubqueryAlias `date_dim`
         :  :                 :     +- Relation[d_date_sk#17534,d_date_id#17535,d_date#17536,d_month_seq#17537,d_week_seq#17538,d_quarter_seq#17539,d_year#17540,d_dow#17541,d_moy#17542,d_dom#17543,d_qoy#17544,d_fy_year#17545,d_fy_quarter_seq#17546,d_fy_week_seq#17547,d_day_name#17548,d_quarter_name#17549,d_holiday#17550,d_weekend#17551,d_following_holiday#17552,d_first_dom#17553,d_last_dom#17554,d_same_day_ly#17555,d_same_day_lq#17556,d_current_day#17557,... 4 more fields] parquet
         :  :                 +- SubqueryAlias `customer_address`
         :  :                    +- Relation[ca_address_sk#17575,ca_address_id#17576,ca_street_number#17577,ca_street_name#17578,ca_street_type#17579,ca_suite_number#17580,ca_city#17581,ca_county#17582,ca_state#17583,ca_zip#17584,ca_country#17585,ca_gmt_offset#17586,ca_location_type#17587] parquet
         :  +- SubqueryAlias `ws2`
         :     +- SubqueryAlias `ws`
         :        +- Aggregate [ca_county#17678, d_qoy#17640, d_year#17636], [ca_county#17678, d_qoy#17640, d_year#17636, sum(ws_ext_sales_price#239) AS web_sales#17588]
         :           +- Filter ((ws_sold_date_sk#216 = d_date_sk#17630) && (ws_bill_addr_sk#223 = ca_address_sk#17671))
         :              +- Join Inner
         :                 :- Join Inner
         :                 :  :- SubqueryAlias `web_sales`
         :                 :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
         :                 :  +- SubqueryAlias `date_dim`
         :                 :     +- Relation[d_date_sk#17630,d_date_id#17631,d_date#17632,d_month_seq#17633,d_week_seq#17634,d_quarter_seq#17635,d_year#17636,d_dow#17637,d_moy#17638,d_dom#17639,d_qoy#17640,d_fy_year#17641,d_fy_quarter_seq#17642,d_fy_week_seq#17643,d_day_name#17644,d_quarter_name#17645,d_holiday#17646,d_weekend#17647,d_following_holiday#17648,d_first_dom#17649,d_last_dom#17650,d_same_day_ly#17651,d_same_day_lq#17652,d_current_day#17653,... 4 more fields] parquet
         :                 +- SubqueryAlias `customer_address`
         :                    +- Relation[ca_address_sk#17671,ca_address_id#17672,ca_street_number#17673,ca_street_name#17674,ca_street_type#17675,ca_suite_number#17676,ca_city#17677,ca_county#17678,ca_state#17679,ca_zip#17680,ca_country#17681,ca_gmt_offset#17682,ca_location_type#17683] parquet
         +- SubqueryAlias `ws3`
            +- SubqueryAlias `ws`
               +- Aggregate [ca_county#17774, d_qoy#17736, d_year#17732], [ca_county#17774, d_qoy#17736, d_year#17732, sum(ws_ext_sales_price#239) AS web_sales#17684]
                  +- Filter ((ws_sold_date_sk#216 = d_date_sk#17726) && (ws_bill_addr_sk#223 = ca_address_sk#17767))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `web_sales`
                        :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  +- SubqueryAlias `date_dim`
                        :     +- Relation[d_date_sk#17726,d_date_id#17727,d_date#17728,d_month_seq#17729,d_week_seq#17730,d_quarter_seq#17731,d_year#17732,d_dow#17733,d_moy#17734,d_dom#17735,d_qoy#17736,d_fy_year#17737,d_fy_quarter_seq#17738,d_fy_week_seq#17739,d_day_name#17740,d_quarter_name#17741,d_holiday#17742,d_weekend#17743,d_following_holiday#17744,d_first_dom#17745,d_last_dom#17746,d_same_day_ly#17747,d_same_day_lq#17748,d_current_day#17749,... 4 more fields] parquet
                        +- SubqueryAlias `customer_address`
                           +- Relation[ca_address_sk#17767,ca_address_id#17768,ca_street_number#17769,ca_street_name#17770,ca_street_type#17771,ca_suite_number#17772,ca_city#17773,ca_county#17774,ca_state#17775,ca_zip#17776,ca_country#17777,ca_gmt_offset#17778,ca_location_type#17779] parquet

     : benchmark
19/10/04 02:30:29 INFO Query: 
== Query: q31-v2.4 ==
Sort [ca_county#455 ASC NULLS FIRST], true
+- Project [ca_county#455, d_year#498, CheckOverflow((promote_precision(cast(web_sales#18040 as decimal(17,2))) / promote_precision(cast(web_sales#17791 as decimal(17,2)))), DecimalType(37,20)) AS web_q1_q2_increase#17786, CheckOverflow((promote_precision(cast(store_sales#17794 as decimal(17,2))) / promote_precision(cast(store_sales#17790 as decimal(17,2)))), DecimalType(37,20)) AS store_q1_q2_increase#17787, CheckOverflow((promote_precision(cast(web_sales#18136 as decimal(17,2))) / promote_precision(cast(web_sales#18040 as decimal(17,2)))), DecimalType(37,20)) AS web_q2_q3_increase#17788, CheckOverflow((promote_precision(cast(store_sales#17890 as decimal(17,2))) / promote_precision(cast(store_sales#17794 as decimal(17,2)))), DecimalType(37,20)) AS store_q2_q3_increase#17789]
   +- Filter ((((((d_qoy#502 = 1) && (d_year#498 = 2000)) && (ca_county#455 = ca_county#17884)) && ((d_qoy#17846 = 2) && (d_year#17842 = 2000))) && ((((ca_county#17884 = ca_county#17980) && (d_qoy#17942 = 3)) && (d_year#17938 = 2000)) && ((ca_county#455 = ca_county#18034) && (d_qoy#17996 = 1)))) && (((((d_year#17992 = 2000) && (ca_county#18034 = ca_county#18130)) && (d_qoy#18092 = 2)) && ((d_year#18088 = 2000) && (ca_county#18034 = ca_county#18226))) && (((d_qoy#18188 = 3) && (d_year#18184 = 2000)) && ((CASE WHEN (cast(web_sales#17791 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(web_sales#18040 as decimal(17,2))) / promote_precision(cast(web_sales#17791 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END > CASE WHEN (cast(store_sales#17790 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(store_sales#17794 as decimal(17,2))) / promote_precision(cast(store_sales#17790 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END) && (CASE WHEN (cast(web_sales#18040 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(web_sales#18136 as decimal(17,2))) / promote_precision(cast(web_sales#18040 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END > CASE WHEN (cast(store_sales#17794 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(store_sales#17890 as decimal(17,2))) / promote_precision(cast(store_sales#17794 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END)))))
      +- Join Inner
         :- Join Inner
         :  :- Join Inner
         :  :  :- Join Inner
         :  :  :  :- Join Inner
         :  :  :  :  :- SubqueryAlias `ss1`
         :  :  :  :  :  +- SubqueryAlias `ss`
         :  :  :  :  :     +- Aggregate [ca_county#455, d_qoy#502, d_year#498], [ca_county#455, d_qoy#502, d_year#498, sum(ss_ext_sales_price#145) AS store_sales#17790]
         :  :  :  :  :        +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && (ss_addr_sk#136 = ca_address_sk#448))
         :  :  :  :  :           +- Join Inner
         :  :  :  :  :              :- Join Inner
         :  :  :  :  :              :  :- SubqueryAlias `store_sales`
         :  :  :  :  :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  :  :              :  +- SubqueryAlias `date_dim`
         :  :  :  :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :  :  :  :  :              +- SubqueryAlias `customer_address`
         :  :  :  :  :                 +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :  :  :  :  +- SubqueryAlias `ss2`
         :  :  :  :     +- SubqueryAlias `ss`
         :  :  :  :        +- Aggregate [ca_county#17884, d_qoy#17846, d_year#17842], [ca_county#17884, d_qoy#17846, d_year#17842, sum(ss_ext_sales_price#145) AS store_sales#17794]
         :  :  :  :           +- Filter ((ss_sold_date_sk#130 = d_date_sk#17836) && (ss_addr_sk#136 = ca_address_sk#17877))
         :  :  :  :              +- Join Inner
         :  :  :  :                 :- Join Inner
         :  :  :  :                 :  :- SubqueryAlias `store_sales`
         :  :  :  :                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :  :                 :  +- SubqueryAlias `date_dim`
         :  :  :  :                 :     +- Relation[d_date_sk#17836,d_date_id#17837,d_date#17838,d_month_seq#17839,d_week_seq#17840,d_quarter_seq#17841,d_year#17842,d_dow#17843,d_moy#17844,d_dom#17845,d_qoy#17846,d_fy_year#17847,d_fy_quarter_seq#17848,d_fy_week_seq#17849,d_day_name#17850,d_quarter_name#17851,d_holiday#17852,d_weekend#17853,d_following_holiday#17854,d_first_dom#17855,d_last_dom#17856,d_same_day_ly#17857,d_same_day_lq#17858,d_current_day#17859,... 4 more fields] parquet
         :  :  :  :                 +- SubqueryAlias `customer_address`
         :  :  :  :                    +- Relation[ca_address_sk#17877,ca_address_id#17878,ca_street_number#17879,ca_street_name#17880,ca_street_type#17881,ca_suite_number#17882,ca_city#17883,ca_county#17884,ca_state#17885,ca_zip#17886,ca_country#17887,ca_gmt_offset#17888,ca_location_type#17889] parquet
         :  :  :  +- SubqueryAlias `ss3`
         :  :  :     +- SubqueryAlias `ss`
         :  :  :        +- Aggregate [ca_county#17980, d_qoy#17942, d_year#17938], [ca_county#17980, d_qoy#17942, d_year#17938, sum(ss_ext_sales_price#145) AS store_sales#17890]
         :  :  :           +- Filter ((ss_sold_date_sk#130 = d_date_sk#17932) && (ss_addr_sk#136 = ca_address_sk#17973))
         :  :  :              +- Join Inner
         :  :  :                 :- Join Inner
         :  :  :                 :  :- SubqueryAlias `store_sales`
         :  :  :                 :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :  :  :                 :  +- SubqueryAlias `date_dim`
         :  :  :                 :     +- Relation[d_date_sk#17932,d_date_id#17933,d_date#17934,d_month_seq#17935,d_week_seq#17936,d_quarter_seq#17937,d_year#17938,d_dow#17939,d_moy#17940,d_dom#17941,d_qoy#17942,d_fy_year#17943,d_fy_quarter_seq#17944,d_fy_week_seq#17945,d_day_name#17946,d_quarter_name#17947,d_holiday#17948,d_weekend#17949,d_following_holiday#17950,d_first_dom#17951,d_last_dom#17952,d_same_day_ly#17953,d_same_day_lq#17954,d_current_day#17955,... 4 more fields] parquet
         :  :  :                 +- SubqueryAlias `customer_address`
         :  :  :                    +- Relation[ca_address_sk#17973,ca_address_id#17974,ca_street_number#17975,ca_street_name#17976,ca_street_type#17977,ca_suite_number#17978,ca_city#17979,ca_county#17980,ca_state#17981,ca_zip#17982,ca_country#17983,ca_gmt_offset#17984,ca_location_type#17985] parquet
         :  :  +- SubqueryAlias `ws1`
         :  :     +- SubqueryAlias `ws`
         :  :        +- Aggregate [ca_county#18034, d_qoy#17996, d_year#17992], [ca_county#18034, d_qoy#17996, d_year#17992, sum(ws_ext_sales_price#239) AS web_sales#17791]
         :  :           +- Filter ((ws_sold_date_sk#216 = d_date_sk#17986) && (ws_bill_addr_sk#223 = ca_address_sk#18027))
         :  :              +- Join Inner
         :  :                 :- Join Inner
         :  :                 :  :- SubqueryAlias `web_sales`
         :  :                 :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
         :  :                 :  +- SubqueryAlias `date_dim`
         :  :                 :     +- Relation[d_date_sk#17986,d_date_id#17987,d_date#17988,d_month_seq#17989,d_week_seq#17990,d_quarter_seq#17991,d_year#17992,d_dow#17993,d_moy#17994,d_dom#17995,d_qoy#17996,d_fy_year#17997,d_fy_quarter_seq#17998,d_fy_week_seq#17999,d_day_name#18000,d_quarter_name#18001,d_holiday#18002,d_weekend#18003,d_following_holiday#18004,d_first_dom#18005,d_last_dom#18006,d_same_day_ly#18007,d_same_day_lq#18008,d_current_day#18009,... 4 more fields] parquet
         :  :                 +- SubqueryAlias `customer_address`
         :  :                    +- Relation[ca_address_sk#18027,ca_address_id#18028,ca_street_number#18029,ca_street_name#18030,ca_street_type#18031,ca_suite_number#18032,ca_city#18033,ca_county#18034,ca_state#18035,ca_zip#18036,ca_country#18037,ca_gmt_offset#18038,ca_location_type#18039] parquet
         :  +- SubqueryAlias `ws2`
         :     +- SubqueryAlias `ws`
         :        +- Aggregate [ca_county#18130, d_qoy#18092, d_year#18088], [ca_county#18130, d_qoy#18092, d_year#18088, sum(ws_ext_sales_price#239) AS web_sales#18040]
         :           +- Filter ((ws_sold_date_sk#216 = d_date_sk#18082) && (ws_bill_addr_sk#223 = ca_address_sk#18123))
         :              +- Join Inner
         :                 :- Join Inner
         :                 :  :- SubqueryAlias `web_sales`
         :                 :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
         :                 :  +- SubqueryAlias `date_dim`
         :                 :     +- Relation[d_date_sk#18082,d_date_id#18083,d_date#18084,d_month_seq#18085,d_week_seq#18086,d_quarter_seq#18087,d_year#18088,d_dow#18089,d_moy#18090,d_dom#18091,d_qoy#18092,d_fy_year#18093,d_fy_quarter_seq#18094,d_fy_week_seq#18095,d_day_name#18096,d_quarter_name#18097,d_holiday#18098,d_weekend#18099,d_following_holiday#18100,d_first_dom#18101,d_last_dom#18102,d_same_day_ly#18103,d_same_day_lq#18104,d_current_day#18105,... 4 more fields] parquet
         :                 +- SubqueryAlias `customer_address`
         :                    +- Relation[ca_address_sk#18123,ca_address_id#18124,ca_street_number#18125,ca_street_name#18126,ca_street_type#18127,ca_suite_number#18128,ca_city#18129,ca_county#18130,ca_state#18131,ca_zip#18132,ca_country#18133,ca_gmt_offset#18134,ca_location_type#18135] parquet
         +- SubqueryAlias `ws3`
            +- SubqueryAlias `ws`
               +- Aggregate [ca_county#18226, d_qoy#18188, d_year#18184], [ca_county#18226, d_qoy#18188, d_year#18184, sum(ws_ext_sales_price#239) AS web_sales#18136]
                  +- Filter ((ws_sold_date_sk#216 = d_date_sk#18178) && (ws_bill_addr_sk#223 = ca_address_sk#18219))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `web_sales`
                        :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  +- SubqueryAlias `date_dim`
                        :     +- Relation[d_date_sk#18178,d_date_id#18179,d_date#18180,d_month_seq#18181,d_week_seq#18182,d_quarter_seq#18183,d_year#18184,d_dow#18185,d_moy#18186,d_dom#18187,d_qoy#18188,d_fy_year#18189,d_fy_quarter_seq#18190,d_fy_week_seq#18191,d_day_name#18192,d_quarter_name#18193,d_holiday#18194,d_weekend#18195,d_following_holiday#18196,d_first_dom#18197,d_last_dom#18198,d_same_day_ly#18199,d_same_day_lq#18200,d_current_day#18201,... 4 more fields] parquet
                        +- SubqueryAlias `customer_address`
                           +- Relation[ca_address_sk#18219,ca_address_id#18220,ca_street_number#18221,ca_street_name#18222,ca_street_type#18223,ca_suite_number#18224,ca_city#18225,ca_county#18226,ca_state#18227,ca_zip#18228,ca_country#18229,ca_gmt_offset#18230,ca_location_type#18231] parquet

      running Thread[benchmark runner,5,main]
Execution time: 395.207889722s
Running execution q32-v2.4 iteration: 1, StandardRun=true
19/10/04 02:37:06 INFO Query: 
== Query: q32-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [sum(cs_ext_discount_amt#22) AS excess discount amount#19179]
      +- Filter ((((i_manufact_id#577 = 977) && (i_item_sk#564 = cs_item_sk#15)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && ((d_date_sk#492 = cs_sold_date_sk#0) && (cast(cs_ext_discount_amt#22 as decimal(14,7)) > cast(scalar-subquery#19180 [i_item_sk#564] as decimal(14,7)))))
         :  +- Aggregate [CheckOverflow((promote_precision(cast(1.3 as decimal(11,6))) * promote_precision(cast(avg(cs_ext_discount_amt#22) as decimal(11,6)))), DecimalType(14,7)) AS (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(cs_ext_discount_amt) AS DECIMAL(11,6)))#19182]
         :     +- Filter (((cs_item_sk#15 = outer(i_item_sk#564)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && (d_date_sk#492 = cs_sold_date_sk#0))
         :        +- Join Inner
         :           :- SubqueryAlias `catalog_sales`
         :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :           +- SubqueryAlias `date_dim`
         :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- Join Inner
            :- Join Inner
            :  :- SubqueryAlias `catalog_sales`
            :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :  +- SubqueryAlias `item`
            :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            +- SubqueryAlias `date_dim`
               +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/04 02:37:06 INFO Query: 
== Query: q32-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [sum(cs_ext_discount_amt#22) AS excess discount amount#19185]
      +- Filter ((((i_manufact_id#577 = 977) && (i_item_sk#564 = cs_item_sk#15)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && ((d_date_sk#492 = cs_sold_date_sk#0) && (cast(cs_ext_discount_amt#22 as decimal(14,7)) > cast(scalar-subquery#19186 [i_item_sk#564] as decimal(14,7)))))
         :  +- Aggregate [CheckOverflow((promote_precision(cast(1.3 as decimal(11,6))) * promote_precision(cast(avg(cs_ext_discount_amt#22) as decimal(11,6)))), DecimalType(14,7)) AS (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(cs_ext_discount_amt) AS DECIMAL(11,6)))#19188]
         :     +- Filter (((cs_item_sk#15 = outer(i_item_sk#564)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && (d_date_sk#492 = cs_sold_date_sk#0))
         :        +- Join Inner
         :           :- SubqueryAlias `catalog_sales`
         :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :           +- SubqueryAlias `date_dim`
         :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- Join Inner
            :- Join Inner
            :  :- SubqueryAlias `catalog_sales`
            :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :  +- SubqueryAlias `item`
            :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            +- SubqueryAlias `date_dim`
               +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 124.153404576s
Running execution q33-v2.4 iteration: 1, StandardRun=true
19/10/04 02:39:13 INFO Query: 
== Query: q33-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [total_sales#19239 ASC NULLS FIRST], true
      +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(total_sales#19240) AS total_sales#19239]
         +- SubqueryAlias `tmp1`
            +- Union
               :- Union
               :  :- Project [i_manufact_id#577, total_sales#19240]
               :  :  +- SubqueryAlias `ss`
               :  :     +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(ss_ext_sales_price#145) AS total_sales#19240]
               :  :        +- Filter (((i_manufact_id#577 IN (list#19241 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 5) && (ss_addr_sk#136 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :  :           :  +- Project [i_manufact_id#577]
               :  :           :     +- Filter i_category#576 IN (Electronics)
               :  :           :        +- SubqueryAlias `item`
               :  :           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- Join Inner
               :  :              :  :  :- SubqueryAlias `store_sales`
               :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :              :  :  +- SubqueryAlias `date_dim`
               :  :              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              :  +- SubqueryAlias `customer_address`
               :  :              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  :              +- SubqueryAlias `item`
               :  :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- Project [i_manufact_id#577, total_sales#19242]
               :     +- SubqueryAlias `cs`
               :        +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(cs_ext_sales_price#23) AS total_sales#19242]
               :           +- Filter (((i_manufact_id#577 IN (list#19243 []) && (cs_item_sk#15 = i_item_sk#564)) && ((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 5) && (cs_bill_addr_sk#6 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :              :  +- Project [i_manufact_id#577]
               :              :     +- Filter i_category#576 IN (Electronics)
               :              :        +- SubqueryAlias `item`
               :              :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- Join Inner
               :                 :  :  :- SubqueryAlias `catalog_sales`
               :                 :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :  :  +- SubqueryAlias `date_dim`
               :                 :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :  +- SubqueryAlias `customer_address`
               :                 :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :                 +- SubqueryAlias `item`
               :                    +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Project [i_manufact_id#577, total_sales#19244]
                  +- SubqueryAlias `ws`
                     +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(ws_ext_sales_price#239) AS total_sales#19244]
                        +- Filter (((i_manufact_id#577 IN (list#19245 []) && (ws_item_sk#219 = i_item_sk#564)) && ((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 5) && (ws_bill_addr_sk#223 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
                           :  +- Project [i_manufact_id#577]
                           :     +- Filter i_category#576 IN (Electronics)
                           :        +- SubqueryAlias `item`
                           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `web_sales`
                              :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :  +- SubqueryAlias `date_dim`
                              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `customer_address`
                              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/04 02:39:13 INFO Query: 
== Query: q33-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [total_sales#19253 ASC NULLS FIRST], true
      +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(total_sales#19254) AS total_sales#19253]
         +- SubqueryAlias `tmp1`
            +- Union
               :- Union
               :  :- Project [i_manufact_id#577, total_sales#19254]
               :  :  +- SubqueryAlias `ss`
               :  :     +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(ss_ext_sales_price#145) AS total_sales#19254]
               :  :        +- Filter (((i_manufact_id#577 IN (list#19255 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 5) && (ss_addr_sk#136 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :  :           :  +- Project [i_manufact_id#577]
               :  :           :     +- Filter i_category#576 IN (Electronics)
               :  :           :        +- SubqueryAlias `item`
               :  :           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- Join Inner
               :  :              :  :  :- SubqueryAlias `store_sales`
               :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :              :  :  +- SubqueryAlias `date_dim`
               :  :              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              :  +- SubqueryAlias `customer_address`
               :  :              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  :              +- SubqueryAlias `item`
               :  :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- Project [i_manufact_id#577, total_sales#19256]
               :     +- SubqueryAlias `cs`
               :        +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(cs_ext_sales_price#23) AS total_sales#19256]
               :           +- Filter (((i_manufact_id#577 IN (list#19257 []) && (cs_item_sk#15 = i_item_sk#564)) && ((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 5) && (cs_bill_addr_sk#6 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :              :  +- Project [i_manufact_id#577]
               :              :     +- Filter i_category#576 IN (Electronics)
               :              :        +- SubqueryAlias `item`
               :              :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- Join Inner
               :                 :  :  :- SubqueryAlias `catalog_sales`
               :                 :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :  :  +- SubqueryAlias `date_dim`
               :                 :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :  +- SubqueryAlias `customer_address`
               :                 :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :                 +- SubqueryAlias `item`
               :                    +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Project [i_manufact_id#577, total_sales#19258]
                  +- SubqueryAlias `ws`
                     +- Aggregate [i_manufact_id#577], [i_manufact_id#577, sum(ws_ext_sales_price#239) AS total_sales#19258]
                        +- Filter (((i_manufact_id#577 IN (list#19259 []) && (ws_item_sk#219 = i_item_sk#564)) && ((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 5) && (ws_bill_addr_sk#223 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
                           :  +- Project [i_manufact_id#577]
                           :     +- Filter i_category#576 IN (Electronics)
                           :        +- SubqueryAlias `item`
                           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `web_sales`
                              :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :  +- SubqueryAlias `date_dim`
                              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `customer_address`
                              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 235.736542164s
Running execution q34-v2.4 iteration: 1, StandardRun=true
19/10/04 02:43:10 INFO Query: 
== Query: q34-v2.4 ==
Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, c_salutation#419 ASC NULLS FIRST, c_preferred_cust_flag#422 DESC NULLS LAST, ss_ticket_number#139L ASC NULLS FIRST], true
+- Project [c_last_name#421, c_first_name#420, c_salutation#419, c_preferred_cust_flag#422, ss_ticket_number#139L, cnt#19320L]
   +- Filter ((ss_customer_sk#133 = c_customer_sk#412) && ((cnt#19320L >= cast(15 as bigint)) && (cnt#19320L <= cast(20 as bigint))))
      +- Join Inner
         :- SubqueryAlias `dn`
         :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133], [ss_ticket_number#139L, ss_customer_sk#133, count(1) AS cnt#19320L]
         :     +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((((d_dom#501 >= 1) && (d_dom#501 <= 3)) || ((d_dom#501 >= 25) && (d_dom#501 <= 28))) && ((hd_buy_potential#550 = >10000) || (hd_buy_potential#550 = unknown)))) && (((hd_vehicle_count#552 > 0) && (CASE WHEN (hd_vehicle_count#552 > 0) THEN (cast(hd_dep_count#551 as double) / cast(hd_vehicle_count#552 as double)) ELSE cast(null as double) END > cast(1.2 as double))) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_county#687 IN (Williamson County,Williamson County,Williamson County,Williamson County,Williamson County,Williamson County,Williamson County,Williamson County))))
         :        +- Join Inner
         :           :- Join Inner
         :           :  :- Join Inner
         :           :  :  :- SubqueryAlias `store_sales`
         :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :           :  :  +- SubqueryAlias `date_dim`
         :           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :           :  +- SubqueryAlias `store`
         :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :           +- SubqueryAlias `household_demographics`
         :              +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         +- SubqueryAlias `customer`
            +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/10/04 02:43:10 INFO Query: 
== Query: q34-v2.4 ==
Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, c_salutation#419 ASC NULLS FIRST, c_preferred_cust_flag#422 DESC NULLS LAST, ss_ticket_number#139L ASC NULLS FIRST], true
+- Project [c_last_name#421, c_first_name#420, c_salutation#419, c_preferred_cust_flag#422, ss_ticket_number#139L, cnt#19328L]
   +- Filter ((ss_customer_sk#133 = c_customer_sk#412) && ((cnt#19328L >= cast(15 as bigint)) && (cnt#19328L <= cast(20 as bigint))))
      +- Join Inner
         :- SubqueryAlias `dn`
         :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133], [ss_ticket_number#139L, ss_customer_sk#133, count(1) AS cnt#19328L]
         :     +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((((d_dom#501 >= 1) && (d_dom#501 <= 3)) || ((d_dom#501 >= 25) && (d_dom#501 <= 28))) && ((hd_buy_potential#550 = >10000) || (hd_buy_potential#550 = unknown)))) && (((hd_vehicle_count#552 > 0) && (CASE WHEN (hd_vehicle_count#552 > 0) THEN (cast(hd_dep_count#551 as double) / cast(hd_vehicle_count#552 as double)) ELSE cast(null as double) END > cast(1.2 as double))) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_county#687 IN (Williamson County,Williamson County,Williamson County,Williamson County,Williamson County,Williamson County,Williamson County,Williamson County))))
         :        +- Join Inner
         :           :- Join Inner
         :           :  :- Join Inner
         :           :  :  :- SubqueryAlias `store_sales`
         :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :           :  :  +- SubqueryAlias `date_dim`
         :           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :           :  +- SubqueryAlias `store`
         :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :           +- SubqueryAlias `household_demographics`
         :              +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         +- SubqueryAlias `customer`
            +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 96.349101734s
Running execution q35-v2.4 iteration: 1, StandardRun=true
19/10/04 02:44:49 INFO Query: 
== Query: q35-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ca_state#456, cd_gender#475, cd_marital_status#476, cd_dep_count#480, cnt1#19434L, min(cd_dep_count)#19452, max(cd_dep_count)#19453, avg(cd_dep_count)#19454, cd_dep_employed_count#481, cnt2#19435L, min(cd_dep_employed_count)#19455, max(cd_dep_employed_count)#19456, avg(cd_dep_employed_count)#19457, cd_dep_college_count#482, cnt3#19436L, min(cd_dep_college_count)#19458, max(cd_dep_college_count)#19459, avg(cd_dep_college_count)#19460]
      +- Sort [ca_state#456 ASC NULLS FIRST, cd_gender#475 ASC NULLS FIRST, cd_marital_status#476 ASC NULLS FIRST, cd_dep_count#480 ASC NULLS FIRST, cd_dep_employed_count#481 ASC NULLS FIRST, cd_dep_college_count#482 ASC NULLS FIRST], true
         +- Aggregate [ca_state#456, cd_gender#475, cd_marital_status#476, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482], [ca_state#456, cd_gender#475, cd_marital_status#476, cd_dep_count#480, count(1) AS cnt1#19434L, min(cd_dep_count#480) AS min(cd_dep_count)#19452, max(cd_dep_count#480) AS max(cd_dep_count)#19453, avg(cast(cd_dep_count#480 as bigint)) AS avg(cd_dep_count)#19454, cd_dep_employed_count#481, count(1) AS cnt2#19435L, min(cd_dep_employed_count#481) AS min(cd_dep_employed_count)#19455, max(cd_dep_employed_count#481) AS max(cd_dep_employed_count)#19456, avg(cast(cd_dep_employed_count#481 as bigint)) AS avg(cd_dep_employed_count)#19457, cd_dep_college_count#482, count(1) AS cnt3#19436L, min(cd_dep_college_count#482) AS min(cd_dep_college_count)#19458, max(cd_dep_college_count#482) AS max(cd_dep_college_count)#19459, avg(cast(cd_dep_college_count#482 as bigint)) AS avg(cd_dep_college_count)#19460]
            +- Filter (((c_current_addr_sk#416 = ca_address_sk#448) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && (exists#19437 [c_customer_sk#412] && (exists#19438 [c_customer_sk#412] || exists#19439 [c_customer_sk#412])))
               :  :- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 27 more fields]
               :  :  +- Filter (((outer(c_customer_sk#412) = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = 2002) && (d_qoy#502 < 4)))
               :  :     +- Join Inner
               :  :        :- SubqueryAlias `store_sales`
               :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :        +- SubqueryAlias `date_dim`
               :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 38 more fields]
               :  :  +- Filter (((outer(c_customer_sk#412) = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = 2002) && (d_qoy#502 < 4)))
               :  :     +- Join Inner
               :  :        :- SubqueryAlias `web_sales`
               :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :        +- SubqueryAlias `date_dim`
               :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 38 more fields]
               :     +- Filter (((outer(c_customer_sk#412) = cs_ship_customer_sk#7) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = 2002) && (d_qoy#502 < 4)))
               :        +- Join Inner
               :           :- SubqueryAlias `catalog_sales`
               :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :           +- SubqueryAlias `date_dim`
               :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- SubqueryAlias `c`
                  :  :  +- SubqueryAlias `customer`
                  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  +- SubqueryAlias `ca`
                  :     +- SubqueryAlias `customer_address`
                  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `customer_demographics`
                     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet

     : benchmark
19/10/04 02:44:49 INFO Query: 
== Query: q35-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ca_state#456, cd_gender#475, cd_marital_status#476, cd_dep_count#480, cnt1#19485L, min(cd_dep_count)#19503, max(cd_dep_count)#19504, avg(cd_dep_count)#19505, cd_dep_employed_count#481, cnt2#19486L, min(cd_dep_employed_count)#19506, max(cd_dep_employed_count)#19507, avg(cd_dep_employed_count)#19508, cd_dep_college_count#482, cnt3#19487L, min(cd_dep_college_count)#19509, max(cd_dep_college_count)#19510, avg(cd_dep_college_count)#19511]
      +- Sort [ca_state#456 ASC NULLS FIRST, cd_gender#475 ASC NULLS FIRST, cd_marital_status#476 ASC NULLS FIRST, cd_dep_count#480 ASC NULLS FIRST, cd_dep_employed_count#481 ASC NULLS FIRST, cd_dep_college_count#482 ASC NULLS FIRST], true
         +- Aggregate [ca_state#456, cd_gender#475, cd_marital_status#476, cd_dep_count#480, cd_dep_employed_count#481, cd_dep_college_count#482], [ca_state#456, cd_gender#475, cd_marital_status#476, cd_dep_count#480, count(1) AS cnt1#19485L, min(cd_dep_count#480) AS min(cd_dep_count)#19503, max(cd_dep_count#480) AS max(cd_dep_count)#19504, avg(cast(cd_dep_count#480 as bigint)) AS avg(cd_dep_count)#19505, cd_dep_employed_count#481, count(1) AS cnt2#19486L, min(cd_dep_employed_count#481) AS min(cd_dep_employed_count)#19506, max(cd_dep_employed_count#481) AS max(cd_dep_employed_count)#19507, avg(cast(cd_dep_employed_count#481 as bigint)) AS avg(cd_dep_employed_count)#19508, cd_dep_college_count#482, count(1) AS cnt3#19487L, min(cd_dep_college_count#482) AS min(cd_dep_college_count)#19509, max(cd_dep_college_count#482) AS max(cd_dep_college_count)#19510, avg(cast(cd_dep_college_count#482 as bigint)) AS avg(cd_dep_college_count)#19511]
            +- Filter (((c_current_addr_sk#416 = ca_address_sk#448) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && (exists#19488 [c_customer_sk#412] && (exists#19489 [c_customer_sk#412] || exists#19490 [c_customer_sk#412])))
               :  :- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 27 more fields]
               :  :  +- Filter (((outer(c_customer_sk#412) = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = 2002) && (d_qoy#502 < 4)))
               :  :     +- Join Inner
               :  :        :- SubqueryAlias `store_sales`
               :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :        +- SubqueryAlias `date_dim`
               :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 38 more fields]
               :  :  +- Filter (((outer(c_customer_sk#412) = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = 2002) && (d_qoy#502 < 4)))
               :  :     +- Join Inner
               :  :        :- SubqueryAlias `web_sales`
               :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :        +- SubqueryAlias `date_dim`
               :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 38 more fields]
               :     +- Filter (((outer(c_customer_sk#412) = cs_ship_customer_sk#7) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = 2002) && (d_qoy#502 < 4)))
               :        +- Join Inner
               :           :- SubqueryAlias `catalog_sales`
               :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :           +- SubqueryAlias `date_dim`
               :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- SubqueryAlias `c`
                  :  :  +- SubqueryAlias `customer`
                  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  +- SubqueryAlias `ca`
                  :     +- SubqueryAlias `customer_address`
                  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `customer_demographics`
                     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet

      running Thread[benchmark runner,5,main]
Execution time: 183.247855705s
Running execution q36-v2.4 iteration: 1, StandardRun=true
19/10/04 02:47:54 INFO Query: 
== Query: q36-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#19715 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#19715 as int) = 0) THEN i_category#19726 END ASC NULLS FIRST, rank_within_parent#19716 ASC NULLS FIRST], true
      +- Project [gross_margin#19714, i_category#19726, i_class#19727, lochierarchy#19715, rank_within_parent#19716]
         +- Project [gross_margin#19714, i_category#19726, i_class#19727, lochierarchy#19715, _w0#19736, _w1#19740, _w2#19741, _w3#19742, rank_within_parent#19716, rank_within_parent#19716]
            +- Window [rank(_w3#19742) windowspecdefinition(_w1#19740, _w2#19741, _w3#19742 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#19716], [_w1#19740, _w2#19741], [_w3#19742 ASC NULLS FIRST]
               +- Aggregate [i_category#19726, i_class#19727, spark_grouping_id#19723], [CheckOverflow((promote_precision(cast(sum(ss_net_profit#152) as decimal(17,2))) / promote_precision(cast(sum(ss_ext_sales_price#145) as decimal(17,2)))), DecimalType(37,20)) AS gross_margin#19714, i_category#19726, i_class#19727, (cast((shiftright(spark_grouping_id#19723, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#19723, 0) & 1) as tinyint)) AS lochierarchy#19715, CheckOverflow((promote_precision(cast(sum(ss_net_profit#152) as decimal(17,2))) / promote_precision(cast(sum(ss_ext_sales_price#145) as decimal(17,2)))), DecimalType(37,20)) AS _w0#19736, (cast((shiftright(spark_grouping_id#19723, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#19723, 0) & 1) as tinyint)) AS _w1#19740, CASE WHEN (cast(cast((shiftright(spark_grouping_id#19723, 0) & 1) as tinyint) as int) = 0) THEN i_category#19726 END AS _w2#19741, CheckOverflow((promote_precision(cast(sum(ss_net_profit#152) as decimal(17,2))) / promote_precision(cast(sum(ss_ext_sales_price#145) as decimal(17,2)))), DecimalType(37,20)) AS _w3#19742]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_category#19724, i_class#19725, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_category#19724, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 81 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 80 more fields]
                        +- Filter ((((d_year#498 = 2001) && (d_date_sk#492 = ss_sold_date_sk#130)) && (i_item_sk#564 = ss_item_sk#132)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (TN,TN,TN,TN,TN,TN,TN,TN)))
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `store_sales`
                              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  :  +- SubqueryAlias `d1`
                              :  :     +- SubqueryAlias `date_dim`
                              :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `item`
                              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/10/04 02:47:54 INFO Query: 
== Query: q36-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#19758 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#19758 as int) = 0) THEN i_category#19769 END ASC NULLS FIRST, rank_within_parent#19759 ASC NULLS FIRST], true
      +- Project [gross_margin#19757, i_category#19769, i_class#19770, lochierarchy#19758, rank_within_parent#19759]
         +- Project [gross_margin#19757, i_category#19769, i_class#19770, lochierarchy#19758, _w0#19779, _w1#19783, _w2#19784, _w3#19785, rank_within_parent#19759, rank_within_parent#19759]
            +- Window [rank(_w3#19785) windowspecdefinition(_w1#19783, _w2#19784, _w3#19785 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#19759], [_w1#19783, _w2#19784], [_w3#19785 ASC NULLS FIRST]
               +- Aggregate [i_category#19769, i_class#19770, spark_grouping_id#19766], [CheckOverflow((promote_precision(cast(sum(ss_net_profit#152) as decimal(17,2))) / promote_precision(cast(sum(ss_ext_sales_price#145) as decimal(17,2)))), DecimalType(37,20)) AS gross_margin#19757, i_category#19769, i_class#19770, (cast((shiftright(spark_grouping_id#19766, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#19766, 0) & 1) as tinyint)) AS lochierarchy#19758, CheckOverflow((promote_precision(cast(sum(ss_net_profit#152) as decimal(17,2))) / promote_precision(cast(sum(ss_ext_sales_price#145) as decimal(17,2)))), DecimalType(37,20)) AS _w0#19779, (cast((shiftright(spark_grouping_id#19766, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#19766, 0) & 1) as tinyint)) AS _w1#19783, CASE WHEN (cast(cast((shiftright(spark_grouping_id#19766, 0) & 1) as tinyint) as int) = 0) THEN i_category#19769 END AS _w2#19784, CheckOverflow((promote_precision(cast(sum(ss_net_profit#152) as decimal(17,2))) / promote_precision(cast(sum(ss_ext_sales_price#145) as decimal(17,2)))), DecimalType(37,20)) AS _w3#19785]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_category#19767, i_class#19768, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_category#19767, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 81 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 80 more fields]
                        +- Filter ((((d_year#498 = 2001) && (d_date_sk#492 = ss_sold_date_sk#130)) && (i_item_sk#564 = ss_item_sk#132)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (TN,TN,TN,TN,TN,TN,TN,TN)))
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `store_sales`
                              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  :  +- SubqueryAlias `d1`
                              :  :     +- SubqueryAlias `date_dim`
                              :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `item`
                              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 142.46338547800002s
Running execution q37-v2.4 iteration: 1, StandardRun=true
19/10/04 02:50:18 INFO Query: 
== Query: q37-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(68 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((68 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-02-01 as date)) && (d_date#494 <= cast(cast(cast(2000-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (677,940,694,808) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (cs_item_sk#15 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `catalog_sales`
                  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet

     : benchmark
19/10/04 02:50:19 INFO Query: 
== Query: q37-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(68 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((68 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-02-01 as date)) && (d_date#494 <= cast(cast(cast(2000-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (677,940,694,808) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (cs_item_sk#15 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `catalog_sales`
                  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet

      running Thread[benchmark runner,5,main]
19/10/04 02:51:25 WARN TaskSetManager: Lost task 6049.0 in stage 544.0 (TID 984978, 192.168.39.158, executor 181): java.io.IOException: can not read FileMetaData: org.apache.hadoop.fs.s3a.AWSClientIOException: read on s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_sales/part-01027-10e4b037-4521-4ea1-80ea-c6a987fb8fc8-c000.snappy.parquet: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at org.apache.parquet.format.Util.readFileMetaData(Util.java:195)
	at org.apache.parquet.format.Util.readFileMetaData(Util.java:85)
	at org.apache.parquet.format.converter.ParquetMetadataConverter$2.visit(ParquetMetadataConverter.java:871)
	at org.apache.parquet.format.converter.ParquetMetadataConverter$2.visit(ParquetMetadataConverter.java:863)
	at org.apache.parquet.format.converter.ParquetMetadataConverter$SkipMetadataFilter.accept(ParquetMetadataConverter.java:757)
	at org.apache.parquet.format.converter.ParquetMetadataConverter.readParquetMetadata(ParquetMetadataConverter.java:863)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:532)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:505)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:499)
	at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:448)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.footerFileMetaData$lzycompute$1(ParquetFileFormat.scala:371)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.footerFileMetaData$1(ParquetFileFormat.scala:370)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.apply(ParquetFileFormat.scala:374)
	at org.apache.spark.sql.execution.datasources.parquet.ParquetFileFormat$$anonfun$buildReaderWithPartitionValues$1.apply(ParquetFileFormat.scala:352)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:124)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:177)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:101)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage5.scan_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage5.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$13$$anon$1.hasNext(WholeStageCodegenExec.scala:636)
	at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner$$anonfun$10.apply(Executor.scala:408)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1360)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:414)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
	Suppressed: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
		at com.amazonaws.util.LengthCheckInputStream.checkLength(LengthCheckInputStream.java:151)
		at com.amazonaws.util.LengthCheckInputStream.read(LengthCheckInputStream.java:93)
		at com.amazonaws.internal.SdkFilterInputStream.read(SdkFilterInputStream.java:76)
		at org.apache.hadoop.fs.s3a.S3AInputStream.closeStream(S3AInputStream.java:529)
		at org.apache.hadoop.fs.s3a.S3AInputStream.close(S3AInputStream.java:490)
		at java.io.FilterInputStream.close(FilterInputStream.java:181)
		at org.apache.parquet.io.DelegatingSeekableInputStream.close(DelegatingSeekableInputStream.java:50)
		at org.apache.parquet.hadoop.ParquetFileReader.readFooter(ParquetFileReader.java:500)
		... 23 more
Caused by: shaded.parquet.org.apache.thrift.transport.TTransportException: org.apache.hadoop.fs.s3a.AWSClientIOException: read on s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_sales/part-01027-10e4b037-4521-4ea1-80ea-c6a987fb8fc8-c000.snappy.parquet: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at shaded.parquet.org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:129)
	at shaded.parquet.org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)
	at shaded.parquet.org.apache.thrift.protocol.TCompactProtocol.readByte(TCompactProtocol.java:634)
	at shaded.parquet.org.apache.thrift.protocol.TCompactProtocol.readFieldBegin(TCompactProtocol.java:539)
	at org.apache.parquet.format.InterningProtocol.readFieldBegin(InterningProtocol.java:158)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:108)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:138)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:112)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:112)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:138)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:112)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:138)
	at shaded.parquet.org.apache.thrift.protocol.TProtocolUtil.skip(TProtocolUtil.java:60)
	at org.apache.parquet.format.event.SkippingFieldConsumer.consumeField(Consumers.java:155)
	at org.apache.parquet.format.event.Consumers$DelegatingFieldConsumer.consumeField(Consumers.java:99)
	at org.apache.parquet.format.event.EventBasedThriftReader.readStructContent(EventBasedThriftReader.java:73)
	at org.apache.parquet.format.event.EventBasedThriftReader.readStruct(EventBasedThriftReader.java:57)
	at org.apache.parquet.format.Util.readFileMetaData(Util.java:192)
	... 31 more
Caused by: org.apache.hadoop.fs.s3a.AWSClientIOException: read on s3a://spark-k8s-data/TPCDS-TEST-10T/catalog_sales/part-01027-10e4b037-4521-4ea1-80ea-c6a987fb8fc8-c000.snappy.parquet: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at org.apache.hadoop.fs.s3a.S3AUtils.translateException(S3AUtils.java:177)
	at org.apache.hadoop.fs.s3a.Invoker.once(Invoker.java:111)
	at org.apache.hadoop.fs.s3a.Invoker.lambda$retry$3(Invoker.java:260)
	at org.apache.hadoop.fs.s3a.Invoker.retryUntranslated(Invoker.java:317)
	at org.apache.hadoop.fs.s3a.Invoker.retry(Invoker.java:256)
	at org.apache.hadoop.fs.s3a.Invoker.retry(Invoker.java:231)
	at org.apache.hadoop.fs.s3a.S3AInputStream.read(S3AInputStream.java:441)
	at java.io.DataInputStream.read(DataInputStream.java:149)
	at org.apache.parquet.io.DelegatingSeekableInputStream.read(DelegatingSeekableInputStream.java:66)
	at shaded.parquet.org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:127)
	... 48 more
Caused by: com.amazonaws.SdkClientException: Data read has a different length than the expected: dataLength=8562; expectedLength=20075; includeSkipped=true; in.getClass()=class com.amazonaws.services.s3.AmazonS3Client$2; markedSupported=false; marked=0; resetSinceLastMarked=false; markCount=0; resetCount=0
	at com.amazonaws.util.LengthCheckInputStream.checkLength(LengthCheckInputStream.java:151)
	at com.amazonaws.util.LengthCheckInputStream.read(LengthCheckInputStream.java:109)
	at com.amazonaws.internal.SdkFilterInputStream.read(SdkFilterInputStream.java:82)
	at org.apache.hadoop.fs.s3a.S3AInputStream.lambda$read$3(S3AInputStream.java:445)
	at org.apache.hadoop.fs.s3a.Invoker.once(Invoker.java:109)
	... 56 more

Execution time: 133.63055209499998s
Running execution q38-v2.4 iteration: 1, StandardRun=true
19/10/04 02:52:34 INFO Query: 
== Query: q38-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [count(1) AS count(1)#20169L]
      +- SubqueryAlias `hot_cust`
         +- Intersect false
            :- Project [c_last_name#421, c_first_name#420, d_date#494]
            :  +- Intersect false
            :     :- Project [c_last_name#421, c_first_name#420, d_date#494]
            :     :  +- Distinct
            :     :     +- Project [c_last_name#421, c_first_name#420, d_date#494]
            :     :        +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_customer_sk#133 = c_customer_sk#412)) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
            :     :           +- Join Inner
            :     :              :- Join Inner
            :     :              :  :- SubqueryAlias `store_sales`
            :     :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :              :  +- SubqueryAlias `date_dim`
            :     :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     :              +- SubqueryAlias `customer`
            :     :                 +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :     +- Project [c_last_name#20096, c_first_name#20095, d_date#20042]
            :        +- Distinct
            :           +- Project [c_last_name#20096, c_first_name#20095, d_date#20042]
            :              +- Filter (((cs_sold_date_sk#0 = d_date_sk#20040) && (cs_bill_customer_sk#3 = c_customer_sk#20087)) && ((d_month_seq#20043 >= 1200) && (d_month_seq#20043 <= (1200 + 11))))
            :                 +- Join Inner
            :                    :- Join Inner
            :                    :  :- SubqueryAlias `catalog_sales`
            :                    :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :                    :  +- SubqueryAlias `date_dim`
            :                    :     +- Relation[d_date_sk#20040,d_date_id#20041,d_date#20042,d_month_seq#20043,d_week_seq#20044,d_quarter_seq#20045,d_year#20046,d_dow#20047,d_moy#20048,d_dom#20049,d_qoy#20050,d_fy_year#20051,d_fy_quarter_seq#20052,d_fy_week_seq#20053,d_day_name#20054,d_quarter_name#20055,d_holiday#20056,d_weekend#20057,d_following_holiday#20058,d_first_dom#20059,d_last_dom#20060,d_same_day_ly#20061,d_same_day_lq#20062,d_current_day#20063,... 4 more fields] parquet
            :                    +- SubqueryAlias `customer`
            :                       +- Relation[c_customer_sk#20087,c_customer_id#20088,c_current_cdemo_sk#20089,c_current_hdemo_sk#20090,c_current_addr_sk#20091,c_first_shipto_date_sk#20092,c_first_sales_date_sk#20093,c_salutation#20094,c_first_name#20095,c_last_name#20096,c_preferred_cust_flag#20097,c_birth_day#20098,c_birth_month#20099,c_birth_year#20100,c_birth_country#20101,c_login#20102,c_email_address#20103,c_last_review_date#20104] parquet
            +- Project [c_last_name#20160, c_first_name#20159, d_date#20107]
               +- Distinct
                  +- Project [c_last_name#20160, c_first_name#20159, d_date#20107]
                     +- Filter (((ws_sold_date_sk#216 = d_date_sk#20105) && (ws_bill_customer_sk#220 = c_customer_sk#20151)) && ((d_month_seq#20108 >= 1200) && (d_month_seq#20108 <= (1200 + 11))))
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `web_sales`
                           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :  +- SubqueryAlias `date_dim`
                           :     +- Relation[d_date_sk#20105,d_date_id#20106,d_date#20107,d_month_seq#20108,d_week_seq#20109,d_quarter_seq#20110,d_year#20111,d_dow#20112,d_moy#20113,d_dom#20114,d_qoy#20115,d_fy_year#20116,d_fy_quarter_seq#20117,d_fy_week_seq#20118,d_day_name#20119,d_quarter_name#20120,d_holiday#20121,d_weekend#20122,d_following_holiday#20123,d_first_dom#20124,d_last_dom#20125,d_same_day_ly#20126,d_same_day_lq#20127,d_current_day#20128,... 4 more fields] parquet
                           +- SubqueryAlias `customer`
                              +- Relation[c_customer_sk#20151,c_customer_id#20152,c_current_cdemo_sk#20153,c_current_hdemo_sk#20154,c_current_addr_sk#20155,c_first_shipto_date_sk#20156,c_first_sales_date_sk#20157,c_salutation#20158,c_first_name#20159,c_last_name#20160,c_preferred_cust_flag#20161,c_birth_day#20162,c_birth_month#20163,c_birth_year#20164,c_birth_country#20165,c_login#20166,c_email_address#20167,c_last_review_date#20168] parquet

     : benchmark
19/10/04 02:52:34 INFO Query: 
== Query: q38-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [count(1) AS count(1)#20300L]
      +- SubqueryAlias `hot_cust`
         +- Intersect false
            :- Project [c_last_name#421, c_first_name#420, d_date#494]
            :  +- Intersect false
            :     :- Project [c_last_name#421, c_first_name#420, d_date#494]
            :     :  +- Distinct
            :     :     +- Project [c_last_name#421, c_first_name#420, d_date#494]
            :     :        +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_customer_sk#133 = c_customer_sk#412)) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
            :     :           +- Join Inner
            :     :              :- Join Inner
            :     :              :  :- SubqueryAlias `store_sales`
            :     :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :     :              :  +- SubqueryAlias `date_dim`
            :     :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     :              +- SubqueryAlias `customer`
            :     :                 +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :     +- Project [c_last_name#20227, c_first_name#20226, d_date#20173]
            :        +- Distinct
            :           +- Project [c_last_name#20227, c_first_name#20226, d_date#20173]
            :              +- Filter (((cs_sold_date_sk#0 = d_date_sk#20171) && (cs_bill_customer_sk#3 = c_customer_sk#20218)) && ((d_month_seq#20174 >= 1200) && (d_month_seq#20174 <= (1200 + 11))))
            :                 +- Join Inner
            :                    :- Join Inner
            :                    :  :- SubqueryAlias `catalog_sales`
            :                    :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :                    :  +- SubqueryAlias `date_dim`
            :                    :     +- Relation[d_date_sk#20171,d_date_id#20172,d_date#20173,d_month_seq#20174,d_week_seq#20175,d_quarter_seq#20176,d_year#20177,d_dow#20178,d_moy#20179,d_dom#20180,d_qoy#20181,d_fy_year#20182,d_fy_quarter_seq#20183,d_fy_week_seq#20184,d_day_name#20185,d_quarter_name#20186,d_holiday#20187,d_weekend#20188,d_following_holiday#20189,d_first_dom#20190,d_last_dom#20191,d_same_day_ly#20192,d_same_day_lq#20193,d_current_day#20194,... 4 more fields] parquet
            :                    +- SubqueryAlias `customer`
            :                       +- Relation[c_customer_sk#20218,c_customer_id#20219,c_current_cdemo_sk#20220,c_current_hdemo_sk#20221,c_current_addr_sk#20222,c_first_shipto_date_sk#20223,c_first_sales_date_sk#20224,c_salutation#20225,c_first_name#20226,c_last_name#20227,c_preferred_cust_flag#20228,c_birth_day#20229,c_birth_month#20230,c_birth_year#20231,c_birth_country#20232,c_login#20233,c_email_address#20234,c_last_review_date#20235] parquet
            +- Project [c_last_name#20291, c_first_name#20290, d_date#20238]
               +- Distinct
                  +- Project [c_last_name#20291, c_first_name#20290, d_date#20238]
                     +- Filter (((ws_sold_date_sk#216 = d_date_sk#20236) && (ws_bill_customer_sk#220 = c_customer_sk#20282)) && ((d_month_seq#20239 >= 1200) && (d_month_seq#20239 <= (1200 + 11))))
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `web_sales`
                           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :  +- SubqueryAlias `date_dim`
                           :     +- Relation[d_date_sk#20236,d_date_id#20237,d_date#20238,d_month_seq#20239,d_week_seq#20240,d_quarter_seq#20241,d_year#20242,d_dow#20243,d_moy#20244,d_dom#20245,d_qoy#20246,d_fy_year#20247,d_fy_quarter_seq#20248,d_fy_week_seq#20249,d_day_name#20250,d_quarter_name#20251,d_holiday#20252,d_weekend#20253,d_following_holiday#20254,d_first_dom#20255,d_last_dom#20256,d_same_day_ly#20257,d_same_day_lq#20258,d_current_day#20259,... 4 more fields] parquet
                           +- SubqueryAlias `customer`
                              +- Relation[c_customer_sk#20282,c_customer_id#20283,c_current_cdemo_sk#20284,c_current_hdemo_sk#20285,c_current_addr_sk#20286,c_first_shipto_date_sk#20287,c_first_sales_date_sk#20288,c_salutation#20289,c_first_name#20290,c_last_name#20291,c_preferred_cust_flag#20292,c_birth_day#20293,c_birth_month#20294,c_birth_year#20295,c_birth_country#20296,c_login#20297,c_email_address#20298,c_last_review_date#20299] parquet

      running Thread[benchmark runner,5,main]
Execution time: 246.892112639s
Running execution q39a-v2.4 iteration: 1, StandardRun=true
19/10/04 02:56:43 INFO Query: 
== Query: q39a-v2.4 ==
Sort [w_warehouse_sk#742 ASC NULLS FIRST, i_item_sk#564 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, mean#20942 ASC NULLS FIRST, cov#20943 ASC NULLS FIRST, d_moy#21217 ASC NULLS FIRST, mean#21038 ASC NULLS FIRST, cov#20970 ASC NULLS FIRST], true
+- Project [w_warehouse_sk#742, i_item_sk#564, d_moy#500, mean#20942, cov#20943, w_warehouse_sk#21167, i_item_sk#21103, d_moy#21217, mean#21038, cov#20970]
   +- Filter (((i_item_sk#564 = i_item_sk#21103) && (w_warehouse_sk#742 = w_warehouse_sk#21167)) && ((d_moy#500 = 1) && (d_moy#21217 = (1 + 1))))
      +- Join Inner
         :- SubqueryAlias `inv1`
         :  +- SubqueryAlias `inv`
         :     +- Project [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stdev#20941, mean#20942, CASE WHEN (mean#20942 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#20941 / mean#20942) END AS cov#20943]
         :        +- Filter (CASE WHEN (mean#20942 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#20941 / mean#20942) END > cast(1 as double))
         :           +- SubqueryAlias `foo`
         :              +- Aggregate [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500], [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#20941, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#20942]
         :                 +- Filter (((inv_item_sk#123 = i_item_sk#564) && (inv_warehouse_sk#124 = w_warehouse_sk#742)) && ((inv_date_sk#122 = d_date_sk#492) && (d_year#498 = 2001)))
         :                    +- Join Inner
         :                       :- Join Inner
         :                       :  :- Join Inner
         :                       :  :  :- SubqueryAlias `inventory`
         :                       :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
         :                       :  :  +- SubqueryAlias `item`
         :                       :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         :                       :  +- SubqueryAlias `warehouse`
         :                       :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
         :                       +- SubqueryAlias `date_dim`
         :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- SubqueryAlias `inv2`
            +- SubqueryAlias `inv`
               +- Project [w_warehouse_name#21169, w_warehouse_sk#21167, i_item_sk#21103, d_moy#21217, stdev#21037, mean#21038, CASE WHEN (mean#21038 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#21037 / mean#21038) END AS cov#20970]
                  +- Filter (CASE WHEN (mean#21038 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#21037 / mean#21038) END > cast(1 as double))
                     +- SubqueryAlias `foo`
                        +- Aggregate [w_warehouse_name#21169, w_warehouse_sk#21167, i_item_sk#21103, d_moy#21217], [w_warehouse_name#21169, w_warehouse_sk#21167, i_item_sk#21103, d_moy#21217, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#21037, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#21038]
                           +- Filter (((inv_item_sk#123 = i_item_sk#21103) && (inv_warehouse_sk#124 = w_warehouse_sk#21167)) && ((inv_date_sk#122 = d_date_sk#21209) && (d_year#21215 = 2001)))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `inventory`
                                 :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                                 :  :  +- SubqueryAlias `item`
                                 :  :     +- Relation[i_item_sk#21103,i_item_id#21104,i_rec_start_date#21105,i_rec_end_date#21106,i_item_desc#21107,i_current_price#21108,i_wholesale_cost#21109,i_brand_id#21110,i_brand#21111,i_class_id#21112,i_class#21113,i_category_id#21114,i_category#21115,i_manufact_id#21116,i_manufact#21117,i_size#21118,i_formulation#21119,i_color#21120,i_units#21121,i_container#21122,i_manager_id#21123,i_product_name#21124] parquet
                                 :  +- SubqueryAlias `warehouse`
                                 :     +- Relation[w_warehouse_sk#21167,w_warehouse_id#21168,w_warehouse_name#21169,w_warehouse_sq_ft#21170,w_street_number#21171,w_street_name#21172,w_street_type#21173,w_suite_number#21174,w_city#21175,w_county#21176,w_state#21177,w_zip#21178,w_country#21179,w_gmt_offset#21180] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#21209,d_date_id#21210,d_date#21211,d_month_seq#21212,d_week_seq#21213,d_quarter_seq#21214,d_year#21215,d_dow#21216,d_moy#21217,d_dom#21218,d_qoy#21219,d_fy_year#21220,d_fy_quarter_seq#21221,d_fy_week_seq#21222,d_day_name#21223,d_quarter_name#21224,d_holiday#21225,d_weekend#21226,d_following_holiday#21227,d_first_dom#21228,d_last_dom#21229,d_same_day_ly#21230,d_same_day_lq#21231,d_current_day#21232,... 4 more fields] parquet

     : benchmark
19/10/04 02:56:43 INFO Query: 
== Query: q39a-v2.4 ==
Sort [w_warehouse_sk#742 ASC NULLS FIRST, i_item_sk#564 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, mean#21248 ASC NULLS FIRST, cov#21249 ASC NULLS FIRST, d_moy#21523 ASC NULLS FIRST, mean#21344 ASC NULLS FIRST, cov#21276 ASC NULLS FIRST], true
+- Project [w_warehouse_sk#742, i_item_sk#564, d_moy#500, mean#21248, cov#21249, w_warehouse_sk#21473, i_item_sk#21409, d_moy#21523, mean#21344, cov#21276]
   +- Filter (((i_item_sk#564 = i_item_sk#21409) && (w_warehouse_sk#742 = w_warehouse_sk#21473)) && ((d_moy#500 = 1) && (d_moy#21523 = (1 + 1))))
      +- Join Inner
         :- SubqueryAlias `inv1`
         :  +- SubqueryAlias `inv`
         :     +- Project [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stdev#21247, mean#21248, CASE WHEN (mean#21248 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#21247 / mean#21248) END AS cov#21249]
         :        +- Filter (CASE WHEN (mean#21248 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#21247 / mean#21248) END > cast(1 as double))
         :           +- SubqueryAlias `foo`
         :              +- Aggregate [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500], [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#21247, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#21248]
         :                 +- Filter (((inv_item_sk#123 = i_item_sk#564) && (inv_warehouse_sk#124 = w_warehouse_sk#742)) && ((inv_date_sk#122 = d_date_sk#492) && (d_year#498 = 2001)))
         :                    +- Join Inner
         :                       :- Join Inner
         :                       :  :- Join Inner
         :                       :  :  :- SubqueryAlias `inventory`
         :                       :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
         :                       :  :  +- SubqueryAlias `item`
         :                       :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         :                       :  +- SubqueryAlias `warehouse`
         :                       :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
         :                       +- SubqueryAlias `date_dim`
         :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- SubqueryAlias `inv2`
            +- SubqueryAlias `inv`
               +- Project [w_warehouse_name#21475, w_warehouse_sk#21473, i_item_sk#21409, d_moy#21523, stdev#21343, mean#21344, CASE WHEN (mean#21344 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#21343 / mean#21344) END AS cov#21276]
                  +- Filter (CASE WHEN (mean#21344 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#21343 / mean#21344) END > cast(1 as double))
                     +- SubqueryAlias `foo`
                        +- Aggregate [w_warehouse_name#21475, w_warehouse_sk#21473, i_item_sk#21409, d_moy#21523], [w_warehouse_name#21475, w_warehouse_sk#21473, i_item_sk#21409, d_moy#21523, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#21343, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#21344]
                           +- Filter (((inv_item_sk#123 = i_item_sk#21409) && (inv_warehouse_sk#124 = w_warehouse_sk#21473)) && ((inv_date_sk#122 = d_date_sk#21515) && (d_year#21521 = 2001)))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `inventory`
                                 :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                                 :  :  +- SubqueryAlias `item`
                                 :  :     +- Relation[i_item_sk#21409,i_item_id#21410,i_rec_start_date#21411,i_rec_end_date#21412,i_item_desc#21413,i_current_price#21414,i_wholesale_cost#21415,i_brand_id#21416,i_brand#21417,i_class_id#21418,i_class#21419,i_category_id#21420,i_category#21421,i_manufact_id#21422,i_manufact#21423,i_size#21424,i_formulation#21425,i_color#21426,i_units#21427,i_container#21428,i_manager_id#21429,i_product_name#21430] parquet
                                 :  +- SubqueryAlias `warehouse`
                                 :     +- Relation[w_warehouse_sk#21473,w_warehouse_id#21474,w_warehouse_name#21475,w_warehouse_sq_ft#21476,w_street_number#21477,w_street_name#21478,w_street_type#21479,w_suite_number#21480,w_city#21481,w_county#21482,w_state#21483,w_zip#21484,w_country#21485,w_gmt_offset#21486] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#21515,d_date_id#21516,d_date#21517,d_month_seq#21518,d_week_seq#21519,d_quarter_seq#21520,d_year#21521,d_dow#21522,d_moy#21523,d_dom#21524,d_qoy#21525,d_fy_year#21526,d_fy_quarter_seq#21527,d_fy_week_seq#21528,d_day_name#21529,d_quarter_name#21530,d_holiday#21531,d_weekend#21532,d_following_holiday#21533,d_first_dom#21534,d_last_dom#21535,d_same_day_ly#21536,d_same_day_lq#21537,d_current_day#21538,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 18.295782688s
Running execution q39b-v2.4 iteration: 1, StandardRun=true
19/10/04 02:57:03 INFO Query: 
== Query: q39b-v2.4 ==
Sort [w_warehouse_sk#742 ASC NULLS FIRST, i_item_sk#564 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, mean#22609 ASC NULLS FIRST, cov#22610 ASC NULLS FIRST, d_moy#22884 ASC NULLS FIRST, mean#22705 ASC NULLS FIRST, cov#22637 ASC NULLS FIRST], true
+- Project [w_warehouse_sk#742, i_item_sk#564, d_moy#500, mean#22609, cov#22610, w_warehouse_sk#22834, i_item_sk#22770, d_moy#22884, mean#22705, cov#22637]
   +- Filter ((((i_item_sk#564 = i_item_sk#22770) && (w_warehouse_sk#742 = w_warehouse_sk#22834)) && (d_moy#500 = 1)) && ((d_moy#22884 = (1 + 1)) && (cov#22610 > cast(1.5 as double))))
      +- Join Inner
         :- SubqueryAlias `inv1`
         :  +- SubqueryAlias `inv`
         :     +- Project [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stdev#22608, mean#22609, CASE WHEN (mean#22609 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#22608 / mean#22609) END AS cov#22610]
         :        +- Filter (CASE WHEN (mean#22609 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#22608 / mean#22609) END > cast(1 as double))
         :           +- SubqueryAlias `foo`
         :              +- Aggregate [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500], [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#22608, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#22609]
         :                 +- Filter (((inv_item_sk#123 = i_item_sk#564) && (inv_warehouse_sk#124 = w_warehouse_sk#742)) && ((inv_date_sk#122 = d_date_sk#492) && (d_year#498 = 2001)))
         :                    +- Join Inner
         :                       :- Join Inner
         :                       :  :- Join Inner
         :                       :  :  :- SubqueryAlias `inventory`
         :                       :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
         :                       :  :  +- SubqueryAlias `item`
         :                       :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         :                       :  +- SubqueryAlias `warehouse`
         :                       :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
         :                       +- SubqueryAlias `date_dim`
         :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- SubqueryAlias `inv2`
            +- SubqueryAlias `inv`
               +- Project [w_warehouse_name#22836, w_warehouse_sk#22834, i_item_sk#22770, d_moy#22884, stdev#22704, mean#22705, CASE WHEN (mean#22705 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#22704 / mean#22705) END AS cov#22637]
                  +- Filter (CASE WHEN (mean#22705 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#22704 / mean#22705) END > cast(1 as double))
                     +- SubqueryAlias `foo`
                        +- Aggregate [w_warehouse_name#22836, w_warehouse_sk#22834, i_item_sk#22770, d_moy#22884], [w_warehouse_name#22836, w_warehouse_sk#22834, i_item_sk#22770, d_moy#22884, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#22704, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#22705]
                           +- Filter (((inv_item_sk#123 = i_item_sk#22770) && (inv_warehouse_sk#124 = w_warehouse_sk#22834)) && ((inv_date_sk#122 = d_date_sk#22876) && (d_year#22882 = 2001)))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `inventory`
                                 :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                                 :  :  +- SubqueryAlias `item`
                                 :  :     +- Relation[i_item_sk#22770,i_item_id#22771,i_rec_start_date#22772,i_rec_end_date#22773,i_item_desc#22774,i_current_price#22775,i_wholesale_cost#22776,i_brand_id#22777,i_brand#22778,i_class_id#22779,i_class#22780,i_category_id#22781,i_category#22782,i_manufact_id#22783,i_manufact#22784,i_size#22785,i_formulation#22786,i_color#22787,i_units#22788,i_container#22789,i_manager_id#22790,i_product_name#22791] parquet
                                 :  +- SubqueryAlias `warehouse`
                                 :     +- Relation[w_warehouse_sk#22834,w_warehouse_id#22835,w_warehouse_name#22836,w_warehouse_sq_ft#22837,w_street_number#22838,w_street_name#22839,w_street_type#22840,w_suite_number#22841,w_city#22842,w_county#22843,w_state#22844,w_zip#22845,w_country#22846,w_gmt_offset#22847] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#22876,d_date_id#22877,d_date#22878,d_month_seq#22879,d_week_seq#22880,d_quarter_seq#22881,d_year#22882,d_dow#22883,d_moy#22884,d_dom#22885,d_qoy#22886,d_fy_year#22887,d_fy_quarter_seq#22888,d_fy_week_seq#22889,d_day_name#22890,d_quarter_name#22891,d_holiday#22892,d_weekend#22893,d_following_holiday#22894,d_first_dom#22895,d_last_dom#22896,d_same_day_ly#22897,d_same_day_lq#22898,d_current_day#22899,... 4 more fields] parquet

     : benchmark
19/10/04 02:57:03 INFO Query: 
== Query: q39b-v2.4 ==
Sort [w_warehouse_sk#742 ASC NULLS FIRST, i_item_sk#564 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, mean#22915 ASC NULLS FIRST, cov#22916 ASC NULLS FIRST, d_moy#23190 ASC NULLS FIRST, mean#23011 ASC NULLS FIRST, cov#22943 ASC NULLS FIRST], true
+- Project [w_warehouse_sk#742, i_item_sk#564, d_moy#500, mean#22915, cov#22916, w_warehouse_sk#23140, i_item_sk#23076, d_moy#23190, mean#23011, cov#22943]
   +- Filter ((((i_item_sk#564 = i_item_sk#23076) && (w_warehouse_sk#742 = w_warehouse_sk#23140)) && (d_moy#500 = 1)) && ((d_moy#23190 = (1 + 1)) && (cov#22916 > cast(1.5 as double))))
      +- Join Inner
         :- SubqueryAlias `inv1`
         :  +- SubqueryAlias `inv`
         :     +- Project [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stdev#22914, mean#22915, CASE WHEN (mean#22915 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#22914 / mean#22915) END AS cov#22916]
         :        +- Filter (CASE WHEN (mean#22915 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#22914 / mean#22915) END > cast(1 as double))
         :           +- SubqueryAlias `foo`
         :              +- Aggregate [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500], [w_warehouse_name#744, w_warehouse_sk#742, i_item_sk#564, d_moy#500, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#22914, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#22915]
         :                 +- Filter (((inv_item_sk#123 = i_item_sk#564) && (inv_warehouse_sk#124 = w_warehouse_sk#742)) && ((inv_date_sk#122 = d_date_sk#492) && (d_year#498 = 2001)))
         :                    +- Join Inner
         :                       :- Join Inner
         :                       :  :- Join Inner
         :                       :  :  :- SubqueryAlias `inventory`
         :                       :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
         :                       :  :  +- SubqueryAlias `item`
         :                       :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         :                       :  +- SubqueryAlias `warehouse`
         :                       :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
         :                       +- SubqueryAlias `date_dim`
         :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- SubqueryAlias `inv2`
            +- SubqueryAlias `inv`
               +- Project [w_warehouse_name#23142, w_warehouse_sk#23140, i_item_sk#23076, d_moy#23190, stdev#23010, mean#23011, CASE WHEN (mean#23011 = cast(0 as double)) THEN cast(null as double) ELSE (stdev#23010 / mean#23011) END AS cov#22943]
                  +- Filter (CASE WHEN (mean#23011 = cast(0 as double)) THEN cast(0 as double) ELSE (stdev#23010 / mean#23011) END > cast(1 as double))
                     +- SubqueryAlias `foo`
                        +- Aggregate [w_warehouse_name#23142, w_warehouse_sk#23140, i_item_sk#23076, d_moy#23190], [w_warehouse_name#23142, w_warehouse_sk#23140, i_item_sk#23076, d_moy#23190, stddev_samp(cast(inv_quantity_on_hand#125 as double)) AS stdev#23010, avg(cast(inv_quantity_on_hand#125 as bigint)) AS mean#23011]
                           +- Filter (((inv_item_sk#123 = i_item_sk#23076) && (inv_warehouse_sk#124 = w_warehouse_sk#23140)) && ((inv_date_sk#122 = d_date_sk#23182) && (d_year#23188 = 2001)))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `inventory`
                                 :  :  :  +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
                                 :  :  +- SubqueryAlias `item`
                                 :  :     +- Relation[i_item_sk#23076,i_item_id#23077,i_rec_start_date#23078,i_rec_end_date#23079,i_item_desc#23080,i_current_price#23081,i_wholesale_cost#23082,i_brand_id#23083,i_brand#23084,i_class_id#23085,i_class#23086,i_category_id#23087,i_category#23088,i_manufact_id#23089,i_manufact#23090,i_size#23091,i_formulation#23092,i_color#23093,i_units#23094,i_container#23095,i_manager_id#23096,i_product_name#23097] parquet
                                 :  +- SubqueryAlias `warehouse`
                                 :     +- Relation[w_warehouse_sk#23140,w_warehouse_id#23141,w_warehouse_name#23142,w_warehouse_sq_ft#23143,w_street_number#23144,w_street_name#23145,w_street_type#23146,w_suite_number#23147,w_city#23148,w_county#23149,w_state#23150,w_zip#23151,w_country#23152,w_gmt_offset#23153] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#23182,d_date_id#23183,d_date#23184,d_month_seq#23185,d_week_seq#23186,d_quarter_seq#23187,d_year#23188,d_dow#23189,d_moy#23190,d_dom#23191,d_qoy#23192,d_fy_year#23193,d_fy_quarter_seq#23194,d_fy_week_seq#23195,d_day_name#23196,d_quarter_name#23197,d_holiday#23198,d_weekend#23199,d_following_holiday#23200,d_first_dom#23201,d_last_dom#23202,d_same_day_ly#23203,d_same_day_lq#23204,d_current_day#23205,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 14.802772227s
Running execution q40-v2.4 iteration: 1, StandardRun=true
19/10/04 02:57:20 INFO Query: 
== Query: q40-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [w_state#752, i_item_id#565, sales_before#23915, sales_after#23916]
      +- Sort [w_state#752 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST], true
         +- Aggregate [w_state#752, i_item_id#565], [w_state#752, i_item_id#565, sum(CASE WHEN (cast(d_date#494 as date) < cast(2000-03-11 as date)) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_refunded_cash#91 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2)) ELSE cast(0 as decimal(13,2)) END) AS sales_before#23915, sum(CASE WHEN (cast(d_date#494 as date) >= cast(2000-03-11 as date)) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_refunded_cash#91 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2)) ELSE cast(0 as decimal(13,2)) END) AS sales_after#23916]
            +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(0.99 as decimal(7,2))) && (cast(i_current_price#569 as decimal(7,2)) <= cast(1.49 as decimal(7,2)))) && (i_item_sk#564 = cs_item_sk#15)) && (cs_warehouse_sk#14 = w_warehouse_sk#742)) && ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(cast(cast(2000-03-11 as date) as timestamp) - interval 4 weeks 2 days as date)) && (d_date#494 <= cast(cast(cast(2000-03-11 as date) as timestamp) + interval 4 weeks 2 days as date)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
                  :  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `catalog_returns`
                  :  :  :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                  :  :  +- SubqueryAlias `warehouse`
                  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/04 02:57:20 INFO Query: 
== Query: q40-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [w_state#752, i_item_id#565, sales_before#23925, sales_after#23926]
      +- Sort [w_state#752 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST], true
         +- Aggregate [w_state#752, i_item_id#565], [w_state#752, i_item_id#565, sum(CASE WHEN (cast(d_date#494 as date) < cast(2000-03-11 as date)) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_refunded_cash#91 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2)) ELSE cast(0 as decimal(13,2)) END) AS sales_before#23925, sum(CASE WHEN (cast(d_date#494 as date) >= cast(2000-03-11 as date)) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_refunded_cash#91 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2)) ELSE cast(0 as decimal(13,2)) END) AS sales_after#23926]
            +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(0.99 as decimal(7,2))) && (cast(i_current_price#569 as decimal(7,2)) <= cast(1.49 as decimal(7,2)))) && (i_item_sk#564 = cs_item_sk#15)) && (cs_warehouse_sk#14 = w_warehouse_sk#742)) && ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(cast(cast(2000-03-11 as date) as timestamp) - interval 4 weeks 2 days as date)) && (d_date#494 <= cast(cast(cast(2000-03-11 as date) as timestamp) + interval 4 weeks 2 days as date)))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
                  :  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `catalog_returns`
                  :  :  :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                  :  :  +- SubqueryAlias `warehouse`
                  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 467.908326636s
Running execution q41-v2.4 iteration: 1, StandardRun=true
19/10/04 03:05:09 INFO Query: 
== Query: q41-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_product_name#585 ASC NULLS FIRST], true
      +- Distinct
         +- Project [i_product_name#585]
            +- Filter (((i_manufact_id#577 >= 738) && (i_manufact_id#577 <= (738 + 40))) && (scalar-subquery#23969 [i_manufact#578 && i_manufact#578] > cast(0 as bigint)))
               :  +- Aggregate [count(1) AS item_cnt#23968L]
               :     +- Filter (((i_manufact#578 = outer(i_manufact#578)) && (((((i_category#576 = Women) && ((i_color#581 = powder) || (i_color#581 = khaki))) && (((i_units#582 = Ounce) || (i_units#582 = Oz)) && ((i_size#579 = medium) || (i_size#579 = extra large)))) || (((i_category#576 = Women) && ((i_color#581 = brown) || (i_color#581 = honeydew))) && (((i_units#582 = Bunch) || (i_units#582 = Ton)) && ((i_size#579 = N/A) || (i_size#579 = small))))) || ((((i_category#576 = Men) && ((i_color#581 = floral) || (i_color#581 = deep))) && (((i_units#582 = N/A) || (i_units#582 = Dozen)) && ((i_size#579 = petite) || (i_size#579 = large)))) || (((i_category#576 = Men) && ((i_color#581 = light) || (i_color#581 = cornflower))) && (((i_units#582 = Box) || (i_units#582 = Pound)) && ((i_size#579 = medium) || (i_size#579 = extra large))))))) || ((i_manufact#578 = outer(i_manufact#578)) && (((((i_category#576 = Women) && ((i_color#581 = midnight) || (i_color#581 = snow))) && (((i_units#582 = Pallet) || (i_units#582 = Gross)) && ((i_size#579 = medium) || (i_size#579 = extra large)))) || (((i_category#576 = Women) && ((i_color#581 = cyan) || (i_color#581 = papaya))) && (((i_units#582 = Cup) || (i_units#582 = Dram)) && ((i_size#579 = N/A) || (i_size#579 = small))))) || ((((i_category#576 = Men) && ((i_color#581 = orange) || (i_color#581 = frosted))) && (((i_units#582 = Each) || (i_units#582 = Tbl)) && ((i_size#579 = petite) || (i_size#579 = large)))) || (((i_category#576 = Men) && ((i_color#581 = forest) || (i_color#581 = ghost))) && (((i_units#582 = Lb) || (i_units#582 = Bundle)) && ((i_size#579 = medium) || (i_size#579 = extra large))))))))
               :        +- SubqueryAlias `item`
               :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- SubqueryAlias `i1`
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/04 03:05:09 INFO Query: 
== Query: q41-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_product_name#585 ASC NULLS FIRST], true
      +- Distinct
         +- Project [i_product_name#585]
            +- Filter (((i_manufact_id#577 >= 738) && (i_manufact_id#577 <= (738 + 40))) && (scalar-subquery#23973 [i_manufact#578 && i_manufact#578] > cast(0 as bigint)))
               :  +- Aggregate [count(1) AS item_cnt#23972L]
               :     +- Filter (((i_manufact#578 = outer(i_manufact#578)) && (((((i_category#576 = Women) && ((i_color#581 = powder) || (i_color#581 = khaki))) && (((i_units#582 = Ounce) || (i_units#582 = Oz)) && ((i_size#579 = medium) || (i_size#579 = extra large)))) || (((i_category#576 = Women) && ((i_color#581 = brown) || (i_color#581 = honeydew))) && (((i_units#582 = Bunch) || (i_units#582 = Ton)) && ((i_size#579 = N/A) || (i_size#579 = small))))) || ((((i_category#576 = Men) && ((i_color#581 = floral) || (i_color#581 = deep))) && (((i_units#582 = N/A) || (i_units#582 = Dozen)) && ((i_size#579 = petite) || (i_size#579 = large)))) || (((i_category#576 = Men) && ((i_color#581 = light) || (i_color#581 = cornflower))) && (((i_units#582 = Box) || (i_units#582 = Pound)) && ((i_size#579 = medium) || (i_size#579 = extra large))))))) || ((i_manufact#578 = outer(i_manufact#578)) && (((((i_category#576 = Women) && ((i_color#581 = midnight) || (i_color#581 = snow))) && (((i_units#582 = Pallet) || (i_units#582 = Gross)) && ((i_size#579 = medium) || (i_size#579 = extra large)))) || (((i_category#576 = Women) && ((i_color#581 = cyan) || (i_color#581 = papaya))) && (((i_units#582 = Cup) || (i_units#582 = Dram)) && ((i_size#579 = N/A) || (i_size#579 = small))))) || ((((i_category#576 = Men) && ((i_color#581 = orange) || (i_color#581 = frosted))) && (((i_units#582 = Each) || (i_units#582 = Tbl)) && ((i_size#579 = petite) || (i_size#579 = large)))) || (((i_category#576 = Men) && ((i_color#581 = forest) || (i_color#581 = ghost))) && (((i_units#582 = Lb) || (i_units#582 = Bundle)) && ((i_size#579 = medium) || (i_size#579 = extra large))))))))
               :        +- SubqueryAlias `item`
               :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- SubqueryAlias `i1`
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 2.520080196s
Running execution q42-v2.4 iteration: 1, StandardRun=true
19/10/04 03:05:13 INFO Query: 
== Query: q42-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [d_year#498, i_category_id#575, i_category#576, sum(ss_ext_sales_price)#24003]
      +- Sort [sum(ss_ext_sales_price)#24003 DESC NULLS LAST, d_year#498 ASC NULLS FIRST, i_category_id#575 ASC NULLS FIRST, i_category#576 ASC NULLS FIRST], true
         +- Aggregate [d_year#498, i_category_id#575, i_category#576], [d_year#498, i_category_id#575, i_category#576, sum(ss_ext_sales_price#145) AS sum(ss_ext_sales_price)#24003]
            +- Filter ((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 1)) && ((d_moy#500 = 11) && (d_year#498 = 2000)))
               +- Join Inner
                  :- Join Inner
                  :  :- SubqueryAlias `dt`
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `store_sales`
                  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/04 03:05:13 INFO Query: 
== Query: q42-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [d_year#498, i_category_id#575, i_category#576, sum(ss_ext_sales_price)#24014]
      +- Sort [sum(ss_ext_sales_price)#24014 DESC NULLS LAST, d_year#498 ASC NULLS FIRST, i_category_id#575 ASC NULLS FIRST, i_category#576 ASC NULLS FIRST], true
         +- Aggregate [d_year#498, i_category_id#575, i_category#576], [d_year#498, i_category_id#575, i_category#576, sum(ss_ext_sales_price#145) AS sum(ss_ext_sales_price)#24014]
            +- Filter ((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 1)) && ((d_moy#500 = 11) && (d_year#498 = 2000)))
               +- Join Inner
                  :- Join Inner
                  :  :- SubqueryAlias `dt`
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `store_sales`
                  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 97.266075899s
Running execution q43-v2.4 iteration: 1, StandardRun=true
19/10/04 03:06:51 INFO Query: 
== Query: q43-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name#669 ASC NULLS FIRST, s_store_id#665 ASC NULLS FIRST, sun_sales#24095 ASC NULLS FIRST, mon_sales#24096 ASC NULLS FIRST, tue_sales#24097 ASC NULLS FIRST, wed_sales#24098 ASC NULLS FIRST, thu_sales#24099 ASC NULLS FIRST, fri_sales#24100 ASC NULLS FIRST, sat_sales#24101 ASC NULLS FIRST], true
      +- Aggregate [s_store_name#669, s_store_id#665], [s_store_name#669, s_store_id#665, sum(CASE WHEN (d_day_name#506 = Sunday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sun_sales#24095, sum(CASE WHEN (d_day_name#506 = Monday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS mon_sales#24096, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS tue_sales#24097, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS wed_sales#24098, sum(CASE WHEN (d_day_name#506 = Thursday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS thu_sales#24099, sum(CASE WHEN (d_day_name#506 = Friday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS fri_sales#24100, sum(CASE WHEN (d_day_name#506 = Saturday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sat_sales#24101]
         +- Filter (((d_date_sk#492 = ss_sold_date_sk#130) && (s_store_sk#664 = ss_store_sk#137)) && ((cast(s_gmt_offset#691 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (d_year#498 = 2000)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `date_dim`
               :  :  +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `store`
                  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/10/04 03:06:51 INFO Query: 
== Query: q43-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name#669 ASC NULLS FIRST, s_store_id#665 ASC NULLS FIRST, sun_sales#24127 ASC NULLS FIRST, mon_sales#24128 ASC NULLS FIRST, tue_sales#24129 ASC NULLS FIRST, wed_sales#24130 ASC NULLS FIRST, thu_sales#24131 ASC NULLS FIRST, fri_sales#24132 ASC NULLS FIRST, sat_sales#24133 ASC NULLS FIRST], true
      +- Aggregate [s_store_name#669, s_store_id#665], [s_store_name#669, s_store_id#665, sum(CASE WHEN (d_day_name#506 = Sunday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sun_sales#24127, sum(CASE WHEN (d_day_name#506 = Monday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS mon_sales#24128, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS tue_sales#24129, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS wed_sales#24130, sum(CASE WHEN (d_day_name#506 = Thursday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS thu_sales#24131, sum(CASE WHEN (d_day_name#506 = Friday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS fri_sales#24132, sum(CASE WHEN (d_day_name#506 = Saturday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sat_sales#24133]
         +- Filter (((d_date_sk#492 = ss_sold_date_sk#130) && (s_store_sk#664 = ss_store_sk#137)) && ((cast(s_gmt_offset#691 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (d_year#498 = 2000)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `date_dim`
               :  :  +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `store`
                  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 86.420626306s
Running execution q44-v2.4 iteration: 1, StandardRun=true
19/10/04 03:08:19 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/10/04 03:08:19 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/10/04 03:08:20 INFO Query: 
== Query: q44-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [rnk#24349 ASC NULLS FIRST], true
      +- Project [rnk#24349, i_product_name#585 AS best_performing#24355, i_product_name#24400 AS worst_performing#24356]
         +- Filter (((rnk#24349 = rnk#24354) && (i_item_sk#564 = item_sk#24345)) && (i_item_sk#24379 = item_sk#24350))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `asceding`
               :  :  :  +- Project [item_sk#24345, rnk#24349]
               :  :  :     +- Filter (rnk#24349 < 11)
               :  :  :        +- SubqueryAlias `V11`
               :  :  :           +- Project [item_sk#24345, rnk#24349]
               :  :  :              +- Project [item_sk#24345, rank_col#24346, rnk#24349, rnk#24349]
               :  :  :                 +- Window [rank(rank_col#24346) windowspecdefinition(rank_col#24346 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rnk#24349], [rank_col#24346 ASC NULLS FIRST]
               :  :  :                    +- Project [item_sk#24345, rank_col#24346]
               :  :  :                       +- SubqueryAlias `V1`
               :  :  :                          +- Project [item_sk#24345, rank_col#24346]
               :  :  :                             +- Filter (cast(avg(ss_net_profit#152)#24367 as decimal(13,7)) > cast(CheckOverflow((promote_precision(cast(0.9 as decimal(11,6))) * promote_precision(cast(scalar-subquery#24348 [] as decimal(11,6)))), DecimalType(13,7)) as decimal(13,7)))
               :  :  :                                :  +- Aggregate [ss_store_sk#137], [avg(ss_net_profit#152) AS rank_col#24347]
               :  :  :                                :     +- Filter ((ss_store_sk#137 = 4) && isnull(ss_addr_sk#136))
               :  :  :                                :        +- SubqueryAlias `store_sales`
               :  :  :                                :           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :                                +- Aggregate [ss_item_sk#132], [ss_item_sk#132 AS item_sk#24345, avg(ss_net_profit#152) AS rank_col#24346, avg(ss_net_profit#152) AS avg(ss_net_profit#152)#24367]
               :  :  :                                   +- Filter (ss_store_sk#137 = 4)
               :  :  :                                      +- SubqueryAlias `ss1`
               :  :  :                                         +- SubqueryAlias `store_sales`
               :  :  :                                            +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  +- SubqueryAlias `descending`
               :  :     +- Project [item_sk#24350, rnk#24354]
               :  :        +- Filter (rnk#24354 < 11)
               :  :           +- SubqueryAlias `V21`
               :  :              +- Project [item_sk#24350, rnk#24354]
               :  :                 +- Project [item_sk#24350, rank_col#24351, rnk#24354, rnk#24354]
               :  :                    +- Window [rank(rank_col#24351) windowspecdefinition(rank_col#24351 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rnk#24354], [rank_col#24351 DESC NULLS LAST]
               :  :                       +- Project [item_sk#24350, rank_col#24351]
               :  :                          +- SubqueryAlias `V2`
               :  :                             +- Project [item_sk#24350, rank_col#24351]
               :  :                                +- Filter (cast(avg(ss_net_profit#152)#24370 as decimal(13,7)) > cast(CheckOverflow((promote_precision(cast(0.9 as decimal(11,6))) * promote_precision(cast(scalar-subquery#24353 [] as decimal(11,6)))), DecimalType(13,7)) as decimal(13,7)))
               :  :                                   :  +- Aggregate [ss_store_sk#137], [avg(ss_net_profit#152) AS rank_col#24352]
               :  :                                   :     +- Filter ((ss_store_sk#137 = 4) && isnull(ss_addr_sk#136))
               :  :                                   :        +- SubqueryAlias `store_sales`
               :  :                                   :           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :                                   +- Aggregate [ss_item_sk#132], [ss_item_sk#132 AS item_sk#24350, avg(ss_net_profit#152) AS rank_col#24351, avg(ss_net_profit#152) AS avg(ss_net_profit#152)#24370]
               :  :                                      +- Filter (ss_store_sk#137 = 4)
               :  :                                         +- SubqueryAlias `ss1`
               :  :                                            +- SubqueryAlias `store_sales`
               :  :                                               +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  +- SubqueryAlias `i1`
               :     +- SubqueryAlias `item`
               :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- SubqueryAlias `i2`
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#24379,i_item_id#24380,i_rec_start_date#24381,i_rec_end_date#24382,i_item_desc#24383,i_current_price#24384,i_wholesale_cost#24385,i_brand_id#24386,i_brand#24387,i_class_id#24388,i_class#24389,i_category_id#24390,i_category#24391,i_manufact_id#24392,i_manufact#24393,i_size#24394,i_formulation#24395,i_color#24396,i_units#24397,i_container#24398,i_manager_id#24399,i_product_name#24400] parquet

     : benchmark
19/10/04 03:08:20 INFO Query: 
== Query: q44-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [rnk#24424 ASC NULLS FIRST], true
      +- Project [rnk#24424, i_product_name#585 AS best_performing#24430, i_product_name#24475 AS worst_performing#24431]
         +- Filter (((rnk#24424 = rnk#24429) && (i_item_sk#564 = item_sk#24420)) && (i_item_sk#24454 = item_sk#24425))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `asceding`
               :  :  :  +- Project [item_sk#24420, rnk#24424]
               :  :  :     +- Filter (rnk#24424 < 11)
               :  :  :        +- SubqueryAlias `V11`
               :  :  :           +- Project [item_sk#24420, rnk#24424]
               :  :  :              +- Project [item_sk#24420, rank_col#24421, rnk#24424, rnk#24424]
               :  :  :                 +- Window [rank(rank_col#24421) windowspecdefinition(rank_col#24421 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rnk#24424], [rank_col#24421 ASC NULLS FIRST]
               :  :  :                    +- Project [item_sk#24420, rank_col#24421]
               :  :  :                       +- SubqueryAlias `V1`
               :  :  :                          +- Project [item_sk#24420, rank_col#24421]
               :  :  :                             +- Filter (cast(avg(ss_net_profit#152)#24442 as decimal(13,7)) > cast(CheckOverflow((promote_precision(cast(0.9 as decimal(11,6))) * promote_precision(cast(scalar-subquery#24423 [] as decimal(11,6)))), DecimalType(13,7)) as decimal(13,7)))
               :  :  :                                :  +- Aggregate [ss_store_sk#137], [avg(ss_net_profit#152) AS rank_col#24422]
               :  :  :                                :     +- Filter ((ss_store_sk#137 = 4) && isnull(ss_addr_sk#136))
               :  :  :                                :        +- SubqueryAlias `store_sales`
               :  :  :                                :           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :                                +- Aggregate [ss_item_sk#132], [ss_item_sk#132 AS item_sk#24420, avg(ss_net_profit#152) AS rank_col#24421, avg(ss_net_profit#152) AS avg(ss_net_profit#152)#24442]
               :  :  :                                   +- Filter (ss_store_sk#137 = 4)
               :  :  :                                      +- SubqueryAlias `ss1`
               :  :  :                                         +- SubqueryAlias `store_sales`
               :  :  :                                            +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  +- SubqueryAlias `descending`
               :  :     +- Project [item_sk#24425, rnk#24429]
               :  :        +- Filter (rnk#24429 < 11)
               :  :           +- SubqueryAlias `V21`
               :  :              +- Project [item_sk#24425, rnk#24429]
               :  :                 +- Project [item_sk#24425, rank_col#24426, rnk#24429, rnk#24429]
               :  :                    +- Window [rank(rank_col#24426) windowspecdefinition(rank_col#24426 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rnk#24429], [rank_col#24426 DESC NULLS LAST]
               :  :                       +- Project [item_sk#24425, rank_col#24426]
               :  :                          +- SubqueryAlias `V2`
               :  :                             +- Project [item_sk#24425, rank_col#24426]
               :  :                                +- Filter (cast(avg(ss_net_profit#152)#24445 as decimal(13,7)) > cast(CheckOverflow((promote_precision(cast(0.9 as decimal(11,6))) * promote_precision(cast(scalar-subquery#24428 [] as decimal(11,6)))), DecimalType(13,7)) as decimal(13,7)))
               :  :                                   :  +- Aggregate [ss_store_sk#137], [avg(ss_net_profit#152) AS rank_col#24427]
               :  :                                   :     +- Filter ((ss_store_sk#137 = 4) && isnull(ss_addr_sk#136))
               :  :                                   :        +- SubqueryAlias `store_sales`
               :  :                                   :           +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :                                   +- Aggregate [ss_item_sk#132], [ss_item_sk#132 AS item_sk#24425, avg(ss_net_profit#152) AS rank_col#24426, avg(ss_net_profit#152) AS avg(ss_net_profit#152)#24445]
               :  :                                      +- Filter (ss_store_sk#137 = 4)
               :  :                                         +- SubqueryAlias `ss1`
               :  :                                            +- SubqueryAlias `store_sales`
               :  :                                               +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  +- SubqueryAlias `i1`
               :     +- SubqueryAlias `item`
               :        +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- SubqueryAlias `i2`
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#24454,i_item_id#24455,i_rec_start_date#24456,i_rec_end_date#24457,i_item_desc#24458,i_current_price#24459,i_wholesale_cost#24460,i_brand_id#24461,i_brand#24462,i_class_id#24463,i_class#24464,i_category_id#24465,i_category#24466,i_manufact_id#24467,i_manufact#24468,i_size#24469,i_formulation#24470,i_color#24471,i_units#24472,i_container#24473,i_manager_id#24474,i_product_name#24475] parquet

      running Thread[benchmark runner,5,main]
19/10/04 03:08:20 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/10/04 03:08:20 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
Execution time: 253.843628121s
Running execution q45-v2.4 iteration: 1, StandardRun=true
19/10/04 03:12:35 INFO Query: 
== Query: q45-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ca_zip#457, ca_city#454, sum(ws_sales_price)#24692]
      +- Sort [ca_zip#457 ASC NULLS FIRST, ca_city#454 ASC NULLS FIRST], true
         +- Aggregate [ca_zip#457, ca_city#454], [ca_zip#457, ca_city#454, sum(ws_sales_price#237) AS sum(ws_sales_price)#24692]
            +- Filter ((((ws_bill_customer_sk#220 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && ((ws_item_sk#219 = i_item_sk#564) && (substring(ca_zip#457, 1, 5) IN (85669,86197,88274,83405,86475,85392,85460,80348,81792) || i_item_id#565 IN (list#24690 [])))) && (((ws_sold_date_sk#216 = d_date_sk#492) && (d_qoy#502 = 2)) && (d_year#498 = 2001)))
               :  +- Project [i_item_id#565]
               :     +- Filter i_item_sk#564 IN (2,3,5,7,11,13,17,19,23,29)
               :        +- SubqueryAlias `item`
               :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `web_sales`
                  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `customer`
                  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  :  +- SubqueryAlias `customer_address`
                  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  :  +- SubqueryAlias `date_dim`
                  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/04 03:12:35 INFO Query: 
== Query: q45-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ca_zip#457, ca_city#454, sum(ws_sales_price)#24700]
      +- Sort [ca_zip#457 ASC NULLS FIRST, ca_city#454 ASC NULLS FIRST], true
         +- Aggregate [ca_zip#457, ca_city#454], [ca_zip#457, ca_city#454, sum(ws_sales_price#237) AS sum(ws_sales_price)#24700]
            +- Filter ((((ws_bill_customer_sk#220 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && ((ws_item_sk#219 = i_item_sk#564) && (substring(ca_zip#457, 1, 5) IN (85669,86197,88274,83405,86475,85392,85460,80348,81792) || i_item_id#565 IN (list#24698 [])))) && (((ws_sold_date_sk#216 = d_date_sk#492) && (d_qoy#502 = 2)) && (d_year#498 = 2001)))
               :  +- Project [i_item_id#565]
               :     +- Filter i_item_sk#564 IN (2,3,5,7,11,13,17,19,23,29)
               :        +- SubqueryAlias `item`
               :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `web_sales`
                  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `customer`
                  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  :  +- SubqueryAlias `customer_address`
                  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  :  +- SubqueryAlias `date_dim`
                  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `item`
                     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 300.576147246s
Running execution q46-v2.4 iteration: 1, StandardRun=true
19/10/04 03:17:37 INFO Query: 
== Query: q46-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, ca_city#454 ASC NULLS FIRST, bought_city#24743 ASC NULLS FIRST, ss_ticket_number#139L ASC NULLS FIRST], true
      +- Project [c_last_name#421, c_first_name#420, ca_city#454, bought_city#24743, ss_ticket_number#139L, amt#24744, profit#24745]
         +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && NOT (ca_city#454 = bought_city#24743))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dn`
               :  :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133, ss_addr_sk#136, ca_city#454], [ss_ticket_number#139L, ss_customer_sk#133, ca_city#454 AS bought_city#24743, sum(ss_coupon_amt#149) AS amt#24744, sum(ss_net_profit#152) AS profit#24745]
               :  :     +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_hdemo_sk#135 = hd_demo_sk#548) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((hd_dep_count#551 = 4) || (hd_vehicle_count#552 = 3)) && d_dow#499 IN (6,0)) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_city#686 IN (Fairview,Midway,Fairview,Fairview,Fairview))))
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- Join Inner
               :  :           :  :  :- Join Inner
               :  :           :  :  :  :- SubqueryAlias `store_sales`
               :  :           :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  :  :  +- SubqueryAlias `date_dim`
               :  :           :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           :  :  +- SubqueryAlias `store`
               :  :           :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :  :           :  +- SubqueryAlias `household_demographics`
               :  :           :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  :           +- SubqueryAlias `customer_address`
               :  :              +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer`
               :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               +- SubqueryAlias `current_addr`
                  +- SubqueryAlias `customer_address`
                     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

     : benchmark
19/10/04 03:17:37 INFO Query: 
== Query: q46-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, ca_city#454 ASC NULLS FIRST, bought_city#24755 ASC NULLS FIRST, ss_ticket_number#139L ASC NULLS FIRST], true
      +- Project [c_last_name#421, c_first_name#420, ca_city#454, bought_city#24755, ss_ticket_number#139L, amt#24756, profit#24757]
         +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && NOT (ca_city#454 = bought_city#24755))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dn`
               :  :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133, ss_addr_sk#136, ca_city#454], [ss_ticket_number#139L, ss_customer_sk#133, ca_city#454 AS bought_city#24755, sum(ss_coupon_amt#149) AS amt#24756, sum(ss_net_profit#152) AS profit#24757]
               :  :     +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_hdemo_sk#135 = hd_demo_sk#548) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((hd_dep_count#551 = 4) || (hd_vehicle_count#552 = 3)) && d_dow#499 IN (6,0)) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_city#686 IN (Fairview,Midway,Fairview,Fairview,Fairview))))
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- Join Inner
               :  :           :  :  :- Join Inner
               :  :           :  :  :  :- SubqueryAlias `store_sales`
               :  :           :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  :  :  +- SubqueryAlias `date_dim`
               :  :           :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           :  :  +- SubqueryAlias `store`
               :  :           :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :  :           :  +- SubqueryAlias `household_demographics`
               :  :           :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  :           +- SubqueryAlias `customer_address`
               :  :              +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer`
               :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               +- SubqueryAlias `current_addr`
                  +- SubqueryAlias `customer_address`
                     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

      running Thread[benchmark runner,5,main]
Execution time: 167.79672428s
Running execution q47-v2.4 iteration: 1, StandardRun=true
19/10/04 03:20:27 INFO Query: 
== Query: q47-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#25890 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#25891 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
      +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, avg_monthly_sales#25891, sum_sales#25890, psum#25893, nsum#25894]
         +- Filter (((d_year#498 = 1999) && (cast(avg_monthly_sales#25891 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6)))) && (cast(CASE WHEN (cast(avg_monthly_sales#25891 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#25890 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#25891 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#25891 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16))))
            +- SubqueryAlias `v2`
               +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, avg_monthly_sales#25891, sum_sales#25890, sum_sales#26098 AS psum#25893, sum_sales#26573 AS nsum#25894]
                  +- Filter (((((i_category#576 = i_category#26203) && (i_category#576 = i_category#26678)) && (i_brand#572 = i_brand#26199)) && ((i_brand#572 = i_brand#26674) && (s_store_name#669 = s_store_name#26360))) && ((((s_store_name#669 = s_store_name#26835) && (s_company_name#681 = s_company_name#26372)) && (s_company_name#681 = s_company_name#26847)) && ((rn#25892 = (rn#26004 + 1)) && (rn#25892 = (rn#26479 - 1)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `v1`
                        :  :  +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, sum_sales#25890, avg_monthly_sales#25891, rn#25892]
                        :  :     +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, sum_sales#25890, _w0#25904, rn#25892, avg_monthly_sales#25891, avg_monthly_sales#25891, rn#25892]
                        :  :        +- Window [avg(_w0#25904) windowspecdefinition(i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#25891], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498]
                        :  :           +- Window [rank(d_year#498, d_moy#500) windowspecdefinition(i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#25892], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681], [d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST]
                        :  :              +- Aggregate [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, sum(ss_sales_price#143) AS sum_sales#25890, sum(ss_sales_price#143) AS _w0#25904]
                        :  :                 +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((ss_store_sk#137 = s_store_sk#664) && (((d_year#498 = 1999) || ((d_year#498 = (1999 - 1)) && (d_moy#500 = 12))) || ((d_year#498 = (1999 + 1)) && (d_moy#500 = 1)))))
                        :  :                    +- Join Inner
                        :  :                       :- Join Inner
                        :  :                       :  :- Join Inner
                        :  :                       :  :  :- SubqueryAlias `item`
                        :  :                       :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        :  :                       :  :  +- SubqueryAlias `store_sales`
                        :  :                       :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :                       :  +- SubqueryAlias `date_dim`
                        :  :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :                       +- SubqueryAlias `store`
                        :  :                          +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  +- SubqueryAlias `v1_lag`
                        :     +- SubqueryAlias `v1`
                        :        +- Project [i_category#26203, i_brand#26199, s_store_name#26360, s_company_name#26372, d_year#26288, d_moy#26290, sum_sales#26098, avg_monthly_sales#25909, rn#26004]
                        :           +- Project [i_category#26203, i_brand#26199, s_store_name#26360, s_company_name#26372, d_year#26288, d_moy#26290, sum_sales#26098, _w0#26099, rn#26004, avg_monthly_sales#25909, avg_monthly_sales#25909, rn#26004]
                        :              +- Window [avg(_w0#26099) windowspecdefinition(i_category#26203, i_brand#26199, s_store_name#26360, s_company_name#26372, d_year#26288, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#25909], [i_category#26203, i_brand#26199, s_store_name#26360, s_company_name#26372, d_year#26288]
                        :                 +- Window [rank(d_year#26288, d_moy#26290) windowspecdefinition(i_category#26203, i_brand#26199, s_store_name#26360, s_company_name#26372, d_year#26288 ASC NULLS FIRST, d_moy#26290 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#26004], [i_category#26203, i_brand#26199, s_store_name#26360, s_company_name#26372], [d_year#26288 ASC NULLS FIRST, d_moy#26290 ASC NULLS FIRST]
                        :                    +- Aggregate [i_category#26203, i_brand#26199, s_store_name#26360, s_company_name#26372, d_year#26288, d_moy#26290], [i_category#26203, i_brand#26199, s_store_name#26360, s_company_name#26372, d_year#26288, d_moy#26290, sum(ss_sales_price#143) AS sum_sales#26098, sum(ss_sales_price#143) AS _w0#26099]
                        :                       +- Filter (((ss_item_sk#132 = i_item_sk#26191) && (ss_sold_date_sk#130 = d_date_sk#26282)) && ((ss_store_sk#137 = s_store_sk#26355) && (((d_year#26288 = 1999) || ((d_year#26288 = (1999 - 1)) && (d_moy#26290 = 12))) || ((d_year#26288 = (1999 + 1)) && (d_moy#26290 = 1)))))
                        :                          +- Join Inner
                        :                             :- Join Inner
                        :                             :  :- Join Inner
                        :                             :  :  :- SubqueryAlias `item`
                        :                             :  :  :  +- Relation[i_item_sk#26191,i_item_id#26192,i_rec_start_date#26193,i_rec_end_date#26194,i_item_desc#26195,i_current_price#26196,i_wholesale_cost#26197,i_brand_id#26198,i_brand#26199,i_class_id#26200,i_class#26201,i_category_id#26202,i_category#26203,i_manufact_id#26204,i_manufact#26205,i_size#26206,i_formulation#26207,i_color#26208,i_units#26209,i_container#26210,i_manager_id#26211,i_product_name#26212] parquet
                        :                             :  :  +- SubqueryAlias `store_sales`
                        :                             :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :                             :  +- SubqueryAlias `date_dim`
                        :                             :     +- Relation[d_date_sk#26282,d_date_id#26283,d_date#26284,d_month_seq#26285,d_week_seq#26286,d_quarter_seq#26287,d_year#26288,d_dow#26289,d_moy#26290,d_dom#26291,d_qoy#26292,d_fy_year#26293,d_fy_quarter_seq#26294,d_fy_week_seq#26295,d_day_name#26296,d_quarter_name#26297,d_holiday#26298,d_weekend#26299,d_following_holiday#26300,d_first_dom#26301,d_last_dom#26302,d_same_day_ly#26303,d_same_day_lq#26304,d_current_day#26305,... 4 more fields] parquet
                        :                             +- SubqueryAlias `store`
                        :                                +- Relation[s_store_sk#26355,s_store_id#26356,s_rec_start_date#26357,s_rec_end_date#26358,s_closed_date_sk#26359,s_store_name#26360,s_number_employees#26361,s_floor_space#26362,s_hours#26363,s_manager#26364,s_market_id#26365,s_geography_class#26366,s_market_desc#26367,s_market_manager#26368,s_division_id#26369,s_division_name#26370,s_company_id#26371,s_company_name#26372,s_street_number#26373,s_street_name#26374,s_street_type#26375,s_suite_number#26376,s_city#26377,s_county#26378,... 5 more fields] parquet
                        +- SubqueryAlias `v1_lead`
                           +- SubqueryAlias `v1`
                              +- Project [i_category#26678, i_brand#26674, s_store_name#26835, s_company_name#26847, d_year#26763, d_moy#26765, sum_sales#26573, avg_monthly_sales#26384, rn#26479]
                                 +- Project [i_category#26678, i_brand#26674, s_store_name#26835, s_company_name#26847, d_year#26763, d_moy#26765, sum_sales#26573, _w0#26574, rn#26479, avg_monthly_sales#26384, avg_monthly_sales#26384, rn#26479]
                                    +- Window [avg(_w0#26574) windowspecdefinition(i_category#26678, i_brand#26674, s_store_name#26835, s_company_name#26847, d_year#26763, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#26384], [i_category#26678, i_brand#26674, s_store_name#26835, s_company_name#26847, d_year#26763]
                                       +- Window [rank(d_year#26763, d_moy#26765) windowspecdefinition(i_category#26678, i_brand#26674, s_store_name#26835, s_company_name#26847, d_year#26763 ASC NULLS FIRST, d_moy#26765 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#26479], [i_category#26678, i_brand#26674, s_store_name#26835, s_company_name#26847], [d_year#26763 ASC NULLS FIRST, d_moy#26765 ASC NULLS FIRST]
                                          +- Aggregate [i_category#26678, i_brand#26674, s_store_name#26835, s_company_name#26847, d_year#26763, d_moy#26765], [i_category#26678, i_brand#26674, s_store_name#26835, s_company_name#26847, d_year#26763, d_moy#26765, sum(ss_sales_price#143) AS sum_sales#26573, sum(ss_sales_price#143) AS _w0#26574]
                                             +- Filter (((ss_item_sk#132 = i_item_sk#26666) && (ss_sold_date_sk#130 = d_date_sk#26757)) && ((ss_store_sk#137 = s_store_sk#26830) && (((d_year#26763 = 1999) || ((d_year#26763 = (1999 - 1)) && (d_moy#26765 = 12))) || ((d_year#26763 = (1999 + 1)) && (d_moy#26765 = 1)))))
                                                +- Join Inner
                                                   :- Join Inner
                                                   :  :- Join Inner
                                                   :  :  :- SubqueryAlias `item`
                                                   :  :  :  +- Relation[i_item_sk#26666,i_item_id#26667,i_rec_start_date#26668,i_rec_end_date#26669,i_item_desc#26670,i_current_price#26671,i_wholesale_cost#26672,i_brand_id#26673,i_brand#26674,i_class_id#26675,i_class#26676,i_category_id#26677,i_category#26678,i_manufact_id#26679,i_manufact#26680,i_size#26681,i_formulation#26682,i_color#26683,i_units#26684,i_container#26685,i_manager_id#26686,i_product_name#26687] parquet
                                                   :  :  +- SubqueryAlias `store_sales`
                                                   :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                                   :  +- SubqueryAlias `date_dim`
                                                   :     +- Relation[d_date_sk#26757,d_date_id#26758,d_date#26759,d_month_seq#26760,d_week_seq#26761,d_quarter_seq#26762,d_year#26763,d_dow#26764,d_moy#26765,d_dom#26766,d_qoy#26767,d_fy_year#26768,d_fy_quarter_seq#26769,d_fy_week_seq#26770,d_day_name#26771,d_quarter_name#26772,d_holiday#26773,d_weekend#26774,d_following_holiday#26775,d_first_dom#26776,d_last_dom#26777,d_same_day_ly#26778,d_same_day_lq#26779,d_current_day#26780,... 4 more fields] parquet
                                                   +- SubqueryAlias `store`
                                                      +- Relation[s_store_sk#26830,s_store_id#26831,s_rec_start_date#26832,s_rec_end_date#26833,s_closed_date_sk#26834,s_store_name#26835,s_number_employees#26836,s_floor_space#26837,s_hours#26838,s_manager#26839,s_market_id#26840,s_geography_class#26841,s_market_desc#26842,s_market_manager#26843,s_division_id#26844,s_division_name#26845,s_company_id#26846,s_company_name#26847,s_street_number#26848,s_street_name#26849,s_street_type#26850,s_suite_number#26851,s_city#26852,s_county#26853,... 5 more fields] parquet

     : benchmark
19/10/04 03:20:28 INFO Query: 
== Query: q47-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#26965 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#26966 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
      +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, avg_monthly_sales#26966, sum_sales#26965, psum#26968, nsum#26969]
         +- Filter (((d_year#498 = 1999) && (cast(avg_monthly_sales#26966 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6)))) && (cast(CASE WHEN (cast(avg_monthly_sales#26966 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#26965 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#26966 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#26966 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16))))
            +- SubqueryAlias `v2`
               +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, avg_monthly_sales#26966, sum_sales#26965, sum_sales#27173 AS psum#26968, sum_sales#27648 AS nsum#26969]
                  +- Filter (((((i_category#576 = i_category#27278) && (i_category#576 = i_category#27753)) && (i_brand#572 = i_brand#27274)) && ((i_brand#572 = i_brand#27749) && (s_store_name#669 = s_store_name#27435))) && ((((s_store_name#669 = s_store_name#27910) && (s_company_name#681 = s_company_name#27447)) && (s_company_name#681 = s_company_name#27922)) && ((rn#26967 = (rn#27079 + 1)) && (rn#26967 = (rn#27554 - 1)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `v1`
                        :  :  +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, sum_sales#26965, avg_monthly_sales#26966, rn#26967]
                        :  :     +- Project [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, sum_sales#26965, _w0#26979, rn#26967, avg_monthly_sales#26966, avg_monthly_sales#26966, rn#26967]
                        :  :        +- Window [avg(_w0#26979) windowspecdefinition(i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#26966], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498]
                        :  :           +- Window [rank(d_year#498, d_moy#500) windowspecdefinition(i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#26967], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681], [d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST]
                        :  :              +- Aggregate [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681, d_year#498, d_moy#500, sum(ss_sales_price#143) AS sum_sales#26965, sum(ss_sales_price#143) AS _w0#26979]
                        :  :                 +- Filter (((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((ss_store_sk#137 = s_store_sk#664) && (((d_year#498 = 1999) || ((d_year#498 = (1999 - 1)) && (d_moy#500 = 12))) || ((d_year#498 = (1999 + 1)) && (d_moy#500 = 1)))))
                        :  :                    +- Join Inner
                        :  :                       :- Join Inner
                        :  :                       :  :- Join Inner
                        :  :                       :  :  :- SubqueryAlias `item`
                        :  :                       :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        :  :                       :  :  +- SubqueryAlias `store_sales`
                        :  :                       :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :                       :  +- SubqueryAlias `date_dim`
                        :  :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :                       +- SubqueryAlias `store`
                        :  :                          +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  +- SubqueryAlias `v1_lag`
                        :     +- SubqueryAlias `v1`
                        :        +- Project [i_category#27278, i_brand#27274, s_store_name#27435, s_company_name#27447, d_year#27363, d_moy#27365, sum_sales#27173, avg_monthly_sales#26984, rn#27079]
                        :           +- Project [i_category#27278, i_brand#27274, s_store_name#27435, s_company_name#27447, d_year#27363, d_moy#27365, sum_sales#27173, _w0#27174, rn#27079, avg_monthly_sales#26984, avg_monthly_sales#26984, rn#27079]
                        :              +- Window [avg(_w0#27174) windowspecdefinition(i_category#27278, i_brand#27274, s_store_name#27435, s_company_name#27447, d_year#27363, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#26984], [i_category#27278, i_brand#27274, s_store_name#27435, s_company_name#27447, d_year#27363]
                        :                 +- Window [rank(d_year#27363, d_moy#27365) windowspecdefinition(i_category#27278, i_brand#27274, s_store_name#27435, s_company_name#27447, d_year#27363 ASC NULLS FIRST, d_moy#27365 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#27079], [i_category#27278, i_brand#27274, s_store_name#27435, s_company_name#27447], [d_year#27363 ASC NULLS FIRST, d_moy#27365 ASC NULLS FIRST]
                        :                    +- Aggregate [i_category#27278, i_brand#27274, s_store_name#27435, s_company_name#27447, d_year#27363, d_moy#27365], [i_category#27278, i_brand#27274, s_store_name#27435, s_company_name#27447, d_year#27363, d_moy#27365, sum(ss_sales_price#143) AS sum_sales#27173, sum(ss_sales_price#143) AS _w0#27174]
                        :                       +- Filter (((ss_item_sk#132 = i_item_sk#27266) && (ss_sold_date_sk#130 = d_date_sk#27357)) && ((ss_store_sk#137 = s_store_sk#27430) && (((d_year#27363 = 1999) || ((d_year#27363 = (1999 - 1)) && (d_moy#27365 = 12))) || ((d_year#27363 = (1999 + 1)) && (d_moy#27365 = 1)))))
                        :                          +- Join Inner
                        :                             :- Join Inner
                        :                             :  :- Join Inner
                        :                             :  :  :- SubqueryAlias `item`
                        :                             :  :  :  +- Relation[i_item_sk#27266,i_item_id#27267,i_rec_start_date#27268,i_rec_end_date#27269,i_item_desc#27270,i_current_price#27271,i_wholesale_cost#27272,i_brand_id#27273,i_brand#27274,i_class_id#27275,i_class#27276,i_category_id#27277,i_category#27278,i_manufact_id#27279,i_manufact#27280,i_size#27281,i_formulation#27282,i_color#27283,i_units#27284,i_container#27285,i_manager_id#27286,i_product_name#27287] parquet
                        :                             :  :  +- SubqueryAlias `store_sales`
                        :                             :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :                             :  +- SubqueryAlias `date_dim`
                        :                             :     +- Relation[d_date_sk#27357,d_date_id#27358,d_date#27359,d_month_seq#27360,d_week_seq#27361,d_quarter_seq#27362,d_year#27363,d_dow#27364,d_moy#27365,d_dom#27366,d_qoy#27367,d_fy_year#27368,d_fy_quarter_seq#27369,d_fy_week_seq#27370,d_day_name#27371,d_quarter_name#27372,d_holiday#27373,d_weekend#27374,d_following_holiday#27375,d_first_dom#27376,d_last_dom#27377,d_same_day_ly#27378,d_same_day_lq#27379,d_current_day#27380,... 4 more fields] parquet
                        :                             +- SubqueryAlias `store`
                        :                                +- Relation[s_store_sk#27430,s_store_id#27431,s_rec_start_date#27432,s_rec_end_date#27433,s_closed_date_sk#27434,s_store_name#27435,s_number_employees#27436,s_floor_space#27437,s_hours#27438,s_manager#27439,s_market_id#27440,s_geography_class#27441,s_market_desc#27442,s_market_manager#27443,s_division_id#27444,s_division_name#27445,s_company_id#27446,s_company_name#27447,s_street_number#27448,s_street_name#27449,s_street_type#27450,s_suite_number#27451,s_city#27452,s_county#27453,... 5 more fields] parquet
                        +- SubqueryAlias `v1_lead`
                           +- SubqueryAlias `v1`
                              +- Project [i_category#27753, i_brand#27749, s_store_name#27910, s_company_name#27922, d_year#27838, d_moy#27840, sum_sales#27648, avg_monthly_sales#27459, rn#27554]
                                 +- Project [i_category#27753, i_brand#27749, s_store_name#27910, s_company_name#27922, d_year#27838, d_moy#27840, sum_sales#27648, _w0#27649, rn#27554, avg_monthly_sales#27459, avg_monthly_sales#27459, rn#27554]
                                    +- Window [avg(_w0#27649) windowspecdefinition(i_category#27753, i_brand#27749, s_store_name#27910, s_company_name#27922, d_year#27838, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#27459], [i_category#27753, i_brand#27749, s_store_name#27910, s_company_name#27922, d_year#27838]
                                       +- Window [rank(d_year#27838, d_moy#27840) windowspecdefinition(i_category#27753, i_brand#27749, s_store_name#27910, s_company_name#27922, d_year#27838 ASC NULLS FIRST, d_moy#27840 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#27554], [i_category#27753, i_brand#27749, s_store_name#27910, s_company_name#27922], [d_year#27838 ASC NULLS FIRST, d_moy#27840 ASC NULLS FIRST]
                                          +- Aggregate [i_category#27753, i_brand#27749, s_store_name#27910, s_company_name#27922, d_year#27838, d_moy#27840], [i_category#27753, i_brand#27749, s_store_name#27910, s_company_name#27922, d_year#27838, d_moy#27840, sum(ss_sales_price#143) AS sum_sales#27648, sum(ss_sales_price#143) AS _w0#27649]
                                             +- Filter (((ss_item_sk#132 = i_item_sk#27741) && (ss_sold_date_sk#130 = d_date_sk#27832)) && ((ss_store_sk#137 = s_store_sk#27905) && (((d_year#27838 = 1999) || ((d_year#27838 = (1999 - 1)) && (d_moy#27840 = 12))) || ((d_year#27838 = (1999 + 1)) && (d_moy#27840 = 1)))))
                                                +- Join Inner
                                                   :- Join Inner
                                                   :  :- Join Inner
                                                   :  :  :- SubqueryAlias `item`
                                                   :  :  :  +- Relation[i_item_sk#27741,i_item_id#27742,i_rec_start_date#27743,i_rec_end_date#27744,i_item_desc#27745,i_current_price#27746,i_wholesale_cost#27747,i_brand_id#27748,i_brand#27749,i_class_id#27750,i_class#27751,i_category_id#27752,i_category#27753,i_manufact_id#27754,i_manufact#27755,i_size#27756,i_formulation#27757,i_color#27758,i_units#27759,i_container#27760,i_manager_id#27761,i_product_name#27762] parquet
                                                   :  :  +- SubqueryAlias `store_sales`
                                                   :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                                   :  +- SubqueryAlias `date_dim`
                                                   :     +- Relation[d_date_sk#27832,d_date_id#27833,d_date#27834,d_month_seq#27835,d_week_seq#27836,d_quarter_seq#27837,d_year#27838,d_dow#27839,d_moy#27840,d_dom#27841,d_qoy#27842,d_fy_year#27843,d_fy_quarter_seq#27844,d_fy_week_seq#27845,d_day_name#27846,d_quarter_name#27847,d_holiday#27848,d_weekend#27849,d_following_holiday#27850,d_first_dom#27851,d_last_dom#27852,d_same_day_ly#27853,d_same_day_lq#27854,d_current_day#27855,... 4 more fields] parquet
                                                   +- SubqueryAlias `store`
                                                      +- Relation[s_store_sk#27905,s_store_id#27906,s_rec_start_date#27907,s_rec_end_date#27908,s_closed_date_sk#27909,s_store_name#27910,s_number_employees#27911,s_floor_space#27912,s_hours#27913,s_manager#27914,s_market_id#27915,s_geography_class#27916,s_market_desc#27917,s_market_manager#27918,s_division_id#27919,s_division_name#27920,s_company_id#27921,s_company_name#27922,s_street_number#27923,s_street_name#27924,s_street_type#27925,s_suite_number#27926,s_city#27927,s_county#27928,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 213.224186422s
Running execution q48-v2.4 iteration: 1, StandardRun=true
19/10/04 03:24:04 INFO Query: 
== Query: q48-v2.4 ==
Aggregate [sum(cast(ss_quantity#140 as bigint)) AS sum(ss_quantity)#30216L]
+- Filter ((((s_store_sk#664 = ss_store_sk#137) && (ss_sold_date_sk#130 = d_date_sk#492)) && (d_year#498 = 2000)) && ((((((cd_demo_sk#474 = ss_cdemo_sk#134) && (cd_marital_status#476 = M)) && ((cd_education_status#477 = 4 yr Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(100.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(150.00 as decimal(7,2)))))) || (((cd_demo_sk#474 = ss_cdemo_sk#134) && (cd_marital_status#476 = D)) && ((cd_education_status#477 = 2 yr Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(50.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(100.00 as decimal(7,2))))))) || (((cd_demo_sk#474 = ss_cdemo_sk#134) && (cd_marital_status#476 = S)) && ((cd_education_status#477 = College) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(150.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(200.00 as decimal(7,2))))))) && (((((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (CO,OH,TX) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(2000 as decimal(4,0)) as decimal(7,2)))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (OR,MN,KY) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(150 as decimal(3,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(3000 as decimal(4,0)) as decimal(7,2))))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (VA,CA,MS) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(25000 as decimal(5,0)) as decimal(7,2)))))))))
   +- Join Inner
      :- Join Inner
      :  :- Join Inner
      :  :  :- Join Inner
      :  :  :  :- SubqueryAlias `store_sales`
      :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
      :  :  :  +- SubqueryAlias `store`
      :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
      :  :  +- SubqueryAlias `customer_demographics`
      :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
      :  +- SubqueryAlias `customer_address`
      :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
      +- SubqueryAlias `date_dim`
         +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/04 03:24:04 INFO Query: 
== Query: q48-v2.4 ==
Aggregate [sum(cast(ss_quantity#140 as bigint)) AS sum(ss_quantity)#30219L]
+- Filter ((((s_store_sk#664 = ss_store_sk#137) && (ss_sold_date_sk#130 = d_date_sk#492)) && (d_year#498 = 2000)) && ((((((cd_demo_sk#474 = ss_cdemo_sk#134) && (cd_marital_status#476 = M)) && ((cd_education_status#477 = 4 yr Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(100.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(150.00 as decimal(7,2)))))) || (((cd_demo_sk#474 = ss_cdemo_sk#134) && (cd_marital_status#476 = D)) && ((cd_education_status#477 = 2 yr Degree) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(50.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(100.00 as decimal(7,2))))))) || (((cd_demo_sk#474 = ss_cdemo_sk#134) && (cd_marital_status#476 = S)) && ((cd_education_status#477 = College) && ((cast(ss_sales_price#143 as decimal(7,2)) >= cast(150.00 as decimal(7,2))) && (cast(ss_sales_price#143 as decimal(7,2)) <= cast(200.00 as decimal(7,2))))))) && (((((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (CO,OH,TX) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(2000 as decimal(4,0)) as decimal(7,2)))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (OR,MN,KY) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(150 as decimal(3,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(3000 as decimal(4,0)) as decimal(7,2))))))) || (((ss_addr_sk#136 = ca_address_sk#448) && (ca_country#458 = United States)) && (ca_state#456 IN (VA,CA,MS) && ((cast(ss_net_profit#152 as decimal(7,2)) >= cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) <= cast(cast(25000 as decimal(5,0)) as decimal(7,2)))))))))
   +- Join Inner
      :- Join Inner
      :  :- Join Inner
      :  :  :- Join Inner
      :  :  :  :- SubqueryAlias `store_sales`
      :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
      :  :  :  +- SubqueryAlias `store`
      :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
      :  :  +- SubqueryAlias `customer_demographics`
      :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
      :  +- SubqueryAlias `customer_address`
      :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
      +- SubqueryAlias `date_dim`
         +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 190.57762839900002s
Running execution q49-v2.4 iteration: 1, StandardRun=true
19/10/04 03:27:17 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/10/04 03:27:17 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/10/04 03:27:17 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/10/04 03:27:17 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/10/04 03:27:17 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/10/04 03:27:17 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/10/04 03:27:17 INFO Query: 
== Query: q49-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#30384 ASC NULLS FIRST, return_rank#30382 ASC NULLS FIRST, currency_rank#30383 ASC NULLS FIRST], true
      +- Distinct
         +- Union
            :- Distinct
            :  +- Union
            :     :- Project [web AS channel#30384, item#30379, return_ratio#30380, return_rank#30382, currency_rank#30383]
            :     :  +- Filter ((return_rank#30382 <= 10) || (currency_rank#30383 <= 10))
            :     :     +- SubqueryAlias `web`
            :     :        +- Project [item#30379, return_ratio#30380, currency_ratio#30381, return_rank#30382, currency_rank#30383]
            :     :           +- Project [item#30379, return_ratio#30380, currency_ratio#30381, currency_rank#30383, return_rank#30382, return_rank#30382, currency_rank#30383]
            :     :              +- Window [rank(return_ratio#30380) windowspecdefinition(return_ratio#30380 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#30382], [return_ratio#30380 ASC NULLS FIRST]
            :     :                 +- Window [rank(currency_ratio#30381) windowspecdefinition(currency_ratio#30381 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#30383], [currency_ratio#30381 ASC NULLS FIRST]
            :     :                    +- Project [item#30379, return_ratio#30380, currency_ratio#30381]
            :     :                       +- SubqueryAlias `in_web`
            :     :                          +- Aggregate [ws_item_sk#219], [ws_item_sk#219 AS item#30379, CheckOverflow((promote_precision(cast(cast(sum(cast(coalesce(wr_return_quantity#298, 0) as bigint)) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(cast(coalesce(ws_quantity#234, 0) as bigint)) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#30380, CheckOverflow((promote_precision(cast(cast(sum(coalesce(cast(wr_return_amt#299 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(coalesce(cast(ws_net_paid#245 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#30381]
            :     :                             +- Filter ((((cast(wr_return_amt#299 as decimal(7,2)) > cast(cast(10000 as decimal(5,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) > cast(cast(1 as decimal(1,0)) as decimal(7,2)))) && ((cast(ws_net_paid#245 as decimal(7,2)) > cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (ws_quantity#234 > 0))) && (((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 2001)) && (d_moy#500 = 12)))
            :     :                                +- Join Inner
            :     :                                   :- Join LeftOuter, ((ws_order_number#233L = wr_order_number#297L) && (ws_item_sk#219 = wr_item_sk#286))
            :     :                                   :  :- SubqueryAlias `ws`
            :     :                                   :  :  +- SubqueryAlias `web_sales`
            :     :                                   :  :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :     :                                   :  +- SubqueryAlias `wr`
            :     :                                   :     +- SubqueryAlias `web_returns`
            :     :                                   :        +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
            :     :                                   +- SubqueryAlias `date_dim`
            :     :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     +- Project [catalog AS channel#30390, item#30385, return_ratio#30386, return_rank#30388, currency_rank#30389]
            :        +- Filter ((return_rank#30388 <= 10) || (currency_rank#30389 <= 10))
            :           +- SubqueryAlias `catalog`
            :              +- Project [item#30385, return_ratio#30386, currency_ratio#30387, return_rank#30388, currency_rank#30389]
            :                 +- Project [item#30385, return_ratio#30386, currency_ratio#30387, currency_rank#30389, return_rank#30388, return_rank#30388, currency_rank#30389]
            :                    +- Window [rank(return_ratio#30386) windowspecdefinition(return_ratio#30386 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#30388], [return_ratio#30386 ASC NULLS FIRST]
            :                       +- Window [rank(currency_ratio#30387) windowspecdefinition(currency_ratio#30387 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#30389], [currency_ratio#30387 ASC NULLS FIRST]
            :                          +- Project [item#30385, return_ratio#30386, currency_ratio#30387]
            :                             +- SubqueryAlias `in_cat`
            :                                +- Aggregate [cs_item_sk#15], [cs_item_sk#15 AS item#30385, CheckOverflow((promote_precision(cast(cast(sum(cast(coalesce(cr_return_quantity#85, 0) as bigint)) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(cast(coalesce(cs_quantity#18, 0) as bigint)) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#30386, CheckOverflow((promote_precision(cast(cast(sum(coalesce(cast(cr_return_amount#86 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(coalesce(cast(cs_net_paid#29 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#30387]
            :                                   +- Filter ((((cast(cr_return_amount#86 as decimal(7,2)) > cast(cast(10000 as decimal(5,0)) as decimal(7,2))) && (cast(cs_net_profit#33 as decimal(7,2)) > cast(cast(1 as decimal(1,0)) as decimal(7,2)))) && ((cast(cs_net_paid#29 as decimal(7,2)) > cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (cs_quantity#18 > 0))) && (((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 2001)) && (d_moy#500 = 12)))
            :                                      +- Join Inner
            :                                         :- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
            :                                         :  :- SubqueryAlias `cs`
            :                                         :  :  +- SubqueryAlias `catalog_sales`
            :                                         :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :                                         :  +- SubqueryAlias `cr`
            :                                         :     +- SubqueryAlias `catalog_returns`
            :                                         :        +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
            :                                         +- SubqueryAlias `date_dim`
            :                                            +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Project [store AS channel#30396, item#30391, return_ratio#30392, return_rank#30394, currency_rank#30395]
               +- Filter ((return_rank#30394 <= 10) || (currency_rank#30395 <= 10))
                  +- SubqueryAlias `store`
                     +- Project [item#30391, return_ratio#30392, currency_ratio#30393, return_rank#30394, currency_rank#30395]
                        +- Project [item#30391, return_ratio#30392, currency_ratio#30393, currency_rank#30395, return_rank#30394, return_rank#30394, currency_rank#30395]
                           +- Window [rank(return_ratio#30392) windowspecdefinition(return_ratio#30392 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#30394], [return_ratio#30392 ASC NULLS FIRST]
                              +- Window [rank(currency_ratio#30393) windowspecdefinition(currency_ratio#30393 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#30395], [currency_ratio#30393 ASC NULLS FIRST]
                                 +- Project [item#30391, return_ratio#30392, currency_ratio#30393]
                                    +- SubqueryAlias `in_store`
                                       +- Aggregate [ss_item_sk#132], [ss_item_sk#132 AS item#30391, CheckOverflow((promote_precision(cast(cast(sum(cast(coalesce(sr_return_quantity#186, 0) as bigint)) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(cast(coalesce(ss_quantity#140, 0) as bigint)) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#30392, CheckOverflow((promote_precision(cast(cast(sum(coalesce(cast(sr_return_amt#187 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(coalesce(cast(ss_net_paid#150 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#30393]
                                          +- Filter ((((cast(sr_return_amt#187 as decimal(7,2)) > cast(cast(10000 as decimal(5,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) > cast(cast(1 as decimal(1,0)) as decimal(7,2)))) && ((cast(ss_net_paid#150 as decimal(7,2)) > cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (ss_quantity#140 > 0))) && (((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 2001)) && (d_moy#500 = 12)))
                                             +- Join Inner
                                                :- Join LeftOuter, ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))
                                                :  :- SubqueryAlias `sts`
                                                :  :  +- SubqueryAlias `store_sales`
                                                :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                                :  +- SubqueryAlias `sr`
                                                :     +- SubqueryAlias `store_returns`
                                                :        +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                                                +- SubqueryAlias `date_dim`
                                                   +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/04 03:27:17 INFO Query: 
== Query: q49-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#30485 ASC NULLS FIRST, return_rank#30483 ASC NULLS FIRST, currency_rank#30484 ASC NULLS FIRST], true
      +- Distinct
         +- Union
            :- Distinct
            :  +- Union
            :     :- Project [web AS channel#30485, item#30480, return_ratio#30481, return_rank#30483, currency_rank#30484]
            :     :  +- Filter ((return_rank#30483 <= 10) || (currency_rank#30484 <= 10))
            :     :     +- SubqueryAlias `web`
            :     :        +- Project [item#30480, return_ratio#30481, currency_ratio#30482, return_rank#30483, currency_rank#30484]
            :     :           +- Project [item#30480, return_ratio#30481, currency_ratio#30482, return_rank#30483, currency_rank#30484, return_rank#30483, currency_rank#30484]
            :     :              +- Window [rank(currency_ratio#30482) windowspecdefinition(currency_ratio#30482 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#30484], [currency_ratio#30482 ASC NULLS FIRST]
            :     :                 +- Window [rank(return_ratio#30481) windowspecdefinition(return_ratio#30481 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#30483], [return_ratio#30481 ASC NULLS FIRST]
            :     :                    +- Project [item#30480, return_ratio#30481, currency_ratio#30482]
            :     :                       +- SubqueryAlias `in_web`
            :     :                          +- Aggregate [ws_item_sk#219], [ws_item_sk#219 AS item#30480, CheckOverflow((promote_precision(cast(cast(sum(cast(coalesce(wr_return_quantity#298, 0) as bigint)) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(cast(coalesce(ws_quantity#234, 0) as bigint)) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#30481, CheckOverflow((promote_precision(cast(cast(sum(coalesce(cast(wr_return_amt#299 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(coalesce(cast(ws_net_paid#245 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#30482]
            :     :                             +- Filter ((((cast(wr_return_amt#299 as decimal(7,2)) > cast(cast(10000 as decimal(5,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) > cast(cast(1 as decimal(1,0)) as decimal(7,2)))) && ((cast(ws_net_paid#245 as decimal(7,2)) > cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (ws_quantity#234 > 0))) && (((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 2001)) && (d_moy#500 = 12)))
            :     :                                +- Join Inner
            :     :                                   :- Join LeftOuter, ((ws_order_number#233L = wr_order_number#297L) && (ws_item_sk#219 = wr_item_sk#286))
            :     :                                   :  :- SubqueryAlias `ws`
            :     :                                   :  :  +- SubqueryAlias `web_sales`
            :     :                                   :  :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :     :                                   :  +- SubqueryAlias `wr`
            :     :                                   :     +- SubqueryAlias `web_returns`
            :     :                                   :        +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
            :     :                                   +- SubqueryAlias `date_dim`
            :     :                                      +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :     +- Project [catalog AS channel#30491, item#30486, return_ratio#30487, return_rank#30489, currency_rank#30490]
            :        +- Filter ((return_rank#30489 <= 10) || (currency_rank#30490 <= 10))
            :           +- SubqueryAlias `catalog`
            :              +- Project [item#30486, return_ratio#30487, currency_ratio#30488, return_rank#30489, currency_rank#30490]
            :                 +- Project [item#30486, return_ratio#30487, currency_ratio#30488, return_rank#30489, currency_rank#30490, return_rank#30489, currency_rank#30490]
            :                    +- Window [rank(currency_ratio#30488) windowspecdefinition(currency_ratio#30488 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#30490], [currency_ratio#30488 ASC NULLS FIRST]
            :                       +- Window [rank(return_ratio#30487) windowspecdefinition(return_ratio#30487 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#30489], [return_ratio#30487 ASC NULLS FIRST]
            :                          +- Project [item#30486, return_ratio#30487, currency_ratio#30488]
            :                             +- SubqueryAlias `in_cat`
            :                                +- Aggregate [cs_item_sk#15], [cs_item_sk#15 AS item#30486, CheckOverflow((promote_precision(cast(cast(sum(cast(coalesce(cr_return_quantity#85, 0) as bigint)) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(cast(coalesce(cs_quantity#18, 0) as bigint)) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#30487, CheckOverflow((promote_precision(cast(cast(sum(coalesce(cast(cr_return_amount#86 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(coalesce(cast(cs_net_paid#29 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#30488]
            :                                   +- Filter ((((cast(cr_return_amount#86 as decimal(7,2)) > cast(cast(10000 as decimal(5,0)) as decimal(7,2))) && (cast(cs_net_profit#33 as decimal(7,2)) > cast(cast(1 as decimal(1,0)) as decimal(7,2)))) && ((cast(cs_net_paid#29 as decimal(7,2)) > cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (cs_quantity#18 > 0))) && (((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 2001)) && (d_moy#500 = 12)))
            :                                      +- Join Inner
            :                                         :- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
            :                                         :  :- SubqueryAlias `cs`
            :                                         :  :  +- SubqueryAlias `catalog_sales`
            :                                         :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :                                         :  +- SubqueryAlias `cr`
            :                                         :     +- SubqueryAlias `catalog_returns`
            :                                         :        +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
            :                                         +- SubqueryAlias `date_dim`
            :                                            +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Project [store AS channel#30497, item#30492, return_ratio#30493, return_rank#30495, currency_rank#30496]
               +- Filter ((return_rank#30495 <= 10) || (currency_rank#30496 <= 10))
                  +- SubqueryAlias `store`
                     +- Project [item#30492, return_ratio#30493, currency_ratio#30494, return_rank#30495, currency_rank#30496]
                        +- Project [item#30492, return_ratio#30493, currency_ratio#30494, return_rank#30495, currency_rank#30496, return_rank#30495, currency_rank#30496]
                           +- Window [rank(currency_ratio#30494) windowspecdefinition(currency_ratio#30494 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS currency_rank#30496], [currency_ratio#30494 ASC NULLS FIRST]
                              +- Window [rank(return_ratio#30493) windowspecdefinition(return_ratio#30493 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS return_rank#30495], [return_ratio#30493 ASC NULLS FIRST]
                                 +- Project [item#30492, return_ratio#30493, currency_ratio#30494]
                                    +- SubqueryAlias `in_store`
                                       +- Aggregate [ss_item_sk#132], [ss_item_sk#132 AS item#30492, CheckOverflow((promote_precision(cast(cast(sum(cast(coalesce(sr_return_quantity#186, 0) as bigint)) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(cast(coalesce(ss_quantity#140, 0) as bigint)) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS return_ratio#30493, CheckOverflow((promote_precision(cast(cast(sum(coalesce(cast(sr_return_amt#187 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(sum(coalesce(cast(ss_net_paid#150 as decimal(12,2)), cast(0 as decimal(12,2)))) as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS currency_ratio#30494]
                                          +- Filter ((((cast(sr_return_amt#187 as decimal(7,2)) > cast(cast(10000 as decimal(5,0)) as decimal(7,2))) && (cast(ss_net_profit#152 as decimal(7,2)) > cast(cast(1 as decimal(1,0)) as decimal(7,2)))) && ((cast(ss_net_paid#150 as decimal(7,2)) > cast(cast(0 as decimal(1,0)) as decimal(7,2))) && (ss_quantity#140 > 0))) && (((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 2001)) && (d_moy#500 = 12)))
                                             +- Join Inner
                                                :- Join LeftOuter, ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))
                                                :  :- SubqueryAlias `sts`
                                                :  :  +- SubqueryAlias `store_sales`
                                                :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                                :  +- SubqueryAlias `sr`
                                                :     +- SubqueryAlias `store_returns`
                                                :        +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                                                +- SubqueryAlias `date_dim`
                                                   +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
19/10/04 03:27:17 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/10/04 03:27:17 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/10/04 03:27:17 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/10/04 03:27:17 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/10/04 03:27:17 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
19/10/04 03:27:17 WARN WindowExec: No Partition Defined for Window operation! Moving all data to a single partition, this can cause serious performance degradation.
Execution time: 504.693326225s
Running execution q50-v2.4 iteration: 1, StandardRun=true
19/10/04 03:35:43 INFO Query: 
== Query: q50-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [s_store_name#669, s_company_id#680, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, 30 days#30905L, 31-60 days#30906L, 61-90 days#30907L, 91-120 days#30908L, >120 days#30909L]
      +- Sort [s_store_name#669 ASC NULLS FIRST, s_company_id#680 ASC NULLS FIRST, s_street_number#682 ASC NULLS FIRST, s_street_name#683 ASC NULLS FIRST, s_street_type#684 ASC NULLS FIRST, s_suite_number#685 ASC NULLS FIRST, s_city#686 ASC NULLS FIRST, s_county#687 ASC NULLS FIRST, s_state#688 ASC NULLS FIRST, s_zip#689 ASC NULLS FIRST], true
         +- Aggregate [s_store_name#669, s_company_id#680, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689], [s_store_name#669, s_company_id#680, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, sum(cast(CASE WHEN ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days#30905L, sum(cast(CASE WHEN (((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 30) && ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31-60 days#30906L, sum(cast(CASE WHEN (((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 60) && ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61-90 days#30907L, sum(cast(CASE WHEN (((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 90) && ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91-120 days#30908L, sum(cast(CASE WHEN ((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days#30909L]
            +- Filter ((((d_year#30916 = 2001) && (d_moy#30918 = 8)) && ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))) && (((ss_sold_date_sk#130 = d_date_sk#492) && (sr_returned_date_sk#176 = d_date_sk#30910)) && ((ss_customer_sk#133 = sr_customer_sk#179) && (ss_store_sk#137 = s_store_sk#664))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  +- SubqueryAlias `store_returns`
                  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :  +- SubqueryAlias `store`
                  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  :  +- SubqueryAlias `d1`
                  :     +- SubqueryAlias `date_dim`
                  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `d2`
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#30910,d_date_id#30911,d_date#30912,d_month_seq#30913,d_week_seq#30914,d_quarter_seq#30915,d_year#30916,d_dow#30917,d_moy#30918,d_dom#30919,d_qoy#30920,d_fy_year#30921,d_fy_quarter_seq#30922,d_fy_week_seq#30923,d_day_name#30924,d_quarter_name#30925,d_holiday#30926,d_weekend#30927,d_following_holiday#30928,d_first_dom#30929,d_last_dom#30930,d_same_day_ly#30931,d_same_day_lq#30932,d_current_day#30933,... 4 more fields] parquet

     : benchmark
19/10/04 03:35:43 INFO Query: 
== Query: q50-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [s_store_name#669, s_company_id#680, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, 30 days#30968L, 31-60 days#30969L, 61-90 days#30970L, 91-120 days#30971L, >120 days#30972L]
      +- Sort [s_store_name#669 ASC NULLS FIRST, s_company_id#680 ASC NULLS FIRST, s_street_number#682 ASC NULLS FIRST, s_street_name#683 ASC NULLS FIRST, s_street_type#684 ASC NULLS FIRST, s_suite_number#685 ASC NULLS FIRST, s_city#686 ASC NULLS FIRST, s_county#687 ASC NULLS FIRST, s_state#688 ASC NULLS FIRST, s_zip#689 ASC NULLS FIRST], true
         +- Aggregate [s_store_name#669, s_company_id#680, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689], [s_store_name#669, s_company_id#680, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, sum(cast(CASE WHEN ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days#30968L, sum(cast(CASE WHEN (((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 30) && ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31-60 days#30969L, sum(cast(CASE WHEN (((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 60) && ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61-90 days#30970L, sum(cast(CASE WHEN (((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 90) && ((sr_returned_date_sk#176 - ss_sold_date_sk#130) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91-120 days#30971L, sum(cast(CASE WHEN ((sr_returned_date_sk#176 - ss_sold_date_sk#130) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days#30972L]
            +- Filter ((((d_year#30979 = 2001) && (d_moy#30981 = 8)) && ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))) && (((ss_sold_date_sk#130 = d_date_sk#492) && (sr_returned_date_sk#176 = d_date_sk#30973)) && ((ss_customer_sk#133 = sr_customer_sk#179) && (ss_store_sk#137 = s_store_sk#664))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  :  +- SubqueryAlias `store_returns`
                  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :  +- SubqueryAlias `store`
                  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  :  +- SubqueryAlias `d1`
                  :     +- SubqueryAlias `date_dim`
                  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `d2`
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#30973,d_date_id#30974,d_date#30975,d_month_seq#30976,d_week_seq#30977,d_quarter_seq#30978,d_year#30979,d_dow#30980,d_moy#30981,d_dom#30982,d_qoy#30983,d_fy_year#30984,d_fy_quarter_seq#30985,d_fy_week_seq#30986,d_day_name#30987,d_quarter_name#30988,d_holiday#30989,d_weekend#30990,d_following_holiday#30991,d_first_dom#30992,d_last_dom#30993,d_same_day_ly#30994,d_same_day_lq#30995,d_current_day#30996,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 996.0270729490001s
Running execution q51-v2.4 iteration: 1, StandardRun=true
19/10/04 03:52:21 INFO Query: 
== Query: q51-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_sk#31228 ASC NULLS FIRST, d_date#31229 ASC NULLS FIRST], true
      +- Project [item_sk#31228, d_date#31229, web_sales#31230, store_sales#31231, web_cumulative#31232, store_cumulative#31233]
         +- Filter (web_cumulative#31232 > store_cumulative#31233)
            +- SubqueryAlias `y`
               +- Project [item_sk#31228, d_date#31229, web_sales#31230, store_sales#31231, web_cumulative#31232, store_cumulative#31233]
                  +- Project [item_sk#31228, d_date#31229, web_sales#31230, store_sales#31231, web_cumulative#31232, store_cumulative#31233, web_cumulative#31232, store_cumulative#31233]
                     +- Window [max(web_sales#31230) windowspecdefinition(item_sk#31228, d_date#31229 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS web_cumulative#31232, max(store_sales#31231) windowspecdefinition(item_sk#31228, d_date#31229 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS store_cumulative#31233], [item_sk#31228], [d_date#31229 ASC NULLS FIRST]
                        +- Project [item_sk#31228, d_date#31229, web_sales#31230, store_sales#31231]
                           +- SubqueryAlias `x`
                              +- Project [CASE WHEN isnotnull(item_sk#31234) THEN item_sk#31234 ELSE item_sk#31236 END AS item_sk#31228, CASE WHEN isnotnull(d_date#494) THEN d_date#494 ELSE d_date#31246 END AS d_date#31229, cume_sales#31235 AS web_sales#31230, cume_sales#31237 AS store_sales#31231]
                                 +- Join FullOuter, ((item_sk#31234 = item_sk#31236) && (d_date#494 = d_date#31246))
                                    :- SubqueryAlias `web`
                                    :  +- SubqueryAlias `web_v1`
                                    :     +- Project [item_sk#31234, d_date#494, cume_sales#31235]
                                    :        +- Project [item_sk#31234, d_date#494, _w0#31240, ws_item_sk#219, cume_sales#31235, cume_sales#31235]
                                    :           +- Window [sum(_w0#31240) windowspecdefinition(ws_item_sk#219, d_date#494 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#31235], [ws_item_sk#219], [d_date#494 ASC NULLS FIRST]
                                    :              +- Aggregate [ws_item_sk#219, d_date#494], [ws_item_sk#219 AS item_sk#31234, d_date#494, sum(ws_sales_price#237) AS _w0#31240, ws_item_sk#219]
                                    :                 +- Filter (((ws_sold_date_sk#216 = d_date_sk#492) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11)))) && isnotnull(ws_item_sk#219))
                                    :                    +- Join Inner
                                    :                       :- SubqueryAlias `web_sales`
                                    :                       :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :                       +- SubqueryAlias `date_dim`
                                    :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                    +- SubqueryAlias `store`
                                       +- SubqueryAlias `store_v1`
                                          +- Project [item_sk#31236, d_date#31246, cume_sales#31237]
                                             +- Project [item_sk#31236, d_date#31246, _w0#31243, ss_item_sk#132, cume_sales#31237, cume_sales#31237]
                                                +- Window [sum(_w0#31243) windowspecdefinition(ss_item_sk#132, d_date#31246 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#31237], [ss_item_sk#132], [d_date#31246 ASC NULLS FIRST]
                                                   +- Aggregate [ss_item_sk#132, d_date#31246], [ss_item_sk#132 AS item_sk#31236, d_date#31246, sum(ss_sales_price#143) AS _w0#31243, ss_item_sk#132]
                                                      +- Filter (((ss_sold_date_sk#130 = d_date_sk#31244) && ((d_month_seq#31247 >= 1200) && (d_month_seq#31247 <= (1200 + 11)))) && isnotnull(ss_item_sk#132))
                                                         +- Join Inner
                                                            :- SubqueryAlias `store_sales`
                                                            :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                                            +- SubqueryAlias `date_dim`
                                                               +- Relation[d_date_sk#31244,d_date_id#31245,d_date#31246,d_month_seq#31247,d_week_seq#31248,d_quarter_seq#31249,d_year#31250,d_dow#31251,d_moy#31252,d_dom#31253,d_qoy#31254,d_fy_year#31255,d_fy_quarter_seq#31256,d_fy_week_seq#31257,d_day_name#31258,d_quarter_name#31259,d_holiday#31260,d_weekend#31261,d_following_holiday#31262,d_first_dom#31263,d_last_dom#31264,d_same_day_ly#31265,d_same_day_lq#31266,d_current_day#31267,... 4 more fields] parquet

     : benchmark
19/10/04 03:52:21 INFO Query: 
== Query: q51-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_sk#31280 ASC NULLS FIRST, d_date#31281 ASC NULLS FIRST], true
      +- Project [item_sk#31280, d_date#31281, web_sales#31282, store_sales#31283, web_cumulative#31284, store_cumulative#31285]
         +- Filter (web_cumulative#31284 > store_cumulative#31285)
            +- SubqueryAlias `y`
               +- Project [item_sk#31280, d_date#31281, web_sales#31282, store_sales#31283, web_cumulative#31284, store_cumulative#31285]
                  +- Project [item_sk#31280, d_date#31281, web_sales#31282, store_sales#31283, web_cumulative#31284, store_cumulative#31285, web_cumulative#31284, store_cumulative#31285]
                     +- Window [max(web_sales#31282) windowspecdefinition(item_sk#31280, d_date#31281 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS web_cumulative#31284, max(store_sales#31283) windowspecdefinition(item_sk#31280, d_date#31281 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS store_cumulative#31285], [item_sk#31280], [d_date#31281 ASC NULLS FIRST]
                        +- Project [item_sk#31280, d_date#31281, web_sales#31282, store_sales#31283]
                           +- SubqueryAlias `x`
                              +- Project [CASE WHEN isnotnull(item_sk#31286) THEN item_sk#31286 ELSE item_sk#31288 END AS item_sk#31280, CASE WHEN isnotnull(d_date#494) THEN d_date#494 ELSE d_date#31298 END AS d_date#31281, cume_sales#31287 AS web_sales#31282, cume_sales#31289 AS store_sales#31283]
                                 +- Join FullOuter, ((item_sk#31286 = item_sk#31288) && (d_date#494 = d_date#31298))
                                    :- SubqueryAlias `web`
                                    :  +- SubqueryAlias `web_v1`
                                    :     +- Project [item_sk#31286, d_date#494, cume_sales#31287]
                                    :        +- Project [item_sk#31286, d_date#494, _w0#31292, ws_item_sk#219, cume_sales#31287, cume_sales#31287]
                                    :           +- Window [sum(_w0#31292) windowspecdefinition(ws_item_sk#219, d_date#494 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#31287], [ws_item_sk#219], [d_date#494 ASC NULLS FIRST]
                                    :              +- Aggregate [ws_item_sk#219, d_date#494], [ws_item_sk#219 AS item_sk#31286, d_date#494, sum(ws_sales_price#237) AS _w0#31292, ws_item_sk#219]
                                    :                 +- Filter (((ws_sold_date_sk#216 = d_date_sk#492) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11)))) && isnotnull(ws_item_sk#219))
                                    :                    +- Join Inner
                                    :                       :- SubqueryAlias `web_sales`
                                    :                       :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :                       +- SubqueryAlias `date_dim`
                                    :                          +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                    +- SubqueryAlias `store`
                                       +- SubqueryAlias `store_v1`
                                          +- Project [item_sk#31288, d_date#31298, cume_sales#31289]
                                             +- Project [item_sk#31288, d_date#31298, _w0#31295, ss_item_sk#132, cume_sales#31289, cume_sales#31289]
                                                +- Window [sum(_w0#31295) windowspecdefinition(ss_item_sk#132, d_date#31298 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS cume_sales#31289], [ss_item_sk#132], [d_date#31298 ASC NULLS FIRST]
                                                   +- Aggregate [ss_item_sk#132, d_date#31298], [ss_item_sk#132 AS item_sk#31288, d_date#31298, sum(ss_sales_price#143) AS _w0#31295, ss_item_sk#132]
                                                      +- Filter (((ss_sold_date_sk#130 = d_date_sk#31296) && ((d_month_seq#31299 >= 1200) && (d_month_seq#31299 <= (1200 + 11)))) && isnotnull(ss_item_sk#132))
                                                         +- Join Inner
                                                            :- SubqueryAlias `store_sales`
                                                            :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                                            +- SubqueryAlias `date_dim`
                                                               +- Relation[d_date_sk#31296,d_date_id#31297,d_date#31298,d_month_seq#31299,d_week_seq#31300,d_quarter_seq#31301,d_year#31302,d_dow#31303,d_moy#31304,d_dom#31305,d_qoy#31306,d_fy_year#31307,d_fy_quarter_seq#31308,d_fy_week_seq#31309,d_day_name#31310,d_quarter_name#31311,d_holiday#31312,d_weekend#31313,d_following_holiday#31314,d_first_dom#31315,d_last_dom#31316,d_same_day_ly#31317,d_same_day_lq#31318,d_current_day#31319,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 225.610397382s
Running execution q52-v2.4 iteration: 1, StandardRun=true
19/10/04 03:56:09 INFO Query: 
== Query: q52-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [d_year#498 ASC NULLS FIRST, ext_price#31460 DESC NULLS LAST, brand_id#31458 ASC NULLS FIRST], true
      +- Aggregate [d_year#498, i_brand#572, i_brand_id#571], [d_year#498, i_brand_id#571 AS brand_id#31458, i_brand#572 AS brand#31459, sum(ss_ext_sales_price#145) AS ext_price#31460]
         +- Filter ((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 1)) && ((d_moy#500 = 11) && (d_year#498 = 2000)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dt`
               :  :  +- SubqueryAlias `date_dim`
               :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/04 03:56:09 INFO Query: 
== Query: q52-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [d_year#498 ASC NULLS FIRST, ext_price#31471 DESC NULLS LAST, brand_id#31469 ASC NULLS FIRST], true
      +- Aggregate [d_year#498, i_brand#572, i_brand_id#571], [d_year#498, i_brand_id#571 AS brand_id#31469, i_brand#572 AS brand#31470, sum(ss_ext_sales_price#145) AS ext_price#31471]
         +- Filter ((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 1)) && ((d_moy#500 = 11) && (d_year#498 = 2000)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dt`
               :  :  +- SubqueryAlias `date_dim`
               :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 93.012666797s
Running execution q53-v2.4 iteration: 1, StandardRun=true
19/10/04 03:57:44 INFO Query: 
== Query: q53-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [avg_quarterly_sales#31517 ASC NULLS FIRST, sum_sales#31516 ASC NULLS FIRST, i_manufact_id#577 ASC NULLS FIRST], true
      +- Project [i_manufact_id#577, sum_sales#31516, avg_quarterly_sales#31517]
         +- Filter (cast(CASE WHEN (cast(avg_quarterly_sales#31517 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#31516 as decimal(22,6))) - promote_precision(cast(avg_quarterly_sales#31517 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_quarterly_sales#31517 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16)))
            +- SubqueryAlias `tmp1`
               +- Project [i_manufact_id#577, sum_sales#31516, avg_quarterly_sales#31517]
                  +- Project [i_manufact_id#577, sum_sales#31516, _w0#31521, avg_quarterly_sales#31517, avg_quarterly_sales#31517]
                     +- Window [avg(_w0#31521) windowspecdefinition(i_manufact_id#577, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_quarterly_sales#31517], [i_manufact_id#577]
                        +- Aggregate [i_manufact_id#577, d_qoy#502], [i_manufact_id#577, sum(ss_sales_price#143) AS sum_sales#31516, sum(ss_sales_price#143) AS _w0#31521]
                           +- Filter ((((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_store_sk#137 = s_store_sk#664)) && (d_month_seq#495 IN (1200,(1200 + 1),(1200 + 2),(1200 + 3),(1200 + 4),(1200 + 5),(1200 + 6),(1200 + 7),(1200 + 8),(1200 + 9),(1200 + 10),(1200 + 11)) && (((i_category#576 IN (Books,Children,Electronics) && i_class#574 IN (personal,portable,reference,self-help)) && i_brand#572 IN (scholaramalgamalg #14,scholaramalgamalg #7,exportiunivamalg #9,scholaramalgamalg #9)) || ((i_category#576 IN (Women,Music,Men) && i_class#574 IN (accessories,classical,fragrances,pants)) && i_brand#572 IN (amalgimporto #1,edu packscholar #1,exportiimporto #1,importoamalg #1)))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `item`
                                 :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :  :  +- SubqueryAlias `store_sales`
                                 :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `date_dim`
                                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- SubqueryAlias `store`
                                    +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/10/04 03:57:44 INFO Query: 
== Query: q53-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [avg_quarterly_sales#31526 ASC NULLS FIRST, sum_sales#31525 ASC NULLS FIRST, i_manufact_id#577 ASC NULLS FIRST], true
      +- Project [i_manufact_id#577, sum_sales#31525, avg_quarterly_sales#31526]
         +- Filter (cast(CASE WHEN (cast(avg_quarterly_sales#31526 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#31525 as decimal(22,6))) - promote_precision(cast(avg_quarterly_sales#31526 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_quarterly_sales#31526 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16)))
            +- SubqueryAlias `tmp1`
               +- Project [i_manufact_id#577, sum_sales#31525, avg_quarterly_sales#31526]
                  +- Project [i_manufact_id#577, sum_sales#31525, _w0#31530, avg_quarterly_sales#31526, avg_quarterly_sales#31526]
                     +- Window [avg(_w0#31530) windowspecdefinition(i_manufact_id#577, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_quarterly_sales#31526], [i_manufact_id#577]
                        +- Aggregate [i_manufact_id#577, d_qoy#502], [i_manufact_id#577, sum(ss_sales_price#143) AS sum_sales#31525, sum(ss_sales_price#143) AS _w0#31530]
                           +- Filter ((((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_store_sk#137 = s_store_sk#664)) && (d_month_seq#495 IN (1200,(1200 + 1),(1200 + 2),(1200 + 3),(1200 + 4),(1200 + 5),(1200 + 6),(1200 + 7),(1200 + 8),(1200 + 9),(1200 + 10),(1200 + 11)) && (((i_category#576 IN (Books,Children,Electronics) && i_class#574 IN (personal,portable,reference,self-help)) && i_brand#572 IN (scholaramalgamalg #14,scholaramalgamalg #7,exportiunivamalg #9,scholaramalgamalg #9)) || ((i_category#576 IN (Women,Music,Men) && i_class#574 IN (accessories,classical,fragrances,pants)) && i_brand#572 IN (amalgimporto #1,edu packscholar #1,exportiimporto #1,importoamalg #1)))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `item`
                                 :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :  :  +- SubqueryAlias `store_sales`
                                 :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `date_dim`
                                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- SubqueryAlias `store`
                                    +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 106.164152643s
Running execution q54-v2.4 iteration: 1, StandardRun=true
19/10/04 03:59:33 INFO Query: 
== Query: q54-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [segment#31591 ASC NULLS FIRST, num_customers#31580L ASC NULLS FIRST], true
      +- Aggregate [segment#31591], [segment#31591, count(1) AS num_customers#31580L, (segment#31591 * 50) AS segment_base#31581]
         +- SubqueryAlias `segments`
            +- Project [cast(CheckOverflow((promote_precision(cast(revenue#31588 as decimal(17,2))) / promote_precision(cast(cast(50 as decimal(2,0)) as decimal(17,2)))), DecimalType(21,6)) as int) AS segment#31591]
               +- SubqueryAlias `my_revenue`
                  +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(ss_ext_sales_price#145) AS revenue#31588]
                     +- Filter ((((c_current_addr_sk#416 = ca_address_sk#448) && (ca_county#455 = s_county#687)) && (ca_state#456 = s_state#688)) && (((ss_sold_date_sk#130 = d_date_sk#492) && (c_customer_sk#412 = ss_customer_sk#133)) && ((d_month_seq#495 >= scalar-subquery#31589 []) && (d_month_seq#495 <= scalar-subquery#31590 []))))
                        :  :- Distinct
                        :  :  +- Project [(d_month_seq#495 + 1) AS (d_month_seq + 1)#31592]
                        :  :     +- Filter ((d_year#498 = 1998) && (d_moy#500 = 12))
                        :  :        +- SubqueryAlias `date_dim`
                        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  +- Distinct
                        :     +- Project [(d_month_seq#495 + 3) AS (d_month_seq + 3)#31593]
                        :        +- Filter ((d_year#498 = 1998) && (d_moy#500 = 12))
                        :           +- SubqueryAlias `date_dim`
                        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Join Inner
                           :- Join Inner
                           :  :- Join Inner
                           :  :  :- Join Inner
                           :  :  :  :- SubqueryAlias `my_customers`
                           :  :  :  :  +- Distinct
                           :  :  :  :     +- Project [c_customer_sk#412, c_current_addr_sk#416]
                           :  :  :  :        +- Filter ((((sold_date_sk#31582 = d_date_sk#492) && (item_sk#31584 = i_item_sk#564)) && ((i_category#576 = Women) && (i_class#574 = maternity))) && (((c_customer_sk#412 = customer_sk#31583) && (d_moy#500 = 12)) && (d_year#498 = 1998)))
                           :  :  :  :           +- Join Inner
                           :  :  :  :              :- Join Inner
                           :  :  :  :              :  :- Join Inner
                           :  :  :  :              :  :  :- SubqueryAlias `cs_or_ws_sales`
                           :  :  :  :              :  :  :  +- Union
                           :  :  :  :              :  :  :     :- Project [cs_sold_date_sk#0 AS sold_date_sk#31582, cs_bill_customer_sk#3 AS customer_sk#31583, cs_item_sk#15 AS item_sk#31584]
                           :  :  :  :              :  :  :     :  +- SubqueryAlias `catalog_sales`
                           :  :  :  :              :  :  :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :  :  :  :              :  :  :     +- Project [ws_sold_date_sk#216 AS sold_date_sk#31585, ws_bill_customer_sk#220 AS customer_sk#31586, ws_item_sk#219 AS item_sk#31587]
                           :  :  :  :              :  :  :        +- SubqueryAlias `web_sales`
                           :  :  :  :              :  :  :           +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :  :  :  :              :  :  +- SubqueryAlias `item`
                           :  :  :  :              :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           :  :  :  :              :  +- SubqueryAlias `date_dim`
                           :  :  :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :  :  :  :              +- SubqueryAlias `customer`
                           :  :  :  :                 +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                           :  :  :  +- SubqueryAlias `store_sales`
                           :  :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :  :  +- SubqueryAlias `customer_address`
                           :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                           :  +- SubqueryAlias `store`
                           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/04 03:59:33 INFO Query: 
== Query: q54-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [segment#31612 ASC NULLS FIRST, num_customers#31601L ASC NULLS FIRST], true
      +- Aggregate [segment#31612], [segment#31612, count(1) AS num_customers#31601L, (segment#31612 * 50) AS segment_base#31602]
         +- SubqueryAlias `segments`
            +- Project [cast(CheckOverflow((promote_precision(cast(revenue#31609 as decimal(17,2))) / promote_precision(cast(cast(50 as decimal(2,0)) as decimal(17,2)))), DecimalType(21,6)) as int) AS segment#31612]
               +- SubqueryAlias `my_revenue`
                  +- Aggregate [c_customer_sk#412], [c_customer_sk#412, sum(ss_ext_sales_price#145) AS revenue#31609]
                     +- Filter ((((c_current_addr_sk#416 = ca_address_sk#448) && (ca_county#455 = s_county#687)) && (ca_state#456 = s_state#688)) && (((ss_sold_date_sk#130 = d_date_sk#492) && (c_customer_sk#412 = ss_customer_sk#133)) && ((d_month_seq#495 >= scalar-subquery#31610 []) && (d_month_seq#495 <= scalar-subquery#31611 []))))
                        :  :- Distinct
                        :  :  +- Project [(d_month_seq#495 + 1) AS (d_month_seq + 1)#31613]
                        :  :     +- Filter ((d_year#498 = 1998) && (d_moy#500 = 12))
                        :  :        +- SubqueryAlias `date_dim`
                        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  +- Distinct
                        :     +- Project [(d_month_seq#495 + 3) AS (d_month_seq + 3)#31614]
                        :        +- Filter ((d_year#498 = 1998) && (d_moy#500 = 12))
                        :           +- SubqueryAlias `date_dim`
                        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Join Inner
                           :- Join Inner
                           :  :- Join Inner
                           :  :  :- Join Inner
                           :  :  :  :- SubqueryAlias `my_customers`
                           :  :  :  :  +- Distinct
                           :  :  :  :     +- Project [c_customer_sk#412, c_current_addr_sk#416]
                           :  :  :  :        +- Filter ((((sold_date_sk#31603 = d_date_sk#492) && (item_sk#31605 = i_item_sk#564)) && ((i_category#576 = Women) && (i_class#574 = maternity))) && (((c_customer_sk#412 = customer_sk#31604) && (d_moy#500 = 12)) && (d_year#498 = 1998)))
                           :  :  :  :           +- Join Inner
                           :  :  :  :              :- Join Inner
                           :  :  :  :              :  :- Join Inner
                           :  :  :  :              :  :  :- SubqueryAlias `cs_or_ws_sales`
                           :  :  :  :              :  :  :  +- Union
                           :  :  :  :              :  :  :     :- Project [cs_sold_date_sk#0 AS sold_date_sk#31603, cs_bill_customer_sk#3 AS customer_sk#31604, cs_item_sk#15 AS item_sk#31605]
                           :  :  :  :              :  :  :     :  +- SubqueryAlias `catalog_sales`
                           :  :  :  :              :  :  :     :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :  :  :  :              :  :  :     +- Project [ws_sold_date_sk#216 AS sold_date_sk#31606, ws_bill_customer_sk#220 AS customer_sk#31607, ws_item_sk#219 AS item_sk#31608]
                           :  :  :  :              :  :  :        +- SubqueryAlias `web_sales`
                           :  :  :  :              :  :  :           +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :  :  :  :              :  :  +- SubqueryAlias `item`
                           :  :  :  :              :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           :  :  :  :              :  +- SubqueryAlias `date_dim`
                           :  :  :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :  :  :  :              +- SubqueryAlias `customer`
                           :  :  :  :                 +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                           :  :  :  +- SubqueryAlias `store_sales`
                           :  :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :  :  +- SubqueryAlias `customer_address`
                           :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                           :  +- SubqueryAlias `store`
                           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 675.430756513s
Running execution q55-v2.4 iteration: 1, StandardRun=true
19/10/04 04:10:51 INFO Query: 
== Query: q55-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ext_price#31682 DESC NULLS LAST, brand_id#31680 ASC NULLS FIRST], true
      +- Aggregate [i_brand#572, i_brand_id#571], [i_brand_id#571 AS brand_id#31680, i_brand#572 AS brand#31681, sum(ss_ext_sales_price#145) AS ext_price#31682]
         +- Filter ((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 28)) && ((d_moy#500 = 11) && (d_year#498 = 1999)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `date_dim`
               :  :  +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/04 04:10:51 INFO Query: 
== Query: q55-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [ext_price#31691 DESC NULLS LAST, brand_id#31689 ASC NULLS FIRST], true
      +- Aggregate [i_brand#572, i_brand_id#571], [i_brand_id#571 AS brand_id#31689, i_brand#572 AS brand#31690, sum(ss_ext_sales_price#145) AS ext_price#31691]
         +- Filter ((((d_date_sk#492 = ss_sold_date_sk#130) && (ss_item_sk#132 = i_item_sk#564)) && (i_manager_id#584 = 28)) && ((d_moy#500 = 11) && (d_year#498 = 1999)))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `date_dim`
               :  :  +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `store_sales`
               :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               +- SubqueryAlias `item`
                  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 98.355111734s
Running execution q56-v2.4 iteration: 1, StandardRun=true
19/10/04 04:12:32 INFO Query: 
== Query: q56-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [total_sales#31747 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565], [i_item_id#565, sum(total_sales#31748) AS total_sales#31747]
         +- SubqueryAlias `tmp1`
            +- Union
               :- Union
               :  :- Project [i_item_id#565, total_sales#31748]
               :  :  +- SubqueryAlias `ss`
               :  :     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ss_ext_sales_price#145) AS total_sales#31748]
               :  :        +- Filter (((i_item_id#565 IN (list#31749 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 2001))) && (((d_moy#500 = 2) && (ss_addr_sk#136 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :  :           :  +- Project [i_item_id#565]
               :  :           :     +- Filter i_color#581 IN (slate,blanched,burnished)
               :  :           :        +- SubqueryAlias `item`
               :  :           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- Join Inner
               :  :              :  :  :- SubqueryAlias `store_sales`
               :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :              :  :  +- SubqueryAlias `date_dim`
               :  :              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              :  +- SubqueryAlias `customer_address`
               :  :              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  :              +- SubqueryAlias `item`
               :  :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- Project [i_item_id#565, total_sales#31750]
               :     +- SubqueryAlias `cs`
               :        +- Aggregate [i_item_id#565], [i_item_id#565, sum(cs_ext_sales_price#23) AS total_sales#31750]
               :           +- Filter (((i_item_id#565 IN (list#31751 []) && (cs_item_sk#15 = i_item_sk#564)) && ((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 2001))) && (((d_moy#500 = 2) && (cs_bill_addr_sk#6 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :              :  +- Project [i_item_id#565]
               :              :     +- Filter i_color#581 IN (slate,blanched,burnished)
               :              :        +- SubqueryAlias `item`
               :              :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- Join Inner
               :                 :  :  :- SubqueryAlias `catalog_sales`
               :                 :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :  :  +- SubqueryAlias `date_dim`
               :                 :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :  +- SubqueryAlias `customer_address`
               :                 :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :                 +- SubqueryAlias `item`
               :                    +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Project [i_item_id#565, total_sales#31752]
                  +- SubqueryAlias `ws`
                     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ws_ext_sales_price#239) AS total_sales#31752]
                        +- Filter (((i_item_id#565 IN (list#31753 []) && (ws_item_sk#219 = i_item_sk#564)) && ((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 2001))) && (((d_moy#500 = 2) && (ws_bill_addr_sk#223 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
                           :  +- Project [i_item_id#565]
                           :     +- Filter i_color#581 IN (slate,blanched,burnished)
                           :        +- SubqueryAlias `item`
                           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `web_sales`
                              :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :  +- SubqueryAlias `date_dim`
                              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `customer_address`
                              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/04 04:12:32 INFO Query: 
== Query: q56-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [total_sales#31761 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565], [i_item_id#565, sum(total_sales#31762) AS total_sales#31761]
         +- SubqueryAlias `tmp1`
            +- Union
               :- Union
               :  :- Project [i_item_id#565, total_sales#31762]
               :  :  +- SubqueryAlias `ss`
               :  :     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ss_ext_sales_price#145) AS total_sales#31762]
               :  :        +- Filter (((i_item_id#565 IN (list#31763 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 2001))) && (((d_moy#500 = 2) && (ss_addr_sk#136 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :  :           :  +- Project [i_item_id#565]
               :  :           :     +- Filter i_color#581 IN (slate,blanched,burnished)
               :  :           :        +- SubqueryAlias `item`
               :  :           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- Join Inner
               :  :              :  :  :- SubqueryAlias `store_sales`
               :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :              :  :  +- SubqueryAlias `date_dim`
               :  :              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              :  +- SubqueryAlias `customer_address`
               :  :              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  :              +- SubqueryAlias `item`
               :  :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- Project [i_item_id#565, total_sales#31764]
               :     +- SubqueryAlias `cs`
               :        +- Aggregate [i_item_id#565], [i_item_id#565, sum(cs_ext_sales_price#23) AS total_sales#31764]
               :           +- Filter (((i_item_id#565 IN (list#31765 []) && (cs_item_sk#15 = i_item_sk#564)) && ((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 2001))) && (((d_moy#500 = 2) && (cs_bill_addr_sk#6 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :              :  +- Project [i_item_id#565]
               :              :     +- Filter i_color#581 IN (slate,blanched,burnished)
               :              :        +- SubqueryAlias `item`
               :              :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- Join Inner
               :                 :  :  :- SubqueryAlias `catalog_sales`
               :                 :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :  :  +- SubqueryAlias `date_dim`
               :                 :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :  +- SubqueryAlias `customer_address`
               :                 :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :                 +- SubqueryAlias `item`
               :                    +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Project [i_item_id#565, total_sales#31766]
                  +- SubqueryAlias `ws`
                     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ws_ext_sales_price#239) AS total_sales#31766]
                        +- Filter (((i_item_id#565 IN (list#31767 []) && (ws_item_sk#219 = i_item_sk#564)) && ((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 2001))) && (((d_moy#500 = 2) && (ws_bill_addr_sk#223 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
                           :  +- Project [i_item_id#565]
                           :     +- Filter i_color#581 IN (slate,blanched,burnished)
                           :        +- SubqueryAlias `item`
                           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `web_sales`
                              :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :  +- SubqueryAlias `date_dim`
                              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `customer_address`
                              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 240.945181674s
Running execution q57-v2.4 iteration: 1, StandardRun=true
19/10/04 04:16:36 INFO Query: 
== Query: q57-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#32935 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#32936 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, cc_name#338 ASC NULLS FIRST], true
      +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, avg_monthly_sales#32936, sum_sales#32935, psum#32938, nsum#32939]
         +- Filter (((d_year#498 = 1999) && (cast(avg_monthly_sales#32936 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6)))) && (cast(CASE WHEN (cast(avg_monthly_sales#32936 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#32935 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#32936 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#32936 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16))))
            +- SubqueryAlias `v2`
               +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, avg_monthly_sales#32936, sum_sales#32935, sum_sales#33147 AS psum#32938, sum_sales#33634 AS nsum#32939]
                  +- Filter ((((i_category#576 = i_category#33254) && (i_category#576 = i_category#33741)) && ((i_brand#572 = i_brand#33250) && (i_brand#572 = i_brand#33737))) && (((cc_name#338 = cc_name#33416) && (cc_name#338 = cc_name#33903)) && ((rn#32937 = (rn#33051 + 1)) && (rn#32937 = (rn#33538 - 1)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `v1`
                        :  :  +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, sum_sales#32935, avg_monthly_sales#32936, rn#32937]
                        :  :     +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, sum_sales#32935, _w0#32949, rn#32937, avg_monthly_sales#32936, avg_monthly_sales#32936, rn#32937]
                        :  :        +- Window [avg(_w0#32949) windowspecdefinition(i_category#576, i_brand#572, cc_name#338, d_year#498, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#32936], [i_category#576, i_brand#572, cc_name#338, d_year#498]
                        :  :           +- Window [rank(d_year#498, d_moy#500) windowspecdefinition(i_category#576, i_brand#572, cc_name#338, d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#32937], [i_category#576, i_brand#572, cc_name#338], [d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST]
                        :  :              +- Aggregate [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500], [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, sum(cs_sales_price#21) AS sum_sales#32935, sum(cs_sales_price#21) AS _w0#32949]
                        :  :                 +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((cc_call_center_sk#332 = cs_call_center_sk#11) && (((d_year#498 = 1999) || ((d_year#498 = (1999 - 1)) && (d_moy#500 = 12))) || ((d_year#498 = (1999 + 1)) && (d_moy#500 = 1)))))
                        :  :                    +- Join Inner
                        :  :                       :- Join Inner
                        :  :                       :  :- Join Inner
                        :  :                       :  :  :- SubqueryAlias `item`
                        :  :                       :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        :  :                       :  :  +- SubqueryAlias `catalog_sales`
                        :  :                       :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :                       :  +- SubqueryAlias `date_dim`
                        :  :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :                       +- SubqueryAlias `call_center`
                        :  :                          +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet
                        :  +- SubqueryAlias `v1_lag`
                        :     +- SubqueryAlias `v1`
                        :        +- Project [i_category#33254, i_brand#33250, cc_name#33416, d_year#33341, d_moy#33343, sum_sales#33147, avg_monthly_sales#32954, rn#33051]
                        :           +- Project [i_category#33254, i_brand#33250, cc_name#33416, d_year#33341, d_moy#33343, sum_sales#33147, _w0#33148, rn#33051, avg_monthly_sales#32954, avg_monthly_sales#32954, rn#33051]
                        :              +- Window [avg(_w0#33148) windowspecdefinition(i_category#33254, i_brand#33250, cc_name#33416, d_year#33341, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#32954], [i_category#33254, i_brand#33250, cc_name#33416, d_year#33341]
                        :                 +- Window [rank(d_year#33341, d_moy#33343) windowspecdefinition(i_category#33254, i_brand#33250, cc_name#33416, d_year#33341 ASC NULLS FIRST, d_moy#33343 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#33051], [i_category#33254, i_brand#33250, cc_name#33416], [d_year#33341 ASC NULLS FIRST, d_moy#33343 ASC NULLS FIRST]
                        :                    +- Aggregate [i_category#33254, i_brand#33250, cc_name#33416, d_year#33341, d_moy#33343], [i_category#33254, i_brand#33250, cc_name#33416, d_year#33341, d_moy#33343, sum(cs_sales_price#21) AS sum_sales#33147, sum(cs_sales_price#21) AS _w0#33148]
                        :                       +- Filter (((cs_item_sk#15 = i_item_sk#33242) && (cs_sold_date_sk#0 = d_date_sk#33335)) && ((cc_call_center_sk#33410 = cs_call_center_sk#11) && (((d_year#33341 = 1999) || ((d_year#33341 = (1999 - 1)) && (d_moy#33343 = 12))) || ((d_year#33341 = (1999 + 1)) && (d_moy#33343 = 1)))))
                        :                          +- Join Inner
                        :                             :- Join Inner
                        :                             :  :- Join Inner
                        :                             :  :  :- SubqueryAlias `item`
                        :                             :  :  :  +- Relation[i_item_sk#33242,i_item_id#33243,i_rec_start_date#33244,i_rec_end_date#33245,i_item_desc#33246,i_current_price#33247,i_wholesale_cost#33248,i_brand_id#33249,i_brand#33250,i_class_id#33251,i_class#33252,i_category_id#33253,i_category#33254,i_manufact_id#33255,i_manufact#33256,i_size#33257,i_formulation#33258,i_color#33259,i_units#33260,i_container#33261,i_manager_id#33262,i_product_name#33263] parquet
                        :                             :  :  +- SubqueryAlias `catalog_sales`
                        :                             :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :                             :  +- SubqueryAlias `date_dim`
                        :                             :     +- Relation[d_date_sk#33335,d_date_id#33336,d_date#33337,d_month_seq#33338,d_week_seq#33339,d_quarter_seq#33340,d_year#33341,d_dow#33342,d_moy#33343,d_dom#33344,d_qoy#33345,d_fy_year#33346,d_fy_quarter_seq#33347,d_fy_week_seq#33348,d_day_name#33349,d_quarter_name#33350,d_holiday#33351,d_weekend#33352,d_following_holiday#33353,d_first_dom#33354,d_last_dom#33355,d_same_day_ly#33356,d_same_day_lq#33357,d_current_day#33358,... 4 more fields] parquet
                        :                             +- SubqueryAlias `call_center`
                        :                                +- Relation[cc_call_center_sk#33410,cc_call_center_id#33411,cc_rec_start_date#33412,cc_rec_end_date#33413,cc_closed_date_sk#33414,cc_open_date_sk#33415,cc_name#33416,cc_class#33417,cc_employees#33418,cc_sq_ft#33419,cc_hours#33420,cc_manager#33421,cc_mkt_id#33422,cc_mkt_class#33423,cc_mkt_desc#33424,cc_market_manager#33425,cc_division#33426,cc_division_name#33427,cc_company#33428,cc_company_name#33429,cc_street_number#33430,cc_street_name#33431,cc_street_type#33432,cc_suite_number#33433,... 7 more fields] parquet
                        +- SubqueryAlias `v1_lead`
                           +- SubqueryAlias `v1`
                              +- Project [i_category#33741, i_brand#33737, cc_name#33903, d_year#33828, d_moy#33830, sum_sales#33634, avg_monthly_sales#33441, rn#33538]
                                 +- Project [i_category#33741, i_brand#33737, cc_name#33903, d_year#33828, d_moy#33830, sum_sales#33634, _w0#33635, rn#33538, avg_monthly_sales#33441, avg_monthly_sales#33441, rn#33538]
                                    +- Window [avg(_w0#33635) windowspecdefinition(i_category#33741, i_brand#33737, cc_name#33903, d_year#33828, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#33441], [i_category#33741, i_brand#33737, cc_name#33903, d_year#33828]
                                       +- Window [rank(d_year#33828, d_moy#33830) windowspecdefinition(i_category#33741, i_brand#33737, cc_name#33903, d_year#33828 ASC NULLS FIRST, d_moy#33830 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#33538], [i_category#33741, i_brand#33737, cc_name#33903], [d_year#33828 ASC NULLS FIRST, d_moy#33830 ASC NULLS FIRST]
                                          +- Aggregate [i_category#33741, i_brand#33737, cc_name#33903, d_year#33828, d_moy#33830], [i_category#33741, i_brand#33737, cc_name#33903, d_year#33828, d_moy#33830, sum(cs_sales_price#21) AS sum_sales#33634, sum(cs_sales_price#21) AS _w0#33635]
                                             +- Filter (((cs_item_sk#15 = i_item_sk#33729) && (cs_sold_date_sk#0 = d_date_sk#33822)) && ((cc_call_center_sk#33897 = cs_call_center_sk#11) && (((d_year#33828 = 1999) || ((d_year#33828 = (1999 - 1)) && (d_moy#33830 = 12))) || ((d_year#33828 = (1999 + 1)) && (d_moy#33830 = 1)))))
                                                +- Join Inner
                                                   :- Join Inner
                                                   :  :- Join Inner
                                                   :  :  :- SubqueryAlias `item`
                                                   :  :  :  +- Relation[i_item_sk#33729,i_item_id#33730,i_rec_start_date#33731,i_rec_end_date#33732,i_item_desc#33733,i_current_price#33734,i_wholesale_cost#33735,i_brand_id#33736,i_brand#33737,i_class_id#33738,i_class#33739,i_category_id#33740,i_category#33741,i_manufact_id#33742,i_manufact#33743,i_size#33744,i_formulation#33745,i_color#33746,i_units#33747,i_container#33748,i_manager_id#33749,i_product_name#33750] parquet
                                                   :  :  +- SubqueryAlias `catalog_sales`
                                                   :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                                                   :  +- SubqueryAlias `date_dim`
                                                   :     +- Relation[d_date_sk#33822,d_date_id#33823,d_date#33824,d_month_seq#33825,d_week_seq#33826,d_quarter_seq#33827,d_year#33828,d_dow#33829,d_moy#33830,d_dom#33831,d_qoy#33832,d_fy_year#33833,d_fy_quarter_seq#33834,d_fy_week_seq#33835,d_day_name#33836,d_quarter_name#33837,d_holiday#33838,d_weekend#33839,d_following_holiday#33840,d_first_dom#33841,d_last_dom#33842,d_same_day_ly#33843,d_same_day_lq#33844,d_current_day#33845,... 4 more fields] parquet
                                                   +- SubqueryAlias `call_center`
                                                      +- Relation[cc_call_center_sk#33897,cc_call_center_id#33898,cc_rec_start_date#33899,cc_rec_end_date#33900,cc_closed_date_sk#33901,cc_open_date_sk#33902,cc_name#33903,cc_class#33904,cc_employees#33905,cc_sq_ft#33906,cc_hours#33907,cc_manager#33908,cc_mkt_id#33909,cc_mkt_class#33910,cc_mkt_desc#33911,cc_market_manager#33912,cc_division#33913,cc_division_name#33914,cc_company#33915,cc_company_name#33916,cc_street_number#33917,cc_street_name#33918,cc_street_type#33919,cc_suite_number#33920,... 7 more fields] parquet

     : benchmark
19/10/04 04:16:37 INFO Query: 
== Query: q57-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#34033 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#34034 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, cc_name#338 ASC NULLS FIRST], true
      +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, avg_monthly_sales#34034, sum_sales#34033, psum#34036, nsum#34037]
         +- Filter (((d_year#498 = 1999) && (cast(avg_monthly_sales#34034 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6)))) && (cast(CASE WHEN (cast(avg_monthly_sales#34034 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#34033 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#34034 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#34034 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16))))
            +- SubqueryAlias `v2`
               +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, avg_monthly_sales#34034, sum_sales#34033, sum_sales#34245 AS psum#34036, sum_sales#34732 AS nsum#34037]
                  +- Filter ((((i_category#576 = i_category#34352) && (i_category#576 = i_category#34839)) && ((i_brand#572 = i_brand#34348) && (i_brand#572 = i_brand#34835))) && (((cc_name#338 = cc_name#34514) && (cc_name#338 = cc_name#35001)) && ((rn#34035 = (rn#34149 + 1)) && (rn#34035 = (rn#34636 - 1)))))
                     +- Join Inner
                        :- Join Inner
                        :  :- SubqueryAlias `v1`
                        :  :  +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, sum_sales#34033, avg_monthly_sales#34034, rn#34035]
                        :  :     +- Project [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, sum_sales#34033, _w0#34047, rn#34035, avg_monthly_sales#34034, avg_monthly_sales#34034, rn#34035]
                        :  :        +- Window [avg(_w0#34047) windowspecdefinition(i_category#576, i_brand#572, cc_name#338, d_year#498, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#34034], [i_category#576, i_brand#572, cc_name#338, d_year#498]
                        :  :           +- Window [rank(d_year#498, d_moy#500) windowspecdefinition(i_category#576, i_brand#572, cc_name#338, d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#34035], [i_category#576, i_brand#572, cc_name#338], [d_year#498 ASC NULLS FIRST, d_moy#500 ASC NULLS FIRST]
                        :  :              +- Aggregate [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500], [i_category#576, i_brand#572, cc_name#338, d_year#498, d_moy#500, sum(cs_sales_price#21) AS sum_sales#34033, sum(cs_sales_price#21) AS _w0#34047]
                        :  :                 +- Filter (((cs_item_sk#15 = i_item_sk#564) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((cc_call_center_sk#332 = cs_call_center_sk#11) && (((d_year#498 = 1999) || ((d_year#498 = (1999 - 1)) && (d_moy#500 = 12))) || ((d_year#498 = (1999 + 1)) && (d_moy#500 = 1)))))
                        :  :                    +- Join Inner
                        :  :                       :- Join Inner
                        :  :                       :  :- Join Inner
                        :  :                       :  :  :- SubqueryAlias `item`
                        :  :                       :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                        :  :                       :  :  +- SubqueryAlias `catalog_sales`
                        :  :                       :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :                       :  +- SubqueryAlias `date_dim`
                        :  :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :                       +- SubqueryAlias `call_center`
                        :  :                          +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet
                        :  +- SubqueryAlias `v1_lag`
                        :     +- SubqueryAlias `v1`
                        :        +- Project [i_category#34352, i_brand#34348, cc_name#34514, d_year#34439, d_moy#34441, sum_sales#34245, avg_monthly_sales#34052, rn#34149]
                        :           +- Project [i_category#34352, i_brand#34348, cc_name#34514, d_year#34439, d_moy#34441, sum_sales#34245, _w0#34246, rn#34149, avg_monthly_sales#34052, avg_monthly_sales#34052, rn#34149]
                        :              +- Window [avg(_w0#34246) windowspecdefinition(i_category#34352, i_brand#34348, cc_name#34514, d_year#34439, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#34052], [i_category#34352, i_brand#34348, cc_name#34514, d_year#34439]
                        :                 +- Window [rank(d_year#34439, d_moy#34441) windowspecdefinition(i_category#34352, i_brand#34348, cc_name#34514, d_year#34439 ASC NULLS FIRST, d_moy#34441 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#34149], [i_category#34352, i_brand#34348, cc_name#34514], [d_year#34439 ASC NULLS FIRST, d_moy#34441 ASC NULLS FIRST]
                        :                    +- Aggregate [i_category#34352, i_brand#34348, cc_name#34514, d_year#34439, d_moy#34441], [i_category#34352, i_brand#34348, cc_name#34514, d_year#34439, d_moy#34441, sum(cs_sales_price#21) AS sum_sales#34245, sum(cs_sales_price#21) AS _w0#34246]
                        :                       +- Filter (((cs_item_sk#15 = i_item_sk#34340) && (cs_sold_date_sk#0 = d_date_sk#34433)) && ((cc_call_center_sk#34508 = cs_call_center_sk#11) && (((d_year#34439 = 1999) || ((d_year#34439 = (1999 - 1)) && (d_moy#34441 = 12))) || ((d_year#34439 = (1999 + 1)) && (d_moy#34441 = 1)))))
                        :                          +- Join Inner
                        :                             :- Join Inner
                        :                             :  :- Join Inner
                        :                             :  :  :- SubqueryAlias `item`
                        :                             :  :  :  +- Relation[i_item_sk#34340,i_item_id#34341,i_rec_start_date#34342,i_rec_end_date#34343,i_item_desc#34344,i_current_price#34345,i_wholesale_cost#34346,i_brand_id#34347,i_brand#34348,i_class_id#34349,i_class#34350,i_category_id#34351,i_category#34352,i_manufact_id#34353,i_manufact#34354,i_size#34355,i_formulation#34356,i_color#34357,i_units#34358,i_container#34359,i_manager_id#34360,i_product_name#34361] parquet
                        :                             :  :  +- SubqueryAlias `catalog_sales`
                        :                             :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :                             :  +- SubqueryAlias `date_dim`
                        :                             :     +- Relation[d_date_sk#34433,d_date_id#34434,d_date#34435,d_month_seq#34436,d_week_seq#34437,d_quarter_seq#34438,d_year#34439,d_dow#34440,d_moy#34441,d_dom#34442,d_qoy#34443,d_fy_year#34444,d_fy_quarter_seq#34445,d_fy_week_seq#34446,d_day_name#34447,d_quarter_name#34448,d_holiday#34449,d_weekend#34450,d_following_holiday#34451,d_first_dom#34452,d_last_dom#34453,d_same_day_ly#34454,d_same_day_lq#34455,d_current_day#34456,... 4 more fields] parquet
                        :                             +- SubqueryAlias `call_center`
                        :                                +- Relation[cc_call_center_sk#34508,cc_call_center_id#34509,cc_rec_start_date#34510,cc_rec_end_date#34511,cc_closed_date_sk#34512,cc_open_date_sk#34513,cc_name#34514,cc_class#34515,cc_employees#34516,cc_sq_ft#34517,cc_hours#34518,cc_manager#34519,cc_mkt_id#34520,cc_mkt_class#34521,cc_mkt_desc#34522,cc_market_manager#34523,cc_division#34524,cc_division_name#34525,cc_company#34526,cc_company_name#34527,cc_street_number#34528,cc_street_name#34529,cc_street_type#34530,cc_suite_number#34531,... 7 more fields] parquet
                        +- SubqueryAlias `v1_lead`
                           +- SubqueryAlias `v1`
                              +- Project [i_category#34839, i_brand#34835, cc_name#35001, d_year#34926, d_moy#34928, sum_sales#34732, avg_monthly_sales#34539, rn#34636]
                                 +- Project [i_category#34839, i_brand#34835, cc_name#35001, d_year#34926, d_moy#34928, sum_sales#34732, _w0#34733, rn#34636, avg_monthly_sales#34539, avg_monthly_sales#34539, rn#34636]
                                    +- Window [avg(_w0#34733) windowspecdefinition(i_category#34839, i_brand#34835, cc_name#35001, d_year#34926, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#34539], [i_category#34839, i_brand#34835, cc_name#35001, d_year#34926]
                                       +- Window [rank(d_year#34926, d_moy#34928) windowspecdefinition(i_category#34839, i_brand#34835, cc_name#35001, d_year#34926 ASC NULLS FIRST, d_moy#34928 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rn#34636], [i_category#34839, i_brand#34835, cc_name#35001], [d_year#34926 ASC NULLS FIRST, d_moy#34928 ASC NULLS FIRST]
                                          +- Aggregate [i_category#34839, i_brand#34835, cc_name#35001, d_year#34926, d_moy#34928], [i_category#34839, i_brand#34835, cc_name#35001, d_year#34926, d_moy#34928, sum(cs_sales_price#21) AS sum_sales#34732, sum(cs_sales_price#21) AS _w0#34733]
                                             +- Filter (((cs_item_sk#15 = i_item_sk#34827) && (cs_sold_date_sk#0 = d_date_sk#34920)) && ((cc_call_center_sk#34995 = cs_call_center_sk#11) && (((d_year#34926 = 1999) || ((d_year#34926 = (1999 - 1)) && (d_moy#34928 = 12))) || ((d_year#34926 = (1999 + 1)) && (d_moy#34928 = 1)))))
                                                +- Join Inner
                                                   :- Join Inner
                                                   :  :- Join Inner
                                                   :  :  :- SubqueryAlias `item`
                                                   :  :  :  +- Relation[i_item_sk#34827,i_item_id#34828,i_rec_start_date#34829,i_rec_end_date#34830,i_item_desc#34831,i_current_price#34832,i_wholesale_cost#34833,i_brand_id#34834,i_brand#34835,i_class_id#34836,i_class#34837,i_category_id#34838,i_category#34839,i_manufact_id#34840,i_manufact#34841,i_size#34842,i_formulation#34843,i_color#34844,i_units#34845,i_container#34846,i_manager_id#34847,i_product_name#34848] parquet
                                                   :  :  +- SubqueryAlias `catalog_sales`
                                                   :  :     +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                                                   :  +- SubqueryAlias `date_dim`
                                                   :     +- Relation[d_date_sk#34920,d_date_id#34921,d_date#34922,d_month_seq#34923,d_week_seq#34924,d_quarter_seq#34925,d_year#34926,d_dow#34927,d_moy#34928,d_dom#34929,d_qoy#34930,d_fy_year#34931,d_fy_quarter_seq#34932,d_fy_week_seq#34933,d_day_name#34934,d_quarter_name#34935,d_holiday#34936,d_weekend#34937,d_following_holiday#34938,d_first_dom#34939,d_last_dom#34940,d_same_day_ly#34941,d_same_day_lq#34942,d_current_day#34943,... 4 more fields] parquet
                                                   +- SubqueryAlias `call_center`
                                                      +- Relation[cc_call_center_sk#34995,cc_call_center_id#34996,cc_rec_start_date#34997,cc_rec_end_date#34998,cc_closed_date_sk#34999,cc_open_date_sk#35000,cc_name#35001,cc_class#35002,cc_employees#35003,cc_sq_ft#35004,cc_hours#35005,cc_manager#35006,cc_mkt_id#35007,cc_mkt_class#35008,cc_mkt_desc#35009,cc_market_manager#35010,cc_division#35011,cc_division_name#35012,cc_company#35013,cc_company_name#35014,cc_street_number#35015,cc_street_name#35016,cc_street_type#35017,cc_suite_number#35018,... 7 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 108.630061193s
Running execution q58-v2.4 iteration: 1, StandardRun=true
19/10/04 04:18:29 INFO Query: 
== Query: q58-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_id#37390 ASC NULLS FIRST, ss_item_rev#37391 ASC NULLS FIRST], true
      +- Project [item_id#37390, ss_item_rev#37391, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37391 as decimal(19,2))) / promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37391 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37395 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37399 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2)))), DecimalType(38,21)) as decimal(38,21))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(38,21)))), DecimalType(38,21)) as decimal(38,21))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(38,21)))), DecimalType(38,17)) AS ss_dev#37386, cs_item_rev#37395, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_item_rev#37395 as decimal(19,2))) / promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37391 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37395 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37399 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2)))), DecimalType(38,21)) as decimal(38,21))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(38,21)))), DecimalType(38,21)) as decimal(38,21))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(38,21)))), DecimalType(38,17)) AS cs_dev#37387, ws_item_rev#37399, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_item_rev#37399 as decimal(19,2))) / promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37391 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37395 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37399 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2)))), DecimalType(38,21)) as decimal(38,21))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(38,21)))), DecimalType(38,21)) as decimal(38,21))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(38,21)))), DecimalType(38,17)) AS ws_dev#37388, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37391 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37395 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37399 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(19,2)))), DecimalType(23,6)) AS average#37389]
         +- Filter ((((item_id#37390 = item_id#37394) && (item_id#37390 = item_id#37398)) && (((cast(ss_item_rev#37391 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37395 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ss_item_rev#37391 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37395 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))) && ((cast(ss_item_rev#37391 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37399 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ss_item_rev#37391 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37399 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))))) && ((((cast(cs_item_rev#37395 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37391 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(cs_item_rev#37395 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37391 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))) && ((cast(cs_item_rev#37395 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37399 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(cs_item_rev#37395 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37399 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3))))) && (((cast(ws_item_rev#37399 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37391 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ws_item_rev#37399 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37391 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))) && ((cast(ws_item_rev#37399 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37395 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ws_item_rev#37399 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37395 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))))))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ss_items`
               :  :  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#37390, sum(ss_ext_sales_price#145) AS ss_item_rev#37391]
               :  :     +- Filter (((ss_item_sk#132 = i_item_sk#564) && d_date#494 IN (list#37393 [])) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :        :  +- Project [d_date#494]
               :  :        :     +- Filter (d_week_seq#496 = scalar-subquery#37392 [])
               :  :        :        :  +- Project [d_week_seq#496]
               :  :        :        :     +- Filter (d_date#494 = cast(2000-01-03 as date))
               :  :        :        :        +- SubqueryAlias `date_dim`
               :  :        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        :        +- SubqueryAlias `date_dim`
               :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- SubqueryAlias `store_sales`
               :  :           :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  +- SubqueryAlias `item`
               :  :           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- SubqueryAlias `date_dim`
               :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `cs_items`
               :     +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#37394, sum(cs_ext_sales_price#23) AS cs_item_rev#37395]
               :        +- Filter (((cs_item_sk#15 = i_item_sk#564) && d_date#494 IN (list#37397 [])) && (cs_sold_date_sk#0 = d_date_sk#492))
               :           :  +- Project [d_date#494]
               :           :     +- Filter (d_week_seq#496 = scalar-subquery#37396 [])
               :           :        :  +- Project [d_week_seq#496]
               :           :        :     +- Filter (d_date#494 = cast(2000-01-03 as date))
               :           :        :        +- SubqueryAlias `date_dim`
               :           :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Join Inner
               :              :- Join Inner
               :              :  :- SubqueryAlias `catalog_sales`
               :              :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :              :  +- SubqueryAlias `item`
               :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- SubqueryAlias `date_dim`
               :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `ws_items`
                  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#37398, sum(ws_ext_sales_price#239) AS ws_item_rev#37399]
                     +- Filter (((ws_item_sk#219 = i_item_sk#564) && d_date#494 IN (list#37401 [])) && (ws_sold_date_sk#216 = d_date_sk#492))
                        :  +- Project [d_date#494]
                        :     +- Filter (d_week_seq#496 = scalar-subquery#37400 [])
                        :        :  +- Project [d_week_seq#496]
                        :        :     +- Filter (d_date#494 = cast(2000-01-03 as date))
                        :        :        +- SubqueryAlias `date_dim`
                        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `web_sales`
                           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :  +- SubqueryAlias `item`
                           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/04 04:18:29 INFO Query: 
== Query: q58-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_id#37417 ASC NULLS FIRST, ss_item_rev#37418 ASC NULLS FIRST], true
      +- Project [item_id#37417, ss_item_rev#37418, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37418 as decimal(19,2))) / promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37418 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37422 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37426 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2)))), DecimalType(38,21)) as decimal(38,21))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(38,21)))), DecimalType(38,21)) as decimal(38,21))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(38,21)))), DecimalType(38,17)) AS ss_dev#37413, cs_item_rev#37422, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cs_item_rev#37422 as decimal(19,2))) / promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37418 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37422 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37426 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2)))), DecimalType(38,21)) as decimal(38,21))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(38,21)))), DecimalType(38,21)) as decimal(38,21))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(38,21)))), DecimalType(38,17)) AS cs_dev#37414, ws_item_rev#37426, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ws_item_rev#37426 as decimal(19,2))) / promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37418 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37422 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37426 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2)))), DecimalType(38,21)) as decimal(38,21))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(38,21)))), DecimalType(38,21)) as decimal(38,21))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(38,21)))), DecimalType(38,17)) AS ws_dev#37415, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(ss_item_rev#37418 as decimal(18,2))) + promote_precision(cast(cs_item_rev#37422 as decimal(18,2)))), DecimalType(18,2)) as decimal(19,2))) + promote_precision(cast(ws_item_rev#37426 as decimal(19,2)))), DecimalType(19,2)) as decimal(19,2))) / promote_precision(cast(cast(3 as decimal(1,0)) as decimal(19,2)))), DecimalType(23,6)) AS average#37416]
         +- Filter ((((item_id#37417 = item_id#37421) && (item_id#37417 = item_id#37425)) && (((cast(ss_item_rev#37418 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37422 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ss_item_rev#37418 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37422 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))) && ((cast(ss_item_rev#37418 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37426 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ss_item_rev#37418 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37426 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))))) && ((((cast(cs_item_rev#37422 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37418 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(cs_item_rev#37422 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37418 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))) && ((cast(cs_item_rev#37422 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37426 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(cs_item_rev#37422 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ws_item_rev#37426 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3))))) && (((cast(ws_item_rev#37426 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37418 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ws_item_rev#37426 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(ss_item_rev#37418 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))) && ((cast(ws_item_rev#37426 as decimal(19,3)) >= cast(CheckOverflow((promote_precision(cast(0.9 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37422 as decimal(17,2)))), DecimalType(19,3)) as decimal(19,3))) && (cast(ws_item_rev#37426 as decimal(20,3)) <= cast(CheckOverflow((promote_precision(cast(1.1 as decimal(17,2))) * promote_precision(cast(cs_item_rev#37422 as decimal(17,2)))), DecimalType(20,3)) as decimal(20,3)))))))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ss_items`
               :  :  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#37417, sum(ss_ext_sales_price#145) AS ss_item_rev#37418]
               :  :     +- Filter (((ss_item_sk#132 = i_item_sk#564) && d_date#494 IN (list#37420 [])) && (ss_sold_date_sk#130 = d_date_sk#492))
               :  :        :  +- Project [d_date#494]
               :  :        :     +- Filter (d_week_seq#496 = scalar-subquery#37419 [])
               :  :        :        :  +- Project [d_week_seq#496]
               :  :        :        :     +- Filter (d_date#494 = cast(2000-01-03 as date))
               :  :        :        :        +- SubqueryAlias `date_dim`
               :  :        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        :        +- SubqueryAlias `date_dim`
               :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- SubqueryAlias `store_sales`
               :  :           :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  +- SubqueryAlias `item`
               :  :           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- SubqueryAlias `date_dim`
               :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `cs_items`
               :     +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#37421, sum(cs_ext_sales_price#23) AS cs_item_rev#37422]
               :        +- Filter (((cs_item_sk#15 = i_item_sk#564) && d_date#494 IN (list#37424 [])) && (cs_sold_date_sk#0 = d_date_sk#492))
               :           :  +- Project [d_date#494]
               :           :     +- Filter (d_week_seq#496 = scalar-subquery#37423 [])
               :           :        :  +- Project [d_week_seq#496]
               :           :        :     +- Filter (d_date#494 = cast(2000-01-03 as date))
               :           :        :        +- SubqueryAlias `date_dim`
               :           :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Join Inner
               :              :- Join Inner
               :              :  :- SubqueryAlias `catalog_sales`
               :              :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :              :  +- SubqueryAlias `item`
               :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- SubqueryAlias `date_dim`
               :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `ws_items`
                  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#37425, sum(ws_ext_sales_price#239) AS ws_item_rev#37426]
                     +- Filter (((ws_item_sk#219 = i_item_sk#564) && d_date#494 IN (list#37428 [])) && (ws_sold_date_sk#216 = d_date_sk#492))
                        :  +- Project [d_date#494]
                        :     +- Filter (d_week_seq#496 = scalar-subquery#37427 [])
                        :        :  +- Project [d_week_seq#496]
                        :        :     +- Filter (d_date#494 = cast(2000-01-03 as date))
                        :        :        +- SubqueryAlias `date_dim`
                        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `web_sales`
                           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                           :  +- SubqueryAlias `item`
                           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 199.525486909s
Running execution q59-v2.4 iteration: 1, StandardRun=true
19/10/04 04:21:51 INFO Query: 
== Query: q59-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name1#37656 ASC NULLS FIRST, s_store_id1#37658 ASC NULLS FIRST, d_week_seq1#37657 ASC NULLS FIRST], true
      +- Project [s_store_name1#37656, s_store_id1#37658, d_week_seq1#37657, CheckOverflow((promote_precision(cast(sun_sales1#37659 as decimal(17,2))) / promote_precision(cast(sun_sales2#37669 as decimal(17,2)))), DecimalType(37,20)) AS (sun_sales1 / sun_sales2)#37746, CheckOverflow((promote_precision(cast(mon_sales1#37660 as decimal(17,2))) / promote_precision(cast(mon_sales2#37670 as decimal(17,2)))), DecimalType(37,20)) AS (mon_sales1 / mon_sales2)#37747, CheckOverflow((promote_precision(cast(tue_sales1#37661 as decimal(17,2))) / promote_precision(cast(tue_sales2#37671 as decimal(17,2)))), DecimalType(37,20)) AS (tue_sales1 / tue_sales2)#37748, CheckOverflow((promote_precision(cast(wed_sales1#37662 as decimal(17,2))) / promote_precision(cast(wed_sales2#37672 as decimal(17,2)))), DecimalType(37,20)) AS (wed_sales1 / wed_sales2)#37749, CheckOverflow((promote_precision(cast(thu_sales1#37663 as decimal(17,2))) / promote_precision(cast(thu_sales2#37673 as decimal(17,2)))), DecimalType(37,20)) AS (thu_sales1 / thu_sales2)#37750, CheckOverflow((promote_precision(cast(fri_sales1#37664 as decimal(17,2))) / promote_precision(cast(fri_sales2#37674 as decimal(17,2)))), DecimalType(37,20)) AS (fri_sales1 / fri_sales2)#37751, CheckOverflow((promote_precision(cast(sat_sales1#37665 as decimal(17,2))) / promote_precision(cast(sat_sales2#37675 as decimal(17,2)))), DecimalType(37,20)) AS (sat_sales1 / sat_sales2)#37752]
         +- Filter ((s_store_id1#37658 = s_store_id2#37668) && (d_week_seq1#37657 = (d_week_seq2#37667 - 52)))
            +- Join Inner
               :- SubqueryAlias `y`
               :  +- Project [s_store_name#669 AS s_store_name1#37656, d_week_seq#496 AS d_week_seq1#37657, s_store_id#665 AS s_store_id1#37658, sun_sales#37676 AS sun_sales1#37659, mon_sales#37677 AS mon_sales1#37660, tue_sales#37678 AS tue_sales1#37661, wed_sales#37679 AS wed_sales1#37662, thu_sales#37680 AS thu_sales1#37663, fri_sales#37681 AS fri_sales1#37664, sat_sales#37682 AS sat_sales1#37665]
               :     +- Filter (((d_week_seq#37694 = d_week_seq#496) && (ss_store_sk#137 = s_store_sk#664)) && ((d_month_seq#37693 >= 1212) && (d_month_seq#37693 <= (1212 + 11))))
               :        +- Join Inner
               :           :- Join Inner
               :           :  :- SubqueryAlias `wss`
               :           :  :  +- Aggregate [d_week_seq#496, ss_store_sk#137], [d_week_seq#496, ss_store_sk#137, sum(CASE WHEN (d_day_name#506 = Sunday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sun_sales#37676, sum(CASE WHEN (d_day_name#506 = Monday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS mon_sales#37677, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS tue_sales#37678, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS wed_sales#37679, sum(CASE WHEN (d_day_name#506 = Thursday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS thu_sales#37680, sum(CASE WHEN (d_day_name#506 = Friday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS fri_sales#37681, sum(CASE WHEN (d_day_name#506 = Saturday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sat_sales#37682]
               :           :  :     +- Filter (d_date_sk#492 = ss_sold_date_sk#130)
               :           :  :        +- Join Inner
               :           :  :           :- SubqueryAlias `store_sales`
               :           :  :           :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :  :           +- SubqueryAlias `date_dim`
               :           :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :  +- SubqueryAlias `store`
               :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :           +- SubqueryAlias `d`
               :              +- SubqueryAlias `date_dim`
               :                 +- Relation[d_date_sk#37690,d_date_id#37691,d_date#37692,d_month_seq#37693,d_week_seq#37694,d_quarter_seq#37695,d_year#37696,d_dow#37697,d_moy#37698,d_dom#37699,d_qoy#37700,d_fy_year#37701,d_fy_quarter_seq#37702,d_fy_week_seq#37703,d_day_name#37704,d_quarter_name#37705,d_holiday#37706,d_weekend#37707,d_following_holiday#37708,d_first_dom#37709,d_last_dom#37710,d_same_day_ly#37711,d_same_day_lq#37712,d_current_day#37713,... 4 more fields] parquet
               +- SubqueryAlias `x`
                  +- Project [s_store_name#669 AS s_store_name2#37666, d_week_seq#496 AS d_week_seq2#37667, s_store_id#665 AS s_store_id2#37668, sun_sales#37676 AS sun_sales2#37669, mon_sales#37677 AS mon_sales2#37670, tue_sales#37678 AS tue_sales2#37671, wed_sales#37679 AS wed_sales2#37672, thu_sales#37680 AS thu_sales2#37673, fri_sales#37681 AS fri_sales2#37674, sat_sales#37682 AS sat_sales2#37675]
                     +- Filter (((d_week_seq#37722 = d_week_seq#496) && (ss_store_sk#137 = s_store_sk#664)) && ((d_month_seq#37721 >= (1212 + 12)) && (d_month_seq#37721 <= (1212 + 23))))
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `wss`
                           :  :  +- Aggregate [d_week_seq#496, ss_store_sk#137], [d_week_seq#496, ss_store_sk#137, sum(CASE WHEN (d_day_name#506 = Sunday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sun_sales#37676, sum(CASE WHEN (d_day_name#506 = Monday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS mon_sales#37677, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS tue_sales#37678, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS wed_sales#37679, sum(CASE WHEN (d_day_name#506 = Thursday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS thu_sales#37680, sum(CASE WHEN (d_day_name#506 = Friday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS fri_sales#37681, sum(CASE WHEN (d_day_name#506 = Saturday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sat_sales#37682]
                           :  :     +- Filter (d_date_sk#492 = ss_sold_date_sk#130)
                           :  :        +- Join Inner
                           :  :           :- SubqueryAlias `store_sales`
                           :  :           :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :  :           +- SubqueryAlias `date_dim`
                           :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :  +- SubqueryAlias `store`
                           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           +- SubqueryAlias `d`
                              +- SubqueryAlias `date_dim`
                                 +- Relation[d_date_sk#37718,d_date_id#37719,d_date#37720,d_month_seq#37721,d_week_seq#37722,d_quarter_seq#37723,d_year#37724,d_dow#37725,d_moy#37726,d_dom#37727,d_qoy#37728,d_fy_year#37729,d_fy_quarter_seq#37730,d_fy_week_seq#37731,d_day_name#37732,d_quarter_name#37733,d_holiday#37734,d_weekend#37735,d_following_holiday#37736,d_first_dom#37737,d_last_dom#37738,d_same_day_ly#37739,d_same_day_lq#37740,d_current_day#37741,... 4 more fields] parquet

     : benchmark
19/10/04 04:21:51 INFO Query: 
== Query: q59-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name1#37763 ASC NULLS FIRST, s_store_id1#37765 ASC NULLS FIRST, d_week_seq1#37764 ASC NULLS FIRST], true
      +- Project [s_store_name1#37763, s_store_id1#37765, d_week_seq1#37764, CheckOverflow((promote_precision(cast(sun_sales1#37766 as decimal(17,2))) / promote_precision(cast(sun_sales2#37776 as decimal(17,2)))), DecimalType(37,20)) AS (sun_sales1 / sun_sales2)#37853, CheckOverflow((promote_precision(cast(mon_sales1#37767 as decimal(17,2))) / promote_precision(cast(mon_sales2#37777 as decimal(17,2)))), DecimalType(37,20)) AS (mon_sales1 / mon_sales2)#37854, CheckOverflow((promote_precision(cast(tue_sales1#37768 as decimal(17,2))) / promote_precision(cast(tue_sales2#37778 as decimal(17,2)))), DecimalType(37,20)) AS (tue_sales1 / tue_sales2)#37855, CheckOverflow((promote_precision(cast(wed_sales1#37769 as decimal(17,2))) / promote_precision(cast(wed_sales2#37779 as decimal(17,2)))), DecimalType(37,20)) AS (wed_sales1 / wed_sales2)#37856, CheckOverflow((promote_precision(cast(thu_sales1#37770 as decimal(17,2))) / promote_precision(cast(thu_sales2#37780 as decimal(17,2)))), DecimalType(37,20)) AS (thu_sales1 / thu_sales2)#37857, CheckOverflow((promote_precision(cast(fri_sales1#37771 as decimal(17,2))) / promote_precision(cast(fri_sales2#37781 as decimal(17,2)))), DecimalType(37,20)) AS (fri_sales1 / fri_sales2)#37858, CheckOverflow((promote_precision(cast(sat_sales1#37772 as decimal(17,2))) / promote_precision(cast(sat_sales2#37782 as decimal(17,2)))), DecimalType(37,20)) AS (sat_sales1 / sat_sales2)#37859]
         +- Filter ((s_store_id1#37765 = s_store_id2#37775) && (d_week_seq1#37764 = (d_week_seq2#37774 - 52)))
            +- Join Inner
               :- SubqueryAlias `y`
               :  +- Project [s_store_name#669 AS s_store_name1#37763, d_week_seq#496 AS d_week_seq1#37764, s_store_id#665 AS s_store_id1#37765, sun_sales#37783 AS sun_sales1#37766, mon_sales#37784 AS mon_sales1#37767, tue_sales#37785 AS tue_sales1#37768, wed_sales#37786 AS wed_sales1#37769, thu_sales#37787 AS thu_sales1#37770, fri_sales#37788 AS fri_sales1#37771, sat_sales#37789 AS sat_sales1#37772]
               :     +- Filter (((d_week_seq#37801 = d_week_seq#496) && (ss_store_sk#137 = s_store_sk#664)) && ((d_month_seq#37800 >= 1212) && (d_month_seq#37800 <= (1212 + 11))))
               :        +- Join Inner
               :           :- Join Inner
               :           :  :- SubqueryAlias `wss`
               :           :  :  +- Aggregate [d_week_seq#496, ss_store_sk#137], [d_week_seq#496, ss_store_sk#137, sum(CASE WHEN (d_day_name#506 = Sunday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sun_sales#37783, sum(CASE WHEN (d_day_name#506 = Monday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS mon_sales#37784, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS tue_sales#37785, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS wed_sales#37786, sum(CASE WHEN (d_day_name#506 = Thursday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS thu_sales#37787, sum(CASE WHEN (d_day_name#506 = Friday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS fri_sales#37788, sum(CASE WHEN (d_day_name#506 = Saturday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sat_sales#37789]
               :           :  :     +- Filter (d_date_sk#492 = ss_sold_date_sk#130)
               :           :  :        +- Join Inner
               :           :  :           :- SubqueryAlias `store_sales`
               :           :  :           :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :  :           +- SubqueryAlias `date_dim`
               :           :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :  +- SubqueryAlias `store`
               :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :           +- SubqueryAlias `d`
               :              +- SubqueryAlias `date_dim`
               :                 +- Relation[d_date_sk#37797,d_date_id#37798,d_date#37799,d_month_seq#37800,d_week_seq#37801,d_quarter_seq#37802,d_year#37803,d_dow#37804,d_moy#37805,d_dom#37806,d_qoy#37807,d_fy_year#37808,d_fy_quarter_seq#37809,d_fy_week_seq#37810,d_day_name#37811,d_quarter_name#37812,d_holiday#37813,d_weekend#37814,d_following_holiday#37815,d_first_dom#37816,d_last_dom#37817,d_same_day_ly#37818,d_same_day_lq#37819,d_current_day#37820,... 4 more fields] parquet
               +- SubqueryAlias `x`
                  +- Project [s_store_name#669 AS s_store_name2#37773, d_week_seq#496 AS d_week_seq2#37774, s_store_id#665 AS s_store_id2#37775, sun_sales#37783 AS sun_sales2#37776, mon_sales#37784 AS mon_sales2#37777, tue_sales#37785 AS tue_sales2#37778, wed_sales#37786 AS wed_sales2#37779, thu_sales#37787 AS thu_sales2#37780, fri_sales#37788 AS fri_sales2#37781, sat_sales#37789 AS sat_sales2#37782]
                     +- Filter (((d_week_seq#37829 = d_week_seq#496) && (ss_store_sk#137 = s_store_sk#664)) && ((d_month_seq#37828 >= (1212 + 12)) && (d_month_seq#37828 <= (1212 + 23))))
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `wss`
                           :  :  +- Aggregate [d_week_seq#496, ss_store_sk#137], [d_week_seq#496, ss_store_sk#137, sum(CASE WHEN (d_day_name#506 = Sunday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sun_sales#37783, sum(CASE WHEN (d_day_name#506 = Monday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS mon_sales#37784, sum(CASE WHEN (d_day_name#506 = Tuesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS tue_sales#37785, sum(CASE WHEN (d_day_name#506 = Wednesday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS wed_sales#37786, sum(CASE WHEN (d_day_name#506 = Thursday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS thu_sales#37787, sum(CASE WHEN (d_day_name#506 = Friday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS fri_sales#37788, sum(CASE WHEN (d_day_name#506 = Saturday) THEN ss_sales_price#143 ELSE cast(null as decimal(7,2)) END) AS sat_sales#37789]
                           :  :     +- Filter (d_date_sk#492 = ss_sold_date_sk#130)
                           :  :        +- Join Inner
                           :  :           :- SubqueryAlias `store_sales`
                           :  :           :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :  :           +- SubqueryAlias `date_dim`
                           :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :  +- SubqueryAlias `store`
                           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           +- SubqueryAlias `d`
                              +- SubqueryAlias `date_dim`
                                 +- Relation[d_date_sk#37825,d_date_id#37826,d_date#37827,d_month_seq#37828,d_week_seq#37829,d_quarter_seq#37830,d_year#37831,d_dow#37832,d_moy#37833,d_dom#37834,d_qoy#37835,d_fy_year#37836,d_fy_quarter_seq#37837,d_fy_week_seq#37838,d_day_name#37839,d_quarter_name#37840,d_holiday#37841,d_weekend#37842,d_following_holiday#37843,d_first_dom#37844,d_last_dom#37845,d_same_day_ly#37846,d_same_day_lq#37847,d_current_day#37848,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 197.66409160799998s
Running execution q60-v2.4 iteration: 1, StandardRun=true
19/10/04 04:25:12 INFO Query: 
== Query: q60-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST, total_sales#38156 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565], [i_item_id#565, sum(total_sales#38157) AS total_sales#38156]
         +- SubqueryAlias `tmp1`
            +- Union
               :- Union
               :  :- Project [i_item_id#565, total_sales#38157]
               :  :  +- SubqueryAlias `ss`
               :  :     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ss_ext_sales_price#145) AS total_sales#38157]
               :  :        +- Filter (((i_item_id#565 IN (list#38158 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 9) && (ss_addr_sk#136 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :  :           :  +- Project [i_item_id#565]
               :  :           :     +- Filter i_category#576 IN (Music)
               :  :           :        +- SubqueryAlias `item`
               :  :           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- Join Inner
               :  :              :  :  :- SubqueryAlias `store_sales`
               :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :              :  :  +- SubqueryAlias `date_dim`
               :  :              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              :  +- SubqueryAlias `customer_address`
               :  :              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  :              +- SubqueryAlias `item`
               :  :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- Project [i_item_id#565, total_sales#38159]
               :     +- SubqueryAlias `cs`
               :        +- Aggregate [i_item_id#565], [i_item_id#565, sum(cs_ext_sales_price#23) AS total_sales#38159]
               :           +- Filter (((i_item_id#565 IN (list#38160 []) && (cs_item_sk#15 = i_item_sk#564)) && ((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 9) && (cs_bill_addr_sk#6 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :              :  +- Project [i_item_id#565]
               :              :     +- Filter i_category#576 IN (Music)
               :              :        +- SubqueryAlias `item`
               :              :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- Join Inner
               :                 :  :  :- SubqueryAlias `catalog_sales`
               :                 :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :  :  +- SubqueryAlias `date_dim`
               :                 :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :  +- SubqueryAlias `customer_address`
               :                 :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :                 +- SubqueryAlias `item`
               :                    +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Project [i_item_id#565, total_sales#38161]
                  +- SubqueryAlias `ws`
                     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ws_ext_sales_price#239) AS total_sales#38161]
                        +- Filter (((i_item_id#565 IN (list#38162 []) && (ws_item_sk#219 = i_item_sk#564)) && ((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 9) && (ws_bill_addr_sk#223 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
                           :  +- Project [i_item_id#565]
                           :     +- Filter i_category#576 IN (Music)
                           :        +- SubqueryAlias `item`
                           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `web_sales`
                              :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :  +- SubqueryAlias `date_dim`
                              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `customer_address`
                              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/04 04:25:12 INFO Query: 
== Query: q60-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST, total_sales#38171 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565], [i_item_id#565, sum(total_sales#38172) AS total_sales#38171]
         +- SubqueryAlias `tmp1`
            +- Union
               :- Union
               :  :- Project [i_item_id#565, total_sales#38172]
               :  :  +- SubqueryAlias `ss`
               :  :     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ss_ext_sales_price#145) AS total_sales#38172]
               :  :        +- Filter (((i_item_id#565 IN (list#38173 []) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_sold_date_sk#130 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 9) && (ss_addr_sk#136 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :  :           :  +- Project [i_item_id#565]
               :  :           :     +- Filter i_category#576 IN (Music)
               :  :           :        +- SubqueryAlias `item`
               :  :           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- Join Inner
               :  :              :  :  :- SubqueryAlias `store_sales`
               :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :              :  :  +- SubqueryAlias `date_dim`
               :  :              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              :  +- SubqueryAlias `customer_address`
               :  :              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  :              +- SubqueryAlias `item`
               :  :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- Project [i_item_id#565, total_sales#38174]
               :     +- SubqueryAlias `cs`
               :        +- Aggregate [i_item_id#565], [i_item_id#565, sum(cs_ext_sales_price#23) AS total_sales#38174]
               :           +- Filter (((i_item_id#565 IN (list#38175 []) && (cs_item_sk#15 = i_item_sk#564)) && ((cs_sold_date_sk#0 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 9) && (cs_bill_addr_sk#6 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
               :              :  +- Project [i_item_id#565]
               :              :     +- Filter i_category#576 IN (Music)
               :              :        +- SubqueryAlias `item`
               :              :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- Join Inner
               :                 :- Join Inner
               :                 :  :- Join Inner
               :                 :  :  :- SubqueryAlias `catalog_sales`
               :                 :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :  :  +- SubqueryAlias `date_dim`
               :                 :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :  +- SubqueryAlias `customer_address`
               :                 :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :                 +- SubqueryAlias `item`
               :                    +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               +- Project [i_item_id#565, total_sales#38176]
                  +- SubqueryAlias `ws`
                     +- Aggregate [i_item_id#565], [i_item_id#565, sum(ws_ext_sales_price#239) AS total_sales#38176]
                        +- Filter (((i_item_id#565 IN (list#38177 []) && (ws_item_sk#219 = i_item_sk#564)) && ((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 1998))) && (((d_moy#500 = 9) && (ws_bill_addr_sk#223 = ca_address_sk#448)) && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))))
                           :  +- Project [i_item_id#565]
                           :     +- Filter i_category#576 IN (Music)
                           :        +- SubqueryAlias `item`
                           :           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- Join Inner
                              :  :  :- SubqueryAlias `web_sales`
                              :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  :  +- SubqueryAlias `date_dim`
                              :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :  +- SubqueryAlias `customer_address`
                              :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 230.43913448400002s
Running execution q61-v2.4 iteration: 1, StandardRun=true
19/10/04 04:29:05 INFO Query: 
== Query: q61-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [promotions#38245 ASC NULLS FIRST, total#38246 ASC NULLS FIRST], true
      +- Project [promotions#38245, total#38246, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(promotions#38245 as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(total#38246 as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) as decimal(35,20))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(35,20)))), DecimalType(38,19)) AS (CAST((CAST(CAST(promotions AS DECIMAL(15,4)) AS DECIMAL(15,4)) / CAST(CAST(total AS DECIMAL(15,4)) AS DECIMAL(15,4))) AS DECIMAL(35,20)) * CAST(CAST(100 AS DECIMAL(3,0)) AS DECIMAL(35,20)))#38249]
         +- Join Cross
            :- SubqueryAlias `promotional_sales`
            :  +- Aggregate [sum(ss_ext_sales_price#145) AS promotions#38245]
            :     +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_promo_sk#138 = p_promo_sk#608)) && (((ss_customer_sk#133 = c_customer_sk#412) && (ca_address_sk#448 = c_current_addr_sk#416)) && (ss_item_sk#132 = i_item_sk#564))) && ((((cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (i_category#576 = Jewelry)) && (((p_channel_dmail#616 = Y) || (p_channel_email#617 = Y)) || (p_channel_tv#619 = Y))) && (((cast(s_gmt_offset#691 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (d_year#498 = 1998)) && (d_moy#500 = 11))))
            :        +- Join Inner
            :           :- Join Inner
            :           :  :- Join Inner
            :           :  :  :- Join Inner
            :           :  :  :  :- Join Inner
            :           :  :  :  :  :- Join Inner
            :           :  :  :  :  :  :- SubqueryAlias `store_sales`
            :           :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :           :  :  :  :  :  +- SubqueryAlias `store`
            :           :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
            :           :  :  :  :  +- SubqueryAlias `promotion`
            :           :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
            :           :  :  :  +- SubqueryAlias `date_dim`
            :           :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :           :  :  +- SubqueryAlias `customer`
            :           :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :           :  +- SubqueryAlias `customer_address`
            :           :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            :           +- SubqueryAlias `item`
            :              +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            +- SubqueryAlias `all_sales`
               +- Aggregate [sum(ss_ext_sales_price#145) AS total#38246]
                  +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_customer_sk#133 = c_customer_sk#412)) && ((ca_address_sk#448 = c_current_addr_sk#416) && (ss_item_sk#132 = i_item_sk#564))) && ((((cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (i_category#576 = Jewelry)) && (cast(s_gmt_offset#691 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))) && ((d_year#498 = 1998) && (d_moy#500 = 11))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  +- SubqueryAlias `date_dim`
                        :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  +- SubqueryAlias `customer`
                        :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  +- SubqueryAlias `customer_address`
                        :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/04 04:29:06 INFO Query: 
== Query: q61-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [promotions#38253 ASC NULLS FIRST, total#38254 ASC NULLS FIRST], true
      +- Project [promotions#38253, total#38254, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cast(promotions#38253 as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(total#38254 as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) as decimal(35,20))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(35,20)))), DecimalType(38,19)) AS (CAST((CAST(CAST(promotions AS DECIMAL(15,4)) AS DECIMAL(15,4)) / CAST(CAST(total AS DECIMAL(15,4)) AS DECIMAL(15,4))) AS DECIMAL(35,20)) * CAST(CAST(100 AS DECIMAL(3,0)) AS DECIMAL(35,20)))#38257]
         +- Join Cross
            :- SubqueryAlias `promotional_sales`
            :  +- Aggregate [sum(ss_ext_sales_price#145) AS promotions#38253]
            :     +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_promo_sk#138 = p_promo_sk#608)) && (((ss_customer_sk#133 = c_customer_sk#412) && (ca_address_sk#448 = c_current_addr_sk#416)) && (ss_item_sk#132 = i_item_sk#564))) && ((((cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (i_category#576 = Jewelry)) && (((p_channel_dmail#616 = Y) || (p_channel_email#617 = Y)) || (p_channel_tv#619 = Y))) && (((cast(s_gmt_offset#691 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (d_year#498 = 1998)) && (d_moy#500 = 11))))
            :        +- Join Inner
            :           :- Join Inner
            :           :  :- Join Inner
            :           :  :  :- Join Inner
            :           :  :  :  :- Join Inner
            :           :  :  :  :  :- Join Inner
            :           :  :  :  :  :  :- SubqueryAlias `store_sales`
            :           :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :           :  :  :  :  :  +- SubqueryAlias `store`
            :           :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
            :           :  :  :  :  +- SubqueryAlias `promotion`
            :           :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
            :           :  :  :  +- SubqueryAlias `date_dim`
            :           :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :           :  :  +- SubqueryAlias `customer`
            :           :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :           :  +- SubqueryAlias `customer_address`
            :           :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            :           +- SubqueryAlias `item`
            :              +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            +- SubqueryAlias `all_sales`
               +- Aggregate [sum(ss_ext_sales_price#145) AS total#38254]
                  +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_customer_sk#133 = c_customer_sk#412)) && ((ca_address_sk#448 = c_current_addr_sk#416) && (ss_item_sk#132 = i_item_sk#564))) && ((((cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2))) && (i_category#576 = Jewelry)) && (cast(s_gmt_offset#691 as decimal(5,2)) = cast(cast(-5 as decimal(1,0)) as decimal(5,2)))) && ((d_year#498 = 1998) && (d_moy#500 = 11))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  +- SubqueryAlias `date_dim`
                        :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  +- SubqueryAlias `customer`
                        :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  +- SubqueryAlias `customer_address`
                        :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 276.058412384s
Running execution q62-v2.4 iteration: 1, StandardRun=true
19/10/04 04:33:44 INFO Query: 
== Query: q62-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [substring(w_warehouse_name, 1, 20)#38327, sm_type#654, web_name#802, 30 days#38317L, 31-60 days#38318L, 61-90 days#38319L, 91-120 days#38320L, >120 days#38321L]
      +- Sort [substring(w_warehouse_name, 1, 20)#38327 ASC NULLS FIRST, sm_type#654 ASC NULLS FIRST, web_name#802 ASC NULLS FIRST], true
         +- Aggregate [substring(w_warehouse_name#744, 1, 20), sm_type#654, web_name#802], [substring(w_warehouse_name#744, 1, 20) AS substring(w_warehouse_name, 1, 20)#38327, sm_type#654, web_name#802, sum(cast(CASE WHEN ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days#38317L, sum(cast(CASE WHEN (((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 30) && ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31-60 days#38318L, sum(cast(CASE WHEN (((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 60) && ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61-90 days#38319L, sum(cast(CASE WHEN (((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 90) && ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91-120 days#38320L, sum(cast(CASE WHEN ((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days#38321L]
            +- Filter (((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (ws_ship_date_sk#218 = d_date_sk#492)) && (ws_warehouse_sk#231 = w_warehouse_sk#742)) && ((ws_ship_mode_sk#230 = sm_ship_mode_sk#652) && (ws_web_site_sk#229 = web_site_sk#798)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `web_sales`
                  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `warehouse`
                  :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :  :  +- SubqueryAlias `ship_mode`
                  :  :     +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet
                  :  +- SubqueryAlias `web_site`
                  :     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/04 04:33:44 INFO Query: 
== Query: q62-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [substring(w_warehouse_name, 1, 20)#38349, sm_type#654, web_name#802, 30 days#38339L, 31-60 days#38340L, 61-90 days#38341L, 91-120 days#38342L, >120 days#38343L]
      +- Sort [substring(w_warehouse_name, 1, 20)#38349 ASC NULLS FIRST, sm_type#654 ASC NULLS FIRST, web_name#802 ASC NULLS FIRST], true
         +- Aggregate [substring(w_warehouse_name#744, 1, 20), sm_type#654, web_name#802], [substring(w_warehouse_name#744, 1, 20) AS substring(w_warehouse_name, 1, 20)#38349, sm_type#654, web_name#802, sum(cast(CASE WHEN ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days#38339L, sum(cast(CASE WHEN (((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 30) && ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31-60 days#38340L, sum(cast(CASE WHEN (((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 60) && ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61-90 days#38341L, sum(cast(CASE WHEN (((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 90) && ((ws_ship_date_sk#218 - ws_sold_date_sk#216) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91-120 days#38342L, sum(cast(CASE WHEN ((ws_ship_date_sk#218 - ws_sold_date_sk#216) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days#38343L]
            +- Filter (((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (ws_ship_date_sk#218 = d_date_sk#492)) && (ws_warehouse_sk#231 = w_warehouse_sk#742)) && ((ws_ship_mode_sk#230 = sm_ship_mode_sk#652) && (ws_web_site_sk#229 = web_site_sk#798)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `web_sales`
                  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `warehouse`
                  :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :  :  +- SubqueryAlias `ship_mode`
                  :  :     +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet
                  :  +- SubqueryAlias `web_site`
                  :     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 41.036112146s
Running execution q63-v2.4 iteration: 1, StandardRun=true
19/10/04 04:34:26 INFO Query: 
== Query: q63-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_manager_id#584 ASC NULLS FIRST, avg_monthly_sales#38429 ASC NULLS FIRST, sum_sales#38428 ASC NULLS FIRST], true
      +- Project [i_manager_id#584, sum_sales#38428, avg_monthly_sales#38429]
         +- Filter (cast(CASE WHEN (cast(avg_monthly_sales#38429 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#38428 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#38429 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#38429 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16)))
            +- SubqueryAlias `tmp1`
               +- Project [i_manager_id#584, sum_sales#38428, avg_monthly_sales#38429]
                  +- Project [i_manager_id#584, sum_sales#38428, _w0#38433, avg_monthly_sales#38429, avg_monthly_sales#38429]
                     +- Window [avg(_w0#38433) windowspecdefinition(i_manager_id#584, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#38429], [i_manager_id#584]
                        +- Aggregate [i_manager_id#584, d_moy#500], [i_manager_id#584, sum(ss_sales_price#143) AS sum_sales#38428, sum(ss_sales_price#143) AS _w0#38433]
                           +- Filter ((((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_store_sk#137 = s_store_sk#664)) && (d_month_seq#495 IN (1200,(1200 + 1),(1200 + 2),(1200 + 3),(1200 + 4),(1200 + 5),(1200 + 6),(1200 + 7),(1200 + 8),(1200 + 9),(1200 + 10),(1200 + 11)) && (((i_category#576 IN (Books,Children,Electronics) && i_class#574 IN (personal,portable,reference,self-help)) && i_brand#572 IN (scholaramalgamalg #14,scholaramalgamalg #7,exportiunivamalg #9,scholaramalgamalg #9)) || ((i_category#576 IN (Women,Music,Men) && i_class#574 IN (accessories,classical,fragrances,pants)) && i_brand#572 IN (amalgimporto #1,edu packscholar #1,exportiimporto #1,importoamalg #1)))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `item`
                                 :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :  :  +- SubqueryAlias `store_sales`
                                 :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `date_dim`
                                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- SubqueryAlias `store`
                                    +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/10/04 04:34:26 INFO Query: 
== Query: q63-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_manager_id#584 ASC NULLS FIRST, avg_monthly_sales#38438 ASC NULLS FIRST, sum_sales#38437 ASC NULLS FIRST], true
      +- Project [i_manager_id#584, sum_sales#38437, avg_monthly_sales#38438]
         +- Filter (cast(CASE WHEN (cast(avg_monthly_sales#38438 as decimal(21,6)) > cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#38437 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#38438 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#38438 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16)))
            +- SubqueryAlias `tmp1`
               +- Project [i_manager_id#584, sum_sales#38437, avg_monthly_sales#38438]
                  +- Project [i_manager_id#584, sum_sales#38437, _w0#38442, avg_monthly_sales#38438, avg_monthly_sales#38438]
                     +- Window [avg(_w0#38442) windowspecdefinition(i_manager_id#584, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#38438], [i_manager_id#584]
                        +- Aggregate [i_manager_id#584, d_moy#500], [i_manager_id#584, sum(ss_sales_price#143) AS sum_sales#38437, sum(ss_sales_price#143) AS _w0#38442]
                           +- Filter ((((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_store_sk#137 = s_store_sk#664)) && (d_month_seq#495 IN (1200,(1200 + 1),(1200 + 2),(1200 + 3),(1200 + 4),(1200 + 5),(1200 + 6),(1200 + 7),(1200 + 8),(1200 + 9),(1200 + 10),(1200 + 11)) && (((i_category#576 IN (Books,Children,Electronics) && i_class#574 IN (personal,portable,reference,self-help)) && i_brand#572 IN (scholaramalgamalg #14,scholaramalgamalg #7,exportiunivamalg #9,scholaramalgamalg #9)) || ((i_category#576 IN (Women,Music,Men) && i_class#574 IN (accessories,classical,fragrances,pants)) && i_brand#572 IN (amalgimporto #1,edu packscholar #1,exportiimporto #1,importoamalg #1)))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `item`
                                 :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :  :  +- SubqueryAlias `store_sales`
                                 :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `date_dim`
                                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- SubqueryAlias `store`
                                    +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 101.984330817s
Running execution q64-v2.4 iteration: 1, StandardRun=true
19/10/04 04:36:14 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#38671 ASC NULLS FIRST, store_name#38673 ASC NULLS FIRST, cnt#38808L ASC NULLS FIRST], true
+- Project [product_name#38671, store_name#38673, store_zip#38674, b_street_number#38675, b_streen_name#38676, b_city#38677, b_zip#38678, c_street_number#38679, c_street_name#38680, c_city#38681, c_zip#38682, syear#38683, cnt#38686L, s1#38687, s2#38688, s3#38689, s1#38809, s2#38810, s3#38811, syear#38805, cnt#38808L]
   +- Filter ((((item_sk#38672 = item_sk#38794) && (syear#38683 = 1999)) && (syear#38805 = (1999 + 1))) && (((cnt#38808L <= cnt#38686L) && (store_name#38673 = store_name#38795)) && (store_zip#38674 = store_zip#38796)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#38771, ca_street_name#38772, ca_city#38775, ca_zip#38778, d_year#498, d_year#38705, d_year#38733], [i_product_name#585 AS product_name#38671, i_item_sk#564 AS item_sk#38672, s_store_name#669 AS store_name#38673, s_zip#689 AS store_zip#38674, ca_street_number#450 AS b_street_number#38675, ca_street_name#451 AS b_streen_name#38676, ca_city#454 AS b_city#38677, ca_zip#457 AS b_zip#38678, ca_street_number#38771 AS c_street_number#38679, ca_street_name#38772 AS c_street_name#38680, ca_city#38775 AS c_city#38681, ca_zip#38778 AS c_zip#38682, d_year#498 AS syear#38683, d_year#38705 AS fsyear#38684, d_year#38733 AS s2year#38685, count(1) AS cnt#38686L, sum(ss_wholesale_cost#141) AS s1#38687, sum(ss_list_price#142) AS s2#38688, sum(ss_coupon_amt#149) AS s3#38689]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#38755)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#38764) && (c_current_addr_sk#416 = ca_address_sk#38769)) && (c_first_sales_date_sk#418 = d_date_sk#38699)) && (((c_first_shipto_date_sk#417 = d_date_sk#38727) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#38765 = ib_income_band_sk#38782) && NOT (cd_marital_status#476 = cd_marital_status#38757)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#38669, refund#38670]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#38695 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#38696 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#38669, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#38670, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#38695, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#38696]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#38699,d_date_id#38700,d_date#38701,d_month_seq#38702,d_week_seq#38703,d_quarter_seq#38704,d_year#38705,d_dow#38706,d_moy#38707,d_dom#38708,d_qoy#38709,d_fy_year#38710,d_fy_quarter_seq#38711,d_fy_week_seq#38712,d_day_name#38713,d_quarter_name#38714,d_holiday#38715,d_weekend#38716,d_following_holiday#38717,d_first_dom#38718,d_last_dom#38719,d_same_day_ly#38720,d_same_day_lq#38721,d_current_day#38722,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#38727,d_date_id#38728,d_date#38729,d_month_seq#38730,d_week_seq#38731,d_quarter_seq#38732,d_year#38733,d_dow#38734,d_moy#38735,d_dom#38736,d_qoy#38737,d_fy_year#38738,d_fy_quarter_seq#38739,d_fy_week_seq#38740,d_day_name#38741,d_quarter_name#38742,d_holiday#38743,d_weekend#38744,d_following_holiday#38745,d_first_dom#38746,d_last_dom#38747,d_same_day_ly#38748,d_same_day_lq#38749,d_current_day#38750,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#38755,cd_gender#38756,cd_marital_status#38757,cd_education_status#38758,cd_purchase_estimate#38759,cd_credit_rating#38760,cd_dep_count#38761,cd_dep_employed_count#38762,cd_dep_college_count#38763] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#38764,hd_income_band_sk#38765,hd_buy_potential#38766,hd_dep_count#38767,hd_vehicle_count#38768] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#38769,ca_address_id#38770,ca_street_number#38771,ca_street_name#38772,ca_street_type#38773,ca_suite_number#38774,ca_city#38775,ca_county#38776,ca_state#38777,ca_zip#38778,ca_country#38779,ca_gmt_offset#38780,ca_location_type#38781] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#38782,ib_lower_bound#38783,ib_upper_bound#38784] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#38771, ca_street_name#38772, ca_city#38775, ca_zip#38778, d_year#498, d_year#38705, d_year#38733], [i_product_name#585 AS product_name#38793, i_item_sk#564 AS item_sk#38794, s_store_name#669 AS store_name#38795, s_zip#689 AS store_zip#38796, ca_street_number#450 AS b_street_number#38797, ca_street_name#451 AS b_streen_name#38798, ca_city#454 AS b_city#38799, ca_zip#457 AS b_zip#38800, ca_street_number#38771 AS c_street_number#38801, ca_street_name#38772 AS c_street_name#38802, ca_city#38775 AS c_city#38803, ca_zip#38778 AS c_zip#38804, d_year#498 AS syear#38805, d_year#38705 AS fsyear#38806, d_year#38733 AS s2year#38807, count(1) AS cnt#38808L, sum(ss_wholesale_cost#141) AS s1#38809, sum(ss_list_price#142) AS s2#38810, sum(ss_coupon_amt#149) AS s3#38811]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#38755)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#38764) && (c_current_addr_sk#416 = ca_address_sk#38769)) && (c_first_sales_date_sk#418 = d_date_sk#38699)) && (((c_first_shipto_date_sk#417 = d_date_sk#38727) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#38765 = ib_income_band_sk#38782) && NOT (cd_marital_status#476 = cd_marital_status#38757)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#38669, refund#38670]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#38695 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#38696 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#38669, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#38670, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#38695, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#38696]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#38699,d_date_id#38700,d_date#38701,d_month_seq#38702,d_week_seq#38703,d_quarter_seq#38704,d_year#38705,d_dow#38706,d_moy#38707,d_dom#38708,d_qoy#38709,d_fy_year#38710,d_fy_quarter_seq#38711,d_fy_week_seq#38712,d_day_name#38713,d_quarter_name#38714,d_holiday#38715,d_weekend#38716,d_following_holiday#38717,d_first_dom#38718,d_last_dom#38719,d_same_day_ly#38720,d_same_day_lq#38721,d_current_day#38722,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#38727,d_date_id#38728,d_date#38729,d_month_seq#38730,d_week_seq#38731,d_quarter_seq#38732,d_year#38733,d_dow#38734,d_moy#38735,d_dom#38736,d_qoy#38737,d_fy_year#38738,d_fy_quarter_seq#38739,d_fy_week_seq#38740,d_day_name#38741,d_quarter_name#38742,d_holiday#38743,d_weekend#38744,d_following_holiday#38745,d_first_dom#38746,d_last_dom#38747,d_same_day_ly#38748,d_same_day_lq#38749,d_current_day#38750,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#38755,cd_gender#38756,cd_marital_status#38757,cd_education_status#38758,cd_purchase_estimate#38759,cd_credit_rating#38760,cd_dep_count#38761,cd_dep_employed_count#38762,cd_dep_college_count#38763] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#38764,hd_income_band_sk#38765,hd_buy_potential#38766,hd_dep_count#38767,hd_vehicle_count#38768] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#38769,ca_address_id#38770,ca_street_number#38771,ca_street_name#38772,ca_street_type#38773,ca_suite_number#38774,ca_city#38775,ca_county#38776,ca_state#38777,ca_zip#38778,ca_country#38779,ca_gmt_offset#38780,ca_location_type#38781] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#38782,ib_lower_bound#38783,ib_upper_bound#38784] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/04 04:36:14 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#38839 ASC NULLS FIRST, store_name#38841 ASC NULLS FIRST, cnt#38976L ASC NULLS FIRST], true
+- Project [product_name#38839, store_name#38841, store_zip#38842, b_street_number#38843, b_streen_name#38844, b_city#38845, b_zip#38846, c_street_number#38847, c_street_name#38848, c_city#38849, c_zip#38850, syear#38851, cnt#38854L, s1#38855, s2#38856, s3#38857, s1#38977, s2#38978, s3#38979, syear#38973, cnt#38976L]
   +- Filter ((((item_sk#38840 = item_sk#38962) && (syear#38851 = 1999)) && (syear#38973 = (1999 + 1))) && (((cnt#38976L <= cnt#38854L) && (store_name#38841 = store_name#38963)) && (store_zip#38842 = store_zip#38964)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#38939, ca_street_name#38940, ca_city#38943, ca_zip#38946, d_year#498, d_year#38873, d_year#38901], [i_product_name#585 AS product_name#38839, i_item_sk#564 AS item_sk#38840, s_store_name#669 AS store_name#38841, s_zip#689 AS store_zip#38842, ca_street_number#450 AS b_street_number#38843, ca_street_name#451 AS b_streen_name#38844, ca_city#454 AS b_city#38845, ca_zip#457 AS b_zip#38846, ca_street_number#38939 AS c_street_number#38847, ca_street_name#38940 AS c_street_name#38848, ca_city#38943 AS c_city#38849, ca_zip#38946 AS c_zip#38850, d_year#498 AS syear#38851, d_year#38873 AS fsyear#38852, d_year#38901 AS s2year#38853, count(1) AS cnt#38854L, sum(ss_wholesale_cost#141) AS s1#38855, sum(ss_list_price#142) AS s2#38856, sum(ss_coupon_amt#149) AS s3#38857]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#38923)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#38932) && (c_current_addr_sk#416 = ca_address_sk#38937)) && (c_first_sales_date_sk#418 = d_date_sk#38867)) && (((c_first_shipto_date_sk#417 = d_date_sk#38895) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#38933 = ib_income_band_sk#38950) && NOT (cd_marital_status#476 = cd_marital_status#38925)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#38837, refund#38838]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#38863 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#38864 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#38837, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#38838, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#38863, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#38864]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#38867,d_date_id#38868,d_date#38869,d_month_seq#38870,d_week_seq#38871,d_quarter_seq#38872,d_year#38873,d_dow#38874,d_moy#38875,d_dom#38876,d_qoy#38877,d_fy_year#38878,d_fy_quarter_seq#38879,d_fy_week_seq#38880,d_day_name#38881,d_quarter_name#38882,d_holiday#38883,d_weekend#38884,d_following_holiday#38885,d_first_dom#38886,d_last_dom#38887,d_same_day_ly#38888,d_same_day_lq#38889,d_current_day#38890,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#38895,d_date_id#38896,d_date#38897,d_month_seq#38898,d_week_seq#38899,d_quarter_seq#38900,d_year#38901,d_dow#38902,d_moy#38903,d_dom#38904,d_qoy#38905,d_fy_year#38906,d_fy_quarter_seq#38907,d_fy_week_seq#38908,d_day_name#38909,d_quarter_name#38910,d_holiday#38911,d_weekend#38912,d_following_holiday#38913,d_first_dom#38914,d_last_dom#38915,d_same_day_ly#38916,d_same_day_lq#38917,d_current_day#38918,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#38923,cd_gender#38924,cd_marital_status#38925,cd_education_status#38926,cd_purchase_estimate#38927,cd_credit_rating#38928,cd_dep_count#38929,cd_dep_employed_count#38930,cd_dep_college_count#38931] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#38932,hd_income_band_sk#38933,hd_buy_potential#38934,hd_dep_count#38935,hd_vehicle_count#38936] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#38937,ca_address_id#38938,ca_street_number#38939,ca_street_name#38940,ca_street_type#38941,ca_suite_number#38942,ca_city#38943,ca_county#38944,ca_state#38945,ca_zip#38946,ca_country#38947,ca_gmt_offset#38948,ca_location_type#38949] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#38950,ib_lower_bound#38951,ib_upper_bound#38952] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#38939, ca_street_name#38940, ca_city#38943, ca_zip#38946, d_year#498, d_year#38873, d_year#38901], [i_product_name#585 AS product_name#38961, i_item_sk#564 AS item_sk#38962, s_store_name#669 AS store_name#38963, s_zip#689 AS store_zip#38964, ca_street_number#450 AS b_street_number#38965, ca_street_name#451 AS b_streen_name#38966, ca_city#454 AS b_city#38967, ca_zip#457 AS b_zip#38968, ca_street_number#38939 AS c_street_number#38969, ca_street_name#38940 AS c_street_name#38970, ca_city#38943 AS c_city#38971, ca_zip#38946 AS c_zip#38972, d_year#498 AS syear#38973, d_year#38873 AS fsyear#38974, d_year#38901 AS s2year#38975, count(1) AS cnt#38976L, sum(ss_wholesale_cost#141) AS s1#38977, sum(ss_list_price#142) AS s2#38978, sum(ss_coupon_amt#149) AS s3#38979]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#38923)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#38932) && (c_current_addr_sk#416 = ca_address_sk#38937)) && (c_first_sales_date_sk#418 = d_date_sk#38867)) && (((c_first_shipto_date_sk#417 = d_date_sk#38895) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#38933 = ib_income_band_sk#38950) && NOT (cd_marital_status#476 = cd_marital_status#38925)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#38837, refund#38838]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#38863 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#38864 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#38837, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#38838, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#38863, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#38864]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#38867,d_date_id#38868,d_date#38869,d_month_seq#38870,d_week_seq#38871,d_quarter_seq#38872,d_year#38873,d_dow#38874,d_moy#38875,d_dom#38876,d_qoy#38877,d_fy_year#38878,d_fy_quarter_seq#38879,d_fy_week_seq#38880,d_day_name#38881,d_quarter_name#38882,d_holiday#38883,d_weekend#38884,d_following_holiday#38885,d_first_dom#38886,d_last_dom#38887,d_same_day_ly#38888,d_same_day_lq#38889,d_current_day#38890,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#38895,d_date_id#38896,d_date#38897,d_month_seq#38898,d_week_seq#38899,d_quarter_seq#38900,d_year#38901,d_dow#38902,d_moy#38903,d_dom#38904,d_qoy#38905,d_fy_year#38906,d_fy_quarter_seq#38907,d_fy_week_seq#38908,d_day_name#38909,d_quarter_name#38910,d_holiday#38911,d_weekend#38912,d_following_holiday#38913,d_first_dom#38914,d_last_dom#38915,d_same_day_ly#38916,d_same_day_lq#38917,d_current_day#38918,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#38923,cd_gender#38924,cd_marital_status#38925,cd_education_status#38926,cd_purchase_estimate#38927,cd_credit_rating#38928,cd_dep_count#38929,cd_dep_employed_count#38930,cd_dep_college_count#38931] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#38932,hd_income_band_sk#38933,hd_buy_potential#38934,hd_dep_count#38935,hd_vehicle_count#38936] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#38937,ca_address_id#38938,ca_street_number#38939,ca_street_name#38940,ca_street_type#38941,ca_suite_number#38942,ca_city#38943,ca_county#38944,ca_state#38945,ca_zip#38946,ca_country#38947,ca_gmt_offset#38948,ca_location_type#38949] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#38950,ib_lower_bound#38951,ib_upper_bound#38952] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 3300.766483965s
Running execution q65-v2.4 iteration: 1, StandardRun=true
19/10/04 05:31:22 INFO Query: 
== Query: q65-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name#669 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST], true
      +- Project [s_store_name#669, i_item_desc#568, revenue#39423, i_current_price#569, i_wholesale_cost#570, i_brand#572]
         +- Filter (((ss_store_sk#137 = ss_store_sk#39434) && (cast(revenue#39423 as decimal(23,7)) <= cast(CheckOverflow((promote_precision(cast(0.1 as decimal(21,6))) * promote_precision(cast(ave#39422 as decimal(21,6)))), DecimalType(23,7)) as decimal(23,7)))) && ((s_store_sk#664 = ss_store_sk#39434) && (i_item_sk#564 = ss_item_sk#39429)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `store`
               :  :  :  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :  :  +- SubqueryAlias `item`
               :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- SubqueryAlias `sb`
               :     +- Aggregate [ss_store_sk#137], [ss_store_sk#137, avg(revenue#39421) AS ave#39422]
               :        +- SubqueryAlias `sa`
               :           +- Aggregate [ss_store_sk#137, ss_item_sk#132], [ss_store_sk#137, ss_item_sk#132, sum(ss_sales_price#143) AS revenue#39421]
               :              +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_month_seq#495 >= 1176) && (d_month_seq#495 <= (1176 + 11))))
               :                 +- Join Inner
               :                    :- SubqueryAlias `store_sales`
               :                    :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `sc`
                  +- Aggregate [ss_store_sk#39434, ss_item_sk#39429], [ss_store_sk#39434, ss_item_sk#39429, sum(ss_sales_price#39440) AS revenue#39423]
                     +- Filter ((ss_sold_date_sk#39427 = d_date_sk#492) && ((d_month_seq#495 >= 1176) && (d_month_seq#495 <= (1176 + 11))))
                        +- Join Inner
                           :- SubqueryAlias `store_sales`
                           :  +- Relation[ss_sold_date_sk#39427,ss_sold_time_sk#39428,ss_item_sk#39429,ss_customer_sk#39430,ss_cdemo_sk#39431,ss_hdemo_sk#39432,ss_addr_sk#39433,ss_store_sk#39434,ss_promo_sk#39435,ss_ticket_number#39436L,ss_quantity#39437,ss_wholesale_cost#39438,ss_list_price#39439,ss_sales_price#39440,ss_ext_discount_amt#39441,ss_ext_sales_price#39442,ss_ext_wholesale_cost#39443,ss_ext_list_price#39444,ss_ext_tax#39445,ss_coupon_amt#39446,ss_net_paid#39447,ss_net_paid_inc_tax#39448,ss_net_profit#39449] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/04 05:31:22 INFO Query: 
== Query: q65-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [s_store_name#669 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST], true
      +- Project [s_store_name#669, i_item_desc#568, revenue#39458, i_current_price#569, i_wholesale_cost#570, i_brand#572]
         +- Filter (((ss_store_sk#137 = ss_store_sk#39469) && (cast(revenue#39458 as decimal(23,7)) <= cast(CheckOverflow((promote_precision(cast(0.1 as decimal(21,6))) * promote_precision(cast(ave#39457 as decimal(21,6)))), DecimalType(23,7)) as decimal(23,7)))) && ((s_store_sk#664 = ss_store_sk#39469) && (i_item_sk#564 = ss_item_sk#39464)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `store`
               :  :  :  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :  :  +- SubqueryAlias `item`
               :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  +- SubqueryAlias `sb`
               :     +- Aggregate [ss_store_sk#137], [ss_store_sk#137, avg(revenue#39456) AS ave#39457]
               :        +- SubqueryAlias `sa`
               :           +- Aggregate [ss_store_sk#137, ss_item_sk#132], [ss_store_sk#137, ss_item_sk#132, sum(ss_sales_price#143) AS revenue#39456]
               :              +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_month_seq#495 >= 1176) && (d_month_seq#495 <= (1176 + 11))))
               :                 +- Join Inner
               :                    :- SubqueryAlias `store_sales`
               :                    :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `sc`
                  +- Aggregate [ss_store_sk#39469, ss_item_sk#39464], [ss_store_sk#39469, ss_item_sk#39464, sum(ss_sales_price#39475) AS revenue#39458]
                     +- Filter ((ss_sold_date_sk#39462 = d_date_sk#492) && ((d_month_seq#495 >= 1176) && (d_month_seq#495 <= (1176 + 11))))
                        +- Join Inner
                           :- SubqueryAlias `store_sales`
                           :  +- Relation[ss_sold_date_sk#39462,ss_sold_time_sk#39463,ss_item_sk#39464,ss_customer_sk#39465,ss_cdemo_sk#39466,ss_hdemo_sk#39467,ss_addr_sk#39468,ss_store_sk#39469,ss_promo_sk#39470,ss_ticket_number#39471L,ss_quantity#39472,ss_wholesale_cost#39473,ss_list_price#39474,ss_sales_price#39475,ss_ext_discount_amt#39476,ss_ext_sales_price#39477,ss_ext_wholesale_cost#39478,ss_ext_list_price#39479,ss_ext_tax#39480,ss_coupon_amt#39481,ss_net_paid#39482,ss_net_paid_inc_tax#39483,ss_net_profit#39484] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 363.91144120900003s
Running execution q66-v2.4 iteration: 1, StandardRun=true
19/10/04 05:37:28 INFO Query: 
== Query: q66-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, ship_carriers#40005, year#40006, jan_sales#40057, feb_sales#40058, mar_sales#40059, apr_sales#40060, may_sales#40061, jun_sales#40062, jul_sales#40063, aug_sales#40064, sep_sales#40065, oct_sales#40066, nov_sales#40067, dec_sales#40068, jan_sales_per_sq_foot#40069, feb_sales_per_sq_foot#40070, mar_sales_per_sq_foot#40071, apr_sales_per_sq_foot#40072, ... 20 more fields]
      +- Sort [w_warehouse_name#744 ASC NULLS FIRST], true
         +- Aggregate [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, ship_carriers#40005, year#40006], [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, ship_carriers#40005, year#40006, sum(jan_sales#40007) AS jan_sales#40057, sum(feb_sales#40008) AS feb_sales#40058, sum(mar_sales#40009) AS mar_sales#40059, sum(apr_sales#40010) AS apr_sales#40060, sum(may_sales#40011) AS may_sales#40061, sum(jun_sales#40012) AS jun_sales#40062, sum(jul_sales#40013) AS jul_sales#40063, sum(aug_sales#40014) AS aug_sales#40064, sum(sep_sales#40015) AS sep_sales#40065, sum(oct_sales#40016) AS oct_sales#40066, sum(nov_sales#40017) AS nov_sales#40067, sum(dec_sales#40018) AS dec_sales#40068, sum(CheckOverflow((promote_precision(cast(jan_sales#40007 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS jan_sales_per_sq_foot#40069, sum(CheckOverflow((promote_precision(cast(feb_sales#40008 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS feb_sales_per_sq_foot#40070, sum(CheckOverflow((promote_precision(cast(mar_sales#40009 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS mar_sales_per_sq_foot#40071, sum(CheckOverflow((promote_precision(cast(apr_sales#40010 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS apr_sales_per_sq_foot#40072, ... 20 more fields]
            +- SubqueryAlias `x`
               +- Union
                  :- Aggregate [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, d_year#498], [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, concat(DHL, ,, BARIAN) AS ship_carriers#40005, d_year#498 AS year#40006, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_sales#40007, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_sales#40008, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_sales#40009, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_sales#40010, sum(CASE WHEN (d_moy#500 = 5) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS may_sales#40011, sum(CASE WHEN (d_moy#500 = 6) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jun_sales#40012, sum(CASE WHEN (d_moy#500 = 7) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jul_sales#40013, sum(CASE WHEN (d_moy#500 = 8) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS aug_sales#40014, sum(CASE WHEN (d_moy#500 = 9) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS sep_sales#40015, sum(CASE WHEN (d_moy#500 = 10) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS oct_sales#40016, sum(CASE WHEN (d_moy#500 = 11) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS nov_sales#40017, sum(CASE WHEN (d_moy#500 = 12) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS dec_sales#40018, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_net#40019, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_net#40020, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_net#40021, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_net#40022, ... 8 more fields]
                  :  +- Filter ((((ws_warehouse_sk#231 = w_warehouse_sk#742) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((ws_sold_time_sk#217 = t_time_sk#722) && (ws_ship_mode_sk#230 = sm_ship_mode_sk#652))) && (((d_year#498 = 2001) && ((t_time#724 >= 30838) && (t_time#724 <= (30838 + 28800)))) && sm_carrier#656 IN (DHL,BARIAN)))
                  :     +- Join Inner
                  :        :- Join Inner
                  :        :  :- Join Inner
                  :        :  :  :- Join Inner
                  :        :  :  :  :- SubqueryAlias `web_sales`
                  :        :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :        :  :  :  +- SubqueryAlias `warehouse`
                  :        :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :        :  :  +- SubqueryAlias `date_dim`
                  :        :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :        :  +- SubqueryAlias `time_dim`
                  :        :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                  :        +- SubqueryAlias `ship_mode`
                  :           +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet
                  +- Aggregate [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, d_year#498], [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, concat(DHL, ,, BARIAN) AS ship_carriers#40031, d_year#498 AS year#40032, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_sales#40033, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_sales#40034, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_sales#40035, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_sales#40036, sum(CASE WHEN (d_moy#500 = 5) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS may_sales#40037, sum(CASE WHEN (d_moy#500 = 6) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jun_sales#40038, sum(CASE WHEN (d_moy#500 = 7) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jul_sales#40039, sum(CASE WHEN (d_moy#500 = 8) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS aug_sales#40040, sum(CASE WHEN (d_moy#500 = 9) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS sep_sales#40041, sum(CASE WHEN (d_moy#500 = 10) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS oct_sales#40042, sum(CASE WHEN (d_moy#500 = 11) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS nov_sales#40043, sum(CASE WHEN (d_moy#500 = 12) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS dec_sales#40044, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_net#40045, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_net#40046, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_net#40047, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_net#40048, ... 8 more fields]
                     +- Filter ((((cs_warehouse_sk#14 = w_warehouse_sk#742) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((cs_sold_time_sk#1 = t_time_sk#722) && (cs_ship_mode_sk#13 = sm_ship_mode_sk#652))) && (((d_year#498 = 2001) && ((t_time#724 >= 30838) && (t_time#724 <= (30838 + 28800)))) && sm_carrier#656 IN (DHL,BARIAN)))
                        +- Join Inner
                           :- Join Inner
                           :  :- Join Inner
                           :  :  :- Join Inner
                           :  :  :  :- SubqueryAlias `catalog_sales`
                           :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :  :  :  +- SubqueryAlias `warehouse`
                           :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                           :  :  +- SubqueryAlias `date_dim`
                           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :  +- SubqueryAlias `time_dim`
                           :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                           +- SubqueryAlias `ship_mode`
                              +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet

     : benchmark
19/10/04 05:37:29 INFO Query: 
== Query: q66-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, ship_carriers#40222, year#40223, jan_sales#40274, feb_sales#40275, mar_sales#40276, apr_sales#40277, may_sales#40278, jun_sales#40279, jul_sales#40280, aug_sales#40281, sep_sales#40282, oct_sales#40283, nov_sales#40284, dec_sales#40285, jan_sales_per_sq_foot#40286, feb_sales_per_sq_foot#40287, mar_sales_per_sq_foot#40288, apr_sales_per_sq_foot#40289, ... 20 more fields]
      +- Sort [w_warehouse_name#744 ASC NULLS FIRST], true
         +- Aggregate [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, ship_carriers#40222, year#40223], [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, ship_carriers#40222, year#40223, sum(jan_sales#40224) AS jan_sales#40274, sum(feb_sales#40225) AS feb_sales#40275, sum(mar_sales#40226) AS mar_sales#40276, sum(apr_sales#40227) AS apr_sales#40277, sum(may_sales#40228) AS may_sales#40278, sum(jun_sales#40229) AS jun_sales#40279, sum(jul_sales#40230) AS jul_sales#40280, sum(aug_sales#40231) AS aug_sales#40281, sum(sep_sales#40232) AS sep_sales#40282, sum(oct_sales#40233) AS oct_sales#40283, sum(nov_sales#40234) AS nov_sales#40284, sum(dec_sales#40235) AS dec_sales#40285, sum(CheckOverflow((promote_precision(cast(jan_sales#40224 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS jan_sales_per_sq_foot#40286, sum(CheckOverflow((promote_precision(cast(feb_sales#40225 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS feb_sales_per_sq_foot#40287, sum(CheckOverflow((promote_precision(cast(mar_sales#40226 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS mar_sales_per_sq_foot#40288, sum(CheckOverflow((promote_precision(cast(apr_sales#40227 as decimal(28,2))) / promote_precision(cast(cast(w_warehouse_sq_ft#745 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12))) AS apr_sales_per_sq_foot#40289, ... 20 more fields]
            +- SubqueryAlias `x`
               +- Union
                  :- Aggregate [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, d_year#498], [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, concat(DHL, ,, BARIAN) AS ship_carriers#40222, d_year#498 AS year#40223, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_sales#40224, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_sales#40225, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_sales#40226, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_sales#40227, sum(CASE WHEN (d_moy#500 = 5) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS may_sales#40228, sum(CASE WHEN (d_moy#500 = 6) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jun_sales#40229, sum(CASE WHEN (d_moy#500 = 7) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jul_sales#40230, sum(CASE WHEN (d_moy#500 = 8) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS aug_sales#40231, sum(CASE WHEN (d_moy#500 = 9) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS sep_sales#40232, sum(CASE WHEN (d_moy#500 = 10) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS oct_sales#40233, sum(CASE WHEN (d_moy#500 = 11) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS nov_sales#40234, sum(CASE WHEN (d_moy#500 = 12) THEN CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS dec_sales#40235, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_net#40236, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_net#40237, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_net#40238, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid#245 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#234 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_net#40239, ... 8 more fields]
                  :  +- Filter ((((ws_warehouse_sk#231 = w_warehouse_sk#742) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((ws_sold_time_sk#217 = t_time_sk#722) && (ws_ship_mode_sk#230 = sm_ship_mode_sk#652))) && (((d_year#498 = 2001) && ((t_time#724 >= 30838) && (t_time#724 <= (30838 + 28800)))) && sm_carrier#656 IN (DHL,BARIAN)))
                  :     +- Join Inner
                  :        :- Join Inner
                  :        :  :- Join Inner
                  :        :  :  :- Join Inner
                  :        :  :  :  :- SubqueryAlias `web_sales`
                  :        :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :        :  :  :  +- SubqueryAlias `warehouse`
                  :        :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :        :  :  +- SubqueryAlias `date_dim`
                  :        :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :        :  +- SubqueryAlias `time_dim`
                  :        :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                  :        +- SubqueryAlias `ship_mode`
                  :           +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet
                  +- Aggregate [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, d_year#498], [w_warehouse_name#744, w_warehouse_sq_ft#745, w_city#750, w_county#751, w_state#752, w_country#754, concat(DHL, ,, BARIAN) AS ship_carriers#40248, d_year#498 AS year#40249, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_sales#40250, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_sales#40251, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_sales#40252, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_sales#40253, sum(CASE WHEN (d_moy#500 = 5) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS may_sales#40254, sum(CASE WHEN (d_moy#500 = 6) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jun_sales#40255, sum(CASE WHEN (d_moy#500 = 7) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jul_sales#40256, sum(CASE WHEN (d_moy#500 = 8) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS aug_sales#40257, sum(CASE WHEN (d_moy#500 = 9) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS sep_sales#40258, sum(CASE WHEN (d_moy#500 = 10) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS oct_sales#40259, sum(CASE WHEN (d_moy#500 = 11) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS nov_sales#40260, sum(CASE WHEN (d_moy#500 = 12) THEN CheckOverflow((promote_precision(cast(cs_sales_price#21 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS dec_sales#40261, sum(CASE WHEN (d_moy#500 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS jan_net#40262, sum(CASE WHEN (d_moy#500 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS feb_net#40263, sum(CASE WHEN (d_moy#500 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS mar_net#40264, sum(CASE WHEN (d_moy#500 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#30 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#18 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)) ELSE cast(0 as decimal(18,2)) END) AS apr_net#40265, ... 8 more fields]
                     +- Filter ((((cs_warehouse_sk#14 = w_warehouse_sk#742) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((cs_sold_time_sk#1 = t_time_sk#722) && (cs_ship_mode_sk#13 = sm_ship_mode_sk#652))) && (((d_year#498 = 2001) && ((t_time#724 >= 30838) && (t_time#724 <= (30838 + 28800)))) && sm_carrier#656 IN (DHL,BARIAN)))
                        +- Join Inner
                           :- Join Inner
                           :  :- Join Inner
                           :  :  :- Join Inner
                           :  :  :  :- SubqueryAlias `catalog_sales`
                           :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :  :  :  +- SubqueryAlias `warehouse`
                           :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                           :  :  +- SubqueryAlias `date_dim`
                           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           :  +- SubqueryAlias `time_dim`
                           :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                           +- SubqueryAlias `ship_mode`
                              +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet

      running Thread[benchmark runner,5,main]
Execution time: 168.093936546s
Running execution q67-v2.4 iteration: 1, StandardRun=true
19/10/04 05:40:20 INFO Query: 
== Query: q67-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#41147 ASC NULLS FIRST, i_class#41148 ASC NULLS FIRST, i_brand#41149 ASC NULLS FIRST, i_product_name#41150 ASC NULLS FIRST, d_year#41151 ASC NULLS FIRST, d_qoy#41152 ASC NULLS FIRST, d_moy#41153 ASC NULLS FIRST, s_store_id#41154 ASC NULLS FIRST, sumsales#41133 ASC NULLS FIRST, rk#41134 ASC NULLS FIRST], true
      +- Project [i_category#41147, i_class#41148, i_brand#41149, i_product_name#41150, d_year#41151, d_qoy#41152, d_moy#41153, s_store_id#41154, sumsales#41133, rk#41134]
         +- Filter (rk#41134 <= 100)
            +- SubqueryAlias `dw2`
               +- Project [i_category#41147, i_class#41148, i_brand#41149, i_product_name#41150, d_year#41151, d_qoy#41152, d_moy#41153, s_store_id#41154, sumsales#41133, rk#41134]
                  +- Project [i_category#41147, i_class#41148, i_brand#41149, i_product_name#41150, d_year#41151, d_qoy#41152, d_moy#41153, s_store_id#41154, sumsales#41133, rk#41134, rk#41134]
                     +- Window [rank(sumsales#41133) windowspecdefinition(i_category#41147, sumsales#41133 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#41134], [i_category#41147], [sumsales#41133 DESC NULLS LAST]
                        +- Project [i_category#41147, i_class#41148, i_brand#41149, i_product_name#41150, d_year#41151, d_qoy#41152, d_moy#41153, s_store_id#41154, sumsales#41133]
                           +- SubqueryAlias `dw1`
                              +- Aggregate [i_category#41147, i_class#41148, i_brand#41149, i_product_name#41150, d_year#41151, d_qoy#41152, d_moy#41153, s_store_id#41154, spark_grouping_id#41138], [i_category#41147, i_class#41148, i_brand#41149, i_product_name#41150, d_year#41151, d_qoy#41152, d_moy#41153, s_store_id#41154, sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#143 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)), cast(0 as decimal(18,2)))) AS sumsales#41133]
                                 +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41139, i_class#41140, i_brand#41141, i_product_name#41142, d_year#41143, d_qoy#41144, d_moy#41145, s_store_id#41146, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41139, i_class#41140, i_brand#41141, i_product_name#41142, d_year#41143, d_qoy#41144, d_moy#41145, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41139, i_class#41140, i_brand#41141, i_product_name#41142, d_year#41143, d_qoy#41144, null, null, 3), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41139, i_class#41140, i_brand#41141, i_product_name#41142, d_year#41143, null, null, null, 7), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41139, i_class#41140, i_brand#41141, i_product_name#41142, null, null, null, null, 15), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41139, i_class#41140, i_brand#41141, null, null, null, null, null, 31), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41139, i_class#41140, null, null, null, null, null, null, 63), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41139, null, null, null, null, null, null, null, 127), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, null, null, null, null, null, null, 255)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 87 more fields]
                                    +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 86 more fields]
                                       +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_store_sk#137 = s_store_sk#664) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11)))))
                                          +- Join Inner
                                             :- Join Inner
                                             :  :- Join Inner
                                             :  :  :- SubqueryAlias `store_sales`
                                             :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                             :  :  +- SubqueryAlias `date_dim`
                                             :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                             :  +- SubqueryAlias `store`
                                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                                             +- SubqueryAlias `item`
                                                +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/04 05:40:20 INFO Query: 
== Query: q67-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_category#41188 ASC NULLS FIRST, i_class#41189 ASC NULLS FIRST, i_brand#41190 ASC NULLS FIRST, i_product_name#41191 ASC NULLS FIRST, d_year#41192 ASC NULLS FIRST, d_qoy#41193 ASC NULLS FIRST, d_moy#41194 ASC NULLS FIRST, s_store_id#41195 ASC NULLS FIRST, sumsales#41174 ASC NULLS FIRST, rk#41175 ASC NULLS FIRST], true
      +- Project [i_category#41188, i_class#41189, i_brand#41190, i_product_name#41191, d_year#41192, d_qoy#41193, d_moy#41194, s_store_id#41195, sumsales#41174, rk#41175]
         +- Filter (rk#41175 <= 100)
            +- SubqueryAlias `dw2`
               +- Project [i_category#41188, i_class#41189, i_brand#41190, i_product_name#41191, d_year#41192, d_qoy#41193, d_moy#41194, s_store_id#41195, sumsales#41174, rk#41175]
                  +- Project [i_category#41188, i_class#41189, i_brand#41190, i_product_name#41191, d_year#41192, d_qoy#41193, d_moy#41194, s_store_id#41195, sumsales#41174, rk#41175, rk#41175]
                     +- Window [rank(sumsales#41174) windowspecdefinition(i_category#41188, sumsales#41174 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rk#41175], [i_category#41188], [sumsales#41174 DESC NULLS LAST]
                        +- Project [i_category#41188, i_class#41189, i_brand#41190, i_product_name#41191, d_year#41192, d_qoy#41193, d_moy#41194, s_store_id#41195, sumsales#41174]
                           +- SubqueryAlias `dw1`
                              +- Aggregate [i_category#41188, i_class#41189, i_brand#41190, i_product_name#41191, d_year#41192, d_qoy#41193, d_moy#41194, s_store_id#41195, spark_grouping_id#41179], [i_category#41188, i_class#41189, i_brand#41190, i_product_name#41191, d_year#41192, d_qoy#41193, d_moy#41194, s_store_id#41195, sum(coalesce(CheckOverflow((promote_precision(cast(ss_sales_price#143 as decimal(12,2))) * promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2)), cast(0 as decimal(18,2)))) AS sumsales#41174]
                                 +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41180, i_class#41181, i_brand#41182, i_product_name#41183, d_year#41184, d_qoy#41185, d_moy#41186, s_store_id#41187, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41180, i_class#41181, i_brand#41182, i_product_name#41183, d_year#41184, d_qoy#41185, d_moy#41186, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41180, i_class#41181, i_brand#41182, i_product_name#41183, d_year#41184, d_qoy#41185, null, null, 3), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41180, i_class#41181, i_brand#41182, i_product_name#41183, d_year#41184, null, null, null, 7), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41180, i_class#41181, i_brand#41182, i_product_name#41183, null, null, null, null, 15), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41180, i_class#41181, i_brand#41182, null, null, null, null, null, 31), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41180, i_class#41181, null, null, null, null, null, null, 63), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#41180, null, null, null, null, null, null, null, 127), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, null, null, null, null, null, null, 255)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 87 more fields]
                                    +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 86 more fields]
                                       +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_item_sk#132 = i_item_sk#564)) && ((ss_store_sk#137 = s_store_sk#664) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11)))))
                                          +- Join Inner
                                             :- Join Inner
                                             :  :- Join Inner
                                             :  :  :- SubqueryAlias `store_sales`
                                             :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                             :  :  +- SubqueryAlias `date_dim`
                                             :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                             :  +- SubqueryAlias `store`
                                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                                             +- SubqueryAlias `item`
                                                +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 2909.541096712s
Running execution q68-v2.4 iteration: 1, StandardRun=true
19/10/04 06:28:51 INFO Query: 
== Query: q68-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_last_name#421 ASC NULLS FIRST, ss_ticket_number#139L ASC NULLS FIRST], true
      +- Project [c_last_name#421, c_first_name#420, ca_city#454, bought_city#41321, ss_ticket_number#139L, extended_price#41322, extended_tax#41324, list_price#41323]
         +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && NOT (ca_city#454 = bought_city#41321))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dn`
               :  :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133, ss_addr_sk#136, ca_city#454], [ss_ticket_number#139L, ss_customer_sk#133, ca_city#454 AS bought_city#41321, sum(ss_ext_sales_price#145) AS extended_price#41322, sum(ss_ext_list_price#147) AS list_price#41323, sum(ss_ext_tax#148) AS extended_tax#41324]
               :  :     +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_hdemo_sk#135 = hd_demo_sk#548) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((d_dom#501 >= 1) && (d_dom#501 <= 2)) && ((hd_dep_count#551 = 4) || (hd_vehicle_count#552 = 3))) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_city#686 IN (Midway,Fairview))))
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- Join Inner
               :  :           :  :  :- Join Inner
               :  :           :  :  :  :- SubqueryAlias `store_sales`
               :  :           :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  :  :  +- SubqueryAlias `date_dim`
               :  :           :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           :  :  +- SubqueryAlias `store`
               :  :           :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :  :           :  +- SubqueryAlias `household_demographics`
               :  :           :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  :           +- SubqueryAlias `customer_address`
               :  :              +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer`
               :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               +- SubqueryAlias `current_addr`
                  +- SubqueryAlias `customer_address`
                     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

     : benchmark
19/10/04 06:28:51 INFO Query: 
== Query: q68-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_last_name#421 ASC NULLS FIRST, ss_ticket_number#139L ASC NULLS FIRST], true
      +- Project [c_last_name#421, c_first_name#420, ca_city#454, bought_city#41336, ss_ticket_number#139L, extended_price#41337, extended_tax#41339, list_price#41338]
         +- Filter (((ss_customer_sk#133 = c_customer_sk#412) && (c_current_addr_sk#416 = ca_address_sk#448)) && NOT (ca_city#454 = bought_city#41336))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `dn`
               :  :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133, ss_addr_sk#136, ca_city#454], [ss_ticket_number#139L, ss_customer_sk#133, ca_city#454 AS bought_city#41336, sum(ss_ext_sales_price#145) AS extended_price#41337, sum(ss_ext_list_price#147) AS list_price#41338, sum(ss_ext_tax#148) AS extended_tax#41339]
               :  :     +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_hdemo_sk#135 = hd_demo_sk#548) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((d_dom#501 >= 1) && (d_dom#501 <= 2)) && ((hd_dep_count#551 = 4) || (hd_vehicle_count#552 = 3))) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_city#686 IN (Midway,Fairview))))
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- Join Inner
               :  :           :  :  :- Join Inner
               :  :           :  :  :  :- SubqueryAlias `store_sales`
               :  :           :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :  :  :  +- SubqueryAlias `date_dim`
               :  :           :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           :  :  +- SubqueryAlias `store`
               :  :           :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
               :  :           :  +- SubqueryAlias `household_demographics`
               :  :           :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  :           +- SubqueryAlias `customer_address`
               :  :              +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer`
               :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               +- SubqueryAlias `current_addr`
                  +- SubqueryAlias `customer_address`
                     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet

      running Thread[benchmark runner,5,main]
Execution time: 189.43174462300001s
Running execution q69-v2.4 iteration: 1, StandardRun=true
19/10/04 06:32:03 INFO Query: 
== Query: q69-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cd_gender#475 ASC NULLS FIRST, cd_marital_status#476 ASC NULLS FIRST, cd_education_status#477 ASC NULLS FIRST, cd_purchase_estimate#478 ASC NULLS FIRST, cd_credit_rating#479 ASC NULLS FIRST], true
      +- Aggregate [cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479], [cd_gender#475, cd_marital_status#476, cd_education_status#477, count(1) AS cnt1#41407L, cd_purchase_estimate#478, count(1) AS cnt2#41408L, cd_credit_rating#479, count(1) AS cnt3#41409L]
         +- Filter ((((c_current_addr_sk#416 = ca_address_sk#448) && ca_state#456 IN (KY,GA,NM)) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && (exists#41410 [c_customer_sk#412] && (NOT exists#41411 [c_customer_sk#412] && NOT exists#41412 [c_customer_sk#412])))
            :  :- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 27 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = 2001) && ((d_moy#500 >= 4) && (d_moy#500 <= (4 + 2)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `store_sales`
            :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 38 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = 2001) && ((d_moy#500 >= 4) && (d_moy#500 <= (4 + 2)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `web_sales`
            :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 38 more fields]
            :     +- Filter (((outer(c_customer_sk#412) = cs_ship_customer_sk#7) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = 2001) && ((d_moy#500 >= 4) && (d_moy#500 <= (4 + 2)))))
            :        +- Join Inner
            :           :- SubqueryAlias `catalog_sales`
            :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :           +- SubqueryAlias `date_dim`
            :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `c`
               :  :  +- SubqueryAlias `customer`
               :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  +- SubqueryAlias `ca`
               :     +- SubqueryAlias `customer_address`
               :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer_demographics`
                  +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet

     : benchmark
19/10/04 06:32:03 INFO Query: 
== Query: q69-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [cd_gender#475 ASC NULLS FIRST, cd_marital_status#476 ASC NULLS FIRST, cd_education_status#477 ASC NULLS FIRST, cd_purchase_estimate#478 ASC NULLS FIRST, cd_credit_rating#479 ASC NULLS FIRST], true
      +- Aggregate [cd_gender#475, cd_marital_status#476, cd_education_status#477, cd_purchase_estimate#478, cd_credit_rating#479], [cd_gender#475, cd_marital_status#476, cd_education_status#477, count(1) AS cnt1#41424L, cd_purchase_estimate#478, count(1) AS cnt2#41425L, cd_credit_rating#479, count(1) AS cnt3#41426L]
         +- Filter ((((c_current_addr_sk#416 = ca_address_sk#448) && ca_state#456 IN (KY,GA,NM)) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && (exists#41427 [c_customer_sk#412] && (NOT exists#41428 [c_customer_sk#412] && NOT exists#41429 [c_customer_sk#412])))
            :  :- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 27 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && ((d_year#498 = 2001) && ((d_moy#500 >= 4) && (d_moy#500 <= (4 + 2)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `store_sales`
            :  :        :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 38 more fields]
            :  :  +- Filter (((outer(c_customer_sk#412) = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && ((d_year#498 = 2001) && ((d_moy#500 >= 4) && (d_moy#500 <= (4 + 2)))))
            :  :     +- Join Inner
            :  :        :- SubqueryAlias `web_sales`
            :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :  :        +- SubqueryAlias `date_dim`
            :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  +- Project [cs_sold_date_sk#0, cs_sold_time_sk#1, cs_ship_date_sk#2, cs_bill_customer_sk#3, cs_bill_cdemo_sk#4, cs_bill_hdemo_sk#5, cs_bill_addr_sk#6, cs_ship_customer_sk#7, cs_ship_cdemo_sk#8, cs_ship_hdemo_sk#9, cs_ship_addr_sk#10, cs_call_center_sk#11, cs_catalog_page_sk#12, cs_ship_mode_sk#13, cs_warehouse_sk#14, cs_item_sk#15, cs_promo_sk#16, cs_order_number#17L, cs_quantity#18, cs_wholesale_cost#19, cs_list_price#20, cs_sales_price#21, cs_ext_discount_amt#22, cs_ext_sales_price#23, ... 38 more fields]
            :     +- Filter (((outer(c_customer_sk#412) = cs_ship_customer_sk#7) && (cs_sold_date_sk#0 = d_date_sk#492)) && ((d_year#498 = 2001) && ((d_moy#500 >= 4) && (d_moy#500 <= (4 + 2)))))
            :        +- Join Inner
            :           :- SubqueryAlias `catalog_sales`
            :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :           +- SubqueryAlias `date_dim`
            :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `c`
               :  :  +- SubqueryAlias `customer`
               :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  +- SubqueryAlias `ca`
               :     +- SubqueryAlias `customer_address`
               :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer_demographics`
                  +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet

      running Thread[benchmark runner,5,main]
Execution time: 140.305720461s
Running execution q70-v2.4 iteration: 1, StandardRun=true
19/10/04 06:34:25 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#41545 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#41545 as int) = 0) THEN s_state#41567 END ASC NULLS FIRST, rank_within_parent#41546 ASC NULLS FIRST], true
      +- Project [total_sum#41544, s_state#41567, s_county#41568, lochierarchy#41545, rank_within_parent#41546]
         +- Project [total_sum#41544, s_state#41567, s_county#41568, lochierarchy#41545, _w0#41577, _w1#41581, _w2#41582, _w3#41583, rank_within_parent#41546, rank_within_parent#41546]
            +- Window [rank(_w3#41583) windowspecdefinition(_w1#41581, _w2#41582, _w3#41583 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#41546], [_w1#41581, _w2#41582], [_w3#41583 DESC NULLS LAST]
               +- Aggregate [s_state#41567, s_county#41568, spark_grouping_id#41564], [sum(ss_net_profit#152) AS total_sum#41544, s_state#41567, s_county#41568, (cast((shiftright(spark_grouping_id#41564, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#41564, 0) & 1) as tinyint)) AS lochierarchy#41545, sum(ss_net_profit#152) AS _w0#41577, (cast((shiftright(spark_grouping_id#41564, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#41564, 0) & 1) as tinyint)) AS _w1#41581, CASE WHEN (cast(cast((shiftright(spark_grouping_id#41564, 0) & 1) as tinyint) as int) = 0) THEN s_state#41567 END AS _w2#41582, sum(ss_net_profit#152) AS _w3#41583]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#41565, s_county#41566, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#41565, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#41549 [])))
                           :  +- Project [s_state#41547]
                           :     +- Filter (ranking#41548 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#41547, ranking#41548]
                           :              +- Project [s_state#41547, s_state#688, _w1#41555, ranking#41548, ranking#41548]
                           :                 +- Window [rank(_w1#41555) windowspecdefinition(s_state#688, _w1#41555 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#41548], [s_state#688], [_w1#41555 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#41547, s_state#688, sum(ss_net_profit#152) AS _w1#41555]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/10/04 06:34:26 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#41599 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#41599 as int) = 0) THEN s_state#41621 END ASC NULLS FIRST, rank_within_parent#41600 ASC NULLS FIRST], true
      +- Project [total_sum#41598, s_state#41621, s_county#41622, lochierarchy#41599, rank_within_parent#41600]
         +- Project [total_sum#41598, s_state#41621, s_county#41622, lochierarchy#41599, _w0#41631, _w1#41635, _w2#41636, _w3#41637, rank_within_parent#41600, rank_within_parent#41600]
            +- Window [rank(_w3#41637) windowspecdefinition(_w1#41635, _w2#41636, _w3#41637 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#41600], [_w1#41635, _w2#41636], [_w3#41637 DESC NULLS LAST]
               +- Aggregate [s_state#41621, s_county#41622, spark_grouping_id#41618], [sum(ss_net_profit#152) AS total_sum#41598, s_state#41621, s_county#41622, (cast((shiftright(spark_grouping_id#41618, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#41618, 0) & 1) as tinyint)) AS lochierarchy#41599, sum(ss_net_profit#152) AS _w0#41631, (cast((shiftright(spark_grouping_id#41618, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#41618, 0) & 1) as tinyint)) AS _w1#41635, CASE WHEN (cast(cast((shiftright(spark_grouping_id#41618, 0) & 1) as tinyint) as int) = 0) THEN s_state#41621 END AS _w2#41636, sum(ss_net_profit#152) AS _w3#41637]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#41619, s_county#41620, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#41619, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#41603 [])))
                           :  +- Project [s_state#41601]
                           :     +- Filter (ranking#41602 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#41601, ranking#41602]
                           :              +- Project [s_state#41601, s_state#688, _w1#41609, ranking#41602, ranking#41602]
                           :                 +- Window [rank(_w1#41609) windowspecdefinition(s_state#688, _w1#41609 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#41602], [s_state#688], [_w1#41609 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#41601, s_state#688, sum(ss_net_profit#152) AS _w1#41609]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 181.920628413s
Running execution q71-v2.4 iteration: 1, StandardRun=true
19/10/04 06:37:30 INFO Query: 
== Query: q71-v2.4 ==
Project [brand_id#41811, brand#41812, t_hour#725, t_minute#726, ext_price#41813]
+- Sort [ext_price#41813 DESC NULLS LAST, brand_id#41811 ASC NULLS FIRST], true
   +- Aggregate [i_brand#572, i_brand_id#571, t_hour#725, t_minute#726], [i_brand_id#571 AS brand_id#41811, i_brand#572 AS brand#41812, t_hour#725, t_minute#726, sum(ext_price#41799) AS ext_price#41813]
      +- Filter (((sold_item_sk#41801 = i_item_sk#564) && (i_manager_id#584 = 1)) && ((time_sk#41802 = t_time_sk#722) && ((t_meal_time#731 = breakfast) || (t_meal_time#731 = dinner))))
         +- Join Inner
            :- Join Inner
            :  :- SubqueryAlias `item`
            :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            :  +- SubqueryAlias `tmp`
            :     +- Union
            :        :- Union
            :        :  :- Project [ws_ext_sales_price#239 AS ext_price#41799, ws_sold_date_sk#216 AS sold_date_sk#41800, ws_item_sk#219 AS sold_item_sk#41801, ws_sold_time_sk#217 AS time_sk#41802]
            :        :  :  +- Filter (((d_date_sk#492 = ws_sold_date_sk#216) && (d_moy#500 = 11)) && (d_year#498 = 1999))
            :        :  :     +- Join Inner
            :        :  :        :- SubqueryAlias `web_sales`
            :        :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :        :  :        +- SubqueryAlias `date_dim`
            :        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :        :  +- Project [cs_ext_sales_price#23 AS ext_price#41803, cs_sold_date_sk#0 AS sold_date_sk#41804, cs_item_sk#15 AS sold_item_sk#41805, cs_sold_time_sk#1 AS time_sk#41806]
            :        :     +- Filter (((d_date_sk#492 = cs_sold_date_sk#0) && (d_moy#500 = 11)) && (d_year#498 = 1999))
            :        :        +- Join Inner
            :        :           :- SubqueryAlias `catalog_sales`
            :        :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :        :           +- SubqueryAlias `date_dim`
            :        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :        +- Project [ss_ext_sales_price#145 AS ext_price#41807, ss_sold_date_sk#130 AS sold_date_sk#41808, ss_item_sk#132 AS sold_item_sk#41809, ss_sold_time_sk#131 AS time_sk#41810]
            :           +- Filter (((d_date_sk#492 = ss_sold_date_sk#130) && (d_moy#500 = 11)) && (d_year#498 = 1999))
            :              +- Join Inner
            :                 :- SubqueryAlias `store_sales`
            :                 :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :                 +- SubqueryAlias `date_dim`
            :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- SubqueryAlias `time_dim`
               +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet

     : benchmark
19/10/04 06:37:30 INFO Query: 
== Query: q71-v2.4 ==
Project [brand_id#41835, brand#41836, t_hour#725, t_minute#726, ext_price#41837]
+- Sort [ext_price#41837 DESC NULLS LAST, brand_id#41835 ASC NULLS FIRST], true
   +- Aggregate [i_brand#572, i_brand_id#571, t_hour#725, t_minute#726], [i_brand_id#571 AS brand_id#41835, i_brand#572 AS brand#41836, t_hour#725, t_minute#726, sum(ext_price#41823) AS ext_price#41837]
      +- Filter (((sold_item_sk#41825 = i_item_sk#564) && (i_manager_id#584 = 1)) && ((time_sk#41826 = t_time_sk#722) && ((t_meal_time#731 = breakfast) || (t_meal_time#731 = dinner))))
         +- Join Inner
            :- Join Inner
            :  :- SubqueryAlias `item`
            :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
            :  +- SubqueryAlias `tmp`
            :     +- Union
            :        :- Union
            :        :  :- Project [ws_ext_sales_price#239 AS ext_price#41823, ws_sold_date_sk#216 AS sold_date_sk#41824, ws_item_sk#219 AS sold_item_sk#41825, ws_sold_time_sk#217 AS time_sk#41826]
            :        :  :  +- Filter (((d_date_sk#492 = ws_sold_date_sk#216) && (d_moy#500 = 11)) && (d_year#498 = 1999))
            :        :  :     +- Join Inner
            :        :  :        :- SubqueryAlias `web_sales`
            :        :  :        :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :        :  :        +- SubqueryAlias `date_dim`
            :        :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :        :  +- Project [cs_ext_sales_price#23 AS ext_price#41827, cs_sold_date_sk#0 AS sold_date_sk#41828, cs_item_sk#15 AS sold_item_sk#41829, cs_sold_time_sk#1 AS time_sk#41830]
            :        :     +- Filter (((d_date_sk#492 = cs_sold_date_sk#0) && (d_moy#500 = 11)) && (d_year#498 = 1999))
            :        :        +- Join Inner
            :        :           :- SubqueryAlias `catalog_sales`
            :        :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
            :        :           +- SubqueryAlias `date_dim`
            :        :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :        +- Project [ss_ext_sales_price#145 AS ext_price#41831, ss_sold_date_sk#130 AS sold_date_sk#41832, ss_item_sk#132 AS sold_item_sk#41833, ss_sold_time_sk#131 AS time_sk#41834]
            :           +- Filter (((d_date_sk#492 = ss_sold_date_sk#130) && (d_moy#500 = 11)) && (d_year#498 = 1999))
            :              +- Join Inner
            :                 :- SubqueryAlias `store_sales`
            :                 :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
            :                 +- SubqueryAlias `date_dim`
            :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            +- SubqueryAlias `time_dim`
               +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet

      running Thread[benchmark runner,5,main]
Execution time: 190.221530704s
Running execution q72-v2.4 iteration: 1, StandardRun=true
19/10/04 06:40:44 INFO Query: 
== Query: q72-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [total_cnt#41978L DESC NULLS LAST, i_item_desc#568 ASC NULLS FIRST, w_warehouse_name#744 ASC NULLS FIRST, d_week_seq#496 ASC NULLS FIRST], true
      +- Aggregate [i_item_desc#568, w_warehouse_name#744, d_week_seq#496], [i_item_desc#568, w_warehouse_name#744, d_week_seq#496, sum(cast(CASE WHEN isnull(p_promo_sk#608) THEN 1 ELSE 0 END as bigint)) AS no_promo#41976L, sum(cast(CASE WHEN isnotnull(p_promo_sk#608) THEN 1 ELSE 0 END as bigint)) AS promo#41977L, count(1) AS total_cnt#41978L]
         +- Filter ((((d_week_seq#496 = d_week_seq#41983) && (inv_quantity_on_hand#125 < cs_quantity#18)) && (d_date#42010 > cast(cast(cast(d_date#494 as date) as timestamp) + interval 5 days as date))) && (((hd_buy_potential#550 = >10000) && (d_year#498 = 1999)) && (cd_marital_status#476 = D)))
            +- Join LeftOuter, ((cr_item_sk#70 = cs_item_sk#15) && (cr_order_number#84L = cs_order_number#17L))
               :- Join LeftOuter, (cs_promo_sk#16 = p_promo_sk#608)
               :  :- Join Inner, (cs_ship_date_sk#2 = d_date_sk#42008)
               :  :  :- Join Inner, (inv_date_sk#122 = d_date_sk#41979)
               :  :  :  :- Join Inner, (cs_sold_date_sk#0 = d_date_sk#492)
               :  :  :  :  :- Join Inner, (cs_bill_hdemo_sk#5 = hd_demo_sk#548)
               :  :  :  :  :  :- Join Inner, (cs_bill_cdemo_sk#4 = cd_demo_sk#474)
               :  :  :  :  :  :  :- Join Inner, (i_item_sk#564 = cs_item_sk#15)
               :  :  :  :  :  :  :  :- Join Inner, (w_warehouse_sk#742 = inv_warehouse_sk#124)
               :  :  :  :  :  :  :  :  :- Join Inner, (cs_item_sk#15 = inv_item_sk#123)
               :  :  :  :  :  :  :  :  :  :- SubqueryAlias `catalog_sales`
               :  :  :  :  :  :  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :  :  :  :  :  :  +- SubqueryAlias `inventory`
               :  :  :  :  :  :  :  :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  :  :  :  :  :  :  :  +- SubqueryAlias `warehouse`
               :  :  :  :  :  :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
               :  :  :  :  :  :  :  +- SubqueryAlias `item`
               :  :  :  :  :  :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  :  :  :  :  +- SubqueryAlias `customer_demographics`
               :  :  :  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
               :  :  :  :  :  +- SubqueryAlias `household_demographics`
               :  :  :  :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  :  :  :  +- SubqueryAlias `d1`
               :  :  :  :     +- SubqueryAlias `date_dim`
               :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  +- SubqueryAlias `d2`
               :  :  :     +- SubqueryAlias `date_dim`
               :  :  :        +- Relation[d_date_sk#41979,d_date_id#41980,d_date#41981,d_month_seq#41982,d_week_seq#41983,d_quarter_seq#41984,d_year#41985,d_dow#41986,d_moy#41987,d_dom#41988,d_qoy#41989,d_fy_year#41990,d_fy_quarter_seq#41991,d_fy_week_seq#41992,d_day_name#41993,d_quarter_name#41994,d_holiday#41995,d_weekend#41996,d_following_holiday#41997,d_first_dom#41998,d_last_dom#41999,d_same_day_ly#42000,d_same_day_lq#42001,d_current_day#42002,... 4 more fields] parquet
               :  :  +- SubqueryAlias `d3`
               :  :     +- SubqueryAlias `date_dim`
               :  :        +- Relation[d_date_sk#42008,d_date_id#42009,d_date#42010,d_month_seq#42011,d_week_seq#42012,d_quarter_seq#42013,d_year#42014,d_dow#42015,d_moy#42016,d_dom#42017,d_qoy#42018,d_fy_year#42019,d_fy_quarter_seq#42020,d_fy_week_seq#42021,d_day_name#42022,d_quarter_name#42023,d_holiday#42024,d_weekend#42025,d_following_holiday#42026,d_first_dom#42027,d_last_dom#42028,d_same_day_ly#42029,d_same_day_lq#42030,d_current_day#42031,... 4 more fields] parquet
               :  +- SubqueryAlias `promotion`
               :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
               +- SubqueryAlias `catalog_returns`
                  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet

     : benchmark
19/10/04 06:40:44 INFO Query: 
== Query: q72-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [total_cnt#42050L DESC NULLS LAST, i_item_desc#568 ASC NULLS FIRST, w_warehouse_name#744 ASC NULLS FIRST, d_week_seq#496 ASC NULLS FIRST], true
      +- Aggregate [i_item_desc#568, w_warehouse_name#744, d_week_seq#496], [i_item_desc#568, w_warehouse_name#744, d_week_seq#496, sum(cast(CASE WHEN isnull(p_promo_sk#608) THEN 1 ELSE 0 END as bigint)) AS no_promo#42048L, sum(cast(CASE WHEN isnotnull(p_promo_sk#608) THEN 1 ELSE 0 END as bigint)) AS promo#42049L, count(1) AS total_cnt#42050L]
         +- Filter ((((d_week_seq#496 = d_week_seq#42055) && (inv_quantity_on_hand#125 < cs_quantity#18)) && (d_date#42082 > cast(cast(cast(d_date#494 as date) as timestamp) + interval 5 days as date))) && (((hd_buy_potential#550 = >10000) && (d_year#498 = 1999)) && (cd_marital_status#476 = D)))
            +- Join LeftOuter, ((cr_item_sk#70 = cs_item_sk#15) && (cr_order_number#84L = cs_order_number#17L))
               :- Join LeftOuter, (cs_promo_sk#16 = p_promo_sk#608)
               :  :- Join Inner, (cs_ship_date_sk#2 = d_date_sk#42080)
               :  :  :- Join Inner, (inv_date_sk#122 = d_date_sk#42051)
               :  :  :  :- Join Inner, (cs_sold_date_sk#0 = d_date_sk#492)
               :  :  :  :  :- Join Inner, (cs_bill_hdemo_sk#5 = hd_demo_sk#548)
               :  :  :  :  :  :- Join Inner, (cs_bill_cdemo_sk#4 = cd_demo_sk#474)
               :  :  :  :  :  :  :- Join Inner, (i_item_sk#564 = cs_item_sk#15)
               :  :  :  :  :  :  :  :- Join Inner, (w_warehouse_sk#742 = inv_warehouse_sk#124)
               :  :  :  :  :  :  :  :  :- Join Inner, (cs_item_sk#15 = inv_item_sk#123)
               :  :  :  :  :  :  :  :  :  :- SubqueryAlias `catalog_sales`
               :  :  :  :  :  :  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :  :  :  :  :  :  :  :  :  +- SubqueryAlias `inventory`
               :  :  :  :  :  :  :  :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  :  :  :  :  :  :  :  +- SubqueryAlias `warehouse`
               :  :  :  :  :  :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
               :  :  :  :  :  :  :  +- SubqueryAlias `item`
               :  :  :  :  :  :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  :  :  :  :  +- SubqueryAlias `customer_demographics`
               :  :  :  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
               :  :  :  :  :  +- SubqueryAlias `household_demographics`
               :  :  :  :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  :  :  :  +- SubqueryAlias `d1`
               :  :  :  :     +- SubqueryAlias `date_dim`
               :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :  +- SubqueryAlias `d2`
               :  :  :     +- SubqueryAlias `date_dim`
               :  :  :        +- Relation[d_date_sk#42051,d_date_id#42052,d_date#42053,d_month_seq#42054,d_week_seq#42055,d_quarter_seq#42056,d_year#42057,d_dow#42058,d_moy#42059,d_dom#42060,d_qoy#42061,d_fy_year#42062,d_fy_quarter_seq#42063,d_fy_week_seq#42064,d_day_name#42065,d_quarter_name#42066,d_holiday#42067,d_weekend#42068,d_following_holiday#42069,d_first_dom#42070,d_last_dom#42071,d_same_day_ly#42072,d_same_day_lq#42073,d_current_day#42074,... 4 more fields] parquet
               :  :  +- SubqueryAlias `d3`
               :  :     +- SubqueryAlias `date_dim`
               :  :        +- Relation[d_date_sk#42080,d_date_id#42081,d_date#42082,d_month_seq#42083,d_week_seq#42084,d_quarter_seq#42085,d_year#42086,d_dow#42087,d_moy#42088,d_dom#42089,d_qoy#42090,d_fy_year#42091,d_fy_quarter_seq#42092,d_fy_week_seq#42093,d_day_name#42094,d_quarter_name#42095,d_holiday#42096,d_weekend#42097,d_following_holiday#42098,d_first_dom#42099,d_last_dom#42100,d_same_day_ly#42101,d_same_day_lq#42102,d_current_day#42103,... 4 more fields] parquet
               :  +- SubqueryAlias `promotion`
               :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
               +- SubqueryAlias `catalog_returns`
                  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 10877.964760194s
Running execution q73-v2.4 iteration: 1, StandardRun=true
19/10/04 09:42:06 INFO Query: 
== Query: q73-v2.4 ==
Sort [cnt#42281L DESC NULLS LAST, c_last_name#421 ASC NULLS FIRST], true
+- Project [c_last_name#421, c_first_name#420, c_salutation#419, c_preferred_cust_flag#422, ss_ticket_number#139L, cnt#42281L]
   +- Filter ((ss_customer_sk#133 = c_customer_sk#412) && ((cnt#42281L >= cast(1 as bigint)) && (cnt#42281L <= cast(5 as bigint))))
      +- Join Inner
         :- SubqueryAlias `dj`
         :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133], [ss_ticket_number#139L, ss_customer_sk#133, count(1) AS cnt#42281L]
         :     +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (((d_dom#501 >= 1) && (d_dom#501 <= 2)) && ((hd_buy_potential#550 = >10000) || (hd_buy_potential#550 = unknown)))) && (((hd_vehicle_count#552 > 0) && (CASE WHEN (hd_vehicle_count#552 > 0) THEN (cast(hd_dep_count#551 as double) / cast(hd_vehicle_count#552 as double)) ELSE cast(null as double) END > cast(1 as double))) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_county#687 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
         :        +- Join Inner
         :           :- Join Inner
         :           :  :- Join Inner
         :           :  :  :- SubqueryAlias `store_sales`
         :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :           :  :  +- SubqueryAlias `date_dim`
         :           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :           :  +- SubqueryAlias `store`
         :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :           +- SubqueryAlias `household_demographics`
         :              +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         +- SubqueryAlias `customer`
            +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/10/04 09:42:06 INFO Query: 
== Query: q73-v2.4 ==
Sort [cnt#42289L DESC NULLS LAST, c_last_name#421 ASC NULLS FIRST], true
+- Project [c_last_name#421, c_first_name#420, c_salutation#419, c_preferred_cust_flag#422, ss_ticket_number#139L, cnt#42289L]
   +- Filter ((ss_customer_sk#133 = c_customer_sk#412) && ((cnt#42289L >= cast(1 as bigint)) && (cnt#42289L <= cast(5 as bigint))))
      +- Join Inner
         :- SubqueryAlias `dj`
         :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133], [ss_ticket_number#139L, ss_customer_sk#133, count(1) AS cnt#42289L]
         :     +- Filter (((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (((d_dom#501 >= 1) && (d_dom#501 <= 2)) && ((hd_buy_potential#550 = >10000) || (hd_buy_potential#550 = unknown)))) && (((hd_vehicle_count#552 > 0) && (CASE WHEN (hd_vehicle_count#552 > 0) THEN (cast(hd_dep_count#551 as double) / cast(hd_vehicle_count#552 as double)) ELSE cast(null as double) END > cast(1 as double))) && (d_year#498 IN (1999,(1999 + 1),(1999 + 2)) && s_county#687 IN (Williamson County,Franklin Parish,Bronx County,Orange County))))
         :        +- Join Inner
         :           :- Join Inner
         :           :  :- Join Inner
         :           :  :  :- SubqueryAlias `store_sales`
         :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :           :  :  +- SubqueryAlias `date_dim`
         :           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :           :  +- SubqueryAlias `store`
         :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :           +- SubqueryAlias `household_demographics`
         :              +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         +- SubqueryAlias `customer`
            +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 96.574729433s
Running execution q74-v2.4 iteration: 1, StandardRun=true
19/10/04 09:43:47 INFO Query: 
== Query: q74-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#42380 ASC NULLS FIRST, customer_id#42380 ASC NULLS FIRST, customer_id#42380 ASC NULLS FIRST], true
      +- Project [customer_id#42380, customer_first_name#42381, customer_last_name#42382]
         +- Filter (((((customer_id#42380 = customer_id#42366) && (customer_id#42366 = customer_id#42392)) && ((customer_id#42366 = customer_id#42386) && (sale_type#42371 = s))) && (((sale_type#42391 = w) && (sale_type#42385 = s)) && (sale_type#42397 = w))) && ((((year#42369 = 2001) && (year#42383 = (2001 + 1))) && ((year#42389 = 2001) && (year#42395 = (2001 + 1)))) && (((cast(year_total#42370 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) && (cast(year_total#42390 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2)))) && (CASE WHEN (cast(year_total#42390 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(year_total#42396 as decimal(17,2))) / promote_precision(cast(year_total#42390 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END > CASE WHEN (cast(year_total#42370 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(year_total#42384 as decimal(17,2))) / promote_precision(cast(year_total#42370 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `t_s_firstyear`
               :  :  :  +- SubqueryAlias `year_total`
               :  :  :     +- Union
               :  :  :        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42366, c_first_name#420 AS customer_first_name#42367, c_last_name#421 AS customer_last_name#42368, d_year#498 AS year#42369, sum(ss_net_paid#150) AS year_total#42370, s AS sale_type#42371]
               :  :  :        :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :  :        :     +- Join Inner
               :  :  :        :        :- Join Inner
               :  :  :        :        :  :- SubqueryAlias `customer`
               :  :  :        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :        :        :  +- SubqueryAlias `store_sales`
               :  :  :        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :        :        +- SubqueryAlias `date_dim`
               :  :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42372, c_first_name#420 AS customer_first_name#42373, c_last_name#421 AS customer_last_name#42374, d_year#498 AS year#42375, sum(ws_net_paid#245) AS year_total#42376, w AS sale_type#42377]
               :  :  :           +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :  :              +- Join Inner
               :  :  :                 :- Join Inner
               :  :  :                 :  :- SubqueryAlias `customer`
               :  :  :                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :                 :  +- SubqueryAlias `web_sales`
               :  :  :                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :                 +- SubqueryAlias `date_dim`
               :  :  :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  +- SubqueryAlias `t_s_secyear`
               :  :     +- SubqueryAlias `year_total`
               :  :        +- Union
               :  :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42380, c_first_name#420 AS customer_first_name#42381, c_last_name#421 AS customer_last_name#42382, d_year#498 AS year#42383, sum(ss_net_paid#150) AS year_total#42384, s AS sale_type#42385]
               :  :           :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :           :     +- Join Inner
               :  :           :        :- Join Inner
               :  :           :        :  :- SubqueryAlias `customer`
               :  :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :        :  +- SubqueryAlias `store_sales`
               :  :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :        +- SubqueryAlias `date_dim`
               :  :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42372, c_first_name#420 AS customer_first_name#42373, c_last_name#421 AS customer_last_name#42374, d_year#498 AS year#42375, sum(ws_net_paid#245) AS year_total#42376, w AS sale_type#42377]
               :  :              +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :                 +- Join Inner
               :  :                    :- Join Inner
               :  :                    :  :- SubqueryAlias `customer`
               :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :                    :  +- SubqueryAlias `web_sales`
               :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :                    +- SubqueryAlias `date_dim`
               :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `t_w_firstyear`
               :     +- SubqueryAlias `year_total`
               :        +- Union
               :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42386, c_first_name#420 AS customer_first_name#42387, c_last_name#421 AS customer_last_name#42388, d_year#498 AS year#42389, sum(ss_net_paid#150) AS year_total#42390, s AS sale_type#42391]
               :           :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :           :     +- Join Inner
               :           :        :- Join Inner
               :           :        :  :- SubqueryAlias `customer`
               :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :        :  +- SubqueryAlias `store_sales`
               :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42372, c_first_name#420 AS customer_first_name#42373, c_last_name#421 AS customer_last_name#42374, d_year#498 AS year#42375, sum(ws_net_paid#245) AS year_total#42376, w AS sale_type#42377]
               :              +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :                 +- Join Inner
               :                    :- Join Inner
               :                    :  :- SubqueryAlias `customer`
               :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :                    :  +- SubqueryAlias `web_sales`
               :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `t_w_secyear`
                  +- SubqueryAlias `year_total`
                     +- Union
                        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42392, c_first_name#420 AS customer_first_name#42393, c_last_name#421 AS customer_last_name#42394, d_year#498 AS year#42395, sum(ss_net_paid#150) AS year_total#42396, s AS sale_type#42397]
                        :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
                        :     +- Join Inner
                        :        :- Join Inner
                        :        :  :- SubqueryAlias `customer`
                        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :        :  +- SubqueryAlias `store_sales`
                        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42372, c_first_name#420 AS customer_first_name#42373, c_last_name#421 AS customer_last_name#42374, d_year#498 AS year#42375, sum(ws_net_paid#245) AS year_total#42376, w AS sale_type#42377]
                           +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `customer`
                                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                                 :  +- SubqueryAlias `web_sales`
                                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/04 09:43:47 INFO Query: 
== Query: q74-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [customer_id#42415 ASC NULLS FIRST, customer_id#42415 ASC NULLS FIRST, customer_id#42415 ASC NULLS FIRST], true
      +- Project [customer_id#42415, customer_first_name#42416, customer_last_name#42417]
         +- Filter (((((customer_id#42415 = customer_id#42401) && (customer_id#42401 = customer_id#42427)) && ((customer_id#42401 = customer_id#42421) && (sale_type#42406 = s))) && (((sale_type#42426 = w) && (sale_type#42420 = s)) && (sale_type#42432 = w))) && ((((year#42404 = 2001) && (year#42418 = (2001 + 1))) && ((year#42424 = 2001) && (year#42430 = (2001 + 1)))) && (((cast(year_total#42405 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) && (cast(year_total#42425 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2)))) && (CASE WHEN (cast(year_total#42425 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(year_total#42431 as decimal(17,2))) / promote_precision(cast(year_total#42425 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END > CASE WHEN (cast(year_total#42405 as decimal(17,2)) > cast(cast(0 as decimal(1,0)) as decimal(17,2))) THEN CheckOverflow((promote_precision(cast(year_total#42419 as decimal(17,2))) / promote_precision(cast(year_total#42405 as decimal(17,2)))), DecimalType(37,20)) ELSE cast(null as decimal(37,20)) END))))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `t_s_firstyear`
               :  :  :  +- SubqueryAlias `year_total`
               :  :  :     +- Union
               :  :  :        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42401, c_first_name#420 AS customer_first_name#42402, c_last_name#421 AS customer_last_name#42403, d_year#498 AS year#42404, sum(ss_net_paid#150) AS year_total#42405, s AS sale_type#42406]
               :  :  :        :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :  :        :     +- Join Inner
               :  :  :        :        :- Join Inner
               :  :  :        :        :  :- SubqueryAlias `customer`
               :  :  :        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :        :        :  +- SubqueryAlias `store_sales`
               :  :  :        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  :        :        +- SubqueryAlias `date_dim`
               :  :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  :        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42407, c_first_name#420 AS customer_first_name#42408, c_last_name#421 AS customer_last_name#42409, d_year#498 AS year#42410, sum(ws_net_paid#245) AS year_total#42411, w AS sale_type#42412]
               :  :  :           +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :  :              +- Join Inner
               :  :  :                 :- Join Inner
               :  :  :                 :  :- SubqueryAlias `customer`
               :  :  :                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :  :                 :  +- SubqueryAlias `web_sales`
               :  :  :                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :  :                 +- SubqueryAlias `date_dim`
               :  :  :                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :  +- SubqueryAlias `t_s_secyear`
               :  :     +- SubqueryAlias `year_total`
               :  :        +- Union
               :  :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42415, c_first_name#420 AS customer_first_name#42416, c_last_name#421 AS customer_last_name#42417, d_year#498 AS year#42418, sum(ss_net_paid#150) AS year_total#42419, s AS sale_type#42420]
               :  :           :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :           :     +- Join Inner
               :  :           :        :- Join Inner
               :  :           :        :  :- SubqueryAlias `customer`
               :  :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :           :        :  +- SubqueryAlias `store_sales`
               :  :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :           :        +- SubqueryAlias `date_dim`
               :  :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42407, c_first_name#420 AS customer_first_name#42408, c_last_name#421 AS customer_last_name#42409, d_year#498 AS year#42410, sum(ws_net_paid#245) AS year_total#42411, w AS sale_type#42412]
               :  :              +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :  :                 +- Join Inner
               :  :                    :- Join Inner
               :  :                    :  :- SubqueryAlias `customer`
               :  :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :  :                    :  +- SubqueryAlias `web_sales`
               :  :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :                    +- SubqueryAlias `date_dim`
               :  :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `t_w_firstyear`
               :     +- SubqueryAlias `year_total`
               :        +- Union
               :           :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42421, c_first_name#420 AS customer_first_name#42422, c_last_name#421 AS customer_last_name#42423, d_year#498 AS year#42424, sum(ss_net_paid#150) AS year_total#42425, s AS sale_type#42426]
               :           :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :           :     +- Join Inner
               :           :        :- Join Inner
               :           :        :  :- SubqueryAlias `customer`
               :           :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :           :        :  +- SubqueryAlias `store_sales`
               :           :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42407, c_first_name#420 AS customer_first_name#42408, c_last_name#421 AS customer_last_name#42409, d_year#498 AS year#42410, sum(ws_net_paid#245) AS year_total#42411, w AS sale_type#42412]
               :              +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
               :                 +- Join Inner
               :                    :- Join Inner
               :                    :  :- SubqueryAlias `customer`
               :                    :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
               :                    :  +- SubqueryAlias `web_sales`
               :                    :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                    +- SubqueryAlias `date_dim`
               :                       +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `t_w_secyear`
                  +- SubqueryAlias `year_total`
                     +- Union
                        :- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42427, c_first_name#420 AS customer_first_name#42428, c_last_name#421 AS customer_last_name#42429, d_year#498 AS year#42430, sum(ss_net_paid#150) AS year_total#42431, s AS sale_type#42432]
                        :  +- Filter (((c_customer_sk#412 = ss_customer_sk#133) && (ss_sold_date_sk#130 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
                        :     +- Join Inner
                        :        :- Join Inner
                        :        :  :- SubqueryAlias `customer`
                        :        :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :        :  +- SubqueryAlias `store_sales`
                        :        :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Aggregate [c_customer_id#413, c_first_name#420, c_last_name#421, d_year#498], [c_customer_id#413 AS customer_id#42407, c_first_name#420 AS customer_first_name#42408, c_last_name#421 AS customer_last_name#42409, d_year#498 AS year#42410, sum(ws_net_paid#245) AS year_total#42411, w AS sale_type#42412]
                           +- Filter (((c_customer_sk#412 = ws_bill_customer_sk#220) && (ws_sold_date_sk#216 = d_date_sk#492)) && d_year#498 IN (2001,(2001 + 1)))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- SubqueryAlias `customer`
                                 :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                                 :  +- SubqueryAlias `web_sales`
                                 :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                 +- SubqueryAlias `date_dim`
                                    +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 965.001599372s
Running execution q75-v2.4 iteration: 1, StandardRun=true
19/10/04 09:59:57 INFO Query: 
== Query: q75-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [sales_cnt_diff#42952L ASC NULLS FIRST], true
      +- Project [d_year#43272 AS prev_year#42948, d_year#498 AS year#42949, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, sales_cnt#42964L AS prev_yr_cnt#42950L, sales_cnt#42960L AS curr_yr_cnt#42951L, (sales_cnt#42960L - sales_cnt#42964L) AS sales_cnt_diff#42952L, CheckOverflow((promote_precision(cast(sales_amt#42961 as decimal(19,2))) - promote_precision(cast(sales_amt#42965 as decimal(19,2)))), DecimalType(19,2)) AS sales_amt_diff#42953]
         +- Filter ((((i_brand_id#571 = i_brand_id#43123) && (i_class_id#573 = i_class_id#43125)) && ((i_category_id#575 = i_category_id#43127) && (i_manufact_id#577 = i_manufact_id#43129))) && (((d_year#498 = 2002) && (d_year#43272 = (2002 - 1))) && (cast(CheckOverflow((promote_precision(cast(cast(sales_cnt#42960L as decimal(17,2)) as decimal(17,2))) / promote_precision(cast(cast(sales_cnt#42964L as decimal(17,2)) as decimal(17,2)))), DecimalType(37,20)) as decimal(37,20)) < cast(0.9 as decimal(37,20)))))
            +- Join Inner
               :- SubqueryAlias `curr_yr`
               :  +- SubqueryAlias `all_sales`
               :     +- Aggregate [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577], [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, sum(cast(sales_cnt#42954 as bigint)) AS sales_cnt#42960L, sum(sales_amt#42955) AS sales_amt#42961]
               :        +- SubqueryAlias `sales_detail`
               :           +- Distinct
               :              +- Union
               :                 :- Distinct
               :                 :  +- Union
               :                 :     :- Project [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, (cs_quantity#18 - coalesce(cr_return_quantity#85, 0)) AS sales_cnt#42954, CheckOverflow((promote_precision(cast(cs_ext_sales_price#23 as decimal(8,2))) - promote_precision(cast(coalesce(cr_return_amount#86, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#42955]
               :                 :     :  +- Filter (i_category#576 = Books)
               :                 :     :     +- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
               :                 :     :        :- Join Inner, (d_date_sk#492 = cs_sold_date_sk#0)
               :                 :     :        :  :- Join Inner, (i_item_sk#564 = cs_item_sk#15)
               :                 :     :        :  :  :- SubqueryAlias `catalog_sales`
               :                 :     :        :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :     :        :  :  +- SubqueryAlias `item`
               :                 :     :        :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                 :     :        :  +- SubqueryAlias `date_dim`
               :                 :     :        :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :     :        +- SubqueryAlias `catalog_returns`
               :                 :     :           +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               :                 :     +- Project [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, (ss_quantity#140 - coalesce(sr_return_quantity#186, 0)) AS sales_cnt#42956, CheckOverflow((promote_precision(cast(ss_ext_sales_price#145 as decimal(8,2))) - promote_precision(cast(coalesce(sr_return_amt#187, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#42957]
               :                 :        +- Filter (i_category#576 = Books)
               :                 :           +- Join LeftOuter, ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))
               :                 :              :- Join Inner, (d_date_sk#492 = ss_sold_date_sk#130)
               :                 :              :  :- Join Inner, (i_item_sk#564 = ss_item_sk#132)
               :                 :              :  :  :- SubqueryAlias `store_sales`
               :                 :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :                 :              :  :  +- SubqueryAlias `item`
               :                 :              :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                 :              :  +- SubqueryAlias `date_dim`
               :                 :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :              +- SubqueryAlias `store_returns`
               :                 :                 +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :                 +- Project [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, (ws_quantity#234 - coalesce(wr_return_quantity#298, 0)) AS sales_cnt#42958, CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(8,2))) - promote_precision(cast(coalesce(wr_return_amt#299, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#42959]
               :                    +- Filter (i_category#576 = Books)
               :                       +- Join LeftOuter, ((ws_order_number#233L = wr_order_number#297L) && (ws_item_sk#219 = wr_item_sk#286))
               :                          :- Join Inner, (d_date_sk#492 = ws_sold_date_sk#216)
               :                          :  :- Join Inner, (i_item_sk#564 = ws_item_sk#219)
               :                          :  :  :- SubqueryAlias `web_sales`
               :                          :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                          :  :  +- SubqueryAlias `item`
               :                          :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                          :  +- SubqueryAlias `date_dim`
               :                          :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                          +- SubqueryAlias `web_returns`
               :                             +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               +- SubqueryAlias `prev_yr`
                  +- SubqueryAlias `all_sales`
                     +- Aggregate [d_year#43272, i_brand_id#43123, i_class_id#43125, i_category_id#43127, i_manufact_id#43129], [d_year#43272, i_brand_id#43123, i_class_id#43125, i_category_id#43127, i_manufact_id#43129, sum(cast(sales_cnt#42954 as bigint)) AS sales_cnt#42964L, sum(sales_amt#42955) AS sales_amt#42965]
                        +- SubqueryAlias `sales_detail`
                           +- Distinct
                              +- Union
                                 :- Distinct
                                 :  +- Union
                                 :     :- Project [d_year#43272, i_brand_id#43123, i_class_id#43125, i_category_id#43127, i_manufact_id#43129, (cs_quantity#18 - coalesce(cr_return_quantity#85, 0)) AS sales_cnt#42954, CheckOverflow((promote_precision(cast(cs_ext_sales_price#23 as decimal(8,2))) - promote_precision(cast(coalesce(cr_return_amount#86, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#42955]
                                 :     :  +- Filter (i_category#43128 = Books)
                                 :     :     +- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
                                 :     :        :- Join Inner, (d_date_sk#43266 = cs_sold_date_sk#0)
                                 :     :        :  :- Join Inner, (i_item_sk#43116 = cs_item_sk#15)
                                 :     :        :  :  :- SubqueryAlias `catalog_sales`
                                 :     :        :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                                 :     :        :  :  +- SubqueryAlias `item`
                                 :     :        :  :     +- Relation[i_item_sk#43116,i_item_id#43117,i_rec_start_date#43118,i_rec_end_date#43119,i_item_desc#43120,i_current_price#43121,i_wholesale_cost#43122,i_brand_id#43123,i_brand#43124,i_class_id#43125,i_class#43126,i_category_id#43127,i_category#43128,i_manufact_id#43129,i_manufact#43130,i_size#43131,i_formulation#43132,i_color#43133,i_units#43134,i_container#43135,i_manager_id#43136,i_product_name#43137] parquet
                                 :     :        :  +- SubqueryAlias `date_dim`
                                 :     :        :     +- Relation[d_date_sk#43266,d_date_id#43267,d_date#43268,d_month_seq#43269,d_week_seq#43270,d_quarter_seq#43271,d_year#43272,d_dow#43273,d_moy#43274,d_dom#43275,d_qoy#43276,d_fy_year#43277,d_fy_quarter_seq#43278,d_fy_week_seq#43279,d_day_name#43280,d_quarter_name#43281,d_holiday#43282,d_weekend#43283,d_following_holiday#43284,d_first_dom#43285,d_last_dom#43286,d_same_day_ly#43287,d_same_day_lq#43288,d_current_day#43289,... 4 more fields] parquet
                                 :     :        +- SubqueryAlias `catalog_returns`
                                 :     :           +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                                 :     +- Project [d_year#43272, i_brand_id#43123, i_class_id#43125, i_category_id#43127, i_manufact_id#43129, (ss_quantity#140 - coalesce(sr_return_quantity#186, 0)) AS sales_cnt#42956, CheckOverflow((promote_precision(cast(ss_ext_sales_price#145 as decimal(8,2))) - promote_precision(cast(coalesce(sr_return_amt#187, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#42957]
                                 :        +- Filter (i_category#43128 = Books)
                                 :           +- Join LeftOuter, ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))
                                 :              :- Join Inner, (d_date_sk#43266 = ss_sold_date_sk#130)
                                 :              :  :- Join Inner, (i_item_sk#43116 = ss_item_sk#132)
                                 :              :  :  :- SubqueryAlias `store_sales`
                                 :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :              :  :  +- SubqueryAlias `item`
                                 :              :  :     +- Relation[i_item_sk#43116,i_item_id#43117,i_rec_start_date#43118,i_rec_end_date#43119,i_item_desc#43120,i_current_price#43121,i_wholesale_cost#43122,i_brand_id#43123,i_brand#43124,i_class_id#43125,i_class#43126,i_category_id#43127,i_category#43128,i_manufact_id#43129,i_manufact#43130,i_size#43131,i_formulation#43132,i_color#43133,i_units#43134,i_container#43135,i_manager_id#43136,i_product_name#43137] parquet
                                 :              :  +- SubqueryAlias `date_dim`
                                 :              :     +- Relation[d_date_sk#43266,d_date_id#43267,d_date#43268,d_month_seq#43269,d_week_seq#43270,d_quarter_seq#43271,d_year#43272,d_dow#43273,d_moy#43274,d_dom#43275,d_qoy#43276,d_fy_year#43277,d_fy_quarter_seq#43278,d_fy_week_seq#43279,d_day_name#43280,d_quarter_name#43281,d_holiday#43282,d_weekend#43283,d_following_holiday#43284,d_first_dom#43285,d_last_dom#43286,d_same_day_ly#43287,d_same_day_lq#43288,d_current_day#43289,... 4 more fields] parquet
                                 :              +- SubqueryAlias `store_returns`
                                 :                 +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                                 +- Project [d_year#43272, i_brand_id#43123, i_class_id#43125, i_category_id#43127, i_manufact_id#43129, (ws_quantity#234 - coalesce(wr_return_quantity#298, 0)) AS sales_cnt#42958, CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(8,2))) - promote_precision(cast(coalesce(wr_return_amt#299, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#42959]
                                    +- Filter (i_category#43128 = Books)
                                       +- Join LeftOuter, ((ws_order_number#233L = wr_order_number#297L) && (ws_item_sk#219 = wr_item_sk#286))
                                          :- Join Inner, (d_date_sk#43266 = ws_sold_date_sk#216)
                                          :  :- Join Inner, (i_item_sk#43116 = ws_item_sk#219)
                                          :  :  :- SubqueryAlias `web_sales`
                                          :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                          :  :  +- SubqueryAlias `item`
                                          :  :     +- Relation[i_item_sk#43116,i_item_id#43117,i_rec_start_date#43118,i_rec_end_date#43119,i_item_desc#43120,i_current_price#43121,i_wholesale_cost#43122,i_brand_id#43123,i_brand#43124,i_class_id#43125,i_class#43126,i_category_id#43127,i_category#43128,i_manufact_id#43129,i_manufact#43130,i_size#43131,i_formulation#43132,i_color#43133,i_units#43134,i_container#43135,i_manager_id#43136,i_product_name#43137] parquet
                                          :  +- SubqueryAlias `date_dim`
                                          :     +- Relation[d_date_sk#43266,d_date_id#43267,d_date#43268,d_month_seq#43269,d_week_seq#43270,d_quarter_seq#43271,d_year#43272,d_dow#43273,d_moy#43274,d_dom#43275,d_qoy#43276,d_fy_year#43277,d_fy_quarter_seq#43278,d_fy_week_seq#43279,d_day_name#43280,d_quarter_name#43281,d_holiday#43282,d_weekend#43283,d_following_holiday#43284,d_first_dom#43285,d_last_dom#43286,d_same_day_ly#43287,d_same_day_lq#43288,d_current_day#43289,... 4 more fields] parquet
                                          +- SubqueryAlias `web_returns`
                                             +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet

     : benchmark
19/10/04 09:59:57 INFO Query: 
== Query: q75-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [sales_cnt_diff#43364L ASC NULLS FIRST], true
      +- Project [d_year#43684 AS prev_year#43360, d_year#498 AS year#43361, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, sales_cnt#43376L AS prev_yr_cnt#43362L, sales_cnt#43372L AS curr_yr_cnt#43363L, (sales_cnt#43372L - sales_cnt#43376L) AS sales_cnt_diff#43364L, CheckOverflow((promote_precision(cast(sales_amt#43373 as decimal(19,2))) - promote_precision(cast(sales_amt#43377 as decimal(19,2)))), DecimalType(19,2)) AS sales_amt_diff#43365]
         +- Filter ((((i_brand_id#571 = i_brand_id#43535) && (i_class_id#573 = i_class_id#43537)) && ((i_category_id#575 = i_category_id#43539) && (i_manufact_id#577 = i_manufact_id#43541))) && (((d_year#498 = 2002) && (d_year#43684 = (2002 - 1))) && (cast(CheckOverflow((promote_precision(cast(cast(sales_cnt#43372L as decimal(17,2)) as decimal(17,2))) / promote_precision(cast(cast(sales_cnt#43376L as decimal(17,2)) as decimal(17,2)))), DecimalType(37,20)) as decimal(37,20)) < cast(0.9 as decimal(37,20)))))
            +- Join Inner
               :- SubqueryAlias `curr_yr`
               :  +- SubqueryAlias `all_sales`
               :     +- Aggregate [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577], [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, sum(cast(sales_cnt#43366 as bigint)) AS sales_cnt#43372L, sum(sales_amt#43367) AS sales_amt#43373]
               :        +- SubqueryAlias `sales_detail`
               :           +- Distinct
               :              +- Union
               :                 :- Distinct
               :                 :  +- Union
               :                 :     :- Project [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, (cs_quantity#18 - coalesce(cr_return_quantity#85, 0)) AS sales_cnt#43366, CheckOverflow((promote_precision(cast(cs_ext_sales_price#23 as decimal(8,2))) - promote_precision(cast(coalesce(cr_return_amount#86, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43367]
               :                 :     :  +- Filter (i_category#576 = Books)
               :                 :     :     +- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
               :                 :     :        :- Join Inner, (d_date_sk#492 = cs_sold_date_sk#0)
               :                 :     :        :  :- Join Inner, (i_item_sk#564 = cs_item_sk#15)
               :                 :     :        :  :  :- SubqueryAlias `catalog_sales`
               :                 :     :        :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
               :                 :     :        :  :  +- SubqueryAlias `item`
               :                 :     :        :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                 :     :        :  +- SubqueryAlias `date_dim`
               :                 :     :        :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :     :        +- SubqueryAlias `catalog_returns`
               :                 :     :           +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               :                 :     +- Project [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, (ss_quantity#140 - coalesce(sr_return_quantity#186, 0)) AS sales_cnt#43368, CheckOverflow((promote_precision(cast(ss_ext_sales_price#145 as decimal(8,2))) - promote_precision(cast(coalesce(sr_return_amt#187, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43369]
               :                 :        +- Filter (i_category#576 = Books)
               :                 :           +- Join LeftOuter, ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))
               :                 :              :- Join Inner, (d_date_sk#492 = ss_sold_date_sk#130)
               :                 :              :  :- Join Inner, (i_item_sk#564 = ss_item_sk#132)
               :                 :              :  :  :- SubqueryAlias `store_sales`
               :                 :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :                 :              :  :  +- SubqueryAlias `item`
               :                 :              :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                 :              :  +- SubqueryAlias `date_dim`
               :                 :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                 :              +- SubqueryAlias `store_returns`
               :                 :                 +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :                 +- Project [d_year#498, i_brand_id#571, i_class_id#573, i_category_id#575, i_manufact_id#577, (ws_quantity#234 - coalesce(wr_return_quantity#298, 0)) AS sales_cnt#43370, CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(8,2))) - promote_precision(cast(coalesce(wr_return_amt#299, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43371]
               :                    +- Filter (i_category#576 = Books)
               :                       +- Join LeftOuter, ((ws_order_number#233L = wr_order_number#297L) && (ws_item_sk#219 = wr_item_sk#286))
               :                          :- Join Inner, (d_date_sk#492 = ws_sold_date_sk#216)
               :                          :  :- Join Inner, (i_item_sk#564 = ws_item_sk#219)
               :                          :  :  :- SubqueryAlias `web_sales`
               :                          :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                          :  :  +- SubqueryAlias `item`
               :                          :  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :                          :  +- SubqueryAlias `date_dim`
               :                          :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :                          +- SubqueryAlias `web_returns`
               :                             +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               +- SubqueryAlias `prev_yr`
                  +- SubqueryAlias `all_sales`
                     +- Aggregate [d_year#43684, i_brand_id#43535, i_class_id#43537, i_category_id#43539, i_manufact_id#43541], [d_year#43684, i_brand_id#43535, i_class_id#43537, i_category_id#43539, i_manufact_id#43541, sum(cast(sales_cnt#43366 as bigint)) AS sales_cnt#43376L, sum(sales_amt#43367) AS sales_amt#43377]
                        +- SubqueryAlias `sales_detail`
                           +- Distinct
                              +- Union
                                 :- Distinct
                                 :  +- Union
                                 :     :- Project [d_year#43684, i_brand_id#43535, i_class_id#43537, i_category_id#43539, i_manufact_id#43541, (cs_quantity#18 - coalesce(cr_return_quantity#85, 0)) AS sales_cnt#43366, CheckOverflow((promote_precision(cast(cs_ext_sales_price#23 as decimal(8,2))) - promote_precision(cast(coalesce(cr_return_amount#86, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43367]
                                 :     :  +- Filter (i_category#43540 = Books)
                                 :     :     +- Join LeftOuter, ((cs_order_number#17L = cr_order_number#84L) && (cs_item_sk#15 = cr_item_sk#70))
                                 :     :        :- Join Inner, (d_date_sk#43678 = cs_sold_date_sk#0)
                                 :     :        :  :- Join Inner, (i_item_sk#43528 = cs_item_sk#15)
                                 :     :        :  :  :- SubqueryAlias `catalog_sales`
                                 :     :        :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                                 :     :        :  :  +- SubqueryAlias `item`
                                 :     :        :  :     +- Relation[i_item_sk#43528,i_item_id#43529,i_rec_start_date#43530,i_rec_end_date#43531,i_item_desc#43532,i_current_price#43533,i_wholesale_cost#43534,i_brand_id#43535,i_brand#43536,i_class_id#43537,i_class#43538,i_category_id#43539,i_category#43540,i_manufact_id#43541,i_manufact#43542,i_size#43543,i_formulation#43544,i_color#43545,i_units#43546,i_container#43547,i_manager_id#43548,i_product_name#43549] parquet
                                 :     :        :  +- SubqueryAlias `date_dim`
                                 :     :        :     +- Relation[d_date_sk#43678,d_date_id#43679,d_date#43680,d_month_seq#43681,d_week_seq#43682,d_quarter_seq#43683,d_year#43684,d_dow#43685,d_moy#43686,d_dom#43687,d_qoy#43688,d_fy_year#43689,d_fy_quarter_seq#43690,d_fy_week_seq#43691,d_day_name#43692,d_quarter_name#43693,d_holiday#43694,d_weekend#43695,d_following_holiday#43696,d_first_dom#43697,d_last_dom#43698,d_same_day_ly#43699,d_same_day_lq#43700,d_current_day#43701,... 4 more fields] parquet
                                 :     :        +- SubqueryAlias `catalog_returns`
                                 :     :           +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                                 :     +- Project [d_year#43684, i_brand_id#43535, i_class_id#43537, i_category_id#43539, i_manufact_id#43541, (ss_quantity#140 - coalesce(sr_return_quantity#186, 0)) AS sales_cnt#43368, CheckOverflow((promote_precision(cast(ss_ext_sales_price#145 as decimal(8,2))) - promote_precision(cast(coalesce(sr_return_amt#187, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43369]
                                 :        +- Filter (i_category#43540 = Books)
                                 :           +- Join LeftOuter, ((ss_ticket_number#139L = sr_ticket_number#185L) && (ss_item_sk#132 = sr_item_sk#178))
                                 :              :- Join Inner, (d_date_sk#43678 = ss_sold_date_sk#130)
                                 :              :  :- Join Inner, (i_item_sk#43528 = ss_item_sk#132)
                                 :              :  :  :- SubqueryAlias `store_sales`
                                 :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :              :  :  +- SubqueryAlias `item`
                                 :              :  :     +- Relation[i_item_sk#43528,i_item_id#43529,i_rec_start_date#43530,i_rec_end_date#43531,i_item_desc#43532,i_current_price#43533,i_wholesale_cost#43534,i_brand_id#43535,i_brand#43536,i_class_id#43537,i_class#43538,i_category_id#43539,i_category#43540,i_manufact_id#43541,i_manufact#43542,i_size#43543,i_formulation#43544,i_color#43545,i_units#43546,i_container#43547,i_manager_id#43548,i_product_name#43549] parquet
                                 :              :  +- SubqueryAlias `date_dim`
                                 :              :     +- Relation[d_date_sk#43678,d_date_id#43679,d_date#43680,d_month_seq#43681,d_week_seq#43682,d_quarter_seq#43683,d_year#43684,d_dow#43685,d_moy#43686,d_dom#43687,d_qoy#43688,d_fy_year#43689,d_fy_quarter_seq#43690,d_fy_week_seq#43691,d_day_name#43692,d_quarter_name#43693,d_holiday#43694,d_weekend#43695,d_following_holiday#43696,d_first_dom#43697,d_last_dom#43698,d_same_day_ly#43699,d_same_day_lq#43700,d_current_day#43701,... 4 more fields] parquet
                                 :              +- SubqueryAlias `store_returns`
                                 :                 +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                                 +- Project [d_year#43684, i_brand_id#43535, i_class_id#43537, i_category_id#43539, i_manufact_id#43541, (ws_quantity#234 - coalesce(wr_return_quantity#298, 0)) AS sales_cnt#43370, CheckOverflow((promote_precision(cast(ws_ext_sales_price#239 as decimal(8,2))) - promote_precision(cast(coalesce(wr_return_amt#299, cast(0.0 as decimal(7,2))) as decimal(8,2)))), DecimalType(8,2)) AS sales_amt#43371]
                                    +- Filter (i_category#43540 = Books)
                                       +- Join LeftOuter, ((ws_order_number#233L = wr_order_number#297L) && (ws_item_sk#219 = wr_item_sk#286))
                                          :- Join Inner, (d_date_sk#43678 = ws_sold_date_sk#216)
                                          :  :- Join Inner, (i_item_sk#43528 = ws_item_sk#219)
                                          :  :  :- SubqueryAlias `web_sales`
                                          :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                          :  :  +- SubqueryAlias `item`
                                          :  :     +- Relation[i_item_sk#43528,i_item_id#43529,i_rec_start_date#43530,i_rec_end_date#43531,i_item_desc#43532,i_current_price#43533,i_wholesale_cost#43534,i_brand_id#43535,i_brand#43536,i_class_id#43537,i_class#43538,i_category_id#43539,i_category#43540,i_manufact_id#43541,i_manufact#43542,i_size#43543,i_formulation#43544,i_color#43545,i_units#43546,i_container#43547,i_manager_id#43548,i_product_name#43549] parquet
                                          :  +- SubqueryAlias `date_dim`
                                          :     +- Relation[d_date_sk#43678,d_date_id#43679,d_date#43680,d_month_seq#43681,d_week_seq#43682,d_quarter_seq#43683,d_year#43684,d_dow#43685,d_moy#43686,d_dom#43687,d_qoy#43688,d_fy_year#43689,d_fy_quarter_seq#43690,d_fy_week_seq#43691,d_day_name#43692,d_quarter_name#43693,d_holiday#43694,d_weekend#43695,d_following_holiday#43696,d_first_dom#43697,d_last_dom#43698,d_same_day_ly#43699,d_same_day_lq#43700,d_current_day#43701,... 4 more fields] parquet
                                          +- SubqueryAlias `web_returns`
                                             +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet

      running Thread[benchmark runner,5,main]
Execution time: 686.1222010729999s
Running execution q76-v2.4 iteration: 1, StandardRun=true
19/10/04 10:11:26 INFO Query: 
== Query: q76-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [channel#44640, col_name#44641, d_year#498, d_qoy#502, i_category#576, sales_cnt#44649L, sales_amt#44650]
      +- Sort [channel#44640 ASC NULLS FIRST, col_name#44641 ASC NULLS FIRST, d_year#498 ASC NULLS FIRST, d_qoy#502 ASC NULLS FIRST, i_category#576 ASC NULLS FIRST], true
         +- Aggregate [channel#44640, col_name#44641, d_year#498, d_qoy#502, i_category#576], [channel#44640, col_name#44641, d_year#498, d_qoy#502, i_category#576, count(1) AS sales_cnt#44649L, sum(ext_sales_price#44642) AS sales_amt#44650]
            +- SubqueryAlias `foo`
               +- Union
                  :- Union
                  :  :- Project [store AS channel#44640, ss_store_sk#137 AS col_name#44641, d_year#498, d_qoy#502, i_category#576, ss_ext_sales_price#145 AS ext_sales_price#44642]
                  :  :  +- Filter ((isnull(ss_store_sk#137) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_item_sk#132 = i_item_sk#564))
                  :  :     +- Join Inner
                  :  :        :- Join Inner
                  :  :        :  :- SubqueryAlias `store_sales`
                  :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :        :  +- SubqueryAlias `item`
                  :  :        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  :  :        +- SubqueryAlias `date_dim`
                  :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- Project [web AS channel#44643, ws_ship_customer_sk#224 AS col_name#44644, d_year#498, d_qoy#502, i_category#576, ws_ext_sales_price#239 AS ext_sales_price#44645]
                  :     +- Filter ((isnull(ws_ship_customer_sk#224) && (ws_sold_date_sk#216 = d_date_sk#492)) && (ws_item_sk#219 = i_item_sk#564))
                  :        +- Join Inner
                  :           :- Join Inner
                  :           :  :- SubqueryAlias `web_sales`
                  :           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :           :  +- SubqueryAlias `item`
                  :           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  :           +- SubqueryAlias `date_dim`
                  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- Project [catalog AS channel#44646, cs_ship_addr_sk#10 AS col_name#44647, d_year#498, d_qoy#502, i_category#576, cs_ext_sales_price#23 AS ext_sales_price#44648]
                     +- Filter ((isnull(cs_ship_addr_sk#10) && (cs_sold_date_sk#0 = d_date_sk#492)) && (cs_item_sk#15 = i_item_sk#564))
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `catalog_sales`
                           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :  +- SubqueryAlias `item`
                           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/04 10:11:26 INFO Query: 
== Query: q76-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [channel#44665, col_name#44666, d_year#498, d_qoy#502, i_category#576, sales_cnt#44674L, sales_amt#44675]
      +- Sort [channel#44665 ASC NULLS FIRST, col_name#44666 ASC NULLS FIRST, d_year#498 ASC NULLS FIRST, d_qoy#502 ASC NULLS FIRST, i_category#576 ASC NULLS FIRST], true
         +- Aggregate [channel#44665, col_name#44666, d_year#498, d_qoy#502, i_category#576], [channel#44665, col_name#44666, d_year#498, d_qoy#502, i_category#576, count(1) AS sales_cnt#44674L, sum(ext_sales_price#44667) AS sales_amt#44675]
            +- SubqueryAlias `foo`
               +- Union
                  :- Union
                  :  :- Project [store AS channel#44665, ss_store_sk#137 AS col_name#44666, d_year#498, d_qoy#502, i_category#576, ss_ext_sales_price#145 AS ext_sales_price#44667]
                  :  :  +- Filter ((isnull(ss_store_sk#137) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_item_sk#132 = i_item_sk#564))
                  :  :     +- Join Inner
                  :  :        :- Join Inner
                  :  :        :  :- SubqueryAlias `store_sales`
                  :  :        :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :        :  +- SubqueryAlias `item`
                  :  :        :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  :  :        +- SubqueryAlias `date_dim`
                  :  :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- Project [web AS channel#44668, ws_ship_customer_sk#224 AS col_name#44669, d_year#498, d_qoy#502, i_category#576, ws_ext_sales_price#239 AS ext_sales_price#44670]
                  :     +- Filter ((isnull(ws_ship_customer_sk#224) && (ws_sold_date_sk#216 = d_date_sk#492)) && (ws_item_sk#219 = i_item_sk#564))
                  :        +- Join Inner
                  :           :- Join Inner
                  :           :  :- SubqueryAlias `web_sales`
                  :           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :           :  +- SubqueryAlias `item`
                  :           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  :           +- SubqueryAlias `date_dim`
                  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- Project [catalog AS channel#44671, cs_ship_addr_sk#10 AS col_name#44672, d_year#498, d_qoy#502, i_category#576, cs_ext_sales_price#23 AS ext_sales_price#44673]
                     +- Filter ((isnull(cs_ship_addr_sk#10) && (cs_sold_date_sk#0 = d_date_sk#492)) && (cs_item_sk#15 = i_item_sk#564))
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `catalog_sales`
                           :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                           :  +- SubqueryAlias `item`
                           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 203.855857516s
Running execution q77-v2.4 iteration: 1, StandardRun=true
19/10/04 10:14:53 INFO Query: 
== Query: q77-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#44972 ASC NULLS FIRST, id#44973 ASC NULLS FIRST], true
      +- Aggregate [channel#44972, id#44973, spark_grouping_id#44969], [channel#44972, id#44973, sum(sales#44897) AS sales#44894, sum(returns#44885) AS returns#44895, sum(profit#44964) AS profit#44896]
         +- Expand [List(channel#44883, id#44884, sales#44897, returns#44885, profit#44964, channel#44970, id#44971, 0), List(channel#44883, id#44884, sales#44897, returns#44885, profit#44964, channel#44970, null, 1), List(channel#44883, id#44884, sales#44897, returns#44885, profit#44964, null, null, 3)], [channel#44883, id#44884, sales#44897, returns#44885, profit#44964, channel#44972, id#44973, spark_grouping_id#44969]
            +- Project [channel#44883, id#44884, sales#44897, returns#44885, profit#44964, channel#44883 AS channel#44970, id#44884 AS id#44971]
               +- SubqueryAlias `x`
                  +- Union
                     :- Project [channel#44883, id#44884, sales#44897, returns#44885, profit#44964]
                     :  +- Union
                     :     :- Project [channel#44883, id#44884, sales#44897, returns#44885, cast(profit#44886 as decimal(18,2)) AS profit#44964]
                     :     :  +- Project [store channel AS channel#44883, s_store_sk#664 AS id#44884, sales#44897, coalesce(returns#44899, cast(0 as decimal(17,2))) AS returns#44885, CheckOverflow((promote_precision(cast(profit#44898 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#44900, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS profit#44886]
                     :     :     +- Join LeftOuter, (s_store_sk#664 = s_store_sk#44921)
                     :     :        :- SubqueryAlias `ss`
                     :     :        :  +- Aggregate [s_store_sk#664], [s_store_sk#664, sum(ss_ext_sales_price#145) AS sales#44897, sum(ss_net_profit#152) AS profit#44898]
                     :     :        :     +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (ss_store_sk#137 = s_store_sk#664))
                     :     :        :        +- Join Inner
                     :     :        :           :- Join Inner
                     :     :        :           :  :- SubqueryAlias `store_sales`
                     :     :        :           :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :     :        :           :  +- SubqueryAlias `date_dim`
                     :     :        :           :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :     :        :           +- SubqueryAlias `store`
                     :     :        :              +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :     :        +- SubqueryAlias `sr`
                     :     :           +- Aggregate [s_store_sk#44921], [s_store_sk#44921, sum(sr_return_amt#187) AS returns#44899, sum(sr_net_loss#195) AS profit_loss#44900]
                     :     :              +- Filter (((sr_returned_date_sk#176 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (sr_store_sk#183 = s_store_sk#44921))
                     :     :                 +- Join Inner
                     :     :                    :- Join Inner
                     :     :                    :  :- SubqueryAlias `store_returns`
                     :     :                    :  :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :     :                    :  +- SubqueryAlias `date_dim`
                     :     :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :     :                    +- SubqueryAlias `store`
                     :     :                       +- Relation[s_store_sk#44921,s_store_id#44922,s_rec_start_date#44923,s_rec_end_date#44924,s_closed_date_sk#44925,s_store_name#44926,s_number_employees#44927,s_floor_space#44928,s_hours#44929,s_manager#44930,s_market_id#44931,s_geography_class#44932,s_market_desc#44933,s_market_manager#44934,s_division_id#44935,s_division_name#44936,s_company_id#44937,s_company_name#44938,s_street_number#44939,s_street_name#44940,s_street_type#44941,s_suite_number#44942,s_city#44943,s_county#44944,... 5 more fields] parquet
                     :     +- Project [channel#44887, id#44888, sales#44901, returns#44903, profit#44889]
                     :        +- Project [catalog channel AS channel#44887, cs_call_center_sk#11 AS id#44888, sales#44901, returns#44903, CheckOverflow((promote_precision(cast(profit#44902 as decimal(18,2))) - promote_precision(cast(profit_loss#44904 as decimal(18,2)))), DecimalType(18,2)) AS profit#44889]
                     :           +- Join Cross
                     :              :- SubqueryAlias `cs`
                     :              :  +- Aggregate [cs_call_center_sk#11], [cs_call_center_sk#11, sum(cs_ext_sales_price#23) AS sales#44901, sum(cs_net_profit#33) AS profit#44902]
                     :              :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date))))
                     :              :        +- Join Inner
                     :              :           :- SubqueryAlias `catalog_sales`
                     :              :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :              :           +- SubqueryAlias `date_dim`
                     :              :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              +- SubqueryAlias `cr`
                     :                 +- Aggregate [cr_call_center_sk#79], [cr_call_center_sk#79, sum(cr_return_amount#86) AS returns#44903, sum(cr_net_loss#94) AS profit_loss#44904]
                     :                    +- Filter ((cr_returned_date_sk#68 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date))))
                     :                       +- Join Inner
                     :                          :- SubqueryAlias `catalog_returns`
                     :                          :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                     :                          +- SubqueryAlias `date_dim`
                     :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- Project [channel#44890, id#44891, sales#44905, returns#44892, cast(profit#44893 as decimal(18,2)) AS profit#44965]
                        +- Project [web channel AS channel#44890, wp_web_page_sk#770 AS id#44891, sales#44905, coalesce(returns#44907, cast(0 as decimal(17,2))) AS returns#44892, CheckOverflow((promote_precision(cast(profit#44906 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#44908, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS profit#44893]
                           +- Join LeftOuter, (wp_web_page_sk#770 = wp_web_page_sk#44950)
                              :- SubqueryAlias `ws`
                              :  +- Aggregate [wp_web_page_sk#770], [wp_web_page_sk#770, sum(ws_ext_sales_price#239) AS sales#44905, sum(ws_net_profit#249) AS profit#44906]
                              :     +- Filter (((ws_sold_date_sk#216 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (ws_web_page_sk#228 = wp_web_page_sk#770))
                              :        +- Join Inner
                              :           :- Join Inner
                              :           :  :- SubqueryAlias `web_sales`
                              :           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :           :  +- SubqueryAlias `date_dim`
                              :           :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :           +- SubqueryAlias `web_page`
                              :              +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet
                              +- SubqueryAlias `wr`
                                 +- Aggregate [wp_web_page_sk#44950], [wp_web_page_sk#44950, sum(wr_return_amt#299) AS returns#44907, sum(wr_net_loss#307) AS profit_loss#44908]
                                    +- Filter (((wr_returned_date_sk#284 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (wr_web_page_sk#295 = wp_web_page_sk#44950))
                                       +- Join Inner
                                          :- Join Inner
                                          :  :- SubqueryAlias `web_returns`
                                          :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                                          :  +- SubqueryAlias `date_dim`
                                          :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                          +- SubqueryAlias `web_page`
                                             +- Relation[wp_web_page_sk#44950,wp_web_page_id#44951,wp_rec_start_date#44952,wp_rec_end_date#44953,wp_creation_date_sk#44954,wp_access_date_sk#44955,wp_autogen_flag#44956,wp_customer_sk#44957,wp_url#44958,wp_type#44959,wp_char_count#44960,wp_link_count#44961,wp_image_count#44962,wp_max_ad_count#44963] parquet

     : benchmark
19/10/04 10:14:53 INFO Query: 
== Query: q77-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#45070 ASC NULLS FIRST, id#45071 ASC NULLS FIRST], true
      +- Aggregate [channel#45070, id#45071, spark_grouping_id#45067], [channel#45070, id#45071, sum(sales#44995) AS sales#44992, sum(returns#44983) AS returns#44993, sum(profit#45062) AS profit#44994]
         +- Expand [List(channel#44981, id#44982, sales#44995, returns#44983, profit#45062, channel#45068, id#45069, 0), List(channel#44981, id#44982, sales#44995, returns#44983, profit#45062, channel#45068, null, 1), List(channel#44981, id#44982, sales#44995, returns#44983, profit#45062, null, null, 3)], [channel#44981, id#44982, sales#44995, returns#44983, profit#45062, channel#45070, id#45071, spark_grouping_id#45067]
            +- Project [channel#44981, id#44982, sales#44995, returns#44983, profit#45062, channel#44981 AS channel#45068, id#44982 AS id#45069]
               +- SubqueryAlias `x`
                  +- Union
                     :- Project [channel#44981, id#44982, sales#44995, returns#44983, profit#45062]
                     :  +- Union
                     :     :- Project [channel#44981, id#44982, sales#44995, returns#44983, cast(profit#44984 as decimal(18,2)) AS profit#45062]
                     :     :  +- Project [store channel AS channel#44981, s_store_sk#664 AS id#44982, sales#44995, coalesce(returns#44997, cast(0 as decimal(17,2))) AS returns#44983, CheckOverflow((promote_precision(cast(profit#44996 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#44998, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS profit#44984]
                     :     :     +- Join LeftOuter, (s_store_sk#664 = s_store_sk#45019)
                     :     :        :- SubqueryAlias `ss`
                     :     :        :  +- Aggregate [s_store_sk#664], [s_store_sk#664, sum(ss_ext_sales_price#145) AS sales#44995, sum(ss_net_profit#152) AS profit#44996]
                     :     :        :     +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (ss_store_sk#137 = s_store_sk#664))
                     :     :        :        +- Join Inner
                     :     :        :           :- Join Inner
                     :     :        :           :  :- SubqueryAlias `store_sales`
                     :     :        :           :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :     :        :           :  +- SubqueryAlias `date_dim`
                     :     :        :           :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :     :        :           +- SubqueryAlias `store`
                     :     :        :              +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :     :        +- SubqueryAlias `sr`
                     :     :           +- Aggregate [s_store_sk#45019], [s_store_sk#45019, sum(sr_return_amt#187) AS returns#44997, sum(sr_net_loss#195) AS profit_loss#44998]
                     :     :              +- Filter (((sr_returned_date_sk#176 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (sr_store_sk#183 = s_store_sk#45019))
                     :     :                 +- Join Inner
                     :     :                    :- Join Inner
                     :     :                    :  :- SubqueryAlias `store_returns`
                     :     :                    :  :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :     :                    :  +- SubqueryAlias `date_dim`
                     :     :                    :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :     :                    +- SubqueryAlias `store`
                     :     :                       +- Relation[s_store_sk#45019,s_store_id#45020,s_rec_start_date#45021,s_rec_end_date#45022,s_closed_date_sk#45023,s_store_name#45024,s_number_employees#45025,s_floor_space#45026,s_hours#45027,s_manager#45028,s_market_id#45029,s_geography_class#45030,s_market_desc#45031,s_market_manager#45032,s_division_id#45033,s_division_name#45034,s_company_id#45035,s_company_name#45036,s_street_number#45037,s_street_name#45038,s_street_type#45039,s_suite_number#45040,s_city#45041,s_county#45042,... 5 more fields] parquet
                     :     +- Project [channel#44985, id#44986, sales#44999, returns#45001, profit#44987]
                     :        +- Project [catalog channel AS channel#44985, cs_call_center_sk#11 AS id#44986, sales#44999, returns#45001, CheckOverflow((promote_precision(cast(profit#45000 as decimal(18,2))) - promote_precision(cast(profit_loss#45002 as decimal(18,2)))), DecimalType(18,2)) AS profit#44987]
                     :           +- Join Cross
                     :              :- SubqueryAlias `cs`
                     :              :  +- Aggregate [cs_call_center_sk#11], [cs_call_center_sk#11, sum(cs_ext_sales_price#23) AS sales#44999, sum(cs_net_profit#33) AS profit#45000]
                     :              :     +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date))))
                     :              :        +- Join Inner
                     :              :           :- SubqueryAlias `catalog_sales`
                     :              :           :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :              :           +- SubqueryAlias `date_dim`
                     :              :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :              +- SubqueryAlias `cr`
                     :                 +- Aggregate [cr_call_center_sk#79], [cr_call_center_sk#79, sum(cr_return_amount#86) AS returns#45001, sum(cr_net_loss#94) AS profit_loss#45002]
                     :                    +- Filter ((cr_returned_date_sk#68 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date))))
                     :                       +- Join Inner
                     :                          :- SubqueryAlias `catalog_returns`
                     :                          :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                     :                          +- SubqueryAlias `date_dim`
                     :                             +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     +- Project [channel#44988, id#44989, sales#45003, returns#44990, cast(profit#44991 as decimal(18,2)) AS profit#45063]
                        +- Project [web channel AS channel#44988, wp_web_page_sk#770 AS id#44989, sales#45003, coalesce(returns#45005, cast(0 as decimal(17,2))) AS returns#44990, CheckOverflow((promote_precision(cast(profit#45004 as decimal(18,2))) - promote_precision(cast(coalesce(profit_loss#45006, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS profit#44991]
                           +- Join LeftOuter, (wp_web_page_sk#770 = wp_web_page_sk#45048)
                              :- SubqueryAlias `ws`
                              :  +- Aggregate [wp_web_page_sk#770], [wp_web_page_sk#770, sum(ws_ext_sales_price#239) AS sales#45003, sum(ws_net_profit#249) AS profit#45004]
                              :     +- Filter (((ws_sold_date_sk#216 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (ws_web_page_sk#228 = wp_web_page_sk#770))
                              :        +- Join Inner
                              :           :- Join Inner
                              :           :  :- SubqueryAlias `web_sales`
                              :           :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :           :  +- SubqueryAlias `date_dim`
                              :           :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              :           +- SubqueryAlias `web_page`
                              :              +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet
                              +- SubqueryAlias `wr`
                                 +- Aggregate [wp_web_page_sk#45048], [wp_web_page_sk#45048, sum(wr_return_amt#299) AS returns#45005, sum(wr_net_loss#307) AS profit_loss#45006]
                                    +- Filter (((wr_returned_date_sk#284 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && (wr_web_page_sk#295 = wp_web_page_sk#45048))
                                       +- Join Inner
                                          :- Join Inner
                                          :  :- SubqueryAlias `web_returns`
                                          :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                                          :  +- SubqueryAlias `date_dim`
                                          :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                          +- SubqueryAlias `web_page`
                                             +- Relation[wp_web_page_sk#45048,wp_web_page_id#45049,wp_rec_start_date#45050,wp_rec_end_date#45051,wp_creation_date_sk#45052,wp_access_date_sk#45053,wp_autogen_flag#45054,wp_customer_sk#45055,wp_url#45056,wp_type#45057,wp_char_count#45058,wp_link_count#45059,wp_image_count#45060,wp_max_ad_count#45061] parquet

      running Thread[benchmark runner,5,main]
19/10/04 10:19:02 ERROR AsyncEventQueue: Dropping event from queue appStatus. This likely means one of the listeners is too slow and cannot keep up with the rate at which tasks are being started by the scheduler.
19/10/04 10:19:02 WARN AsyncEventQueue: Dropped 1 events from appStatus since Thu Jan 01 00:00:00 GMT 1970.
Execution time: 270.62728989000004s
Running execution q78-v2.4 iteration: 1, StandardRun=true
19/10/04 10:19:27 INFO Query: 
== Query: q78-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ss_sold_year#45391, ss_item_sk#132, ss_customer_sk#133, ratio#45374, store_qty#45375L, store_wholesale_cost#45376, store_sales_price#45377, other_chan_qty#45378L, other_chan_wholesale_cost#45379, other_chan_sales_price#45380]
      +- Sort [ss_sold_year#45391 ASC NULLS FIRST, ss_item_sk#132 ASC NULLS FIRST, ss_customer_sk#133 ASC NULLS FIRST, ss_qty#45392L DESC NULLS LAST, ss_wc#45393 DESC NULLS LAST, ss_sp#45394 DESC NULLS LAST, other_chan_qty#45378L ASC NULLS FIRST, other_chan_wholesale_cost#45379 ASC NULLS FIRST, other_chan_sales_price#45380 ASC NULLS FIRST, round((cast(ss_qty#45392L as double) / cast(coalesce((ws_qty#45383L + cs_qty#45388L), cast(1 as bigint)) as double)), 2) ASC NULLS FIRST], true
         +- Project [ss_sold_year#45391, ss_item_sk#132, ss_customer_sk#133, round((cast(ss_qty#45392L as double) / cast((coalesce(ws_qty#45383L, cast(0 as bigint)) + coalesce(cs_qty#45388L, cast(0 as bigint))) as double)), 2) AS ratio#45374, ss_qty#45392L AS store_qty#45375L, ss_wc#45393 AS store_wholesale_cost#45376, ss_sp#45394 AS store_sales_price#45377, (coalesce(ws_qty#45383L, cast(0 as bigint)) + coalesce(cs_qty#45388L, cast(0 as bigint))) AS other_chan_qty#45378L, CheckOverflow((promote_precision(cast(coalesce(ws_wc#45384, cast(0 as decimal(17,2))) as decimal(18,2))) + promote_precision(cast(coalesce(cs_wc#45389, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS other_chan_wholesale_cost#45379, CheckOverflow((promote_precision(cast(coalesce(ws_sp#45385, cast(0 as decimal(17,2))) as decimal(18,2))) + promote_precision(cast(coalesce(cs_sp#45390, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS other_chan_sales_price#45380, ss_wc#45393, cs_qty#45388L, ws_qty#45383L, ss_sp#45394, ss_qty#45392L]
            +- Filter (((coalesce(ws_qty#45383L, cast(0 as bigint)) > cast(0 as bigint)) || (coalesce(cs_qty#45388L, cast(0 as bigint)) > cast(0 as bigint))) && (ss_sold_year#45391 = 2000))
               +- Join LeftOuter, (((cs_sold_year#45386 = ss_sold_year#45391) && (cs_item_sk#15 = ss_item_sk#132)) && (cs_customer_sk#45387 = ss_customer_sk#133))
                  :- Join LeftOuter, (((ws_sold_year#45381 = ss_sold_year#45391) && (ws_item_sk#219 = ss_item_sk#132)) && (ws_customer_sk#45382 = ss_customer_sk#133))
                  :  :- SubqueryAlias `ss`
                  :  :  +- Aggregate [d_year#498, ss_item_sk#132, ss_customer_sk#133], [d_year#498 AS ss_sold_year#45391, ss_item_sk#132, ss_customer_sk#133, sum(cast(ss_quantity#140 as bigint)) AS ss_qty#45392L, sum(ss_wholesale_cost#141) AS ss_wc#45393, sum(ss_sales_price#143) AS ss_sp#45394]
                  :  :     +- Filter isnull(sr_ticket_number#185L)
                  :  :        +- Join Inner, (ss_sold_date_sk#130 = d_date_sk#492)
                  :  :           :- Join LeftOuter, ((sr_ticket_number#185L = ss_ticket_number#139L) && (ss_item_sk#132 = sr_item_sk#178))
                  :  :           :  :- SubqueryAlias `store_sales`
                  :  :           :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :           :  +- SubqueryAlias `store_returns`
                  :  :           :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :           +- SubqueryAlias `date_dim`
                  :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `ws`
                  :     +- Aggregate [d_year#498, ws_item_sk#219, ws_bill_customer_sk#220], [d_year#498 AS ws_sold_year#45381, ws_item_sk#219, ws_bill_customer_sk#220 AS ws_customer_sk#45382, sum(cast(ws_quantity#234 as bigint)) AS ws_qty#45383L, sum(ws_wholesale_cost#235) AS ws_wc#45384, sum(ws_sales_price#237) AS ws_sp#45385]
                  :        +- Filter isnull(wr_order_number#297L)
                  :           +- Join Inner, (ws_sold_date_sk#216 = d_date_sk#492)
                  :              :- Join LeftOuter, ((wr_order_number#297L = ws_order_number#233L) && (ws_item_sk#219 = wr_item_sk#286))
                  :              :  :- SubqueryAlias `web_sales`
                  :              :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :              :  +- SubqueryAlias `web_returns`
                  :              :     +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                  :              +- SubqueryAlias `date_dim`
                  :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `cs`
                     +- Aggregate [d_year#498, cs_item_sk#15, cs_bill_customer_sk#3], [d_year#498 AS cs_sold_year#45386, cs_item_sk#15, cs_bill_customer_sk#3 AS cs_customer_sk#45387, sum(cast(cs_quantity#18 as bigint)) AS cs_qty#45388L, sum(cs_wholesale_cost#19) AS cs_wc#45389, sum(cs_sales_price#21) AS cs_sp#45390]
                        +- Filter isnull(cr_order_number#84L)
                           +- Join Inner, (cs_sold_date_sk#0 = d_date_sk#492)
                              :- Join LeftOuter, ((cr_order_number#84L = cs_order_number#17L) && (cs_item_sk#15 = cr_item_sk#70))
                              :  :- SubqueryAlias `catalog_sales`
                              :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                              :  +- SubqueryAlias `catalog_returns`
                              :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                              +- SubqueryAlias `date_dim`
                                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/04 10:19:27 INFO Query: 
== Query: q78-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [ss_sold_year#45431, ss_item_sk#132, ss_customer_sk#133, ratio#45414, store_qty#45415L, store_wholesale_cost#45416, store_sales_price#45417, other_chan_qty#45418L, other_chan_wholesale_cost#45419, other_chan_sales_price#45420]
      +- Sort [ss_sold_year#45431 ASC NULLS FIRST, ss_item_sk#132 ASC NULLS FIRST, ss_customer_sk#133 ASC NULLS FIRST, ss_qty#45432L DESC NULLS LAST, ss_wc#45433 DESC NULLS LAST, ss_sp#45434 DESC NULLS LAST, other_chan_qty#45418L ASC NULLS FIRST, other_chan_wholesale_cost#45419 ASC NULLS FIRST, other_chan_sales_price#45420 ASC NULLS FIRST, round((cast(ss_qty#45432L as double) / cast(coalesce((ws_qty#45423L + cs_qty#45428L), cast(1 as bigint)) as double)), 2) ASC NULLS FIRST], true
         +- Project [ss_sold_year#45431, ss_item_sk#132, ss_customer_sk#133, round((cast(ss_qty#45432L as double) / cast((coalesce(ws_qty#45423L, cast(0 as bigint)) + coalesce(cs_qty#45428L, cast(0 as bigint))) as double)), 2) AS ratio#45414, ss_qty#45432L AS store_qty#45415L, ss_wc#45433 AS store_wholesale_cost#45416, ss_sp#45434 AS store_sales_price#45417, (coalesce(ws_qty#45423L, cast(0 as bigint)) + coalesce(cs_qty#45428L, cast(0 as bigint))) AS other_chan_qty#45418L, CheckOverflow((promote_precision(cast(coalesce(ws_wc#45424, cast(0 as decimal(17,2))) as decimal(18,2))) + promote_precision(cast(coalesce(cs_wc#45429, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS other_chan_wholesale_cost#45419, CheckOverflow((promote_precision(cast(coalesce(ws_sp#45425, cast(0 as decimal(17,2))) as decimal(18,2))) + promote_precision(cast(coalesce(cs_sp#45430, cast(0 as decimal(17,2))) as decimal(18,2)))), DecimalType(18,2)) AS other_chan_sales_price#45420, ss_qty#45432L, ws_qty#45423L, ss_sp#45434, cs_qty#45428L, ss_wc#45433]
            +- Filter (((coalesce(ws_qty#45423L, cast(0 as bigint)) > cast(0 as bigint)) || (coalesce(cs_qty#45428L, cast(0 as bigint)) > cast(0 as bigint))) && (ss_sold_year#45431 = 2000))
               +- Join LeftOuter, (((cs_sold_year#45426 = ss_sold_year#45431) && (cs_item_sk#15 = ss_item_sk#132)) && (cs_customer_sk#45427 = ss_customer_sk#133))
                  :- Join LeftOuter, (((ws_sold_year#45421 = ss_sold_year#45431) && (ws_item_sk#219 = ss_item_sk#132)) && (ws_customer_sk#45422 = ss_customer_sk#133))
                  :  :- SubqueryAlias `ss`
                  :  :  +- Aggregate [d_year#498, ss_item_sk#132, ss_customer_sk#133], [d_year#498 AS ss_sold_year#45431, ss_item_sk#132, ss_customer_sk#133, sum(cast(ss_quantity#140 as bigint)) AS ss_qty#45432L, sum(ss_wholesale_cost#141) AS ss_wc#45433, sum(ss_sales_price#143) AS ss_sp#45434]
                  :  :     +- Filter isnull(sr_ticket_number#185L)
                  :  :        +- Join Inner, (ss_sold_date_sk#130 = d_date_sk#492)
                  :  :           :- Join LeftOuter, ((sr_ticket_number#185L = ss_ticket_number#139L) && (ss_item_sk#132 = sr_item_sk#178))
                  :  :           :  :- SubqueryAlias `store_sales`
                  :  :           :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :           :  +- SubqueryAlias `store_returns`
                  :  :           :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                  :  :           +- SubqueryAlias `date_dim`
                  :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `ws`
                  :     +- Aggregate [d_year#498, ws_item_sk#219, ws_bill_customer_sk#220], [d_year#498 AS ws_sold_year#45421, ws_item_sk#219, ws_bill_customer_sk#220 AS ws_customer_sk#45422, sum(cast(ws_quantity#234 as bigint)) AS ws_qty#45423L, sum(ws_wholesale_cost#235) AS ws_wc#45424, sum(ws_sales_price#237) AS ws_sp#45425]
                  :        +- Filter isnull(wr_order_number#297L)
                  :           +- Join Inner, (ws_sold_date_sk#216 = d_date_sk#492)
                  :              :- Join LeftOuter, ((wr_order_number#297L = ws_order_number#233L) && (ws_item_sk#219 = wr_item_sk#286))
                  :              :  :- SubqueryAlias `web_sales`
                  :              :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :              :  +- SubqueryAlias `web_returns`
                  :              :     +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                  :              +- SubqueryAlias `date_dim`
                  :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `cs`
                     +- Aggregate [d_year#498, cs_item_sk#15, cs_bill_customer_sk#3], [d_year#498 AS cs_sold_year#45426, cs_item_sk#15, cs_bill_customer_sk#3 AS cs_customer_sk#45427, sum(cast(cs_quantity#18 as bigint)) AS cs_qty#45428L, sum(cs_wholesale_cost#19) AS cs_wc#45429, sum(cs_sales_price#21) AS cs_sp#45430]
                        +- Filter isnull(cr_order_number#84L)
                           +- Join Inner, (cs_sold_date_sk#0 = d_date_sk#492)
                              :- Join LeftOuter, ((cr_order_number#84L = cs_order_number#17L) && (cs_item_sk#15 = cr_item_sk#70))
                              :  :- SubqueryAlias `catalog_sales`
                              :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                              :  +- SubqueryAlias `catalog_returns`
                              :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                              +- SubqueryAlias `date_dim`
                                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 2765.997255754s
Running execution q79-v2.4 iteration: 1, StandardRun=true
19/10/04 11:05:35 INFO Query: 
== Query: q79-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [c_last_name#421, c_first_name#420, substring(s_city, 1, 30)#45572, ss_ticket_number#139L, amt#45568, profit#45569]
      +- Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, substring(s_city#686, 1, 30) ASC NULLS FIRST, profit#45569 ASC NULLS FIRST], true
         +- Project [c_last_name#421, c_first_name#420, substring(s_city#686, 1, 30) AS substring(s_city, 1, 30)#45572, ss_ticket_number#139L, amt#45568, profit#45569, s_city#686]
            +- Filter (ss_customer_sk#133 = c_customer_sk#412)
               +- Join Inner
                  :- SubqueryAlias `ms`
                  :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133, ss_addr_sk#136, s_city#686], [ss_ticket_number#139L, ss_customer_sk#133, s_city#686, sum(ss_coupon_amt#149) AS amt#45568, sum(ss_net_profit#152) AS profit#45569]
                  :     +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_hdemo_sk#135 = hd_demo_sk#548) && ((hd_dep_count#551 = 6) || (hd_vehicle_count#552 > 2)))) && (((d_dow#499 = 1) && d_year#498 IN (1999,(1999 + 1),(1999 + 2))) && ((s_number_employees#670 >= 200) && (s_number_employees#670 <= 295))))
                  :        +- Join Inner
                  :           :- Join Inner
                  :           :  :- Join Inner
                  :           :  :  :- SubqueryAlias `store_sales`
                  :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :           :  :  +- SubqueryAlias `date_dim`
                  :           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :           :  +- SubqueryAlias `store`
                  :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  :           +- SubqueryAlias `household_demographics`
                  :              +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                  +- SubqueryAlias `customer`
                     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/10/04 11:05:35 INFO Query: 
== Query: q79-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [c_last_name#421, c_first_name#420, substring(s_city, 1, 30)#45583, ss_ticket_number#139L, amt#45579, profit#45580]
      +- Sort [c_last_name#421 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, substring(s_city#686, 1, 30) ASC NULLS FIRST, profit#45580 ASC NULLS FIRST], true
         +- Project [c_last_name#421, c_first_name#420, substring(s_city#686, 1, 30) AS substring(s_city, 1, 30)#45583, ss_ticket_number#139L, amt#45579, profit#45580, s_city#686]
            +- Filter (ss_customer_sk#133 = c_customer_sk#412)
               +- Join Inner
                  :- SubqueryAlias `ms`
                  :  +- Aggregate [ss_ticket_number#139L, ss_customer_sk#133, ss_addr_sk#136, s_city#686], [ss_ticket_number#139L, ss_customer_sk#133, s_city#686, sum(ss_coupon_amt#149) AS amt#45579, sum(ss_net_profit#152) AS profit#45580]
                  :     +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && (ss_store_sk#137 = s_store_sk#664)) && ((ss_hdemo_sk#135 = hd_demo_sk#548) && ((hd_dep_count#551 = 6) || (hd_vehicle_count#552 > 2)))) && (((d_dow#499 = 1) && d_year#498 IN (1999,(1999 + 1),(1999 + 2))) && ((s_number_employees#670 >= 200) && (s_number_employees#670 <= 295))))
                  :        +- Join Inner
                  :           :- Join Inner
                  :           :  :- Join Inner
                  :           :  :  :- SubqueryAlias `store_sales`
                  :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :           :  :  +- SubqueryAlias `date_dim`
                  :           :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :           :  +- SubqueryAlias `store`
                  :           :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                  :           +- SubqueryAlias `household_demographics`
                  :              +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                  +- SubqueryAlias `customer`
                     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 160.386596973s
Running execution q80-v2.4 iteration: 1, StandardRun=true
19/10/04 11:08:18 INFO Query: 
== Query: q80-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#45724 ASC NULLS FIRST, id#45725 ASC NULLS FIRST], true
      +- Aggregate [channel#45724, id#45725, spark_grouping_id#45721], [channel#45724, id#45725, sum(sales#45699) AS sales#45695, sum(returns#45700) AS returns#45696, sum(profit#45701) AS profit#45697]
         +- Expand [List(channel#45689, id#45690, sales#45699, returns#45700, profit#45701, channel#45722, id#45723, 0), List(channel#45689, id#45690, sales#45699, returns#45700, profit#45701, channel#45722, null, 1), List(channel#45689, id#45690, sales#45699, returns#45700, profit#45701, null, null, 3)], [channel#45689, id#45690, sales#45699, returns#45700, profit#45701, channel#45724, id#45725, spark_grouping_id#45721]
            +- Project [channel#45689, id#45690, sales#45699, returns#45700, profit#45701, channel#45689 AS channel#45722, id#45690 AS id#45723]
               +- SubqueryAlias `x`
                  +- Union
                     :- Union
                     :  :- Project [store channel AS channel#45689, concat(store, store_id#45698) AS id#45690, sales#45699, returns#45700, profit#45701]
                     :  :  +- SubqueryAlias `ssr`
                     :  :     +- Aggregate [s_store_id#665], [s_store_id#665 AS store_id#45698, sum(ss_ext_sales_price#145) AS sales#45699, sum(coalesce(cast(sr_return_amt#187 as decimal(12,2)), cast(0 as decimal(12,2)))) AS returns#45700, sum(CheckOverflow((promote_precision(cast(ss_net_profit#152 as decimal(13,2))) - promote_precision(cast(coalesce(cast(sr_net_loss#195 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2))) AS profit#45701]
                     :  :        +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && ((ss_store_sk#137 = s_store_sk#664) && (ss_item_sk#132 = i_item_sk#564))) && (((cast(i_current_price#569 as decimal(7,2)) > cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (ss_promo_sk#138 = p_promo_sk#608)) && (p_channel_tv#619 = N)))
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- Join Inner
                     :  :              :  :  :- Join Inner
                     :  :              :  :  :  :- Join LeftOuter, ((ss_item_sk#132 = sr_item_sk#178) && (ss_ticket_number#139L = sr_ticket_number#185L))
                     :  :              :  :  :  :  :- SubqueryAlias `store_sales`
                     :  :              :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :              :  :  :  :  +- SubqueryAlias `store_returns`
                     :  :              :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :              :  :  :  +- SubqueryAlias `date_dim`
                     :  :              :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :              :  :  +- SubqueryAlias `store`
                     :  :              :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  :              :  +- SubqueryAlias `item`
                     :  :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :              +- SubqueryAlias `promotion`
                     :  :                 +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                     :  +- Project [catalog channel AS channel#45691, concat(catalog_page, catalog_page_id#45702) AS id#45692, sales#45703, returns#45704, profit#45705]
                     :     +- SubqueryAlias `csr`
                     :        +- Aggregate [cp_catalog_page_id#395], [cp_catalog_page_id#395 AS catalog_page_id#45702, sum(cs_ext_sales_price#23) AS sales#45703, sum(coalesce(cast(cr_return_amount#86 as decimal(12,2)), cast(0 as decimal(12,2)))) AS returns#45704, sum(CheckOverflow((promote_precision(cast(cs_net_profit#33 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_net_loss#94 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2))) AS profit#45705]
                     :           +- Filter ((((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && ((cs_catalog_page_sk#12 = cp_catalog_page_sk#394) && (cs_item_sk#15 = i_item_sk#564))) && (((cast(i_current_price#569 as decimal(7,2)) > cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cs_promo_sk#16 = p_promo_sk#608)) && (p_channel_tv#619 = N)))
                     :              +- Join Inner
                     :                 :- Join Inner
                     :                 :  :- Join Inner
                     :                 :  :  :- Join Inner
                     :                 :  :  :  :- Join LeftOuter, ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                     :                 :  :  :  :  :- SubqueryAlias `catalog_sales`
                     :                 :  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :                 :  :  :  :  +- SubqueryAlias `catalog_returns`
                     :                 :  :  :  :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                     :                 :  :  :  +- SubqueryAlias `date_dim`
                     :                 :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :                 :  :  +- SubqueryAlias `catalog_page`
                     :                 :  :     +- Relation[cp_catalog_page_sk#394,cp_catalog_page_id#395,cp_start_date_sk#396,cp_end_date_sk#397,cp_department#398,cp_catalog_number#399,cp_catalog_page_number#400,cp_description#401,cp_type#402] parquet
                     :                 :  +- SubqueryAlias `item`
                     :                 :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :                 +- SubqueryAlias `promotion`
                     :                    +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                     +- Project [web channel AS channel#45693, concat(web_site, web_site_id#799) AS id#45694, sales#45706, returns#45707, profit#45708]
                        +- SubqueryAlias `wsr`
                           +- Aggregate [web_site_id#799], [web_site_id#799, sum(ws_ext_sales_price#239) AS sales#45706, sum(coalesce(cast(wr_return_amt#299 as decimal(12,2)), cast(0 as decimal(12,2)))) AS returns#45707, sum(CheckOverflow((promote_precision(cast(ws_net_profit#249 as decimal(13,2))) - promote_precision(cast(coalesce(cast(wr_net_loss#307 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2))) AS profit#45708]
                              +- Filter ((((ws_sold_date_sk#216 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && ((ws_web_site_sk#229 = web_site_sk#798) && (ws_item_sk#219 = i_item_sk#564))) && (((cast(i_current_price#569 as decimal(7,2)) > cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (ws_promo_sk#232 = p_promo_sk#608)) && (p_channel_tv#619 = N)))
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- Join Inner
                                    :  :  :- Join Inner
                                    :  :  :  :- Join LeftOuter, ((ws_item_sk#219 = wr_item_sk#286) && (ws_order_number#233L = wr_order_number#297L))
                                    :  :  :  :  :- SubqueryAlias `web_sales`
                                    :  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  :  :  :  +- SubqueryAlias `web_returns`
                                    :  :  :  :     +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                                    :  :  :  +- SubqueryAlias `date_dim`
                                    :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                    :  :  +- SubqueryAlias `web_site`
                                    :  :     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet
                                    :  +- SubqueryAlias `item`
                                    :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                    +- SubqueryAlias `promotion`
                                       +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet

     : benchmark
19/10/04 11:08:18 INFO Query: 
== Query: q80-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [channel#45768 ASC NULLS FIRST, id#45769 ASC NULLS FIRST], true
      +- Aggregate [channel#45768, id#45769, spark_grouping_id#45765], [channel#45768, id#45769, sum(sales#45743) AS sales#45739, sum(returns#45744) AS returns#45740, sum(profit#45745) AS profit#45741]
         +- Expand [List(channel#45733, id#45734, sales#45743, returns#45744, profit#45745, channel#45766, id#45767, 0), List(channel#45733, id#45734, sales#45743, returns#45744, profit#45745, channel#45766, null, 1), List(channel#45733, id#45734, sales#45743, returns#45744, profit#45745, null, null, 3)], [channel#45733, id#45734, sales#45743, returns#45744, profit#45745, channel#45768, id#45769, spark_grouping_id#45765]
            +- Project [channel#45733, id#45734, sales#45743, returns#45744, profit#45745, channel#45733 AS channel#45766, id#45734 AS id#45767]
               +- SubqueryAlias `x`
                  +- Union
                     :- Union
                     :  :- Project [store channel AS channel#45733, concat(store, store_id#45742) AS id#45734, sales#45743, returns#45744, profit#45745]
                     :  :  +- SubqueryAlias `ssr`
                     :  :     +- Aggregate [s_store_id#665], [s_store_id#665 AS store_id#45742, sum(ss_ext_sales_price#145) AS sales#45743, sum(coalesce(cast(sr_return_amt#187 as decimal(12,2)), cast(0 as decimal(12,2)))) AS returns#45744, sum(CheckOverflow((promote_precision(cast(ss_net_profit#152 as decimal(13,2))) - promote_precision(cast(coalesce(cast(sr_net_loss#195 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2))) AS profit#45745]
                     :  :        +- Filter ((((ss_sold_date_sk#130 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && ((ss_store_sk#137 = s_store_sk#664) && (ss_item_sk#132 = i_item_sk#564))) && (((cast(i_current_price#569 as decimal(7,2)) > cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (ss_promo_sk#138 = p_promo_sk#608)) && (p_channel_tv#619 = N)))
                     :  :           +- Join Inner
                     :  :              :- Join Inner
                     :  :              :  :- Join Inner
                     :  :              :  :  :- Join Inner
                     :  :              :  :  :  :- Join LeftOuter, ((ss_item_sk#132 = sr_item_sk#178) && (ss_ticket_number#139L = sr_ticket_number#185L))
                     :  :              :  :  :  :  :- SubqueryAlias `store_sales`
                     :  :              :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  :              :  :  :  :  +- SubqueryAlias `store_returns`
                     :  :              :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     :  :              :  :  :  +- SubqueryAlias `date_dim`
                     :  :              :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :  :              :  :  +- SubqueryAlias `store`
                     :  :              :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                     :  :              :  +- SubqueryAlias `item`
                     :  :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :  :              +- SubqueryAlias `promotion`
                     :  :                 +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                     :  +- Project [catalog channel AS channel#45735, concat(catalog_page, catalog_page_id#45746) AS id#45736, sales#45747, returns#45748, profit#45749]
                     :     +- SubqueryAlias `csr`
                     :        +- Aggregate [cp_catalog_page_id#395], [cp_catalog_page_id#395 AS catalog_page_id#45746, sum(cs_ext_sales_price#23) AS sales#45747, sum(coalesce(cast(cr_return_amount#86 as decimal(12,2)), cast(0 as decimal(12,2)))) AS returns#45748, sum(CheckOverflow((promote_precision(cast(cs_net_profit#33 as decimal(13,2))) - promote_precision(cast(coalesce(cast(cr_net_loss#94 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2))) AS profit#45749]
                     :           +- Filter ((((cs_sold_date_sk#0 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && ((cs_catalog_page_sk#12 = cp_catalog_page_sk#394) && (cs_item_sk#15 = i_item_sk#564))) && (((cast(i_current_price#569 as decimal(7,2)) > cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cs_promo_sk#16 = p_promo_sk#608)) && (p_channel_tv#619 = N)))
                     :              +- Join Inner
                     :                 :- Join Inner
                     :                 :  :- Join Inner
                     :                 :  :  :- Join Inner
                     :                 :  :  :  :- Join LeftOuter, ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                     :                 :  :  :  :  :- SubqueryAlias `catalog_sales`
                     :                 :  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     :                 :  :  :  :  +- SubqueryAlias `catalog_returns`
                     :                 :  :  :  :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                     :                 :  :  :  +- SubqueryAlias `date_dim`
                     :                 :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                     :                 :  :  +- SubqueryAlias `catalog_page`
                     :                 :  :     +- Relation[cp_catalog_page_sk#394,cp_catalog_page_id#395,cp_start_date_sk#396,cp_end_date_sk#397,cp_department#398,cp_catalog_number#399,cp_catalog_page_number#400,cp_description#401,cp_type#402] parquet
                     :                 :  +- SubqueryAlias `item`
                     :                 :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     :                 +- SubqueryAlias `promotion`
                     :                    +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                     +- Project [web channel AS channel#45737, concat(web_site, web_site_id#799) AS id#45738, sales#45750, returns#45751, profit#45752]
                        +- SubqueryAlias `wsr`
                           +- Aggregate [web_site_id#799], [web_site_id#799, sum(ws_ext_sales_price#239) AS sales#45750, sum(coalesce(cast(wr_return_amt#299 as decimal(12,2)), cast(0 as decimal(12,2)))) AS returns#45751, sum(CheckOverflow((promote_precision(cast(ws_net_profit#249 as decimal(13,2))) - promote_precision(cast(coalesce(cast(wr_net_loss#307 as decimal(12,2)), cast(0 as decimal(12,2))) as decimal(13,2)))), DecimalType(13,2))) AS profit#45752]
                              +- Filter ((((ws_sold_date_sk#216 = d_date_sk#492) && ((d_date#494 >= cast(2000-08-23 as date)) && (d_date#494 <= cast(cast(cast(2000-08-23 as date) as timestamp) + interval 4 weeks 2 days as date)))) && ((ws_web_site_sk#229 = web_site_sk#798) && (ws_item_sk#219 = i_item_sk#564))) && (((cast(i_current_price#569 as decimal(7,2)) > cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (ws_promo_sk#232 = p_promo_sk#608)) && (p_channel_tv#619 = N)))
                                 +- Join Inner
                                    :- Join Inner
                                    :  :- Join Inner
                                    :  :  :- Join Inner
                                    :  :  :  :- Join LeftOuter, ((ws_item_sk#219 = wr_item_sk#286) && (ws_order_number#233L = wr_order_number#297L))
                                    :  :  :  :  :- SubqueryAlias `web_sales`
                                    :  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                                    :  :  :  :  +- SubqueryAlias `web_returns`
                                    :  :  :  :     +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                                    :  :  :  +- SubqueryAlias `date_dim`
                                    :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                    :  :  +- SubqueryAlias `web_site`
                                    :  :     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet
                                    :  +- SubqueryAlias `item`
                                    :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                    +- SubqueryAlias `promotion`
                                       +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet

      running Thread[benchmark runner,5,main]
Execution time: 2827.535320131s
Running execution q81-v2.4 iteration: 1, StandardRun=true
19/10/04 11:55:28 INFO Query: 
== Query: q81-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_customer_id#413 ASC NULLS FIRST, c_salutation#419 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, c_last_name#421 ASC NULLS FIRST, ca_street_number#450 ASC NULLS FIRST, ca_street_name#451 ASC NULLS FIRST, ca_street_type#452 ASC NULLS FIRST, ca_suite_number#453 ASC NULLS FIRST, ca_city#454 ASC NULLS FIRST, ca_county#455 ASC NULLS FIRST, ca_state#456 ASC NULLS FIRST, ca_zip#457 ASC NULLS FIRST, ca_country#458 ASC NULLS FIRST, ca_gmt_offset#459 ASC NULLS FIRST, ca_location_type#460 ASC NULLS FIRST, ctr_total_return#45931 ASC NULLS FIRST], true
      +- Project [c_customer_id#413, c_salutation#419, c_first_name#420, c_last_name#421, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, ctr_total_return#45931]
         +- Filter (((cast(ctr_total_return#45931 as decimal(24,7)) > cast(scalar-subquery#45928 [ctr_state#45930] as decimal(24,7))) && (ca_address_sk#448 = c_current_addr_sk#416)) && ((ca_state#456 = GA) && (ctr_customer_sk#45929 = c_customer_sk#412)))
            :  +- Aggregate [CheckOverflow((promote_precision(cast(avg(ctr_total_return#45931) as decimal(21,6))) * promote_precision(cast(1.2 as decimal(21,6)))), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#45934]
            :     +- Filter (outer(ctr_state#45930) = ctr_state#45930)
            :        +- SubqueryAlias `ctr2`
            :           +- SubqueryAlias `customer_total_return`
            :              +- Aggregate [cr_returning_customer_sk#75, ca_state#456], [cr_returning_customer_sk#75 AS ctr_customer_sk#45929, ca_state#456 AS ctr_state#45930, sum(cr_return_amt_inc_tax#88) AS ctr_total_return#45931]
            :                 +- Filter (((cr_returned_date_sk#68 = d_date_sk#492) && (d_year#498 = 2000)) && (cr_returning_addr_sk#78 = ca_address_sk#448))
            :                    +- Join Inner
            :                       :- Join Inner
            :                       :  :- SubqueryAlias `catalog_returns`
            :                       :  :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
            :                       :  +- SubqueryAlias `date_dim`
            :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :                       +- SubqueryAlias `customer_address`
            :                          +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ctr1`
               :  :  +- SubqueryAlias `customer_total_return`
               :  :     +- Aggregate [cr_returning_customer_sk#75, ca_state#456], [cr_returning_customer_sk#75 AS ctr_customer_sk#45929, ca_state#456 AS ctr_state#45930, sum(cr_return_amt_inc_tax#88) AS ctr_total_return#45931]
               :  :        +- Filter (((cr_returned_date_sk#68 = d_date_sk#492) && (d_year#498 = 2000)) && (cr_returning_addr_sk#78 = ca_address_sk#448))
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- SubqueryAlias `catalog_returns`
               :  :              :  :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               :  :              :  +- SubqueryAlias `date_dim`
               :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              +- SubqueryAlias `customer_address`
               :  :                 +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer_address`
               :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer`
                  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

     : benchmark
19/10/04 11:55:29 INFO Query: 
== Query: q81-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [c_customer_id#413 ASC NULLS FIRST, c_salutation#419 ASC NULLS FIRST, c_first_name#420 ASC NULLS FIRST, c_last_name#421 ASC NULLS FIRST, ca_street_number#450 ASC NULLS FIRST, ca_street_name#451 ASC NULLS FIRST, ca_street_type#452 ASC NULLS FIRST, ca_suite_number#453 ASC NULLS FIRST, ca_city#454 ASC NULLS FIRST, ca_county#455 ASC NULLS FIRST, ca_state#456 ASC NULLS FIRST, ca_zip#457 ASC NULLS FIRST, ca_country#458 ASC NULLS FIRST, ca_gmt_offset#459 ASC NULLS FIRST, ca_location_type#460 ASC NULLS FIRST, ctr_total_return#45954 ASC NULLS FIRST], true
      +- Project [c_customer_id#413, c_salutation#419, c_first_name#420, c_last_name#421, ca_street_number#450, ca_street_name#451, ca_street_type#452, ca_suite_number#453, ca_city#454, ca_county#455, ca_state#456, ca_zip#457, ca_country#458, ca_gmt_offset#459, ca_location_type#460, ctr_total_return#45954]
         +- Filter (((cast(ctr_total_return#45954 as decimal(24,7)) > cast(scalar-subquery#45951 [ctr_state#45953] as decimal(24,7))) && (ca_address_sk#448 = c_current_addr_sk#416)) && ((ca_state#456 = GA) && (ctr_customer_sk#45952 = c_customer_sk#412)))
            :  +- Aggregate [CheckOverflow((promote_precision(cast(avg(ctr_total_return#45954) as decimal(21,6))) * promote_precision(cast(1.2 as decimal(21,6)))), DecimalType(24,7)) AS (CAST(avg(ctr_total_return) AS DECIMAL(21,6)) * CAST(1.2 AS DECIMAL(21,6)))#45957]
            :     +- Filter (outer(ctr_state#45953) = ctr_state#45953)
            :        +- SubqueryAlias `ctr2`
            :           +- SubqueryAlias `customer_total_return`
            :              +- Aggregate [cr_returning_customer_sk#75, ca_state#456], [cr_returning_customer_sk#75 AS ctr_customer_sk#45952, ca_state#456 AS ctr_state#45953, sum(cr_return_amt_inc_tax#88) AS ctr_total_return#45954]
            :                 +- Filter (((cr_returned_date_sk#68 = d_date_sk#492) && (d_year#498 = 2000)) && (cr_returning_addr_sk#78 = ca_address_sk#448))
            :                    +- Join Inner
            :                       :- Join Inner
            :                       :  :- SubqueryAlias `catalog_returns`
            :                       :  :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
            :                       :  +- SubqueryAlias `date_dim`
            :                       :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :                       +- SubqueryAlias `customer_address`
            :                          +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `ctr1`
               :  :  +- SubqueryAlias `customer_total_return`
               :  :     +- Aggregate [cr_returning_customer_sk#75, ca_state#456], [cr_returning_customer_sk#75 AS ctr_customer_sk#45952, ca_state#456 AS ctr_state#45953, sum(cr_return_amt_inc_tax#88) AS ctr_total_return#45954]
               :  :        +- Filter (((cr_returned_date_sk#68 = d_date_sk#492) && (d_year#498 = 2000)) && (cr_returning_addr_sk#78 = ca_address_sk#448))
               :  :           +- Join Inner
               :  :              :- Join Inner
               :  :              :  :- SubqueryAlias `catalog_returns`
               :  :              :  :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               :  :              :  +- SubqueryAlias `date_dim`
               :  :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :              +- SubqueryAlias `customer_address`
               :  :                 +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               :  +- SubqueryAlias `customer_address`
               :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
               +- SubqueryAlias `customer`
                  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet

      running Thread[benchmark runner,5,main]
Execution time: 76.99912633s
Running execution q82-v2.4 iteration: 1, StandardRun=true
19/10/04 11:56:48 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
19/10/04 11:56:48 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 229.939986398s
Running execution q83-v2.4 iteration: 1, StandardRun=true
19/10/04 12:00:40 INFO Query: 
== Query: q83-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_id#46094 ASC NULLS FIRST, sr_item_qty#46095L ASC NULLS FIRST], true
      +- Project [item_id#46094, sr_item_qty#46095L, (((cast(sr_item_qty#46095L as double) / cast(((sr_item_qty#46095L + cr_item_qty#46099L) + wr_item_qty#46103L) as double)) / cast(3.0 as double)) * cast(100 as double)) AS sr_dev#46090, cr_item_qty#46099L, (((cast(cr_item_qty#46099L as double) / cast(((sr_item_qty#46095L + cr_item_qty#46099L) + wr_item_qty#46103L) as double)) / cast(3.0 as double)) * cast(100 as double)) AS cr_dev#46091, wr_item_qty#46103L, (((cast(wr_item_qty#46103L as double) / cast(((sr_item_qty#46095L + cr_item_qty#46099L) + wr_item_qty#46103L) as double)) / cast(3.0 as double)) * cast(100 as double)) AS wr_dev#46092, CheckOverflow((promote_precision(cast(cast(((sr_item_qty#46095L + cr_item_qty#46099L) + wr_item_qty#46103L) as decimal(20,0)) as decimal(21,1))) / promote_precision(cast(3.0 as decimal(21,1)))), DecimalType(27,6)) AS average#46093]
         +- Filter ((item_id#46094 = item_id#46098) && (item_id#46094 = item_id#46102))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `sr_items`
               :  :  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#46094, sum(cast(sr_return_quantity#186 as bigint)) AS sr_item_qty#46095L]
               :  :     +- Filter (((sr_item_sk#178 = i_item_sk#564) && d_date#494 IN (list#46097 [])) && (sr_returned_date_sk#176 = d_date_sk#492))
               :  :        :  +- Project [d_date#494]
               :  :        :     +- Filter d_week_seq#496 IN (list#46096 [])
               :  :        :        :  +- Project [d_week_seq#496]
               :  :        :        :     +- Filter d_date#494 IN (cast(2000-06-30 as date),cast(2000-09-27 as date),cast(2000-11-17 as date))
               :  :        :        :        +- SubqueryAlias `date_dim`
               :  :        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        :        +- SubqueryAlias `date_dim`
               :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- SubqueryAlias `store_returns`
               :  :           :  :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :  :           :  +- SubqueryAlias `item`
               :  :           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- SubqueryAlias `date_dim`
               :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `cr_items`
               :     +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#46098, sum(cast(cr_return_quantity#85 as bigint)) AS cr_item_qty#46099L]
               :        +- Filter (((cr_item_sk#70 = i_item_sk#564) && d_date#494 IN (list#46101 [])) && (cr_returned_date_sk#68 = d_date_sk#492))
               :           :  +- Project [d_date#494]
               :           :     +- Filter d_week_seq#496 IN (list#46100 [])
               :           :        :  +- Project [d_week_seq#496]
               :           :        :     +- Filter d_date#494 IN (cast(2000-06-30 as date),cast(2000-09-27 as date),cast(2000-11-17 as date))
               :           :        :        +- SubqueryAlias `date_dim`
               :           :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Join Inner
               :              :- Join Inner
               :              :  :- SubqueryAlias `catalog_returns`
               :              :  :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               :              :  +- SubqueryAlias `item`
               :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- SubqueryAlias `date_dim`
               :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `wr_items`
                  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#46102, sum(cast(wr_return_quantity#298 as bigint)) AS wr_item_qty#46103L]
                     +- Filter (((wr_item_sk#286 = i_item_sk#564) && d_date#494 IN (list#46105 [])) && (wr_returned_date_sk#284 = d_date_sk#492))
                        :  +- Project [d_date#494]
                        :     +- Filter d_week_seq#496 IN (list#46104 [])
                        :        :  +- Project [d_week_seq#496]
                        :        :     +- Filter d_date#494 IN (cast(2000-06-30 as date),cast(2000-09-27 as date),cast(2000-11-17 as date))
                        :        :        +- SubqueryAlias `date_dim`
                        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `web_returns`
                           :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                           :  +- SubqueryAlias `item`
                           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/04 12:00:40 INFO Query: 
== Query: q83-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_id#46121 ASC NULLS FIRST, sr_item_qty#46122L ASC NULLS FIRST], true
      +- Project [item_id#46121, sr_item_qty#46122L, (((cast(sr_item_qty#46122L as double) / cast(((sr_item_qty#46122L + cr_item_qty#46126L) + wr_item_qty#46130L) as double)) / cast(3.0 as double)) * cast(100 as double)) AS sr_dev#46117, cr_item_qty#46126L, (((cast(cr_item_qty#46126L as double) / cast(((sr_item_qty#46122L + cr_item_qty#46126L) + wr_item_qty#46130L) as double)) / cast(3.0 as double)) * cast(100 as double)) AS cr_dev#46118, wr_item_qty#46130L, (((cast(wr_item_qty#46130L as double) / cast(((sr_item_qty#46122L + cr_item_qty#46126L) + wr_item_qty#46130L) as double)) / cast(3.0 as double)) * cast(100 as double)) AS wr_dev#46119, CheckOverflow((promote_precision(cast(cast(((sr_item_qty#46122L + cr_item_qty#46126L) + wr_item_qty#46130L) as decimal(20,0)) as decimal(21,1))) / promote_precision(cast(3.0 as decimal(21,1)))), DecimalType(27,6)) AS average#46120]
         +- Filter ((item_id#46121 = item_id#46125) && (item_id#46121 = item_id#46129))
            +- Join Inner
               :- Join Inner
               :  :- SubqueryAlias `sr_items`
               :  :  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#46121, sum(cast(sr_return_quantity#186 as bigint)) AS sr_item_qty#46122L]
               :  :     +- Filter (((sr_item_sk#178 = i_item_sk#564) && d_date#494 IN (list#46124 [])) && (sr_returned_date_sk#176 = d_date_sk#492))
               :  :        :  +- Project [d_date#494]
               :  :        :     +- Filter d_week_seq#496 IN (list#46123 [])
               :  :        :        :  +- Project [d_week_seq#496]
               :  :        :        :     +- Filter d_date#494 IN (cast(2000-06-30 as date),cast(2000-09-27 as date),cast(2000-11-17 as date))
               :  :        :        :        +- SubqueryAlias `date_dim`
               :  :        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        :        +- SubqueryAlias `date_dim`
               :  :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  :        +- Join Inner
               :  :           :- Join Inner
               :  :           :  :- SubqueryAlias `store_returns`
               :  :           :  :  +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
               :  :           :  +- SubqueryAlias `item`
               :  :           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :           +- SubqueryAlias `date_dim`
               :  :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :  +- SubqueryAlias `cr_items`
               :     +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#46125, sum(cast(cr_return_quantity#85 as bigint)) AS cr_item_qty#46126L]
               :        +- Filter (((cr_item_sk#70 = i_item_sk#564) && d_date#494 IN (list#46128 [])) && (cr_returned_date_sk#68 = d_date_sk#492))
               :           :  +- Project [d_date#494]
               :           :     +- Filter d_week_seq#496 IN (list#46127 [])
               :           :        :  +- Project [d_week_seq#496]
               :           :        :     +- Filter d_date#494 IN (cast(2000-06-30 as date),cast(2000-09-27 as date),cast(2000-11-17 as date))
               :           :        :        +- SubqueryAlias `date_dim`
               :           :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           :        +- SubqueryAlias `date_dim`
               :           :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               :           +- Join Inner
               :              :- Join Inner
               :              :  :- SubqueryAlias `catalog_returns`
               :              :  :  +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
               :              :  +- SubqueryAlias `item`
               :              :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :              +- SubqueryAlias `date_dim`
               :                 +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `wr_items`
                  +- Aggregate [i_item_id#565], [i_item_id#565 AS item_id#46129, sum(cast(wr_return_quantity#298 as bigint)) AS wr_item_qty#46130L]
                     +- Filter (((wr_item_sk#286 = i_item_sk#564) && d_date#494 IN (list#46132 [])) && (wr_returned_date_sk#284 = d_date_sk#492))
                        :  +- Project [d_date#494]
                        :     +- Filter d_week_seq#496 IN (list#46131 [])
                        :        :  +- Project [d_week_seq#496]
                        :        :     +- Filter d_date#494 IN (cast(2000-06-30 as date),cast(2000-09-27 as date),cast(2000-11-17 as date))
                        :        :        +- SubqueryAlias `date_dim`
                        :        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :        +- SubqueryAlias `date_dim`
                        :           +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        +- Join Inner
                           :- Join Inner
                           :  :- SubqueryAlias `web_returns`
                           :  :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                           :  +- SubqueryAlias `item`
                           :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                           +- SubqueryAlias `date_dim`
                              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 40.455909914s
Running execution q84-v2.4 iteration: 1, StandardRun=true
19/10/04 12:01:23 INFO Query: 
== Query: q84-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [customer_id#46218, customername#46219]
      +- Sort [c_customer_id#413 ASC NULLS FIRST], true
         +- Project [c_customer_id#413 AS customer_id#46218, ((cast(coalesce(c_last_name#421, ) as double) + cast(,  as double)) + cast(coalesce(c_first_name#420, ) as double)) AS customername#46219, c_customer_id#413]
            +- Filter ((((ca_city#454 = Edgewood) && (c_current_addr_sk#416 = ca_address_sk#448)) && ((ib_lower_bound#559 >= 38128) && (ib_upper_bound#560 <= (38128 + 50000)))) && (((ib_income_band_sk#558 = hd_income_band_sk#549) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && ((hd_demo_sk#548 = c_current_hdemo_sk#415) && (sr_cdemo_sk#180 = cd_demo_sk#474))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- SubqueryAlias `customer`
                  :  :  :  :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  :  :  :  +- SubqueryAlias `customer_address`
                  :  :  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  :  :  :  +- SubqueryAlias `customer_demographics`
                  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  +- SubqueryAlias `household_demographics`
                  :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                  :  +- SubqueryAlias `income_band`
                  :     +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                  +- SubqueryAlias `store_returns`
                     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet

     : benchmark
19/10/04 12:01:23 INFO Query: 
== Query: q84-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [customer_id#46222, customername#46223]
      +- Sort [c_customer_id#413 ASC NULLS FIRST], true
         +- Project [c_customer_id#413 AS customer_id#46222, ((cast(coalesce(c_last_name#421, ) as double) + cast(,  as double)) + cast(coalesce(c_first_name#420, ) as double)) AS customername#46223, c_customer_id#413]
            +- Filter ((((ca_city#454 = Edgewood) && (c_current_addr_sk#416 = ca_address_sk#448)) && ((ib_lower_bound#559 >= 38128) && (ib_upper_bound#560 <= (38128 + 50000)))) && (((ib_income_band_sk#558 = hd_income_band_sk#549) && (cd_demo_sk#474 = c_current_cdemo_sk#414)) && ((hd_demo_sk#548 = c_current_hdemo_sk#415) && (sr_cdemo_sk#180 = cd_demo_sk#474))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- SubqueryAlias `customer`
                  :  :  :  :  :  +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                  :  :  :  :  +- SubqueryAlias `customer_address`
                  :  :  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  :  :  :  +- SubqueryAlias `customer_demographics`
                  :  :  :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  +- SubqueryAlias `household_demographics`
                  :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                  :  +- SubqueryAlias `income_band`
                  :     +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                  +- SubqueryAlias `store_returns`
                     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet

      running Thread[benchmark runner,5,main]
Execution time: 55.401339106s
Running execution q85-v2.4 iteration: 1, StandardRun=true
19/10/04 12:02:20 INFO Query: 
== Query: q85-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [substring(r_reason_desc, 1, 20)#46286, avg(ws_quantity)#46287, avg(wr_refunded_cash)#46288, avg(wr_fee)#46289]
      +- Sort [substring(r_reason_desc, 1, 20)#46286 ASC NULLS FIRST, aggOrder#46291 ASC NULLS FIRST, avg(wr_refunded_cash)#46288 ASC NULLS FIRST, avg(wr_fee)#46289 ASC NULLS FIRST], true
         +- Aggregate [r_reason_desc#648], [substring(r_reason_desc#648, 1, 20) AS substring(r_reason_desc, 1, 20)#46286, avg(cast(ws_quantity#234 as bigint)) AS avg(ws_quantity)#46287, avg(wr_refunded_cash#304) AS avg(wr_refunded_cash)#46288, avg(wr_fee#302) AS avg(wr_fee)#46289, avg(cast(ws_quantity#234 as bigint)) AS aggOrder#46291]
            +- Filter (((((ws_web_page_sk#228 = wp_web_page_sk#770) && (ws_item_sk#219 = wr_item_sk#286)) && (ws_order_number#233L = wr_order_number#297L)) && (((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 2000)) && (cd_demo_sk#474 = wr_refunded_cdemo_sk#288))) && ((((cd_demo_sk#46274 = wr_returning_cdemo_sk#292) && (ca_address_sk#448 = wr_refunded_addr_sk#290)) && (r_reason_sk#646 = wr_reason_sk#296)) && (((((((cd_marital_status#476 = M) && (cd_marital_status#476 = cd_marital_status#46276)) && (cd_education_status#477 = Advanced Degree)) && ((cd_education_status#477 = cd_education_status#46277) && ((cast(ws_sales_price#237 as decimal(7,2)) >= cast(100.00 as decimal(7,2))) && (cast(ws_sales_price#237 as decimal(7,2)) <= cast(150.00 as decimal(7,2)))))) || ((((cd_marital_status#476 = S) && (cd_marital_status#476 = cd_marital_status#46276)) && (cd_education_status#477 = College)) && ((cd_education_status#477 = cd_education_status#46277) && ((cast(ws_sales_price#237 as decimal(7,2)) >= cast(50.00 as decimal(7,2))) && (cast(ws_sales_price#237 as decimal(7,2)) <= cast(100.00 as decimal(7,2))))))) || ((((cd_marital_status#476 = W) && (cd_marital_status#476 = cd_marital_status#46276)) && (cd_education_status#477 = 2 yr Degree)) && ((cd_education_status#477 = cd_education_status#46277) && ((cast(ws_sales_price#237 as decimal(7,2)) >= cast(150.00 as decimal(7,2))) && (cast(ws_sales_price#237 as decimal(7,2)) <= cast(200.00 as decimal(7,2))))))) && (((((ca_country#458 = United States) && ca_state#456 IN (IN,OH,NJ)) && ((cast(ws_net_profit#249 as decimal(7,2)) >= cast(cast(100 as decimal(3,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) <= cast(cast(200 as decimal(3,0)) as decimal(7,2))))) || (((ca_country#458 = United States) && ca_state#456 IN (WI,CT,KY)) && ((cast(ws_net_profit#249 as decimal(7,2)) >= cast(cast(150 as decimal(3,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) <= cast(cast(300 as decimal(3,0)) as decimal(7,2)))))) || (((ca_country#458 = United States) && ca_state#456 IN (LA,IA,AR)) && ((cast(ws_net_profit#249 as decimal(7,2)) >= cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) <= cast(cast(250 as decimal(3,0)) as decimal(7,2)))))))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias `web_sales`
                  :  :  :  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  :  :  :  :  +- SubqueryAlias `web_returns`
                  :  :  :  :  :  :     +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                  :  :  :  :  :  +- SubqueryAlias `web_page`
                  :  :  :  :  :     +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet
                  :  :  :  :  +- SubqueryAlias `cd1`
                  :  :  :  :     +- SubqueryAlias `customer_demographics`
                  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  :  +- SubqueryAlias `cd2`
                  :  :  :     +- SubqueryAlias `customer_demographics`
                  :  :  :        +- Relation[cd_demo_sk#46274,cd_gender#46275,cd_marital_status#46276,cd_education_status#46277,cd_purchase_estimate#46278,cd_credit_rating#46279,cd_dep_count#46280,cd_dep_employed_count#46281,cd_dep_college_count#46282] parquet
                  :  :  +- SubqueryAlias `customer_address`
                  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  :  +- SubqueryAlias `date_dim`
                  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `reason`
                     +- Relation[r_reason_sk#646,r_reason_id#647,r_reason_desc#648] parquet

     : benchmark
19/10/04 12:02:20 INFO Query: 
== Query: q85-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [substring(r_reason_desc, 1, 20)#46313, avg(ws_quantity)#46314, avg(wr_refunded_cash)#46315, avg(wr_fee)#46316]
      +- Sort [substring(r_reason_desc, 1, 20)#46313 ASC NULLS FIRST, aggOrder#46318 ASC NULLS FIRST, avg(wr_refunded_cash)#46315 ASC NULLS FIRST, avg(wr_fee)#46316 ASC NULLS FIRST], true
         +- Aggregate [r_reason_desc#648], [substring(r_reason_desc#648, 1, 20) AS substring(r_reason_desc, 1, 20)#46313, avg(cast(ws_quantity#234 as bigint)) AS avg(ws_quantity)#46314, avg(wr_refunded_cash#304) AS avg(wr_refunded_cash)#46315, avg(wr_fee#302) AS avg(wr_fee)#46316, avg(cast(ws_quantity#234 as bigint)) AS aggOrder#46318]
            +- Filter (((((ws_web_page_sk#228 = wp_web_page_sk#770) && (ws_item_sk#219 = wr_item_sk#286)) && (ws_order_number#233L = wr_order_number#297L)) && (((ws_sold_date_sk#216 = d_date_sk#492) && (d_year#498 = 2000)) && (cd_demo_sk#474 = wr_refunded_cdemo_sk#288))) && ((((cd_demo_sk#46301 = wr_returning_cdemo_sk#292) && (ca_address_sk#448 = wr_refunded_addr_sk#290)) && (r_reason_sk#646 = wr_reason_sk#296)) && (((((((cd_marital_status#476 = M) && (cd_marital_status#476 = cd_marital_status#46303)) && (cd_education_status#477 = Advanced Degree)) && ((cd_education_status#477 = cd_education_status#46304) && ((cast(ws_sales_price#237 as decimal(7,2)) >= cast(100.00 as decimal(7,2))) && (cast(ws_sales_price#237 as decimal(7,2)) <= cast(150.00 as decimal(7,2)))))) || ((((cd_marital_status#476 = S) && (cd_marital_status#476 = cd_marital_status#46303)) && (cd_education_status#477 = College)) && ((cd_education_status#477 = cd_education_status#46304) && ((cast(ws_sales_price#237 as decimal(7,2)) >= cast(50.00 as decimal(7,2))) && (cast(ws_sales_price#237 as decimal(7,2)) <= cast(100.00 as decimal(7,2))))))) || ((((cd_marital_status#476 = W) && (cd_marital_status#476 = cd_marital_status#46303)) && (cd_education_status#477 = 2 yr Degree)) && ((cd_education_status#477 = cd_education_status#46304) && ((cast(ws_sales_price#237 as decimal(7,2)) >= cast(150.00 as decimal(7,2))) && (cast(ws_sales_price#237 as decimal(7,2)) <= cast(200.00 as decimal(7,2))))))) && (((((ca_country#458 = United States) && ca_state#456 IN (IN,OH,NJ)) && ((cast(ws_net_profit#249 as decimal(7,2)) >= cast(cast(100 as decimal(3,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) <= cast(cast(200 as decimal(3,0)) as decimal(7,2))))) || (((ca_country#458 = United States) && ca_state#456 IN (WI,CT,KY)) && ((cast(ws_net_profit#249 as decimal(7,2)) >= cast(cast(150 as decimal(3,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) <= cast(cast(300 as decimal(3,0)) as decimal(7,2)))))) || (((ca_country#458 = United States) && ca_state#456 IN (LA,IA,AR)) && ((cast(ws_net_profit#249 as decimal(7,2)) >= cast(cast(50 as decimal(2,0)) as decimal(7,2))) && (cast(ws_net_profit#249 as decimal(7,2)) <= cast(cast(250 as decimal(3,0)) as decimal(7,2)))))))))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- Join Inner
                  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :- Join Inner
                  :  :  :  :  :  :  :- SubqueryAlias `web_sales`
                  :  :  :  :  :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  :  :  :  :  +- SubqueryAlias `web_returns`
                  :  :  :  :  :  :     +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
                  :  :  :  :  :  +- SubqueryAlias `web_page`
                  :  :  :  :  :     +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet
                  :  :  :  :  +- SubqueryAlias `cd1`
                  :  :  :  :     +- SubqueryAlias `customer_demographics`
                  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                  :  :  :  +- SubqueryAlias `cd2`
                  :  :  :     +- SubqueryAlias `customer_demographics`
                  :  :  :        +- Relation[cd_demo_sk#46301,cd_gender#46302,cd_marital_status#46303,cd_education_status#46304,cd_purchase_estimate#46305,cd_credit_rating#46306,cd_dep_count#46307,cd_dep_employed_count#46308,cd_dep_college_count#46309] parquet
                  :  :  +- SubqueryAlias `customer_address`
                  :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  :  +- SubqueryAlias `date_dim`
                  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  +- SubqueryAlias `reason`
                     +- Relation[r_reason_sk#646,r_reason_id#647,r_reason_desc#648] parquet

      running Thread[benchmark runner,5,main]
Execution time: 411.747124816s
Running execution q86-v2.4 iteration: 1, StandardRun=true
19/10/04 12:09:14 INFO Query: 
== Query: q86-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#46439 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#46439 as int) = 0) THEN i_category#46448 END ASC NULLS FIRST, rank_within_parent#46440 ASC NULLS FIRST], true
      +- Project [total_sum#46438, i_category#46448, i_class#46449, lochierarchy#46439, rank_within_parent#46440]
         +- Project [total_sum#46438, i_category#46448, i_class#46449, lochierarchy#46439, _w0#46458, _w1#46462, _w2#46463, _w3#46464, rank_within_parent#46440, rank_within_parent#46440]
            +- Window [rank(_w3#46464) windowspecdefinition(_w1#46462, _w2#46463, _w3#46464 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#46440], [_w1#46462, _w2#46463], [_w3#46464 DESC NULLS LAST]
               +- Aggregate [i_category#46448, i_class#46449, spark_grouping_id#46445], [sum(ws_net_paid#245) AS total_sum#46438, i_category#46448, i_class#46449, (cast((shiftright(spark_grouping_id#46445, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#46445, 0) & 1) as tinyint)) AS lochierarchy#46439, sum(ws_net_paid#245) AS _w0#46458, (cast((shiftright(spark_grouping_id#46445, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#46445, 0) & 1) as tinyint)) AS _w1#46462, CASE WHEN (cast(cast((shiftright(spark_grouping_id#46445, 0) & 1) as tinyint) as int) = 0) THEN i_category#46448 END AS _w2#46463, sum(ws_net_paid#245) AS _w3#46464]
                  +- Expand [List(ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ws_ext_wholesale_cost#240, ws_ext_list_price#241, ws_ext_tax#242, ws_coupon_amt#243, ws_ext_ship_cost#244, ws_net_paid#245, ws_net_paid_inc_tax#246, ws_net_paid_inc_ship#247, ws_net_paid_inc_ship_tax#248, ws_net_profit#249, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#46446, i_class#46447, 0), List(ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ws_ext_wholesale_cost#240, ws_ext_list_price#241, ws_ext_tax#242, ws_coupon_amt#243, ws_ext_ship_cost#244, ws_net_paid#245, ws_net_paid_inc_tax#246, ws_net_paid_inc_ship#247, ws_net_paid_inc_ship_tax#248, ws_net_profit#249, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#46446, null, 1), List(ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ws_ext_wholesale_cost#240, ws_ext_list_price#241, ws_ext_tax#242, ws_coupon_amt#243, ws_ext_ship_cost#244, ws_net_paid#245, ws_net_paid_inc_tax#246, ws_net_paid_inc_ship#247, ws_net_paid_inc_ship_tax#248, ws_net_profit#249, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, 3)], [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 63 more fields]
                     +- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 62 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ws_sold_date_sk#216)) && (i_item_sk#564 = ws_item_sk#219))
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `web_sales`
                              :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
19/10/04 12:09:14 INFO Query: 
== Query: q86-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#46480 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#46480 as int) = 0) THEN i_category#46489 END ASC NULLS FIRST, rank_within_parent#46481 ASC NULLS FIRST], true
      +- Project [total_sum#46479, i_category#46489, i_class#46490, lochierarchy#46480, rank_within_parent#46481]
         +- Project [total_sum#46479, i_category#46489, i_class#46490, lochierarchy#46480, _w0#46499, _w1#46503, _w2#46504, _w3#46505, rank_within_parent#46481, rank_within_parent#46481]
            +- Window [rank(_w3#46505) windowspecdefinition(_w1#46503, _w2#46504, _w3#46505 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#46481], [_w1#46503, _w2#46504], [_w3#46505 DESC NULLS LAST]
               +- Aggregate [i_category#46489, i_class#46490, spark_grouping_id#46486], [sum(ws_net_paid#245) AS total_sum#46479, i_category#46489, i_class#46490, (cast((shiftright(spark_grouping_id#46486, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#46486, 0) & 1) as tinyint)) AS lochierarchy#46480, sum(ws_net_paid#245) AS _w0#46499, (cast((shiftright(spark_grouping_id#46486, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#46486, 0) & 1) as tinyint)) AS _w1#46503, CASE WHEN (cast(cast((shiftright(spark_grouping_id#46486, 0) & 1) as tinyint) as int) = 0) THEN i_category#46489 END AS _w2#46504, sum(ws_net_paid#245) AS _w3#46505]
                  +- Expand [List(ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ws_ext_wholesale_cost#240, ws_ext_list_price#241, ws_ext_tax#242, ws_coupon_amt#243, ws_ext_ship_cost#244, ws_net_paid#245, ws_net_paid_inc_tax#246, ws_net_paid_inc_ship#247, ws_net_paid_inc_ship_tax#248, ws_net_profit#249, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#46487, i_class#46488, 0), List(ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ws_ext_wholesale_cost#240, ws_ext_list_price#241, ws_ext_tax#242, ws_coupon_amt#243, ws_ext_ship_cost#244, ws_net_paid#245, ws_net_paid_inc_tax#246, ws_net_paid_inc_ship#247, ws_net_paid_inc_ship_tax#248, ws_net_profit#249, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, i_category#46487, null, 1), List(ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ws_ext_wholesale_cost#240, ws_ext_list_price#241, ws_ext_tax#242, ws_coupon_amt#243, ws_ext_ship_cost#244, ws_net_paid#245, ws_net_paid_inc_tax#246, ws_net_paid_inc_ship#247, ws_net_paid_inc_ship_tax#248, ws_net_profit#249, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, i_item_sk#564, i_item_id#565, i_rec_start_date#566, i_rec_end_date#567, i_item_desc#568, i_current_price#569, i_wholesale_cost#570, i_brand_id#571, i_brand#572, i_class_id#573, i_class#574, i_category_id#575, i_category#576, i_manufact_id#577, i_manufact#578, i_size#579, i_formulation#580, i_color#581, i_units#582, i_container#583, i_manager_id#584, i_product_name#585, null, null, 3)], [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 63 more fields]
                     +- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 62 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ws_sold_date_sk#216)) && (i_item_sk#564 = ws_item_sk#219))
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `web_sales`
                              :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `item`
                                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 39.167525664s
Running execution q87-v2.4 iteration: 1, StandardRun=true
19/10/04 12:09:56 INFO Query: 
== Query: q87-v2.4 ==
Aggregate [count(1) AS count(1)#46867L]
+- SubqueryAlias `cool_cust`
   +- Except false
      :- Project [c_last_name#421, c_first_name#420, d_date#494]
      :  +- Except false
      :     :- Project [c_last_name#421, c_first_name#420, d_date#494]
      :     :  +- Distinct
      :     :     +- Project [c_last_name#421, c_first_name#420, d_date#494]
      :     :        +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_customer_sk#133 = c_customer_sk#412)) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
      :     :           +- Join Inner
      :     :              :- Join Inner
      :     :              :  :- SubqueryAlias `store_sales`
      :     :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
      :     :              :  +- SubqueryAlias `date_dim`
      :     :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
      :     :              +- SubqueryAlias `customer`
      :     :                 +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
      :     +- Project [c_last_name#46794, c_first_name#46793, d_date#46740]
      :        +- Distinct
      :           +- Project [c_last_name#46794, c_first_name#46793, d_date#46740]
      :              +- Filter (((cs_sold_date_sk#0 = d_date_sk#46738) && (cs_bill_customer_sk#3 = c_customer_sk#46785)) && ((d_month_seq#46741 >= 1200) && (d_month_seq#46741 <= (1200 + 11))))
      :                 +- Join Inner
      :                    :- Join Inner
      :                    :  :- SubqueryAlias `catalog_sales`
      :                    :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
      :                    :  +- SubqueryAlias `date_dim`
      :                    :     +- Relation[d_date_sk#46738,d_date_id#46739,d_date#46740,d_month_seq#46741,d_week_seq#46742,d_quarter_seq#46743,d_year#46744,d_dow#46745,d_moy#46746,d_dom#46747,d_qoy#46748,d_fy_year#46749,d_fy_quarter_seq#46750,d_fy_week_seq#46751,d_day_name#46752,d_quarter_name#46753,d_holiday#46754,d_weekend#46755,d_following_holiday#46756,d_first_dom#46757,d_last_dom#46758,d_same_day_ly#46759,d_same_day_lq#46760,d_current_day#46761,... 4 more fields] parquet
      :                    +- SubqueryAlias `customer`
      :                       +- Relation[c_customer_sk#46785,c_customer_id#46786,c_current_cdemo_sk#46787,c_current_hdemo_sk#46788,c_current_addr_sk#46789,c_first_shipto_date_sk#46790,c_first_sales_date_sk#46791,c_salutation#46792,c_first_name#46793,c_last_name#46794,c_preferred_cust_flag#46795,c_birth_day#46796,c_birth_month#46797,c_birth_year#46798,c_birth_country#46799,c_login#46800,c_email_address#46801,c_last_review_date#46802] parquet
      +- Project [c_last_name#46858, c_first_name#46857, d_date#46805]
         +- Distinct
            +- Project [c_last_name#46858, c_first_name#46857, d_date#46805]
               +- Filter (((ws_sold_date_sk#216 = d_date_sk#46803) && (ws_bill_customer_sk#220 = c_customer_sk#46849)) && ((d_month_seq#46806 >= 1200) && (d_month_seq#46806 <= (1200 + 11))))
                  +- Join Inner
                     :- Join Inner
                     :  :- SubqueryAlias `web_sales`
                     :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :  +- SubqueryAlias `date_dim`
                     :     +- Relation[d_date_sk#46803,d_date_id#46804,d_date#46805,d_month_seq#46806,d_week_seq#46807,d_quarter_seq#46808,d_year#46809,d_dow#46810,d_moy#46811,d_dom#46812,d_qoy#46813,d_fy_year#46814,d_fy_quarter_seq#46815,d_fy_week_seq#46816,d_day_name#46817,d_quarter_name#46818,d_holiday#46819,d_weekend#46820,d_following_holiday#46821,d_first_dom#46822,d_last_dom#46823,d_same_day_ly#46824,d_same_day_lq#46825,d_current_day#46826,... 4 more fields] parquet
                     +- SubqueryAlias `customer`
                        +- Relation[c_customer_sk#46849,c_customer_id#46850,c_current_cdemo_sk#46851,c_current_hdemo_sk#46852,c_current_addr_sk#46853,c_first_shipto_date_sk#46854,c_first_sales_date_sk#46855,c_salutation#46856,c_first_name#46857,c_last_name#46858,c_preferred_cust_flag#46859,c_birth_day#46860,c_birth_month#46861,c_birth_year#46862,c_birth_country#46863,c_login#46864,c_email_address#46865,c_last_review_date#46866] parquet

     : benchmark
19/10/04 12:09:56 INFO Query: 
== Query: q87-v2.4 ==
Aggregate [count(1) AS count(1)#46998L]
+- SubqueryAlias `cool_cust`
   +- Except false
      :- Project [c_last_name#421, c_first_name#420, d_date#494]
      :  +- Except false
      :     :- Project [c_last_name#421, c_first_name#420, d_date#494]
      :     :  +- Distinct
      :     :     +- Project [c_last_name#421, c_first_name#420, d_date#494]
      :     :        +- Filter (((ss_sold_date_sk#130 = d_date_sk#492) && (ss_customer_sk#133 = c_customer_sk#412)) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
      :     :           +- Join Inner
      :     :              :- Join Inner
      :     :              :  :- SubqueryAlias `store_sales`
      :     :              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
      :     :              :  +- SubqueryAlias `date_dim`
      :     :              :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
      :     :              +- SubqueryAlias `customer`
      :     :                 +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
      :     +- Project [c_last_name#46925, c_first_name#46924, d_date#46871]
      :        +- Distinct
      :           +- Project [c_last_name#46925, c_first_name#46924, d_date#46871]
      :              +- Filter (((cs_sold_date_sk#0 = d_date_sk#46869) && (cs_bill_customer_sk#3 = c_customer_sk#46916)) && ((d_month_seq#46872 >= 1200) && (d_month_seq#46872 <= (1200 + 11))))
      :                 +- Join Inner
      :                    :- Join Inner
      :                    :  :- SubqueryAlias `catalog_sales`
      :                    :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
      :                    :  +- SubqueryAlias `date_dim`
      :                    :     +- Relation[d_date_sk#46869,d_date_id#46870,d_date#46871,d_month_seq#46872,d_week_seq#46873,d_quarter_seq#46874,d_year#46875,d_dow#46876,d_moy#46877,d_dom#46878,d_qoy#46879,d_fy_year#46880,d_fy_quarter_seq#46881,d_fy_week_seq#46882,d_day_name#46883,d_quarter_name#46884,d_holiday#46885,d_weekend#46886,d_following_holiday#46887,d_first_dom#46888,d_last_dom#46889,d_same_day_ly#46890,d_same_day_lq#46891,d_current_day#46892,... 4 more fields] parquet
      :                    +- SubqueryAlias `customer`
      :                       +- Relation[c_customer_sk#46916,c_customer_id#46917,c_current_cdemo_sk#46918,c_current_hdemo_sk#46919,c_current_addr_sk#46920,c_first_shipto_date_sk#46921,c_first_sales_date_sk#46922,c_salutation#46923,c_first_name#46924,c_last_name#46925,c_preferred_cust_flag#46926,c_birth_day#46927,c_birth_month#46928,c_birth_year#46929,c_birth_country#46930,c_login#46931,c_email_address#46932,c_last_review_date#46933] parquet
      +- Project [c_last_name#46989, c_first_name#46988, d_date#46936]
         +- Distinct
            +- Project [c_last_name#46989, c_first_name#46988, d_date#46936]
               +- Filter (((ws_sold_date_sk#216 = d_date_sk#46934) && (ws_bill_customer_sk#220 = c_customer_sk#46980)) && ((d_month_seq#46937 >= 1200) && (d_month_seq#46937 <= (1200 + 11))))
                  +- Join Inner
                     :- Join Inner
                     :  :- SubqueryAlias `web_sales`
                     :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                     :  +- SubqueryAlias `date_dim`
                     :     +- Relation[d_date_sk#46934,d_date_id#46935,d_date#46936,d_month_seq#46937,d_week_seq#46938,d_quarter_seq#46939,d_year#46940,d_dow#46941,d_moy#46942,d_dom#46943,d_qoy#46944,d_fy_year#46945,d_fy_quarter_seq#46946,d_fy_week_seq#46947,d_day_name#46948,d_quarter_name#46949,d_holiday#46950,d_weekend#46951,d_following_holiday#46952,d_first_dom#46953,d_last_dom#46954,d_same_day_ly#46955,d_same_day_lq#46956,d_current_day#46957,... 4 more fields] parquet
                     +- SubqueryAlias `customer`
                        +- Relation[c_customer_sk#46980,c_customer_id#46981,c_current_cdemo_sk#46982,c_current_hdemo_sk#46983,c_current_addr_sk#46984,c_first_shipto_date_sk#46985,c_first_sales_date_sk#46986,c_salutation#46987,c_first_name#46988,c_last_name#46989,c_preferred_cust_flag#46990,c_birth_day#46991,c_birth_month#46992,c_birth_year#46993,c_birth_country#46994,c_login#46995,c_email_address#46996,c_last_review_date#46997] parquet

      running Thread[benchmark runner,5,main]
Execution time: 258.67097747400004s
Running execution q88-v2.4 iteration: 1, StandardRun=true
19/10/04 12:14:17 INFO Query: 
== Query: q88-v2.4 ==
Project [h8_30_to_9#47305L, h9_to_9_30#47306L, h9_30_to_10#47307L, h10_to_10_30#47308L, h10_30_to_11#47309L, h11_to_11_30#47310L, h11_30_to_12#47311L, h12_to_12_30#47312L]
+- Join Cross
   :- Join Cross
   :  :- Join Cross
   :  :  :- Join Cross
   :  :  :  :- Join Cross
   :  :  :  :  :- Join Cross
   :  :  :  :  :  :- Join Cross
   :  :  :  :  :  :  :- SubqueryAlias `s1`
   :  :  :  :  :  :  :  +- Aggregate [count(1) AS h8_30_to_9#47305L]
   :  :  :  :  :  :  :     +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 8))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :  :  :  :        +- Join Inner
   :  :  :  :  :  :  :           :- Join Inner
   :  :  :  :  :  :  :           :  :- Join Inner
   :  :  :  :  :  :  :           :  :  :- SubqueryAlias `store_sales`
   :  :  :  :  :  :  :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :  :  :  :           :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :  :  :  :           :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :  :  :  :           :  +- SubqueryAlias `time_dim`
   :  :  :  :  :  :  :           :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :  :  :  :           +- SubqueryAlias `store`
   :  :  :  :  :  :  :              +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  :  :  :  +- SubqueryAlias `s2`
   :  :  :  :  :  :     +- Aggregate [count(1) AS h9_to_9_30#47306L]
   :  :  :  :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 9))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :  :  :           +- Join Inner
   :  :  :  :  :  :              :- Join Inner
   :  :  :  :  :  :              :  :- Join Inner
   :  :  :  :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :  :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :  :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :  :  :              +- SubqueryAlias `store`
   :  :  :  :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  :  :  +- SubqueryAlias `s3`
   :  :  :  :  :     +- Aggregate [count(1) AS h9_30_to_10#47307L]
   :  :  :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 9))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :  :           +- Join Inner
   :  :  :  :  :              :- Join Inner
   :  :  :  :  :              :  :- Join Inner
   :  :  :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :  :              +- SubqueryAlias `store`
   :  :  :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  :  +- SubqueryAlias `s4`
   :  :  :  :     +- Aggregate [count(1) AS h10_to_10_30#47308L]
   :  :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 10))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :           +- Join Inner
   :  :  :  :              :- Join Inner
   :  :  :  :              :  :- Join Inner
   :  :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :              +- SubqueryAlias `store`
   :  :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  +- SubqueryAlias `s5`
   :  :  :     +- Aggregate [count(1) AS h10_30_to_11#47309L]
   :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 10))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :           +- Join Inner
   :  :  :              :- Join Inner
   :  :  :              :  :- Join Inner
   :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :              +- SubqueryAlias `store`
   :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  +- SubqueryAlias `s6`
   :  :     +- Aggregate [count(1) AS h11_to_11_30#47310L]
   :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 11))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :           +- Join Inner
   :  :              :- Join Inner
   :  :              :  :- Join Inner
   :  :              :  :  :- SubqueryAlias `store_sales`
   :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :              :  +- SubqueryAlias `time_dim`
   :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :              +- SubqueryAlias `store`
   :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  +- SubqueryAlias `s7`
   :     +- Aggregate [count(1) AS h11_30_to_12#47311L]
   :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 11))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :           +- Join Inner
   :              :- Join Inner
   :              :  :- Join Inner
   :              :  :  :- SubqueryAlias `store_sales`
   :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :              :  :  +- SubqueryAlias `household_demographics`
   :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :              :  +- SubqueryAlias `time_dim`
   :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :              +- SubqueryAlias `store`
   :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   +- SubqueryAlias `s8`
      +- Aggregate [count(1) AS h12_to_12_30#47312L]
         +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 12))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `store_sales`
               :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  +- SubqueryAlias `household_demographics`
               :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  +- SubqueryAlias `time_dim`
               :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
               +- SubqueryAlias `store`
                  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/10/04 12:14:17 INFO Query: 
== Query: q88-v2.4 ==
Project [h8_30_to_9#47329L, h9_to_9_30#47330L, h9_30_to_10#47331L, h10_to_10_30#47332L, h10_30_to_11#47333L, h11_to_11_30#47334L, h11_30_to_12#47335L, h12_to_12_30#47336L]
+- Join Cross
   :- Join Cross
   :  :- Join Cross
   :  :  :- Join Cross
   :  :  :  :- Join Cross
   :  :  :  :  :- Join Cross
   :  :  :  :  :  :- Join Cross
   :  :  :  :  :  :  :- SubqueryAlias `s1`
   :  :  :  :  :  :  :  +- Aggregate [count(1) AS h8_30_to_9#47329L]
   :  :  :  :  :  :  :     +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 8))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :  :  :  :        +- Join Inner
   :  :  :  :  :  :  :           :- Join Inner
   :  :  :  :  :  :  :           :  :- Join Inner
   :  :  :  :  :  :  :           :  :  :- SubqueryAlias `store_sales`
   :  :  :  :  :  :  :           :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :  :  :  :           :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :  :  :  :           :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :  :  :  :           :  +- SubqueryAlias `time_dim`
   :  :  :  :  :  :  :           :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :  :  :  :           +- SubqueryAlias `store`
   :  :  :  :  :  :  :              +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  :  :  :  +- SubqueryAlias `s2`
   :  :  :  :  :  :     +- Aggregate [count(1) AS h9_to_9_30#47330L]
   :  :  :  :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 9))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :  :  :           +- Join Inner
   :  :  :  :  :  :              :- Join Inner
   :  :  :  :  :  :              :  :- Join Inner
   :  :  :  :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :  :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :  :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :  :  :              +- SubqueryAlias `store`
   :  :  :  :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  :  :  +- SubqueryAlias `s3`
   :  :  :  :  :     +- Aggregate [count(1) AS h9_30_to_10#47331L]
   :  :  :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 9))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :  :           +- Join Inner
   :  :  :  :  :              :- Join Inner
   :  :  :  :  :              :  :- Join Inner
   :  :  :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :  :              +- SubqueryAlias `store`
   :  :  :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  :  +- SubqueryAlias `s4`
   :  :  :  :     +- Aggregate [count(1) AS h10_to_10_30#47332L]
   :  :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 10))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :  :           +- Join Inner
   :  :  :  :              :- Join Inner
   :  :  :  :              :  :- Join Inner
   :  :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :  :              +- SubqueryAlias `store`
   :  :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  :  +- SubqueryAlias `s5`
   :  :  :     +- Aggregate [count(1) AS h10_30_to_11#47333L]
   :  :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 10))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :  :           +- Join Inner
   :  :  :              :- Join Inner
   :  :  :              :  :- Join Inner
   :  :  :              :  :  :- SubqueryAlias `store_sales`
   :  :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :  :              :  +- SubqueryAlias `time_dim`
   :  :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :  :              +- SubqueryAlias `store`
   :  :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  :  +- SubqueryAlias `s6`
   :  :     +- Aggregate [count(1) AS h11_to_11_30#47334L]
   :  :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 11))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :  :           +- Join Inner
   :  :              :- Join Inner
   :  :              :  :- Join Inner
   :  :              :  :  :- SubqueryAlias `store_sales`
   :  :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :  :              :  :  +- SubqueryAlias `household_demographics`
   :  :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :  :              :  +- SubqueryAlias `time_dim`
   :  :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :  :              +- SubqueryAlias `store`
   :  :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   :  +- SubqueryAlias `s7`
   :     +- Aggregate [count(1) AS h11_30_to_12#47335L]
   :        +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 11))) && (((t_minute#726 >= 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
   :           +- Join Inner
   :              :- Join Inner
   :              :  :- Join Inner
   :              :  :  :- SubqueryAlias `store_sales`
   :              :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
   :              :  :  +- SubqueryAlias `household_demographics`
   :              :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
   :              :  +- SubqueryAlias `time_dim`
   :              :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
   :              +- SubqueryAlias `store`
   :                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
   +- SubqueryAlias `s8`
      +- Aggregate [count(1) AS h12_to_12_30#47336L]
         +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 12))) && (((t_minute#726 < 30) && ((((hd_dep_count#551 = 4) && (hd_vehicle_count#552 <= (4 + 2))) || ((hd_dep_count#551 = 2) && (hd_vehicle_count#552 <= (2 + 2)))) || ((hd_dep_count#551 = 0) && (hd_vehicle_count#552 <= (0 + 2))))) && (s_store_name#669 = ese)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `store_sales`
               :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
               :  :  +- SubqueryAlias `household_demographics`
               :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
               :  +- SubqueryAlias `time_dim`
               :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
               +- SubqueryAlias `store`
                  +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 410.598872722s
Running execution q89-v2.4 iteration: 1, StandardRun=true
19/10/04 12:21:11 INFO Query: 
== Query: q89-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#47434 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#47435 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
      +- Project [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum_sales#47434, avg_monthly_sales#47435]
         +- Filter (cast(CASE WHEN NOT (cast(avg_monthly_sales#47435 as decimal(21,6)) = cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#47434 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#47435 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#47435 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16)))
            +- SubqueryAlias `tmp1`
               +- Project [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum_sales#47434, avg_monthly_sales#47435]
                  +- Project [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum_sales#47434, _w0#47439, avg_monthly_sales#47435, avg_monthly_sales#47435]
                     +- Window [avg(_w0#47439) windowspecdefinition(i_category#576, i_brand#572, s_store_name#669, s_company_name#681, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#47435], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681]
                        +- Aggregate [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500], [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum(ss_sales_price#143) AS sum_sales#47434, sum(ss_sales_price#143) AS _w0#47439]
                           +- Filter ((((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_store_sk#137 = s_store_sk#664)) && (d_year#498 IN (1999) && ((i_category#576 IN (Books,Electronics,Sports) && i_class#574 IN (computers,stereo,football)) || (i_category#576 IN (Men,Jewelry,Women) && i_class#574 IN (shirts,birdal,dresses)))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `item`
                                 :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :  :  +- SubqueryAlias `store_sales`
                                 :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `date_dim`
                                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- SubqueryAlias `store`
                                    +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/10/04 12:21:11 INFO Query: 
== Query: q89-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [CheckOverflow((promote_precision(cast(sum_sales#47448 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#47449 as decimal(22,6)))), DecimalType(22,6)) ASC NULLS FIRST, s_store_name#669 ASC NULLS FIRST], true
      +- Project [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum_sales#47448, avg_monthly_sales#47449]
         +- Filter (cast(CASE WHEN NOT (cast(avg_monthly_sales#47449 as decimal(21,6)) = cast(cast(0 as decimal(1,0)) as decimal(21,6))) THEN CheckOverflow((promote_precision(cast(abs(CheckOverflow((promote_precision(cast(sum_sales#47448 as decimal(22,6))) - promote_precision(cast(avg_monthly_sales#47449 as decimal(22,6)))), DecimalType(22,6))) as decimal(22,6))) / promote_precision(cast(avg_monthly_sales#47449 as decimal(22,6)))), DecimalType(38,16)) ELSE cast(null as decimal(38,16)) END as decimal(38,16)) > cast(0.1 as decimal(38,16)))
            +- SubqueryAlias `tmp1`
               +- Project [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum_sales#47448, avg_monthly_sales#47449]
                  +- Project [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum_sales#47448, _w0#47453, avg_monthly_sales#47449, avg_monthly_sales#47449]
                     +- Window [avg(_w0#47453) windowspecdefinition(i_category#576, i_brand#572, s_store_name#669, s_company_name#681, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS avg_monthly_sales#47449], [i_category#576, i_brand#572, s_store_name#669, s_company_name#681]
                        +- Aggregate [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500], [i_category#576, i_class#574, i_brand#572, s_store_name#669, s_company_name#681, d_moy#500, sum(ss_sales_price#143) AS sum_sales#47448, sum(ss_sales_price#143) AS _w0#47453]
                           +- Filter ((((ss_item_sk#132 = i_item_sk#564) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_store_sk#137 = s_store_sk#664)) && (d_year#498 IN (1999) && ((i_category#576 IN (Books,Electronics,Sports) && i_class#574 IN (computers,stereo,football)) || (i_category#576 IN (Men,Jewelry,Women) && i_class#574 IN (shirts,birdal,dresses)))))
                              +- Join Inner
                                 :- Join Inner
                                 :  :- Join Inner
                                 :  :  :- SubqueryAlias `item`
                                 :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                                 :  :  +- SubqueryAlias `store_sales`
                                 :  :     +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                                 :  +- SubqueryAlias `date_dim`
                                 :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                                 +- SubqueryAlias `store`
                                    +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 112.619199596s
Running execution q90-v2.4 iteration: 1, StandardRun=true
19/10/04 12:23:06 INFO Query: 
== Query: q90-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [am_pm_ratio#47505 ASC NULLS FIRST], true
      +- Project [CheckOverflow((promote_precision(cast(cast(amc#47503L as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(pmc#47504L as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS am_pm_ratio#47505]
         +- Join Cross
            :- SubqueryAlias `at`
            :  +- Aggregate [count(1) AS amc#47503L]
            :     +- Filter ((((ws_sold_time_sk#217 = t_time_sk#722) && (ws_ship_hdemo_sk#226 = hd_demo_sk#548)) && (ws_web_page_sk#228 = wp_web_page_sk#770)) && ((((t_hour#725 >= 8) && (t_hour#725 <= (8 + 1))) && (hd_dep_count#551 = 6)) && ((wp_char_count#780 >= 5000) && (wp_char_count#780 <= 5200))))
            :        +- Join Inner
            :           :- Join Inner
            :           :  :- Join Inner
            :           :  :  :- SubqueryAlias `web_sales`
            :           :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :           :  :  +- SubqueryAlias `household_demographics`
            :           :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
            :           :  +- SubqueryAlias `time_dim`
            :           :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
            :           +- SubqueryAlias `web_page`
            :              +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet
            +- SubqueryAlias `pt`
               +- Aggregate [count(1) AS pmc#47504L]
                  +- Filter ((((ws_sold_time_sk#217 = t_time_sk#722) && (ws_ship_hdemo_sk#226 = hd_demo_sk#548)) && (ws_web_page_sk#228 = wp_web_page_sk#770)) && ((((t_hour#725 >= 19) && (t_hour#725 <= (19 + 1))) && (hd_dep_count#551 = 6)) && ((wp_char_count#780 >= 5000) && (wp_char_count#780 <= 5200))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- SubqueryAlias `web_sales`
                        :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  :  +- SubqueryAlias `household_demographics`
                        :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  +- SubqueryAlias `time_dim`
                        :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                        +- SubqueryAlias `web_page`
                           +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet

     : benchmark
19/10/04 12:23:06 INFO Query: 
== Query: q90-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [am_pm_ratio#47511 ASC NULLS FIRST], true
      +- Project [CheckOverflow((promote_precision(cast(cast(amc#47509L as decimal(15,4)) as decimal(15,4))) / promote_precision(cast(cast(pmc#47510L as decimal(15,4)) as decimal(15,4)))), DecimalType(35,20)) AS am_pm_ratio#47511]
         +- Join Cross
            :- SubqueryAlias `at`
            :  +- Aggregate [count(1) AS amc#47509L]
            :     +- Filter ((((ws_sold_time_sk#217 = t_time_sk#722) && (ws_ship_hdemo_sk#226 = hd_demo_sk#548)) && (ws_web_page_sk#228 = wp_web_page_sk#770)) && ((((t_hour#725 >= 8) && (t_hour#725 <= (8 + 1))) && (hd_dep_count#551 = 6)) && ((wp_char_count#780 >= 5000) && (wp_char_count#780 <= 5200))))
            :        +- Join Inner
            :           :- Join Inner
            :           :  :- Join Inner
            :           :  :  :- SubqueryAlias `web_sales`
            :           :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
            :           :  :  +- SubqueryAlias `household_demographics`
            :           :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
            :           :  +- SubqueryAlias `time_dim`
            :           :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
            :           +- SubqueryAlias `web_page`
            :              +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet
            +- SubqueryAlias `pt`
               +- Aggregate [count(1) AS pmc#47510L]
                  +- Filter ((((ws_sold_time_sk#217 = t_time_sk#722) && (ws_ship_hdemo_sk#226 = hd_demo_sk#548)) && (ws_web_page_sk#228 = wp_web_page_sk#770)) && ((((t_hour#725 >= 19) && (t_hour#725 <= (19 + 1))) && (hd_dep_count#551 = 6)) && ((wp_char_count#780 >= 5000) && (wp_char_count#780 <= 5200))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- SubqueryAlias `web_sales`
                        :  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                        :  :  +- SubqueryAlias `household_demographics`
                        :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  +- SubqueryAlias `time_dim`
                        :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                        +- SubqueryAlias `web_page`
                           +- Relation[wp_web_page_sk#770,wp_web_page_id#771,wp_rec_start_date#772,wp_rec_end_date#773,wp_creation_date_sk#774,wp_access_date_sk#775,wp_autogen_flag#776,wp_customer_sk#777,wp_url#778,wp_type#779,wp_char_count#780,wp_link_count#781,wp_image_count#782,wp_max_ad_count#783] parquet

      running Thread[benchmark runner,5,main]
Execution time: 43.549873152s
Running execution q91-v2.4 iteration: 1, StandardRun=true
19/10/04 12:23:52 INFO Query: 
== Query: q91-v2.4 ==
Project [Call_Center#47545, Call_Center_Name#47546, Manager#47547, Returns_Loss#47548]
+- Sort [Returns_Loss#47548 DESC NULLS LAST], true
   +- Aggregate [cc_call_center_id#333, cc_name#338, cc_manager#343, cd_marital_status#476, cd_education_status#477], [cc_call_center_id#333 AS Call_Center#47545, cc_name#338 AS Call_Center_Name#47546, cc_manager#343 AS Manager#47547, sum(cr_net_loss#94) AS Returns_Loss#47548]
      +- Filter (((((cr_call_center_sk#79 = cc_call_center_sk#332) && (cr_returned_date_sk#68 = d_date_sk#492)) && (cr_returning_customer_sk#75 = c_customer_sk#412)) && (((cd_demo_sk#474 = c_current_cdemo_sk#414) && (hd_demo_sk#548 = c_current_hdemo_sk#415)) && (ca_address_sk#448 = c_current_addr_sk#416))) && ((((d_year#498 = 1998) && (d_moy#500 = 11)) && (((cd_marital_status#476 = M) && (cd_education_status#477 = Unknown)) || ((cd_marital_status#476 = W) && (cd_education_status#477 = Advanced Degree)))) && (hd_buy_potential#550 LIKE Unknown% && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-7 as decimal(1,0)) as decimal(5,2))))))
         +- Join Inner
            :- Join Inner
            :  :- Join Inner
            :  :  :- Join Inner
            :  :  :  :- Join Inner
            :  :  :  :  :- Join Inner
            :  :  :  :  :  :- SubqueryAlias `call_center`
            :  :  :  :  :  :  +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet
            :  :  :  :  :  +- SubqueryAlias `catalog_returns`
            :  :  :  :  :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
            :  :  :  :  +- SubqueryAlias `date_dim`
            :  :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  :  :  +- SubqueryAlias `customer`
            :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :  :  +- SubqueryAlias `customer_address`
            :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            :  +- SubqueryAlias `customer_demographics`
            :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
            +- SubqueryAlias `household_demographics`
               +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet

     : benchmark
19/10/04 12:23:52 INFO Query: 
== Query: q91-v2.4 ==
Project [Call_Center#47556, Call_Center_Name#47557, Manager#47558, Returns_Loss#47559]
+- Sort [Returns_Loss#47559 DESC NULLS LAST], true
   +- Aggregate [cc_call_center_id#333, cc_name#338, cc_manager#343, cd_marital_status#476, cd_education_status#477], [cc_call_center_id#333 AS Call_Center#47556, cc_name#338 AS Call_Center_Name#47557, cc_manager#343 AS Manager#47558, sum(cr_net_loss#94) AS Returns_Loss#47559]
      +- Filter (((((cr_call_center_sk#79 = cc_call_center_sk#332) && (cr_returned_date_sk#68 = d_date_sk#492)) && (cr_returning_customer_sk#75 = c_customer_sk#412)) && (((cd_demo_sk#474 = c_current_cdemo_sk#414) && (hd_demo_sk#548 = c_current_hdemo_sk#415)) && (ca_address_sk#448 = c_current_addr_sk#416))) && ((((d_year#498 = 1998) && (d_moy#500 = 11)) && (((cd_marital_status#476 = M) && (cd_education_status#477 = Unknown)) || ((cd_marital_status#476 = W) && (cd_education_status#477 = Advanced Degree)))) && (hd_buy_potential#550 LIKE Unknown% && (cast(ca_gmt_offset#459 as decimal(5,2)) = cast(cast(-7 as decimal(1,0)) as decimal(5,2))))))
         +- Join Inner
            :- Join Inner
            :  :- Join Inner
            :  :  :- Join Inner
            :  :  :  :- Join Inner
            :  :  :  :  :- Join Inner
            :  :  :  :  :  :- SubqueryAlias `call_center`
            :  :  :  :  :  :  +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet
            :  :  :  :  :  +- SubqueryAlias `catalog_returns`
            :  :  :  :  :     +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
            :  :  :  :  +- SubqueryAlias `date_dim`
            :  :  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
            :  :  :  +- SubqueryAlias `customer`
            :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
            :  :  +- SubqueryAlias `customer_address`
            :  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
            :  +- SubqueryAlias `customer_demographics`
            :     +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
            +- SubqueryAlias `household_demographics`
               +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet

      running Thread[benchmark runner,5,main]
Execution time: 33.70510499s
Running execution q92-v2.4 iteration: 1, StandardRun=true
19/10/04 12:24:28 INFO Query: 
== Query: q92-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [Excess Discount Amount#47607]
      +- Sort [Excess Discount Amount#47607 ASC NULLS FIRST], true
         +- Aggregate [sum(ws_ext_discount_amt#238) AS Excess Discount Amount#47607]
            +- Filter ((((i_manufact_id#577 = 350) && (i_item_sk#564 = ws_item_sk#219)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && ((d_date_sk#492 = ws_sold_date_sk#216) && (cast(ws_ext_discount_amt#238 as decimal(14,7)) > cast(scalar-subquery#47608 [i_item_sk#564] as decimal(14,7)))))
               :  +- Aggregate [CheckOverflow((promote_precision(cast(1.3 as decimal(11,6))) * promote_precision(cast(avg(ws_ext_discount_amt#238) as decimal(11,6)))), DecimalType(14,7)) AS (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(ws_ext_discount_amt) AS DECIMAL(11,6)))#47610]
               :     +- Filter (((ws_item_sk#219 = outer(i_item_sk#564)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && (d_date_sk#492 = ws_sold_date_sk#216))
               :        +- Join Inner
               :           :- SubqueryAlias `web_sales`
               :           :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :           +- SubqueryAlias `date_dim`
               :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- SubqueryAlias `web_sales`
                  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/04 12:24:28 INFO Query: 
== Query: q92-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [Excess Discount Amount#47615]
      +- Sort [Excess Discount Amount#47615 ASC NULLS FIRST], true
         +- Aggregate [sum(ws_ext_discount_amt#238) AS Excess Discount Amount#47615]
            +- Filter ((((i_manufact_id#577 = 350) && (i_item_sk#564 = ws_item_sk#219)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && ((d_date_sk#492 = ws_sold_date_sk#216) && (cast(ws_ext_discount_amt#238 as decimal(14,7)) > cast(scalar-subquery#47616 [i_item_sk#564] as decimal(14,7)))))
               :  +- Aggregate [CheckOverflow((promote_precision(cast(1.3 as decimal(11,6))) * promote_precision(cast(avg(ws_ext_discount_amt#238) as decimal(11,6)))), DecimalType(14,7)) AS (CAST(1.3 AS DECIMAL(11,6)) * CAST(avg(ws_ext_discount_amt) AS DECIMAL(11,6)))#47618]
               :     +- Filter (((ws_item_sk#219 = outer(i_item_sk#564)) && ((d_date#494 >= cast(2000-01-27 as date)) && (d_date#494 <= cast(cast(cast(2000-01-27 as date) as timestamp) + interval 12 weeks 6 days as date)))) && (d_date_sk#492 = ws_sold_date_sk#216))
               :        +- Join Inner
               :           :- SubqueryAlias `web_sales`
               :           :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :           +- SubqueryAlias `date_dim`
               :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- SubqueryAlias `web_sales`
                  :  :  +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  +- SubqueryAlias `item`
                  :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 57.531506837s
Running execution q93-v2.4 iteration: 1, StandardRun=true
19/10/04 12:25:27 INFO Query: 
== Query: q93-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [sumsales#47657 ASC NULLS FIRST, ss_customer_sk#133 ASC NULLS FIRST], true
      +- Aggregate [ss_customer_sk#133], [ss_customer_sk#133, sum(act_sales#47656) AS sumsales#47657]
         +- SubqueryAlias `t`
            +- Project [ss_item_sk#132, ss_ticket_number#139L, ss_customer_sk#133, CASE WHEN isnotnull(sr_return_quantity#186) THEN CheckOverflow((promote_precision(cast(cast((ss_quantity#140 - sr_return_quantity#186) as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)) ELSE CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)) END AS act_sales#47656]
               +- Filter ((sr_reason_sk#184 = r_reason_sk#646) && (r_reason_desc#648 = reason 28))
                  +- Join Inner
                     :- Join LeftOuter, ((sr_item_sk#178 = ss_item_sk#132) && (sr_ticket_number#185L = ss_ticket_number#139L))
                     :  :- SubqueryAlias `store_sales`
                     :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  +- SubqueryAlias `store_returns`
                     :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     +- SubqueryAlias `reason`
                        +- Relation[r_reason_sk#646,r_reason_id#647,r_reason_desc#648] parquet

     : benchmark
19/10/04 12:25:27 INFO Query: 
== Query: q93-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [sumsales#47664 ASC NULLS FIRST, ss_customer_sk#133 ASC NULLS FIRST], true
      +- Aggregate [ss_customer_sk#133], [ss_customer_sk#133, sum(act_sales#47663) AS sumsales#47664]
         +- SubqueryAlias `t`
            +- Project [ss_item_sk#132, ss_ticket_number#139L, ss_customer_sk#133, CASE WHEN isnotnull(sr_return_quantity#186) THEN CheckOverflow((promote_precision(cast(cast((ss_quantity#140 - sr_return_quantity#186) as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)) ELSE CheckOverflow((promote_precision(cast(cast(ss_quantity#140 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_sales_price#143 as decimal(12,2)))), DecimalType(18,2)) END AS act_sales#47663]
               +- Filter ((sr_reason_sk#184 = r_reason_sk#646) && (r_reason_desc#648 = reason 28))
                  +- Join Inner
                     :- Join LeftOuter, ((sr_item_sk#178 = ss_item_sk#132) && (sr_ticket_number#185L = ss_ticket_number#139L))
                     :  :- SubqueryAlias `store_sales`
                     :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  +- SubqueryAlias `store_returns`
                     :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                     +- SubqueryAlias `reason`
                        +- Relation[r_reason_sk#646,r_reason_id#647,r_reason_desc#648] parquet

      running Thread[benchmark runner,5,main]
Execution time: 1704.9782812689998s
Running execution q94-v2.4 iteration: 1, StandardRun=true
19/10/04 12:53:54 INFO Query: 
== Query: q94-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [order count#47742L, total shipping cost#47743, total net profit#47744]
      +- Sort [order count#47742L ASC NULLS FIRST], true
         +- Aggregate [count(distinct ws_order_number#233L) AS order count#47742L, sum(ws_ext_ship_cost#244) AS total shipping cost#47743, sum(ws_net_profit#249) AS total net profit#47744]
            +- Filter (((((d_date#494 >= cast(1999-02-01 as date)) && (d_date#494 <= cast(cast(cast(1999-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))) && (ws_ship_date_sk#218 = d_date_sk#492)) && ((ws_ship_addr_sk#227 = ca_address_sk#448) && (ca_state#456 = IL))) && (((ws_web_site_sk#229 = web_site_sk#798) && (web_company_name#812 = pri)) && (exists#47745 [ws_order_number#233L && ws_warehouse_sk#231] && NOT exists#47746 [ws_order_number#233L])))
               :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 10 more fields]
               :  :  +- Filter ((outer(ws_order_number#233L) = ws_order_number#233L) && NOT (outer(ws_warehouse_sk#231) = ws_warehouse_sk#231))
               :  :     +- SubqueryAlias `ws2`
               :  :        +- SubqueryAlias `web_sales`
               :  :           +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  +- Project [wr_returned_date_sk#284, wr_returned_time_sk#285, wr_item_sk#286, wr_refunded_customer_sk#287, wr_refunded_cdemo_sk#288, wr_refunded_hdemo_sk#289, wr_refunded_addr_sk#290, wr_returning_customer_sk#291, wr_returning_cdemo_sk#292, wr_returning_hdemo_sk#293, wr_returning_addr_sk#294, wr_web_page_sk#295, wr_reason_sk#296, wr_order_number#297L, wr_return_quantity#298, wr_return_amt#299, wr_return_tax#300, wr_return_amt_inc_tax#301, wr_fee#302, wr_return_ship_cost#303, wr_refunded_cash#304, wr_reversed_charge#305, wr_account_credit#306, wr_net_loss#307]
               :     +- Filter (outer(ws_order_number#233L) = wr_order_number#297L)
               :        +- SubqueryAlias `wr1`
               :           +- SubqueryAlias `web_returns`
               :              +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `ws1`
                  :  :  :  +- SubqueryAlias `web_sales`
                  :  :  :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `web_site`
                     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet

     : benchmark
19/10/04 12:53:54 INFO Query: 
== Query: q94-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [order count#47755L, total shipping cost#47756, total net profit#47757]
      +- Sort [order count#47755L ASC NULLS FIRST], true
         +- Aggregate [count(distinct ws_order_number#233L) AS order count#47755L, sum(ws_ext_ship_cost#244) AS total shipping cost#47756, sum(ws_net_profit#249) AS total net profit#47757]
            +- Filter (((((d_date#494 >= cast(1999-02-01 as date)) && (d_date#494 <= cast(cast(cast(1999-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))) && (ws_ship_date_sk#218 = d_date_sk#492)) && ((ws_ship_addr_sk#227 = ca_address_sk#448) && (ca_state#456 = IL))) && (((ws_web_site_sk#229 = web_site_sk#798) && (web_company_name#812 = pri)) && (exists#47758 [ws_order_number#233L && ws_warehouse_sk#231] && NOT exists#47759 [ws_order_number#233L])))
               :  :- Project [ws_sold_date_sk#216, ws_sold_time_sk#217, ws_ship_date_sk#218, ws_item_sk#219, ws_bill_customer_sk#220, ws_bill_cdemo_sk#221, ws_bill_hdemo_sk#222, ws_bill_addr_sk#223, ws_ship_customer_sk#224, ws_ship_cdemo_sk#225, ws_ship_hdemo_sk#226, ws_ship_addr_sk#227, ws_web_page_sk#228, ws_web_site_sk#229, ws_ship_mode_sk#230, ws_warehouse_sk#231, ws_promo_sk#232, ws_order_number#233L, ws_quantity#234, ws_wholesale_cost#235, ws_list_price#236, ws_sales_price#237, ws_ext_discount_amt#238, ws_ext_sales_price#239, ... 10 more fields]
               :  :  +- Filter ((outer(ws_order_number#233L) = ws_order_number#233L) && NOT (outer(ws_warehouse_sk#231) = ws_warehouse_sk#231))
               :  :     +- SubqueryAlias `ws2`
               :  :        +- SubqueryAlias `web_sales`
               :  :           +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  +- Project [wr_returned_date_sk#284, wr_returned_time_sk#285, wr_item_sk#286, wr_refunded_customer_sk#287, wr_refunded_cdemo_sk#288, wr_refunded_hdemo_sk#289, wr_refunded_addr_sk#290, wr_returning_customer_sk#291, wr_returning_cdemo_sk#292, wr_returning_hdemo_sk#293, wr_returning_addr_sk#294, wr_web_page_sk#295, wr_reason_sk#296, wr_order_number#297L, wr_return_quantity#298, wr_return_amt#299, wr_return_tax#300, wr_return_amt_inc_tax#301, wr_fee#302, wr_return_ship_cost#303, wr_refunded_cash#304, wr_reversed_charge#305, wr_account_credit#306, wr_net_loss#307]
               :     +- Filter (outer(ws_order_number#233L) = wr_order_number#297L)
               :        +- SubqueryAlias `wr1`
               :           +- SubqueryAlias `web_returns`
               :              +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `ws1`
                  :  :  :  +- SubqueryAlias `web_sales`
                  :  :  :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `web_site`
                     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 386.63608946799997s
Running execution q95-v2.4 iteration: 1, StandardRun=true
19/10/04 13:00:22 INFO Query: 
== Query: q95-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [order count#47895L, total shipping cost#47896, total net profit#47897]
      +- Sort [order count#47895L ASC NULLS FIRST], true
         +- Aggregate [count(distinct ws_order_number#233L) AS order count#47895L, sum(ws_ext_ship_cost#244) AS total shipping cost#47896, sum(ws_net_profit#249) AS total net profit#47897]
            +- Filter (((((d_date#494 >= cast(1999-02-01 as date)) && (d_date#494 <= cast(cast(cast(1999-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))) && (ws_ship_date_sk#218 = d_date_sk#492)) && ((ws_ship_addr_sk#227 = ca_address_sk#448) && (ca_state#456 = IL))) && (((ws_web_site_sk#229 = web_site_sk#798) && (web_company_name#812 = pri)) && (ws_order_number#233L IN (list#47898 []) && ws_order_number#233L IN (list#47899 []))))
               :  :- Project [ws_order_number#233L]
               :  :  +- SubqueryAlias `ws_wh`
               :  :     +- Project [ws_order_number#233L, ws_warehouse_sk#231 AS wh1#47900, ws_warehouse_sk#47917 AS wh2#47901]
               :  :        +- Filter ((ws_order_number#233L = ws_order_number#47919L) && NOT (ws_warehouse_sk#231 = ws_warehouse_sk#47917))
               :  :           +- Join Inner
               :  :              :- SubqueryAlias `ws1`
               :  :              :  +- SubqueryAlias `web_sales`
               :  :              :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :              +- SubqueryAlias `ws2`
               :  :                 +- SubqueryAlias `web_sales`
               :  :                    +- Relation[ws_sold_date_sk#47902,ws_sold_time_sk#47903,ws_ship_date_sk#47904,ws_item_sk#47905,ws_bill_customer_sk#47906,ws_bill_cdemo_sk#47907,ws_bill_hdemo_sk#47908,ws_bill_addr_sk#47909,ws_ship_customer_sk#47910,ws_ship_cdemo_sk#47911,ws_ship_hdemo_sk#47912,ws_ship_addr_sk#47913,ws_web_page_sk#47914,ws_web_site_sk#47915,ws_ship_mode_sk#47916,ws_warehouse_sk#47917,ws_promo_sk#47918,ws_order_number#47919L,ws_quantity#47920,ws_wholesale_cost#47921,ws_list_price#47922,ws_sales_price#47923,ws_ext_discount_amt#47924,ws_ext_sales_price#47925,... 10 more fields] parquet
               :  +- Project [wr_order_number#297L]
               :     +- Filter (wr_order_number#297L = ws_order_number#233L)
               :        +- Join Inner
               :           :- SubqueryAlias `web_returns`
               :           :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               :           +- SubqueryAlias `ws_wh`
               :              +- Project [ws_order_number#233L, ws_warehouse_sk#231 AS wh1#47900, ws_warehouse_sk#47917 AS wh2#47901]
               :                 +- Filter ((ws_order_number#233L = ws_order_number#47919L) && NOT (ws_warehouse_sk#231 = ws_warehouse_sk#47917))
               :                    +- Join Inner
               :                       :- SubqueryAlias `ws1`
               :                       :  +- SubqueryAlias `web_sales`
               :                       :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                       +- SubqueryAlias `ws2`
               :                          +- SubqueryAlias `web_sales`
               :                             +- Relation[ws_sold_date_sk#47902,ws_sold_time_sk#47903,ws_ship_date_sk#47904,ws_item_sk#47905,ws_bill_customer_sk#47906,ws_bill_cdemo_sk#47907,ws_bill_hdemo_sk#47908,ws_bill_addr_sk#47909,ws_ship_customer_sk#47910,ws_ship_cdemo_sk#47911,ws_ship_hdemo_sk#47912,ws_ship_addr_sk#47913,ws_web_page_sk#47914,ws_web_site_sk#47915,ws_ship_mode_sk#47916,ws_warehouse_sk#47917,ws_promo_sk#47918,ws_order_number#47919L,ws_quantity#47920,ws_wholesale_cost#47921,ws_list_price#47922,ws_sales_price#47923,ws_ext_discount_amt#47924,ws_ext_sales_price#47925,... 10 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `ws1`
                  :  :  :  +- SubqueryAlias `web_sales`
                  :  :  :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `web_site`
                     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet

     : benchmark
19/10/04 13:00:22 INFO Query: 
== Query: q95-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [order count#47944L, total shipping cost#47945, total net profit#47946]
      +- Sort [order count#47944L ASC NULLS FIRST], true
         +- Aggregate [count(distinct ws_order_number#233L) AS order count#47944L, sum(ws_ext_ship_cost#244) AS total shipping cost#47945, sum(ws_net_profit#249) AS total net profit#47946]
            +- Filter (((((d_date#494 >= cast(1999-02-01 as date)) && (d_date#494 <= cast(cast(cast(1999-02-01 as date) as timestamp) + interval 8 weeks 4 days as date))) && (ws_ship_date_sk#218 = d_date_sk#492)) && ((ws_ship_addr_sk#227 = ca_address_sk#448) && (ca_state#456 = IL))) && (((ws_web_site_sk#229 = web_site_sk#798) && (web_company_name#812 = pri)) && (ws_order_number#233L IN (list#47947 []) && ws_order_number#233L IN (list#47948 []))))
               :  :- Project [ws_order_number#233L]
               :  :  +- SubqueryAlias `ws_wh`
               :  :     +- Project [ws_order_number#233L, ws_warehouse_sk#231 AS wh1#47949, ws_warehouse_sk#47966 AS wh2#47950]
               :  :        +- Filter ((ws_order_number#233L = ws_order_number#47968L) && NOT (ws_warehouse_sk#231 = ws_warehouse_sk#47966))
               :  :           +- Join Inner
               :  :              :- SubqueryAlias `ws1`
               :  :              :  +- SubqueryAlias `web_sales`
               :  :              :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :  :              +- SubqueryAlias `ws2`
               :  :                 +- SubqueryAlias `web_sales`
               :  :                    +- Relation[ws_sold_date_sk#47951,ws_sold_time_sk#47952,ws_ship_date_sk#47953,ws_item_sk#47954,ws_bill_customer_sk#47955,ws_bill_cdemo_sk#47956,ws_bill_hdemo_sk#47957,ws_bill_addr_sk#47958,ws_ship_customer_sk#47959,ws_ship_cdemo_sk#47960,ws_ship_hdemo_sk#47961,ws_ship_addr_sk#47962,ws_web_page_sk#47963,ws_web_site_sk#47964,ws_ship_mode_sk#47965,ws_warehouse_sk#47966,ws_promo_sk#47967,ws_order_number#47968L,ws_quantity#47969,ws_wholesale_cost#47970,ws_list_price#47971,ws_sales_price#47972,ws_ext_discount_amt#47973,ws_ext_sales_price#47974,... 10 more fields] parquet
               :  +- Project [wr_order_number#297L]
               :     +- Filter (wr_order_number#297L = ws_order_number#233L)
               :        +- Join Inner
               :           :- SubqueryAlias `web_returns`
               :           :  +- Relation[wr_returned_date_sk#284,wr_returned_time_sk#285,wr_item_sk#286,wr_refunded_customer_sk#287,wr_refunded_cdemo_sk#288,wr_refunded_hdemo_sk#289,wr_refunded_addr_sk#290,wr_returning_customer_sk#291,wr_returning_cdemo_sk#292,wr_returning_hdemo_sk#293,wr_returning_addr_sk#294,wr_web_page_sk#295,wr_reason_sk#296,wr_order_number#297L,wr_return_quantity#298,wr_return_amt#299,wr_return_tax#300,wr_return_amt_inc_tax#301,wr_fee#302,wr_return_ship_cost#303,wr_refunded_cash#304,wr_reversed_charge#305,wr_account_credit#306,wr_net_loss#307] parquet
               :           +- SubqueryAlias `ws_wh`
               :              +- Project [ws_order_number#233L, ws_warehouse_sk#231 AS wh1#47949, ws_warehouse_sk#47966 AS wh2#47950]
               :                 +- Filter ((ws_order_number#233L = ws_order_number#47968L) && NOT (ws_warehouse_sk#231 = ws_warehouse_sk#47966))
               :                    +- Join Inner
               :                       :- SubqueryAlias `ws1`
               :                       :  +- SubqueryAlias `web_sales`
               :                       :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
               :                       +- SubqueryAlias `ws2`
               :                          +- SubqueryAlias `web_sales`
               :                             +- Relation[ws_sold_date_sk#47951,ws_sold_time_sk#47952,ws_ship_date_sk#47953,ws_item_sk#47954,ws_bill_customer_sk#47955,ws_bill_cdemo_sk#47956,ws_bill_hdemo_sk#47957,ws_bill_addr_sk#47958,ws_ship_customer_sk#47959,ws_ship_cdemo_sk#47960,ws_ship_hdemo_sk#47961,ws_ship_addr_sk#47962,ws_web_page_sk#47963,ws_web_site_sk#47964,ws_ship_mode_sk#47965,ws_warehouse_sk#47966,ws_promo_sk#47967,ws_order_number#47968L,ws_quantity#47969,ws_wholesale_cost#47970,ws_list_price#47971,ws_sales_price#47972,ws_ext_discount_amt#47973,ws_ext_sales_price#47974,... 10 more fields] parquet
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `ws1`
                  :  :  :  +- SubqueryAlias `web_sales`
                  :  :  :     +- Relation[ws_sold_date_sk#216,ws_sold_time_sk#217,ws_ship_date_sk#218,ws_item_sk#219,ws_bill_customer_sk#220,ws_bill_cdemo_sk#221,ws_bill_hdemo_sk#222,ws_bill_addr_sk#223,ws_ship_customer_sk#224,ws_ship_cdemo_sk#225,ws_ship_hdemo_sk#226,ws_ship_addr_sk#227,ws_web_page_sk#228,ws_web_site_sk#229,ws_ship_mode_sk#230,ws_warehouse_sk#231,ws_promo_sk#232,ws_order_number#233L,ws_quantity#234,ws_wholesale_cost#235,ws_list_price#236,ws_sales_price#237,ws_ext_discount_amt#238,ws_ext_sales_price#239,... 10 more fields] parquet
                  :  :  +- SubqueryAlias `date_dim`
                  :  :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                  :  +- SubqueryAlias `customer_address`
                  :     +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                  +- SubqueryAlias `web_site`
                     +- Relation[web_site_sk#798,web_site_id#799,web_rec_start_date#800,web_rec_end_date#801,web_name#802,web_open_date_sk#803,web_close_date_sk#804,web_class#805,web_manager#806,web_mkt_id#807,web_mkt_class#808,web_mkt_desc#809,web_market_manager#810,web_company_id#811,web_company_name#812,web_street_number#813,web_street_name#814,web_street_type#815,web_suite_number#816,web_city#817,web_county#818,web_state#819,web_zip#820,web_country#821,... 2 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 1840.6238451s
Running execution q96-v2.4 iteration: 1, StandardRun=true
19/10/04 13:31:04 INFO Query: 
== Query: q96-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [count(1)#48110L]
      +- Sort [count(1)#48110L ASC NULLS FIRST], true
         +- Aggregate [count(1) AS count(1)#48110L]
            +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 20))) && (((t_minute#726 >= 30) && (hd_dep_count#551 = 7)) && (s_store_name#669 = ese)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  +- SubqueryAlias `household_demographics`
                  :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                  :  +- SubqueryAlias `time_dim`
                  :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                  +- SubqueryAlias `store`
                     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
19/10/04 13:31:04 INFO Query: 
== Query: q96-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [count(1)#48115L]
      +- Sort [count(1)#48115L ASC NULLS FIRST], true
         +- Aggregate [count(1) AS count(1)#48115L]
            +- Filter ((((ss_sold_time_sk#131 = t_time_sk#722) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && ((ss_store_sk#137 = s_store_sk#664) && (t_hour#725 = 20))) && (((t_minute#726 >= 30) && (hd_dep_count#551 = 7)) && (s_store_name#669 = ese)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- SubqueryAlias `store_sales`
                  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                  :  :  +- SubqueryAlias `household_demographics`
                  :  :     +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                  :  +- SubqueryAlias `time_dim`
                  :     +- Relation[t_time_sk#722,t_time_id#723,t_time#724,t_hour#725,t_minute#726,t_second#727,t_am_pm#728,t_shift#729,t_sub_shift#730,t_meal_time#731] parquet
                  +- SubqueryAlias `store`
                     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 67.108407903s
Running execution q97-v2.4 iteration: 1, StandardRun=true
19/10/04 13:32:13 INFO Query: 
== Query: q97-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [sum(cast(CASE WHEN (isnotnull(customer_sk#48153) && isnull(customer_sk#48155)) THEN 1 ELSE 0 END as bigint)) AS store_only#48150L, sum(cast(CASE WHEN (isnull(customer_sk#48153) && isnotnull(customer_sk#48155)) THEN 1 ELSE 0 END as bigint)) AS catalog_only#48151L, sum(cast(CASE WHEN (isnotnull(customer_sk#48153) && isnotnull(customer_sk#48155)) THEN 1 ELSE 0 END as bigint)) AS store_and_catalog#48152L]
      +- Join FullOuter, ((customer_sk#48153 = customer_sk#48155) && (item_sk#48154 = item_sk#48156))
         :- SubqueryAlias `ssci`
         :  +- Aggregate [ss_customer_sk#133, ss_item_sk#132], [ss_customer_sk#133 AS customer_sk#48153, ss_item_sk#132 AS item_sk#48154]
         :     +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
         :        +- Join Inner
         :           :- SubqueryAlias `store_sales`
         :           :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :           +- SubqueryAlias `date_dim`
         :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- SubqueryAlias `csci`
            +- Aggregate [cs_bill_customer_sk#3, cs_item_sk#15], [cs_bill_customer_sk#3 AS customer_sk#48155, cs_item_sk#15 AS item_sk#48156]
               +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
                  +- Join Inner
                     :- SubqueryAlias `catalog_sales`
                     :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/04 13:32:13 INFO Query: 
== Query: q97-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Aggregate [sum(cast(CASE WHEN (isnotnull(customer_sk#48166) && isnull(customer_sk#48168)) THEN 1 ELSE 0 END as bigint)) AS store_only#48163L, sum(cast(CASE WHEN (isnull(customer_sk#48166) && isnotnull(customer_sk#48168)) THEN 1 ELSE 0 END as bigint)) AS catalog_only#48164L, sum(cast(CASE WHEN (isnotnull(customer_sk#48166) && isnotnull(customer_sk#48168)) THEN 1 ELSE 0 END as bigint)) AS store_and_catalog#48165L]
      +- Join FullOuter, ((customer_sk#48166 = customer_sk#48168) && (item_sk#48167 = item_sk#48169))
         :- SubqueryAlias `ssci`
         :  +- Aggregate [ss_customer_sk#133, ss_item_sk#132], [ss_customer_sk#133 AS customer_sk#48166, ss_item_sk#132 AS item_sk#48167]
         :     +- Filter ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
         :        +- Join Inner
         :           :- SubqueryAlias `store_sales`
         :           :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :           +- SubqueryAlias `date_dim`
         :              +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         +- SubqueryAlias `csci`
            +- Aggregate [cs_bill_customer_sk#3, cs_item_sk#15], [cs_bill_customer_sk#3 AS customer_sk#48168, cs_item_sk#15 AS item_sk#48169]
               +- Filter ((cs_sold_date_sk#0 = d_date_sk#492) && ((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))))
                  +- Join Inner
                     :- SubqueryAlias `catalog_sales`
                     :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 428.423760324s
Running execution q98-v2.4 iteration: 1, StandardRun=true
19/10/04 13:39:23 INFO Query: 
== Query: q98-v2.4 ==
Project [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#48226, revenueratio#48227]
+- Sort [i_category#576 ASC NULLS FIRST, i_class#574 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, revenueratio#48227 ASC NULLS FIRST], true
   +- Project [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#48226, revenueratio#48227, i_item_id#565]
      +- Project [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#48226, _w0#48232, _w1#48233, _we0#48234, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(_w0#48232 as decimal(17,2))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(17,2)))), DecimalType(21,2)) as decimal(27,2))) / promote_precision(cast(_we0#48234 as decimal(27,2)))), DecimalType(38,17)) AS revenueratio#48227, i_item_id#565]
         +- Window [sum(_w1#48233) windowspecdefinition(i_class#574, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#48234], [i_class#574]
            +- Aggregate [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569], [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, sum(ss_ext_sales_price#145) AS itemrevenue#48226, sum(ss_ext_sales_price#145) AS _w0#48232, sum(ss_ext_sales_price#145) AS _w1#48233, i_item_id#565]
               +- Filter (((ss_item_sk#132 = i_item_sk#564) && i_category#576 IN (Sports,Books,Home)) && ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_date#494 >= cast(1999-02-22 as date)) && (d_date#494 <= cast(cast(cast(1999-02-22 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                  +- Join Inner
                     :- Join Inner
                     :  :- SubqueryAlias `store_sales`
                     :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  +- SubqueryAlias `item`
                     :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/04 13:39:23 INFO Query: 
== Query: q98-v2.4 ==
Project [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#48241, revenueratio#48242]
+- Sort [i_category#576 ASC NULLS FIRST, i_class#574 ASC NULLS FIRST, i_item_id#565 ASC NULLS FIRST, i_item_desc#568 ASC NULLS FIRST, revenueratio#48242 ASC NULLS FIRST], true
   +- Project [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#48241, revenueratio#48242, i_item_id#565]
      +- Project [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, itemrevenue#48241, _w0#48247, _w1#48248, _we0#48249, CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(_w0#48247 as decimal(17,2))) * promote_precision(cast(cast(100 as decimal(3,0)) as decimal(17,2)))), DecimalType(21,2)) as decimal(27,2))) / promote_precision(cast(_we0#48249 as decimal(27,2)))), DecimalType(38,17)) AS revenueratio#48242, i_item_id#565]
         +- Window [sum(_w1#48248) windowspecdefinition(i_class#574, specifiedwindowframe(RowFrame, unboundedpreceding$(), unboundedfollowing$())) AS _we0#48249], [i_class#574]
            +- Aggregate [i_item_id#565, i_item_desc#568, i_category#576, i_class#574, i_current_price#569], [i_item_desc#568, i_category#576, i_class#574, i_current_price#569, sum(ss_ext_sales_price#145) AS itemrevenue#48241, sum(ss_ext_sales_price#145) AS _w0#48247, sum(ss_ext_sales_price#145) AS _w1#48248, i_item_id#565]
               +- Filter (((ss_item_sk#132 = i_item_sk#564) && i_category#576 IN (Sports,Books,Home)) && ((ss_sold_date_sk#130 = d_date_sk#492) && ((d_date#494 >= cast(1999-02-22 as date)) && (d_date#494 <= cast(cast(cast(1999-02-22 as date) as timestamp) + interval 4 weeks 2 days as date)))))
                  +- Join Inner
                     :- Join Inner
                     :  :- SubqueryAlias `store_sales`
                     :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                     :  +- SubqueryAlias `item`
                     :     +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
                     +- SubqueryAlias `date_dim`
                        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 639.0719912740001s
Running execution q99-v2.4 iteration: 1, StandardRun=true
19/10/04 13:50:04 INFO Query: 
== Query: q99-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [substring(w_warehouse_name, 1, 20)#48332, sm_type#654, cc_name#338, 30 days#48322L, 31-60 days#48323L, 61-90 days#48324L, 91-120 days#48325L, >120 days#48326L]
      +- Sort [substring(w_warehouse_name, 1, 20)#48332 ASC NULLS FIRST, sm_type#654 ASC NULLS FIRST, cc_name#338 ASC NULLS FIRST], true
         +- Aggregate [substring(w_warehouse_name#744, 1, 20), sm_type#654, cc_name#338], [substring(w_warehouse_name#744, 1, 20) AS substring(w_warehouse_name, 1, 20)#48332, sm_type#654, cc_name#338, sum(cast(CASE WHEN ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days#48322L, sum(cast(CASE WHEN (((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 30) && ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31-60 days#48323L, sum(cast(CASE WHEN (((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 60) && ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61-90 days#48324L, sum(cast(CASE WHEN (((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 90) && ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91-120 days#48325L, sum(cast(CASE WHEN ((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days#48326L]
            +- Filter (((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (cs_ship_date_sk#2 = d_date_sk#492)) && (cs_warehouse_sk#14 = w_warehouse_sk#742)) && ((cs_ship_mode_sk#13 = sm_ship_mode_sk#652) && (cs_call_center_sk#11 = cc_call_center_sk#332)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `warehouse`
                  :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :  :  +- SubqueryAlias `ship_mode`
                  :  :     +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet
                  :  +- SubqueryAlias `call_center`
                  :     +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

     : benchmark
19/10/04 13:50:04 INFO Query: 
== Query: q99-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Project [substring(w_warehouse_name, 1, 20)#48354, sm_type#654, cc_name#338, 30 days#48344L, 31-60 days#48345L, 61-90 days#48346L, 91-120 days#48347L, >120 days#48348L]
      +- Sort [substring(w_warehouse_name, 1, 20)#48354 ASC NULLS FIRST, sm_type#654 ASC NULLS FIRST, cc_name#338 ASC NULLS FIRST], true
         +- Aggregate [substring(w_warehouse_name#744, 1, 20), sm_type#654, cc_name#338], [substring(w_warehouse_name#744, 1, 20) AS substring(w_warehouse_name, 1, 20)#48354, sm_type#654, cc_name#338, sum(cast(CASE WHEN ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 30) THEN 1 ELSE 0 END as bigint)) AS 30 days#48344L, sum(cast(CASE WHEN (((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 30) && ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 60)) THEN 1 ELSE 0 END as bigint)) AS 31-60 days#48345L, sum(cast(CASE WHEN (((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 60) && ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 90)) THEN 1 ELSE 0 END as bigint)) AS 61-90 days#48346L, sum(cast(CASE WHEN (((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 90) && ((cs_ship_date_sk#2 - cs_sold_date_sk#0) <= 120)) THEN 1 ELSE 0 END as bigint)) AS 91-120 days#48347L, sum(cast(CASE WHEN ((cs_ship_date_sk#2 - cs_sold_date_sk#0) > 120) THEN 1 ELSE 0 END as bigint)) AS >120 days#48348L]
            +- Filter (((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (cs_ship_date_sk#2 = d_date_sk#492)) && (cs_warehouse_sk#14 = w_warehouse_sk#742)) && ((cs_ship_mode_sk#13 = sm_ship_mode_sk#652) && (cs_call_center_sk#11 = cc_call_center_sk#332)))
               +- Join Inner
                  :- Join Inner
                  :  :- Join Inner
                  :  :  :- Join Inner
                  :  :  :  :- SubqueryAlias `catalog_sales`
                  :  :  :  :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                  :  :  :  +- SubqueryAlias `warehouse`
                  :  :  :     +- Relation[w_warehouse_sk#742,w_warehouse_id#743,w_warehouse_name#744,w_warehouse_sq_ft#745,w_street_number#746,w_street_name#747,w_street_type#748,w_suite_number#749,w_city#750,w_county#751,w_state#752,w_zip#753,w_country#754,w_gmt_offset#755] parquet
                  :  :  +- SubqueryAlias `ship_mode`
                  :  :     +- Relation[sm_ship_mode_sk#652,sm_ship_mode_id#653,sm_type#654,sm_code#655,sm_carrier#656,sm_contract#657] parquet
                  :  +- SubqueryAlias `call_center`
                  :     +- Relation[cc_call_center_sk#332,cc_call_center_id#333,cc_rec_start_date#334,cc_rec_end_date#335,cc_closed_date_sk#336,cc_open_date_sk#337,cc_name#338,cc_class#339,cc_employees#340,cc_sq_ft#341,cc_hours#342,cc_manager#343,cc_mkt_id#344,cc_mkt_class#345,cc_mkt_desc#346,cc_market_manager#347,cc_division#348,cc_division_name#349,cc_company#350,cc_company_name#351,cc_street_number#352,cc_street_name#353,cc_street_type#354,cc_suite_number#355,... 7 more fields] parquet
                  +- SubqueryAlias `date_dim`
                     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 78.394189752s
Running execution ss_max-v2.4 iteration: 1, StandardRun=true
19/10/04 13:51:24 INFO Query: 
== Query: ss_max-v2.4 ==
Aggregate [count(1) AS total#48484L, count(ss_sold_date_sk#130) AS not_null_total#48485L, count(distinct ss_sold_date_sk#130) AS unique_days#48486L, max(ss_sold_date_sk#130) AS max_ss_sold_date_sk#48487, max(ss_sold_time_sk#131) AS max_ss_sold_time_sk#48488, max(ss_item_sk#132) AS max_ss_item_sk#48489, max(ss_customer_sk#133) AS max_ss_customer_sk#48490, max(ss_cdemo_sk#134) AS max_ss_cdemo_sk#48491, max(ss_hdemo_sk#135) AS max_ss_hdemo_sk#48492, max(ss_addr_sk#136) AS max_ss_addr_sk#48493, max(ss_store_sk#137) AS max_ss_store_sk#48494, max(ss_promo_sk#138) AS max_ss_promo_sk#48495]
+- SubqueryAlias `store_sales`
   +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
19/10/04 13:51:24 INFO Query: 
== Query: ss_max-v2.4 ==
Aggregate [count(1) AS total#48520L, count(ss_sold_date_sk#130) AS not_null_total#48521L, count(distinct ss_sold_date_sk#130) AS unique_days#48522L, max(ss_sold_date_sk#130) AS max_ss_sold_date_sk#48523, max(ss_sold_time_sk#131) AS max_ss_sold_time_sk#48524, max(ss_item_sk#132) AS max_ss_item_sk#48525, max(ss_customer_sk#133) AS max_ss_customer_sk#48526, max(ss_cdemo_sk#134) AS max_ss_cdemo_sk#48527, max(ss_hdemo_sk#135) AS max_ss_hdemo_sk#48528, max(ss_addr_sk#136) AS max_ss_addr_sk#48529, max(ss_store_sk#137) AS max_ss_store_sk#48530, max(ss_promo_sk#138) AS max_ss_promo_sk#48531]
+- SubqueryAlias `store_sales`
   +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 160.181613911s
Results written to table: 'sqlPerformance' at s3a://spark-k8s-data/TPCDS-TEST-10T-RESULT/timestamp=1570115064375
19/10/04 13:54:07 WARN TaskSetManager: Stage 1232 contains a task of very large size (3056 KB). The maximum recommended task size is 100 KB.
19/10/04 13:54:07 WARN AbstractS3ACommitter: Task committer attempt_20191004135406_0000_m_000000_0: No pending uploads to commit
Reading result at s3a://spark-k8s-data/TPCDS-TEST-10T-RESULT/timestamp=1570115064375
+--------------------+---------+--------------------+------+-------------+
|       configuration|iteration|             results|  tags|    timestamp|
+--------------------+---------+--------------------+------+-------------+
|[95, [spark-6aa15...|        1|[[0.012179, [], 9...|[true]|1570115064375|
+--------------------+---------+--------------------+------+-------------+

+---------+---------+------------------+
|iteration|queryName|  executionSeconds|
+---------+---------+------------------+
|        1|  q1-v2.4|       98.89859649|
|        1|  q2-v2.4|140.93035673999998|
|        1|  q3-v2.4|     105.633772108|
|        1|  q4-v2.4|    3450.169137807|
|        1|  q5-v2.4| 568.9026054689999|
|        1|  q6-v2.4|     596.171334013|
|        1|  q7-v2.4|     177.796985989|
|        1|  q8-v2.4|      120.20683601|
|        1|  q9-v2.4| 696.9336391859999|
|        1| q10-v2.4|     143.826036353|
|        1| q11-v2.4|    1228.461315144|
|        1| q12-v2.4|129.03560363100001|
|        1| q13-v2.4|    1088.311795565|
|        1|q14a-v2.4|              null|
|        1|q14b-v2.4|              null|
|        1| q15-v2.4|     591.053319881|
|        1| q16-v2.4|     833.761417844|
|        1| q17-v2.4|    1918.513243911|
|        1| q18-v2.4|     203.597169828|
|        1| q19-v2.4|137.64453125400001|
+---------+---------+------------------+
only showing top 20 rows

Final results at s3a://spark-k8s-data/TPCDS-TEST-10T-RESULT/timestamp=1570115064375
19/10/04 13:54:12 WARN AbstractS3ACommitter: Task committer attempt_20191004135409_0000_m_000000_0: No pending uploads to commit
+-----------+--------------------+-----------------+-----------------+
|  queryName|medianRuntimeSeconds|minRuntimeSeconds|maxRuntimeSeconds|
+-----------+--------------------+-----------------+-----------------+
|    q1-v2.4|                98.0|               98|               98|
|   q10-v2.4|               143.0|              143|              143|
|   q11-v2.4|              1228.0|             1228|             1228|
|   q12-v2.4|               129.0|              129|              129|
|   q13-v2.4|              1088.0|             1088|             1088|
|  q14a-v2.4|                null|             null|             null|
|  q14b-v2.4|                null|             null|             null|
|   q15-v2.4|               591.0|              591|              591|
|   q16-v2.4|               833.0|              833|              833|
|   q17-v2.4|              1918.0|             1918|             1918|
|   q18-v2.4|               203.0|              203|              203|
|   q19-v2.4|               137.0|              137|              137|
|    q2-v2.4|               140.0|              140|              140|
|   q20-v2.4|               298.0|              298|              298|
|   q21-v2.4|                16.0|               16|               16|
|   q22-v2.4|               351.0|              351|              351|
|  q23a-v2.4|              4534.0|             4534|             4534|
|  q23b-v2.4|              3415.0|             3415|             3415|
|  q24a-v2.4|              3885.0|             3885|             3885|
|  q24b-v2.4|              3928.0|             3928|             3928|
|   q25-v2.4|              2162.0|             2162|             2162|
|   q26-v2.4|               108.0|              108|              108|
|   q27-v2.4|               177.0|              177|              177|
|   q28-v2.4|               506.0|              506|              506|
|   q29-v2.4|              1920.0|             1920|             1920|
|    q3-v2.4|               105.0|              105|              105|
|   q30-v2.4|                74.0|               74|               74|
|   q31-v2.4|               395.0|              395|              395|
|   q32-v2.4|               124.0|              124|              124|
|   q33-v2.4|               235.0|              235|              235|
|   q34-v2.4|                96.0|               96|               96|
|   q35-v2.4|               183.0|              183|              183|
|   q36-v2.4|               142.0|              142|              142|
|   q37-v2.4|               133.0|              133|              133|
|   q38-v2.4|               246.0|              246|              246|
|  q39a-v2.4|                18.0|               18|               18|
|  q39b-v2.4|                14.0|               14|               14|
|    q4-v2.4|              3450.0|             3450|             3450|
|   q40-v2.4|               467.0|              467|              467|
|   q41-v2.4|                 2.0|                2|                2|
|   q42-v2.4|                97.0|               97|               97|
|   q43-v2.4|                86.0|               86|               86|
|   q44-v2.4|               253.0|              253|              253|
|   q45-v2.4|               300.0|              300|              300|
|   q46-v2.4|               167.0|              167|              167|
|   q47-v2.4|               213.0|              213|              213|
|   q48-v2.4|               190.0|              190|              190|
|   q49-v2.4|               504.0|              504|              504|
|    q5-v2.4|               568.0|              568|              568|
|   q50-v2.4|               996.0|              996|              996|
|   q51-v2.4|               225.0|              225|              225|
|   q52-v2.4|                93.0|               93|               93|
|   q53-v2.4|               106.0|              106|              106|
|   q54-v2.4|               675.0|              675|              675|
|   q55-v2.4|                98.0|               98|               98|
|   q56-v2.4|               240.0|              240|              240|
|   q57-v2.4|               108.0|              108|              108|
|   q58-v2.4|               199.0|              199|              199|
|   q59-v2.4|               197.0|              197|              197|
|    q6-v2.4|               596.0|              596|              596|
|   q60-v2.4|               230.0|              230|              230|
|   q61-v2.4|               276.0|              276|              276|
|   q62-v2.4|                41.0|               41|               41|
|   q63-v2.4|               101.0|              101|              101|
|   q64-v2.4|              3300.0|             3300|             3300|
|   q65-v2.4|               363.0|              363|              363|
|   q66-v2.4|               168.0|              168|              168|
|   q67-v2.4|              2909.0|             2909|             2909|
|   q68-v2.4|               189.0|              189|              189|
|   q69-v2.4|               140.0|              140|              140|
|    q7-v2.4|               177.0|              177|              177|
|   q70-v2.4|               181.0|              181|              181|
|   q71-v2.4|               190.0|              190|              190|
|   q72-v2.4|             10877.0|            10877|            10877|
|   q73-v2.4|                96.0|               96|               96|
|   q74-v2.4|               965.0|              965|              965|
|   q75-v2.4|               686.0|              686|              686|
|   q76-v2.4|               203.0|              203|              203|
|   q77-v2.4|               270.0|              270|              270|
|   q78-v2.4|              2765.0|             2765|             2765|
|   q79-v2.4|               160.0|              160|              160|
|    q8-v2.4|               120.0|              120|              120|
|   q80-v2.4|              2827.0|             2827|             2827|
|   q81-v2.4|                76.0|               76|               76|
|   q82-v2.4|               229.0|              229|              229|
|   q83-v2.4|                40.0|               40|               40|
|   q84-v2.4|                55.0|               55|               55|
|   q85-v2.4|               411.0|              411|              411|
|   q86-v2.4|                39.0|               39|               39|
|   q87-v2.4|               258.0|              258|              258|
|   q88-v2.4|               410.0|              410|              410|
|   q89-v2.4|               112.0|              112|              112|
|    q9-v2.4|               696.0|              696|              696|
|   q90-v2.4|                43.0|               43|               43|
|   q91-v2.4|                33.0|               33|               33|
|   q92-v2.4|                57.0|               57|               57|
|   q93-v2.4|              1704.0|             1704|             1704|
|   q94-v2.4|               386.0|              386|              386|
|   q95-v2.4|              1840.0|             1840|             1840|
|   q96-v2.4|                67.0|               67|               67|
|   q97-v2.4|               428.0|              428|              428|
|   q98-v2.4|               639.0|              639|              639|
|   q99-v2.4|                78.0|               78|               78|
|ss_max-v2.4|               160.0|              160|              160|
+-----------+--------------------+-----------------+-----------------+

19/10/04 13:54:13 WARN StageMetrics: Stage metrics data refreshed into temp view PerfStageMetrics

Scheduling mode = FIFO
Spark Context default degree of parallelism = 95
Aggregated Spark stage metrics:
numStages => 1171
sum(numTasks) => 1985130
elapsedTime => 82178231 (22.8 h)
sum(stageDuration) => 176154684 (48.9 h)
sum(executorRunTime) => 6096005645 (1693.3 h)
sum(executorCpuTime) => 4504575096 (1251.3 h)
sum(executorDeserializeTime) => 7520720 (2.1 h)
sum(executorDeserializeCpuTime) => 3896684 (1.1 h)
sum(resultSerializationTime) => 50510 (51 s)
sum(jvmGCTime) => 58519939 (16.3 h)
sum(shuffleFetchWaitTime) => 498824126 (138.6 h)
sum(shuffleWriteTime) => 121825295 (33.8 h)
max(resultSize) => 620852635 (592.0 MB)
sum(numUpdatedBlockStatuses) => 0
sum(diskBytesSpilled) => 22208519263057 (20.0 TB)
sum(memoryBytesSpilled) => 62296602640384 (56.0 TB)
max(peakExecutionMemory) => 3263624400000
sum(recordsRead) => 4598771338360
sum(bytesRead) => 28791624829409 (26.0 TB)
sum(recordsWritten) => 105
sum(bytesWritten) => 3115275 (2.0 MB)
sum(shuffleTotalBytesRead) => 29479489597070 (26.0 TB)
sum(shuffleTotalBlocksFetched) => 269449557
sum(shuffleLocalBlocksFetched) => 3075828
sum(shuffleRemoteBlocksFetched) => 266373729
sum(shuffleBytesWritten) => 27161509045999 (24.0 TB)
sum(shuffleRecordsWritten) => 1488669228966
19/10/04 13:54:14 WARN AbstractS3ACommitter: Task committer attempt_20191004135414_0000_m_000000_0: No pending uploads to commit
