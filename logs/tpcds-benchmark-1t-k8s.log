++ id -u
+ myuid=0
++ id -g
+ mygid=0
+ set +e
++ getent passwd 0
+ uidentry=root:x:0:0:root:/root:/bin/ash
+ set -e
+ '[' -z root:x:0:0:root:/root:/bin/ash ']'
+ SPARK_K8S_CMD=driver
+ case "$SPARK_K8S_CMD" in
+ shift 1
+ SPARK_CLASSPATH=':/opt/spark/jars/*'
+ env
+ grep SPARK_JAVA_OPT_
+ sort -t_ -k4 -n
+ sed 's/[^=]*=\(.*\)/\1/g'
+ readarray -t SPARK_EXECUTOR_JAVA_OPTS
+ '[' -n '' ']'
+ '[' -n '' ']'
+ PYSPARK_ARGS=
+ '[' -n '' ']'
+ R_ARGS=
+ '[' -n '' ']'
+ '[' '' == 2 ']'
+ '[' '' == 3 ']'
+ case "$SPARK_K8S_CMD" in
+ CMD=("$SPARK_HOME/bin/spark-submit" --conf "spark.driver.bindAddress=$SPARK_DRIVER_BIND_ADDRESS" --deploy-mode client "$@")
+ exec /sbin/tini -s -- /opt/spark/bin/spark-submit --conf spark.driver.bindAddress=192.168.25.142 --deploy-mode client --properties-file /opt/spark/conf/spark.properties --class com.amazonaws.eks.tpcds.BenchmarkSparkSQL local:///opt/spark/examples/jars/eks-spark-examples-assembly-1.0.jar s3a://spark-k8s-data/TPCDS-TEST-1T s3a://spark-k8s-data/BENCHMARK-RESULT /opt/tpcds-kit/tools 1000 10 false q70-v2.4,q82-v2.4,q64-v2.4 true
20/01/08 17:35:14 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
DATA DIR is s3a://spark-k8s-data/TPCDS-TEST-1T
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
20/01/08 17:35:14 INFO SparkContext: Running Spark version 2.4.5-SNAPSHOT
20/01/08 17:35:14 INFO SparkContext: Submitted application: TPCDS SQL Benchmark 1000 GB
20/01/08 17:35:15 INFO SecurityManager: Changing view acls to: root
20/01/08 17:35:15 INFO SecurityManager: Changing modify acls to: root
20/01/08 17:35:15 INFO SecurityManager: Changing view acls groups to: 
20/01/08 17:35:15 INFO SecurityManager: Changing modify acls groups to: 
20/01/08 17:35:15 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(root); groups with view permissions: Set(); users  with modify permissions: Set(root); groups with modify permissions: Set()
20/01/08 17:35:15 INFO Utils: Successfully started service 'sparkDriver' on port 7078.
20/01/08 17:35:15 INFO SparkEnv: Registering MapOutputTracker
20/01/08 17:35:15 INFO SparkEnv: Registering BlockManagerMaster
20/01/08 17:35:15 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
20/01/08 17:35:15 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
20/01/08 17:35:15 INFO DiskBlockManager: Created local directory at /tmp/spark-local-dir/blockmgr-7e01f212-9524-4d1d-94ea-8209d690a29c
20/01/08 17:35:15 INFO MemoryStore: MemoryStore started with capacity 4.0 GB
20/01/08 17:35:15 INFO SparkEnv: Registering OutputCommitCoordinator
20/01/08 17:35:15 INFO Utils: Successfully started service 'SparkUI' on port 4040.
20/01/08 17:35:15 INFO SparkUI: Bound SparkUI to 0.0.0.0, and started at http://tpcds-benchmark-1t-5-8acf4a6f86397690-driver-svc.default.svc:4040
20/01/08 17:35:15 INFO SparkContext: Added JAR local:///opt/spark/examples/jars/eks-spark-examples-assembly-1.0.jar at file:/opt/spark/examples/jars/eks-spark-examples-assembly-1.0.jar with timestamp 1578504915674
20/01/08 17:35:15 WARN SparkContext: The jar local:///opt/spark/examples/jars/eks-spark-examples-assembly-1.0.jar has been added already. Overwriting of added jars is not supported in the current version.
20/01/08 17:35:16 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
20/01/08 17:35:16 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 7079.
20/01/08 17:35:16 INFO NettyBlockTransferService: Server created on tpcds-benchmark-1t-5-8acf4a6f86397690-driver-svc.default.svc:7079
20/01/08 17:35:16 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
20/01/08 17:35:16 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, tpcds-benchmark-1t-5-8acf4a6f86397690-driver-svc.default.svc, 7079, None)
20/01/08 17:35:16 INFO BlockManagerMasterEndpoint: Registering block manager tpcds-benchmark-1t-5-8acf4a6f86397690-driver-svc.default.svc:7079 with 4.0 GB RAM, BlockManagerId(driver, tpcds-benchmark-1t-5-8acf4a6f86397690-driver-svc.default.svc, 7079, None)
20/01/08 17:35:16 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, tpcds-benchmark-1t-5-8acf4a6f86397690-driver-svc.default.svc, 7079, None)
20/01/08 17:35:16 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, tpcds-benchmark-1t-5-8acf4a6f86397690-driver-svc.default.svc, 7079, None)
20/01/08 17:35:20 INFO ExecutorPodsAllocator: Going to request 5 executors from Kubernetes.
20/01/08 17:35:20 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.15.150:59638) with ID 1
20/01/08 17:35:20 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.22.8:49308) with ID 2
20/01/08 17:35:20 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.19.54:44736) with ID 5
20/01/08 17:35:20 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.15.150:46227 with 4.3 GB RAM, BlockManagerId(1, 192.168.15.150, 46227, None)
20/01/08 17:35:20 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.20.136:56634) with ID 3
20/01/08 17:35:20 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.22.8:38709 with 4.3 GB RAM, BlockManagerId(2, 192.168.22.8, 38709, None)
20/01/08 17:35:20 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.19.54:38199 with 4.3 GB RAM, BlockManagerId(5, 192.168.19.54, 38199, None)
20/01/08 17:35:20 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.20.136:44391 with 4.3 GB RAM, BlockManagerId(3, 192.168.20.136, 44391, None)
20/01/08 17:35:20 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.11.184:56310) with ID 4
20/01/08 17:35:20 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.11.184:45129 with 4.3 GB RAM, BlockManagerId(4, 192.168.11.184, 45129, None)
20/01/08 17:35:23 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.4.152:56638) with ID 7
20/01/08 17:35:23 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.21.70:34992) with ID 8
20/01/08 17:35:23 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.4.152:37541 with 4.3 GB RAM, BlockManagerId(7, 192.168.4.152, 37541, None)
20/01/08 17:35:23 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.21.70:42405 with 4.3 GB RAM, BlockManagerId(8, 192.168.21.70, 42405, None)
20/01/08 17:35:23 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.14.2:45374) with ID 6
20/01/08 17:35:23 INFO KubernetesClusterSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.8
20/01/08 17:35:23 INFO KubernetesClusterSchedulerBackend$KubernetesDriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (192.168.26.226:53898) with ID 9
20/01/08 17:35:24 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.14.2:43803 with 4.3 GB RAM, BlockManagerId(6, 192.168.14.2, 43803, None)
20/01/08 17:35:24 INFO BlockManagerMasterEndpoint: Registering block manager 192.168.26.226:36775 with 4.3 GB RAM, BlockManagerId(9, 192.168.26.226, 36775, None)
Only WARN
Creating temporary table catalog_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/catalog_sales.
20/01/08 17:35:24 INFO TPCDSTables: Creating temporary table catalog_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/catalog_sales.
20/01/08 17:35:24 WARN MetricsConfig: Cannot locate configuration: tried hadoop-metrics2-s3a-file-system.properties,hadoop-metrics2.properties
20/01/08 17:35:31 WARN Utils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.debug.maxToStringFields' in SparkEnv.conf.
Creating temporary table catalog_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/catalog_returns.
20/01/08 17:35:31 INFO TPCDSTables: Creating temporary table catalog_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/catalog_returns.
Creating temporary table inventory using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/inventory.
20/01/08 17:35:34 INFO TPCDSTables: Creating temporary table inventory using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/inventory.
Creating temporary table store_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/store_sales.
20/01/08 17:35:35 INFO TPCDSTables: Creating temporary table store_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/store_sales.
Creating temporary table store_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/store_returns.
20/01/08 17:35:37 INFO TPCDSTables: Creating temporary table store_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/store_returns.
Creating temporary table web_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/web_sales.
20/01/08 17:35:40 INFO TPCDSTables: Creating temporary table web_sales using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/web_sales.
Creating temporary table web_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/web_returns.
20/01/08 17:35:43 INFO TPCDSTables: Creating temporary table web_returns using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/web_returns.
Creating temporary table call_center using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/call_center.
20/01/08 17:35:45 INFO TPCDSTables: Creating temporary table call_center using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/call_center.
Creating temporary table catalog_page using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/catalog_page.
20/01/08 17:35:45 INFO TPCDSTables: Creating temporary table catalog_page using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/catalog_page.
Creating temporary table customer using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/customer.
20/01/08 17:35:48 INFO TPCDSTables: Creating temporary table customer using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/customer.
Creating temporary table customer_address using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/customer_address.
20/01/08 17:35:51 INFO TPCDSTables: Creating temporary table customer_address using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/customer_address.
Creating temporary table customer_demographics using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/customer_demographics.
20/01/08 17:35:53 INFO TPCDSTables: Creating temporary table customer_demographics using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/customer_demographics.
Creating temporary table date_dim using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/date_dim.
20/01/08 17:35:54 INFO TPCDSTables: Creating temporary table date_dim using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/date_dim.
Creating temporary table household_demographics using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/household_demographics.
20/01/08 17:35:54 INFO TPCDSTables: Creating temporary table household_demographics using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/household_demographics.
Creating temporary table income_band using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/income_band.
20/01/08 17:35:54 INFO TPCDSTables: Creating temporary table income_band using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/income_band.
Creating temporary table item using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/item.
20/01/08 17:35:55 INFO TPCDSTables: Creating temporary table item using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/item.
Creating temporary table promotion using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/promotion.
20/01/08 17:35:58 INFO TPCDSTables: Creating temporary table promotion using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/promotion.
Creating temporary table reason using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/reason.
20/01/08 17:35:58 INFO TPCDSTables: Creating temporary table reason using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/reason.
Creating temporary table ship_mode using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/ship_mode.
20/01/08 17:35:59 INFO TPCDSTables: Creating temporary table ship_mode using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/ship_mode.
Creating temporary table store using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/store.
20/01/08 17:35:59 INFO TPCDSTables: Creating temporary table store using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/store.
Creating temporary table time_dim using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/time_dim.
20/01/08 17:35:59 INFO TPCDSTables: Creating temporary table time_dim using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/time_dim.
Creating temporary table warehouse using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/warehouse.
20/01/08 17:36:00 INFO TPCDSTables: Creating temporary table warehouse using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/warehouse.
Creating temporary table web_page using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/web_page.
20/01/08 17:36:00 INFO TPCDSTables: Creating temporary table web_page using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/web_page.
Creating temporary table web_site using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/web_site.
20/01/08 17:36:01 INFO TPCDSTables: Creating temporary table web_site using data stored in s3a://spark-k8s-data/TPCDS-TEST-1T/web_site.
Running only queries: q70-v2.4,q82-v2.4,q64-v2.4
Couldn't read table cross_sales and its not defined as a Benchmark.Table.
Table store_sales exists.
Table date_dim exists.
Table store exists.
Table item exists.
Table inventory exists.
Running execution q64-v2.4 iteration: 1, StandardRun=true
20/01/08 17:36:13 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#1385 ASC NULLS FIRST, store_name#1387 ASC NULLS FIRST, cnt#1522L ASC NULLS FIRST], true
+- Project [product_name#1385, store_name#1387, store_zip#1388, b_street_number#1389, b_streen_name#1390, b_city#1391, b_zip#1392, c_street_number#1393, c_street_name#1394, c_city#1395, c_zip#1396, syear#1397, cnt#1400L, s1#1401, s2#1402, s3#1403, s1#1523, s2#1524, s3#1525, syear#1519, cnt#1522L]
   +- Filter ((((item_sk#1386 = item_sk#1508) && (syear#1397 = 1999)) && (syear#1519 = (1999 + 1))) && (((cnt#1522L <= cnt#1400L) && (store_name#1387 = store_name#1509)) && (store_zip#1388 = store_zip#1510)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1485, ca_street_name#1486, ca_city#1489, ca_zip#1492, d_year#498, d_year#1419, d_year#1447], [i_product_name#585 AS product_name#1385, i_item_sk#564 AS item_sk#1386, s_store_name#669 AS store_name#1387, s_zip#689 AS store_zip#1388, ca_street_number#450 AS b_street_number#1389, ca_street_name#451 AS b_streen_name#1390, ca_city#454 AS b_city#1391, ca_zip#457 AS b_zip#1392, ca_street_number#1485 AS c_street_number#1393, ca_street_name#1486 AS c_street_name#1394, ca_city#1489 AS c_city#1395, ca_zip#1492 AS c_zip#1396, d_year#498 AS syear#1397, d_year#1419 AS fsyear#1398, d_year#1447 AS s2year#1399, count(1) AS cnt#1400L, sum(ss_wholesale_cost#141) AS s1#1401, sum(ss_list_price#142) AS s2#1402, sum(ss_coupon_amt#149) AS s3#1403]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#1469)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#1478) && (c_current_addr_sk#416 = ca_address_sk#1483)) && (c_first_sales_date_sk#418 = d_date_sk#1413)) && (((c_first_shipto_date_sk#417 = d_date_sk#1441) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#1479 = ib_income_band_sk#1496) && NOT (cd_marital_status#476 = cd_marital_status#1471)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#1383, refund#1384]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#1409 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#1410 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#1383, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#1384, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#1409, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#1410]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#1413,d_date_id#1414,d_date#1415,d_month_seq#1416,d_week_seq#1417,d_quarter_seq#1418,d_year#1419,d_dow#1420,d_moy#1421,d_dom#1422,d_qoy#1423,d_fy_year#1424,d_fy_quarter_seq#1425,d_fy_week_seq#1426,d_day_name#1427,d_quarter_name#1428,d_holiday#1429,d_weekend#1430,d_following_holiday#1431,d_first_dom#1432,d_last_dom#1433,d_same_day_ly#1434,d_same_day_lq#1435,d_current_day#1436,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#1441,d_date_id#1442,d_date#1443,d_month_seq#1444,d_week_seq#1445,d_quarter_seq#1446,d_year#1447,d_dow#1448,d_moy#1449,d_dom#1450,d_qoy#1451,d_fy_year#1452,d_fy_quarter_seq#1453,d_fy_week_seq#1454,d_day_name#1455,d_quarter_name#1456,d_holiday#1457,d_weekend#1458,d_following_holiday#1459,d_first_dom#1460,d_last_dom#1461,d_same_day_ly#1462,d_same_day_lq#1463,d_current_day#1464,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#1469,cd_gender#1470,cd_marital_status#1471,cd_education_status#1472,cd_purchase_estimate#1473,cd_credit_rating#1474,cd_dep_count#1475,cd_dep_employed_count#1476,cd_dep_college_count#1477] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#1478,hd_income_band_sk#1479,hd_buy_potential#1480,hd_dep_count#1481,hd_vehicle_count#1482] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#1483,ca_address_id#1484,ca_street_number#1485,ca_street_name#1486,ca_street_type#1487,ca_suite_number#1488,ca_city#1489,ca_county#1490,ca_state#1491,ca_zip#1492,ca_country#1493,ca_gmt_offset#1494,ca_location_type#1495] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#1496,ib_lower_bound#1497,ib_upper_bound#1498] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1485, ca_street_name#1486, ca_city#1489, ca_zip#1492, d_year#498, d_year#1419, d_year#1447], [i_product_name#585 AS product_name#1507, i_item_sk#564 AS item_sk#1508, s_store_name#669 AS store_name#1509, s_zip#689 AS store_zip#1510, ca_street_number#450 AS b_street_number#1511, ca_street_name#451 AS b_streen_name#1512, ca_city#454 AS b_city#1513, ca_zip#457 AS b_zip#1514, ca_street_number#1485 AS c_street_number#1515, ca_street_name#1486 AS c_street_name#1516, ca_city#1489 AS c_city#1517, ca_zip#1492 AS c_zip#1518, d_year#498 AS syear#1519, d_year#1419 AS fsyear#1520, d_year#1447 AS s2year#1521, count(1) AS cnt#1522L, sum(ss_wholesale_cost#141) AS s1#1523, sum(ss_list_price#142) AS s2#1524, sum(ss_coupon_amt#149) AS s3#1525]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#1469)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#1478) && (c_current_addr_sk#416 = ca_address_sk#1483)) && (c_first_sales_date_sk#418 = d_date_sk#1413)) && (((c_first_shipto_date_sk#417 = d_date_sk#1441) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#1479 = ib_income_band_sk#1496) && NOT (cd_marital_status#476 = cd_marital_status#1471)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#1383, refund#1384]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#1409 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#1410 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#1383, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#1384, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#1409, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#1410]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#1413,d_date_id#1414,d_date#1415,d_month_seq#1416,d_week_seq#1417,d_quarter_seq#1418,d_year#1419,d_dow#1420,d_moy#1421,d_dom#1422,d_qoy#1423,d_fy_year#1424,d_fy_quarter_seq#1425,d_fy_week_seq#1426,d_day_name#1427,d_quarter_name#1428,d_holiday#1429,d_weekend#1430,d_following_holiday#1431,d_first_dom#1432,d_last_dom#1433,d_same_day_ly#1434,d_same_day_lq#1435,d_current_day#1436,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#1441,d_date_id#1442,d_date#1443,d_month_seq#1444,d_week_seq#1445,d_quarter_seq#1446,d_year#1447,d_dow#1448,d_moy#1449,d_dom#1450,d_qoy#1451,d_fy_year#1452,d_fy_quarter_seq#1453,d_fy_week_seq#1454,d_day_name#1455,d_quarter_name#1456,d_holiday#1457,d_weekend#1458,d_following_holiday#1459,d_first_dom#1460,d_last_dom#1461,d_same_day_ly#1462,d_same_day_lq#1463,d_current_day#1464,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#1469,cd_gender#1470,cd_marital_status#1471,cd_education_status#1472,cd_purchase_estimate#1473,cd_credit_rating#1474,cd_dep_count#1475,cd_dep_employed_count#1476,cd_dep_college_count#1477] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#1478,hd_income_band_sk#1479,hd_buy_potential#1480,hd_dep_count#1481,hd_vehicle_count#1482] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#1483,ca_address_id#1484,ca_street_number#1485,ca_street_name#1486,ca_street_type#1487,ca_suite_number#1488,ca_city#1489,ca_county#1490,ca_state#1491,ca_zip#1492,ca_country#1493,ca_gmt_offset#1494,ca_location_type#1495] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#1496,ib_lower_bound#1497,ib_upper_bound#1498] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
20/01/08 17:36:13 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#1553 ASC NULLS FIRST, store_name#1555 ASC NULLS FIRST, cnt#1690L ASC NULLS FIRST], true
+- Project [product_name#1553, store_name#1555, store_zip#1556, b_street_number#1557, b_streen_name#1558, b_city#1559, b_zip#1560, c_street_number#1561, c_street_name#1562, c_city#1563, c_zip#1564, syear#1565, cnt#1568L, s1#1569, s2#1570, s3#1571, s1#1691, s2#1692, s3#1693, syear#1687, cnt#1690L]
   +- Filter ((((item_sk#1554 = item_sk#1676) && (syear#1565 = 1999)) && (syear#1687 = (1999 + 1))) && (((cnt#1690L <= cnt#1568L) && (store_name#1555 = store_name#1677)) && (store_zip#1556 = store_zip#1678)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1653, ca_street_name#1654, ca_city#1657, ca_zip#1660, d_year#498, d_year#1587, d_year#1615], [i_product_name#585 AS product_name#1553, i_item_sk#564 AS item_sk#1554, s_store_name#669 AS store_name#1555, s_zip#689 AS store_zip#1556, ca_street_number#450 AS b_street_number#1557, ca_street_name#451 AS b_streen_name#1558, ca_city#454 AS b_city#1559, ca_zip#457 AS b_zip#1560, ca_street_number#1653 AS c_street_number#1561, ca_street_name#1654 AS c_street_name#1562, ca_city#1657 AS c_city#1563, ca_zip#1660 AS c_zip#1564, d_year#498 AS syear#1565, d_year#1587 AS fsyear#1566, d_year#1615 AS s2year#1567, count(1) AS cnt#1568L, sum(ss_wholesale_cost#141) AS s1#1569, sum(ss_list_price#142) AS s2#1570, sum(ss_coupon_amt#149) AS s3#1571]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#1637)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#1646) && (c_current_addr_sk#416 = ca_address_sk#1651)) && (c_first_sales_date_sk#418 = d_date_sk#1581)) && (((c_first_shipto_date_sk#417 = d_date_sk#1609) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#1647 = ib_income_band_sk#1664) && NOT (cd_marital_status#476 = cd_marital_status#1639)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#1551, refund#1552]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#1577 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#1578 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#1551, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#1552, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#1577, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#1578]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#1581,d_date_id#1582,d_date#1583,d_month_seq#1584,d_week_seq#1585,d_quarter_seq#1586,d_year#1587,d_dow#1588,d_moy#1589,d_dom#1590,d_qoy#1591,d_fy_year#1592,d_fy_quarter_seq#1593,d_fy_week_seq#1594,d_day_name#1595,d_quarter_name#1596,d_holiday#1597,d_weekend#1598,d_following_holiday#1599,d_first_dom#1600,d_last_dom#1601,d_same_day_ly#1602,d_same_day_lq#1603,d_current_day#1604,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#1609,d_date_id#1610,d_date#1611,d_month_seq#1612,d_week_seq#1613,d_quarter_seq#1614,d_year#1615,d_dow#1616,d_moy#1617,d_dom#1618,d_qoy#1619,d_fy_year#1620,d_fy_quarter_seq#1621,d_fy_week_seq#1622,d_day_name#1623,d_quarter_name#1624,d_holiday#1625,d_weekend#1626,d_following_holiday#1627,d_first_dom#1628,d_last_dom#1629,d_same_day_ly#1630,d_same_day_lq#1631,d_current_day#1632,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#1637,cd_gender#1638,cd_marital_status#1639,cd_education_status#1640,cd_purchase_estimate#1641,cd_credit_rating#1642,cd_dep_count#1643,cd_dep_employed_count#1644,cd_dep_college_count#1645] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#1646,hd_income_band_sk#1647,hd_buy_potential#1648,hd_dep_count#1649,hd_vehicle_count#1650] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#1651,ca_address_id#1652,ca_street_number#1653,ca_street_name#1654,ca_street_type#1655,ca_suite_number#1656,ca_city#1657,ca_county#1658,ca_state#1659,ca_zip#1660,ca_country#1661,ca_gmt_offset#1662,ca_location_type#1663] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#1664,ib_lower_bound#1665,ib_upper_bound#1666] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#1653, ca_street_name#1654, ca_city#1657, ca_zip#1660, d_year#498, d_year#1587, d_year#1615], [i_product_name#585 AS product_name#1675, i_item_sk#564 AS item_sk#1676, s_store_name#669 AS store_name#1677, s_zip#689 AS store_zip#1678, ca_street_number#450 AS b_street_number#1679, ca_street_name#451 AS b_streen_name#1680, ca_city#454 AS b_city#1681, ca_zip#457 AS b_zip#1682, ca_street_number#1653 AS c_street_number#1683, ca_street_name#1654 AS c_street_name#1684, ca_city#1657 AS c_city#1685, ca_zip#1660 AS c_zip#1686, d_year#498 AS syear#1687, d_year#1587 AS fsyear#1688, d_year#1615 AS s2year#1689, count(1) AS cnt#1690L, sum(ss_wholesale_cost#141) AS s1#1691, sum(ss_list_price#142) AS s2#1692, sum(ss_coupon_amt#149) AS s3#1693]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#1637)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#1646) && (c_current_addr_sk#416 = ca_address_sk#1651)) && (c_first_sales_date_sk#418 = d_date_sk#1581)) && (((c_first_shipto_date_sk#417 = d_date_sk#1609) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#1647 = ib_income_band_sk#1664) && NOT (cd_marital_status#476 = cd_marital_status#1639)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#1551, refund#1552]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#1577 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#1578 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#1551, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#1552, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#1577, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#1578]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#1581,d_date_id#1582,d_date#1583,d_month_seq#1584,d_week_seq#1585,d_quarter_seq#1586,d_year#1587,d_dow#1588,d_moy#1589,d_dom#1590,d_qoy#1591,d_fy_year#1592,d_fy_quarter_seq#1593,d_fy_week_seq#1594,d_day_name#1595,d_quarter_name#1596,d_holiday#1597,d_weekend#1598,d_following_holiday#1599,d_first_dom#1600,d_last_dom#1601,d_same_day_ly#1602,d_same_day_lq#1603,d_current_day#1604,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#1609,d_date_id#1610,d_date#1611,d_month_seq#1612,d_week_seq#1613,d_quarter_seq#1614,d_year#1615,d_dow#1616,d_moy#1617,d_dom#1618,d_qoy#1619,d_fy_year#1620,d_fy_quarter_seq#1621,d_fy_week_seq#1622,d_day_name#1623,d_quarter_name#1624,d_holiday#1625,d_weekend#1626,d_following_holiday#1627,d_first_dom#1628,d_last_dom#1629,d_same_day_ly#1630,d_same_day_lq#1631,d_current_day#1632,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#1637,cd_gender#1638,cd_marital_status#1639,cd_education_status#1640,cd_purchase_estimate#1641,cd_credit_rating#1642,cd_dep_count#1643,cd_dep_employed_count#1644,cd_dep_college_count#1645] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#1646,hd_income_band_sk#1647,hd_buy_potential#1648,hd_dep_count#1649,hd_vehicle_count#1650] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#1651,ca_address_id#1652,ca_street_number#1653,ca_street_name#1654,ca_street_type#1655,ca_suite_number#1656,ca_city#1657,ca_county#1658,ca_state#1659,ca_zip#1660,ca_country#1661,ca_gmt_offset#1662,ca_location_type#1663] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#1664,ib_lower_bound#1665,ib_upper_bound#1666] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 825.829712141s
Running execution q70-v2.4 iteration: 1, StandardRun=true
20/01/08 17:50:10 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#2157 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#2157 as int) = 0) THEN s_state#2179 END ASC NULLS FIRST, rank_within_parent#2158 ASC NULLS FIRST], true
      +- Project [total_sum#2156, s_state#2179, s_county#2180, lochierarchy#2157, rank_within_parent#2158]
         +- Project [total_sum#2156, s_state#2179, s_county#2180, lochierarchy#2157, _w0#2189, _w1#2193, _w2#2194, _w3#2195, rank_within_parent#2158, rank_within_parent#2158]
            +- Window [rank(_w3#2195) windowspecdefinition(_w1#2193, _w2#2194, _w3#2195 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#2158], [_w1#2193, _w2#2194], [_w3#2195 DESC NULLS LAST]
               +- Aggregate [s_state#2179, s_county#2180, spark_grouping_id#2176], [sum(ss_net_profit#152) AS total_sum#2156, s_state#2179, s_county#2180, (cast((shiftright(spark_grouping_id#2176, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#2176, 0) & 1) as tinyint)) AS lochierarchy#2157, sum(ss_net_profit#152) AS _w0#2189, (cast((shiftright(spark_grouping_id#2176, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#2176, 0) & 1) as tinyint)) AS _w1#2193, CASE WHEN (cast(cast((shiftright(spark_grouping_id#2176, 0) & 1) as tinyint) as int) = 0) THEN s_state#2179 END AS _w2#2194, sum(ss_net_profit#152) AS _w3#2195]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#2177, s_county#2178, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#2177, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#2161 [])))
                           :  +- Project [s_state#2159]
                           :     +- Filter (ranking#2160 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#2159, ranking#2160]
                           :              +- Project [s_state#2159, s_state#688, _w1#2167, ranking#2160, ranking#2160]
                           :                 +- Window [rank(_w1#2167) windowspecdefinition(s_state#688, _w1#2167 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#2160], [s_state#688], [_w1#2167 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#2159, s_state#688, sum(ss_net_profit#152) AS _w1#2167]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
20/01/08 17:50:11 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#2211 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#2211 as int) = 0) THEN s_state#2233 END ASC NULLS FIRST, rank_within_parent#2212 ASC NULLS FIRST], true
      +- Project [total_sum#2210, s_state#2233, s_county#2234, lochierarchy#2211, rank_within_parent#2212]
         +- Project [total_sum#2210, s_state#2233, s_county#2234, lochierarchy#2211, _w0#2243, _w1#2247, _w2#2248, _w3#2249, rank_within_parent#2212, rank_within_parent#2212]
            +- Window [rank(_w3#2249) windowspecdefinition(_w1#2247, _w2#2248, _w3#2249 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#2212], [_w1#2247, _w2#2248], [_w3#2249 DESC NULLS LAST]
               +- Aggregate [s_state#2233, s_county#2234, spark_grouping_id#2230], [sum(ss_net_profit#152) AS total_sum#2210, s_state#2233, s_county#2234, (cast((shiftright(spark_grouping_id#2230, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#2230, 0) & 1) as tinyint)) AS lochierarchy#2211, sum(ss_net_profit#152) AS _w0#2243, (cast((shiftright(spark_grouping_id#2230, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#2230, 0) & 1) as tinyint)) AS _w1#2247, CASE WHEN (cast(cast((shiftright(spark_grouping_id#2230, 0) & 1) as tinyint) as int) = 0) THEN s_state#2233 END AS _w2#2248, sum(ss_net_profit#152) AS _w3#2249]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#2231, s_county#2232, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#2231, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#2215 [])))
                           :  +- Project [s_state#2213]
                           :     +- Filter (ranking#2214 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#2213, ranking#2214]
                           :              +- Project [s_state#2213, s_state#688, _w1#2221, ranking#2214, ranking#2214]
                           :                 +- Window [rank(_w1#2221) windowspecdefinition(s_state#688, _w1#2221 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#2214], [s_state#688], [_w1#2221 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#2213, s_state#688, sum(ss_net_profit#152) AS _w1#2221]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 86.059236713s
Running execution q82-v2.4 iteration: 1, StandardRun=true
20/01/08 17:51:38 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
20/01/08 17:51:38 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 88.017953018s
Running execution q64-v2.4 iteration: 2, StandardRun=true
20/01/08 17:53:16 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#2605 ASC NULLS FIRST, store_name#2607 ASC NULLS FIRST, cnt#2742L ASC NULLS FIRST], true
+- Project [product_name#2605, store_name#2607, store_zip#2608, b_street_number#2609, b_streen_name#2610, b_city#2611, b_zip#2612, c_street_number#2613, c_street_name#2614, c_city#2615, c_zip#2616, syear#2617, cnt#2620L, s1#2621, s2#2622, s3#2623, s1#2743, s2#2744, s3#2745, syear#2739, cnt#2742L]
   +- Filter ((((item_sk#2606 = item_sk#2728) && (syear#2617 = 1999)) && (syear#2739 = (1999 + 1))) && (((cnt#2742L <= cnt#2620L) && (store_name#2607 = store_name#2729)) && (store_zip#2608 = store_zip#2730)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2705, ca_street_name#2706, ca_city#2709, ca_zip#2712, d_year#498, d_year#2639, d_year#2667], [i_product_name#585 AS product_name#2605, i_item_sk#564 AS item_sk#2606, s_store_name#669 AS store_name#2607, s_zip#689 AS store_zip#2608, ca_street_number#450 AS b_street_number#2609, ca_street_name#451 AS b_streen_name#2610, ca_city#454 AS b_city#2611, ca_zip#457 AS b_zip#2612, ca_street_number#2705 AS c_street_number#2613, ca_street_name#2706 AS c_street_name#2614, ca_city#2709 AS c_city#2615, ca_zip#2712 AS c_zip#2616, d_year#498 AS syear#2617, d_year#2639 AS fsyear#2618, d_year#2667 AS s2year#2619, count(1) AS cnt#2620L, sum(ss_wholesale_cost#141) AS s1#2621, sum(ss_list_price#142) AS s2#2622, sum(ss_coupon_amt#149) AS s3#2623]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#2689)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#2698) && (c_current_addr_sk#416 = ca_address_sk#2703)) && (c_first_sales_date_sk#418 = d_date_sk#2633)) && (((c_first_shipto_date_sk#417 = d_date_sk#2661) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#2699 = ib_income_band_sk#2716) && NOT (cd_marital_status#476 = cd_marital_status#2691)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#2603, refund#2604]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#2629 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#2630 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#2603, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#2604, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#2629, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#2630]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#2633,d_date_id#2634,d_date#2635,d_month_seq#2636,d_week_seq#2637,d_quarter_seq#2638,d_year#2639,d_dow#2640,d_moy#2641,d_dom#2642,d_qoy#2643,d_fy_year#2644,d_fy_quarter_seq#2645,d_fy_week_seq#2646,d_day_name#2647,d_quarter_name#2648,d_holiday#2649,d_weekend#2650,d_following_holiday#2651,d_first_dom#2652,d_last_dom#2653,d_same_day_ly#2654,d_same_day_lq#2655,d_current_day#2656,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#2661,d_date_id#2662,d_date#2663,d_month_seq#2664,d_week_seq#2665,d_quarter_seq#2666,d_year#2667,d_dow#2668,d_moy#2669,d_dom#2670,d_qoy#2671,d_fy_year#2672,d_fy_quarter_seq#2673,d_fy_week_seq#2674,d_day_name#2675,d_quarter_name#2676,d_holiday#2677,d_weekend#2678,d_following_holiday#2679,d_first_dom#2680,d_last_dom#2681,d_same_day_ly#2682,d_same_day_lq#2683,d_current_day#2684,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#2689,cd_gender#2690,cd_marital_status#2691,cd_education_status#2692,cd_purchase_estimate#2693,cd_credit_rating#2694,cd_dep_count#2695,cd_dep_employed_count#2696,cd_dep_college_count#2697] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#2698,hd_income_band_sk#2699,hd_buy_potential#2700,hd_dep_count#2701,hd_vehicle_count#2702] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#2703,ca_address_id#2704,ca_street_number#2705,ca_street_name#2706,ca_street_type#2707,ca_suite_number#2708,ca_city#2709,ca_county#2710,ca_state#2711,ca_zip#2712,ca_country#2713,ca_gmt_offset#2714,ca_location_type#2715] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#2716,ib_lower_bound#2717,ib_upper_bound#2718] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2705, ca_street_name#2706, ca_city#2709, ca_zip#2712, d_year#498, d_year#2639, d_year#2667], [i_product_name#585 AS product_name#2727, i_item_sk#564 AS item_sk#2728, s_store_name#669 AS store_name#2729, s_zip#689 AS store_zip#2730, ca_street_number#450 AS b_street_number#2731, ca_street_name#451 AS b_streen_name#2732, ca_city#454 AS b_city#2733, ca_zip#457 AS b_zip#2734, ca_street_number#2705 AS c_street_number#2735, ca_street_name#2706 AS c_street_name#2736, ca_city#2709 AS c_city#2737, ca_zip#2712 AS c_zip#2738, d_year#498 AS syear#2739, d_year#2639 AS fsyear#2740, d_year#2667 AS s2year#2741, count(1) AS cnt#2742L, sum(ss_wholesale_cost#141) AS s1#2743, sum(ss_list_price#142) AS s2#2744, sum(ss_coupon_amt#149) AS s3#2745]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#2689)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#2698) && (c_current_addr_sk#416 = ca_address_sk#2703)) && (c_first_sales_date_sk#418 = d_date_sk#2633)) && (((c_first_shipto_date_sk#417 = d_date_sk#2661) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#2699 = ib_income_band_sk#2716) && NOT (cd_marital_status#476 = cd_marital_status#2691)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#2603, refund#2604]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#2629 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#2630 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#2603, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#2604, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#2629, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#2630]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#2633,d_date_id#2634,d_date#2635,d_month_seq#2636,d_week_seq#2637,d_quarter_seq#2638,d_year#2639,d_dow#2640,d_moy#2641,d_dom#2642,d_qoy#2643,d_fy_year#2644,d_fy_quarter_seq#2645,d_fy_week_seq#2646,d_day_name#2647,d_quarter_name#2648,d_holiday#2649,d_weekend#2650,d_following_holiday#2651,d_first_dom#2652,d_last_dom#2653,d_same_day_ly#2654,d_same_day_lq#2655,d_current_day#2656,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#2661,d_date_id#2662,d_date#2663,d_month_seq#2664,d_week_seq#2665,d_quarter_seq#2666,d_year#2667,d_dow#2668,d_moy#2669,d_dom#2670,d_qoy#2671,d_fy_year#2672,d_fy_quarter_seq#2673,d_fy_week_seq#2674,d_day_name#2675,d_quarter_name#2676,d_holiday#2677,d_weekend#2678,d_following_holiday#2679,d_first_dom#2680,d_last_dom#2681,d_same_day_ly#2682,d_same_day_lq#2683,d_current_day#2684,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#2689,cd_gender#2690,cd_marital_status#2691,cd_education_status#2692,cd_purchase_estimate#2693,cd_credit_rating#2694,cd_dep_count#2695,cd_dep_employed_count#2696,cd_dep_college_count#2697] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#2698,hd_income_band_sk#2699,hd_buy_potential#2700,hd_dep_count#2701,hd_vehicle_count#2702] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#2703,ca_address_id#2704,ca_street_number#2705,ca_street_name#2706,ca_street_type#2707,ca_suite_number#2708,ca_city#2709,ca_county#2710,ca_state#2711,ca_zip#2712,ca_country#2713,ca_gmt_offset#2714,ca_location_type#2715] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#2716,ib_lower_bound#2717,ib_upper_bound#2718] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
20/01/08 17:53:16 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#2773 ASC NULLS FIRST, store_name#2775 ASC NULLS FIRST, cnt#2910L ASC NULLS FIRST], true
+- Project [product_name#2773, store_name#2775, store_zip#2776, b_street_number#2777, b_streen_name#2778, b_city#2779, b_zip#2780, c_street_number#2781, c_street_name#2782, c_city#2783, c_zip#2784, syear#2785, cnt#2788L, s1#2789, s2#2790, s3#2791, s1#2911, s2#2912, s3#2913, syear#2907, cnt#2910L]
   +- Filter ((((item_sk#2774 = item_sk#2896) && (syear#2785 = 1999)) && (syear#2907 = (1999 + 1))) && (((cnt#2910L <= cnt#2788L) && (store_name#2775 = store_name#2897)) && (store_zip#2776 = store_zip#2898)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2873, ca_street_name#2874, ca_city#2877, ca_zip#2880, d_year#498, d_year#2807, d_year#2835], [i_product_name#585 AS product_name#2773, i_item_sk#564 AS item_sk#2774, s_store_name#669 AS store_name#2775, s_zip#689 AS store_zip#2776, ca_street_number#450 AS b_street_number#2777, ca_street_name#451 AS b_streen_name#2778, ca_city#454 AS b_city#2779, ca_zip#457 AS b_zip#2780, ca_street_number#2873 AS c_street_number#2781, ca_street_name#2874 AS c_street_name#2782, ca_city#2877 AS c_city#2783, ca_zip#2880 AS c_zip#2784, d_year#498 AS syear#2785, d_year#2807 AS fsyear#2786, d_year#2835 AS s2year#2787, count(1) AS cnt#2788L, sum(ss_wholesale_cost#141) AS s1#2789, sum(ss_list_price#142) AS s2#2790, sum(ss_coupon_amt#149) AS s3#2791]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#2857)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#2866) && (c_current_addr_sk#416 = ca_address_sk#2871)) && (c_first_sales_date_sk#418 = d_date_sk#2801)) && (((c_first_shipto_date_sk#417 = d_date_sk#2829) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#2867 = ib_income_band_sk#2884) && NOT (cd_marital_status#476 = cd_marital_status#2859)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#2771, refund#2772]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#2797 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#2798 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#2771, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#2772, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#2797, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#2798]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#2801,d_date_id#2802,d_date#2803,d_month_seq#2804,d_week_seq#2805,d_quarter_seq#2806,d_year#2807,d_dow#2808,d_moy#2809,d_dom#2810,d_qoy#2811,d_fy_year#2812,d_fy_quarter_seq#2813,d_fy_week_seq#2814,d_day_name#2815,d_quarter_name#2816,d_holiday#2817,d_weekend#2818,d_following_holiday#2819,d_first_dom#2820,d_last_dom#2821,d_same_day_ly#2822,d_same_day_lq#2823,d_current_day#2824,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#2829,d_date_id#2830,d_date#2831,d_month_seq#2832,d_week_seq#2833,d_quarter_seq#2834,d_year#2835,d_dow#2836,d_moy#2837,d_dom#2838,d_qoy#2839,d_fy_year#2840,d_fy_quarter_seq#2841,d_fy_week_seq#2842,d_day_name#2843,d_quarter_name#2844,d_holiday#2845,d_weekend#2846,d_following_holiday#2847,d_first_dom#2848,d_last_dom#2849,d_same_day_ly#2850,d_same_day_lq#2851,d_current_day#2852,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#2857,cd_gender#2858,cd_marital_status#2859,cd_education_status#2860,cd_purchase_estimate#2861,cd_credit_rating#2862,cd_dep_count#2863,cd_dep_employed_count#2864,cd_dep_college_count#2865] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#2866,hd_income_band_sk#2867,hd_buy_potential#2868,hd_dep_count#2869,hd_vehicle_count#2870] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#2871,ca_address_id#2872,ca_street_number#2873,ca_street_name#2874,ca_street_type#2875,ca_suite_number#2876,ca_city#2877,ca_county#2878,ca_state#2879,ca_zip#2880,ca_country#2881,ca_gmt_offset#2882,ca_location_type#2883] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#2884,ib_lower_bound#2885,ib_upper_bound#2886] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#2873, ca_street_name#2874, ca_city#2877, ca_zip#2880, d_year#498, d_year#2807, d_year#2835], [i_product_name#585 AS product_name#2895, i_item_sk#564 AS item_sk#2896, s_store_name#669 AS store_name#2897, s_zip#689 AS store_zip#2898, ca_street_number#450 AS b_street_number#2899, ca_street_name#451 AS b_streen_name#2900, ca_city#454 AS b_city#2901, ca_zip#457 AS b_zip#2902, ca_street_number#2873 AS c_street_number#2903, ca_street_name#2874 AS c_street_name#2904, ca_city#2877 AS c_city#2905, ca_zip#2880 AS c_zip#2906, d_year#498 AS syear#2907, d_year#2807 AS fsyear#2908, d_year#2835 AS s2year#2909, count(1) AS cnt#2910L, sum(ss_wholesale_cost#141) AS s1#2911, sum(ss_list_price#142) AS s2#2912, sum(ss_coupon_amt#149) AS s3#2913]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#2857)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#2866) && (c_current_addr_sk#416 = ca_address_sk#2871)) && (c_first_sales_date_sk#418 = d_date_sk#2801)) && (((c_first_shipto_date_sk#417 = d_date_sk#2829) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#2867 = ib_income_band_sk#2884) && NOT (cd_marital_status#476 = cd_marital_status#2859)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#2771, refund#2772]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#2797 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#2798 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#2771, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#2772, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#2797, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#2798]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#2801,d_date_id#2802,d_date#2803,d_month_seq#2804,d_week_seq#2805,d_quarter_seq#2806,d_year#2807,d_dow#2808,d_moy#2809,d_dom#2810,d_qoy#2811,d_fy_year#2812,d_fy_quarter_seq#2813,d_fy_week_seq#2814,d_day_name#2815,d_quarter_name#2816,d_holiday#2817,d_weekend#2818,d_following_holiday#2819,d_first_dom#2820,d_last_dom#2821,d_same_day_ly#2822,d_same_day_lq#2823,d_current_day#2824,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#2829,d_date_id#2830,d_date#2831,d_month_seq#2832,d_week_seq#2833,d_quarter_seq#2834,d_year#2835,d_dow#2836,d_moy#2837,d_dom#2838,d_qoy#2839,d_fy_year#2840,d_fy_quarter_seq#2841,d_fy_week_seq#2842,d_day_name#2843,d_quarter_name#2844,d_holiday#2845,d_weekend#2846,d_following_holiday#2847,d_first_dom#2848,d_last_dom#2849,d_same_day_ly#2850,d_same_day_lq#2851,d_current_day#2852,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#2857,cd_gender#2858,cd_marital_status#2859,cd_education_status#2860,cd_purchase_estimate#2861,cd_credit_rating#2862,cd_dep_count#2863,cd_dep_employed_count#2864,cd_dep_college_count#2865] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#2866,hd_income_band_sk#2867,hd_buy_potential#2868,hd_dep_count#2869,hd_vehicle_count#2870] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#2871,ca_address_id#2872,ca_street_number#2873,ca_street_name#2874,ca_street_type#2875,ca_suite_number#2876,ca_city#2877,ca_county#2878,ca_state#2879,ca_zip#2880,ca_country#2881,ca_gmt_offset#2882,ca_location_type#2883] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#2884,ib_lower_bound#2885,ib_upper_bound#2886] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 1018.986373717s
Running execution q70-v2.4 iteration: 2, StandardRun=true
20/01/08 18:10:26 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#3209 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#3209 as int) = 0) THEN s_state#3231 END ASC NULLS FIRST, rank_within_parent#3210 ASC NULLS FIRST], true
      +- Project [total_sum#3208, s_state#3231, s_county#3232, lochierarchy#3209, rank_within_parent#3210]
         +- Project [total_sum#3208, s_state#3231, s_county#3232, lochierarchy#3209, _w0#3241, _w1#3245, _w2#3246, _w3#3247, rank_within_parent#3210, rank_within_parent#3210]
            +- Window [rank(_w3#3247) windowspecdefinition(_w1#3245, _w2#3246, _w3#3247 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#3210], [_w1#3245, _w2#3246], [_w3#3247 DESC NULLS LAST]
               +- Aggregate [s_state#3231, s_county#3232, spark_grouping_id#3228], [sum(ss_net_profit#152) AS total_sum#3208, s_state#3231, s_county#3232, (cast((shiftright(spark_grouping_id#3228, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#3228, 0) & 1) as tinyint)) AS lochierarchy#3209, sum(ss_net_profit#152) AS _w0#3241, (cast((shiftright(spark_grouping_id#3228, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#3228, 0) & 1) as tinyint)) AS _w1#3245, CASE WHEN (cast(cast((shiftright(spark_grouping_id#3228, 0) & 1) as tinyint) as int) = 0) THEN s_state#3231 END AS _w2#3246, sum(ss_net_profit#152) AS _w3#3247]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#3229, s_county#3230, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#3229, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#3213 [])))
                           :  +- Project [s_state#3211]
                           :     +- Filter (ranking#3212 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#3211, ranking#3212]
                           :              +- Project [s_state#3211, s_state#688, _w1#3219, ranking#3212, ranking#3212]
                           :                 +- Window [rank(_w1#3219) windowspecdefinition(s_state#688, _w1#3219 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#3212], [s_state#688], [_w1#3219 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#3211, s_state#688, sum(ss_net_profit#152) AS _w1#3219]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
20/01/08 18:10:26 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#3263 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#3263 as int) = 0) THEN s_state#3285 END ASC NULLS FIRST, rank_within_parent#3264 ASC NULLS FIRST], true
      +- Project [total_sum#3262, s_state#3285, s_county#3286, lochierarchy#3263, rank_within_parent#3264]
         +- Project [total_sum#3262, s_state#3285, s_county#3286, lochierarchy#3263, _w0#3295, _w1#3299, _w2#3300, _w3#3301, rank_within_parent#3264, rank_within_parent#3264]
            +- Window [rank(_w3#3301) windowspecdefinition(_w1#3299, _w2#3300, _w3#3301 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#3264], [_w1#3299, _w2#3300], [_w3#3301 DESC NULLS LAST]
               +- Aggregate [s_state#3285, s_county#3286, spark_grouping_id#3282], [sum(ss_net_profit#152) AS total_sum#3262, s_state#3285, s_county#3286, (cast((shiftright(spark_grouping_id#3282, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#3282, 0) & 1) as tinyint)) AS lochierarchy#3263, sum(ss_net_profit#152) AS _w0#3295, (cast((shiftright(spark_grouping_id#3282, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#3282, 0) & 1) as tinyint)) AS _w1#3299, CASE WHEN (cast(cast((shiftright(spark_grouping_id#3282, 0) & 1) as tinyint) as int) = 0) THEN s_state#3285 END AS _w2#3300, sum(ss_net_profit#152) AS _w3#3301]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#3283, s_county#3284, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#3283, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#3267 [])))
                           :  +- Project [s_state#3265]
                           :     +- Filter (ranking#3266 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#3265, ranking#3266]
                           :              +- Project [s_state#3265, s_state#688, _w1#3273, ranking#3266, ranking#3266]
                           :                 +- Window [rank(_w1#3273) windowspecdefinition(s_state#688, _w1#3273 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#3266], [s_state#688], [_w1#3273 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#3265, s_state#688, sum(ss_net_profit#152) AS _w1#3273]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 86.523169774s
Running execution q82-v2.4 iteration: 2, StandardRun=true
20/01/08 18:11:53 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
20/01/08 18:11:53 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 86.66216706399999s
Running execution q64-v2.4 iteration: 3, StandardRun=true
20/01/08 18:13:30 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#3600 ASC NULLS FIRST, store_name#3602 ASC NULLS FIRST, cnt#3737L ASC NULLS FIRST], true
+- Project [product_name#3600, store_name#3602, store_zip#3603, b_street_number#3604, b_streen_name#3605, b_city#3606, b_zip#3607, c_street_number#3608, c_street_name#3609, c_city#3610, c_zip#3611, syear#3612, cnt#3615L, s1#3616, s2#3617, s3#3618, s1#3738, s2#3739, s3#3740, syear#3734, cnt#3737L]
   +- Filter ((((item_sk#3601 = item_sk#3723) && (syear#3612 = 1999)) && (syear#3734 = (1999 + 1))) && (((cnt#3737L <= cnt#3615L) && (store_name#3602 = store_name#3724)) && (store_zip#3603 = store_zip#3725)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3700, ca_street_name#3701, ca_city#3704, ca_zip#3707, d_year#498, d_year#3634, d_year#3662], [i_product_name#585 AS product_name#3600, i_item_sk#564 AS item_sk#3601, s_store_name#669 AS store_name#3602, s_zip#689 AS store_zip#3603, ca_street_number#450 AS b_street_number#3604, ca_street_name#451 AS b_streen_name#3605, ca_city#454 AS b_city#3606, ca_zip#457 AS b_zip#3607, ca_street_number#3700 AS c_street_number#3608, ca_street_name#3701 AS c_street_name#3609, ca_city#3704 AS c_city#3610, ca_zip#3707 AS c_zip#3611, d_year#498 AS syear#3612, d_year#3634 AS fsyear#3613, d_year#3662 AS s2year#3614, count(1) AS cnt#3615L, sum(ss_wholesale_cost#141) AS s1#3616, sum(ss_list_price#142) AS s2#3617, sum(ss_coupon_amt#149) AS s3#3618]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#3684)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#3693) && (c_current_addr_sk#416 = ca_address_sk#3698)) && (c_first_sales_date_sk#418 = d_date_sk#3628)) && (((c_first_shipto_date_sk#417 = d_date_sk#3656) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#3694 = ib_income_band_sk#3711) && NOT (cd_marital_status#476 = cd_marital_status#3686)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#3598, refund#3599]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#3624 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#3625 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#3598, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#3599, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#3624, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#3625]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#3628,d_date_id#3629,d_date#3630,d_month_seq#3631,d_week_seq#3632,d_quarter_seq#3633,d_year#3634,d_dow#3635,d_moy#3636,d_dom#3637,d_qoy#3638,d_fy_year#3639,d_fy_quarter_seq#3640,d_fy_week_seq#3641,d_day_name#3642,d_quarter_name#3643,d_holiday#3644,d_weekend#3645,d_following_holiday#3646,d_first_dom#3647,d_last_dom#3648,d_same_day_ly#3649,d_same_day_lq#3650,d_current_day#3651,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#3656,d_date_id#3657,d_date#3658,d_month_seq#3659,d_week_seq#3660,d_quarter_seq#3661,d_year#3662,d_dow#3663,d_moy#3664,d_dom#3665,d_qoy#3666,d_fy_year#3667,d_fy_quarter_seq#3668,d_fy_week_seq#3669,d_day_name#3670,d_quarter_name#3671,d_holiday#3672,d_weekend#3673,d_following_holiday#3674,d_first_dom#3675,d_last_dom#3676,d_same_day_ly#3677,d_same_day_lq#3678,d_current_day#3679,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#3684,cd_gender#3685,cd_marital_status#3686,cd_education_status#3687,cd_purchase_estimate#3688,cd_credit_rating#3689,cd_dep_count#3690,cd_dep_employed_count#3691,cd_dep_college_count#3692] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#3693,hd_income_band_sk#3694,hd_buy_potential#3695,hd_dep_count#3696,hd_vehicle_count#3697] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#3698,ca_address_id#3699,ca_street_number#3700,ca_street_name#3701,ca_street_type#3702,ca_suite_number#3703,ca_city#3704,ca_county#3705,ca_state#3706,ca_zip#3707,ca_country#3708,ca_gmt_offset#3709,ca_location_type#3710] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#3711,ib_lower_bound#3712,ib_upper_bound#3713] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3700, ca_street_name#3701, ca_city#3704, ca_zip#3707, d_year#498, d_year#3634, d_year#3662], [i_product_name#585 AS product_name#3722, i_item_sk#564 AS item_sk#3723, s_store_name#669 AS store_name#3724, s_zip#689 AS store_zip#3725, ca_street_number#450 AS b_street_number#3726, ca_street_name#451 AS b_streen_name#3727, ca_city#454 AS b_city#3728, ca_zip#457 AS b_zip#3729, ca_street_number#3700 AS c_street_number#3730, ca_street_name#3701 AS c_street_name#3731, ca_city#3704 AS c_city#3732, ca_zip#3707 AS c_zip#3733, d_year#498 AS syear#3734, d_year#3634 AS fsyear#3735, d_year#3662 AS s2year#3736, count(1) AS cnt#3737L, sum(ss_wholesale_cost#141) AS s1#3738, sum(ss_list_price#142) AS s2#3739, sum(ss_coupon_amt#149) AS s3#3740]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#3684)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#3693) && (c_current_addr_sk#416 = ca_address_sk#3698)) && (c_first_sales_date_sk#418 = d_date_sk#3628)) && (((c_first_shipto_date_sk#417 = d_date_sk#3656) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#3694 = ib_income_band_sk#3711) && NOT (cd_marital_status#476 = cd_marital_status#3686)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#3598, refund#3599]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#3624 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#3625 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#3598, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#3599, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#3624, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#3625]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#3628,d_date_id#3629,d_date#3630,d_month_seq#3631,d_week_seq#3632,d_quarter_seq#3633,d_year#3634,d_dow#3635,d_moy#3636,d_dom#3637,d_qoy#3638,d_fy_year#3639,d_fy_quarter_seq#3640,d_fy_week_seq#3641,d_day_name#3642,d_quarter_name#3643,d_holiday#3644,d_weekend#3645,d_following_holiday#3646,d_first_dom#3647,d_last_dom#3648,d_same_day_ly#3649,d_same_day_lq#3650,d_current_day#3651,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#3656,d_date_id#3657,d_date#3658,d_month_seq#3659,d_week_seq#3660,d_quarter_seq#3661,d_year#3662,d_dow#3663,d_moy#3664,d_dom#3665,d_qoy#3666,d_fy_year#3667,d_fy_quarter_seq#3668,d_fy_week_seq#3669,d_day_name#3670,d_quarter_name#3671,d_holiday#3672,d_weekend#3673,d_following_holiday#3674,d_first_dom#3675,d_last_dom#3676,d_same_day_ly#3677,d_same_day_lq#3678,d_current_day#3679,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#3684,cd_gender#3685,cd_marital_status#3686,cd_education_status#3687,cd_purchase_estimate#3688,cd_credit_rating#3689,cd_dep_count#3690,cd_dep_employed_count#3691,cd_dep_college_count#3692] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#3693,hd_income_band_sk#3694,hd_buy_potential#3695,hd_dep_count#3696,hd_vehicle_count#3697] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#3698,ca_address_id#3699,ca_street_number#3700,ca_street_name#3701,ca_street_type#3702,ca_suite_number#3703,ca_city#3704,ca_county#3705,ca_state#3706,ca_zip#3707,ca_country#3708,ca_gmt_offset#3709,ca_location_type#3710] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#3711,ib_lower_bound#3712,ib_upper_bound#3713] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
20/01/08 18:13:30 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#3768 ASC NULLS FIRST, store_name#3770 ASC NULLS FIRST, cnt#3905L ASC NULLS FIRST], true
+- Project [product_name#3768, store_name#3770, store_zip#3771, b_street_number#3772, b_streen_name#3773, b_city#3774, b_zip#3775, c_street_number#3776, c_street_name#3777, c_city#3778, c_zip#3779, syear#3780, cnt#3783L, s1#3784, s2#3785, s3#3786, s1#3906, s2#3907, s3#3908, syear#3902, cnt#3905L]
   +- Filter ((((item_sk#3769 = item_sk#3891) && (syear#3780 = 1999)) && (syear#3902 = (1999 + 1))) && (((cnt#3905L <= cnt#3783L) && (store_name#3770 = store_name#3892)) && (store_zip#3771 = store_zip#3893)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3868, ca_street_name#3869, ca_city#3872, ca_zip#3875, d_year#498, d_year#3802, d_year#3830], [i_product_name#585 AS product_name#3768, i_item_sk#564 AS item_sk#3769, s_store_name#669 AS store_name#3770, s_zip#689 AS store_zip#3771, ca_street_number#450 AS b_street_number#3772, ca_street_name#451 AS b_streen_name#3773, ca_city#454 AS b_city#3774, ca_zip#457 AS b_zip#3775, ca_street_number#3868 AS c_street_number#3776, ca_street_name#3869 AS c_street_name#3777, ca_city#3872 AS c_city#3778, ca_zip#3875 AS c_zip#3779, d_year#498 AS syear#3780, d_year#3802 AS fsyear#3781, d_year#3830 AS s2year#3782, count(1) AS cnt#3783L, sum(ss_wholesale_cost#141) AS s1#3784, sum(ss_list_price#142) AS s2#3785, sum(ss_coupon_amt#149) AS s3#3786]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#3852)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#3861) && (c_current_addr_sk#416 = ca_address_sk#3866)) && (c_first_sales_date_sk#418 = d_date_sk#3796)) && (((c_first_shipto_date_sk#417 = d_date_sk#3824) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#3862 = ib_income_band_sk#3879) && NOT (cd_marital_status#476 = cd_marital_status#3854)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#3766, refund#3767]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#3792 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#3793 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#3766, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#3767, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#3792, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#3793]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#3796,d_date_id#3797,d_date#3798,d_month_seq#3799,d_week_seq#3800,d_quarter_seq#3801,d_year#3802,d_dow#3803,d_moy#3804,d_dom#3805,d_qoy#3806,d_fy_year#3807,d_fy_quarter_seq#3808,d_fy_week_seq#3809,d_day_name#3810,d_quarter_name#3811,d_holiday#3812,d_weekend#3813,d_following_holiday#3814,d_first_dom#3815,d_last_dom#3816,d_same_day_ly#3817,d_same_day_lq#3818,d_current_day#3819,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#3824,d_date_id#3825,d_date#3826,d_month_seq#3827,d_week_seq#3828,d_quarter_seq#3829,d_year#3830,d_dow#3831,d_moy#3832,d_dom#3833,d_qoy#3834,d_fy_year#3835,d_fy_quarter_seq#3836,d_fy_week_seq#3837,d_day_name#3838,d_quarter_name#3839,d_holiday#3840,d_weekend#3841,d_following_holiday#3842,d_first_dom#3843,d_last_dom#3844,d_same_day_ly#3845,d_same_day_lq#3846,d_current_day#3847,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#3852,cd_gender#3853,cd_marital_status#3854,cd_education_status#3855,cd_purchase_estimate#3856,cd_credit_rating#3857,cd_dep_count#3858,cd_dep_employed_count#3859,cd_dep_college_count#3860] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#3861,hd_income_band_sk#3862,hd_buy_potential#3863,hd_dep_count#3864,hd_vehicle_count#3865] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#3866,ca_address_id#3867,ca_street_number#3868,ca_street_name#3869,ca_street_type#3870,ca_suite_number#3871,ca_city#3872,ca_county#3873,ca_state#3874,ca_zip#3875,ca_country#3876,ca_gmt_offset#3877,ca_location_type#3878] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#3879,ib_lower_bound#3880,ib_upper_bound#3881] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#3868, ca_street_name#3869, ca_city#3872, ca_zip#3875, d_year#498, d_year#3802, d_year#3830], [i_product_name#585 AS product_name#3890, i_item_sk#564 AS item_sk#3891, s_store_name#669 AS store_name#3892, s_zip#689 AS store_zip#3893, ca_street_number#450 AS b_street_number#3894, ca_street_name#451 AS b_streen_name#3895, ca_city#454 AS b_city#3896, ca_zip#457 AS b_zip#3897, ca_street_number#3868 AS c_street_number#3898, ca_street_name#3869 AS c_street_name#3899, ca_city#3872 AS c_city#3900, ca_zip#3875 AS c_zip#3901, d_year#498 AS syear#3902, d_year#3802 AS fsyear#3903, d_year#3830 AS s2year#3904, count(1) AS cnt#3905L, sum(ss_wholesale_cost#141) AS s1#3906, sum(ss_list_price#142) AS s2#3907, sum(ss_coupon_amt#149) AS s3#3908]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#3852)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#3861) && (c_current_addr_sk#416 = ca_address_sk#3866)) && (c_first_sales_date_sk#418 = d_date_sk#3796)) && (((c_first_shipto_date_sk#417 = d_date_sk#3824) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#3862 = ib_income_band_sk#3879) && NOT (cd_marital_status#476 = cd_marital_status#3854)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#3766, refund#3767]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#3792 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#3793 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#3766, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#3767, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#3792, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#3793]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#3796,d_date_id#3797,d_date#3798,d_month_seq#3799,d_week_seq#3800,d_quarter_seq#3801,d_year#3802,d_dow#3803,d_moy#3804,d_dom#3805,d_qoy#3806,d_fy_year#3807,d_fy_quarter_seq#3808,d_fy_week_seq#3809,d_day_name#3810,d_quarter_name#3811,d_holiday#3812,d_weekend#3813,d_following_holiday#3814,d_first_dom#3815,d_last_dom#3816,d_same_day_ly#3817,d_same_day_lq#3818,d_current_day#3819,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#3824,d_date_id#3825,d_date#3826,d_month_seq#3827,d_week_seq#3828,d_quarter_seq#3829,d_year#3830,d_dow#3831,d_moy#3832,d_dom#3833,d_qoy#3834,d_fy_year#3835,d_fy_quarter_seq#3836,d_fy_week_seq#3837,d_day_name#3838,d_quarter_name#3839,d_holiday#3840,d_weekend#3841,d_following_holiday#3842,d_first_dom#3843,d_last_dom#3844,d_same_day_ly#3845,d_same_day_lq#3846,d_current_day#3847,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#3852,cd_gender#3853,cd_marital_status#3854,cd_education_status#3855,cd_purchase_estimate#3856,cd_credit_rating#3857,cd_dep_count#3858,cd_dep_employed_count#3859,cd_dep_college_count#3860] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#3861,hd_income_band_sk#3862,hd_buy_potential#3863,hd_dep_count#3864,hd_vehicle_count#3865] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#3866,ca_address_id#3867,ca_street_number#3868,ca_street_name#3869,ca_street_type#3870,ca_suite_number#3871,ca_city#3872,ca_county#3873,ca_state#3874,ca_zip#3875,ca_country#3876,ca_gmt_offset#3877,ca_location_type#3878] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#3879,ib_lower_bound#3880,ib_upper_bound#3881] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 827.128222898s
Running execution q70-v2.4 iteration: 3, StandardRun=true
20/01/08 18:27:27 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#4204 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#4204 as int) = 0) THEN s_state#4226 END ASC NULLS FIRST, rank_within_parent#4205 ASC NULLS FIRST], true
      +- Project [total_sum#4203, s_state#4226, s_county#4227, lochierarchy#4204, rank_within_parent#4205]
         +- Project [total_sum#4203, s_state#4226, s_county#4227, lochierarchy#4204, _w0#4236, _w1#4240, _w2#4241, _w3#4242, rank_within_parent#4205, rank_within_parent#4205]
            +- Window [rank(_w3#4242) windowspecdefinition(_w1#4240, _w2#4241, _w3#4242 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#4205], [_w1#4240, _w2#4241], [_w3#4242 DESC NULLS LAST]
               +- Aggregate [s_state#4226, s_county#4227, spark_grouping_id#4223], [sum(ss_net_profit#152) AS total_sum#4203, s_state#4226, s_county#4227, (cast((shiftright(spark_grouping_id#4223, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#4223, 0) & 1) as tinyint)) AS lochierarchy#4204, sum(ss_net_profit#152) AS _w0#4236, (cast((shiftright(spark_grouping_id#4223, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#4223, 0) & 1) as tinyint)) AS _w1#4240, CASE WHEN (cast(cast((shiftright(spark_grouping_id#4223, 0) & 1) as tinyint) as int) = 0) THEN s_state#4226 END AS _w2#4241, sum(ss_net_profit#152) AS _w3#4242]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#4224, s_county#4225, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#4224, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#4208 [])))
                           :  +- Project [s_state#4206]
                           :     +- Filter (ranking#4207 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#4206, ranking#4207]
                           :              +- Project [s_state#4206, s_state#688, _w1#4214, ranking#4207, ranking#4207]
                           :                 +- Window [rank(_w1#4214) windowspecdefinition(s_state#688, _w1#4214 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#4207], [s_state#688], [_w1#4214 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#4206, s_state#688, sum(ss_net_profit#152) AS _w1#4214]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
20/01/08 18:27:27 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#4258 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#4258 as int) = 0) THEN s_state#4280 END ASC NULLS FIRST, rank_within_parent#4259 ASC NULLS FIRST], true
      +- Project [total_sum#4257, s_state#4280, s_county#4281, lochierarchy#4258, rank_within_parent#4259]
         +- Project [total_sum#4257, s_state#4280, s_county#4281, lochierarchy#4258, _w0#4290, _w1#4294, _w2#4295, _w3#4296, rank_within_parent#4259, rank_within_parent#4259]
            +- Window [rank(_w3#4296) windowspecdefinition(_w1#4294, _w2#4295, _w3#4296 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#4259], [_w1#4294, _w2#4295], [_w3#4296 DESC NULLS LAST]
               +- Aggregate [s_state#4280, s_county#4281, spark_grouping_id#4277], [sum(ss_net_profit#152) AS total_sum#4257, s_state#4280, s_county#4281, (cast((shiftright(spark_grouping_id#4277, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#4277, 0) & 1) as tinyint)) AS lochierarchy#4258, sum(ss_net_profit#152) AS _w0#4290, (cast((shiftright(spark_grouping_id#4277, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#4277, 0) & 1) as tinyint)) AS _w1#4294, CASE WHEN (cast(cast((shiftright(spark_grouping_id#4277, 0) & 1) as tinyint) as int) = 0) THEN s_state#4280 END AS _w2#4295, sum(ss_net_profit#152) AS _w3#4296]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#4278, s_county#4279, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#4278, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#4262 [])))
                           :  +- Project [s_state#4260]
                           :     +- Filter (ranking#4261 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#4260, ranking#4261]
                           :              +- Project [s_state#4260, s_state#688, _w1#4268, ranking#4261, ranking#4261]
                           :                 +- Window [rank(_w1#4268) windowspecdefinition(s_state#688, _w1#4268 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#4261], [s_state#688], [_w1#4268 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#4260, s_state#688, sum(ss_net_profit#152) AS _w1#4268]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 86.49464543s
Running execution q82-v2.4 iteration: 3, StandardRun=true
20/01/08 18:28:55 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
20/01/08 18:28:55 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 90.372636512s
Running execution q64-v2.4 iteration: 4, StandardRun=true
20/01/08 18:30:35 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#4595 ASC NULLS FIRST, store_name#4597 ASC NULLS FIRST, cnt#4732L ASC NULLS FIRST], true
+- Project [product_name#4595, store_name#4597, store_zip#4598, b_street_number#4599, b_streen_name#4600, b_city#4601, b_zip#4602, c_street_number#4603, c_street_name#4604, c_city#4605, c_zip#4606, syear#4607, cnt#4610L, s1#4611, s2#4612, s3#4613, s1#4733, s2#4734, s3#4735, syear#4729, cnt#4732L]
   +- Filter ((((item_sk#4596 = item_sk#4718) && (syear#4607 = 1999)) && (syear#4729 = (1999 + 1))) && (((cnt#4732L <= cnt#4610L) && (store_name#4597 = store_name#4719)) && (store_zip#4598 = store_zip#4720)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4695, ca_street_name#4696, ca_city#4699, ca_zip#4702, d_year#498, d_year#4629, d_year#4657], [i_product_name#585 AS product_name#4595, i_item_sk#564 AS item_sk#4596, s_store_name#669 AS store_name#4597, s_zip#689 AS store_zip#4598, ca_street_number#450 AS b_street_number#4599, ca_street_name#451 AS b_streen_name#4600, ca_city#454 AS b_city#4601, ca_zip#457 AS b_zip#4602, ca_street_number#4695 AS c_street_number#4603, ca_street_name#4696 AS c_street_name#4604, ca_city#4699 AS c_city#4605, ca_zip#4702 AS c_zip#4606, d_year#498 AS syear#4607, d_year#4629 AS fsyear#4608, d_year#4657 AS s2year#4609, count(1) AS cnt#4610L, sum(ss_wholesale_cost#141) AS s1#4611, sum(ss_list_price#142) AS s2#4612, sum(ss_coupon_amt#149) AS s3#4613]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#4679)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#4688) && (c_current_addr_sk#416 = ca_address_sk#4693)) && (c_first_sales_date_sk#418 = d_date_sk#4623)) && (((c_first_shipto_date_sk#417 = d_date_sk#4651) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#4689 = ib_income_band_sk#4706) && NOT (cd_marital_status#476 = cd_marital_status#4681)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#4593, refund#4594]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#4619 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#4620 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#4593, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#4594, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#4619, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#4620]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#4623,d_date_id#4624,d_date#4625,d_month_seq#4626,d_week_seq#4627,d_quarter_seq#4628,d_year#4629,d_dow#4630,d_moy#4631,d_dom#4632,d_qoy#4633,d_fy_year#4634,d_fy_quarter_seq#4635,d_fy_week_seq#4636,d_day_name#4637,d_quarter_name#4638,d_holiday#4639,d_weekend#4640,d_following_holiday#4641,d_first_dom#4642,d_last_dom#4643,d_same_day_ly#4644,d_same_day_lq#4645,d_current_day#4646,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#4651,d_date_id#4652,d_date#4653,d_month_seq#4654,d_week_seq#4655,d_quarter_seq#4656,d_year#4657,d_dow#4658,d_moy#4659,d_dom#4660,d_qoy#4661,d_fy_year#4662,d_fy_quarter_seq#4663,d_fy_week_seq#4664,d_day_name#4665,d_quarter_name#4666,d_holiday#4667,d_weekend#4668,d_following_holiday#4669,d_first_dom#4670,d_last_dom#4671,d_same_day_ly#4672,d_same_day_lq#4673,d_current_day#4674,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#4679,cd_gender#4680,cd_marital_status#4681,cd_education_status#4682,cd_purchase_estimate#4683,cd_credit_rating#4684,cd_dep_count#4685,cd_dep_employed_count#4686,cd_dep_college_count#4687] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#4688,hd_income_band_sk#4689,hd_buy_potential#4690,hd_dep_count#4691,hd_vehicle_count#4692] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#4693,ca_address_id#4694,ca_street_number#4695,ca_street_name#4696,ca_street_type#4697,ca_suite_number#4698,ca_city#4699,ca_county#4700,ca_state#4701,ca_zip#4702,ca_country#4703,ca_gmt_offset#4704,ca_location_type#4705] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#4706,ib_lower_bound#4707,ib_upper_bound#4708] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4695, ca_street_name#4696, ca_city#4699, ca_zip#4702, d_year#498, d_year#4629, d_year#4657], [i_product_name#585 AS product_name#4717, i_item_sk#564 AS item_sk#4718, s_store_name#669 AS store_name#4719, s_zip#689 AS store_zip#4720, ca_street_number#450 AS b_street_number#4721, ca_street_name#451 AS b_streen_name#4722, ca_city#454 AS b_city#4723, ca_zip#457 AS b_zip#4724, ca_street_number#4695 AS c_street_number#4725, ca_street_name#4696 AS c_street_name#4726, ca_city#4699 AS c_city#4727, ca_zip#4702 AS c_zip#4728, d_year#498 AS syear#4729, d_year#4629 AS fsyear#4730, d_year#4657 AS s2year#4731, count(1) AS cnt#4732L, sum(ss_wholesale_cost#141) AS s1#4733, sum(ss_list_price#142) AS s2#4734, sum(ss_coupon_amt#149) AS s3#4735]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#4679)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#4688) && (c_current_addr_sk#416 = ca_address_sk#4693)) && (c_first_sales_date_sk#418 = d_date_sk#4623)) && (((c_first_shipto_date_sk#417 = d_date_sk#4651) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#4689 = ib_income_band_sk#4706) && NOT (cd_marital_status#476 = cd_marital_status#4681)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#4593, refund#4594]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#4619 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#4620 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#4593, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#4594, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#4619, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#4620]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#4623,d_date_id#4624,d_date#4625,d_month_seq#4626,d_week_seq#4627,d_quarter_seq#4628,d_year#4629,d_dow#4630,d_moy#4631,d_dom#4632,d_qoy#4633,d_fy_year#4634,d_fy_quarter_seq#4635,d_fy_week_seq#4636,d_day_name#4637,d_quarter_name#4638,d_holiday#4639,d_weekend#4640,d_following_holiday#4641,d_first_dom#4642,d_last_dom#4643,d_same_day_ly#4644,d_same_day_lq#4645,d_current_day#4646,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#4651,d_date_id#4652,d_date#4653,d_month_seq#4654,d_week_seq#4655,d_quarter_seq#4656,d_year#4657,d_dow#4658,d_moy#4659,d_dom#4660,d_qoy#4661,d_fy_year#4662,d_fy_quarter_seq#4663,d_fy_week_seq#4664,d_day_name#4665,d_quarter_name#4666,d_holiday#4667,d_weekend#4668,d_following_holiday#4669,d_first_dom#4670,d_last_dom#4671,d_same_day_ly#4672,d_same_day_lq#4673,d_current_day#4674,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#4679,cd_gender#4680,cd_marital_status#4681,cd_education_status#4682,cd_purchase_estimate#4683,cd_credit_rating#4684,cd_dep_count#4685,cd_dep_employed_count#4686,cd_dep_college_count#4687] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#4688,hd_income_band_sk#4689,hd_buy_potential#4690,hd_dep_count#4691,hd_vehicle_count#4692] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#4693,ca_address_id#4694,ca_street_number#4695,ca_street_name#4696,ca_street_type#4697,ca_suite_number#4698,ca_city#4699,ca_county#4700,ca_state#4701,ca_zip#4702,ca_country#4703,ca_gmt_offset#4704,ca_location_type#4705] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#4706,ib_lower_bound#4707,ib_upper_bound#4708] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
20/01/08 18:30:35 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#4763 ASC NULLS FIRST, store_name#4765 ASC NULLS FIRST, cnt#4900L ASC NULLS FIRST], true
+- Project [product_name#4763, store_name#4765, store_zip#4766, b_street_number#4767, b_streen_name#4768, b_city#4769, b_zip#4770, c_street_number#4771, c_street_name#4772, c_city#4773, c_zip#4774, syear#4775, cnt#4778L, s1#4779, s2#4780, s3#4781, s1#4901, s2#4902, s3#4903, syear#4897, cnt#4900L]
   +- Filter ((((item_sk#4764 = item_sk#4886) && (syear#4775 = 1999)) && (syear#4897 = (1999 + 1))) && (((cnt#4900L <= cnt#4778L) && (store_name#4765 = store_name#4887)) && (store_zip#4766 = store_zip#4888)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4863, ca_street_name#4864, ca_city#4867, ca_zip#4870, d_year#498, d_year#4797, d_year#4825], [i_product_name#585 AS product_name#4763, i_item_sk#564 AS item_sk#4764, s_store_name#669 AS store_name#4765, s_zip#689 AS store_zip#4766, ca_street_number#450 AS b_street_number#4767, ca_street_name#451 AS b_streen_name#4768, ca_city#454 AS b_city#4769, ca_zip#457 AS b_zip#4770, ca_street_number#4863 AS c_street_number#4771, ca_street_name#4864 AS c_street_name#4772, ca_city#4867 AS c_city#4773, ca_zip#4870 AS c_zip#4774, d_year#498 AS syear#4775, d_year#4797 AS fsyear#4776, d_year#4825 AS s2year#4777, count(1) AS cnt#4778L, sum(ss_wholesale_cost#141) AS s1#4779, sum(ss_list_price#142) AS s2#4780, sum(ss_coupon_amt#149) AS s3#4781]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#4847)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#4856) && (c_current_addr_sk#416 = ca_address_sk#4861)) && (c_first_sales_date_sk#418 = d_date_sk#4791)) && (((c_first_shipto_date_sk#417 = d_date_sk#4819) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#4857 = ib_income_band_sk#4874) && NOT (cd_marital_status#476 = cd_marital_status#4849)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#4761, refund#4762]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#4787 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#4788 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#4761, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#4762, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#4787, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#4788]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#4791,d_date_id#4792,d_date#4793,d_month_seq#4794,d_week_seq#4795,d_quarter_seq#4796,d_year#4797,d_dow#4798,d_moy#4799,d_dom#4800,d_qoy#4801,d_fy_year#4802,d_fy_quarter_seq#4803,d_fy_week_seq#4804,d_day_name#4805,d_quarter_name#4806,d_holiday#4807,d_weekend#4808,d_following_holiday#4809,d_first_dom#4810,d_last_dom#4811,d_same_day_ly#4812,d_same_day_lq#4813,d_current_day#4814,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#4819,d_date_id#4820,d_date#4821,d_month_seq#4822,d_week_seq#4823,d_quarter_seq#4824,d_year#4825,d_dow#4826,d_moy#4827,d_dom#4828,d_qoy#4829,d_fy_year#4830,d_fy_quarter_seq#4831,d_fy_week_seq#4832,d_day_name#4833,d_quarter_name#4834,d_holiday#4835,d_weekend#4836,d_following_holiday#4837,d_first_dom#4838,d_last_dom#4839,d_same_day_ly#4840,d_same_day_lq#4841,d_current_day#4842,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#4847,cd_gender#4848,cd_marital_status#4849,cd_education_status#4850,cd_purchase_estimate#4851,cd_credit_rating#4852,cd_dep_count#4853,cd_dep_employed_count#4854,cd_dep_college_count#4855] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#4856,hd_income_band_sk#4857,hd_buy_potential#4858,hd_dep_count#4859,hd_vehicle_count#4860] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#4861,ca_address_id#4862,ca_street_number#4863,ca_street_name#4864,ca_street_type#4865,ca_suite_number#4866,ca_city#4867,ca_county#4868,ca_state#4869,ca_zip#4870,ca_country#4871,ca_gmt_offset#4872,ca_location_type#4873] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#4874,ib_lower_bound#4875,ib_upper_bound#4876] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#4863, ca_street_name#4864, ca_city#4867, ca_zip#4870, d_year#498, d_year#4797, d_year#4825], [i_product_name#585 AS product_name#4885, i_item_sk#564 AS item_sk#4886, s_store_name#669 AS store_name#4887, s_zip#689 AS store_zip#4888, ca_street_number#450 AS b_street_number#4889, ca_street_name#451 AS b_streen_name#4890, ca_city#454 AS b_city#4891, ca_zip#457 AS b_zip#4892, ca_street_number#4863 AS c_street_number#4893, ca_street_name#4864 AS c_street_name#4894, ca_city#4867 AS c_city#4895, ca_zip#4870 AS c_zip#4896, d_year#498 AS syear#4897, d_year#4797 AS fsyear#4898, d_year#4825 AS s2year#4899, count(1) AS cnt#4900L, sum(ss_wholesale_cost#141) AS s1#4901, sum(ss_list_price#142) AS s2#4902, sum(ss_coupon_amt#149) AS s3#4903]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#4847)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#4856) && (c_current_addr_sk#416 = ca_address_sk#4861)) && (c_first_sales_date_sk#418 = d_date_sk#4791)) && (((c_first_shipto_date_sk#417 = d_date_sk#4819) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#4857 = ib_income_band_sk#4874) && NOT (cd_marital_status#476 = cd_marital_status#4849)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#4761, refund#4762]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#4787 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#4788 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#4761, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#4762, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#4787, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#4788]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#4791,d_date_id#4792,d_date#4793,d_month_seq#4794,d_week_seq#4795,d_quarter_seq#4796,d_year#4797,d_dow#4798,d_moy#4799,d_dom#4800,d_qoy#4801,d_fy_year#4802,d_fy_quarter_seq#4803,d_fy_week_seq#4804,d_day_name#4805,d_quarter_name#4806,d_holiday#4807,d_weekend#4808,d_following_holiday#4809,d_first_dom#4810,d_last_dom#4811,d_same_day_ly#4812,d_same_day_lq#4813,d_current_day#4814,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#4819,d_date_id#4820,d_date#4821,d_month_seq#4822,d_week_seq#4823,d_quarter_seq#4824,d_year#4825,d_dow#4826,d_moy#4827,d_dom#4828,d_qoy#4829,d_fy_year#4830,d_fy_quarter_seq#4831,d_fy_week_seq#4832,d_day_name#4833,d_quarter_name#4834,d_holiday#4835,d_weekend#4836,d_following_holiday#4837,d_first_dom#4838,d_last_dom#4839,d_same_day_ly#4840,d_same_day_lq#4841,d_current_day#4842,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#4847,cd_gender#4848,cd_marital_status#4849,cd_education_status#4850,cd_purchase_estimate#4851,cd_credit_rating#4852,cd_dep_count#4853,cd_dep_employed_count#4854,cd_dep_college_count#4855] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#4856,hd_income_band_sk#4857,hd_buy_potential#4858,hd_dep_count#4859,hd_vehicle_count#4860] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#4861,ca_address_id#4862,ca_street_number#4863,ca_street_name#4864,ca_street_type#4865,ca_suite_number#4866,ca_city#4867,ca_county#4868,ca_state#4869,ca_zip#4870,ca_country#4871,ca_gmt_offset#4872,ca_location_type#4873] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#4874,ib_lower_bound#4875,ib_upper_bound#4876] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 1014.082377505s
Running execution q70-v2.4 iteration: 4, StandardRun=true
20/01/08 18:47:40 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#5199 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#5199 as int) = 0) THEN s_state#5221 END ASC NULLS FIRST, rank_within_parent#5200 ASC NULLS FIRST], true
      +- Project [total_sum#5198, s_state#5221, s_county#5222, lochierarchy#5199, rank_within_parent#5200]
         +- Project [total_sum#5198, s_state#5221, s_county#5222, lochierarchy#5199, _w0#5231, _w1#5235, _w2#5236, _w3#5237, rank_within_parent#5200, rank_within_parent#5200]
            +- Window [rank(_w3#5237) windowspecdefinition(_w1#5235, _w2#5236, _w3#5237 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#5200], [_w1#5235, _w2#5236], [_w3#5237 DESC NULLS LAST]
               +- Aggregate [s_state#5221, s_county#5222, spark_grouping_id#5218], [sum(ss_net_profit#152) AS total_sum#5198, s_state#5221, s_county#5222, (cast((shiftright(spark_grouping_id#5218, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#5218, 0) & 1) as tinyint)) AS lochierarchy#5199, sum(ss_net_profit#152) AS _w0#5231, (cast((shiftright(spark_grouping_id#5218, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#5218, 0) & 1) as tinyint)) AS _w1#5235, CASE WHEN (cast(cast((shiftright(spark_grouping_id#5218, 0) & 1) as tinyint) as int) = 0) THEN s_state#5221 END AS _w2#5236, sum(ss_net_profit#152) AS _w3#5237]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#5219, s_county#5220, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#5219, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#5203 [])))
                           :  +- Project [s_state#5201]
                           :     +- Filter (ranking#5202 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#5201, ranking#5202]
                           :              +- Project [s_state#5201, s_state#688, _w1#5209, ranking#5202, ranking#5202]
                           :                 +- Window [rank(_w1#5209) windowspecdefinition(s_state#688, _w1#5209 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#5202], [s_state#688], [_w1#5209 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#5201, s_state#688, sum(ss_net_profit#152) AS _w1#5209]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
20/01/08 18:47:40 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#5253 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#5253 as int) = 0) THEN s_state#5275 END ASC NULLS FIRST, rank_within_parent#5254 ASC NULLS FIRST], true
      +- Project [total_sum#5252, s_state#5275, s_county#5276, lochierarchy#5253, rank_within_parent#5254]
         +- Project [total_sum#5252, s_state#5275, s_county#5276, lochierarchy#5253, _w0#5285, _w1#5289, _w2#5290, _w3#5291, rank_within_parent#5254, rank_within_parent#5254]
            +- Window [rank(_w3#5291) windowspecdefinition(_w1#5289, _w2#5290, _w3#5291 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#5254], [_w1#5289, _w2#5290], [_w3#5291 DESC NULLS LAST]
               +- Aggregate [s_state#5275, s_county#5276, spark_grouping_id#5272], [sum(ss_net_profit#152) AS total_sum#5252, s_state#5275, s_county#5276, (cast((shiftright(spark_grouping_id#5272, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#5272, 0) & 1) as tinyint)) AS lochierarchy#5253, sum(ss_net_profit#152) AS _w0#5285, (cast((shiftright(spark_grouping_id#5272, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#5272, 0) & 1) as tinyint)) AS _w1#5289, CASE WHEN (cast(cast((shiftright(spark_grouping_id#5272, 0) & 1) as tinyint) as int) = 0) THEN s_state#5275 END AS _w2#5290, sum(ss_net_profit#152) AS _w3#5291]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#5273, s_county#5274, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#5273, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#5257 [])))
                           :  +- Project [s_state#5255]
                           :     +- Filter (ranking#5256 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#5255, ranking#5256]
                           :              +- Project [s_state#5255, s_state#688, _w1#5263, ranking#5256, ranking#5256]
                           :                 +- Window [rank(_w1#5263) windowspecdefinition(s_state#688, _w1#5263 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#5256], [s_state#688], [_w1#5263 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#5255, s_state#688, sum(ss_net_profit#152) AS _w1#5263]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 83.03243336199999s
Running execution q82-v2.4 iteration: 4, StandardRun=true
20/01/08 18:49:04 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
20/01/08 18:49:04 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 87.32902565399999s
Running execution q64-v2.4 iteration: 5, StandardRun=true
20/01/08 18:50:41 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#5590 ASC NULLS FIRST, store_name#5592 ASC NULLS FIRST, cnt#5727L ASC NULLS FIRST], true
+- Project [product_name#5590, store_name#5592, store_zip#5593, b_street_number#5594, b_streen_name#5595, b_city#5596, b_zip#5597, c_street_number#5598, c_street_name#5599, c_city#5600, c_zip#5601, syear#5602, cnt#5605L, s1#5606, s2#5607, s3#5608, s1#5728, s2#5729, s3#5730, syear#5724, cnt#5727L]
   +- Filter ((((item_sk#5591 = item_sk#5713) && (syear#5602 = 1999)) && (syear#5724 = (1999 + 1))) && (((cnt#5727L <= cnt#5605L) && (store_name#5592 = store_name#5714)) && (store_zip#5593 = store_zip#5715)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5690, ca_street_name#5691, ca_city#5694, ca_zip#5697, d_year#498, d_year#5624, d_year#5652], [i_product_name#585 AS product_name#5590, i_item_sk#564 AS item_sk#5591, s_store_name#669 AS store_name#5592, s_zip#689 AS store_zip#5593, ca_street_number#450 AS b_street_number#5594, ca_street_name#451 AS b_streen_name#5595, ca_city#454 AS b_city#5596, ca_zip#457 AS b_zip#5597, ca_street_number#5690 AS c_street_number#5598, ca_street_name#5691 AS c_street_name#5599, ca_city#5694 AS c_city#5600, ca_zip#5697 AS c_zip#5601, d_year#498 AS syear#5602, d_year#5624 AS fsyear#5603, d_year#5652 AS s2year#5604, count(1) AS cnt#5605L, sum(ss_wholesale_cost#141) AS s1#5606, sum(ss_list_price#142) AS s2#5607, sum(ss_coupon_amt#149) AS s3#5608]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#5674)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#5683) && (c_current_addr_sk#416 = ca_address_sk#5688)) && (c_first_sales_date_sk#418 = d_date_sk#5618)) && (((c_first_shipto_date_sk#417 = d_date_sk#5646) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#5684 = ib_income_band_sk#5701) && NOT (cd_marital_status#476 = cd_marital_status#5676)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#5588, refund#5589]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#5614 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#5615 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#5588, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#5589, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#5614, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#5615]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#5618,d_date_id#5619,d_date#5620,d_month_seq#5621,d_week_seq#5622,d_quarter_seq#5623,d_year#5624,d_dow#5625,d_moy#5626,d_dom#5627,d_qoy#5628,d_fy_year#5629,d_fy_quarter_seq#5630,d_fy_week_seq#5631,d_day_name#5632,d_quarter_name#5633,d_holiday#5634,d_weekend#5635,d_following_holiday#5636,d_first_dom#5637,d_last_dom#5638,d_same_day_ly#5639,d_same_day_lq#5640,d_current_day#5641,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#5646,d_date_id#5647,d_date#5648,d_month_seq#5649,d_week_seq#5650,d_quarter_seq#5651,d_year#5652,d_dow#5653,d_moy#5654,d_dom#5655,d_qoy#5656,d_fy_year#5657,d_fy_quarter_seq#5658,d_fy_week_seq#5659,d_day_name#5660,d_quarter_name#5661,d_holiday#5662,d_weekend#5663,d_following_holiday#5664,d_first_dom#5665,d_last_dom#5666,d_same_day_ly#5667,d_same_day_lq#5668,d_current_day#5669,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#5674,cd_gender#5675,cd_marital_status#5676,cd_education_status#5677,cd_purchase_estimate#5678,cd_credit_rating#5679,cd_dep_count#5680,cd_dep_employed_count#5681,cd_dep_college_count#5682] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#5683,hd_income_band_sk#5684,hd_buy_potential#5685,hd_dep_count#5686,hd_vehicle_count#5687] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#5688,ca_address_id#5689,ca_street_number#5690,ca_street_name#5691,ca_street_type#5692,ca_suite_number#5693,ca_city#5694,ca_county#5695,ca_state#5696,ca_zip#5697,ca_country#5698,ca_gmt_offset#5699,ca_location_type#5700] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#5701,ib_lower_bound#5702,ib_upper_bound#5703] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5690, ca_street_name#5691, ca_city#5694, ca_zip#5697, d_year#498, d_year#5624, d_year#5652], [i_product_name#585 AS product_name#5712, i_item_sk#564 AS item_sk#5713, s_store_name#669 AS store_name#5714, s_zip#689 AS store_zip#5715, ca_street_number#450 AS b_street_number#5716, ca_street_name#451 AS b_streen_name#5717, ca_city#454 AS b_city#5718, ca_zip#457 AS b_zip#5719, ca_street_number#5690 AS c_street_number#5720, ca_street_name#5691 AS c_street_name#5721, ca_city#5694 AS c_city#5722, ca_zip#5697 AS c_zip#5723, d_year#498 AS syear#5724, d_year#5624 AS fsyear#5725, d_year#5652 AS s2year#5726, count(1) AS cnt#5727L, sum(ss_wholesale_cost#141) AS s1#5728, sum(ss_list_price#142) AS s2#5729, sum(ss_coupon_amt#149) AS s3#5730]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#5674)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#5683) && (c_current_addr_sk#416 = ca_address_sk#5688)) && (c_first_sales_date_sk#418 = d_date_sk#5618)) && (((c_first_shipto_date_sk#417 = d_date_sk#5646) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#5684 = ib_income_band_sk#5701) && NOT (cd_marital_status#476 = cd_marital_status#5676)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#5588, refund#5589]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#5614 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#5615 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#5588, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#5589, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#5614, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#5615]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#5618,d_date_id#5619,d_date#5620,d_month_seq#5621,d_week_seq#5622,d_quarter_seq#5623,d_year#5624,d_dow#5625,d_moy#5626,d_dom#5627,d_qoy#5628,d_fy_year#5629,d_fy_quarter_seq#5630,d_fy_week_seq#5631,d_day_name#5632,d_quarter_name#5633,d_holiday#5634,d_weekend#5635,d_following_holiday#5636,d_first_dom#5637,d_last_dom#5638,d_same_day_ly#5639,d_same_day_lq#5640,d_current_day#5641,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#5646,d_date_id#5647,d_date#5648,d_month_seq#5649,d_week_seq#5650,d_quarter_seq#5651,d_year#5652,d_dow#5653,d_moy#5654,d_dom#5655,d_qoy#5656,d_fy_year#5657,d_fy_quarter_seq#5658,d_fy_week_seq#5659,d_day_name#5660,d_quarter_name#5661,d_holiday#5662,d_weekend#5663,d_following_holiday#5664,d_first_dom#5665,d_last_dom#5666,d_same_day_ly#5667,d_same_day_lq#5668,d_current_day#5669,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#5674,cd_gender#5675,cd_marital_status#5676,cd_education_status#5677,cd_purchase_estimate#5678,cd_credit_rating#5679,cd_dep_count#5680,cd_dep_employed_count#5681,cd_dep_college_count#5682] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#5683,hd_income_band_sk#5684,hd_buy_potential#5685,hd_dep_count#5686,hd_vehicle_count#5687] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#5688,ca_address_id#5689,ca_street_number#5690,ca_street_name#5691,ca_street_type#5692,ca_suite_number#5693,ca_city#5694,ca_county#5695,ca_state#5696,ca_zip#5697,ca_country#5698,ca_gmt_offset#5699,ca_location_type#5700] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#5701,ib_lower_bound#5702,ib_upper_bound#5703] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
20/01/08 18:50:41 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#5758 ASC NULLS FIRST, store_name#5760 ASC NULLS FIRST, cnt#5895L ASC NULLS FIRST], true
+- Project [product_name#5758, store_name#5760, store_zip#5761, b_street_number#5762, b_streen_name#5763, b_city#5764, b_zip#5765, c_street_number#5766, c_street_name#5767, c_city#5768, c_zip#5769, syear#5770, cnt#5773L, s1#5774, s2#5775, s3#5776, s1#5896, s2#5897, s3#5898, syear#5892, cnt#5895L]
   +- Filter ((((item_sk#5759 = item_sk#5881) && (syear#5770 = 1999)) && (syear#5892 = (1999 + 1))) && (((cnt#5895L <= cnt#5773L) && (store_name#5760 = store_name#5882)) && (store_zip#5761 = store_zip#5883)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5858, ca_street_name#5859, ca_city#5862, ca_zip#5865, d_year#498, d_year#5792, d_year#5820], [i_product_name#585 AS product_name#5758, i_item_sk#564 AS item_sk#5759, s_store_name#669 AS store_name#5760, s_zip#689 AS store_zip#5761, ca_street_number#450 AS b_street_number#5762, ca_street_name#451 AS b_streen_name#5763, ca_city#454 AS b_city#5764, ca_zip#457 AS b_zip#5765, ca_street_number#5858 AS c_street_number#5766, ca_street_name#5859 AS c_street_name#5767, ca_city#5862 AS c_city#5768, ca_zip#5865 AS c_zip#5769, d_year#498 AS syear#5770, d_year#5792 AS fsyear#5771, d_year#5820 AS s2year#5772, count(1) AS cnt#5773L, sum(ss_wholesale_cost#141) AS s1#5774, sum(ss_list_price#142) AS s2#5775, sum(ss_coupon_amt#149) AS s3#5776]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#5842)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#5851) && (c_current_addr_sk#416 = ca_address_sk#5856)) && (c_first_sales_date_sk#418 = d_date_sk#5786)) && (((c_first_shipto_date_sk#417 = d_date_sk#5814) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#5852 = ib_income_band_sk#5869) && NOT (cd_marital_status#476 = cd_marital_status#5844)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#5756, refund#5757]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#5782 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#5783 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#5756, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#5757, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#5782, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#5783]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#5786,d_date_id#5787,d_date#5788,d_month_seq#5789,d_week_seq#5790,d_quarter_seq#5791,d_year#5792,d_dow#5793,d_moy#5794,d_dom#5795,d_qoy#5796,d_fy_year#5797,d_fy_quarter_seq#5798,d_fy_week_seq#5799,d_day_name#5800,d_quarter_name#5801,d_holiday#5802,d_weekend#5803,d_following_holiday#5804,d_first_dom#5805,d_last_dom#5806,d_same_day_ly#5807,d_same_day_lq#5808,d_current_day#5809,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#5814,d_date_id#5815,d_date#5816,d_month_seq#5817,d_week_seq#5818,d_quarter_seq#5819,d_year#5820,d_dow#5821,d_moy#5822,d_dom#5823,d_qoy#5824,d_fy_year#5825,d_fy_quarter_seq#5826,d_fy_week_seq#5827,d_day_name#5828,d_quarter_name#5829,d_holiday#5830,d_weekend#5831,d_following_holiday#5832,d_first_dom#5833,d_last_dom#5834,d_same_day_ly#5835,d_same_day_lq#5836,d_current_day#5837,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#5842,cd_gender#5843,cd_marital_status#5844,cd_education_status#5845,cd_purchase_estimate#5846,cd_credit_rating#5847,cd_dep_count#5848,cd_dep_employed_count#5849,cd_dep_college_count#5850] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#5851,hd_income_band_sk#5852,hd_buy_potential#5853,hd_dep_count#5854,hd_vehicle_count#5855] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#5856,ca_address_id#5857,ca_street_number#5858,ca_street_name#5859,ca_street_type#5860,ca_suite_number#5861,ca_city#5862,ca_county#5863,ca_state#5864,ca_zip#5865,ca_country#5866,ca_gmt_offset#5867,ca_location_type#5868] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#5869,ib_lower_bound#5870,ib_upper_bound#5871] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#5858, ca_street_name#5859, ca_city#5862, ca_zip#5865, d_year#498, d_year#5792, d_year#5820], [i_product_name#585 AS product_name#5880, i_item_sk#564 AS item_sk#5881, s_store_name#669 AS store_name#5882, s_zip#689 AS store_zip#5883, ca_street_number#450 AS b_street_number#5884, ca_street_name#451 AS b_streen_name#5885, ca_city#454 AS b_city#5886, ca_zip#457 AS b_zip#5887, ca_street_number#5858 AS c_street_number#5888, ca_street_name#5859 AS c_street_name#5889, ca_city#5862 AS c_city#5890, ca_zip#5865 AS c_zip#5891, d_year#498 AS syear#5892, d_year#5792 AS fsyear#5893, d_year#5820 AS s2year#5894, count(1) AS cnt#5895L, sum(ss_wholesale_cost#141) AS s1#5896, sum(ss_list_price#142) AS s2#5897, sum(ss_coupon_amt#149) AS s3#5898]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#5842)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#5851) && (c_current_addr_sk#416 = ca_address_sk#5856)) && (c_first_sales_date_sk#418 = d_date_sk#5786)) && (((c_first_shipto_date_sk#417 = d_date_sk#5814) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#5852 = ib_income_band_sk#5869) && NOT (cd_marital_status#476 = cd_marital_status#5844)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#5756, refund#5757]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#5782 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#5783 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#5756, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#5757, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#5782, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#5783]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#5786,d_date_id#5787,d_date#5788,d_month_seq#5789,d_week_seq#5790,d_quarter_seq#5791,d_year#5792,d_dow#5793,d_moy#5794,d_dom#5795,d_qoy#5796,d_fy_year#5797,d_fy_quarter_seq#5798,d_fy_week_seq#5799,d_day_name#5800,d_quarter_name#5801,d_holiday#5802,d_weekend#5803,d_following_holiday#5804,d_first_dom#5805,d_last_dom#5806,d_same_day_ly#5807,d_same_day_lq#5808,d_current_day#5809,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#5814,d_date_id#5815,d_date#5816,d_month_seq#5817,d_week_seq#5818,d_quarter_seq#5819,d_year#5820,d_dow#5821,d_moy#5822,d_dom#5823,d_qoy#5824,d_fy_year#5825,d_fy_quarter_seq#5826,d_fy_week_seq#5827,d_day_name#5828,d_quarter_name#5829,d_holiday#5830,d_weekend#5831,d_following_holiday#5832,d_first_dom#5833,d_last_dom#5834,d_same_day_ly#5835,d_same_day_lq#5836,d_current_day#5837,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#5842,cd_gender#5843,cd_marital_status#5844,cd_education_status#5845,cd_purchase_estimate#5846,cd_credit_rating#5847,cd_dep_count#5848,cd_dep_employed_count#5849,cd_dep_college_count#5850] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#5851,hd_income_band_sk#5852,hd_buy_potential#5853,hd_dep_count#5854,hd_vehicle_count#5855] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#5856,ca_address_id#5857,ca_street_number#5858,ca_street_name#5859,ca_street_type#5860,ca_suite_number#5861,ca_city#5862,ca_county#5863,ca_state#5864,ca_zip#5865,ca_country#5866,ca_gmt_offset#5867,ca_location_type#5868] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#5869,ib_lower_bound#5870,ib_upper_bound#5871] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 828.604365161s
Running execution q70-v2.4 iteration: 5, StandardRun=true
20/01/08 19:04:40 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#6194 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#6194 as int) = 0) THEN s_state#6216 END ASC NULLS FIRST, rank_within_parent#6195 ASC NULLS FIRST], true
      +- Project [total_sum#6193, s_state#6216, s_county#6217, lochierarchy#6194, rank_within_parent#6195]
         +- Project [total_sum#6193, s_state#6216, s_county#6217, lochierarchy#6194, _w0#6226, _w1#6230, _w2#6231, _w3#6232, rank_within_parent#6195, rank_within_parent#6195]
            +- Window [rank(_w3#6232) windowspecdefinition(_w1#6230, _w2#6231, _w3#6232 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#6195], [_w1#6230, _w2#6231], [_w3#6232 DESC NULLS LAST]
               +- Aggregate [s_state#6216, s_county#6217, spark_grouping_id#6213], [sum(ss_net_profit#152) AS total_sum#6193, s_state#6216, s_county#6217, (cast((shiftright(spark_grouping_id#6213, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#6213, 0) & 1) as tinyint)) AS lochierarchy#6194, sum(ss_net_profit#152) AS _w0#6226, (cast((shiftright(spark_grouping_id#6213, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#6213, 0) & 1) as tinyint)) AS _w1#6230, CASE WHEN (cast(cast((shiftright(spark_grouping_id#6213, 0) & 1) as tinyint) as int) = 0) THEN s_state#6216 END AS _w2#6231, sum(ss_net_profit#152) AS _w3#6232]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#6214, s_county#6215, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#6214, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#6198 [])))
                           :  +- Project [s_state#6196]
                           :     +- Filter (ranking#6197 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#6196, ranking#6197]
                           :              +- Project [s_state#6196, s_state#688, _w1#6204, ranking#6197, ranking#6197]
                           :                 +- Window [rank(_w1#6204) windowspecdefinition(s_state#688, _w1#6204 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#6197], [s_state#688], [_w1#6204 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#6196, s_state#688, sum(ss_net_profit#152) AS _w1#6204]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
20/01/08 19:04:40 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#6248 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#6248 as int) = 0) THEN s_state#6270 END ASC NULLS FIRST, rank_within_parent#6249 ASC NULLS FIRST], true
      +- Project [total_sum#6247, s_state#6270, s_county#6271, lochierarchy#6248, rank_within_parent#6249]
         +- Project [total_sum#6247, s_state#6270, s_county#6271, lochierarchy#6248, _w0#6280, _w1#6284, _w2#6285, _w3#6286, rank_within_parent#6249, rank_within_parent#6249]
            +- Window [rank(_w3#6286) windowspecdefinition(_w1#6284, _w2#6285, _w3#6286 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#6249], [_w1#6284, _w2#6285], [_w3#6286 DESC NULLS LAST]
               +- Aggregate [s_state#6270, s_county#6271, spark_grouping_id#6267], [sum(ss_net_profit#152) AS total_sum#6247, s_state#6270, s_county#6271, (cast((shiftright(spark_grouping_id#6267, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#6267, 0) & 1) as tinyint)) AS lochierarchy#6248, sum(ss_net_profit#152) AS _w0#6280, (cast((shiftright(spark_grouping_id#6267, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#6267, 0) & 1) as tinyint)) AS _w1#6284, CASE WHEN (cast(cast((shiftright(spark_grouping_id#6267, 0) & 1) as tinyint) as int) = 0) THEN s_state#6270 END AS _w2#6285, sum(ss_net_profit#152) AS _w3#6286]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#6268, s_county#6269, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#6268, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#6252 [])))
                           :  +- Project [s_state#6250]
                           :     +- Filter (ranking#6251 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#6250, ranking#6251]
                           :              +- Project [s_state#6250, s_state#688, _w1#6258, ranking#6251, ranking#6251]
                           :                 +- Window [rank(_w1#6258) windowspecdefinition(s_state#688, _w1#6258 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#6251], [s_state#688], [_w1#6258 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#6250, s_state#688, sum(ss_net_profit#152) AS _w1#6258]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 77.86118556500001s
Running execution q82-v2.4 iteration: 5, StandardRun=true
20/01/08 19:05:59 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
20/01/08 19:05:59 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 87.010027666s
Running execution q64-v2.4 iteration: 6, StandardRun=true
20/01/08 19:07:35 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#6585 ASC NULLS FIRST, store_name#6587 ASC NULLS FIRST, cnt#6722L ASC NULLS FIRST], true
+- Project [product_name#6585, store_name#6587, store_zip#6588, b_street_number#6589, b_streen_name#6590, b_city#6591, b_zip#6592, c_street_number#6593, c_street_name#6594, c_city#6595, c_zip#6596, syear#6597, cnt#6600L, s1#6601, s2#6602, s3#6603, s1#6723, s2#6724, s3#6725, syear#6719, cnt#6722L]
   +- Filter ((((item_sk#6586 = item_sk#6708) && (syear#6597 = 1999)) && (syear#6719 = (1999 + 1))) && (((cnt#6722L <= cnt#6600L) && (store_name#6587 = store_name#6709)) && (store_zip#6588 = store_zip#6710)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#6685, ca_street_name#6686, ca_city#6689, ca_zip#6692, d_year#498, d_year#6619, d_year#6647], [i_product_name#585 AS product_name#6585, i_item_sk#564 AS item_sk#6586, s_store_name#669 AS store_name#6587, s_zip#689 AS store_zip#6588, ca_street_number#450 AS b_street_number#6589, ca_street_name#451 AS b_streen_name#6590, ca_city#454 AS b_city#6591, ca_zip#457 AS b_zip#6592, ca_street_number#6685 AS c_street_number#6593, ca_street_name#6686 AS c_street_name#6594, ca_city#6689 AS c_city#6595, ca_zip#6692 AS c_zip#6596, d_year#498 AS syear#6597, d_year#6619 AS fsyear#6598, d_year#6647 AS s2year#6599, count(1) AS cnt#6600L, sum(ss_wholesale_cost#141) AS s1#6601, sum(ss_list_price#142) AS s2#6602, sum(ss_coupon_amt#149) AS s3#6603]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#6669)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#6678) && (c_current_addr_sk#416 = ca_address_sk#6683)) && (c_first_sales_date_sk#418 = d_date_sk#6613)) && (((c_first_shipto_date_sk#417 = d_date_sk#6641) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#6679 = ib_income_band_sk#6696) && NOT (cd_marital_status#476 = cd_marital_status#6671)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#6583, refund#6584]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#6609 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#6610 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#6583, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#6584, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#6609, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#6610]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#6613,d_date_id#6614,d_date#6615,d_month_seq#6616,d_week_seq#6617,d_quarter_seq#6618,d_year#6619,d_dow#6620,d_moy#6621,d_dom#6622,d_qoy#6623,d_fy_year#6624,d_fy_quarter_seq#6625,d_fy_week_seq#6626,d_day_name#6627,d_quarter_name#6628,d_holiday#6629,d_weekend#6630,d_following_holiday#6631,d_first_dom#6632,d_last_dom#6633,d_same_day_ly#6634,d_same_day_lq#6635,d_current_day#6636,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#6641,d_date_id#6642,d_date#6643,d_month_seq#6644,d_week_seq#6645,d_quarter_seq#6646,d_year#6647,d_dow#6648,d_moy#6649,d_dom#6650,d_qoy#6651,d_fy_year#6652,d_fy_quarter_seq#6653,d_fy_week_seq#6654,d_day_name#6655,d_quarter_name#6656,d_holiday#6657,d_weekend#6658,d_following_holiday#6659,d_first_dom#6660,d_last_dom#6661,d_same_day_ly#6662,d_same_day_lq#6663,d_current_day#6664,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#6669,cd_gender#6670,cd_marital_status#6671,cd_education_status#6672,cd_purchase_estimate#6673,cd_credit_rating#6674,cd_dep_count#6675,cd_dep_employed_count#6676,cd_dep_college_count#6677] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#6678,hd_income_band_sk#6679,hd_buy_potential#6680,hd_dep_count#6681,hd_vehicle_count#6682] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#6683,ca_address_id#6684,ca_street_number#6685,ca_street_name#6686,ca_street_type#6687,ca_suite_number#6688,ca_city#6689,ca_county#6690,ca_state#6691,ca_zip#6692,ca_country#6693,ca_gmt_offset#6694,ca_location_type#6695] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#6696,ib_lower_bound#6697,ib_upper_bound#6698] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#6685, ca_street_name#6686, ca_city#6689, ca_zip#6692, d_year#498, d_year#6619, d_year#6647], [i_product_name#585 AS product_name#6707, i_item_sk#564 AS item_sk#6708, s_store_name#669 AS store_name#6709, s_zip#689 AS store_zip#6710, ca_street_number#450 AS b_street_number#6711, ca_street_name#451 AS b_streen_name#6712, ca_city#454 AS b_city#6713, ca_zip#457 AS b_zip#6714, ca_street_number#6685 AS c_street_number#6715, ca_street_name#6686 AS c_street_name#6716, ca_city#6689 AS c_city#6717, ca_zip#6692 AS c_zip#6718, d_year#498 AS syear#6719, d_year#6619 AS fsyear#6720, d_year#6647 AS s2year#6721, count(1) AS cnt#6722L, sum(ss_wholesale_cost#141) AS s1#6723, sum(ss_list_price#142) AS s2#6724, sum(ss_coupon_amt#149) AS s3#6725]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#6669)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#6678) && (c_current_addr_sk#416 = ca_address_sk#6683)) && (c_first_sales_date_sk#418 = d_date_sk#6613)) && (((c_first_shipto_date_sk#417 = d_date_sk#6641) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#6679 = ib_income_band_sk#6696) && NOT (cd_marital_status#476 = cd_marital_status#6671)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#6583, refund#6584]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#6609 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#6610 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#6583, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#6584, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#6609, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#6610]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#6613,d_date_id#6614,d_date#6615,d_month_seq#6616,d_week_seq#6617,d_quarter_seq#6618,d_year#6619,d_dow#6620,d_moy#6621,d_dom#6622,d_qoy#6623,d_fy_year#6624,d_fy_quarter_seq#6625,d_fy_week_seq#6626,d_day_name#6627,d_quarter_name#6628,d_holiday#6629,d_weekend#6630,d_following_holiday#6631,d_first_dom#6632,d_last_dom#6633,d_same_day_ly#6634,d_same_day_lq#6635,d_current_day#6636,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#6641,d_date_id#6642,d_date#6643,d_month_seq#6644,d_week_seq#6645,d_quarter_seq#6646,d_year#6647,d_dow#6648,d_moy#6649,d_dom#6650,d_qoy#6651,d_fy_year#6652,d_fy_quarter_seq#6653,d_fy_week_seq#6654,d_day_name#6655,d_quarter_name#6656,d_holiday#6657,d_weekend#6658,d_following_holiday#6659,d_first_dom#6660,d_last_dom#6661,d_same_day_ly#6662,d_same_day_lq#6663,d_current_day#6664,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#6669,cd_gender#6670,cd_marital_status#6671,cd_education_status#6672,cd_purchase_estimate#6673,cd_credit_rating#6674,cd_dep_count#6675,cd_dep_employed_count#6676,cd_dep_college_count#6677] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#6678,hd_income_band_sk#6679,hd_buy_potential#6680,hd_dep_count#6681,hd_vehicle_count#6682] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#6683,ca_address_id#6684,ca_street_number#6685,ca_street_name#6686,ca_street_type#6687,ca_suite_number#6688,ca_city#6689,ca_county#6690,ca_state#6691,ca_zip#6692,ca_country#6693,ca_gmt_offset#6694,ca_location_type#6695] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#6696,ib_lower_bound#6697,ib_upper_bound#6698] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
20/01/08 19:07:36 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#6753 ASC NULLS FIRST, store_name#6755 ASC NULLS FIRST, cnt#6890L ASC NULLS FIRST], true
+- Project [product_name#6753, store_name#6755, store_zip#6756, b_street_number#6757, b_streen_name#6758, b_city#6759, b_zip#6760, c_street_number#6761, c_street_name#6762, c_city#6763, c_zip#6764, syear#6765, cnt#6768L, s1#6769, s2#6770, s3#6771, s1#6891, s2#6892, s3#6893, syear#6887, cnt#6890L]
   +- Filter ((((item_sk#6754 = item_sk#6876) && (syear#6765 = 1999)) && (syear#6887 = (1999 + 1))) && (((cnt#6890L <= cnt#6768L) && (store_name#6755 = store_name#6877)) && (store_zip#6756 = store_zip#6878)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#6853, ca_street_name#6854, ca_city#6857, ca_zip#6860, d_year#498, d_year#6787, d_year#6815], [i_product_name#585 AS product_name#6753, i_item_sk#564 AS item_sk#6754, s_store_name#669 AS store_name#6755, s_zip#689 AS store_zip#6756, ca_street_number#450 AS b_street_number#6757, ca_street_name#451 AS b_streen_name#6758, ca_city#454 AS b_city#6759, ca_zip#457 AS b_zip#6760, ca_street_number#6853 AS c_street_number#6761, ca_street_name#6854 AS c_street_name#6762, ca_city#6857 AS c_city#6763, ca_zip#6860 AS c_zip#6764, d_year#498 AS syear#6765, d_year#6787 AS fsyear#6766, d_year#6815 AS s2year#6767, count(1) AS cnt#6768L, sum(ss_wholesale_cost#141) AS s1#6769, sum(ss_list_price#142) AS s2#6770, sum(ss_coupon_amt#149) AS s3#6771]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#6837)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#6846) && (c_current_addr_sk#416 = ca_address_sk#6851)) && (c_first_sales_date_sk#418 = d_date_sk#6781)) && (((c_first_shipto_date_sk#417 = d_date_sk#6809) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#6847 = ib_income_band_sk#6864) && NOT (cd_marital_status#476 = cd_marital_status#6839)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#6751, refund#6752]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#6777 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#6778 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#6751, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#6752, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#6777, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#6778]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#6781,d_date_id#6782,d_date#6783,d_month_seq#6784,d_week_seq#6785,d_quarter_seq#6786,d_year#6787,d_dow#6788,d_moy#6789,d_dom#6790,d_qoy#6791,d_fy_year#6792,d_fy_quarter_seq#6793,d_fy_week_seq#6794,d_day_name#6795,d_quarter_name#6796,d_holiday#6797,d_weekend#6798,d_following_holiday#6799,d_first_dom#6800,d_last_dom#6801,d_same_day_ly#6802,d_same_day_lq#6803,d_current_day#6804,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#6809,d_date_id#6810,d_date#6811,d_month_seq#6812,d_week_seq#6813,d_quarter_seq#6814,d_year#6815,d_dow#6816,d_moy#6817,d_dom#6818,d_qoy#6819,d_fy_year#6820,d_fy_quarter_seq#6821,d_fy_week_seq#6822,d_day_name#6823,d_quarter_name#6824,d_holiday#6825,d_weekend#6826,d_following_holiday#6827,d_first_dom#6828,d_last_dom#6829,d_same_day_ly#6830,d_same_day_lq#6831,d_current_day#6832,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#6837,cd_gender#6838,cd_marital_status#6839,cd_education_status#6840,cd_purchase_estimate#6841,cd_credit_rating#6842,cd_dep_count#6843,cd_dep_employed_count#6844,cd_dep_college_count#6845] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#6846,hd_income_band_sk#6847,hd_buy_potential#6848,hd_dep_count#6849,hd_vehicle_count#6850] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#6851,ca_address_id#6852,ca_street_number#6853,ca_street_name#6854,ca_street_type#6855,ca_suite_number#6856,ca_city#6857,ca_county#6858,ca_state#6859,ca_zip#6860,ca_country#6861,ca_gmt_offset#6862,ca_location_type#6863] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#6864,ib_lower_bound#6865,ib_upper_bound#6866] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#6853, ca_street_name#6854, ca_city#6857, ca_zip#6860, d_year#498, d_year#6787, d_year#6815], [i_product_name#585 AS product_name#6875, i_item_sk#564 AS item_sk#6876, s_store_name#669 AS store_name#6877, s_zip#689 AS store_zip#6878, ca_street_number#450 AS b_street_number#6879, ca_street_name#451 AS b_streen_name#6880, ca_city#454 AS b_city#6881, ca_zip#457 AS b_zip#6882, ca_street_number#6853 AS c_street_number#6883, ca_street_name#6854 AS c_street_name#6884, ca_city#6857 AS c_city#6885, ca_zip#6860 AS c_zip#6886, d_year#498 AS syear#6887, d_year#6787 AS fsyear#6888, d_year#6815 AS s2year#6889, count(1) AS cnt#6890L, sum(ss_wholesale_cost#141) AS s1#6891, sum(ss_list_price#142) AS s2#6892, sum(ss_coupon_amt#149) AS s3#6893]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#6837)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#6846) && (c_current_addr_sk#416 = ca_address_sk#6851)) && (c_first_sales_date_sk#418 = d_date_sk#6781)) && (((c_first_shipto_date_sk#417 = d_date_sk#6809) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#6847 = ib_income_band_sk#6864) && NOT (cd_marital_status#476 = cd_marital_status#6839)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#6751, refund#6752]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#6777 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#6778 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#6751, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#6752, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#6777, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#6778]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#6781,d_date_id#6782,d_date#6783,d_month_seq#6784,d_week_seq#6785,d_quarter_seq#6786,d_year#6787,d_dow#6788,d_moy#6789,d_dom#6790,d_qoy#6791,d_fy_year#6792,d_fy_quarter_seq#6793,d_fy_week_seq#6794,d_day_name#6795,d_quarter_name#6796,d_holiday#6797,d_weekend#6798,d_following_holiday#6799,d_first_dom#6800,d_last_dom#6801,d_same_day_ly#6802,d_same_day_lq#6803,d_current_day#6804,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#6809,d_date_id#6810,d_date#6811,d_month_seq#6812,d_week_seq#6813,d_quarter_seq#6814,d_year#6815,d_dow#6816,d_moy#6817,d_dom#6818,d_qoy#6819,d_fy_year#6820,d_fy_quarter_seq#6821,d_fy_week_seq#6822,d_day_name#6823,d_quarter_name#6824,d_holiday#6825,d_weekend#6826,d_following_holiday#6827,d_first_dom#6828,d_last_dom#6829,d_same_day_ly#6830,d_same_day_lq#6831,d_current_day#6832,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#6837,cd_gender#6838,cd_marital_status#6839,cd_education_status#6840,cd_purchase_estimate#6841,cd_credit_rating#6842,cd_dep_count#6843,cd_dep_employed_count#6844,cd_dep_college_count#6845] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#6846,hd_income_band_sk#6847,hd_buy_potential#6848,hd_dep_count#6849,hd_vehicle_count#6850] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#6851,ca_address_id#6852,ca_street_number#6853,ca_street_name#6854,ca_street_type#6855,ca_suite_number#6856,ca_city#6857,ca_county#6858,ca_state#6859,ca_zip#6860,ca_country#6861,ca_gmt_offset#6862,ca_location_type#6863] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#6864,ib_lower_bound#6865,ib_upper_bound#6866] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 812.6623579550001s
Running execution q70-v2.4 iteration: 6, StandardRun=true
20/01/08 19:21:18 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#7189 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#7189 as int) = 0) THEN s_state#7211 END ASC NULLS FIRST, rank_within_parent#7190 ASC NULLS FIRST], true
      +- Project [total_sum#7188, s_state#7211, s_county#7212, lochierarchy#7189, rank_within_parent#7190]
         +- Project [total_sum#7188, s_state#7211, s_county#7212, lochierarchy#7189, _w0#7221, _w1#7225, _w2#7226, _w3#7227, rank_within_parent#7190, rank_within_parent#7190]
            +- Window [rank(_w3#7227) windowspecdefinition(_w1#7225, _w2#7226, _w3#7227 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#7190], [_w1#7225, _w2#7226], [_w3#7227 DESC NULLS LAST]
               +- Aggregate [s_state#7211, s_county#7212, spark_grouping_id#7208], [sum(ss_net_profit#152) AS total_sum#7188, s_state#7211, s_county#7212, (cast((shiftright(spark_grouping_id#7208, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#7208, 0) & 1) as tinyint)) AS lochierarchy#7189, sum(ss_net_profit#152) AS _w0#7221, (cast((shiftright(spark_grouping_id#7208, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#7208, 0) & 1) as tinyint)) AS _w1#7225, CASE WHEN (cast(cast((shiftright(spark_grouping_id#7208, 0) & 1) as tinyint) as int) = 0) THEN s_state#7211 END AS _w2#7226, sum(ss_net_profit#152) AS _w3#7227]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#7209, s_county#7210, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#7209, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#7193 [])))
                           :  +- Project [s_state#7191]
                           :     +- Filter (ranking#7192 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#7191, ranking#7192]
                           :              +- Project [s_state#7191, s_state#688, _w1#7199, ranking#7192, ranking#7192]
                           :                 +- Window [rank(_w1#7199) windowspecdefinition(s_state#688, _w1#7199 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#7192], [s_state#688], [_w1#7199 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#7191, s_state#688, sum(ss_net_profit#152) AS _w1#7199]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
20/01/08 19:21:18 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#7243 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#7243 as int) = 0) THEN s_state#7265 END ASC NULLS FIRST, rank_within_parent#7244 ASC NULLS FIRST], true
      +- Project [total_sum#7242, s_state#7265, s_county#7266, lochierarchy#7243, rank_within_parent#7244]
         +- Project [total_sum#7242, s_state#7265, s_county#7266, lochierarchy#7243, _w0#7275, _w1#7279, _w2#7280, _w3#7281, rank_within_parent#7244, rank_within_parent#7244]
            +- Window [rank(_w3#7281) windowspecdefinition(_w1#7279, _w2#7280, _w3#7281 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#7244], [_w1#7279, _w2#7280], [_w3#7281 DESC NULLS LAST]
               +- Aggregate [s_state#7265, s_county#7266, spark_grouping_id#7262], [sum(ss_net_profit#152) AS total_sum#7242, s_state#7265, s_county#7266, (cast((shiftright(spark_grouping_id#7262, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#7262, 0) & 1) as tinyint)) AS lochierarchy#7243, sum(ss_net_profit#152) AS _w0#7275, (cast((shiftright(spark_grouping_id#7262, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#7262, 0) & 1) as tinyint)) AS _w1#7279, CASE WHEN (cast(cast((shiftright(spark_grouping_id#7262, 0) & 1) as tinyint) as int) = 0) THEN s_state#7265 END AS _w2#7280, sum(ss_net_profit#152) AS _w3#7281]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#7263, s_county#7264, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#7263, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#7247 [])))
                           :  +- Project [s_state#7245]
                           :     +- Filter (ranking#7246 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#7245, ranking#7246]
                           :              +- Project [s_state#7245, s_state#688, _w1#7253, ranking#7246, ranking#7246]
                           :                 +- Window [rank(_w1#7253) windowspecdefinition(s_state#688, _w1#7253 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#7246], [s_state#688], [_w1#7253 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#7245, s_state#688, sum(ss_net_profit#152) AS _w1#7253]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 79.606993823s
Running execution q82-v2.4 iteration: 6, StandardRun=true
20/01/08 19:22:39 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
20/01/08 19:22:39 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 85.49589838600001s
Running execution q64-v2.4 iteration: 7, StandardRun=true
20/01/08 19:24:14 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#7580 ASC NULLS FIRST, store_name#7582 ASC NULLS FIRST, cnt#7717L ASC NULLS FIRST], true
+- Project [product_name#7580, store_name#7582, store_zip#7583, b_street_number#7584, b_streen_name#7585, b_city#7586, b_zip#7587, c_street_number#7588, c_street_name#7589, c_city#7590, c_zip#7591, syear#7592, cnt#7595L, s1#7596, s2#7597, s3#7598, s1#7718, s2#7719, s3#7720, syear#7714, cnt#7717L]
   +- Filter ((((item_sk#7581 = item_sk#7703) && (syear#7592 = 1999)) && (syear#7714 = (1999 + 1))) && (((cnt#7717L <= cnt#7595L) && (store_name#7582 = store_name#7704)) && (store_zip#7583 = store_zip#7705)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#7680, ca_street_name#7681, ca_city#7684, ca_zip#7687, d_year#498, d_year#7614, d_year#7642], [i_product_name#585 AS product_name#7580, i_item_sk#564 AS item_sk#7581, s_store_name#669 AS store_name#7582, s_zip#689 AS store_zip#7583, ca_street_number#450 AS b_street_number#7584, ca_street_name#451 AS b_streen_name#7585, ca_city#454 AS b_city#7586, ca_zip#457 AS b_zip#7587, ca_street_number#7680 AS c_street_number#7588, ca_street_name#7681 AS c_street_name#7589, ca_city#7684 AS c_city#7590, ca_zip#7687 AS c_zip#7591, d_year#498 AS syear#7592, d_year#7614 AS fsyear#7593, d_year#7642 AS s2year#7594, count(1) AS cnt#7595L, sum(ss_wholesale_cost#141) AS s1#7596, sum(ss_list_price#142) AS s2#7597, sum(ss_coupon_amt#149) AS s3#7598]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#7664)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#7673) && (c_current_addr_sk#416 = ca_address_sk#7678)) && (c_first_sales_date_sk#418 = d_date_sk#7608)) && (((c_first_shipto_date_sk#417 = d_date_sk#7636) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#7674 = ib_income_band_sk#7691) && NOT (cd_marital_status#476 = cd_marital_status#7666)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#7578, refund#7579]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#7604 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#7605 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#7578, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#7579, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#7604, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#7605]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#7608,d_date_id#7609,d_date#7610,d_month_seq#7611,d_week_seq#7612,d_quarter_seq#7613,d_year#7614,d_dow#7615,d_moy#7616,d_dom#7617,d_qoy#7618,d_fy_year#7619,d_fy_quarter_seq#7620,d_fy_week_seq#7621,d_day_name#7622,d_quarter_name#7623,d_holiday#7624,d_weekend#7625,d_following_holiday#7626,d_first_dom#7627,d_last_dom#7628,d_same_day_ly#7629,d_same_day_lq#7630,d_current_day#7631,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#7636,d_date_id#7637,d_date#7638,d_month_seq#7639,d_week_seq#7640,d_quarter_seq#7641,d_year#7642,d_dow#7643,d_moy#7644,d_dom#7645,d_qoy#7646,d_fy_year#7647,d_fy_quarter_seq#7648,d_fy_week_seq#7649,d_day_name#7650,d_quarter_name#7651,d_holiday#7652,d_weekend#7653,d_following_holiday#7654,d_first_dom#7655,d_last_dom#7656,d_same_day_ly#7657,d_same_day_lq#7658,d_current_day#7659,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#7664,cd_gender#7665,cd_marital_status#7666,cd_education_status#7667,cd_purchase_estimate#7668,cd_credit_rating#7669,cd_dep_count#7670,cd_dep_employed_count#7671,cd_dep_college_count#7672] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#7673,hd_income_band_sk#7674,hd_buy_potential#7675,hd_dep_count#7676,hd_vehicle_count#7677] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#7678,ca_address_id#7679,ca_street_number#7680,ca_street_name#7681,ca_street_type#7682,ca_suite_number#7683,ca_city#7684,ca_county#7685,ca_state#7686,ca_zip#7687,ca_country#7688,ca_gmt_offset#7689,ca_location_type#7690] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#7691,ib_lower_bound#7692,ib_upper_bound#7693] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#7680, ca_street_name#7681, ca_city#7684, ca_zip#7687, d_year#498, d_year#7614, d_year#7642], [i_product_name#585 AS product_name#7702, i_item_sk#564 AS item_sk#7703, s_store_name#669 AS store_name#7704, s_zip#689 AS store_zip#7705, ca_street_number#450 AS b_street_number#7706, ca_street_name#451 AS b_streen_name#7707, ca_city#454 AS b_city#7708, ca_zip#457 AS b_zip#7709, ca_street_number#7680 AS c_street_number#7710, ca_street_name#7681 AS c_street_name#7711, ca_city#7684 AS c_city#7712, ca_zip#7687 AS c_zip#7713, d_year#498 AS syear#7714, d_year#7614 AS fsyear#7715, d_year#7642 AS s2year#7716, count(1) AS cnt#7717L, sum(ss_wholesale_cost#141) AS s1#7718, sum(ss_list_price#142) AS s2#7719, sum(ss_coupon_amt#149) AS s3#7720]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#7664)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#7673) && (c_current_addr_sk#416 = ca_address_sk#7678)) && (c_first_sales_date_sk#418 = d_date_sk#7608)) && (((c_first_shipto_date_sk#417 = d_date_sk#7636) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#7674 = ib_income_band_sk#7691) && NOT (cd_marital_status#476 = cd_marital_status#7666)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#7578, refund#7579]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#7604 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#7605 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#7578, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#7579, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#7604, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#7605]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#7608,d_date_id#7609,d_date#7610,d_month_seq#7611,d_week_seq#7612,d_quarter_seq#7613,d_year#7614,d_dow#7615,d_moy#7616,d_dom#7617,d_qoy#7618,d_fy_year#7619,d_fy_quarter_seq#7620,d_fy_week_seq#7621,d_day_name#7622,d_quarter_name#7623,d_holiday#7624,d_weekend#7625,d_following_holiday#7626,d_first_dom#7627,d_last_dom#7628,d_same_day_ly#7629,d_same_day_lq#7630,d_current_day#7631,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#7636,d_date_id#7637,d_date#7638,d_month_seq#7639,d_week_seq#7640,d_quarter_seq#7641,d_year#7642,d_dow#7643,d_moy#7644,d_dom#7645,d_qoy#7646,d_fy_year#7647,d_fy_quarter_seq#7648,d_fy_week_seq#7649,d_day_name#7650,d_quarter_name#7651,d_holiday#7652,d_weekend#7653,d_following_holiday#7654,d_first_dom#7655,d_last_dom#7656,d_same_day_ly#7657,d_same_day_lq#7658,d_current_day#7659,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#7664,cd_gender#7665,cd_marital_status#7666,cd_education_status#7667,cd_purchase_estimate#7668,cd_credit_rating#7669,cd_dep_count#7670,cd_dep_employed_count#7671,cd_dep_college_count#7672] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#7673,hd_income_band_sk#7674,hd_buy_potential#7675,hd_dep_count#7676,hd_vehicle_count#7677] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#7678,ca_address_id#7679,ca_street_number#7680,ca_street_name#7681,ca_street_type#7682,ca_suite_number#7683,ca_city#7684,ca_county#7685,ca_state#7686,ca_zip#7687,ca_country#7688,ca_gmt_offset#7689,ca_location_type#7690] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#7691,ib_lower_bound#7692,ib_upper_bound#7693] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
20/01/08 19:24:15 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#7748 ASC NULLS FIRST, store_name#7750 ASC NULLS FIRST, cnt#7885L ASC NULLS FIRST], true
+- Project [product_name#7748, store_name#7750, store_zip#7751, b_street_number#7752, b_streen_name#7753, b_city#7754, b_zip#7755, c_street_number#7756, c_street_name#7757, c_city#7758, c_zip#7759, syear#7760, cnt#7763L, s1#7764, s2#7765, s3#7766, s1#7886, s2#7887, s3#7888, syear#7882, cnt#7885L]
   +- Filter ((((item_sk#7749 = item_sk#7871) && (syear#7760 = 1999)) && (syear#7882 = (1999 + 1))) && (((cnt#7885L <= cnt#7763L) && (store_name#7750 = store_name#7872)) && (store_zip#7751 = store_zip#7873)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#7848, ca_street_name#7849, ca_city#7852, ca_zip#7855, d_year#498, d_year#7782, d_year#7810], [i_product_name#585 AS product_name#7748, i_item_sk#564 AS item_sk#7749, s_store_name#669 AS store_name#7750, s_zip#689 AS store_zip#7751, ca_street_number#450 AS b_street_number#7752, ca_street_name#451 AS b_streen_name#7753, ca_city#454 AS b_city#7754, ca_zip#457 AS b_zip#7755, ca_street_number#7848 AS c_street_number#7756, ca_street_name#7849 AS c_street_name#7757, ca_city#7852 AS c_city#7758, ca_zip#7855 AS c_zip#7759, d_year#498 AS syear#7760, d_year#7782 AS fsyear#7761, d_year#7810 AS s2year#7762, count(1) AS cnt#7763L, sum(ss_wholesale_cost#141) AS s1#7764, sum(ss_list_price#142) AS s2#7765, sum(ss_coupon_amt#149) AS s3#7766]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#7832)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#7841) && (c_current_addr_sk#416 = ca_address_sk#7846)) && (c_first_sales_date_sk#418 = d_date_sk#7776)) && (((c_first_shipto_date_sk#417 = d_date_sk#7804) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#7842 = ib_income_band_sk#7859) && NOT (cd_marital_status#476 = cd_marital_status#7834)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#7746, refund#7747]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#7772 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#7773 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#7746, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#7747, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#7772, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#7773]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#7776,d_date_id#7777,d_date#7778,d_month_seq#7779,d_week_seq#7780,d_quarter_seq#7781,d_year#7782,d_dow#7783,d_moy#7784,d_dom#7785,d_qoy#7786,d_fy_year#7787,d_fy_quarter_seq#7788,d_fy_week_seq#7789,d_day_name#7790,d_quarter_name#7791,d_holiday#7792,d_weekend#7793,d_following_holiday#7794,d_first_dom#7795,d_last_dom#7796,d_same_day_ly#7797,d_same_day_lq#7798,d_current_day#7799,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#7804,d_date_id#7805,d_date#7806,d_month_seq#7807,d_week_seq#7808,d_quarter_seq#7809,d_year#7810,d_dow#7811,d_moy#7812,d_dom#7813,d_qoy#7814,d_fy_year#7815,d_fy_quarter_seq#7816,d_fy_week_seq#7817,d_day_name#7818,d_quarter_name#7819,d_holiday#7820,d_weekend#7821,d_following_holiday#7822,d_first_dom#7823,d_last_dom#7824,d_same_day_ly#7825,d_same_day_lq#7826,d_current_day#7827,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#7832,cd_gender#7833,cd_marital_status#7834,cd_education_status#7835,cd_purchase_estimate#7836,cd_credit_rating#7837,cd_dep_count#7838,cd_dep_employed_count#7839,cd_dep_college_count#7840] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#7841,hd_income_band_sk#7842,hd_buy_potential#7843,hd_dep_count#7844,hd_vehicle_count#7845] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#7846,ca_address_id#7847,ca_street_number#7848,ca_street_name#7849,ca_street_type#7850,ca_suite_number#7851,ca_city#7852,ca_county#7853,ca_state#7854,ca_zip#7855,ca_country#7856,ca_gmt_offset#7857,ca_location_type#7858] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#7859,ib_lower_bound#7860,ib_upper_bound#7861] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#7848, ca_street_name#7849, ca_city#7852, ca_zip#7855, d_year#498, d_year#7782, d_year#7810], [i_product_name#585 AS product_name#7870, i_item_sk#564 AS item_sk#7871, s_store_name#669 AS store_name#7872, s_zip#689 AS store_zip#7873, ca_street_number#450 AS b_street_number#7874, ca_street_name#451 AS b_streen_name#7875, ca_city#454 AS b_city#7876, ca_zip#457 AS b_zip#7877, ca_street_number#7848 AS c_street_number#7878, ca_street_name#7849 AS c_street_name#7879, ca_city#7852 AS c_city#7880, ca_zip#7855 AS c_zip#7881, d_year#498 AS syear#7882, d_year#7782 AS fsyear#7883, d_year#7810 AS s2year#7884, count(1) AS cnt#7885L, sum(ss_wholesale_cost#141) AS s1#7886, sum(ss_list_price#142) AS s2#7887, sum(ss_coupon_amt#149) AS s3#7888]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#7832)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#7841) && (c_current_addr_sk#416 = ca_address_sk#7846)) && (c_first_sales_date_sk#418 = d_date_sk#7776)) && (((c_first_shipto_date_sk#417 = d_date_sk#7804) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#7842 = ib_income_band_sk#7859) && NOT (cd_marital_status#476 = cd_marital_status#7834)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#7746, refund#7747]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#7772 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#7773 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#7746, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#7747, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#7772, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#7773]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#7776,d_date_id#7777,d_date#7778,d_month_seq#7779,d_week_seq#7780,d_quarter_seq#7781,d_year#7782,d_dow#7783,d_moy#7784,d_dom#7785,d_qoy#7786,d_fy_year#7787,d_fy_quarter_seq#7788,d_fy_week_seq#7789,d_day_name#7790,d_quarter_name#7791,d_holiday#7792,d_weekend#7793,d_following_holiday#7794,d_first_dom#7795,d_last_dom#7796,d_same_day_ly#7797,d_same_day_lq#7798,d_current_day#7799,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#7804,d_date_id#7805,d_date#7806,d_month_seq#7807,d_week_seq#7808,d_quarter_seq#7809,d_year#7810,d_dow#7811,d_moy#7812,d_dom#7813,d_qoy#7814,d_fy_year#7815,d_fy_quarter_seq#7816,d_fy_week_seq#7817,d_day_name#7818,d_quarter_name#7819,d_holiday#7820,d_weekend#7821,d_following_holiday#7822,d_first_dom#7823,d_last_dom#7824,d_same_day_ly#7825,d_same_day_lq#7826,d_current_day#7827,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#7832,cd_gender#7833,cd_marital_status#7834,cd_education_status#7835,cd_purchase_estimate#7836,cd_credit_rating#7837,cd_dep_count#7838,cd_dep_employed_count#7839,cd_dep_college_count#7840] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#7841,hd_income_band_sk#7842,hd_buy_potential#7843,hd_dep_count#7844,hd_vehicle_count#7845] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#7846,ca_address_id#7847,ca_street_number#7848,ca_street_name#7849,ca_street_type#7850,ca_suite_number#7851,ca_city#7852,ca_county#7853,ca_state#7854,ca_zip#7855,ca_country#7856,ca_gmt_offset#7857,ca_location_type#7858] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#7859,ib_lower_bound#7860,ib_upper_bound#7861] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 820.798298335s
Running execution q70-v2.4 iteration: 7, StandardRun=true
20/01/08 19:38:06 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#8184 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#8184 as int) = 0) THEN s_state#8206 END ASC NULLS FIRST, rank_within_parent#8185 ASC NULLS FIRST], true
      +- Project [total_sum#8183, s_state#8206, s_county#8207, lochierarchy#8184, rank_within_parent#8185]
         +- Project [total_sum#8183, s_state#8206, s_county#8207, lochierarchy#8184, _w0#8216, _w1#8220, _w2#8221, _w3#8222, rank_within_parent#8185, rank_within_parent#8185]
            +- Window [rank(_w3#8222) windowspecdefinition(_w1#8220, _w2#8221, _w3#8222 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#8185], [_w1#8220, _w2#8221], [_w3#8222 DESC NULLS LAST]
               +- Aggregate [s_state#8206, s_county#8207, spark_grouping_id#8203], [sum(ss_net_profit#152) AS total_sum#8183, s_state#8206, s_county#8207, (cast((shiftright(spark_grouping_id#8203, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#8203, 0) & 1) as tinyint)) AS lochierarchy#8184, sum(ss_net_profit#152) AS _w0#8216, (cast((shiftright(spark_grouping_id#8203, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#8203, 0) & 1) as tinyint)) AS _w1#8220, CASE WHEN (cast(cast((shiftright(spark_grouping_id#8203, 0) & 1) as tinyint) as int) = 0) THEN s_state#8206 END AS _w2#8221, sum(ss_net_profit#152) AS _w3#8222]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#8204, s_county#8205, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#8204, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#8188 [])))
                           :  +- Project [s_state#8186]
                           :     +- Filter (ranking#8187 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#8186, ranking#8187]
                           :              +- Project [s_state#8186, s_state#688, _w1#8194, ranking#8187, ranking#8187]
                           :                 +- Window [rank(_w1#8194) windowspecdefinition(s_state#688, _w1#8194 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#8187], [s_state#688], [_w1#8194 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#8186, s_state#688, sum(ss_net_profit#152) AS _w1#8194]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
20/01/08 19:38:06 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#8238 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#8238 as int) = 0) THEN s_state#8260 END ASC NULLS FIRST, rank_within_parent#8239 ASC NULLS FIRST], true
      +- Project [total_sum#8237, s_state#8260, s_county#8261, lochierarchy#8238, rank_within_parent#8239]
         +- Project [total_sum#8237, s_state#8260, s_county#8261, lochierarchy#8238, _w0#8270, _w1#8274, _w2#8275, _w3#8276, rank_within_parent#8239, rank_within_parent#8239]
            +- Window [rank(_w3#8276) windowspecdefinition(_w1#8274, _w2#8275, _w3#8276 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#8239], [_w1#8274, _w2#8275], [_w3#8276 DESC NULLS LAST]
               +- Aggregate [s_state#8260, s_county#8261, spark_grouping_id#8257], [sum(ss_net_profit#152) AS total_sum#8237, s_state#8260, s_county#8261, (cast((shiftright(spark_grouping_id#8257, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#8257, 0) & 1) as tinyint)) AS lochierarchy#8238, sum(ss_net_profit#152) AS _w0#8270, (cast((shiftright(spark_grouping_id#8257, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#8257, 0) & 1) as tinyint)) AS _w1#8274, CASE WHEN (cast(cast((shiftright(spark_grouping_id#8257, 0) & 1) as tinyint) as int) = 0) THEN s_state#8260 END AS _w2#8275, sum(ss_net_profit#152) AS _w3#8276]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#8258, s_county#8259, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#8258, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#8242 [])))
                           :  +- Project [s_state#8240]
                           :     +- Filter (ranking#8241 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#8240, ranking#8241]
                           :              +- Project [s_state#8240, s_state#688, _w1#8248, ranking#8241, ranking#8241]
                           :                 +- Window [rank(_w1#8248) windowspecdefinition(s_state#688, _w1#8248 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#8241], [s_state#688], [_w1#8248 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#8240, s_state#688, sum(ss_net_profit#152) AS _w1#8248]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 76.962398978s
Running execution q82-v2.4 iteration: 7, StandardRun=true
20/01/08 19:39:24 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
20/01/08 19:39:24 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 80.862132585s
Running execution q64-v2.4 iteration: 8, StandardRun=true
20/01/08 19:40:54 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#8575 ASC NULLS FIRST, store_name#8577 ASC NULLS FIRST, cnt#8712L ASC NULLS FIRST], true
+- Project [product_name#8575, store_name#8577, store_zip#8578, b_street_number#8579, b_streen_name#8580, b_city#8581, b_zip#8582, c_street_number#8583, c_street_name#8584, c_city#8585, c_zip#8586, syear#8587, cnt#8590L, s1#8591, s2#8592, s3#8593, s1#8713, s2#8714, s3#8715, syear#8709, cnt#8712L]
   +- Filter ((((item_sk#8576 = item_sk#8698) && (syear#8587 = 1999)) && (syear#8709 = (1999 + 1))) && (((cnt#8712L <= cnt#8590L) && (store_name#8577 = store_name#8699)) && (store_zip#8578 = store_zip#8700)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#8675, ca_street_name#8676, ca_city#8679, ca_zip#8682, d_year#498, d_year#8609, d_year#8637], [i_product_name#585 AS product_name#8575, i_item_sk#564 AS item_sk#8576, s_store_name#669 AS store_name#8577, s_zip#689 AS store_zip#8578, ca_street_number#450 AS b_street_number#8579, ca_street_name#451 AS b_streen_name#8580, ca_city#454 AS b_city#8581, ca_zip#457 AS b_zip#8582, ca_street_number#8675 AS c_street_number#8583, ca_street_name#8676 AS c_street_name#8584, ca_city#8679 AS c_city#8585, ca_zip#8682 AS c_zip#8586, d_year#498 AS syear#8587, d_year#8609 AS fsyear#8588, d_year#8637 AS s2year#8589, count(1) AS cnt#8590L, sum(ss_wholesale_cost#141) AS s1#8591, sum(ss_list_price#142) AS s2#8592, sum(ss_coupon_amt#149) AS s3#8593]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#8659)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#8668) && (c_current_addr_sk#416 = ca_address_sk#8673)) && (c_first_sales_date_sk#418 = d_date_sk#8603)) && (((c_first_shipto_date_sk#417 = d_date_sk#8631) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#8669 = ib_income_band_sk#8686) && NOT (cd_marital_status#476 = cd_marital_status#8661)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#8573, refund#8574]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#8599 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#8600 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#8573, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#8574, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#8599, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#8600]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#8603,d_date_id#8604,d_date#8605,d_month_seq#8606,d_week_seq#8607,d_quarter_seq#8608,d_year#8609,d_dow#8610,d_moy#8611,d_dom#8612,d_qoy#8613,d_fy_year#8614,d_fy_quarter_seq#8615,d_fy_week_seq#8616,d_day_name#8617,d_quarter_name#8618,d_holiday#8619,d_weekend#8620,d_following_holiday#8621,d_first_dom#8622,d_last_dom#8623,d_same_day_ly#8624,d_same_day_lq#8625,d_current_day#8626,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#8631,d_date_id#8632,d_date#8633,d_month_seq#8634,d_week_seq#8635,d_quarter_seq#8636,d_year#8637,d_dow#8638,d_moy#8639,d_dom#8640,d_qoy#8641,d_fy_year#8642,d_fy_quarter_seq#8643,d_fy_week_seq#8644,d_day_name#8645,d_quarter_name#8646,d_holiday#8647,d_weekend#8648,d_following_holiday#8649,d_first_dom#8650,d_last_dom#8651,d_same_day_ly#8652,d_same_day_lq#8653,d_current_day#8654,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#8659,cd_gender#8660,cd_marital_status#8661,cd_education_status#8662,cd_purchase_estimate#8663,cd_credit_rating#8664,cd_dep_count#8665,cd_dep_employed_count#8666,cd_dep_college_count#8667] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#8668,hd_income_band_sk#8669,hd_buy_potential#8670,hd_dep_count#8671,hd_vehicle_count#8672] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#8673,ca_address_id#8674,ca_street_number#8675,ca_street_name#8676,ca_street_type#8677,ca_suite_number#8678,ca_city#8679,ca_county#8680,ca_state#8681,ca_zip#8682,ca_country#8683,ca_gmt_offset#8684,ca_location_type#8685] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#8686,ib_lower_bound#8687,ib_upper_bound#8688] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#8675, ca_street_name#8676, ca_city#8679, ca_zip#8682, d_year#498, d_year#8609, d_year#8637], [i_product_name#585 AS product_name#8697, i_item_sk#564 AS item_sk#8698, s_store_name#669 AS store_name#8699, s_zip#689 AS store_zip#8700, ca_street_number#450 AS b_street_number#8701, ca_street_name#451 AS b_streen_name#8702, ca_city#454 AS b_city#8703, ca_zip#457 AS b_zip#8704, ca_street_number#8675 AS c_street_number#8705, ca_street_name#8676 AS c_street_name#8706, ca_city#8679 AS c_city#8707, ca_zip#8682 AS c_zip#8708, d_year#498 AS syear#8709, d_year#8609 AS fsyear#8710, d_year#8637 AS s2year#8711, count(1) AS cnt#8712L, sum(ss_wholesale_cost#141) AS s1#8713, sum(ss_list_price#142) AS s2#8714, sum(ss_coupon_amt#149) AS s3#8715]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#8659)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#8668) && (c_current_addr_sk#416 = ca_address_sk#8673)) && (c_first_sales_date_sk#418 = d_date_sk#8603)) && (((c_first_shipto_date_sk#417 = d_date_sk#8631) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#8669 = ib_income_band_sk#8686) && NOT (cd_marital_status#476 = cd_marital_status#8661)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#8573, refund#8574]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#8599 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#8600 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#8573, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#8574, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#8599, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#8600]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#8603,d_date_id#8604,d_date#8605,d_month_seq#8606,d_week_seq#8607,d_quarter_seq#8608,d_year#8609,d_dow#8610,d_moy#8611,d_dom#8612,d_qoy#8613,d_fy_year#8614,d_fy_quarter_seq#8615,d_fy_week_seq#8616,d_day_name#8617,d_quarter_name#8618,d_holiday#8619,d_weekend#8620,d_following_holiday#8621,d_first_dom#8622,d_last_dom#8623,d_same_day_ly#8624,d_same_day_lq#8625,d_current_day#8626,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#8631,d_date_id#8632,d_date#8633,d_month_seq#8634,d_week_seq#8635,d_quarter_seq#8636,d_year#8637,d_dow#8638,d_moy#8639,d_dom#8640,d_qoy#8641,d_fy_year#8642,d_fy_quarter_seq#8643,d_fy_week_seq#8644,d_day_name#8645,d_quarter_name#8646,d_holiday#8647,d_weekend#8648,d_following_holiday#8649,d_first_dom#8650,d_last_dom#8651,d_same_day_ly#8652,d_same_day_lq#8653,d_current_day#8654,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#8659,cd_gender#8660,cd_marital_status#8661,cd_education_status#8662,cd_purchase_estimate#8663,cd_credit_rating#8664,cd_dep_count#8665,cd_dep_employed_count#8666,cd_dep_college_count#8667] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#8668,hd_income_band_sk#8669,hd_buy_potential#8670,hd_dep_count#8671,hd_vehicle_count#8672] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#8673,ca_address_id#8674,ca_street_number#8675,ca_street_name#8676,ca_street_type#8677,ca_suite_number#8678,ca_city#8679,ca_county#8680,ca_state#8681,ca_zip#8682,ca_country#8683,ca_gmt_offset#8684,ca_location_type#8685] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#8686,ib_lower_bound#8687,ib_upper_bound#8688] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
20/01/08 19:40:55 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#8743 ASC NULLS FIRST, store_name#8745 ASC NULLS FIRST, cnt#8880L ASC NULLS FIRST], true
+- Project [product_name#8743, store_name#8745, store_zip#8746, b_street_number#8747, b_streen_name#8748, b_city#8749, b_zip#8750, c_street_number#8751, c_street_name#8752, c_city#8753, c_zip#8754, syear#8755, cnt#8758L, s1#8759, s2#8760, s3#8761, s1#8881, s2#8882, s3#8883, syear#8877, cnt#8880L]
   +- Filter ((((item_sk#8744 = item_sk#8866) && (syear#8755 = 1999)) && (syear#8877 = (1999 + 1))) && (((cnt#8880L <= cnt#8758L) && (store_name#8745 = store_name#8867)) && (store_zip#8746 = store_zip#8868)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#8843, ca_street_name#8844, ca_city#8847, ca_zip#8850, d_year#498, d_year#8777, d_year#8805], [i_product_name#585 AS product_name#8743, i_item_sk#564 AS item_sk#8744, s_store_name#669 AS store_name#8745, s_zip#689 AS store_zip#8746, ca_street_number#450 AS b_street_number#8747, ca_street_name#451 AS b_streen_name#8748, ca_city#454 AS b_city#8749, ca_zip#457 AS b_zip#8750, ca_street_number#8843 AS c_street_number#8751, ca_street_name#8844 AS c_street_name#8752, ca_city#8847 AS c_city#8753, ca_zip#8850 AS c_zip#8754, d_year#498 AS syear#8755, d_year#8777 AS fsyear#8756, d_year#8805 AS s2year#8757, count(1) AS cnt#8758L, sum(ss_wholesale_cost#141) AS s1#8759, sum(ss_list_price#142) AS s2#8760, sum(ss_coupon_amt#149) AS s3#8761]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#8827)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#8836) && (c_current_addr_sk#416 = ca_address_sk#8841)) && (c_first_sales_date_sk#418 = d_date_sk#8771)) && (((c_first_shipto_date_sk#417 = d_date_sk#8799) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#8837 = ib_income_band_sk#8854) && NOT (cd_marital_status#476 = cd_marital_status#8829)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#8741, refund#8742]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#8767 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#8768 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#8741, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#8742, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#8767, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#8768]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#8771,d_date_id#8772,d_date#8773,d_month_seq#8774,d_week_seq#8775,d_quarter_seq#8776,d_year#8777,d_dow#8778,d_moy#8779,d_dom#8780,d_qoy#8781,d_fy_year#8782,d_fy_quarter_seq#8783,d_fy_week_seq#8784,d_day_name#8785,d_quarter_name#8786,d_holiday#8787,d_weekend#8788,d_following_holiday#8789,d_first_dom#8790,d_last_dom#8791,d_same_day_ly#8792,d_same_day_lq#8793,d_current_day#8794,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#8799,d_date_id#8800,d_date#8801,d_month_seq#8802,d_week_seq#8803,d_quarter_seq#8804,d_year#8805,d_dow#8806,d_moy#8807,d_dom#8808,d_qoy#8809,d_fy_year#8810,d_fy_quarter_seq#8811,d_fy_week_seq#8812,d_day_name#8813,d_quarter_name#8814,d_holiday#8815,d_weekend#8816,d_following_holiday#8817,d_first_dom#8818,d_last_dom#8819,d_same_day_ly#8820,d_same_day_lq#8821,d_current_day#8822,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#8827,cd_gender#8828,cd_marital_status#8829,cd_education_status#8830,cd_purchase_estimate#8831,cd_credit_rating#8832,cd_dep_count#8833,cd_dep_employed_count#8834,cd_dep_college_count#8835] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#8836,hd_income_band_sk#8837,hd_buy_potential#8838,hd_dep_count#8839,hd_vehicle_count#8840] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#8841,ca_address_id#8842,ca_street_number#8843,ca_street_name#8844,ca_street_type#8845,ca_suite_number#8846,ca_city#8847,ca_county#8848,ca_state#8849,ca_zip#8850,ca_country#8851,ca_gmt_offset#8852,ca_location_type#8853] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#8854,ib_lower_bound#8855,ib_upper_bound#8856] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#8843, ca_street_name#8844, ca_city#8847, ca_zip#8850, d_year#498, d_year#8777, d_year#8805], [i_product_name#585 AS product_name#8865, i_item_sk#564 AS item_sk#8866, s_store_name#669 AS store_name#8867, s_zip#689 AS store_zip#8868, ca_street_number#450 AS b_street_number#8869, ca_street_name#451 AS b_streen_name#8870, ca_city#454 AS b_city#8871, ca_zip#457 AS b_zip#8872, ca_street_number#8843 AS c_street_number#8873, ca_street_name#8844 AS c_street_name#8874, ca_city#8847 AS c_city#8875, ca_zip#8850 AS c_zip#8876, d_year#498 AS syear#8877, d_year#8777 AS fsyear#8878, d_year#8805 AS s2year#8879, count(1) AS cnt#8880L, sum(ss_wholesale_cost#141) AS s1#8881, sum(ss_list_price#142) AS s2#8882, sum(ss_coupon_amt#149) AS s3#8883]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#8827)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#8836) && (c_current_addr_sk#416 = ca_address_sk#8841)) && (c_first_sales_date_sk#418 = d_date_sk#8771)) && (((c_first_shipto_date_sk#417 = d_date_sk#8799) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#8837 = ib_income_band_sk#8854) && NOT (cd_marital_status#476 = cd_marital_status#8829)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#8741, refund#8742]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#8767 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#8768 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#8741, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#8742, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#8767, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#8768]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#8771,d_date_id#8772,d_date#8773,d_month_seq#8774,d_week_seq#8775,d_quarter_seq#8776,d_year#8777,d_dow#8778,d_moy#8779,d_dom#8780,d_qoy#8781,d_fy_year#8782,d_fy_quarter_seq#8783,d_fy_week_seq#8784,d_day_name#8785,d_quarter_name#8786,d_holiday#8787,d_weekend#8788,d_following_holiday#8789,d_first_dom#8790,d_last_dom#8791,d_same_day_ly#8792,d_same_day_lq#8793,d_current_day#8794,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#8799,d_date_id#8800,d_date#8801,d_month_seq#8802,d_week_seq#8803,d_quarter_seq#8804,d_year#8805,d_dow#8806,d_moy#8807,d_dom#8808,d_qoy#8809,d_fy_year#8810,d_fy_quarter_seq#8811,d_fy_week_seq#8812,d_day_name#8813,d_quarter_name#8814,d_holiday#8815,d_weekend#8816,d_following_holiday#8817,d_first_dom#8818,d_last_dom#8819,d_same_day_ly#8820,d_same_day_lq#8821,d_current_day#8822,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#8827,cd_gender#8828,cd_marital_status#8829,cd_education_status#8830,cd_purchase_estimate#8831,cd_credit_rating#8832,cd_dep_count#8833,cd_dep_employed_count#8834,cd_dep_college_count#8835] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#8836,hd_income_band_sk#8837,hd_buy_potential#8838,hd_dep_count#8839,hd_vehicle_count#8840] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#8841,ca_address_id#8842,ca_street_number#8843,ca_street_name#8844,ca_street_type#8845,ca_suite_number#8846,ca_city#8847,ca_county#8848,ca_state#8849,ca_zip#8850,ca_country#8851,ca_gmt_offset#8852,ca_location_type#8853] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#8854,ib_lower_bound#8855,ib_upper_bound#8856] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 997.2728981409999s
Running execution q70-v2.4 iteration: 8, StandardRun=true
20/01/08 19:57:42 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#9179 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#9179 as int) = 0) THEN s_state#9201 END ASC NULLS FIRST, rank_within_parent#9180 ASC NULLS FIRST], true
      +- Project [total_sum#9178, s_state#9201, s_county#9202, lochierarchy#9179, rank_within_parent#9180]
         +- Project [total_sum#9178, s_state#9201, s_county#9202, lochierarchy#9179, _w0#9211, _w1#9215, _w2#9216, _w3#9217, rank_within_parent#9180, rank_within_parent#9180]
            +- Window [rank(_w3#9217) windowspecdefinition(_w1#9215, _w2#9216, _w3#9217 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#9180], [_w1#9215, _w2#9216], [_w3#9217 DESC NULLS LAST]
               +- Aggregate [s_state#9201, s_county#9202, spark_grouping_id#9198], [sum(ss_net_profit#152) AS total_sum#9178, s_state#9201, s_county#9202, (cast((shiftright(spark_grouping_id#9198, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#9198, 0) & 1) as tinyint)) AS lochierarchy#9179, sum(ss_net_profit#152) AS _w0#9211, (cast((shiftright(spark_grouping_id#9198, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#9198, 0) & 1) as tinyint)) AS _w1#9215, CASE WHEN (cast(cast((shiftright(spark_grouping_id#9198, 0) & 1) as tinyint) as int) = 0) THEN s_state#9201 END AS _w2#9216, sum(ss_net_profit#152) AS _w3#9217]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#9199, s_county#9200, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#9199, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#9183 [])))
                           :  +- Project [s_state#9181]
                           :     +- Filter (ranking#9182 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#9181, ranking#9182]
                           :              +- Project [s_state#9181, s_state#688, _w1#9189, ranking#9182, ranking#9182]
                           :                 +- Window [rank(_w1#9189) windowspecdefinition(s_state#688, _w1#9189 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#9182], [s_state#688], [_w1#9189 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#9181, s_state#688, sum(ss_net_profit#152) AS _w1#9189]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
20/01/08 19:57:42 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#9233 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#9233 as int) = 0) THEN s_state#9255 END ASC NULLS FIRST, rank_within_parent#9234 ASC NULLS FIRST], true
      +- Project [total_sum#9232, s_state#9255, s_county#9256, lochierarchy#9233, rank_within_parent#9234]
         +- Project [total_sum#9232, s_state#9255, s_county#9256, lochierarchy#9233, _w0#9265, _w1#9269, _w2#9270, _w3#9271, rank_within_parent#9234, rank_within_parent#9234]
            +- Window [rank(_w3#9271) windowspecdefinition(_w1#9269, _w2#9270, _w3#9271 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#9234], [_w1#9269, _w2#9270], [_w3#9271 DESC NULLS LAST]
               +- Aggregate [s_state#9255, s_county#9256, spark_grouping_id#9252], [sum(ss_net_profit#152) AS total_sum#9232, s_state#9255, s_county#9256, (cast((shiftright(spark_grouping_id#9252, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#9252, 0) & 1) as tinyint)) AS lochierarchy#9233, sum(ss_net_profit#152) AS _w0#9265, (cast((shiftright(spark_grouping_id#9252, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#9252, 0) & 1) as tinyint)) AS _w1#9269, CASE WHEN (cast(cast((shiftright(spark_grouping_id#9252, 0) & 1) as tinyint) as int) = 0) THEN s_state#9255 END AS _w2#9270, sum(ss_net_profit#152) AS _w3#9271]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#9253, s_county#9254, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#9253, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#9237 [])))
                           :  +- Project [s_state#9235]
                           :     +- Filter (ranking#9236 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#9235, ranking#9236]
                           :              +- Project [s_state#9235, s_state#688, _w1#9243, ranking#9236, ranking#9236]
                           :                 +- Window [rank(_w1#9243) windowspecdefinition(s_state#688, _w1#9243 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#9236], [s_state#688], [_w1#9243 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#9235, s_state#688, sum(ss_net_profit#152) AS _w1#9243]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 76.90698206399999s
Running execution q82-v2.4 iteration: 8, StandardRun=true
20/01/08 19:59:01 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
20/01/08 19:59:01 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 86.488678325s
Running execution q64-v2.4 iteration: 9, StandardRun=true
20/01/08 20:00:37 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#9570 ASC NULLS FIRST, store_name#9572 ASC NULLS FIRST, cnt#9707L ASC NULLS FIRST], true
+- Project [product_name#9570, store_name#9572, store_zip#9573, b_street_number#9574, b_streen_name#9575, b_city#9576, b_zip#9577, c_street_number#9578, c_street_name#9579, c_city#9580, c_zip#9581, syear#9582, cnt#9585L, s1#9586, s2#9587, s3#9588, s1#9708, s2#9709, s3#9710, syear#9704, cnt#9707L]
   +- Filter ((((item_sk#9571 = item_sk#9693) && (syear#9582 = 1999)) && (syear#9704 = (1999 + 1))) && (((cnt#9707L <= cnt#9585L) && (store_name#9572 = store_name#9694)) && (store_zip#9573 = store_zip#9695)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#9670, ca_street_name#9671, ca_city#9674, ca_zip#9677, d_year#498, d_year#9604, d_year#9632], [i_product_name#585 AS product_name#9570, i_item_sk#564 AS item_sk#9571, s_store_name#669 AS store_name#9572, s_zip#689 AS store_zip#9573, ca_street_number#450 AS b_street_number#9574, ca_street_name#451 AS b_streen_name#9575, ca_city#454 AS b_city#9576, ca_zip#457 AS b_zip#9577, ca_street_number#9670 AS c_street_number#9578, ca_street_name#9671 AS c_street_name#9579, ca_city#9674 AS c_city#9580, ca_zip#9677 AS c_zip#9581, d_year#498 AS syear#9582, d_year#9604 AS fsyear#9583, d_year#9632 AS s2year#9584, count(1) AS cnt#9585L, sum(ss_wholesale_cost#141) AS s1#9586, sum(ss_list_price#142) AS s2#9587, sum(ss_coupon_amt#149) AS s3#9588]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#9654)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#9663) && (c_current_addr_sk#416 = ca_address_sk#9668)) && (c_first_sales_date_sk#418 = d_date_sk#9598)) && (((c_first_shipto_date_sk#417 = d_date_sk#9626) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#9664 = ib_income_band_sk#9681) && NOT (cd_marital_status#476 = cd_marital_status#9656)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#9568, refund#9569]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#9594 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#9595 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#9568, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#9569, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#9594, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#9595]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#9598,d_date_id#9599,d_date#9600,d_month_seq#9601,d_week_seq#9602,d_quarter_seq#9603,d_year#9604,d_dow#9605,d_moy#9606,d_dom#9607,d_qoy#9608,d_fy_year#9609,d_fy_quarter_seq#9610,d_fy_week_seq#9611,d_day_name#9612,d_quarter_name#9613,d_holiday#9614,d_weekend#9615,d_following_holiday#9616,d_first_dom#9617,d_last_dom#9618,d_same_day_ly#9619,d_same_day_lq#9620,d_current_day#9621,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#9626,d_date_id#9627,d_date#9628,d_month_seq#9629,d_week_seq#9630,d_quarter_seq#9631,d_year#9632,d_dow#9633,d_moy#9634,d_dom#9635,d_qoy#9636,d_fy_year#9637,d_fy_quarter_seq#9638,d_fy_week_seq#9639,d_day_name#9640,d_quarter_name#9641,d_holiday#9642,d_weekend#9643,d_following_holiday#9644,d_first_dom#9645,d_last_dom#9646,d_same_day_ly#9647,d_same_day_lq#9648,d_current_day#9649,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#9654,cd_gender#9655,cd_marital_status#9656,cd_education_status#9657,cd_purchase_estimate#9658,cd_credit_rating#9659,cd_dep_count#9660,cd_dep_employed_count#9661,cd_dep_college_count#9662] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#9663,hd_income_band_sk#9664,hd_buy_potential#9665,hd_dep_count#9666,hd_vehicle_count#9667] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#9668,ca_address_id#9669,ca_street_number#9670,ca_street_name#9671,ca_street_type#9672,ca_suite_number#9673,ca_city#9674,ca_county#9675,ca_state#9676,ca_zip#9677,ca_country#9678,ca_gmt_offset#9679,ca_location_type#9680] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#9681,ib_lower_bound#9682,ib_upper_bound#9683] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#9670, ca_street_name#9671, ca_city#9674, ca_zip#9677, d_year#498, d_year#9604, d_year#9632], [i_product_name#585 AS product_name#9692, i_item_sk#564 AS item_sk#9693, s_store_name#669 AS store_name#9694, s_zip#689 AS store_zip#9695, ca_street_number#450 AS b_street_number#9696, ca_street_name#451 AS b_streen_name#9697, ca_city#454 AS b_city#9698, ca_zip#457 AS b_zip#9699, ca_street_number#9670 AS c_street_number#9700, ca_street_name#9671 AS c_street_name#9701, ca_city#9674 AS c_city#9702, ca_zip#9677 AS c_zip#9703, d_year#498 AS syear#9704, d_year#9604 AS fsyear#9705, d_year#9632 AS s2year#9706, count(1) AS cnt#9707L, sum(ss_wholesale_cost#141) AS s1#9708, sum(ss_list_price#142) AS s2#9709, sum(ss_coupon_amt#149) AS s3#9710]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#9654)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#9663) && (c_current_addr_sk#416 = ca_address_sk#9668)) && (c_first_sales_date_sk#418 = d_date_sk#9598)) && (((c_first_shipto_date_sk#417 = d_date_sk#9626) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#9664 = ib_income_band_sk#9681) && NOT (cd_marital_status#476 = cd_marital_status#9656)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#9568, refund#9569]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#9594 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#9595 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#9568, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#9569, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#9594, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#9595]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#9598,d_date_id#9599,d_date#9600,d_month_seq#9601,d_week_seq#9602,d_quarter_seq#9603,d_year#9604,d_dow#9605,d_moy#9606,d_dom#9607,d_qoy#9608,d_fy_year#9609,d_fy_quarter_seq#9610,d_fy_week_seq#9611,d_day_name#9612,d_quarter_name#9613,d_holiday#9614,d_weekend#9615,d_following_holiday#9616,d_first_dom#9617,d_last_dom#9618,d_same_day_ly#9619,d_same_day_lq#9620,d_current_day#9621,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#9626,d_date_id#9627,d_date#9628,d_month_seq#9629,d_week_seq#9630,d_quarter_seq#9631,d_year#9632,d_dow#9633,d_moy#9634,d_dom#9635,d_qoy#9636,d_fy_year#9637,d_fy_quarter_seq#9638,d_fy_week_seq#9639,d_day_name#9640,d_quarter_name#9641,d_holiday#9642,d_weekend#9643,d_following_holiday#9644,d_first_dom#9645,d_last_dom#9646,d_same_day_ly#9647,d_same_day_lq#9648,d_current_day#9649,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#9654,cd_gender#9655,cd_marital_status#9656,cd_education_status#9657,cd_purchase_estimate#9658,cd_credit_rating#9659,cd_dep_count#9660,cd_dep_employed_count#9661,cd_dep_college_count#9662] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#9663,hd_income_band_sk#9664,hd_buy_potential#9665,hd_dep_count#9666,hd_vehicle_count#9667] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#9668,ca_address_id#9669,ca_street_number#9670,ca_street_name#9671,ca_street_type#9672,ca_suite_number#9673,ca_city#9674,ca_county#9675,ca_state#9676,ca_zip#9677,ca_country#9678,ca_gmt_offset#9679,ca_location_type#9680] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#9681,ib_lower_bound#9682,ib_upper_bound#9683] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
20/01/08 20:00:37 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#9738 ASC NULLS FIRST, store_name#9740 ASC NULLS FIRST, cnt#9875L ASC NULLS FIRST], true
+- Project [product_name#9738, store_name#9740, store_zip#9741, b_street_number#9742, b_streen_name#9743, b_city#9744, b_zip#9745, c_street_number#9746, c_street_name#9747, c_city#9748, c_zip#9749, syear#9750, cnt#9753L, s1#9754, s2#9755, s3#9756, s1#9876, s2#9877, s3#9878, syear#9872, cnt#9875L]
   +- Filter ((((item_sk#9739 = item_sk#9861) && (syear#9750 = 1999)) && (syear#9872 = (1999 + 1))) && (((cnt#9875L <= cnt#9753L) && (store_name#9740 = store_name#9862)) && (store_zip#9741 = store_zip#9863)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#9838, ca_street_name#9839, ca_city#9842, ca_zip#9845, d_year#498, d_year#9772, d_year#9800], [i_product_name#585 AS product_name#9738, i_item_sk#564 AS item_sk#9739, s_store_name#669 AS store_name#9740, s_zip#689 AS store_zip#9741, ca_street_number#450 AS b_street_number#9742, ca_street_name#451 AS b_streen_name#9743, ca_city#454 AS b_city#9744, ca_zip#457 AS b_zip#9745, ca_street_number#9838 AS c_street_number#9746, ca_street_name#9839 AS c_street_name#9747, ca_city#9842 AS c_city#9748, ca_zip#9845 AS c_zip#9749, d_year#498 AS syear#9750, d_year#9772 AS fsyear#9751, d_year#9800 AS s2year#9752, count(1) AS cnt#9753L, sum(ss_wholesale_cost#141) AS s1#9754, sum(ss_list_price#142) AS s2#9755, sum(ss_coupon_amt#149) AS s3#9756]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#9822)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#9831) && (c_current_addr_sk#416 = ca_address_sk#9836)) && (c_first_sales_date_sk#418 = d_date_sk#9766)) && (((c_first_shipto_date_sk#417 = d_date_sk#9794) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#9832 = ib_income_band_sk#9849) && NOT (cd_marital_status#476 = cd_marital_status#9824)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#9736, refund#9737]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#9762 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#9763 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#9736, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#9737, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#9762, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#9763]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#9766,d_date_id#9767,d_date#9768,d_month_seq#9769,d_week_seq#9770,d_quarter_seq#9771,d_year#9772,d_dow#9773,d_moy#9774,d_dom#9775,d_qoy#9776,d_fy_year#9777,d_fy_quarter_seq#9778,d_fy_week_seq#9779,d_day_name#9780,d_quarter_name#9781,d_holiday#9782,d_weekend#9783,d_following_holiday#9784,d_first_dom#9785,d_last_dom#9786,d_same_day_ly#9787,d_same_day_lq#9788,d_current_day#9789,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#9794,d_date_id#9795,d_date#9796,d_month_seq#9797,d_week_seq#9798,d_quarter_seq#9799,d_year#9800,d_dow#9801,d_moy#9802,d_dom#9803,d_qoy#9804,d_fy_year#9805,d_fy_quarter_seq#9806,d_fy_week_seq#9807,d_day_name#9808,d_quarter_name#9809,d_holiday#9810,d_weekend#9811,d_following_holiday#9812,d_first_dom#9813,d_last_dom#9814,d_same_day_ly#9815,d_same_day_lq#9816,d_current_day#9817,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#9822,cd_gender#9823,cd_marital_status#9824,cd_education_status#9825,cd_purchase_estimate#9826,cd_credit_rating#9827,cd_dep_count#9828,cd_dep_employed_count#9829,cd_dep_college_count#9830] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#9831,hd_income_band_sk#9832,hd_buy_potential#9833,hd_dep_count#9834,hd_vehicle_count#9835] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#9836,ca_address_id#9837,ca_street_number#9838,ca_street_name#9839,ca_street_type#9840,ca_suite_number#9841,ca_city#9842,ca_county#9843,ca_state#9844,ca_zip#9845,ca_country#9846,ca_gmt_offset#9847,ca_location_type#9848] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#9849,ib_lower_bound#9850,ib_upper_bound#9851] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#9838, ca_street_name#9839, ca_city#9842, ca_zip#9845, d_year#498, d_year#9772, d_year#9800], [i_product_name#585 AS product_name#9860, i_item_sk#564 AS item_sk#9861, s_store_name#669 AS store_name#9862, s_zip#689 AS store_zip#9863, ca_street_number#450 AS b_street_number#9864, ca_street_name#451 AS b_streen_name#9865, ca_city#454 AS b_city#9866, ca_zip#457 AS b_zip#9867, ca_street_number#9838 AS c_street_number#9868, ca_street_name#9839 AS c_street_name#9869, ca_city#9842 AS c_city#9870, ca_zip#9845 AS c_zip#9871, d_year#498 AS syear#9872, d_year#9772 AS fsyear#9873, d_year#9800 AS s2year#9874, count(1) AS cnt#9875L, sum(ss_wholesale_cost#141) AS s1#9876, sum(ss_list_price#142) AS s2#9877, sum(ss_coupon_amt#149) AS s3#9878]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#9822)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#9831) && (c_current_addr_sk#416 = ca_address_sk#9836)) && (c_first_sales_date_sk#418 = d_date_sk#9766)) && (((c_first_shipto_date_sk#417 = d_date_sk#9794) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#9832 = ib_income_band_sk#9849) && NOT (cd_marital_status#476 = cd_marital_status#9824)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#9736, refund#9737]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#9762 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#9763 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#9736, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#9737, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#9762, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#9763]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#9766,d_date_id#9767,d_date#9768,d_month_seq#9769,d_week_seq#9770,d_quarter_seq#9771,d_year#9772,d_dow#9773,d_moy#9774,d_dom#9775,d_qoy#9776,d_fy_year#9777,d_fy_quarter_seq#9778,d_fy_week_seq#9779,d_day_name#9780,d_quarter_name#9781,d_holiday#9782,d_weekend#9783,d_following_holiday#9784,d_first_dom#9785,d_last_dom#9786,d_same_day_ly#9787,d_same_day_lq#9788,d_current_day#9789,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#9794,d_date_id#9795,d_date#9796,d_month_seq#9797,d_week_seq#9798,d_quarter_seq#9799,d_year#9800,d_dow#9801,d_moy#9802,d_dom#9803,d_qoy#9804,d_fy_year#9805,d_fy_quarter_seq#9806,d_fy_week_seq#9807,d_day_name#9808,d_quarter_name#9809,d_holiday#9810,d_weekend#9811,d_following_holiday#9812,d_first_dom#9813,d_last_dom#9814,d_same_day_ly#9815,d_same_day_lq#9816,d_current_day#9817,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#9822,cd_gender#9823,cd_marital_status#9824,cd_education_status#9825,cd_purchase_estimate#9826,cd_credit_rating#9827,cd_dep_count#9828,cd_dep_employed_count#9829,cd_dep_college_count#9830] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#9831,hd_income_band_sk#9832,hd_buy_potential#9833,hd_dep_count#9834,hd_vehicle_count#9835] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#9836,ca_address_id#9837,ca_street_number#9838,ca_street_name#9839,ca_street_type#9840,ca_suite_number#9841,ca_city#9842,ca_county#9843,ca_state#9844,ca_zip#9845,ca_country#9846,ca_gmt_offset#9847,ca_location_type#9848] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#9849,ib_lower_bound#9850,ib_upper_bound#9851] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 814.735932631s
Running execution q70-v2.4 iteration: 9, StandardRun=true
20/01/08 20:14:22 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#10174 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#10174 as int) = 0) THEN s_state#10196 END ASC NULLS FIRST, rank_within_parent#10175 ASC NULLS FIRST], true
      +- Project [total_sum#10173, s_state#10196, s_county#10197, lochierarchy#10174, rank_within_parent#10175]
         +- Project [total_sum#10173, s_state#10196, s_county#10197, lochierarchy#10174, _w0#10206, _w1#10210, _w2#10211, _w3#10212, rank_within_parent#10175, rank_within_parent#10175]
            +- Window [rank(_w3#10212) windowspecdefinition(_w1#10210, _w2#10211, _w3#10212 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#10175], [_w1#10210, _w2#10211], [_w3#10212 DESC NULLS LAST]
               +- Aggregate [s_state#10196, s_county#10197, spark_grouping_id#10193], [sum(ss_net_profit#152) AS total_sum#10173, s_state#10196, s_county#10197, (cast((shiftright(spark_grouping_id#10193, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#10193, 0) & 1) as tinyint)) AS lochierarchy#10174, sum(ss_net_profit#152) AS _w0#10206, (cast((shiftright(spark_grouping_id#10193, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#10193, 0) & 1) as tinyint)) AS _w1#10210, CASE WHEN (cast(cast((shiftright(spark_grouping_id#10193, 0) & 1) as tinyint) as int) = 0) THEN s_state#10196 END AS _w2#10211, sum(ss_net_profit#152) AS _w3#10212]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#10194, s_county#10195, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#10194, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#10178 [])))
                           :  +- Project [s_state#10176]
                           :     +- Filter (ranking#10177 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#10176, ranking#10177]
                           :              +- Project [s_state#10176, s_state#688, _w1#10184, ranking#10177, ranking#10177]
                           :                 +- Window [rank(_w1#10184) windowspecdefinition(s_state#688, _w1#10184 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#10177], [s_state#688], [_w1#10184 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#10176, s_state#688, sum(ss_net_profit#152) AS _w1#10184]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
20/01/08 20:14:22 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#10228 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#10228 as int) = 0) THEN s_state#10250 END ASC NULLS FIRST, rank_within_parent#10229 ASC NULLS FIRST], true
      +- Project [total_sum#10227, s_state#10250, s_county#10251, lochierarchy#10228, rank_within_parent#10229]
         +- Project [total_sum#10227, s_state#10250, s_county#10251, lochierarchy#10228, _w0#10260, _w1#10264, _w2#10265, _w3#10266, rank_within_parent#10229, rank_within_parent#10229]
            +- Window [rank(_w3#10266) windowspecdefinition(_w1#10264, _w2#10265, _w3#10266 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#10229], [_w1#10264, _w2#10265], [_w3#10266 DESC NULLS LAST]
               +- Aggregate [s_state#10250, s_county#10251, spark_grouping_id#10247], [sum(ss_net_profit#152) AS total_sum#10227, s_state#10250, s_county#10251, (cast((shiftright(spark_grouping_id#10247, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#10247, 0) & 1) as tinyint)) AS lochierarchy#10228, sum(ss_net_profit#152) AS _w0#10260, (cast((shiftright(spark_grouping_id#10247, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#10247, 0) & 1) as tinyint)) AS _w1#10264, CASE WHEN (cast(cast((shiftright(spark_grouping_id#10247, 0) & 1) as tinyint) as int) = 0) THEN s_state#10250 END AS _w2#10265, sum(ss_net_profit#152) AS _w3#10266]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#10248, s_county#10249, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#10248, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#10232 [])))
                           :  +- Project [s_state#10230]
                           :     +- Filter (ranking#10231 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#10230, ranking#10231]
                           :              +- Project [s_state#10230, s_state#688, _w1#10238, ranking#10231, ranking#10231]
                           :                 +- Window [rank(_w1#10238) windowspecdefinition(s_state#688, _w1#10238 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#10231], [s_state#688], [_w1#10238 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#10230, s_state#688, sum(ss_net_profit#152) AS _w1#10238]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 77.760679895s
Running execution q82-v2.4 iteration: 9, StandardRun=true
20/01/08 20:15:41 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
20/01/08 20:15:41 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 84.545813502s
Running execution q64-v2.4 iteration: 10, StandardRun=true
20/01/08 20:17:15 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#10565 ASC NULLS FIRST, store_name#10567 ASC NULLS FIRST, cnt#10702L ASC NULLS FIRST], true
+- Project [product_name#10565, store_name#10567, store_zip#10568, b_street_number#10569, b_streen_name#10570, b_city#10571, b_zip#10572, c_street_number#10573, c_street_name#10574, c_city#10575, c_zip#10576, syear#10577, cnt#10580L, s1#10581, s2#10582, s3#10583, s1#10703, s2#10704, s3#10705, syear#10699, cnt#10702L]
   +- Filter ((((item_sk#10566 = item_sk#10688) && (syear#10577 = 1999)) && (syear#10699 = (1999 + 1))) && (((cnt#10702L <= cnt#10580L) && (store_name#10567 = store_name#10689)) && (store_zip#10568 = store_zip#10690)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#10665, ca_street_name#10666, ca_city#10669, ca_zip#10672, d_year#498, d_year#10599, d_year#10627], [i_product_name#585 AS product_name#10565, i_item_sk#564 AS item_sk#10566, s_store_name#669 AS store_name#10567, s_zip#689 AS store_zip#10568, ca_street_number#450 AS b_street_number#10569, ca_street_name#451 AS b_streen_name#10570, ca_city#454 AS b_city#10571, ca_zip#457 AS b_zip#10572, ca_street_number#10665 AS c_street_number#10573, ca_street_name#10666 AS c_street_name#10574, ca_city#10669 AS c_city#10575, ca_zip#10672 AS c_zip#10576, d_year#498 AS syear#10577, d_year#10599 AS fsyear#10578, d_year#10627 AS s2year#10579, count(1) AS cnt#10580L, sum(ss_wholesale_cost#141) AS s1#10581, sum(ss_list_price#142) AS s2#10582, sum(ss_coupon_amt#149) AS s3#10583]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#10649)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#10658) && (c_current_addr_sk#416 = ca_address_sk#10663)) && (c_first_sales_date_sk#418 = d_date_sk#10593)) && (((c_first_shipto_date_sk#417 = d_date_sk#10621) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#10659 = ib_income_band_sk#10676) && NOT (cd_marital_status#476 = cd_marital_status#10651)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#10563, refund#10564]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#10589 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#10590 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#10563, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#10564, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#10589, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#10590]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#10593,d_date_id#10594,d_date#10595,d_month_seq#10596,d_week_seq#10597,d_quarter_seq#10598,d_year#10599,d_dow#10600,d_moy#10601,d_dom#10602,d_qoy#10603,d_fy_year#10604,d_fy_quarter_seq#10605,d_fy_week_seq#10606,d_day_name#10607,d_quarter_name#10608,d_holiday#10609,d_weekend#10610,d_following_holiday#10611,d_first_dom#10612,d_last_dom#10613,d_same_day_ly#10614,d_same_day_lq#10615,d_current_day#10616,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#10621,d_date_id#10622,d_date#10623,d_month_seq#10624,d_week_seq#10625,d_quarter_seq#10626,d_year#10627,d_dow#10628,d_moy#10629,d_dom#10630,d_qoy#10631,d_fy_year#10632,d_fy_quarter_seq#10633,d_fy_week_seq#10634,d_day_name#10635,d_quarter_name#10636,d_holiday#10637,d_weekend#10638,d_following_holiday#10639,d_first_dom#10640,d_last_dom#10641,d_same_day_ly#10642,d_same_day_lq#10643,d_current_day#10644,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#10649,cd_gender#10650,cd_marital_status#10651,cd_education_status#10652,cd_purchase_estimate#10653,cd_credit_rating#10654,cd_dep_count#10655,cd_dep_employed_count#10656,cd_dep_college_count#10657] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#10658,hd_income_band_sk#10659,hd_buy_potential#10660,hd_dep_count#10661,hd_vehicle_count#10662] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#10663,ca_address_id#10664,ca_street_number#10665,ca_street_name#10666,ca_street_type#10667,ca_suite_number#10668,ca_city#10669,ca_county#10670,ca_state#10671,ca_zip#10672,ca_country#10673,ca_gmt_offset#10674,ca_location_type#10675] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#10676,ib_lower_bound#10677,ib_upper_bound#10678] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#10665, ca_street_name#10666, ca_city#10669, ca_zip#10672, d_year#498, d_year#10599, d_year#10627], [i_product_name#585 AS product_name#10687, i_item_sk#564 AS item_sk#10688, s_store_name#669 AS store_name#10689, s_zip#689 AS store_zip#10690, ca_street_number#450 AS b_street_number#10691, ca_street_name#451 AS b_streen_name#10692, ca_city#454 AS b_city#10693, ca_zip#457 AS b_zip#10694, ca_street_number#10665 AS c_street_number#10695, ca_street_name#10666 AS c_street_name#10696, ca_city#10669 AS c_city#10697, ca_zip#10672 AS c_zip#10698, d_year#498 AS syear#10699, d_year#10599 AS fsyear#10700, d_year#10627 AS s2year#10701, count(1) AS cnt#10702L, sum(ss_wholesale_cost#141) AS s1#10703, sum(ss_list_price#142) AS s2#10704, sum(ss_coupon_amt#149) AS s3#10705]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#10649)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#10658) && (c_current_addr_sk#416 = ca_address_sk#10663)) && (c_first_sales_date_sk#418 = d_date_sk#10593)) && (((c_first_shipto_date_sk#417 = d_date_sk#10621) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#10659 = ib_income_band_sk#10676) && NOT (cd_marital_status#476 = cd_marital_status#10651)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#10563, refund#10564]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#10589 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#10590 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#10563, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#10564, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#10589, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#10590]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#10593,d_date_id#10594,d_date#10595,d_month_seq#10596,d_week_seq#10597,d_quarter_seq#10598,d_year#10599,d_dow#10600,d_moy#10601,d_dom#10602,d_qoy#10603,d_fy_year#10604,d_fy_quarter_seq#10605,d_fy_week_seq#10606,d_day_name#10607,d_quarter_name#10608,d_holiday#10609,d_weekend#10610,d_following_holiday#10611,d_first_dom#10612,d_last_dom#10613,d_same_day_ly#10614,d_same_day_lq#10615,d_current_day#10616,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#10621,d_date_id#10622,d_date#10623,d_month_seq#10624,d_week_seq#10625,d_quarter_seq#10626,d_year#10627,d_dow#10628,d_moy#10629,d_dom#10630,d_qoy#10631,d_fy_year#10632,d_fy_quarter_seq#10633,d_fy_week_seq#10634,d_day_name#10635,d_quarter_name#10636,d_holiday#10637,d_weekend#10638,d_following_holiday#10639,d_first_dom#10640,d_last_dom#10641,d_same_day_ly#10642,d_same_day_lq#10643,d_current_day#10644,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#10649,cd_gender#10650,cd_marital_status#10651,cd_education_status#10652,cd_purchase_estimate#10653,cd_credit_rating#10654,cd_dep_count#10655,cd_dep_employed_count#10656,cd_dep_college_count#10657] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#10658,hd_income_band_sk#10659,hd_buy_potential#10660,hd_dep_count#10661,hd_vehicle_count#10662] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#10663,ca_address_id#10664,ca_street_number#10665,ca_street_name#10666,ca_street_type#10667,ca_suite_number#10668,ca_city#10669,ca_county#10670,ca_state#10671,ca_zip#10672,ca_country#10673,ca_gmt_offset#10674,ca_location_type#10675] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#10676,ib_lower_bound#10677,ib_upper_bound#10678] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

     : benchmark
20/01/08 20:17:15 INFO Query: 
== Query: q64-v2.4 ==
Sort [product_name#10733 ASC NULLS FIRST, store_name#10735 ASC NULLS FIRST, cnt#10870L ASC NULLS FIRST], true
+- Project [product_name#10733, store_name#10735, store_zip#10736, b_street_number#10737, b_streen_name#10738, b_city#10739, b_zip#10740, c_street_number#10741, c_street_name#10742, c_city#10743, c_zip#10744, syear#10745, cnt#10748L, s1#10749, s2#10750, s3#10751, s1#10871, s2#10872, s3#10873, syear#10867, cnt#10870L]
   +- Filter ((((item_sk#10734 = item_sk#10856) && (syear#10745 = 1999)) && (syear#10867 = (1999 + 1))) && (((cnt#10870L <= cnt#10748L) && (store_name#10735 = store_name#10857)) && (store_zip#10736 = store_zip#10858)))
      +- Join Inner
         :- SubqueryAlias `cs1`
         :  +- SubqueryAlias `cross_sales`
         :     +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#10833, ca_street_name#10834, ca_city#10837, ca_zip#10840, d_year#498, d_year#10767, d_year#10795], [i_product_name#585 AS product_name#10733, i_item_sk#564 AS item_sk#10734, s_store_name#669 AS store_name#10735, s_zip#689 AS store_zip#10736, ca_street_number#450 AS b_street_number#10737, ca_street_name#451 AS b_streen_name#10738, ca_city#454 AS b_city#10739, ca_zip#457 AS b_zip#10740, ca_street_number#10833 AS c_street_number#10741, ca_street_name#10834 AS c_street_name#10742, ca_city#10837 AS c_city#10743, ca_zip#10840 AS c_zip#10744, d_year#498 AS syear#10745, d_year#10767 AS fsyear#10746, d_year#10795 AS s2year#10747, count(1) AS cnt#10748L, sum(ss_wholesale_cost#141) AS s1#10749, sum(ss_list_price#142) AS s2#10750, sum(ss_coupon_amt#149) AS s3#10751]
         :        +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#10817)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#10826) && (c_current_addr_sk#416 = ca_address_sk#10831)) && (c_first_sales_date_sk#418 = d_date_sk#10761)) && (((c_first_shipto_date_sk#417 = d_date_sk#10789) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#10827 = ib_income_band_sk#10844) && NOT (cd_marital_status#476 = cd_marital_status#10819)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
         :           +- Join Inner
         :              :- Join Inner
         :              :  :- Join Inner
         :              :  :  :- Join Inner
         :              :  :  :  :- Join Inner
         :              :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#10731, refund#10732]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#10757 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#10758 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#10731, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#10732, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#10757, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#10758]
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#10761,d_date_id#10762,d_date#10763,d_month_seq#10764,d_week_seq#10765,d_quarter_seq#10766,d_year#10767,d_dow#10768,d_moy#10769,d_dom#10770,d_qoy#10771,d_fy_year#10772,d_fy_quarter_seq#10773,d_fy_week_seq#10774,d_day_name#10775,d_quarter_name#10776,d_holiday#10777,d_weekend#10778,d_following_holiday#10779,d_first_dom#10780,d_last_dom#10781,d_same_day_ly#10782,d_same_day_lq#10783,d_current_day#10784,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
         :              :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
         :              :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#10789,d_date_id#10790,d_date#10791,d_month_seq#10792,d_week_seq#10793,d_quarter_seq#10794,d_year#10795,d_dow#10796,d_moy#10797,d_dom#10798,d_qoy#10799,d_fy_year#10800,d_fy_quarter_seq#10801,d_fy_week_seq#10802,d_day_name#10803,d_quarter_name#10804,d_holiday#10805,d_weekend#10806,d_following_holiday#10807,d_first_dom#10808,d_last_dom#10809,d_same_day_ly#10810,d_same_day_lq#10811,d_current_day#10812,... 4 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
         :              :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
         :              :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
         :              :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
         :              :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
         :              :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
         :              :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
         :              :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
         :              :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#10817,cd_gender#10818,cd_marital_status#10819,cd_education_status#10820,cd_purchase_estimate#10821,cd_credit_rating#10822,cd_dep_count#10823,cd_dep_employed_count#10824,cd_dep_college_count#10825] parquet
         :              :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
         :              :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
         :              :  :  :  :  :  :  +- SubqueryAlias `hd1`
         :              :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
         :              :  :  :  :  :  +- SubqueryAlias `hd2`
         :              :  :  :  :  :     +- SubqueryAlias `household_demographics`
         :              :  :  :  :  :        +- Relation[hd_demo_sk#10826,hd_income_band_sk#10827,hd_buy_potential#10828,hd_dep_count#10829,hd_vehicle_count#10830] parquet
         :              :  :  :  :  +- SubqueryAlias `ad1`
         :              :  :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
         :              :  :  :  +- SubqueryAlias `ad2`
         :              :  :  :     +- SubqueryAlias `customer_address`
         :              :  :  :        +- Relation[ca_address_sk#10831,ca_address_id#10832,ca_street_number#10833,ca_street_name#10834,ca_street_type#10835,ca_suite_number#10836,ca_city#10837,ca_county#10838,ca_state#10839,ca_zip#10840,ca_country#10841,ca_gmt_offset#10842,ca_location_type#10843] parquet
         :              :  :  +- SubqueryAlias `ib1`
         :              :  :     +- SubqueryAlias `income_band`
         :              :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
         :              :  +- SubqueryAlias `ib2`
         :              :     +- SubqueryAlias `income_band`
         :              :        +- Relation[ib_income_band_sk#10844,ib_lower_bound#10845,ib_upper_bound#10846] parquet
         :              +- SubqueryAlias `item`
         :                 +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
         +- SubqueryAlias `cs2`
            +- SubqueryAlias `cross_sales`
               +- Aggregate [i_product_name#585, i_item_sk#564, s_store_name#669, s_zip#689, ca_street_number#450, ca_street_name#451, ca_city#454, ca_zip#457, ca_street_number#10833, ca_street_name#10834, ca_city#10837, ca_zip#10840, d_year#498, d_year#10767, d_year#10795], [i_product_name#585 AS product_name#10855, i_item_sk#564 AS item_sk#10856, s_store_name#669 AS store_name#10857, s_zip#689 AS store_zip#10858, ca_street_number#450 AS b_street_number#10859, ca_street_name#451 AS b_streen_name#10860, ca_city#454 AS b_city#10861, ca_zip#457 AS b_zip#10862, ca_street_number#10833 AS c_street_number#10863, ca_street_name#10834 AS c_street_name#10864, ca_city#10837 AS c_city#10865, ca_zip#10840 AS c_zip#10866, d_year#498 AS syear#10867, d_year#10767 AS fsyear#10868, d_year#10795 AS s2year#10869, count(1) AS cnt#10870L, sum(ss_wholesale_cost#141) AS s1#10871, sum(ss_list_price#142) AS s2#10872, sum(ss_coupon_amt#149) AS s3#10873]
                  +- Filter ((((((ss_store_sk#137 = s_store_sk#664) && (ss_sold_date_sk#130 = d_date_sk#492)) && (ss_customer_sk#133 = c_customer_sk#412)) && (((ss_cdemo_sk#134 = cd_demo_sk#474) && (ss_hdemo_sk#135 = hd_demo_sk#548)) && (ss_addr_sk#136 = ca_address_sk#448))) && ((((ss_item_sk#132 = i_item_sk#564) && (ss_item_sk#132 = sr_item_sk#178)) && (ss_ticket_number#139L = sr_ticket_number#185L)) && ((ss_item_sk#132 = cs_item_sk#15) && (c_current_cdemo_sk#414 = cd_demo_sk#10817)))) && (((((c_current_hdemo_sk#415 = hd_demo_sk#10826) && (c_current_addr_sk#416 = ca_address_sk#10831)) && (c_first_sales_date_sk#418 = d_date_sk#10761)) && (((c_first_shipto_date_sk#417 = d_date_sk#10789) && (ss_promo_sk#138 = p_promo_sk#608)) && (hd_income_band_sk#549 = ib_income_band_sk#558))) && ((((hd_income_band_sk#10827 = ib_income_band_sk#10844) && NOT (cd_marital_status#476 = cd_marital_status#10819)) && i_color#581 IN (purple,burlywood,indian,spring,floral,medium)) && (((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(64 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 10) as decimal(10,0)) as decimal(12,2)))) && ((cast(i_current_price#569 as decimal(12,2)) >= cast(cast((64 + 1) as decimal(10,0)) as decimal(12,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((64 + 15) as decimal(10,0)) as decimal(12,2))))))))
                     +- Join Inner
                        :- Join Inner
                        :  :- Join Inner
                        :  :  :- Join Inner
                        :  :  :  :- Join Inner
                        :  :  :  :  :- Join Inner
                        :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :- SubqueryAlias `store_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Relation[sr_returned_date_sk#176,sr_return_time_sk#177,sr_item_sk#178,sr_customer_sk#179,sr_cdemo_sk#180,sr_hdemo_sk#181,sr_addr_sk#182,sr_store_sk#183,sr_reason_sk#184,sr_ticket_number#185L,sr_return_quantity#186,sr_return_amt#187,sr_return_tax#188,sr_return_amt_inc_tax#189,sr_fee#190,sr_return_ship_cost#191,sr_refunded_cash#192,sr_reversed_charge#193,sr_store_credit#194,sr_net_loss#195] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cs_ui`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- Project [cs_item_sk#15, sale#10731, refund#10732]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Filter (cast(sum(cs_ext_list_price#25)#10757 as decimal(21,2)) > cast(CheckOverflow((promote_precision(cast(cast(2 as decimal(1,0)) as decimal(19,2))) * promote_precision(cast(sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#10758 as decimal(19,2)))), DecimalType(21,2)) as decimal(21,2)))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :           +- Aggregate [cs_item_sk#15], [cs_item_sk#15, sum(cs_ext_list_price#25) AS sale#10731, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS refund#10732, sum(cs_ext_list_price#25) AS sum(cs_ext_list_price#25)#10757, sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2))) AS sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#91 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#92 as decimal(8,2)))), DecimalType(8,2)) as decimal(9,2))) + promote_precision(cast(cr_store_credit#93 as decimal(9,2)))), DecimalType(9,2)))#10758]
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :              +- Filter ((cs_item_sk#15 = cr_item_sk#70) && (cs_order_number#17L = cr_order_number#84L))
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                 +- Join Inner
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :- SubqueryAlias `catalog_sales`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    :  +- Relation[cs_sold_date_sk#0,cs_sold_time_sk#1,cs_ship_date_sk#2,cs_bill_customer_sk#3,cs_bill_cdemo_sk#4,cs_bill_hdemo_sk#5,cs_bill_addr_sk#6,cs_ship_customer_sk#7,cs_ship_cdemo_sk#8,cs_ship_hdemo_sk#9,cs_ship_addr_sk#10,cs_call_center_sk#11,cs_catalog_page_sk#12,cs_ship_mode_sk#13,cs_warehouse_sk#14,cs_item_sk#15,cs_promo_sk#16,cs_order_number#17L,cs_quantity#18,cs_wholesale_cost#19,cs_list_price#20,cs_sales_price#21,cs_ext_discount_amt#22,cs_ext_sales_price#23,... 10 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                    +- SubqueryAlias `catalog_returns`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  :                       +- Relation[cr_returned_date_sk#68,cr_returned_time_sk#69,cr_item_sk#70,cr_refunded_customer_sk#71,cr_refunded_cdemo_sk#72,cr_refunded_hdemo_sk#73,cr_refunded_addr_sk#74,cr_returning_customer_sk#75,cr_returning_cdemo_sk#76,cr_returning_hdemo_sk#77,cr_returning_addr_sk#78,cr_call_center_sk#79,cr_catalog_page_sk#80,cr_ship_mode_sk#81,cr_warehouse_sk#82,cr_reason_sk#83,cr_order_number#84L,cr_return_quantity#85,cr_return_amount#86,cr_return_tax#87,cr_return_amt_inc_tax#88,cr_fee#89,cr_return_ship_cost#90,cr_refunded_cash#91,... 3 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d1`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d2`
                        :  :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#10761,d_date_id#10762,d_date#10763,d_month_seq#10764,d_week_seq#10765,d_quarter_seq#10766,d_year#10767,d_dow#10768,d_moy#10769,d_dom#10770,d_qoy#10771,d_fy_year#10772,d_fy_quarter_seq#10773,d_fy_week_seq#10774,d_day_name#10775,d_quarter_name#10776,d_holiday#10777,d_weekend#10778,d_following_holiday#10779,d_first_dom#10780,d_last_dom#10781,d_same_day_ly#10782,d_same_day_lq#10783,d_current_day#10784,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `d3`
                        :  :  :  :  :  :  :  :  :  :  :  :     +- SubqueryAlias `date_dim`
                        :  :  :  :  :  :  :  :  :  :  :  :        +- Relation[d_date_sk#10789,d_date_id#10790,d_date#10791,d_month_seq#10792,d_week_seq#10793,d_quarter_seq#10794,d_year#10795,d_dow#10796,d_moy#10797,d_dom#10798,d_qoy#10799,d_fy_year#10800,d_fy_quarter_seq#10801,d_fy_week_seq#10802,d_day_name#10803,d_quarter_name#10804,d_holiday#10805,d_weekend#10806,d_following_holiday#10807,d_first_dom#10808,d_last_dom#10809,d_same_day_ly#10810,d_same_day_lq#10811,d_current_day#10812,... 4 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `store`
                        :  :  :  :  :  :  :  :  :  :  :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                        :  :  :  :  :  :  :  :  :  :  +- SubqueryAlias `customer`
                        :  :  :  :  :  :  :  :  :  :     +- Relation[c_customer_sk#412,c_customer_id#413,c_current_cdemo_sk#414,c_current_hdemo_sk#415,c_current_addr_sk#416,c_first_shipto_date_sk#417,c_first_sales_date_sk#418,c_salutation#419,c_first_name#420,c_last_name#421,c_preferred_cust_flag#422,c_birth_day#423,c_birth_month#424,c_birth_year#425,c_birth_country#426,c_login#427,c_email_address#428,c_last_review_date#429] parquet
                        :  :  :  :  :  :  :  :  :  +- SubqueryAlias `cd1`
                        :  :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#474,cd_gender#475,cd_marital_status#476,cd_education_status#477,cd_purchase_estimate#478,cd_credit_rating#479,cd_dep_count#480,cd_dep_employed_count#481,cd_dep_college_count#482] parquet
                        :  :  :  :  :  :  :  :  +- SubqueryAlias `cd2`
                        :  :  :  :  :  :  :  :     +- SubqueryAlias `customer_demographics`
                        :  :  :  :  :  :  :  :        +- Relation[cd_demo_sk#10817,cd_gender#10818,cd_marital_status#10819,cd_education_status#10820,cd_purchase_estimate#10821,cd_credit_rating#10822,cd_dep_count#10823,cd_dep_employed_count#10824,cd_dep_college_count#10825] parquet
                        :  :  :  :  :  :  :  +- SubqueryAlias `promotion`
                        :  :  :  :  :  :  :     +- Relation[p_promo_sk#608,p_promo_id#609,p_start_date_sk#610,p_end_date_sk#611,p_item_sk#612,p_cost#613,p_response_target#614,p_promo_name#615,p_channel_dmail#616,p_channel_email#617,p_channel_catalog#618,p_channel_tv#619,p_channel_radio#620,p_channel_press#621,p_channel_event#622,p_channel_demo#623,p_channel_details#624,p_purpose#625,p_discount_active#626] parquet
                        :  :  :  :  :  :  +- SubqueryAlias `hd1`
                        :  :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :  :        +- Relation[hd_demo_sk#548,hd_income_band_sk#549,hd_buy_potential#550,hd_dep_count#551,hd_vehicle_count#552] parquet
                        :  :  :  :  :  +- SubqueryAlias `hd2`
                        :  :  :  :  :     +- SubqueryAlias `household_demographics`
                        :  :  :  :  :        +- Relation[hd_demo_sk#10826,hd_income_band_sk#10827,hd_buy_potential#10828,hd_dep_count#10829,hd_vehicle_count#10830] parquet
                        :  :  :  :  +- SubqueryAlias `ad1`
                        :  :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :  :        +- Relation[ca_address_sk#448,ca_address_id#449,ca_street_number#450,ca_street_name#451,ca_street_type#452,ca_suite_number#453,ca_city#454,ca_county#455,ca_state#456,ca_zip#457,ca_country#458,ca_gmt_offset#459,ca_location_type#460] parquet
                        :  :  :  +- SubqueryAlias `ad2`
                        :  :  :     +- SubqueryAlias `customer_address`
                        :  :  :        +- Relation[ca_address_sk#10831,ca_address_id#10832,ca_street_number#10833,ca_street_name#10834,ca_street_type#10835,ca_suite_number#10836,ca_city#10837,ca_county#10838,ca_state#10839,ca_zip#10840,ca_country#10841,ca_gmt_offset#10842,ca_location_type#10843] parquet
                        :  :  +- SubqueryAlias `ib1`
                        :  :     +- SubqueryAlias `income_band`
                        :  :        +- Relation[ib_income_band_sk#558,ib_lower_bound#559,ib_upper_bound#560] parquet
                        :  +- SubqueryAlias `ib2`
                        :     +- SubqueryAlias `income_band`
                        :        +- Relation[ib_income_band_sk#10844,ib_lower_bound#10845,ib_upper_bound#10846] parquet
                        +- SubqueryAlias `item`
                           +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet

      running Thread[benchmark runner,5,main]
Execution time: 962.642404867s
Running execution q70-v2.4 iteration: 10, StandardRun=true
20/01/08 20:33:28 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#11169 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#11169 as int) = 0) THEN s_state#11191 END ASC NULLS FIRST, rank_within_parent#11170 ASC NULLS FIRST], true
      +- Project [total_sum#11168, s_state#11191, s_county#11192, lochierarchy#11169, rank_within_parent#11170]
         +- Project [total_sum#11168, s_state#11191, s_county#11192, lochierarchy#11169, _w0#11201, _w1#11205, _w2#11206, _w3#11207, rank_within_parent#11170, rank_within_parent#11170]
            +- Window [rank(_w3#11207) windowspecdefinition(_w1#11205, _w2#11206, _w3#11207 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#11170], [_w1#11205, _w2#11206], [_w3#11207 DESC NULLS LAST]
               +- Aggregate [s_state#11191, s_county#11192, spark_grouping_id#11188], [sum(ss_net_profit#152) AS total_sum#11168, s_state#11191, s_county#11192, (cast((shiftright(spark_grouping_id#11188, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#11188, 0) & 1) as tinyint)) AS lochierarchy#11169, sum(ss_net_profit#152) AS _w0#11201, (cast((shiftright(spark_grouping_id#11188, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#11188, 0) & 1) as tinyint)) AS _w1#11205, CASE WHEN (cast(cast((shiftright(spark_grouping_id#11188, 0) & 1) as tinyint) as int) = 0) THEN s_state#11191 END AS _w2#11206, sum(ss_net_profit#152) AS _w3#11207]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#11189, s_county#11190, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#11189, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#11173 [])))
                           :  +- Project [s_state#11171]
                           :     +- Filter (ranking#11172 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#11171, ranking#11172]
                           :              +- Project [s_state#11171, s_state#688, _w1#11179, ranking#11172, ranking#11172]
                           :                 +- Window [rank(_w1#11179) windowspecdefinition(s_state#688, _w1#11179 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#11172], [s_state#688], [_w1#11179 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#11171, s_state#688, sum(ss_net_profit#152) AS _w1#11179]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

     : benchmark
20/01/08 20:33:28 INFO Query: 
== Query: q70-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [lochierarchy#11223 DESC NULLS LAST, CASE WHEN (cast(lochierarchy#11223 as int) = 0) THEN s_state#11245 END ASC NULLS FIRST, rank_within_parent#11224 ASC NULLS FIRST], true
      +- Project [total_sum#11222, s_state#11245, s_county#11246, lochierarchy#11223, rank_within_parent#11224]
         +- Project [total_sum#11222, s_state#11245, s_county#11246, lochierarchy#11223, _w0#11255, _w1#11259, _w2#11260, _w3#11261, rank_within_parent#11224, rank_within_parent#11224]
            +- Window [rank(_w3#11261) windowspecdefinition(_w1#11259, _w2#11260, _w3#11261 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS rank_within_parent#11224], [_w1#11259, _w2#11260], [_w3#11261 DESC NULLS LAST]
               +- Aggregate [s_state#11245, s_county#11246, spark_grouping_id#11242], [sum(ss_net_profit#152) AS total_sum#11222, s_state#11245, s_county#11246, (cast((shiftright(spark_grouping_id#11242, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#11242, 0) & 1) as tinyint)) AS lochierarchy#11223, sum(ss_net_profit#152) AS _w0#11255, (cast((shiftright(spark_grouping_id#11242, 1) & 1) as tinyint) + cast((shiftright(spark_grouping_id#11242, 0) & 1) as tinyint)) AS _w1#11259, CASE WHEN (cast(cast((shiftright(spark_grouping_id#11242, 0) & 1) as tinyint) as int) = 0) THEN s_state#11245 END AS _w2#11260, sum(ss_net_profit#152) AS _w3#11261]
                  +- Expand [List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#11243, s_county#11244, 0), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, s_state#11243, null, 1), List(ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, d_date_id#493, d_date#494, d_month_seq#495, d_week_seq#496, d_quarter_seq#497, d_year#498, d_dow#499, d_moy#500, d_dom#501, d_qoy#502, d_fy_year#503, d_fy_quarter_seq#504, d_fy_week_seq#505, d_day_name#506, d_quarter_name#507, d_holiday#508, d_weekend#509, d_following_holiday#510, d_first_dom#511, d_last_dom#512, d_same_day_ly#513, d_same_day_lq#514, d_current_day#515, d_current_week#516, d_current_month#517, d_current_quarter#518, d_current_year#519, s_store_sk#664, s_store_id#665, s_rec_start_date#666, s_rec_end_date#667, s_closed_date_sk#668, s_store_name#669, s_number_employees#670, s_floor_space#671, s_hours#672, s_manager#673, s_market_id#674, s_geography_class#675, s_market_desc#676, s_market_manager#677, s_division_id#678, s_division_name#679, s_company_id#680, s_company_name#681, s_street_number#682, s_street_name#683, s_street_type#684, s_suite_number#685, s_city#686, s_county#687, s_state#688, s_zip#689, s_country#690, s_gmt_offset#691, s_tax_precentage#692, null, null, 3)], [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 59 more fields]
                     +- Project [ss_sold_date_sk#130, ss_sold_time_sk#131, ss_item_sk#132, ss_customer_sk#133, ss_cdemo_sk#134, ss_hdemo_sk#135, ss_addr_sk#136, ss_store_sk#137, ss_promo_sk#138, ss_ticket_number#139L, ss_quantity#140, ss_wholesale_cost#141, ss_list_price#142, ss_sales_price#143, ss_ext_discount_amt#144, ss_ext_sales_price#145, ss_ext_wholesale_cost#146, ss_ext_list_price#147, ss_ext_tax#148, ss_coupon_amt#149, ss_net_paid#150, ss_net_paid_inc_tax#151, ss_net_profit#152, d_date_sk#492, ... 58 more fields]
                        +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && ((s_store_sk#664 = ss_store_sk#137) && s_state#688 IN (list#11227 [])))
                           :  +- Project [s_state#11225]
                           :     +- Filter (ranking#11226 <= 5)
                           :        +- SubqueryAlias `tmp1`
                           :           +- Project [s_state#11225, ranking#11226]
                           :              +- Project [s_state#11225, s_state#688, _w1#11233, ranking#11226, ranking#11226]
                           :                 +- Window [rank(_w1#11233) windowspecdefinition(s_state#688, _w1#11233 DESC NULLS LAST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS ranking#11226], [s_state#688], [_w1#11233 DESC NULLS LAST]
                           :                    +- Aggregate [s_state#688], [s_state#688 AS s_state#11225, s_state#688, sum(ss_net_profit#152) AS _w1#11233]
                           :                       +- Filter ((((d_month_seq#495 >= 1200) && (d_month_seq#495 <= (1200 + 11))) && (d_date_sk#492 = ss_sold_date_sk#130)) && (s_store_sk#664 = ss_store_sk#137))
                           :                          +- Join Inner
                           :                             :- Join Inner
                           :                             :  :- SubqueryAlias `store_sales`
                           :                             :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                           :                             :  +- SubqueryAlias `store`
                           :                             :     +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet
                           :                             +- SubqueryAlias `date_dim`
                           :                                +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                           +- Join Inner
                              :- Join Inner
                              :  :- SubqueryAlias `store_sales`
                              :  :  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet
                              :  +- SubqueryAlias `d1`
                              :     +- SubqueryAlias `date_dim`
                              :        +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
                              +- SubqueryAlias `store`
                                 +- Relation[s_store_sk#664,s_store_id#665,s_rec_start_date#666,s_rec_end_date#667,s_closed_date_sk#668,s_store_name#669,s_number_employees#670,s_floor_space#671,s_hours#672,s_manager#673,s_market_id#674,s_geography_class#675,s_market_desc#676,s_market_manager#677,s_division_id#678,s_division_name#679,s_company_id#680,s_company_name#681,s_street_number#682,s_street_name#683,s_street_type#684,s_suite_number#685,s_city#686,s_county#687,... 5 more fields] parquet

      running Thread[benchmark runner,5,main]
Execution time: 75.170667481s
Running execution q82-v2.4 iteration: 10, StandardRun=true
20/01/08 20:34:45 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

     : benchmark
20/01/08 20:34:45 INFO Query: 
== Query: q82-v2.4 ==
GlobalLimit 100
+- LocalLimit 100
   +- Sort [i_item_id#565 ASC NULLS FIRST], true
      +- Aggregate [i_item_id#565, i_item_desc#568, i_current_price#569], [i_item_id#565, i_item_desc#568, i_current_price#569]
         +- Filter (((((cast(i_current_price#569 as decimal(7,2)) >= cast(cast(62 as decimal(2,0)) as decimal(7,2))) && (cast(i_current_price#569 as decimal(12,2)) <= cast(cast((62 + 30) as decimal(10,0)) as decimal(12,2)))) && (inv_item_sk#123 = i_item_sk#564)) && ((d_date_sk#492 = inv_date_sk#122) && ((d_date#494 >= cast(2000-05-25 as date)) && (d_date#494 <= cast(cast(cast(2000-05-25 as date) as timestamp) + interval 8 weeks 4 days as date))))) && ((i_manufact_id#577 IN (129,270,821,423) && ((inv_quantity_on_hand#125 >= 100) && (inv_quantity_on_hand#125 <= 500))) && (ss_item_sk#132 = i_item_sk#564)))
            +- Join Inner
               :- Join Inner
               :  :- Join Inner
               :  :  :- SubqueryAlias `item`
               :  :  :  +- Relation[i_item_sk#564,i_item_id#565,i_rec_start_date#566,i_rec_end_date#567,i_item_desc#568,i_current_price#569,i_wholesale_cost#570,i_brand_id#571,i_brand#572,i_class_id#573,i_class#574,i_category_id#575,i_category#576,i_manufact_id#577,i_manufact#578,i_size#579,i_formulation#580,i_color#581,i_units#582,i_container#583,i_manager_id#584,i_product_name#585] parquet
               :  :  +- SubqueryAlias `inventory`
               :  :     +- Relation[inv_date_sk#122,inv_item_sk#123,inv_warehouse_sk#124,inv_quantity_on_hand#125] parquet
               :  +- SubqueryAlias `date_dim`
               :     +- Relation[d_date_sk#492,d_date_id#493,d_date#494,d_month_seq#495,d_week_seq#496,d_quarter_seq#497,d_year#498,d_dow#499,d_moy#500,d_dom#501,d_qoy#502,d_fy_year#503,d_fy_quarter_seq#504,d_fy_week_seq#505,d_day_name#506,d_quarter_name#507,d_holiday#508,d_weekend#509,d_following_holiday#510,d_first_dom#511,d_last_dom#512,d_same_day_ly#513,d_same_day_lq#514,d_current_day#515,... 4 more fields] parquet
               +- SubqueryAlias `store_sales`
                  +- Relation[ss_sold_date_sk#130,ss_sold_time_sk#131,ss_item_sk#132,ss_customer_sk#133,ss_cdemo_sk#134,ss_hdemo_sk#135,ss_addr_sk#136,ss_store_sk#137,ss_promo_sk#138,ss_ticket_number#139L,ss_quantity#140,ss_wholesale_cost#141,ss_list_price#142,ss_sales_price#143,ss_ext_discount_amt#144,ss_ext_sales_price#145,ss_ext_wholesale_cost#146,ss_ext_list_price#147,ss_ext_tax#148,ss_coupon_amt#149,ss_net_paid#150,ss_net_paid_inc_tax#151,ss_net_profit#152] parquet

      running Thread[benchmark runner,5,main]
Execution time: 83.17012066800001s
Results written to table: 'sqlPerformance' at s3a://spark-k8s-data/BENCHMARK-RESULT/timestamp=1578504961896
20/01/08 20:36:09 WARN TaskSetManager: Stage 654 contains a task of very large size (1864 KB). The maximum recommended task size is 100 KB.
20/01/08 20:36:10 WARN AbstractS3ACommitter: Task committer attempt_20200108203609_0000_m_000000_0: No pending uploads to commit
Reading result at s3a://spark-k8s-data/BENCHMARK-RESULT/timestamp=1578504961896
+--------------------+---------+--------------------+------+-------------+
|       configuration|iteration|             results|  tags|    timestamp|
+--------------------+---------+--------------------+------+-------------+
|[20, [spark-3db7a...|        1|[[0.008325, [], 8...|[true]|1578504961896|
|[20, [spark-3db7a...|        2|[[0.001565, [], 1...|[true]|1578504961896|
|[20, [spark-3db7a...|        3|[[0.001506, [], 8...|[true]|1578504961896|
|[20, [spark-3db7a...|        4|[[0.001373, [], 1...|[true]|1578504961896|
|[20, [spark-3db7a...|        5|[[0.001424, [], 8...|[true]|1578504961896|
|[20, [spark-3db7a...|        6|[[0.001419, [], 8...|[true]|1578504961896|
|[20, [spark-3db7a...|        7|[[0.001869, [], 8...|[true]|1578504961896|
|[20, [spark-3db7a...|        8|[[0.001645, [], 9...|[true]|1578504961896|
|[20, [spark-3db7a...|        9|[[0.001759, [], 8...|[true]|1578504961896|
|[20, [spark-3db7a...|       10|[[0.001649, [], 9...|[true]|1578504961896|
+--------------------+---------+--------------------+------+-------------+

+---------+---------+-----------------+
|iteration|queryName| executionSeconds|
+---------+---------+-----------------+
|        1| q64-v2.4|    825.829712141|
|        1| q70-v2.4|     86.059236713|
|        1| q82-v2.4|     88.017953018|
|        2| q64-v2.4|   1018.986373717|
|        2| q70-v2.4|     86.523169774|
|        2| q82-v2.4|86.66216706399999|
|        3| q64-v2.4|    827.128222898|
|        3| q70-v2.4|      86.49464543|
|        3| q82-v2.4|     90.372636512|
|        4| q64-v2.4|   1014.082377505|
|        4| q70-v2.4|83.03243336199999|
|        4| q82-v2.4|87.32902565399999|
|        5| q64-v2.4|    828.604365161|
|        5| q70-v2.4|77.86118556500001|
|        5| q82-v2.4|     87.010027666|
|        6| q64-v2.4|812.6623579550001|
|        6| q70-v2.4|     79.606993823|
|        6| q82-v2.4|85.49589838600001|
|        7| q64-v2.4|    820.798298335|
|        7| q70-v2.4|     76.962398978|
+---------+---------+-----------------+
only showing top 20 rows

Final results at s3a://spark-k8s-data/BENCHMARK-RESULT/timestamp=1578504961896
20/01/08 20:36:13 WARN AbstractS3ACommitter: Task committer attempt_20200108203611_0000_m_000000_0: No pending uploads to commit
+---------+--------------------+-----------------+-----------------+
|queryName|medianRuntimeSeconds|minRuntimeSeconds|maxRuntimeSeconds|
+---------+--------------------+-----------------+-----------------+
| q64-v2.4|               827.5|              812|             1018|
| q70-v2.4|                78.0|               75|               86|
| q82-v2.4|                86.0|               80|               90|
+---------+--------------------+-----------------+-----------------+

20/01/08 20:36:13 WARN StageMetrics: Stage metrics data refreshed into temp view PerfStageMetrics

Scheduling mode = FIFO
Spark Context default degree of parallelism = 20
Aggregated Spark stage metrics:
numStages => 461
sum(numTasks) => 86860
elapsedTime => 10789743 (3.0 h)
sum(stageDuration) => 28187853 (7.8 h)
sum(executorRunTime) => 191530056 (53.2 h)
sum(executorCpuTime) => 154363405 (42.9 h)
sum(executorDeserializeTime) => 416215 (6.9 min)
sum(executorDeserializeCpuTime) => 257488 (4.3 min)
sum(resultSerializationTime) => 2865 (3 s)
sum(jvmGCTime) => 2542312 (42 min)
sum(shuffleFetchWaitTime) => 4981217 (1.4 h)
sum(shuffleWriteTime) => 14856523 (4.1 h)
max(resultSize) => 12785180 (12.0 MB)
sum(numUpdatedBlockStatuses) => 0
sum(diskBytesSpilled) => 0 (0 Bytes)
sum(memoryBytesSpilled) => 0 (0 Bytes)
max(peakExecutionMemory) => 429496729600
sum(recordsRead) => 127932123167
sum(bytesRead) => 895574425081 (834.0 GB)
sum(recordsWritten) => 13
sum(bytesWritten) => 1875712 (1831.0 KB)
sum(shuffleTotalBytesRead) => 1927757194888 (1795.0 GB)
sum(shuffleTotalBlocksFetched) => 9080641
sum(shuffleLocalBlocksFetched) => 1942150
sum(shuffleRemoteBlocksFetched) => 7138491
sum(shuffleBytesWritten) => 1903885496455 (1773.0 GB)
sum(shuffleRecordsWritten) => 64737946302
20/01/08 20:36:14 WARN AbstractS3ACommitter: Task committer attempt_20200108203614_0000_m_000000_0: No pending uploads to commit
20/01/08 20:36:15 WARN ExecutorPodsWatchSnapshotSource: Kubernetes client has been closed (this is expected if the application is shutting down.)
